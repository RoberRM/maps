(self.webpackChunkmaps=self.webpackChunkmaps||[]).push([[179],{8217:(kn,an,Ve)=>{"use strict";Ve.d(an,{$:()=>Ja,A:()=>ae,G:()=>ke,K:()=>Zp,L:()=>Uc,N:()=>os,P:()=>Ge,R:()=>N,U:()=>bn,V:()=>vd,W:()=>Us,X:()=>js,Y:()=>Yi,Z:()=>fa,_:()=>Ol,a:()=>$l,a0:()=>tr,a1:()=>Id,a2:()=>Ou,a3:()=>fh,a4:()=>ph,a5:()=>qo,a6:()=>$s,a7:()=>gh,a8:()=>Fu,a9:()=>eo,aA:()=>$i,aB:()=>ze,aC:()=>lt,aD:()=>Hl,aE:()=>bt,aF:()=>Xn,aG:()=>Hu,aH:()=>br,aI:()=>mr,aJ:()=>Ki,aN:()=>vc,aQ:()=>Qa,aa:()=>Ci,ab:()=>el,ac:()=>Dd,ad:()=>Lu,ae:()=>Io,af:()=>Nu,ag:()=>Nl,ah:()=>Bl,ak:()=>Ad,al:()=>Vi,am:()=>zl,ap:()=>Wc,aq:()=>To,as:()=>Rg,at:()=>Kp,au:()=>Lt,av:()=>jn,aw:()=>Tt,ax:()=>at,ay:()=>Sh,az:()=>em,b:()=>_l,c:()=>Dt,d:()=>sn,e:()=>vt,f:()=>Ps,g:()=>sr,h:()=>_i,i:()=>$f,j:()=>Mr,k:()=>ps,l:()=>ye,m:()=>Cc,p:()=>se,r:()=>ve,s:()=>q,u:()=>Ae});var W=Ve(5861),ie=Ve(9058),fe=Ve(534),h=Ve(7879),Me=Ve(7582),He=Ve(4537);const se={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},ae={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const ke=function he(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},$e=function _e(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},Je=new ie.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ie=new h.Yd("@firebase/auth");function mt(R,...C){Ie.logLevel<=h.in.ERROR&&Ie.error(`Auth (${fe.SDK_VERSION}): ${R}`,...C)}function at(R,...C){throw xt(R,...C)}function ze(R,...C){return xt(R,...C)}function kt(R,C,D){const L=Object.assign(Object.assign({},$e()),{[C]:D});return new ie.LL("auth","Firebase",L).create(C,{appName:R.name})}function fn(R,C,D){if(!(C instanceof D))throw D.name!==C.constructor.name&&at(R,"argument-error"),kt(R,"argument-error",`Type of ${C.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function xt(R,...C){if("string"!=typeof R){const D=C[0],L=[...C.slice(1)];return L[0]&&(L[0].appName=R.name),R._errorFactory.create(D,...L)}return Je.create(R,...C)}function lt(R,C,...D){if(!R)throw xt(C,...D)}function pn(R){const C="INTERNAL ASSERTION FAILED: "+R;throw mt(C),new Error(C)}function Lt(R,C){R||pn(C)}function nn(){var R;return typeof self<"u"&&(null===(R=self.location)||void 0===R?void 0:R.href)||""}function wn(){return"http:"===Rt()||"https:"===Rt()}function Rt(){var R;return typeof self<"u"&&(null===(R=self.location)||void 0===R?void 0:R.protocol)||null}class Hn{constructor(C,D){this.shortDelay=C,this.longDelay=D,Lt(D>C,"Short delay should be less than long delay!"),this.isMobile=(0,ie.uI)()||(0,ie.b$)()}get(){return function Jn(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(wn()||(0,ie.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function yi(R,C){Lt(R.emulator,"Emulator should always be set here");const{url:D}=R.emulator;return C?`${D}${C.startsWith("/")?C.slice(1):C}`:D}class Pe{static initialize(C,D,L){this.fetchImpl=C,D&&(this.headersImpl=D),L&&(this.responseImpl=L)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void pn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void pn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void pn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const qe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Oe=new Hn(3e4,6e4);function Ue(R,C){return R.tenantId&&!C.tenantId?Object.assign(Object.assign({},C),{tenantId:R.tenantId}):C}function Ft(R,C,D,L){return Ot.apply(this,arguments)}function Ot(){return(Ot=(0,W.Z)(function*(R,C,D,L,Y={}){return _n(R,Y,(0,W.Z)(function*(){let me={},nt={};L&&("GET"===C?nt=L:me={body:JSON.stringify(L)});const Pt=(0,ie.xO)(Object.assign({key:R.config.apiKey},nt)).slice(1),hn=yield R._getAdditionalHeaders();return hn["Content-Type"]="application/json",R.languageCode&&(hn["X-Firebase-Locale"]=R.languageCode),Pe.fetch()(bi(R,R.config.apiHost,D,Pt),Object.assign({method:C,headers:hn,referrerPolicy:"no-referrer"},me))}))})).apply(this,arguments)}function _n(R,C,D){return Rn.apply(this,arguments)}function Rn(){return(Rn=(0,W.Z)(function*(R,C,D){R._canInitEmulator=!1;const L=Object.assign(Object.assign({},qe),C);try{const Y=new ti(R),me=yield Promise.race([D(),Y.promise]);Y.clearNetworkTimeout();const nt=yield me.json();if("needConfirmation"in nt)throw Ei(R,"account-exists-with-different-credential",nt);if(me.ok&&!("errorMessage"in nt))return nt;{const Pt=me.ok?nt.errorMessage:nt.error.message,[hn,Dn]=Pt.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===hn)throw Ei(R,"credential-already-in-use",nt);if("EMAIL_EXISTS"===hn)throw Ei(R,"email-already-in-use",nt);if("USER_DISABLED"===hn)throw Ei(R,"user-disabled",nt);const mi=L[hn]||hn.toLowerCase().replace(/[_\s]+/g,"-");if(Dn)throw kt(R,mi,Dn);at(R,mi)}}catch(Y){if(Y instanceof ie.ZR)throw Y;at(R,"network-request-failed",{message:String(Y)})}})).apply(this,arguments)}function $t(R,C,D,L){return qn.apply(this,arguments)}function qn(){return(qn=(0,W.Z)(function*(R,C,D,L,Y={}){const me=yield Ft(R,C,D,L,Y);return"mfaPendingCredential"in me&&at(R,"multi-factor-auth-required",{_serverResponse:me}),me})).apply(this,arguments)}function bi(R,C,D,L){const Y=`${C}${D}?${L}`;return R.config.emulator?yi(R.config,Y):`${R.config.apiScheme}://${Y}`}function ur(R){switch(R){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ti{constructor(C){this.auth=C,this.timer=null,this.promise=new Promise((D,L)=>{this.timer=setTimeout(()=>L(ze(this.auth,"network-request-failed")),Oe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ei(R,C,D){const L={appName:R.name};D.email&&(L.email=D.email),D.phoneNumber&&(L.phoneNumber=D.phoneNumber);const Y=ze(R,C,L);return Y.customData._tokenResponse=D,Y}function Vr(R){return void 0!==R&&void 0!==R.getResponse}function pr(R){return void 0!==R&&void 0!==R.enterprise}class dr{constructor(C){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===C.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=C.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=C.recaptchaEnforcementState}getProviderEnforcementState(C){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const D of this.recaptchaEnforcementState)if(D.provider&&D.provider===C)return ur(D.enforcementState);return null}isProviderEnabled(C){return"ENFORCE"===this.getProviderEnforcementState(C)||"AUDIT"===this.getProviderEnforcementState(C)}}function Fo(){return(Fo=(0,W.Z)(function*(R){return(yield Ft(R,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Lo(R,C){return hi.apply(this,arguments)}function hi(){return(hi=(0,W.Z)(function*(R,C){return Ft(R,"GET","/v2/recaptchaConfig",Ue(R,C))})).apply(this,arguments)}function bo(){return(bo=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:delete",C)})).apply(this,arguments)}function Jr(){return(Jr=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:update",C)})).apply(this,arguments)}function fo(){return(fo=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:lookup",C)})).apply(this,arguments)}function So(R){if(R)try{const C=new Date(Number(R));if(!isNaN(C.getTime()))return C.toUTCString()}catch{}}function Bi(){return(Bi=(0,W.Z)(function*(R,C=!1){const D=(0,ie.m9)(R),L=yield D.getIdToken(C),Y=Sr(L);lt(Y&&Y.exp&&Y.auth_time&&Y.iat,D.auth,"internal-error");const me="object"==typeof Y.firebase?Y.firebase:void 0,nt=me?.sign_in_provider;return{claims:Y,token:L,authTime:So(qr(Y.auth_time)),issuedAtTime:So(qr(Y.iat)),expirationTime:So(qr(Y.exp)),signInProvider:nt||null,signInSecondFactor:me?.sign_in_second_factor||null}})).apply(this,arguments)}function qr(R){return 1e3*Number(R)}function Sr(R){const[C,D,L]=R.split(".");if(void 0===C||void 0===D||void 0===L)return mt("JWT malformed, contained fewer than 3 sections"),null;try{const Y=(0,ie.tV)(D);return Y?JSON.parse(Y):(mt("Failed to decode base64 JWT payload"),null)}catch(Y){return mt("Caught error parsing JWT payload as JSON",Y?.toString()),null}}function vr(R,C){return zr.apply(this,arguments)}function zr(){return(zr=(0,W.Z)(function*(R,C,D=!1){if(D)return C;try{return yield C}catch(L){throw L instanceof ie.ZR&&function Re({code:R}){return"auth/user-disabled"===R||"auth/user-token-expired"===R}(L)&&R.auth.currentUser===R&&(yield R.auth.signOut()),L}})).apply(this,arguments)}class te{constructor(C){this.user=C,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(C){var D;if(C){const L=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),L}{this.errorBackoff=3e4;const Y=(null!==(D=this.user.stsTokenManager.expirationTime)&&void 0!==D?D:0)-Date.now()-3e5;return Math.max(0,Y)}}schedule(C=!1){var D=this;if(!this.isRunning)return;const L=this.getInterval(C);this.timerId=setTimeout((0,W.Z)(function*(){yield D.iteration()}),L)}iteration(){var C=this;return(0,W.Z)(function*(){try{yield C.user.getIdToken(!0)}catch(D){return void("auth/network-request-failed"===D?.code&&C.schedule(!0))}C.schedule()})()}}class oe{constructor(C,D){this.createdAt=C,this.lastLoginAt=D,this._initializeTime()}_initializeTime(){this.lastSignInTime=So(this.lastLoginAt),this.creationTime=So(this.createdAt)}_copy(C){this.createdAt=C.createdAt,this.lastLoginAt=C.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function De(R){return Be.apply(this,arguments)}function Be(){return Be=(0,W.Z)(function*(R){var C;const D=R.auth,L=yield R.getIdToken(),Y=yield vr(R,function Ir(R,C){return fo.apply(this,arguments)}(D,{idToken:L}));lt(Y?.users.length,D,"internal-error");const me=Y.users[0];R._notifyReloadListener(me);const nt=null!==(C=me.providerUserInfo)&&void 0!==C&&C.length?function et(R){return R.map(C=>{var{providerId:D}=C,L=(0,Me._T)(C,["providerId"]);return{providerId:D,uid:L.rawId||"",displayName:L.displayName||null,email:L.email||null,phoneNumber:L.phoneNumber||null,photoURL:L.photoUrl||null}})}(me.providerUserInfo):[],Pt=function dt(R,C){return[...R.filter(L=>!C.some(Y=>Y.providerId===L.providerId)),...C]}(R.providerData,nt),mi=!!R.isAnonymous&&!(R.email&&me.passwordHash||Pt?.length),ir={uid:me.localId,displayName:me.displayName||null,photoURL:me.photoUrl||null,email:me.email||null,emailVerified:me.emailVerified||!1,phoneNumber:me.phoneNumber||null,tenantId:me.tenantId||null,providerData:Pt,metadata:new oe(me.createdAt,me.lastLoginAt),isAnonymous:mi};Object.assign(R,ir)}),Be.apply(this,arguments)}function ut(){return(ut=(0,W.Z)(function*(R){const C=(0,ie.m9)(R);yield De(C),yield C.auth._persistUserIfCurrent(C),C.auth._notifyListenersIfCurrent(C)})).apply(this,arguments)}function tn(){return(tn=(0,W.Z)(function*(R,C){const D=yield _n(R,{},(0,W.Z)(function*(){const L=(0,ie.xO)({grant_type:"refresh_token",refresh_token:C}).slice(1),{tokenApiHost:Y,apiKey:me}=R.config,nt=bi(R,Y,"/v1/token",`key=${me}`),Pt=yield R._getAdditionalHeaders();return Pt["Content-Type"]="application/x-www-form-urlencoded",Pe.fetch()(nt,{method:"POST",headers:Pt,body:L})}));return{accessToken:D.access_token,expiresIn:D.expires_in,refreshToken:D.refresh_token}})).apply(this,arguments)}function pe(){return(pe=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v2/accounts:revokeToken",Ue(R,C))})).apply(this,arguments)}class ne{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(C){lt(C.idToken,"internal-error"),lt(typeof C.idToken<"u","internal-error"),lt(typeof C.refreshToken<"u","internal-error");const D="expiresIn"in C&&typeof C.expiresIn<"u"?Number(C.expiresIn):function Ks(R){const C=Sr(R);return lt(C,"internal-error"),lt(typeof C.exp<"u","internal-error"),lt(typeof C.iat<"u","internal-error"),Number(C.exp)-Number(C.iat)}(C.idToken);this.updateTokensAndExpiration(C.idToken,C.refreshToken,D)}getToken(C,D=!1){var L=this;return(0,W.Z)(function*(){return lt(!L.accessToken||L.refreshToken,C,"user-token-expired"),D||!L.accessToken||L.isExpired?L.refreshToken?(yield L.refresh(C,L.refreshToken),L.accessToken):null:L.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(C,D){var L=this;return(0,W.Z)(function*(){const{accessToken:Y,refreshToken:me,expiresIn:nt}=yield function Et(R,C){return tn.apply(this,arguments)}(C,D);L.updateTokensAndExpiration(Y,me,Number(nt))})()}updateTokensAndExpiration(C,D,L){this.refreshToken=D||null,this.accessToken=C||null,this.expirationTime=Date.now()+1e3*L}static fromJSON(C,D){const{refreshToken:L,accessToken:Y,expirationTime:me}=D,nt=new ne;return L&&(lt("string"==typeof L,"internal-error",{appName:C}),nt.refreshToken=L),Y&&(lt("string"==typeof Y,"internal-error",{appName:C}),nt.accessToken=Y),me&&(lt("number"==typeof me,"internal-error",{appName:C}),nt.expirationTime=me),nt}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(C){this.accessToken=C.accessToken,this.refreshToken=C.refreshToken,this.expirationTime=C.expirationTime}_clone(){return Object.assign(new ne,this.toJSON())}_performRefresh(){return pn("not implemented")}}function ue(R,C){lt("string"==typeof R||typeof R>"u","internal-error",{appName:C})}class ee{constructor(C){var{uid:D,auth:L,stsTokenManager:Y}=C,me=(0,Me._T)(C,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new te(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=D,this.auth=L,this.stsTokenManager=Y,this.accessToken=Y.accessToken,this.displayName=me.displayName||null,this.email=me.email||null,this.emailVerified=me.emailVerified||!1,this.phoneNumber=me.phoneNumber||null,this.photoURL=me.photoURL||null,this.isAnonymous=me.isAnonymous||!1,this.tenantId=me.tenantId||null,this.providerData=me.providerData?[...me.providerData]:[],this.metadata=new oe(me.createdAt||void 0,me.lastLoginAt||void 0)}getIdToken(C){var D=this;return(0,W.Z)(function*(){const L=yield vr(D,D.stsTokenManager.getToken(D.auth,C));return lt(L,D.auth,"internal-error"),D.accessToken!==L&&(D.accessToken=L,yield D.auth._persistUserIfCurrent(D),D.auth._notifyListenersIfCurrent(D)),L})()}getIdTokenResult(C){return function co(R){return Bi.apply(this,arguments)}(this,C)}reload(){return function Qe(R){return ut.apply(this,arguments)}(this)}_assign(C){this!==C&&(lt(this.uid===C.uid,this.auth,"internal-error"),this.displayName=C.displayName,this.photoURL=C.photoURL,this.email=C.email,this.emailVerified=C.emailVerified,this.phoneNumber=C.phoneNumber,this.isAnonymous=C.isAnonymous,this.tenantId=C.tenantId,this.providerData=C.providerData.map(D=>Object.assign({},D)),this.metadata._copy(C.metadata),this.stsTokenManager._assign(C.stsTokenManager))}_clone(C){const D=new ee(Object.assign(Object.assign({},this),{auth:C,stsTokenManager:this.stsTokenManager._clone()}));return D.metadata._copy(this.metadata),D}_onReload(C){lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=C,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(C){this.reloadListener?this.reloadListener(C):this.reloadUserInfo=C}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(C,D=!1){var L=this;return(0,W.Z)(function*(){let Y=!1;C.idToken&&C.idToken!==L.stsTokenManager.accessToken&&(L.stsTokenManager.updateFromServerResponse(C),Y=!0),D&&(yield De(L)),yield L.auth._persistUserIfCurrent(L),Y&&L.auth._notifyListenersIfCurrent(L)})()}delete(){var C=this;return(0,W.Z)(function*(){const D=yield C.getIdToken();return yield vr(C,function Or(R,C){return bo.apply(this,arguments)}(C.auth,{idToken:D})),C.stsTokenManager.clearRefreshToken(),C.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(C=>Object.assign({},C)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(C,D){var L,Y,me,nt,Pt,hn,Dn,mi;const ir=null!==(L=D.displayName)&&void 0!==L?L:void 0,go=null!==(Y=D.email)&&void 0!==Y?Y:void 0,nu=null!==(me=D.phoneNumber)&&void 0!==me?me:void 0,dm=null!==(nt=D.photoURL)&&void 0!==nt?nt:void 0,Rh=null!==(Pt=D.tenantId)&&void 0!==Pt?Pt:void 0,Tc=null!==(hn=D._redirectEventId)&&void 0!==hn?hn:void 0,Zu=null!==(Dn=D.createdAt)&&void 0!==Dn?Dn:void 0,hm=null!==(mi=D.lastLoginAt)&&void 0!==mi?mi:void 0,{uid:Qf,emailVerified:Bd,isAnonymous:Gg,providerData:Hs,stsTokenManager:S0}=D;lt(Qf&&S0,C,"internal-error");const ms=ne.fromJSON(this.name,S0);lt("string"==typeof Qf,C,"internal-error"),ue(ir,C.name),ue(go,C.name),lt("boolean"==typeof Bd,C,"internal-error"),lt("boolean"==typeof Gg,C,"internal-error"),ue(nu,C.name),ue(dm,C.name),ue(Rh,C.name),ue(Tc,C.name),ue(Zu,C.name),ue(hm,C.name);const Oh=new ee({uid:Qf,auth:C,email:go,emailVerified:Bd,displayName:ir,isAnonymous:Gg,photoURL:dm,phoneNumber:nu,tenantId:Rh,stsTokenManager:ms,createdAt:Zu,lastLoginAt:hm});return Hs&&Array.isArray(Hs)&&(Oh.providerData=Hs.map(Jf=>Object.assign({},Jf))),Tc&&(Oh._redirectEventId=Tc),Oh}static _fromIdTokenResponse(C,D,L=!1){return(0,W.Z)(function*(){const Y=new ne;Y.updateFromServerResponse(D);const me=new ee({uid:D.localId,auth:C,stsTokenManager:Y,isAnonymous:L});return yield De(me),me})()}}const Te=new Map;function bt(R){Lt(R instanceof Function,"Expected a class definition");let C=Te.get(R);return C?(Lt(C instanceof R,"Instance stored in cache mismatched with class"),C):(C=new R,Te.set(R,C),C)}const bn=(()=>{class R{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,W.Z)(function*(){return!0})()}_set(D,L){var Y=this;return(0,W.Z)(function*(){Y.storage[D]=L})()}_get(D){var L=this;return(0,W.Z)(function*(){const Y=L.storage[D];return void 0===Y?null:Y})()}_remove(D){var L=this;return(0,W.Z)(function*(){delete L.storage[D]})()}_addListener(D,L){}_removeListener(D,L){}}return R.type="NONE",R})();function Xn(R,C,D){return`firebase:${R}:${C}:${D}`}class vi{constructor(C,D,L){this.persistence=C,this.auth=D,this.userKey=L;const{config:Y,name:me}=this.auth;this.fullUserKey=Xn(this.userKey,Y.apiKey,me),this.fullPersistenceKey=Xn("persistence",Y.apiKey,me),this.boundEventHandler=D._onStorageEvent.bind(D),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(C){return this.persistence._set(this.fullUserKey,C.toJSON())}getCurrentUser(){var C=this;return(0,W.Z)(function*(){const D=yield C.persistence._get(C.fullUserKey);return D?ee._fromJSON(C.auth,D):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(C){var D=this;return(0,W.Z)(function*(){if(D.persistence===C)return;const L=yield D.getCurrentUser();return yield D.removeCurrentUser(),D.persistence=C,L?D.setCurrentUser(L):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(C,D,L="authUser"){return(0,W.Z)(function*(){if(!D.length)return new vi(bt(bn),C,L);const Y=(yield Promise.all(D.map(function(){var Dn=(0,W.Z)(function*(mi){if(yield mi._isAvailable())return mi});return function(mi){return Dn.apply(this,arguments)}}()))).filter(Dn=>Dn);let me=Y[0]||bt(bn);const nt=Xn(L,C.config.apiKey,C.name);let Pt=null;for(const Dn of D)try{const mi=yield Dn._get(nt);if(mi){const ir=ee._fromJSON(C,mi);Dn!==me&&(Pt=ir),me=Dn;break}}catch{}const hn=Y.filter(Dn=>Dn._shouldAllowMigration);return me._shouldAllowMigration&&hn.length?(me=hn[0],Pt&&(yield me._set(nt,Pt.toJSON())),yield Promise.all(D.map(function(){var Dn=(0,W.Z)(function*(mi){if(mi!==me)try{yield mi._remove(nt)}catch{}});return function(mi){return Dn.apply(this,arguments)}}())),new vi(me,C,L)):new vi(me,C,L)})()}}function Pn(R){const C=R.toLowerCase();if(C.includes("opera/")||C.includes("opr/")||C.includes("opios/"))return"Opera";if(Vc(C))return"IEMobile";if(C.includes("msie")||C.includes("trident/"))return"IE";if(C.includes("edge/"))return"Edge";if(Li(C))return"Firefox";if(C.includes("silk/"))return"Silk";if(Ke(C))return"Blackberry";if(dn(C))return"Webos";if(Un(C))return"Safari";if((C.includes("chrome/")||po(C))&&!C.includes("edge/"))return"Chrome";if(Tt(C))return"Android";{const L=R.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===L?.length)return L[1]}return"Other"}function Li(R=(0,ie.z$)()){return/firefox\//i.test(R)}function Un(R=(0,ie.z$)()){const C=R.toLowerCase();return C.includes("safari/")&&!C.includes("chrome/")&&!C.includes("crios/")&&!C.includes("android")}function po(R=(0,ie.z$)()){return/crios\//i.test(R)}function Vc(R=(0,ie.z$)()){return/iemobile/i.test(R)}function Tt(R=(0,ie.z$)()){return/android/i.test(R)}function Ke(R=(0,ie.z$)()){return/blackberry/i.test(R)}function dn(R=(0,ie.z$)()){return/webos/i.test(R)}function jn(R=(0,ie.z$)()){return/iphone|ipad|ipod/i.test(R)||/macintosh/i.test(R)&&/mobile/i.test(R)}function $i(R=(0,ie.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(R)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(R)}function xr(R=(0,ie.z$)()){return jn(R)||Tt(R)||dn(R)||Ke(R)||/windows phone/i.test(R)||Vc(R)}function Hi(R,C=[]){let D;switch(R){case"Browser":D=Pn((0,ie.z$)());break;case"Worker":D=`${Pn((0,ie.z$)())}-${R}`;break;default:D=R}const L=C.length?C.join(","):"FirebaseCore-web";return`${D}/JsCore/${fe.SDK_VERSION}/${L}`}class Wa{constructor(C){this.auth=C,this.queue=[]}pushCallback(C,D){const L=me=>new Promise((nt,Pt)=>{try{nt(C(me))}catch(hn){Pt(hn)}});L.onAbort=D,this.queue.push(L);const Y=this.queue.length-1;return()=>{this.queue[Y]=()=>Promise.resolve()}}runMiddleware(C){var D=this;return(0,W.Z)(function*(){if(D.auth.currentUser===C)return;const L=[];try{for(const Y of D.queue)yield Y(C),Y.onAbort&&L.push(Y.onAbort)}catch(Y){L.reverse();for(const me of L)try{me()}catch{}throw D.auth._errorFactory.create("login-blocked",{originalMessage:Y?.message})}})()}}function zc(){return(zc=(0,W.Z)(function*(R,C={}){return Ft(R,"GET","/v2/passwordPolicy",Ue(R,C))})).apply(this,arguments)}class Po{constructor(C){var D,L,Y,me;const nt=C.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(D=nt.minPasswordLength)&&void 0!==D?D:6,nt.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=nt.maxPasswordLength),void 0!==nt.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=nt.containsLowercaseCharacter),void 0!==nt.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=nt.containsUppercaseCharacter),void 0!==nt.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=nt.containsNumericCharacter),void 0!==nt.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=nt.containsNonAlphanumericCharacter),this.enforcementState=C.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(Y=null===(L=C.allowedNonAlphanumericCharacters)||void 0===L?void 0:L.join(""))&&void 0!==Y?Y:"",this.forceUpgradeOnSignin=null!==(me=C.forceUpgradeOnSignin)&&void 0!==me&&me,this.schemaVersion=C.schemaVersion}validatePassword(C){var D,L,Y,me,nt,Pt;const hn={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(C,hn),this.validatePasswordCharacterOptions(C,hn),hn.isValid&&(hn.isValid=null===(D=hn.meetsMinPasswordLength)||void 0===D||D),hn.isValid&&(hn.isValid=null===(L=hn.meetsMaxPasswordLength)||void 0===L||L),hn.isValid&&(hn.isValid=null===(Y=hn.containsLowercaseLetter)||void 0===Y||Y),hn.isValid&&(hn.isValid=null===(me=hn.containsUppercaseLetter)||void 0===me||me),hn.isValid&&(hn.isValid=null===(nt=hn.containsNumericCharacter)||void 0===nt||nt),hn.isValid&&(hn.isValid=null===(Pt=hn.containsNonAlphanumericCharacter)||void 0===Pt||Pt),hn}validatePasswordLengthOptions(C,D){const L=this.customStrengthOptions.minPasswordLength,Y=this.customStrengthOptions.maxPasswordLength;L&&(D.meetsMinPasswordLength=C.length>=L),Y&&(D.meetsMaxPasswordLength=C.length<=Y)}validatePasswordCharacterOptions(C,D){let L;this.updatePasswordCharacterOptionsStatuses(D,!1,!1,!1,!1);for(let Y=0;Y<C.length;Y++)L=C.charAt(Y),this.updatePasswordCharacterOptionsStatuses(D,L>="a"&&L<="z",L>="A"&&L<="Z",L>="0"&&L<="9",this.allowedNonAlphanumericCharacters.includes(L))}updatePasswordCharacterOptionsStatuses(C,D,L,Y,me){this.customStrengthOptions.containsLowercaseLetter&&(C.containsLowercaseLetter||(C.containsLowercaseLetter=D)),this.customStrengthOptions.containsUppercaseLetter&&(C.containsUppercaseLetter||(C.containsUppercaseLetter=L)),this.customStrengthOptions.containsNumericCharacter&&(C.containsNumericCharacter||(C.containsNumericCharacter=Y)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(C.containsNonAlphanumericCharacter||(C.containsNonAlphanumericCharacter=me))}}class No{constructor(C,D,L,Y){this.app=C,this.heartbeatServiceProvider=D,this.appCheckServiceProvider=L,this.config=Y,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Wp(this),this.idTokenSubscription=new Wp(this),this.beforeStateQueue=new Wa(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Je,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=C.name,this.clientVersion=Y.sdkClientVersion}_initializeWithPersistence(C,D){var L=this;return D&&(this._popupRedirectResolver=bt(D)),this._initializationPromise=this.queue((0,W.Z)(function*(){var Y,me;if(!L._deleted&&(L.persistenceManager=yield vi.create(L,C),!L._deleted)){if(null!==(Y=L._popupRedirectResolver)&&void 0!==Y&&Y._shouldInitProactively)try{yield L._popupRedirectResolver._initialize(L)}catch{}yield L.initializeCurrentUser(D),L.lastNotifiedUid=(null===(me=L.currentUser)||void 0===me?void 0:me.uid)||null,!L._deleted&&(L._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var C=this;return(0,W.Z)(function*(){if(C._deleted)return;const D=yield C.assertedPersistence.getCurrentUser();if(C.currentUser||D){if(C.currentUser&&D&&C.currentUser.uid===D.uid)return C._currentUser._assign(D),void(yield C.currentUser.getIdToken());yield C._updateCurrentUser(D,!0)}})()}initializeCurrentUser(C){var D=this;return(0,W.Z)(function*(){var L;const Y=yield D.assertedPersistence.getCurrentUser();let me=Y,nt=!1;if(C&&D.config.authDomain){yield D.getOrInitRedirectPersistenceManager();const Pt=null===(L=D.redirectUser)||void 0===L?void 0:L._redirectEventId,hn=me?._redirectEventId,Dn=yield D.tryRedirectSignIn(C);(!Pt||Pt===hn)&&Dn?.user&&(me=Dn.user,nt=!0)}if(!me)return D.directlySetCurrentUser(null);if(!me._redirectEventId){if(nt)try{yield D.beforeStateQueue.runMiddleware(me)}catch(Pt){me=Y,D._popupRedirectResolver._overrideRedirectResult(D,()=>Promise.reject(Pt))}return me?D.reloadAndSetCurrentUserOrClear(me):D.directlySetCurrentUser(null)}return lt(D._popupRedirectResolver,D,"argument-error"),yield D.getOrInitRedirectPersistenceManager(),D.redirectUser&&D.redirectUser._redirectEventId===me._redirectEventId?D.directlySetCurrentUser(me):D.reloadAndSetCurrentUserOrClear(me)})()}tryRedirectSignIn(C){var D=this;return(0,W.Z)(function*(){let L=null;try{L=yield D._popupRedirectResolver._completeRedirectFn(D,C,!0)}catch{yield D._setRedirectUser(null)}return L})()}reloadAndSetCurrentUserOrClear(C){var D=this;return(0,W.Z)(function*(){try{yield De(C)}catch(L){if("auth/network-request-failed"!==L?.code)return D.directlySetCurrentUser(null)}return D.directlySetCurrentUser(C)})()}useDeviceLanguage(){this.languageCode=function Kt(){if(typeof navigator>"u")return null;const R=navigator;return R.languages&&R.languages[0]||R.language||null}()}_delete(){var C=this;return(0,W.Z)(function*(){C._deleted=!0})()}updateCurrentUser(C){var D=this;return(0,W.Z)(function*(){const L=C?(0,ie.m9)(C):null;return L&&lt(L.auth.config.apiKey===D.config.apiKey,D,"invalid-user-token"),D._updateCurrentUser(L&&L._clone(D))})()}_updateCurrentUser(C,D=!1){var L=this;return(0,W.Z)(function*(){if(!L._deleted)return C&&lt(L.tenantId===C.tenantId,L,"tenant-id-mismatch"),D||(yield L.beforeStateQueue.runMiddleware(C)),L.queue((0,W.Z)(function*(){yield L.directlySetCurrentUser(C),L.notifyAuthListeners()}))})()}signOut(){var C=this;return(0,W.Z)(function*(){return yield C.beforeStateQueue.runMiddleware(null),(C.redirectPersistenceManager||C._popupRedirectResolver)&&(yield C._setRedirectUser(null)),C._updateCurrentUser(null,!0)})()}setPersistence(C){var D=this;return this.queue((0,W.Z)(function*(){yield D.assertedPersistence.setPersistence(bt(C))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(C){var D=this;return(0,W.Z)(function*(){D._getPasswordPolicyInternal()||(yield D._updatePasswordPolicy());const L=D._getPasswordPolicyInternal();return L.schemaVersion!==D.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(D._errorFactory.create("unsupported-password-policy-schema-version",{})):L.validatePassword(C)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var C=this;return(0,W.Z)(function*(){const D=yield function cc(R){return zc.apply(this,arguments)}(C),L=new Po(D);null===C.tenantId?C._projectPasswordPolicy=L:C._tenantPasswordPolicies[C.tenantId]=L})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(C){this._errorFactory=new ie.LL("auth","Firebase",C())}onAuthStateChanged(C,D,L){return this.registerStateListener(this.authStateSubscription,C,D,L)}beforeAuthStateChanged(C,D){return this.beforeStateQueue.pushCallback(C,D)}onIdTokenChanged(C,D,L){return this.registerStateListener(this.idTokenSubscription,C,D,L)}authStateReady(){return new Promise((C,D)=>{if(this.currentUser)C();else{const L=this.onAuthStateChanged(()=>{L(),C()},D)}})}revokeAccessToken(C){var D=this;return(0,W.Z)(function*(){if(D.currentUser){const L=yield D.currentUser.getIdToken(),Y={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:C,idToken:L};null!=D.tenantId&&(Y.tenantId=D.tenantId),yield function Ee(R,C){return pe.apply(this,arguments)}(D,Y)}})()}toJSON(){var C;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(C=this._currentUser)||void 0===C?void 0:C.toJSON()}}_setRedirectUser(C,D){var L=this;return(0,W.Z)(function*(){const Y=yield L.getOrInitRedirectPersistenceManager(D);return null===C?Y.removeCurrentUser():Y.setCurrentUser(C)})()}getOrInitRedirectPersistenceManager(C){var D=this;return(0,W.Z)(function*(){if(!D.redirectPersistenceManager){const L=C&&bt(C)||D._popupRedirectResolver;lt(L,D,"argument-error"),D.redirectPersistenceManager=yield vi.create(D,[bt(L._redirectPersistence)],"redirectUser"),D.redirectUser=yield D.redirectPersistenceManager.getCurrentUser()}return D.redirectPersistenceManager})()}_redirectUserForId(C){var D=this;return(0,W.Z)(function*(){var L,Y;return D._isInitialized&&(yield D.queue((0,W.Z)(function*(){}))),(null===(L=D._currentUser)||void 0===L?void 0:L._redirectEventId)===C?D._currentUser:(null===(Y=D.redirectUser)||void 0===Y?void 0:Y._redirectEventId)===C?D.redirectUser:null})()}_persistUserIfCurrent(C){var D=this;return(0,W.Z)(function*(){if(C===D.currentUser)return D.queue((0,W.Z)(function*(){return D.directlySetCurrentUser(C)}))})()}_notifyListenersIfCurrent(C){C===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var C,D;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const L=null!==(D=null===(C=this.currentUser)||void 0===C?void 0:C.uid)&&void 0!==D?D:null;this.lastNotifiedUid!==L&&(this.lastNotifiedUid=L,this.authStateSubscription.next(this.currentUser))}registerStateListener(C,D,L,Y){if(this._deleted)return()=>{};const me="function"==typeof D?D:D.next.bind(D);let nt=!1;const Pt=this._isInitialized?Promise.resolve():this._initializationPromise;if(lt(Pt,this,"internal-error"),Pt.then(()=>{nt||me(this.currentUser)}),"function"==typeof D){const hn=C.addObserver(D,L,Y);return()=>{nt=!0,hn()}}{const hn=C.addObserver(D);return()=>{nt=!0,hn()}}}directlySetCurrentUser(C){var D=this;return(0,W.Z)(function*(){D.currentUser&&D.currentUser!==C&&D._currentUser._stopProactiveRefresh(),C&&D.isProactiveRefreshEnabled&&C._startProactiveRefresh(),D.currentUser=C,C?yield D.assertedPersistence.setCurrentUser(C):yield D.assertedPersistence.removeCurrentUser()})()}queue(C){return this.operations=this.operations.then(C,C),this.operations}get assertedPersistence(){return lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(C){!C||this.frameworks.includes(C)||(this.frameworks.push(C),this.frameworks.sort(),this.clientVersion=Hi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var C=this;return(0,W.Z)(function*(){var D;const L={"X-Client-Version":C.clientVersion};C.app.options.appId&&(L["X-Firebase-gmpid"]=C.app.options.appId);const Y=yield null===(D=C.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===D?void 0:D.getHeartbeatsHeader();Y&&(L["X-Firebase-Client"]=Y);const me=yield C._getAppCheckToken();return me&&(L["X-Firebase-AppCheck"]=me),L})()}_getAppCheckToken(){var C=this;return(0,W.Z)(function*(){var D;const L=yield null===(D=C.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===D?void 0:D.getToken();return L?.error&&function Le(R,...C){Ie.logLevel<=h.in.WARN&&Ie.warn(`Auth (${fe.SDK_VERSION}): ${R}`,...C)}(`Error while retrieving App Check token: ${L.error}`),L?.token})()}}function Ki(R){return(0,ie.m9)(R)}class Wp{constructor(C){this.auth=C,this.observer=null,this.addObserver=(0,ie.ne)(D=>this.observer=D)}get next(){return lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function ih(R){return new Promise((C,D)=>{const L=document.createElement("script");L.setAttribute("src",R),L.onload=C,L.onerror=Y=>{const me=ze("internal-error");me.customData=Y,D(me)},L.type="text/javascript",L.charset="UTF-8",function Ts(){var R,C;return null!==(C=null===(R=document.getElementsByTagName("head"))||void 0===R?void 0:R[0])&&void 0!==C?C:document}().appendChild(L)})}function qp(R){return`__${R}${Math.floor(1e6*Math.random())}`}class zi{constructor(C){this.type="recaptcha-enterprise",this.auth=Ki(C)}verify(C="verify",D=!1){var L=this;return(0,W.Z)(function*(){function me(){return me=(0,W.Z)(function*(Pt){if(!D){if(null==Pt.tenantId&&null!=Pt._agentRecaptchaConfig)return Pt._agentRecaptchaConfig.siteKey;if(null!=Pt.tenantId&&void 0!==Pt._tenantRecaptchaConfigs[Pt.tenantId])return Pt._tenantRecaptchaConfigs[Pt.tenantId].siteKey}return new Promise(function(){var hn=(0,W.Z)(function*(Dn,mi){Lo(Pt,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(ir=>{if(void 0!==ir.recaptchaKey){const go=new dr(ir);return null==Pt.tenantId?Pt._agentRecaptchaConfig=go:Pt._tenantRecaptchaConfigs[Pt.tenantId]=go,Dn(go.siteKey)}mi(new Error("recaptcha Enterprise site key undefined"))}).catch(ir=>{mi(ir)})});return function(Dn,mi){return hn.apply(this,arguments)}}())}),me.apply(this,arguments)}function nt(Pt,hn,Dn){const mi=window.grecaptcha;pr(mi)?mi.enterprise.ready(()=>{mi.enterprise.execute(Pt,{action:C}).then(ir=>{hn(ir)}).catch(()=>{hn("NO_RECAPTCHA")})}):Dn(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((Pt,hn)=>{(function Y(Pt){return me.apply(this,arguments)})(L.auth).then(Dn=>{if(!D&&pr(window.grecaptcha))nt(Dn,Pt,hn);else{if(typeof window>"u")return void hn(new Error("RecaptchaVerifier is only supported in browser"));ih("https://www.google.com/recaptcha/enterprise.js?render="+Dn).then(()=>{nt(Dn,Pt,hn)}).catch(mi=>{hn(mi)})}}).catch(Dn=>{hn(Dn)})})})()}}function Ys(R,C,D){return Da.apply(this,arguments)}function Da(){return(Da=(0,W.Z)(function*(R,C,D,L=!1){const Y=new zi(R);let me;try{me=yield Y.verify(D)}catch{me=yield Y.verify(D,!0)}const nt=Object.assign({},C);return Object.assign(nt,L?{captchaResp:me}:{captchaResponse:me}),Object.assign(nt,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(nt,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),nt})).apply(this,arguments)}function li(R,C,D,L){return ri.apply(this,arguments)}function ri(){return ri=(0,W.Z)(function*(R,C,D,L){var Y;if(null!==(Y=R._getRecaptchaConfig())&&void 0!==Y&&Y.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const me=yield Ys(R,C,D,"getOobCode"===D);return L(R,me)}return L(R,C).catch(function(){var me=(0,W.Z)(function*(nt){if("auth/missing-recaptcha-token"===nt.code){console.log(`${D} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const Pt=yield Ys(R,C,D,"getOobCode"===D);return L(R,Pt)}return Promise.reject(nt)});return function(nt){return me.apply(this,arguments)}}())}),ri.apply(this,arguments)}function Zp(R,C,D){const L=Ki(R);lt(L._canInitEmulator,L,"emulator-config-failed"),lt(/^https?:\/\//.test(C),L,"invalid-emulator-scheme");const Y=!!D?.disableWarnings,me=Ai(C),{host:nt,port:Pt}=function dc(R){const C=Ai(R),D=/(\/\/)?([^?#/]+)/.exec(R.substr(C.length));if(!D)return{host:"",port:null};const L=D[2].split("@").pop()||"",Y=/^(\[[^\]]+\])(:|$)/.exec(L);if(Y){const me=Y[1];return{host:me,port:Du(L.substr(me.length+1))}}{const[me,nt]=L.split(":");return{host:me,port:Du(nt)}}}(C);L.config.emulator={url:`${me}//${nt}${null===Pt?"":`:${Pt}`}/`},L.settings.appVerificationDisabledForTesting=!0,L.emulatorConfig=Object.freeze({host:nt,port:Pt,protocol:me.replace(":",""),options:Object.freeze({disableWarnings:Y})}),Y||function oh(){function R(){const C=document.createElement("p"),D=C.style;C.innerText="Running in emulator mode. Do not use with production credentials.",D.position="fixed",D.width="100%",D.backgroundColor="#ffffff",D.border=".1em solid #000000",D.color="#b50000",D.bottom="0px",D.left="0px",D.margin="0px",D.zIndex="10000",D.textAlign="center",C.classList.add("firebase-emulator-warning"),document.body.appendChild(C)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",R):R())}()}function Ai(R){const C=R.indexOf(":");return C<0?"":R.substr(0,C+1)}function Du(R){if(!R)return null;const C=Number(R);return isNaN(C)?null:C}class Uc{constructor(C,D){this.providerId=C,this.signInMethod=D}toJSON(){return pn("not implemented")}_getIdTokenResponse(C){return pn("not implemented")}_linkToIdToken(C,D){return pn("not implemented")}_getReauthenticationResolver(C){return pn("not implemented")}}function Pl(R,C){return dl.apply(this,arguments)}function dl(){return(dl=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:resetPassword",Ue(R,C))})).apply(this,arguments)}function kl(){return(kl=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:update",C)})).apply(this,arguments)}function Xs(R,C){return si.apply(this,arguments)}function si(){return(si=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:signUp",C)})).apply(this,arguments)}function Su(){return(Su=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:update",Ue(R,C))})).apply(this,arguments)}function Ur(R,C){return zs.apply(this,arguments)}function zs(){return(zs=(0,W.Z)(function*(R,C){return $t(R,"POST","/v1/accounts:signInWithPassword",Ue(R,C))})).apply(this,arguments)}function sh(R,C){return yr.apply(this,arguments)}function yr(){return(yr=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:sendOobCode",Ue(R,C))})).apply(this,arguments)}function Mu(){return(Mu=(0,W.Z)(function*(R,C){return sh(R,C)})).apply(this,arguments)}function pd(R,C){return Za.apply(this,arguments)}function Za(){return(Za=(0,W.Z)(function*(R,C){return sh(R,C)})).apply(this,arguments)}function rs(R,C){return jc.apply(this,arguments)}function jc(){return(jc=(0,W.Z)(function*(R,C){return sh(R,C)})).apply(this,arguments)}function da(){return(da=(0,W.Z)(function*(R,C){return sh(R,C)})).apply(this,arguments)}function md(){return(md=(0,W.Z)(function*(R,C){return $t(R,"POST","/v1/accounts:signInWithEmailLink",Ue(R,C))})).apply(this,arguments)}function ah(){return(ah=(0,W.Z)(function*(R,C){return $t(R,"POST","/v1/accounts:signInWithEmailLink",Ue(R,C))})).apply(this,arguments)}class Rl extends Uc{constructor(C,D,L,Y=null){super("password",L),this._email=C,this._password=D,this._tenantId=Y}static _fromEmailAndPassword(C,D){return new Rl(C,D,"password")}static _fromEmailAndCode(C,D,L=null){return new Rl(C,D,"emailLink",L)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(C){const D="string"==typeof C?JSON.parse(C):C;if(D?.email&&D?.password){if("password"===D.signInMethod)return this._fromEmailAndPassword(D.email,D.password);if("emailLink"===D.signInMethod)return this._fromEmailAndCode(D.email,D.password,D.tenantId)}return null}_getIdTokenResponse(C){var D=this;return(0,W.Z)(function*(){switch(D.signInMethod){case"password":return li(C,{returnSecureToken:!0,email:D._email,password:D._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Ur);case"emailLink":return function $c(R,C){return md.apply(this,arguments)}(C,{email:D._email,oobCode:D._password});default:at(C,"internal-error")}})()}_linkToIdToken(C,D){var L=this;return(0,W.Z)(function*(){switch(L.signInMethod){case"password":return li(C,{idToken:D,returnSecureToken:!0,email:L._email,password:L._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Xs);case"emailLink":return function w0(R,C){return ah.apply(this,arguments)}(C,{idToken:D,email:L._email,oobCode:L._password});default:at(C,"internal-error")}})()}_getReauthenticationResolver(C){return this._getIdTokenResponse(C)}}function Eo(R,C){return Hc.apply(this,arguments)}function Hc(){return(Hc=(0,W.Z)(function*(R,C){return $t(R,"POST","/v1/accounts:signInWithIdp",Ue(R,C))})).apply(this,arguments)}class os extends Uc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(C){const D=new os(C.providerId,C.signInMethod);return C.idToken||C.accessToken?(C.idToken&&(D.idToken=C.idToken),C.accessToken&&(D.accessToken=C.accessToken),C.nonce&&!C.pendingToken&&(D.nonce=C.nonce),C.pendingToken&&(D.pendingToken=C.pendingToken)):C.oauthToken&&C.oauthTokenSecret?(D.accessToken=C.oauthToken,D.secret=C.oauthTokenSecret):at("argument-error"),D}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(C){const D="string"==typeof C?JSON.parse(C):C,{providerId:L,signInMethod:Y}=D,me=(0,Me._T)(D,["providerId","signInMethod"]);if(!L||!Y)return null;const nt=new os(L,Y);return nt.idToken=me.idToken||void 0,nt.accessToken=me.accessToken||void 0,nt.secret=me.secret,nt.nonce=me.nonce,nt.pendingToken=me.pendingToken||null,nt}_getIdTokenResponse(C){return Eo(C,this.buildRequest())}_linkToIdToken(C,D){const L=this.buildRequest();return L.idToken=D,Eo(C,L)}_getReauthenticationResolver(C){const D=this.buildRequest();return D.autoCreate=!1,Eo(C,D)}buildRequest(){const C={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)C.pendingToken=this.pendingToken;else{const D={};this.idToken&&(D.id_token=this.idToken),this.accessToken&&(D.access_token=this.accessToken),this.secret&&(D.oauth_token_secret=this.secret),D.providerId=this.providerId,this.nonce&&!this.pendingToken&&(D.nonce=this.nonce),C.postBody=(0,ie.xO)(D)}return C}}function Ka(){return(Ka=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:sendVerificationCode",Ue(R,C))})).apply(this,arguments)}function ha(){return(ha=(0,W.Z)(function*(R,C){return $t(R,"POST","/v1/accounts:signInWithPhoneNumber",Ue(R,C))})).apply(this,arguments)}function Ya(){return(Ya=(0,W.Z)(function*(R,C){const D=yield $t(R,"POST","/v1/accounts:signInWithPhoneNumber",Ue(R,C));if(D.temporaryProof)throw Ei(R,"account-exists-with-different-credential",D);return D})).apply(this,arguments)}const lh={USER_NOT_FOUND:"user-not-found"};function Pu(){return(Pu=(0,W.Z)(function*(R,C){return $t(R,"POST","/v1/accounts:signInWithPhoneNumber",Ue(R,Object.assign(Object.assign({},C),{operation:"REAUTH"})),lh)})).apply(this,arguments)}class xn extends Uc{constructor(C){super("phone","phone"),this.params=C}static _fromVerification(C,D){return new xn({verificationId:C,verificationCode:D})}static _fromTokenResponse(C,D){return new xn({phoneNumber:C,temporaryProof:D})}_getIdTokenResponse(C){return function _d(R,C){return ha.apply(this,arguments)}(C,this._makeVerificationRequest())}_linkToIdToken(C,D){return function yd(R,C){return Ya.apply(this,arguments)}(C,Object.assign({idToken:D},this._makeVerificationRequest()))}_getReauthenticationResolver(C){return function it(R,C){return Pu.apply(this,arguments)}(C,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:C,phoneNumber:D,verificationId:L,verificationCode:Y}=this.params;return C&&D?{temporaryProof:C,phoneNumber:D}:{sessionInfo:L,code:Y}}toJSON(){const C={providerId:this.providerId};return this.params.phoneNumber&&(C.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(C.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(C.verificationCode=this.params.verificationCode),this.params.verificationId&&(C.verificationId=this.params.verificationId),C}static fromJSON(C){"string"==typeof C&&(C=JSON.parse(C));const{verificationId:D,verificationCode:L,phoneNumber:Y,temporaryProof:me}=C;return L||D||Y||me?new xn({verificationId:D,verificationCode:L,phoneNumber:Y,temporaryProof:me}):null}}class Xa{constructor(C){var D,L,Y,me,nt,Pt;const hn=(0,ie.zd)((0,ie.pd)(C)),Dn=null!==(D=hn.apiKey)&&void 0!==D?D:null,mi=null!==(L=hn.oobCode)&&void 0!==L?L:null,ir=function or(R){switch(R){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(Y=hn.mode)&&void 0!==Y?Y:null);lt(Dn&&mi&&ir,"argument-error"),this.apiKey=Dn,this.operation=ir,this.code=mi,this.continueUrl=null!==(me=hn.continueUrl)&&void 0!==me?me:null,this.languageCode=null!==(nt=hn.languageCode)&&void 0!==nt?nt:null,this.tenantId=null!==(Pt=hn.tenantId)&&void 0!==Pt?Pt:null}static parseLink(C){const D=function Rf(R){const C=(0,ie.zd)((0,ie.pd)(R)).link,D=C?(0,ie.zd)((0,ie.pd)(C)).deep_link_id:null,L=(0,ie.zd)((0,ie.pd)(R)).deep_link_id;return(L?(0,ie.zd)((0,ie.pd)(L)).link:null)||L||D||C||R}(C);try{return new Xa(D)}catch{return null}}}let vd=(()=>{class R{constructor(){this.providerId=R.PROVIDER_ID}static credential(D,L){return Rl._fromEmailAndPassword(D,L)}static credentialWithLink(D,L){const Y=Xa.parseLink(L);return lt(Y,"argument-error"),Rl._fromEmailAndCode(D,Y.code,Y.tenantId)}}return R.PROVIDER_ID="password",R.EMAIL_PASSWORD_SIGN_IN_METHOD="password",R.EMAIL_LINK_SIGN_IN_METHOD="emailLink",R})();class fl{constructor(C){this.providerId=C,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(C){this.defaultLanguageCode=C}setCustomParameters(C){return this.customParameters=C,this}getCustomParameters(){return this.customParameters}}class Ds extends fl{constructor(){super(...arguments),this.scopes=[]}addScope(C){return this.scopes.includes(C)||this.scopes.push(C),this}getScopes(){return[...this.scopes]}}class fa extends Ds{static credentialFromJSON(C){const D="string"==typeof C?JSON.parse(C):C;return lt("providerId"in D&&"signInMethod"in D,"argument-error"),os._fromParams(D)}credential(C){return this._credential(Object.assign(Object.assign({},C),{nonce:C.rawNonce}))}_credential(C){return lt(C.idToken||C.accessToken,"argument-error"),os._fromParams(Object.assign(Object.assign({},C),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(C){return fa.oauthCredentialFromTaggedObject(C)}static credentialFromError(C){return fa.oauthCredentialFromTaggedObject(C.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:C}){if(!C)return null;const{oauthIdToken:D,oauthAccessToken:L,oauthTokenSecret:Y,pendingToken:me,nonce:nt,providerId:Pt}=C;if(!L&&!Y&&!D&&!me||!Pt)return null;try{return new fa(Pt)._credential({idToken:D,accessToken:L,nonce:nt,pendingToken:me})}catch{return null}}}let Us=(()=>{class R extends Ds{constructor(){super("facebook.com")}static credential(D){return os._fromParams({providerId:R.PROVIDER_ID,signInMethod:R.FACEBOOK_SIGN_IN_METHOD,accessToken:D})}static credentialFromResult(D){return R.credentialFromTaggedObject(D)}static credentialFromError(D){return R.credentialFromTaggedObject(D.customData||{})}static credentialFromTaggedObject({_tokenResponse:D}){if(!D||!("oauthAccessToken"in D)||!D.oauthAccessToken)return null;try{return R.credential(D.oauthAccessToken)}catch{return null}}}return R.FACEBOOK_SIGN_IN_METHOD="facebook.com",R.PROVIDER_ID="facebook.com",R})(),js=(()=>{class R extends Ds{constructor(){super("google.com"),this.addScope("profile")}static credential(D,L){return os._fromParams({providerId:R.PROVIDER_ID,signInMethod:R.GOOGLE_SIGN_IN_METHOD,idToken:D,accessToken:L})}static credentialFromResult(D){return R.credentialFromTaggedObject(D)}static credentialFromError(D){return R.credentialFromTaggedObject(D.customData||{})}static credentialFromTaggedObject({_tokenResponse:D}){if(!D)return null;const{oauthIdToken:L,oauthAccessToken:Y}=D;if(!L&&!Y)return null;try{return R.credential(L,Y)}catch{return null}}}return R.GOOGLE_SIGN_IN_METHOD="google.com",R.PROVIDER_ID="google.com",R})(),Yi=(()=>{class R extends Ds{constructor(){super("github.com")}static credential(D){return os._fromParams({providerId:R.PROVIDER_ID,signInMethod:R.GITHUB_SIGN_IN_METHOD,accessToken:D})}static credentialFromResult(D){return R.credentialFromTaggedObject(D)}static credentialFromError(D){return R.credentialFromTaggedObject(D.customData||{})}static credentialFromTaggedObject({_tokenResponse:D}){if(!D||!("oauthAccessToken"in D)||!D.oauthAccessToken)return null;try{return R.credential(D.oauthAccessToken)}catch{return null}}}return R.GITHUB_SIGN_IN_METHOD="github.com",R.PROVIDER_ID="github.com",R})();class Qa extends Uc{constructor(C,D){super(C,C),this.pendingToken=D}_getIdTokenResponse(C){return Eo(C,this.buildRequest())}_linkToIdToken(C,D){const L=this.buildRequest();return L.idToken=D,Eo(C,L)}_getReauthenticationResolver(C){const D=this.buildRequest();return D.autoCreate=!1,Eo(C,D)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(C){const D="string"==typeof C?JSON.parse(C):C,{providerId:L,signInMethod:Y,pendingToken:me}=D;return L&&Y&&me&&L===Y?new Qa(L,me):null}static _create(C,D){return new Qa(C,D)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Ol extends fl{constructor(C){lt(C.startsWith("saml."),"argument-error"),super(C)}static credentialFromResult(C){return Ol.samlCredentialFromTaggedObject(C)}static credentialFromError(C){return Ol.samlCredentialFromTaggedObject(C.customData||{})}static credentialFromJSON(C){const D=Qa.fromJSON(C);return lt(D,"argument-error"),D}static samlCredentialFromTaggedObject({_tokenResponse:C}){if(!C)return null;const{pendingToken:D,providerId:L}=C;if(!D||!L)return null;try{return Qa._create(L,D)}catch{return null}}}let Ja=(()=>{class R extends Ds{constructor(){super("twitter.com")}static credential(D,L){return os._fromParams({providerId:R.PROVIDER_ID,signInMethod:R.TWITTER_SIGN_IN_METHOD,oauthToken:D,oauthTokenSecret:L})}static credentialFromResult(D){return R.credentialFromTaggedObject(D)}static credentialFromError(D){return R.credentialFromTaggedObject(D.customData||{})}static credentialFromTaggedObject({_tokenResponse:D}){if(!D)return null;const{oauthAccessToken:L,oauthTokenSecret:Y}=D;if(!L||!Y)return null;try{return R.credential(L,Y)}catch{return null}}}return R.TWITTER_SIGN_IN_METHOD="twitter.com",R.PROVIDER_ID="twitter.com",R})();function hc(R,C){return Gc.apply(this,arguments)}function Gc(){return(Gc=(0,W.Z)(function*(R,C){return $t(R,"POST","/v1/accounts:signUp",Ue(R,C))})).apply(this,arguments)}class As{constructor(C){this.user=C.user,this.providerId=C.providerId,this._tokenResponse=C._tokenResponse,this.operationType=C.operationType}static _fromIdTokenResponse(C,D,L,Y=!1){return(0,W.Z)(function*(){const me=yield ee._fromIdTokenResponse(C,L,Y),nt=ku(L);return new As({user:me,providerId:nt,_tokenResponse:L,operationType:D})})()}static _forOperation(C,D,L){return(0,W.Z)(function*(){yield C._updateTokensIfNecessary(L,!0);const Y=ku(L);return new As({user:C,providerId:Y,_tokenResponse:L,operationType:D})})()}}function ku(R){return R.providerId?R.providerId:"phoneNumber"in R?"phone":null}function tr(R){return fc.apply(this,arguments)}function fc(){return(fc=(0,W.Z)(function*(R){var C;const D=Ki(R);if(yield D._initializationPromise,null!==(C=D.currentUser)&&void 0!==C&&C.isAnonymous)return new As({user:D.currentUser,providerId:null,operationType:"signIn"});const L=yield hc(D,{returnSecureToken:!0}),Y=yield As._fromIdTokenResponse(D,"signIn",L,!0);return yield D._updateCurrentUser(Y.user),Y})).apply(this,arguments)}class Fl extends ie.ZR{constructor(C,D,L,Y){var me;super(D.code,D.message),this.operationType=L,this.user=Y,Object.setPrototypeOf(this,Fl.prototype),this.customData={appName:C.name,tenantId:null!==(me=C.tenantId)&&void 0!==me?me:void 0,_serverResponse:D.customData._serverResponse,operationType:L}}static _fromErrorAndOperation(C,D,L,Y){return new Fl(C,D,L,Y)}}function xd(R,C,D,L){return("reauthenticate"===C?D._getReauthenticationResolver(R):D._getIdTokenResponse(R)).catch(me=>{throw"auth/multi-factor-auth-required"===me.code?Fl._fromErrorAndOperation(R,me,C,L):me})}function uh(R){return new Set(R.map(({providerId:C})=>C).filter(C=>!!C))}function Wc(R,C){return Ru.apply(this,arguments)}function Ru(){return Ru=(0,W.Z)(function*(R,C){const D=(0,ie.m9)(R);yield Qs(!0,D,C);const{providerUserInfo:L}=yield function Wo(R,C){return Jr.apply(this,arguments)}(D.auth,{idToken:yield D.getIdToken(),deleteProvider:[C]}),Y=uh(L||[]);return D.providerData=D.providerData.filter(me=>Y.has(me.providerId)),Y.has("phone")||(D.phoneNumber=null),yield D.auth._persistUserIfCurrent(D),D}),Ru.apply(this,arguments)}function Of(R,C){return Ff.apply(this,arguments)}function Ff(){return(Ff=(0,W.Z)(function*(R,C,D=!1){const L=yield vr(R,C._linkToIdToken(R.auth,yield R.getIdToken()),D);return As._forOperation(R,"link",L)})).apply(this,arguments)}function Qs(R,C,D){return bd.apply(this,arguments)}function bd(){return(bd=(0,W.Z)(function*(R,C,D){yield De(C);const Y=!1===R?"provider-already-linked":"no-such-provider";lt(uh(C.providerData).has(D)===R,C.auth,Y)})).apply(this,arguments)}function wd(R,C){return Ed.apply(this,arguments)}function Ed(){return(Ed=(0,W.Z)(function*(R,C,D=!1){const{auth:L}=R,Y="reauthenticate";try{const me=yield vr(R,xd(L,Y,C,R),D);lt(me.idToken,L,"internal-error");const nt=Sr(me.idToken);lt(nt,L,"internal-error");const{sub:Pt}=nt;return lt(R.uid===Pt,L,"user-mismatch"),As._forOperation(R,Y,me)}catch(me){throw"auth/user-not-found"===me?.code&&at(L,"user-mismatch"),me}})).apply(this,arguments)}function Cd(R,C){return dh.apply(this,arguments)}function dh(){return(dh=(0,W.Z)(function*(R,C,D=!1){const L="signIn",Y=yield xd(R,L,C),me=yield As._fromIdTokenResponse(R,L,Y);return D||(yield R._updateCurrentUser(me.user)),me})).apply(this,arguments)}function Id(R,C){return hh.apply(this,arguments)}function hh(){return(hh=(0,W.Z)(function*(R,C){return Cd(Ki(R),C)})).apply(this,arguments)}function Ou(R,C){return pc.apply(this,arguments)}function pc(){return(pc=(0,W.Z)(function*(R,C){const D=(0,ie.m9)(R);return yield Qs(!1,D,C.providerId),Of(D,C)})).apply(this,arguments)}function fh(R,C){return Wi.apply(this,arguments)}function Wi(){return(Wi=(0,W.Z)(function*(R,C){return wd((0,ie.m9)(R),C)})).apply(this,arguments)}function Aa(){return(Aa=(0,W.Z)(function*(R,C){return $t(R,"POST","/v1/accounts:signInWithCustomToken",Ue(R,C))})).apply(this,arguments)}function ph(R,C){return qi.apply(this,arguments)}function qi(){return qi=(0,W.Z)(function*(R,C){const D=Ki(R),L=yield function Lf(R,C){return Aa.apply(this,arguments)}(D,{token:C,returnSecureToken:!0}),Y=yield As._fromIdTokenResponse(D,"signIn",L);return yield D._updateCurrentUser(Y.user),Y}),qi.apply(this,arguments)}class mc{constructor(C,D){this.factorId=C,this.uid=D.mfaEnrollmentId,this.enrollmentTime=new Date(D.enrolledAt).toUTCString(),this.displayName=D.displayName}static _fromServerResponse(C,D){return"phoneInfo"in D?Td._fromServerResponse(C,D):"totpInfo"in D?On._fromServerResponse(C,D):at(C,"internal-error")}}class Td extends mc{constructor(C){super("phone",C),this.phoneNumber=C.phoneInfo}static _fromServerResponse(C,D){return new Td(D)}}class On extends mc{constructor(C){super("totp",C)}static _fromServerResponse(C,D){return new On(D)}}function ss(R,C,D){var L;lt((null===(L=D.url)||void 0===L?void 0:L.length)>0,R,"invalid-continue-uri"),lt(typeof D.dynamicLinkDomain>"u"||D.dynamicLinkDomain.length>0,R,"invalid-dynamic-link-domain"),C.continueUrl=D.url,C.dynamicLinkDomain=D.dynamicLinkDomain,C.canHandleCodeInApp=D.handleCodeInApp,D.iOS&&(lt(D.iOS.bundleId.length>0,R,"missing-ios-bundle-id"),C.iOSBundleId=D.iOS.bundleId),D.android&&(lt(D.android.packageName.length>0,R,"missing-android-pkg-name"),C.androidInstallApp=D.android.installApp,C.androidMinimumVersionCode=D.android.minimumVersion,C.androidPackageName=D.android.packageName)}function nr(R){return Co.apply(this,arguments)}function Co(){return(Co=(0,W.Z)(function*(R){const C=Ki(R);C._getPasswordPolicyInternal()&&(yield C._updatePasswordPolicy())})).apply(this,arguments)}function qo(R,C,D){return Ll.apply(this,arguments)}function Ll(){return(Ll=(0,W.Z)(function*(R,C,D){const L=Ki(R),Y={requestType:"PASSWORD_RESET",email:C,clientType:"CLIENT_TYPE_WEB"};D&&ss(L,Y,D),yield li(L,Y,"getOobCode",pd)})).apply(this,arguments)}function $s(R,C,D){return mh.apply(this,arguments)}function mh(){return mh=(0,W.Z)(function*(R,C,D){yield Pl((0,ie.m9)(R),{oobCode:C,newPassword:D}).catch(function(){var L=(0,W.Z)(function*(Y){throw"auth/password-does-not-meet-requirements"===Y.code&&nr(R),Y});return function(Y){return L.apply(this,arguments)}}())}),mh.apply(this,arguments)}function gh(R,C){return qc.apply(this,arguments)}function qc(){return qc=(0,W.Z)(function*(R,C){yield function fd(R,C){return Su.apply(this,arguments)}((0,ie.m9)(R),{oobCode:C})}),qc.apply(this,arguments)}function Fu(R,C){return _h.apply(this,arguments)}function _h(){return(_h=(0,W.Z)(function*(R,C){const D=(0,ie.m9)(R),L=yield Pl(D,{oobCode:C}),Y=L.requestType;switch(lt(Y,D,"internal-error"),Y){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":lt(L.newEmail,D,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":lt(L.mfaInfo,D,"internal-error");default:lt(L.email,D,"internal-error")}let me=null;return L.mfaInfo&&(me=mc._fromServerResponse(Ki(D),L.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===L.requestType?L.newEmail:L.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===L.requestType?L.email:L.newEmail)||null,multiFactorInfo:me},operation:Y}})).apply(this,arguments)}function eo(R,C){return Nn.apply(this,arguments)}function Nn(){return(Nn=(0,W.Z)(function*(R,C){const{data:D}=yield Fu((0,ie.m9)(R),C);return D.email})).apply(this,arguments)}function Ci(R,C,D){return Zr.apply(this,arguments)}function Zr(){return(Zr=(0,W.Z)(function*(R,C,D){const L=Ki(R),nt=yield li(L,{returnSecureToken:!0,email:C,password:D,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",hc).catch(hn=>{throw"auth/password-does-not-meet-requirements"===hn.code&&nr(R),hn}),Pt=yield As._fromIdTokenResponse(L,"signIn",nt);return yield L._updateCurrentUser(Pt.user),Pt})).apply(this,arguments)}function el(R,C,D){return Id((0,ie.m9)(R),vd.credential(C,D)).catch(function(){var L=(0,W.Z)(function*(Y){throw"auth/password-does-not-meet-requirements"===Y.code&&nr(R),Y});return function(Y){return L.apply(this,arguments)}}())}function Dd(R,C,D){return as.apply(this,arguments)}function as(){return(as=(0,W.Z)(function*(R,C,D){const L=Ki(R),Y={requestType:"EMAIL_SIGNIN",email:C,clientType:"CLIENT_TYPE_WEB"};(function me(nt,Pt){lt(Pt.handleCodeInApp,L,"argument-error"),Pt&&ss(L,nt,Pt)})(Y,D),yield li(L,Y,"getOobCode",rs)})).apply(this,arguments)}function Lu(R,C){const D=Xa.parseLink(C);return"EMAIL_SIGNIN"===D?.operation}function Io(R,C,D){return pa.apply(this,arguments)}function pa(){return(pa=(0,W.Z)(function*(R,C,D){const L=(0,ie.m9)(R),Y=vd.credentialWithLink(C,D||nn());return lt(Y._tenantId===(L.tenantId||null),L,"tenant-id-mismatch"),Id(L,Y)})).apply(this,arguments)}function Ii(){return(Ii=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:createAuthUri",Ue(R,C))})).apply(this,arguments)}function Nu(R,C){return Sa.apply(this,arguments)}function Sa(){return Sa=(0,W.Z)(function*(R,C){const L={identifier:C,continueUri:wn()?nn():"http://localhost"},{signinMethods:Y}=yield function tl(R,C){return Ii.apply(this,arguments)}((0,ie.m9)(R),L);return Y||[]}),Sa.apply(this,arguments)}function Nl(R,C){return hr.apply(this,arguments)}function hr(){return hr=(0,W.Z)(function*(R,C){const D=(0,ie.m9)(R),Y={requestType:"VERIFY_EMAIL",idToken:yield R.getIdToken()};C&&ss(D.auth,Y,C);const{email:me}=yield function wo(R,C){return Mu.apply(this,arguments)}(D.auth,Y);me!==R.email&&(yield R.reload())}),hr.apply(this,arguments)}function Bl(R,C,D){return Vl.apply(this,arguments)}function Vl(){return Vl=(0,W.Z)(function*(R,C,D){const L=(0,ie.m9)(R),me={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield R.getIdToken(),newEmail:C};D&&ss(L.auth,me,D);const{email:nt}=yield function kf(R,C){return da.apply(this,arguments)}(L.auth,me);nt!==R.email&&(yield R.reload())}),Vl.apply(this,arguments)}function Ma(){return(Ma=(0,W.Z)(function*(R,C){return Ft(R,"POST","/v1/accounts:update",C)})).apply(this,arguments)}function Ad(R,C){return ma.apply(this,arguments)}function ma(){return ma=(0,W.Z)(function*(R,{displayName:C,photoURL:D}){if(void 0===C&&void 0===D)return;const L=(0,ie.m9)(R),me={idToken:yield L.getIdToken(),displayName:C,photoUrl:D,returnSecureToken:!0},nt=yield vr(L,function Ss(R,C){return Ma.apply(this,arguments)}(L.auth,me));L.displayName=nt.displayName||null,L.photoURL=nt.photoUrl||null;const Pt=L.providerData.find(({providerId:hn})=>"password"===hn);Pt&&(Pt.displayName=L.displayName,Pt.photoURL=L.photoURL),yield L._updateTokensIfNecessary(nt)}),ma.apply(this,arguments)}function Vi(R,C){return Zc((0,ie.m9)(R),C,null)}function zl(R,C){return Zc((0,ie.m9)(R),null,C)}function Zc(R,C,D){return ji.apply(this,arguments)}function ji(){return ji=(0,W.Z)(function*(R,C,D){const{auth:L}=R,me={idToken:yield R.getIdToken(),returnSecureToken:!0};C&&(me.email=C),D&&(me.password=D);const nt=yield vr(R,function Au(R,C){return kl.apply(this,arguments)}(L,me));yield R._updateTokensIfNecessary(nt,!0)}),ji.apply(this,arguments)}class Ul{constructor(C,D,L={}){this.isNewUser=C,this.providerId=D,this.profile=L}}class Bu extends Ul{constructor(C,D,L,Y){super(C,D,L),this.username=Y}}class ls extends Ul{constructor(C,D){super(C,"facebook.com",D)}}class Md extends Bu{constructor(C,D){super(C,"github.com",D,"string"==typeof D?.login?D?.login:null)}}class jl extends Ul{constructor(C,D){super(C,"google.com",D)}}class ml extends Bu{constructor(C,D,L){super(C,"twitter.com",D,L)}}function To(R){const{user:C,_tokenResponse:D}=R;return C.isAnonymous&&!D?{providerId:null,isNewUser:!1,profile:null}:function Sd(R){var C,D;if(!R)return null;const{providerId:L}=R,Y=R.rawUserInfo?JSON.parse(R.rawUserInfo):{},me=R.isNewUser||"identitytoolkit#SignupNewUserResponse"===R.kind;if(!L&&R?.idToken){const nt=null===(D=null===(C=Sr(R.idToken))||void 0===C?void 0:C.firebase)||void 0===D?void 0:D.sign_in_provider;if(nt)return new Ul(me,"anonymous"!==nt&&"custom"!==nt?nt:null)}if(!L)return null;switch(L){case"facebook.com":return new ls(me,Y);case"github.com":return new Md(me,Y);case"google.com":return new jl(me,Y);case"twitter.com":return new ml(me,Y,R.screenName||null);case"custom":case"anonymous":return new Ul(me,null);default:return new Ul(me,L,Y)}}(D)}class _c{constructor(C,D,L){this.type=C,this.credential=D,this.user=L}static _fromIdtoken(C,D){return new _c("enroll",C,D)}static _fromMfaPendingCredential(C){return new _c("signin",C)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(C){var D,L;if(C?.multiFactorSession){if(null!==(D=C.multiFactorSession)&&void 0!==D&&D.pendingCredential)return _c._fromMfaPendingCredential(C.multiFactorSession.pendingCredential);if(null!==(L=C.multiFactorSession)&&void 0!==L&&L.idToken)return _c._fromIdtoken(C.multiFactorSession.idToken)}return null}}class Pd{constructor(C,D,L){this.session=C,this.hints=D,this.signInResolver=L}static _fromError(C,D){const L=Ki(C),Y=D.customData._serverResponse,me=(Y.mfaInfo||[]).map(Pt=>mc._fromServerResponse(L,Pt));lt(Y.mfaPendingCredential,L,"internal-error");const nt=_c._fromMfaPendingCredential(Y.mfaPendingCredential);return new Pd(nt,me,function(){var Pt=(0,W.Z)(function*(hn){const Dn=yield hn._process(L,nt);delete Y.mfaInfo,delete Y.mfaPendingCredential;const mi=Object.assign(Object.assign({},Y),{idToken:Dn.idToken,refreshToken:Dn.refreshToken});switch(D.operationType){case"signIn":const ir=yield As._fromIdTokenResponse(L,D.operationType,mi);return yield L._updateCurrentUser(ir.user),ir;case"reauthenticate":return lt(D.user,L,"internal-error"),As._forOperation(D.user,D.operationType,mi);default:at(L,"internal-error")}});return function(hn){return Pt.apply(this,arguments)}}())}resolveSignIn(C){var D=this;return(0,W.Z)(function*(){return D.signInResolver(C)})()}}function Rg(R,C){var D;const L=(0,ie.m9)(R),Y=C;return lt(C.customData.operationType,L,"argument-error"),lt(null===(D=Y.customData._serverResponse)||void 0===D?void 0:D.mfaPendingCredential,L,"argument-error"),Pd._fromError(L,Y)}class Kc{constructor(C){this.user=C,this.enrolledFactors=[],C._onReload(D=>{D.mfaInfo&&(this.enrolledFactors=D.mfaInfo.map(L=>mc._fromServerResponse(C.auth,L)))})}static _fromUser(C){return new Kc(C)}getSession(){var C=this;return(0,W.Z)(function*(){return _c._fromIdtoken(yield C.user.getIdToken(),C.user)})()}enroll(C,D){var L=this;return(0,W.Z)(function*(){const Y=C,me=yield L.getSession(),nt=yield vr(L.user,Y._process(L.user.auth,me,D));return yield L.user._updateTokensIfNecessary(nt),L.user.reload()})()}unenroll(C){var D=this;return(0,W.Z)(function*(){const L="string"==typeof C?C:C.uid,Y=yield D.user.getIdToken();try{const me=yield vr(D.user,function Fg(R,C){return Ft(R,"POST","/v2/accounts/mfaEnrollment:withdraw",Ue(R,C))}(D.user.auth,{idToken:Y,mfaEnrollmentId:L}));D.enrolledFactors=D.enrolledFactors.filter(({uid:nt})=>nt!==L),yield D.user._updateTokensIfNecessary(me),yield D.user.reload()}catch(me){throw me}})()}}const bh=new WeakMap;function Kp(R){const C=(0,ie.m9)(R);return bh.has(C)||bh.set(C,Kc._fromUser(C)),bh.get(C)}const Rd="__sak";class zu{constructor(C,D){this.storageRetriever=C,this.type=D}_isAvailable(){try{return this.storage?(this.storage.setItem(Rd,"1"),this.storage.removeItem(Rd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(C,D){return this.storage.setItem(C,JSON.stringify(D)),Promise.resolve()}_get(C){const D=this.storage.getItem(C);return Promise.resolve(D?JSON.parse(D):null)}_remove(C){return this.storage.removeItem(C),Promise.resolve()}get storage(){return this.storageRetriever()}}const _l=(()=>{class R extends zu{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(D,L)=>this.onStorageEvent(D,L),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Uu(){const R=(0,ie.z$)();return Un(R)||jn(R)}()&&function Zn(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=xr(),this._shouldAllowMigration=!0}forAllChangedKeys(D){for(const L of Object.keys(this.listeners)){const Y=this.storage.getItem(L),me=this.localCache[L];Y!==me&&D(L,me,Y)}}onStorageEvent(D,L=!1){if(!D.key)return void this.forAllChangedKeys((Pt,hn,Dn)=>{this.notifyListeners(Pt,Dn)});const Y=D.key;if(L?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const Pt=this.storage.getItem(Y);if(D.newValue!==Pt)null!==D.newValue?this.storage.setItem(Y,D.newValue):this.storage.removeItem(Y);else if(this.localCache[Y]===D.newValue&&!L)return}const me=()=>{const Pt=this.storage.getItem(Y);!L&&this.localCache[Y]===Pt||this.notifyListeners(Y,Pt)},nt=this.storage.getItem(Y);!function gt(){return(0,ie.w1)()&&10===document.documentMode}()||nt===D.newValue||D.newValue===D.oldValue?me():setTimeout(me,10)}notifyListeners(D,L){this.localCache[D]=L;const Y=this.listeners[D];if(Y)for(const me of Array.from(Y))me(L&&JSON.parse(L))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((D,L,Y)=>{this.onStorageEvent(new StorageEvent("storage",{key:D,oldValue:L,newValue:Y}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(D,L){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[D]||(this.listeners[D]=new Set,this.localCache[D]=this.storage.getItem(D)),this.listeners[D].add(L)}_removeListener(D,L){this.listeners[D]&&(this.listeners[D].delete(L),0===this.listeners[D].size&&delete this.listeners[D]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(D,L){var Y=()=>super._set,me=this;return(0,W.Z)(function*(){yield Y().call(me,D,L),me.localCache[D]=JSON.stringify(L)})()}_get(D){var L=()=>super._get,Y=this;return(0,W.Z)(function*(){const me=yield L().call(Y,D);return Y.localCache[D]=JSON.stringify(me),me})()}_remove(D){var L=()=>super._remove,Y=this;return(0,W.Z)(function*(){yield L().call(Y,D),delete Y.localCache[D]})()}}return R.type="LOCAL",R})(),$l=(()=>{class R extends zu{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(D,L){}_removeListener(D,L){}}return R.type="SESSION",R})();let us=(()=>{class R{constructor(D){this.eventTarget=D,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(D){const L=this.receivers.find(me=>me.isListeningto(D));if(L)return L;const Y=new R(D);return this.receivers.push(Y),Y}isListeningto(D){return this.eventTarget===D}handleEvent(D){var L=this;return(0,W.Z)(function*(){const Y=D,{eventId:me,eventType:nt,data:Pt}=Y.data,hn=L.handlersMap[nt];if(!hn?.size)return;Y.ports[0].postMessage({status:"ack",eventId:me,eventType:nt});const Dn=Array.from(hn).map(function(){var ir=(0,W.Z)(function*(go){return go(Y.origin,Pt)});return function(go){return ir.apply(this,arguments)}}()),mi=yield function Lg(R){return Promise.all(R.map(function(){var C=(0,W.Z)(function*(D){try{return{fulfilled:!0,value:yield D}}catch(L){return{fulfilled:!1,reason:L}}});return function(D){return C.apply(this,arguments)}}()))}(Dn);Y.ports[0].postMessage({status:"done",eventId:me,eventType:nt,response:mi})})()}_subscribe(D,L){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[D]||(this.handlersMap[D]=new Set),this.handlersMap[D].add(L)}_unsubscribe(D,L){this.handlersMap[D]&&L&&this.handlersMap[D].delete(L),(!L||0===this.handlersMap[D].size)&&delete this.handlersMap[D],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return R.receivers=[],R})();function vc(R="",C=10){let D="";for(let L=0;L<C;L++)D+=Math.floor(10*Math.random());return R+D}class ga{constructor(C){this.target=C,this.handlers=new Set}removeMessageHandler(C){C.messageChannel&&(C.messageChannel.port1.removeEventListener("message",C.onMessage),C.messageChannel.port1.close()),this.handlers.delete(C)}_send(C,D,L=50){var Y=this;return(0,W.Z)(function*(){const me=typeof MessageChannel<"u"?new MessageChannel:null;if(!me)throw new Error("connection_unavailable");let nt,Pt;return new Promise((hn,Dn)=>{const mi=vc("",20);me.port1.start();const ir=setTimeout(()=>{Dn(new Error("unsupported_event"))},L);Pt={messageChannel:me,onMessage(go){const nu=go;if(nu.data.eventId===mi)switch(nu.data.status){case"ack":clearTimeout(ir),nt=setTimeout(()=>{Dn(new Error("timeout"))},3e3);break;case"done":clearTimeout(nt),hn(nu.data.response);break;default:clearTimeout(ir),clearTimeout(nt),Dn(new Error("invalid_response"))}}},Y.handlers.add(Pt),me.port1.addEventListener("message",Pt.onMessage),Y.target.postMessage({eventType:C,eventId:mi,data:D},[me.port2])}).finally(()=>{Pt&&Y.removeMessageHandler(Pt)})})()}}function mo(){return window}function Od(){return typeof mo().WorkerGlobalScope<"u"&&"function"==typeof mo().importScripts}function Fd(){return(Fd=(0,W.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Eh="firebaseLocalStorageDb",ju="firebaseLocalStorage",jf="fbase_key";class ds{constructor(C){this.request=C}toPromise(){return new Promise((C,D)=>{this.request.addEventListener("success",()=>{C(this.request.result)}),this.request.addEventListener("error",()=>{D(this.request.error)})})}}function ws(R,C){return R.transaction([ju],C?"readwrite":"readonly").objectStore(ju)}function Yc(){const R=indexedDB.open(Eh,1);return new Promise((C,D)=>{R.addEventListener("error",()=>{D(R.error)}),R.addEventListener("upgradeneeded",()=>{const L=R.result;try{L.createObjectStore(ju,{keyPath:jf})}catch(Y){D(Y)}}),R.addEventListener("success",(0,W.Z)(function*(){const L=R.result;L.objectStoreNames.contains(ju)?C(L):(L.close(),yield function Pa(){const R=indexedDB.deleteDatabase(Eh);return new ds(R).toPromise()}(),C(yield Yc()))}))})}function Fn(R,C,D){return Ch.apply(this,arguments)}function Ch(){return(Ch=(0,W.Z)(function*(R,C,D){const L=ws(R,!0).put({[jf]:C,value:D});return new ds(L).toPromise()})).apply(this,arguments)}function xc(){return(xc=(0,W.Z)(function*(R,C){const D=ws(R,!1).get(C),L=yield new ds(D).toPromise();return void 0===L?null:L.value})).apply(this,arguments)}function bc(R,C){const D=ws(R,!0).delete(C);return new ds(D).toPromise()}const $f=(()=>{class R{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var D=this;return(0,W.Z)(function*(){return D.db||(D.db=yield Yc()),D.db})()}_withRetries(D){var L=this;return(0,W.Z)(function*(){let Y=0;for(;;)try{const me=yield L._openDb();return yield D(me)}catch(me){if(Y++>3)throw me;L.db&&(L.db.close(),L.db=void 0)}})()}initializeServiceWorkerMessaging(){var D=this;return(0,W.Z)(function*(){return Od()?D.initializeReceiver():D.initializeSender()})()}initializeReceiver(){var D=this;return(0,W.Z)(function*(){D.receiver=us._getInstance(function Uf(){return Od()?self:null}()),D.receiver._subscribe("keyChanged",function(){var L=(0,W.Z)(function*(Y,me){return{keyProcessed:(yield D._poll()).includes(me.key)}});return function(Y,me){return L.apply(this,arguments)}}()),D.receiver._subscribe("ping",function(){var L=(0,W.Z)(function*(Y,me){return["keyChanged"]});return function(Y,me){return L.apply(this,arguments)}}())})()}initializeSender(){var D=this;return(0,W.Z)(function*(){var L,Y;if(D.activeServiceWorker=yield function bs(){return Fd.apply(this,arguments)}(),!D.activeServiceWorker)return;D.sender=new ga(D.activeServiceWorker);const me=yield D.sender._send("ping",{},800);me&&null!==(L=me[0])&&void 0!==L&&L.fulfilled&&null!==(Y=me[0])&&void 0!==Y&&Y.value.includes("keyChanged")&&(D.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(D){var L=this;return(0,W.Z)(function*(){if(L.sender&&L.activeServiceWorker&&function zf(){var R;return(null===(R=navigator?.serviceWorker)||void 0===R?void 0:R.controller)||null}()===L.activeServiceWorker)try{yield L.sender._send("keyChanged",{key:D},L.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,W.Z)(function*(){try{if(!indexedDB)return!1;const D=yield Yc();return yield Fn(D,Rd,"1"),yield bc(D,Rd),!0}catch{}return!1})()}_withPendingWrite(D){var L=this;return(0,W.Z)(function*(){L.pendingWrites++;try{yield D()}finally{L.pendingWrites--}})()}_set(D,L){var Y=this;return(0,W.Z)(function*(){return Y._withPendingWrite((0,W.Z)(function*(){return yield Y._withRetries(me=>Fn(me,D,L)),Y.localCache[D]=L,Y.notifyServiceWorker(D)}))})()}_get(D){var L=this;return(0,W.Z)(function*(){const Y=yield L._withRetries(me=>function Xp(R,C){return xc.apply(this,arguments)}(me,D));return L.localCache[D]=Y,Y})()}_remove(D){var L=this;return(0,W.Z)(function*(){return L._withPendingWrite((0,W.Z)(function*(){return yield L._withRetries(Y=>bc(Y,D)),delete L.localCache[D],L.notifyServiceWorker(D)}))})()}_poll(){var D=this;return(0,W.Z)(function*(){const L=yield D._withRetries(nt=>{const Pt=ws(nt,!1).getAll();return new ds(Pt).toPromise()});if(!L)return[];if(0!==D.pendingWrites)return[];const Y=[],me=new Set;if(0!==L.length)for(const{fbase_key:nt,value:Pt}of L)me.add(nt),JSON.stringify(D.localCache[nt])!==JSON.stringify(Pt)&&(D.notifyListeners(nt,Pt),Y.push(nt));for(const nt of Object.keys(D.localCache))D.localCache[nt]&&!me.has(nt)&&(D.notifyListeners(nt,null),Y.push(nt));return Y})()}notifyListeners(D,L){this.localCache[D]=L;const Y=this.listeners[D];if(Y)for(const me of Array.from(Y))me(L)}startPolling(){var D=this;this.stopPolling(),this.pollTimer=setInterval((0,W.Z)(function*(){return D._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(D,L){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[D]||(this.listeners[D]=new Set,this._get(D)),this.listeners[D].add(L)}_removeListener(D,L){this.listeners[D]&&(this.listeners[D].delete(L),0===this.listeners[D].size&&delete this.listeners[D]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return R.type="LOCAL",R})(),Xc=1e12;class Hf{constructor(C){this.auth=C,this.counter=Xc,this._widgets=new Map}render(C,D){const L=this.counter;return this._widgets.set(L,new Gf(C,this.auth.name,D||{})),this.counter++,L}reset(C){var D;const L=C||Xc;null===(D=this._widgets.get(L))||void 0===D||D.delete(),this._widgets.delete(L)}getResponse(C){var D;return(null===(D=this._widgets.get(C||Xc))||void 0===D?void 0:D.getResponse())||""}execute(C){var D=this;return(0,W.Z)(function*(){var L;return null===(L=D._widgets.get(C||Xc))||void 0===L||L.execute(),""})()}}class Gf{constructor(C,D,L){this.params=L,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const Y="string"==typeof C?document.getElementById(C):C;lt(Y,"argument-error",{appName:D}),this.container=Y,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function $u(R){const C=[],D="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let L=0;L<R;L++)C.push(D.charAt(Math.floor(62*Math.random())));return C.join("")}(50);const{callback:C,"expired-callback":D}=this.params;if(C)try{C(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,D)try{D()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const _=qp("rcb"),u=new Hn(3e4,6e4);class v{constructor(){var C;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(C=mo().grecaptcha)||void 0===C||!C.render)}load(C,D=""){return lt(function w(R){return R.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(R)}(D),C,"argument-error"),this.shouldResolveImmediately(D)&&Vr(mo().grecaptcha)?Promise.resolve(mo().grecaptcha):new Promise((L,Y)=>{const me=mo().setTimeout(()=>{Y(ze(C,"network-request-failed"))},u.get());mo()[_]=()=>{mo().clearTimeout(me),delete mo()[_];const Pt=mo().grecaptcha;if(!Pt||!Vr(Pt))return void Y(ze(C,"internal-error"));const hn=Pt.render;Pt.render=(Dn,mi)=>{const ir=hn(Dn,mi);return this.counter++,ir},this.hostLanguage=D,L(Pt)},ih(`https://www.google.com/recaptcha/api.js??${(0,ie.xO)({onload:_,render:"explicit",hl:D})}`).catch(()=>{clearTimeout(me),Y(ze(C,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(C){var D;return!(null===(D=mo().grecaptcha)||void 0===D||!D.render)&&(C===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class I{load(C){return(0,W.Z)(function*(){return new Hf(C)})()}clearedOneInstance(){}}const P="recaptcha",k={theme:"light",type:"image"};class N{constructor(C,D,L=Object.assign({},k)){this.parameters=L,this.type=P,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ki(C),this.isInvisible="invisible"===this.parameters.size,lt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const Y="string"==typeof D?document.getElementById(D):D;lt(Y,this.auth,"argument-error"),this.container=Y,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new I:new v,this.validateStartingState()}verify(){var C=this;return(0,W.Z)(function*(){C.assertNotDestroyed();const D=yield C.render(),L=C.getAssertedRecaptcha();return L.getResponse(D)||new Promise(me=>{const nt=Pt=>{Pt&&(C.tokenChangeListeners.delete(nt),me(Pt))};C.tokenChangeListeners.add(nt),C.isInvisible&&L.execute(D)})})()}render(){try{this.assertNotDestroyed()}catch(C){return Promise.reject(C)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(C=>{throw this.renderPromise=null,C})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(C=>{this.container.removeChild(C)})}validateStartingState(){lt(!this.parameters.sitekey,this.auth,"argument-error"),lt(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),lt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(C){return D=>{if(this.tokenChangeListeners.forEach(L=>L(D)),"function"==typeof C)C(D);else if("string"==typeof C){const L=mo()[C];"function"==typeof L&&L(D)}}}assertNotDestroyed(){lt(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var C=this;return(0,W.Z)(function*(){if(yield C.init(),!C.widgetId){let D=C.container;if(!C.isInvisible){const L=document.createElement("div");D.appendChild(L),D=L}C.widgetId=C.getAssertedRecaptcha().render(D,C.parameters)}return C.widgetId})()}init(){var C=this;return(0,W.Z)(function*(){lt(wn()&&!Od(),C.auth,"internal-error"),yield function U(){let R=null;return new Promise(C=>{"complete"!==document.readyState?(R=()=>C(),window.addEventListener("load",R)):C()}).catch(C=>{throw R&&window.removeEventListener("load",R),C})}(),C.recaptcha=yield C._recaptchaLoader.load(C.auth,C.auth.languageCode||void 0);const D=yield function lo(R){return Fo.apply(this,arguments)}(C.auth);lt(D,C.auth,"internal-error"),C.parameters.sitekey=D})()}getAssertedRecaptcha(){return lt(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class z{constructor(C,D){this.verificationId=C,this.onConfirmation=D}confirm(C){const D=xn._fromVerification(this.verificationId,C);return this.onConfirmation(D)}}function q(R,C,D){return le.apply(this,arguments)}function le(){return(le=(0,W.Z)(function*(R,C,D){const L=Ki(R),Y=yield K(L,C,(0,ie.m9)(D));return new z(Y,me=>Id(L,me))})).apply(this,arguments)}function ye(R,C,D){return be.apply(this,arguments)}function be(){return(be=(0,W.Z)(function*(R,C,D){const L=(0,ie.m9)(R);yield Qs(!1,L,"phone");const Y=yield K(L.auth,C,(0,ie.m9)(D));return new z(Y,me=>Ou(L,me))})).apply(this,arguments)}function ve(R,C,D){return we.apply(this,arguments)}function we(){return(we=(0,W.Z)(function*(R,C,D){const L=(0,ie.m9)(R),Y=yield K(L.auth,C,(0,ie.m9)(D));return new z(Y,me=>fh(L,me))})).apply(this,arguments)}function K(R,C,D){return de.apply(this,arguments)}function de(){return de=(0,W.Z)(function*(R,C,D){var L;const Y=yield D.verify();try{let me;if(lt("string"==typeof Y,R,"argument-error"),lt(D.type===P,R,"argument-error"),me="string"==typeof C?{phoneNumber:C}:C,"session"in me){const nt=me.session;if("phoneNumber"in me)return lt("enroll"===nt.type,R,"internal-error"),(yield function Bf(R,C){return Ft(R,"POST","/v2/accounts/mfaEnrollment:start",Ue(R,C))}(R,{idToken:nt.credential,phoneEnrollmentInfo:{phoneNumber:me.phoneNumber,recaptchaToken:Y}})).phoneSessionInfo.sessionInfo;{lt("signin"===nt.type,R,"internal-error");const Pt=(null===(L=me.multiFactorHint)||void 0===L?void 0:L.uid)||me.multiFactorUid;return lt(Pt,R,"missing-multi-factor-info"),(yield function Ld(R,C){return Ft(R,"POST","/v2/accounts/mfaSignIn:start",Ue(R,C))}(R,{mfaPendingCredential:nt.credential,mfaEnrollmentId:Pt,phoneSignInInfo:{recaptchaToken:Y}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:nt}=yield function gd(R,C){return Ka.apply(this,arguments)}(R,{phoneNumber:me.phoneNumber,recaptchaToken:Y});return nt}}finally{D._reset()}}),de.apply(this,arguments)}function Ae(R,C){return Se.apply(this,arguments)}function Se(){return(Se=(0,W.Z)(function*(R,C){yield Of((0,ie.m9)(R),C)})).apply(this,arguments)}let Ge=(()=>{class R{constructor(D){this.providerId=R.PROVIDER_ID,this.auth=Ki(D)}verifyPhoneNumber(D,L){return K(this.auth,D,(0,ie.m9)(L))}static credential(D,L){return xn._fromVerification(D,L)}static credentialFromResult(D){return R.credentialFromTaggedObject(D)}static credentialFromError(D){return R.credentialFromTaggedObject(D.customData||{})}static credentialFromTaggedObject({_tokenResponse:D}){if(!D)return null;const{phoneNumber:L,temporaryProof:Y}=D;return L&&Y?xn._fromTokenResponse(L,Y):null}}return R.PROVIDER_ID="phone",R.PHONE_SIGN_IN_METHOD="phone",R})();function Ye(R,C){return C?bt(C):(lt(R._popupRedirectResolver,R,"argument-error"),R._popupRedirectResolver)}class Xe extends Uc{constructor(C){super("custom","custom"),this.params=C}_getIdTokenResponse(C){return Eo(C,this._buildIdpRequest())}_linkToIdToken(C,D){return Eo(C,this._buildIdpRequest(D))}_getReauthenticationResolver(C){return Eo(C,this._buildIdpRequest())}_buildIdpRequest(C){const D={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return C&&(D.idToken=C),D}}function ct(R){return Cd(R.auth,new Xe(R),R.bypassAuthState)}function st(R){const{auth:C,user:D}=R;return lt(D,C,"internal-error"),wd(D,new Xe(R),R.bypassAuthState)}function Ct(R){return rn.apply(this,arguments)}function rn(){return(rn=(0,W.Z)(function*(R){const{auth:C,user:D}=R;return lt(D,C,"internal-error"),Of(D,new Xe(R),R.bypassAuthState)})).apply(this,arguments)}class _t{constructor(C,D,L,Y,me=!1){this.auth=C,this.resolver=L,this.user=Y,this.bypassAuthState=me,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(D)?D:[D]}execute(){var C=this;return new Promise(function(){var D=(0,W.Z)(function*(L,Y){C.pendingPromise={resolve:L,reject:Y};try{C.eventManager=yield C.resolver._initialize(C.auth),yield C.onExecution(),C.eventManager.registerConsumer(C)}catch(me){C.reject(me)}});return function(L,Y){return D.apply(this,arguments)}}())}onAuthEvent(C){var D=this;return(0,W.Z)(function*(){const{urlResponse:L,sessionId:Y,postBody:me,tenantId:nt,error:Pt,type:hn}=C;if(Pt)return void D.reject(Pt);const Dn={auth:D.auth,requestUri:L,sessionId:Y,tenantId:nt||void 0,postBody:me||void 0,user:D.user,bypassAuthState:D.bypassAuthState};try{D.resolve(yield D.getIdpTask(hn)(Dn))}catch(mi){D.reject(mi)}})()}onError(C){this.reject(C)}getIdpTask(C){switch(C){case"signInViaPopup":case"signInViaRedirect":return ct;case"linkViaPopup":case"linkViaRedirect":return Ct;case"reauthViaPopup":case"reauthViaRedirect":return st;default:at(this.auth,"internal-error")}}resolve(C){Lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(C),this.unregisterAndCleanUp()}reject(C){Lt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(C),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const zt=new Hn(2e3,1e4);function Dt(R,C,D){return en.apply(this,arguments)}function en(){return(en=(0,W.Z)(function*(R,C,D){const L=Ki(R);fn(R,C,fl);const Y=Ye(L,D);return new Mt(L,"signInViaPopup",C,Y).executeNotNull()})).apply(this,arguments)}function vt(R,C,D){return Ut.apply(this,arguments)}function Ut(){return(Ut=(0,W.Z)(function*(R,C,D){const L=(0,ie.m9)(R);fn(L.auth,C,fl);const Y=Ye(L.auth,D);return new Mt(L.auth,"reauthViaPopup",C,Y,L).executeNotNull()})).apply(this,arguments)}function sn(R,C,D){return Zt.apply(this,arguments)}function Zt(){return(Zt=(0,W.Z)(function*(R,C,D){const L=(0,ie.m9)(R);fn(L.auth,C,fl);const Y=Ye(L.auth,D);return new Mt(L.auth,"linkViaPopup",C,Y,L).executeNotNull()})).apply(this,arguments)}let Mt=(()=>{class R extends _t{constructor(D,L,Y,me,nt){super(D,L,me,nt),this.provider=Y,this.authWindow=null,this.pollId=null,R.currentPopupAction&&R.currentPopupAction.cancel(),R.currentPopupAction=this}executeNotNull(){var D=this;return(0,W.Z)(function*(){const L=yield D.execute();return lt(L,D.auth,"internal-error"),L})()}onExecution(){var D=this;return(0,W.Z)(function*(){Lt(1===D.filter.length,"Popup operations only handle one event");const L=vc();D.authWindow=yield D.resolver._openPopup(D.auth,D.provider,D.filter[0],L),D.authWindow.associatedEvent=L,D.resolver._originValidation(D.auth).catch(Y=>{D.reject(Y)}),D.resolver._isIframeWebStorageSupported(D.auth,Y=>{Y||D.reject(ze(D.auth,"web-storage-unsupported"))}),D.pollUserCancellation()})()}get eventId(){var D;return(null===(D=this.authWindow)||void 0===D?void 0:D.associatedEvent)||null}cancel(){this.reject(ze(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,R.currentPopupAction=null}pollUserCancellation(){const D=()=>{var L,Y;this.pollId=null!==(Y=null===(L=this.authWindow)||void 0===L?void 0:L.window)&&void 0!==Y&&Y.closed?window.setTimeout(()=>{this.pollId=null,this.reject(ze(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(D,zt.get())};D()}}return R.currentPopupAction=null,R})();const Kn="pendingRedirect",pi=new Map;class Ln extends _t{constructor(C,D,L=!1){super(C,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],D,void 0,L),this.eventId=null}execute(){var C=()=>super.execute,D=this;return(0,W.Z)(function*(){let L=pi.get(D.auth._key());if(!L){try{const me=(yield function oi(R,C){return Ni.apply(this,arguments)}(D.resolver,D.auth))?yield C().call(D):null;L=()=>Promise.resolve(me)}catch(Y){L=()=>Promise.reject(Y)}pi.set(D.auth._key(),L)}return D.bypassAuthState||pi.set(D.auth._key(),()=>Promise.resolve(null)),L()})()}onAuthEvent(C){var D=()=>super.onAuthEvent,L=this;return(0,W.Z)(function*(){if("signInViaRedirect"===C.type)return D().call(L,C);if("unknown"!==C.type){if(C.eventId){const Y=yield L.auth._redirectUserForId(C.eventId);if(Y)return L.user=Y,D().call(L,C);L.resolve(null)}}else L.resolve(null)})()}onExecution(){return(0,W.Z)(function*(){})()}cleanUp(){}}function Ni(){return(Ni=(0,W.Z)(function*(R,C){const D=Er(C),L=wr(R);if(!(yield L._isAvailable()))return!1;const Y="true"===(yield L._get(D));return yield L._remove(D),Y})).apply(this,arguments)}function Si(R,C){return Bn.apply(this,arguments)}function Bn(){return(Bn=(0,W.Z)(function*(R,C){return wr(R)._set(Er(C),"true")})).apply(this,arguments)}function mr(){pi.clear()}function br(R,C){pi.set(R._key(),C)}function wr(R){return bt(R._redirectPersistence)}function Er(R){return Xn(Kn,R.config.apiKey,R.name)}function Ps(R,C,D){return function qt(R,C,D){return Mi.apply(this,arguments)}(R,C,D)}function Mi(){return(Mi=(0,W.Z)(function*(R,C,D){const L=Ki(R);fn(R,C,fl),yield L._initializationPromise;const Y=Ye(L,D);return yield Si(Y,L),Y._openRedirect(L,C,"signInViaRedirect")})).apply(this,arguments)}function _i(R,C,D){return function Gn(R,C,D){return Ti.apply(this,arguments)}(R,C,D)}function Ti(){return(Ti=(0,W.Z)(function*(R,C,D){const L=(0,ie.m9)(R);fn(L.auth,C,fl),yield L.auth._initializationPromise;const Y=Ye(L.auth,D);yield Si(Y,L.auth);const me=yield Qc(L);return Y._openRedirect(L.auth,C,"reauthViaRedirect",me)})).apply(this,arguments)}function sr(R,C,D){return function to(R,C,D){return Kr.apply(this,arguments)}(R,C,D)}function Kr(){return(Kr=(0,W.Z)(function*(R,C,D){const L=(0,ie.m9)(R);fn(L.auth,C,fl),yield L.auth._initializationPromise;const Y=Ye(L.auth,D);yield Qs(!1,L,C.providerId),yield Si(Y,L.auth);const me=yield Qc(L);return Y._openRedirect(L.auth,C,"linkViaRedirect",me)})).apply(this,arguments)}function Mr(R,C){return hs.apply(this,arguments)}function hs(){return(hs=(0,W.Z)(function*(R,C){return yield Ki(R)._initializationPromise,Hu(R,C,!1)})).apply(this,arguments)}function Hu(R,C){return wc.apply(this,arguments)}function wc(){return(wc=(0,W.Z)(function*(R,C,D=!1){const L=Ki(R),Y=Ye(L,C),nt=yield new Ln(L,Y,D).execute();return nt&&!D&&(delete nt.user._redirectEventId,yield L._persistUserIfCurrent(nt.user),yield L._setRedirectUser(null,C)),nt})).apply(this,arguments)}function Qc(R){return no.apply(this,arguments)}function no(){return(no=(0,W.Z)(function*(R){const C=vc(`${R.uid}:::`);return R._redirectEventId=C,yield R.auth._setRedirectUser(R),yield R.auth._persistUserIfCurrent(R),C})).apply(this,arguments)}class Hl{constructor(C){this.auth=C,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(C){this.consumers.add(C),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,C)&&(this.sendToConsumer(this.queuedRedirectEvent,C),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(C){this.consumers.delete(C)}onEvent(C){if(this.hasEventBeenHandled(C))return!1;let D=!1;return this.consumers.forEach(L=>{this.isEventForConsumer(C,L)&&(D=!0,this.sendToConsumer(C,L),this.saveEventToCache(C))}),this.hasHandledPotentialRedirect||!function Wf(R){switch(R.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Js(R);default:return!1}}(C)||(this.hasHandledPotentialRedirect=!0,D||(this.queuedRedirectEvent=C,D=!0)),D}sendToConsumer(C,D){var L;if(C.error&&!Js(C)){const Y=(null===(L=C.error.code)||void 0===L?void 0:L.split("auth/")[1])||"internal-error";D.onError(ze(this.auth,Y))}else D.onAuthEvent(C)}isEventForConsumer(C,D){const L=null===D.eventId||!!C.eventId&&C.eventId===D.eventId;return D.filter.includes(C.type)&&L}hasEventBeenHandled(C){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(yl(C))}saveEventToCache(C){this.cachedEventUids.add(yl(C)),this.lastProcessedEventTime=Date.now()}}function yl(R){return[R.type,R.eventId,R.sessionId,R.tenantId].filter(C=>C).join("-")}function Js({type:R,error:C}){return"unknown"===R&&"auth/no-auth-event"===C?.code}function em(R){return tm.apply(this,arguments)}function tm(){return(tm=(0,W.Z)(function*(R,C={}){return Ft(R,"GET","/v1/projects",C)})).apply(this,arguments)}const yx=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qf=/^https?/;function Zf(){return(Zf=(0,W.Z)(function*(R){if(R.config.emulator)return;const{authorizedDomains:C}=yield em(R);for(const D of C)try{if(Kf(D))return}catch{}at(R,"unauthorized-domain")})).apply(this,arguments)}function Kf(R){const C=nn(),{protocol:D,hostname:L}=new URL(C);if(R.startsWith("chrome-extension://")){const nt=new URL(R);return""===nt.hostname&&""===L?"chrome-extension:"===D&&R.replace("chrome-extension://","")===C.replace("chrome-extension://",""):"chrome-extension:"===D&&nt.hostname===L}if(!qf.test(D))return!1;if(yx.test(R))return L===R;const Y=R.replace(/\./g,"\\.");return new RegExp("^(.+\\."+Y+"|"+Y+")$","i").test(L)}const nm=new Hn(3e4,6e4);function Gl(){const R=mo().___jsl;if(R?.H)for(const C of Object.keys(R.H))if(R.H[C].r=R.H[C].r||[],R.H[C].L=R.H[C].L||[],R.H[C].r=[...R.H[C].L],R.CP)for(let D=0;D<R.CP.length;D++)R.CP[D]=null}let Ah=null;const I0=new Hn(5e3,15e3),T0="__/auth/iframe",Ug="emulator/auth/iframe",jg={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Yf=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function fs(R){const C=R.config;lt(C.authDomain,R,"auth-domain-config-required");const D=C.emulator?yi(C,Ug):`https://${R.config.authDomain}/${T0}`,L={apiKey:C.apiKey,appName:R.name,v:fe.SDK_VERSION},Y=Yf.get(R.config.apiHost);Y&&(L.eid=Y);const me=R._getFrameworks();return me.length&&(L.fw=me.join(",")),`${D}?${(0,ie.xO)(L).slice(1)}`}function gr(){return gr=(0,W.Z)(function*(R){const C=yield function zg(R){return Ah=Ah||function Dh(R){return new Promise((C,D)=>{var L,Y,me;function nt(){Gl(),gapi.load("gapi.iframes",{callback:()=>{C(gapi.iframes.getContext())},ontimeout:()=>{Gl(),D(ze(R,"network-request-failed"))},timeout:nm.get()})}if(null!==(Y=null===(L=mo().gapi)||void 0===L?void 0:L.iframes)&&void 0!==Y&&Y.Iframe)C(gapi.iframes.getContext());else{if(null===(me=mo().gapi)||void 0===me||!me.load){const Pt=qp("iframefcb");return mo()[Pt]=()=>{gapi.load?nt():D(ze(R,"network-request-failed"))},ih(`https://apis.google.com/js/api.js?onload=${Pt}`).catch(hn=>D(hn))}nt()}}).catch(C=>{throw Ah=null,C})}(R),Ah}(R),D=mo().gapi;return lt(D,R,"internal-error"),C.open({where:document.body,url:fs(R),messageHandlersFilter:D.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jg,dontclear:!0},L=>new Promise(function(){var Y=(0,W.Z)(function*(me,nt){yield L.restyle({setHideOnLeave:!1});const Pt=ze(R,"network-request-failed"),hn=mo().setTimeout(()=>{nt(Pt)},I0.get());function Dn(){mo().clearTimeout(hn),me(L)}L.ping(Dn).then(Dn,()=>{nt(Pt)})});return function(me,nt){return Y.apply(this,arguments)}}()))}),gr.apply(this,arguments)}const Ec={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class $g{constructor(C){this.window=C,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const A0="__/auth/handler",ka="emulator/auth/handler",rm=encodeURIComponent("fac");function Sh(R,C,D,L,Y,me){return io.apply(this,arguments)}function io(){return(io=(0,W.Z)(function*(R,C,D,L,Y,me){lt(R.config.authDomain,R,"auth-domain-config-required"),lt(R.config.apiKey,R,"invalid-api-key");const nt={apiKey:R.config.apiKey,appName:R.name,authType:D,redirectUrl:L,v:fe.SDK_VERSION,eventId:Y};if(C instanceof fl){C.setDefaultLanguage(R.languageCode),nt.providerId=C.providerId||"",(0,ie.xb)(C.getCustomParameters())||(nt.customParameters=JSON.stringify(C.getCustomParameters()));for(const[mi,ir]of Object.entries(me||{}))nt[mi]=ir}if(C instanceof Ds){const mi=C.getScopes().filter(ir=>""!==ir);mi.length>0&&(nt.scopes=mi.join(","))}R.tenantId&&(nt.tid=R.tenantId);const Pt=nt;for(const mi of Object.keys(Pt))void 0===Pt[mi]&&delete Pt[mi];const hn=yield R._getAppCheckToken(),Dn=hn?`#${rm}=${encodeURIComponent(hn)}`:"";return`${function ei({config:R}){return R.emulator?yi(R,ka):`https://${R.authDomain}/${A0}`}(R)}?${(0,ie.xO)(Pt).slice(1)}${Dn}`})).apply(this,arguments)}const Wl="webStorageSupport",ps=class om{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$l,this._completeRedirectFn=Hu,this._overrideRedirectResult=br}_openPopup(C,D,L,Y){var me=this;return(0,W.Z)(function*(){var nt;Lt(null===(nt=me.eventManagers[C._key()])||void 0===nt?void 0:nt.manager,"_initialize() not called before _openPopup()");const Pt=yield Sh(C,D,L,nn(),Y);return function im(R,C,D,L=500,Y=600){const me=Math.max((window.screen.availHeight-Y)/2,0).toString(),nt=Math.max((window.screen.availWidth-L)/2,0).toString();let Pt="";const hn=Object.assign(Object.assign({},Ec),{width:L.toString(),height:Y.toString(),top:me,left:nt}),Dn=(0,ie.z$)().toLowerCase();D&&(Pt=po(Dn)?"_blank":D),Li(Dn)&&(C=C||"http://localhost",hn.scrollbars="yes");const mi=Object.entries(hn).reduce((go,[nu,dm])=>`${go}${nu}=${dm},`,"");if(function Zi(R=(0,ie.z$)()){var C;return jn(R)&&!(null===(C=window.navigator)||void 0===C||!C.standalone)}(Dn)&&"_self"!==Pt)return function Jc(R,C){const D=document.createElement("a");D.href=R,D.target=C;const L=document.createEvent("MouseEvent");L.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),D.dispatchEvent(L)}(C||"",Pt),new $g(null);const ir=window.open(C||"",Pt,mi);lt(ir,R,"popup-blocked");try{ir.focus()}catch{}return new $g(ir)}(C,Pt,vc())})()}_openRedirect(C,D,L,Y){var me=this;return(0,W.Z)(function*(){return yield me._originValidation(C),function Vf(R){mo().location.href=R}(yield Sh(C,D,L,nn(),Y)),new Promise(()=>{})})()}_initialize(C){const D=C._key();if(this.eventManagers[D]){const{manager:Y,promise:me}=this.eventManagers[D];return Y?Promise.resolve(Y):(Lt(me,"If manager is not set, promise should be"),me)}const L=this.initAndGetManager(C);return this.eventManagers[D]={promise:L},L.catch(()=>{delete this.eventManagers[D]}),L}initAndGetManager(C){var D=this;return(0,W.Z)(function*(){const L=yield function ya(R){return gr.apply(this,arguments)}(C),Y=new Hl(C);return L.register("authEvent",me=>(lt(me?.authEvent,C,"invalid-auth-event"),{status:Y.onEvent(me.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),D.eventManagers[C._key()]={manager:Y},D.iframes[C._key()]=L,Y})()}_isIframeWebStorageSupported(C,D){this.iframes[C._key()].send(Wl,{type:Wl},Y=>{var me;const nt=null===(me=Y?.[0])||void 0===me?void 0:me[Wl];void 0!==nt&&D(!!nt),at(C,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(C){const D=C._key();return this.originValidationPromises[D]||(this.originValidationPromises[D]=function Th(R){return Zf.apply(this,arguments)}(C)),this.originValidationPromises[D]}get _shouldInitProactively(){return xr()||Un()||jn()}};class Mh{constructor(C){this.factorId=C}_process(C,D,L){switch(D.type){case"enroll":return this._finalizeEnroll(C,D.credential,L);case"signin":return this._finalizeSignIn(C,D.credential);default:return pn("unexpected MultiFactorSessionType")}}}class sm extends Mh{constructor(C){super("phone"),this.credential=C}static _fromCredential(C){return new sm(C)}_finalizeEnroll(C,D,L){return function kd(R,C){return Ft(R,"POST","/v2/accounts/mfaEnrollment:finalize",Ue(R,C))}(C,{idToken:D,displayName:L,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(C,D){return function Ng(R,C){return Ft(R,"POST","/v2/accounts/mfaSignIn:finalize",Ue(R,C))}(C,{mfaPendingCredential:D,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Cc=(()=>{class R{constructor(){}static assertion(D){return sm._fromCredential(D)}}return R.FACTOR_ID="phone",R})();var Hg="@firebase/auth";class cm{constructor(C){this.auth=C,this.internalListeners=new Map}getUid(){var C;return this.assertAuthConfigured(),(null===(C=this.auth.currentUser)||void 0===C?void 0:C.uid)||null}getToken(C){var D=this;return(0,W.Z)(function*(){return D.assertAuthConfigured(),yield D.auth._initializationPromise,D.auth.currentUser?{accessToken:yield D.auth.currentUser.getIdToken(C)}:null})()}addAuthTokenListener(C){if(this.assertAuthConfigured(),this.internalListeners.has(C))return;const D=this.auth.onIdTokenChanged(L=>{C(L?.stsTokenManager.accessToken||null)});this.internalListeners.set(C,D),this.updateProactiveRefresh()}removeAuthTokenListener(C){this.assertAuthConfigured();const D=this.internalListeners.get(C);D&&(this.internalListeners.delete(C),D(),this.updateProactiveRefresh())}assertAuthConfigured(){lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,ie.Pz)("authIdTokenMaxAge"),function xx(R){(0,fe._registerComponent)(new He.wA("auth",(C,{options:D})=>{const L=C.getProvider("app").getImmediate(),Y=C.getProvider("heartbeat"),me=C.getProvider("app-check-internal"),{apiKey:nt,authDomain:Pt}=L.options;lt(nt&&!nt.includes(":"),"invalid-api-key",{appName:L.name});const hn={apiKey:nt,authDomain:Pt,clientPlatform:R,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Hi(R)},Dn=new No(L,Y,me,hn);return function Wt(R,C){const D=C?.persistence||[],L=(Array.isArray(D)?D:[D]).map(bt);C?.errorMap&&R._updateErrorMap(C.errorMap),R._initializeWithPersistence(L,C?.popupRedirectResolver)}(Dn,D),Dn},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((C,D,L)=>{C.getProvider("auth-internal").initialize()})),(0,fe._registerComponent)(new He.wA("auth-internal",C=>{const D=Ki(C.getProvider("auth").getImmediate());return new cm(D)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,fe.registerVersion)(Hg,"1.5.1",function kh(R){switch(R){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(R)),(0,fe.registerVersion)(Hg,"1.5.1","esm2017")}("Browser")},9058:(kn,an,Ve)=>{"use strict";Ve.d(an,{BH:()=>kt,G6:()=>yi,L:()=>ce,LL:()=>Ot,P0:()=>mt,Pz:()=>ze,Sg:()=>fn,UG:()=>pn,ZB:()=>he,ZR:()=>Ft,aH:()=>at,b$:()=>wn,eu:()=>qe,hl:()=>Pe,jU:()=>Lt,m9:()=>tn,ne:()=>fo,pd:()=>Jr,r3:()=>pr,ru:()=>nn,tV:()=>xe,uI:()=>lt,vZ:()=>Lo,w1:()=>Jn,xO:()=>bo,xb:()=>lo,z$:()=>xt,zd:()=>Wo});const h=function(Ee){const pe=[];let ne=0;for(let ue=0;ue<Ee.length;ue++){let ee=Ee.charCodeAt(ue);ee<128?pe[ne++]=ee:ee<2048?(pe[ne++]=ee>>6|192,pe[ne++]=63&ee|128):55296==(64512&ee)&&ue+1<Ee.length&&56320==(64512&Ee.charCodeAt(ue+1))?(ee=65536+((1023&ee)<<10)+(1023&Ee.charCodeAt(++ue)),pe[ne++]=ee>>18|240,pe[ne++]=ee>>12&63|128,pe[ne++]=ee>>6&63|128,pe[ne++]=63&ee|128):(pe[ne++]=ee>>12|224,pe[ne++]=ee>>6&63|128,pe[ne++]=63&ee|128)}return pe},He={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(Ee,pe){if(!Array.isArray(Ee))throw Error("encodeByteArray takes an array as a parameter");this.init_();const ne=pe?this.byteToCharMapWebSafe_:this.byteToCharMap_,ue=[];for(let ee=0;ee<Ee.length;ee+=3){const Te=Ee[ee],bt=ee+1<Ee.length,En=bt?Ee[ee+1]:0,bn=ee+2<Ee.length,Xn=bn?Ee[ee+2]:0;let Li=(15&En)<<2|Xn>>6,Un=63&Xn;bn||(Un=64,bt||(Li=64)),ue.push(ne[Te>>2],ne[(3&Te)<<4|En>>4],ne[Li],ne[Un])}return ue.join("")},encodeString(Ee,pe){return this.HAS_NATIVE_SUPPORT&&!pe?btoa(Ee):this.encodeByteArray(h(Ee),pe)},decodeString(Ee,pe){return this.HAS_NATIVE_SUPPORT&&!pe?atob(Ee):function(Ee){const pe=[];let ne=0,ue=0;for(;ne<Ee.length;){const ee=Ee[ne++];if(ee<128)pe[ue++]=String.fromCharCode(ee);else if(ee>191&&ee<224){const Te=Ee[ne++];pe[ue++]=String.fromCharCode((31&ee)<<6|63&Te)}else if(ee>239&&ee<365){const bn=((7&ee)<<18|(63&Ee[ne++])<<12|(63&Ee[ne++])<<6|63&Ee[ne++])-65536;pe[ue++]=String.fromCharCode(55296+(bn>>10)),pe[ue++]=String.fromCharCode(56320+(1023&bn))}else{const Te=Ee[ne++],bt=Ee[ne++];pe[ue++]=String.fromCharCode((15&ee)<<12|(63&Te)<<6|63&bt)}}return pe.join("")}(this.decodeStringToByteArray(Ee,pe))},decodeStringToByteArray(Ee,pe){this.init_();const ne=pe?this.charToByteMapWebSafe_:this.charToByteMap_,ue=[];for(let ee=0;ee<Ee.length;){const Te=ne[Ee.charAt(ee++)],En=ee<Ee.length?ne[Ee.charAt(ee)]:0;++ee;const Xn=ee<Ee.length?ne[Ee.charAt(ee)]:64;++ee;const Pn=ee<Ee.length?ne[Ee.charAt(ee)]:64;if(++ee,null==Te||null==En||null==Xn||null==Pn)throw new rt;ue.push(Te<<2|En>>4),64!==Xn&&(ue.push(En<<4&240|Xn>>2),64!==Pn&&ue.push(Xn<<6&192|Pn))}return ue},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let Ee=0;Ee<this.ENCODED_VALS.length;Ee++)this.byteToCharMap_[Ee]=this.ENCODED_VALS.charAt(Ee),this.charToByteMap_[this.byteToCharMap_[Ee]]=Ee,this.byteToCharMapWebSafe_[Ee]=this.ENCODED_VALS_WEBSAFE.charAt(Ee),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[Ee]]=Ee,Ee>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(Ee)]=Ee,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(Ee)]=Ee)}}};class rt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ce=function(Ee){return function(Ee){const pe=h(Ee);return He.encodeByteArray(pe,!0)}(Ee).replace(/\./g,"")},xe=function(Ee){try{return He.decodeString(Ee,!0)}catch(pe){console.error("base64Decode failed: ",pe)}return null};function he(Ee,pe){if(!(pe instanceof Object))return pe;switch(pe.constructor){case Date:return new Date(pe.getTime());case Object:void 0===Ee&&(Ee={});break;case Array:Ee=[];break;default:return pe}for(const ne in pe)!pe.hasOwnProperty(ne)||!_e(ne)||(Ee[ne]=he(Ee[ne],pe[ne]));return Ee}function _e(Ee){return"__proto__"!==Ee}const Ie=()=>{try{return function ke(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const Ee=process.env.__FIREBASE_DEFAULTS__;return Ee?JSON.parse(Ee):void 0})()||(()=>{if(typeof document>"u")return;let Ee;try{Ee=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const pe=Ee&&xe(Ee[1]);return pe&&JSON.parse(pe)})()}catch(Ee){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${Ee}`)}},mt=Ee=>{const pe=(Ee=>{var pe,ne;return null===(ne=null===(pe=Ie())||void 0===pe?void 0:pe.emulatorHosts)||void 0===ne?void 0:ne[Ee]})(Ee);if(!pe)return;const ne=pe.lastIndexOf(":");if(ne<=0||ne+1===pe.length)throw new Error(`Invalid host ${pe} with no separate hostname and port!`);const ue=parseInt(pe.substring(ne+1),10);return"["===pe[0]?[pe.substring(1,ne-1),ue]:[pe.substring(0,ne),ue]},at=()=>{var Ee;return null===(Ee=Ie())||void 0===Ee?void 0:Ee.config},ze=Ee=>{var pe;return null===(pe=Ie())||void 0===pe?void 0:pe[`_${Ee}`]};class kt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((pe,ne)=>{this.resolve=pe,this.reject=ne})}wrapCallback(pe){return(ne,ue)=>{ne?this.reject(ne):this.resolve(ue),"function"==typeof pe&&(this.promise.catch(()=>{}),1===pe.length?pe(ne):pe(ne,ue))}}}function fn(Ee,pe){if(Ee.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const ue=pe||"demo-project",ee=Ee.iat||0,Te=Ee.sub||Ee.user_id;if(!Te)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const bt=Object.assign({iss:`https://securetoken.google.com/${ue}`,aud:ue,iat:ee,exp:ee+3600,auth_time:ee,sub:Te,user_id:Te,firebase:{sign_in_provider:"custom",identities:{}}},Ee);return[ce(JSON.stringify({alg:"none",type:"JWT"})),ce(JSON.stringify(bt)),""].join(".")}function xt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function lt(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xt())}function pn(){var Ee;const pe=null===(Ee=Ie())||void 0===Ee?void 0:Ee.forceEnvironment;if("node"===pe)return!0;if("browser"===pe)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function Lt(){return"object"==typeof self&&self.self===self}function nn(){const Ee="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof Ee&&void 0!==Ee.id}function wn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Jn(){const Ee=xt();return Ee.indexOf("MSIE ")>=0||Ee.indexOf("Trident/")>=0}function yi(){return!pn()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Pe(){try{return"object"==typeof indexedDB}catch{return!1}}function qe(){return new Promise((Ee,pe)=>{try{let ne=!0;const ue="validate-browser-context-for-indexeddb-analytics-module",ee=self.indexedDB.open(ue);ee.onsuccess=()=>{ee.result.close(),ne||self.indexedDB.deleteDatabase(ue),Ee(!0)},ee.onupgradeneeded=()=>{ne=!1},ee.onerror=()=>{var Te;pe((null===(Te=ee.error)||void 0===Te?void 0:Te.message)||"")}}catch(ne){pe(ne)}})}class Ft extends Error{constructor(pe,ne,ue){super(ne),this.code=pe,this.customData=ue,this.name="FirebaseError",Object.setPrototypeOf(this,Ft.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ot.prototype.create)}}class Ot{constructor(pe,ne,ue){this.service=pe,this.serviceName=ne,this.errors=ue}create(pe,...ne){const ue=ne[0]||{},ee=`${this.service}/${pe}`,Te=this.errors[pe],bt=Te?function _n(Ee,pe){return Ee.replace(Rn,(ne,ue)=>{const ee=pe[ue];return null!=ee?String(ee):`<${ue}?>`})}(Te,ue):"Error";return new Ft(ee,`${this.serviceName}: ${bt} (${ee}).`,ue)}}const Rn=/\{\$([^}]+)}/g;function pr(Ee,pe){return Object.prototype.hasOwnProperty.call(Ee,pe)}function lo(Ee){for(const pe in Ee)if(Object.prototype.hasOwnProperty.call(Ee,pe))return!1;return!0}function Lo(Ee,pe){if(Ee===pe)return!0;const ne=Object.keys(Ee),ue=Object.keys(pe);for(const ee of ne){if(!ue.includes(ee))return!1;const Te=Ee[ee],bt=pe[ee];if(hi(Te)&&hi(bt)){if(!Lo(Te,bt))return!1}else if(Te!==bt)return!1}for(const ee of ue)if(!ne.includes(ee))return!1;return!0}function hi(Ee){return null!==Ee&&"object"==typeof Ee}function bo(Ee){const pe=[];for(const[ne,ue]of Object.entries(Ee))Array.isArray(ue)?ue.forEach(ee=>{pe.push(encodeURIComponent(ne)+"="+encodeURIComponent(ee))}):pe.push(encodeURIComponent(ne)+"="+encodeURIComponent(ue));return pe.length?"&"+pe.join("&"):""}function Wo(Ee){const pe={};return Ee.replace(/^\?/,"").split("&").forEach(ue=>{if(ue){const[ee,Te]=ue.split("=");pe[decodeURIComponent(ee)]=decodeURIComponent(Te)}}),pe}function Jr(Ee){const pe=Ee.indexOf("?");if(!pe)return"";const ne=Ee.indexOf("#",pe);return Ee.substring(pe,ne>0?ne:void 0)}function fo(Ee,pe){const ne=new So(Ee,pe);return ne.subscribe.bind(ne)}class So{constructor(pe,ne){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=ne,this.task.then(()=>{pe(this)}).catch(ue=>{this.error(ue)})}next(pe){this.forEachObserver(ne=>{ne.next(pe)})}error(pe){this.forEachObserver(ne=>{ne.error(pe)}),this.close(pe)}complete(){this.forEachObserver(pe=>{pe.complete()}),this.close()}subscribe(pe,ne,ue){let ee;if(void 0===pe&&void 0===ne&&void 0===ue)throw new Error("Missing Observer.");ee=function co(Ee,pe){if("object"!=typeof Ee||null===Ee)return!1;for(const ne of pe)if(ne in Ee&&"function"==typeof Ee[ne])return!0;return!1}(pe,["next","error","complete"])?pe:{next:pe,error:ne,complete:ue},void 0===ee.next&&(ee.next=Bi),void 0===ee.error&&(ee.error=Bi),void 0===ee.complete&&(ee.complete=Bi);const Te=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?ee.error(this.finalError):ee.complete()}catch{}}),this.observers.push(ee),Te}unsubscribeOne(pe){void 0===this.observers||void 0===this.observers[pe]||(delete this.observers[pe],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(pe){if(!this.finalized)for(let ne=0;ne<this.observers.length;ne++)this.sendOne(ne,pe)}sendOne(pe,ne){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[pe])try{ne(this.observers[pe])}catch(ue){typeof console<"u"&&console.error&&console.error(ue)}})}close(pe){this.finalized||(this.finalized=!0,void 0!==pe&&(this.finalError=pe),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Bi(){}function tn(Ee){return Ee&&Ee._delegate?Ee._delegate:Ee}},4411:(kn,an,Ve)=>{"use strict";function W(n){return"function"==typeof n}function ie(n){const e=n(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const fe=ie(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function h(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class Me{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(W(i))try{i()}catch(o){t=o instanceof fe?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{se(o)}catch(l){t=t??[],l instanceof fe?t=[...t,...l.errors]:t.push(l)}}if(t)throw new fe(t)}}add(t){var e;if(t&&t!==this)if(this.closed)se(t);else{if(t instanceof Me){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&h(e,t)}remove(t){const{_finalizers:e}=this;e&&h(e,t),t instanceof Me&&t._removeParent(this)}}Me.EMPTY=(()=>{const n=new Me;return n.closed=!0,n})();const He=Me.EMPTY;function rt(n){return n instanceof Me||n&&"closed"in n&&W(n.remove)&&W(n.add)&&W(n.unsubscribe)}function se(n){W(n)?n():n.unsubscribe()}const ce={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},xe={setTimeout(n,t,...e){const{delegate:i}=xe;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=xe;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function ae(n){xe.setTimeout(()=>{const{onUnhandledError:t}=ce;if(!t)throw n;t(n)})}function he(){}const _e=Je("C",void 0,void 0);function Je(n,t,e){return{kind:n,value:t,error:e}}let tt=null;function Ie(n){if(ce.useDeprecatedSynchronousErrorHandling){const t=!tt;if(t&&(tt={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=tt;if(tt=null,e)throw i}}else n()}class mt extends Me{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,rt(t)&&t.add(this)):this.destination=Lt}static create(t,e,i){return new fn(t,e,i)}next(t){this.isStopped?pn(function $e(n){return Je("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?pn(function ke(n){return Je("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?pn(_e,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const at=Function.prototype.bind;function ze(n,t){return at.call(n,t)}class kt{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){xt(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){xt(i)}else xt(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){xt(e)}}}class fn extends mt{constructor(t,e,i){let r;if(super(),W(t)||!t)r={next:t??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&ce.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&ze(t.next,o),error:t.error&&ze(t.error,o),complete:t.complete&&ze(t.complete,o)}):r=t}this.destination=new kt(r)}}function xt(n){ce.useDeprecatedSynchronousErrorHandling?function Le(n){ce.useDeprecatedSynchronousErrorHandling&&tt&&(tt.errorThrown=!0,tt.error=n)}(n):ae(n)}function pn(n,t){const{onStoppedNotification:e}=ce;e&&xe.setTimeout(()=>e(n,t))}const Lt={closed:!0,next:he,error:function lt(n){throw n},complete:he},nn="function"==typeof Symbol&&Symbol.observable||"@@observable";function wn(n){return n}function Jn(n){return 0===n.length?wn:1===n.length?n[0]:function(e){return n.reduce((i,r)=>r(i),e)}}let Kt=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function Pe(n){return n&&n instanceof mt||function yi(n){return n&&W(n.next)&&W(n.error)&&W(n.complete)}(n)&&rt(n)}(e)?e:new fn(e,i,r);return Ie(()=>{const{operator:l,source:f}=this;o.add(l?l.call(o,f):f?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=Hn(i))((r,o)=>{const l=new fn({next:f=>{try{e(f)}catch(g){o(g),l.unsubscribe()}},error:o,complete:r});this.subscribe(l)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[nn](){return this}pipe(...e){return Jn(e)(this)}toPromise(e){return new(e=Hn(e))((i,r)=>{let o;this.subscribe(l=>o=l,l=>r(l),()=>i(o))})}}return n.create=t=>new n(t),n})();function Hn(n){var t;return null!==(t=n??ce.Promise)&&void 0!==t?t:Promise}const qe=ie(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Oe=(()=>{class n extends Kt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Ue(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new qe}next(e){Ie(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){Ie(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Ie(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?He:(this.currentObservers=null,o.push(e),new Me(()=>{this.currentObservers=null,h(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new Kt;return e.source=this,e}}return n.create=(t,e)=>new Ue(t,e),n})();class Ue extends Oe{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:He}}function Ft(n){return W(n?.lift)}function Ot(n){return t=>{if(Ft(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function _n(n,t,e,i,r){return new Rn(n,t,e,i,r)}class Rn extends mt{constructor(t,e,i,r,o,l){super(t),this.onFinalize=o,this.shouldUnsubscribe=l,this._next=e?function(f){try{e(f)}catch(g){t.error(g)}}:super._next,this._error=r?function(f){try{r(f)}catch(g){t.error(g)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(f){t.error(f)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function $t(n,t){return Ot((e,i)=>{let r=0;e.subscribe(_n(i,o=>{i.next(n.call(t,o,r++))}))})}var qn=Ve(7582);const bi=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function ur(n){return W(n?.then)}function ti(n){return W(n[nn])}function Ei(n){return Symbol.asyncIterator&&W(n?.[Symbol.asyncIterator])}function Vr(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const dr=function pr(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function lo(n){return W(n?.[dr])}function Fo(n){return(0,qn.FC)(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:i,done:r}=yield(0,qn.qq)(e.read());if(r)return yield(0,qn.qq)(void 0);yield yield(0,qn.qq)(i)}}finally{e.releaseLock()}})}function Lo(n){return W(n?.getReader)}function hi(n){if(n instanceof Kt)return n;if(null!=n){if(ti(n))return function Or(n){return new Kt(t=>{const e=n[nn]();if(W(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(bi(n))return function bo(n){return new Kt(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(ur(n))return function Wo(n){return new Kt(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,ae)})}(n);if(Ei(n))return Ir(n);if(lo(n))return function Jr(n){return new Kt(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(Lo(n))return function fo(n){return Ir(Fo(n))}(n)}throw Vr(n)}function Ir(n){return new Kt(t=>{(function So(n,t){var e,i,r,o;return(0,qn.mG)(this,void 0,void 0,function*(){try{for(e=(0,qn.KL)(n);!(i=yield e.next()).done;)if(t.next(i.value),t.closed)return}catch(l){r={error:l}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Mo(n,t,e,i=0,r=!1){const o=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Bi(n,t,e=1/0){return W(t)?Bi((i,r)=>$t((o,l)=>t(i,o,r,l))(hi(n(i,r))),e):("number"==typeof t&&(e=t),Ot((i,r)=>function co(n,t,e,i,r,o,l,f){const g=[];let b=0,S=0,O=!1;const $=()=>{O&&!g.length&&!b&&t.complete()},J=Ce=>b<i?ge(Ce):g.push(Ce),ge=Ce=>{o&&t.next(Ce),b++;let je=!1;hi(e(Ce,S++)).subscribe(_n(t,ft=>{r?.(ft),o?J(ft):t.next(ft)},()=>{je=!0},void 0,()=>{if(je)try{for(b--;g.length&&b<i;){const ft=g.shift();l?Mo(t,l,()=>ge(ft)):ge(ft)}$()}catch(ft){t.error(ft)}}))};return n.subscribe(_n(t,J,()=>{O=!0,$()})),()=>{f?.()}}(i,r,n,e)))}function qr(n=1/0){return Bi(wn,n)}const Sr=new Kt(n=>n.complete());function zr(n){return n&&W(n.schedule)}function Re(n){return n[n.length-1]}function te(n){return W(Re(n))?n.pop():void 0}function oe(n){return zr(Re(n))?n.pop():void 0}function Be(n,t=0){return Ot((e,i)=>{e.subscribe(_n(i,r=>Mo(i,n,()=>i.next(r),t),()=>Mo(i,n,()=>i.complete(),t),r=>Mo(i,n,()=>i.error(r),t)))})}function Qe(n,t=0){return Ot((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function tn(n,t){if(!n)throw new Error("Iterable cannot be null");return new Kt(e=>{Mo(e,t,()=>{const i=n[Symbol.asyncIterator]();Mo(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function ne(n,t){return t?function pe(n,t){if(null!=n){if(ti(n))return function ut(n,t){return hi(n).pipe(Qe(t),Be(t))}(n,t);if(bi(n))return function et(n,t){return new Kt(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}(n,t);if(ur(n))return function dt(n,t){return hi(n).pipe(Qe(t),Be(t))}(n,t);if(Ei(n))return tn(n,t);if(lo(n))return function Et(n,t){return new Kt(e=>{let i;return Mo(e,t,()=>{i=n[dr](),Mo(e,t,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(l){return void e.error(l)}o?e.complete():e.next(r)},0,!0)}),()=>W(i?.return)&&i.return()})}(n,t);if(Lo(n))return function Ee(n,t){return tn(Fo(n),t)}(n,t)}throw Vr(n)}(n,t):hi(n)}function ue(...n){const t=oe(n),e=function De(n,t){return"number"==typeof Re(n)?n.pop():t}(n,1/0),i=n;return i.length?1===i.length?hi(i[0]):qr(e)(ne(i,t)):Sr}class ee extends Oe{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function Te(...n){return ne(n,oe(n))}function bt(n={}){const{connector:t=(()=>new Oe),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return o=>{let l,f,g,b=0,S=!1,O=!1;const $=()=>{f?.unsubscribe(),f=void 0},J=()=>{$(),l=g=void 0,S=O=!1},ge=()=>{const Ce=l;J(),Ce?.unsubscribe()};return Ot((Ce,je)=>{b++,!O&&!S&&$();const ft=g=g??t();je.add(()=>{b--,0===b&&!O&&!S&&(f=En(ge,r))}),ft.subscribe(je),!l&&b>0&&(l=new fn({next:ot=>ft.next(ot),error:ot=>{O=!0,$(),f=En(J,e,ot),ft.error(ot)},complete:()=>{S=!0,$(),f=En(J,i),ft.complete()}}),hi(Ce).subscribe(l))})(o)}}function En(n,t,...e){if(!0===t)return void n();if(!1===t)return;const i=new fn({next:()=>{i.unsubscribe(),n()}});return hi(t(...e)).subscribe(i)}function bn(n,t){return Ot((e,i)=>{let r=null,o=0,l=!1;const f=()=>l&&!r&&i.complete();e.subscribe(_n(i,g=>{r?.unsubscribe();let b=0;const S=o++;hi(n(g,S)).subscribe(r=_n(i,O=>i.next(t?t(g,O,S,b++):O),()=>{r=null,f()}))},()=>{l=!0,f()}))})}function Xn(n,t=wn){return n=n??vi,Ot((e,i)=>{let r,o=!0;e.subscribe(_n(i,l=>{const f=t(l);(o||!n(r,f))&&(o=!1,r=f,i.next(l))}))})}function vi(n,t){return n===t}function Pn(n){for(let t in n)if(n[t]===Pn)return t;throw Error("Could not find renamed property on target object.")}function Li(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Un(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Un).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function po(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const Vc=Pn({__forward_ref__:Pn});function Tt(n){return n.__forward_ref__=Tt,n.toString=function(){return Un(this())},n}function Ke(n){return dn(n)?n():n}function dn(n){return"function"==typeof n&&n.hasOwnProperty(Vc)&&n.__forward_ref__===Tt}function jn(n){return n&&!!n.\u0275providers}const Zi="https://g.co/ng/security#xss";class gt extends Error{constructor(t,e){super(function xr(n,t){return`NG0${Math.abs(n)}${t?": "+t:""}`}(t,e)),this.code=t}}function Zn(n){return"string"==typeof n?n:null==n?"":String(n)}function Nt(n,t){throw new gt(-201,!1)}function li(n,t){null==n&&function ri(n,t,e,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${e} ${i} ${t} <=Actual]`))}(t,n,null,"!=")}function Wt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Ai(n){return{providers:n.providers||[],imports:n.imports||[]}}function dc(n){return oh(n,dl)||oh(n,kl)}function oh(n,t){return n.hasOwnProperty(t)?n[t]:null}function Pl(n){return n&&(n.hasOwnProperty(Au)||n.hasOwnProperty(Xs))?n[Au]:null}const dl=Pn({\u0275prov:Pn}),Au=Pn({\u0275inj:Pn}),kl=Pn({ngInjectableDef:Pn}),Xs=Pn({ngInjectorDef:Pn});var si=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(si||{});let fd;function Ur(n){const t=fd;return fd=n,t}function zs(n,t,e){const i=dc(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&si.Optional?null:void 0!==t?t:void Nt(Un(n))}const yr=globalThis,Eo={},Hc="__NG_DI_FLAG__",hl="ngTempTokenPath",gd=/\n/gm,_d="__source";let ha;function Ya(n){const t=ha;return ha=n,t}function lh(n,t=si.Default){if(void 0===ha)throw new gt(-203,!1);return null===ha?zs(n,void 0,t):ha.get(n,t&si.Optional?null:void 0,t)}function it(n,t=si.Default){return(function Su(){return fd}()||lh)(Ke(n),t)}function xn(n,t=si.Default){return it(n,or(t))}function or(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Rf(n){const t=[];for(let e=0;e<n.length;e++){const i=Ke(n[e]);if(Array.isArray(i)){if(0===i.length)throw new gt(900,!1);let r,o=si.Default;for(let l=0;l<i.length;l++){const f=i[l],g=Pg(f);"number"==typeof g?-1===g?r=f.token:o|=g:r=f}t.push(it(r,o))}else t.push(it(i))}return t}function Xa(n,t){return n[Hc]=t,n.prototype[Hc]=t,n}function Pg(n){return n[Hc]}function Ds(n){return{toString:n}.toString()}var fa=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(fa||{}),Us=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Us||{});const js={},Yi=[],pl=Pn({\u0275cmp:Pn}),Qa=Pn({\u0275dir:Pn}),ch=Pn({\u0275pipe:Pn}),Ol=Pn({\u0275mod:Pn}),Ja=Pn({\u0275fac:Pn}),hc=Pn({__NG_ELEMENT_ID__:Pn}),Gc=Pn({__NG_ENV_ID__:Pn});function As(n,t,e){let i=n.length;for(;;){const r=n.indexOf(t,e);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const o=t.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}e=r+1}}function ku(n,t,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const o=e[i++],l=e[i++],f=e[i++];n.setAttribute(t,l,f,o)}else{const o=r,l=e[++i];fc(o)?n.setProperty(t,o,l):n.setAttribute(t,o,l),i++}}return i}function tr(n){return 3===n||4===n||6===n}function fc(n){return 64===n.charCodeAt(0)}function Fl(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?e=r:0===e||xd(n,e,r,null,-1===e||2===e?t[++i]:null)}}return n}function xd(n,t,e,i,r){let o=0,l=n.length;if(-1===t)l=-1;else for(;o<n.length;){const f=n[o++];if("number"==typeof f){if(f===t){l=-1;break}if(f>t){l=o-1;break}}}for(;o<n.length;){const f=n[o];if("number"==typeof f)break;if(f===e){if(null===i)return void(null!==r&&(n[o+1]=r));if(i===n[o+1])return void(n[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==l&&(n.splice(l,0,t),o=l+1),n.splice(o++,0,e),null!==i&&n.splice(o++,0,i),null!==r&&n.splice(o++,0,r)}const uh="ng-template";function Wc(n,t,e){let i=0,r=!0;for(;i<n.length;){let o=n[i++];if("string"==typeof o&&r){const l=n[i++];if(e&&"class"===o&&-1!==As(l.toLowerCase(),t,0))return!0}else{if(1===o){for(;i<n.length&&"string"==typeof(o=n[i++]);)if(o.toLowerCase()===t)return!0;return!1}"number"==typeof o&&(r=!1)}}return!1}function Ru(n){return 4===n.type&&n.value!==uh}function Of(n,t,e){return t===(4!==n.type||e?n.value:uh)}function Ff(n,t,e){let i=4;const r=n.attrs||[],o=function Cd(n){for(let t=0;t<n.length;t++)if(tr(n[t]))return t;return n.length}(r);let l=!1;for(let f=0;f<t.length;f++){const g=t[f];if("number"!=typeof g){if(!l)if(4&i){if(i=2|1&i,""!==g&&!Of(n,g,e)||""===g&&1===t.length){if(Qs(i))return!1;l=!0}}else{const b=8&i?g:t[++f];if(8&i&&null!==n.attrs){if(!Wc(n.attrs,b,e)){if(Qs(i))return!1;l=!0}continue}const O=bd(8&i?"class":g,r,Ru(n),e);if(-1===O){if(Qs(i))return!1;l=!0;continue}if(""!==b){let $;$=O>o?"":r[O+1].toLowerCase();const J=8&i?$:null;if(J&&-1!==As(J,b,0)||2&i&&b!==$){if(Qs(i))return!1;l=!0}}}}else{if(!l&&!Qs(i)&&!Qs(g))return!1;if(l&&Qs(g))continue;l=!1,i=g|1&i}}return Qs(i)||l}function Qs(n){return 0==(1&n)}function bd(n,t,e,i){if(null===t)return-1;let r=0;if(i||!e){let o=!1;for(;r<t.length;){const l=t[r];if(l===n)return r;if(3===l||6===l)o=!0;else{if(1===l||2===l){let f=t[++r];for(;"string"==typeof f;)f=t[++r];continue}if(4===l)break;if(0===l){r+=4;continue}}r+=o?1:2}return-1}return function dh(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const i=n[e];if("number"==typeof i)return-1;if(i===t)return e;e++}return-1}(t,n)}function wd(n,t,e=!1){for(let i=0;i<t.length;i++)if(Ff(n,t[i],e))return!0;return!1}function Id(n,t){e:for(let e=0;e<t.length;e++){const i=t[e];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function hh(n,t){return n?":not("+t.trim()+")":t}function Ou(n){let t=n[0],e=1,i=2,r="",o=!1;for(;e<n.length;){let l=n[e];if("string"==typeof l)if(2&i){const f=n[++e];r+="["+l+(f.length>0?'="'+f+'"':"")+"]"}else 8&i?r+="."+l:4&i&&(r+=" "+l);else""!==r&&!Qs(l)&&(t+=hh(o,r),r=""),i=l,o=o||!Qs(i);e++}return""!==r&&(t+=hh(o,r)),t}function Wi(n){return Ds(()=>{const t=mh(n),e={...t,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===fa.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Us.Emulated,styles:n.styles||Yi,_:null,schemas:n.schemas||null,tView:null,id:""};gh(e);const i=n.dependencies;return e.directiveDefs=qc(i,!1),e.pipeDefs=qc(i,!0),e.id=function _h(n){let t=0;const e=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const r of e)t=Math.imul(31,t)+r.charCodeAt(0)<<0;return t+=2147483648,"c"+t}(e),e})}function Aa(n){return nr(n)||Co(n)}function ph(n){return null!==n}function qi(n){return Ds(()=>({type:n.type,bootstrap:n.bootstrap||Yi,declarations:n.declarations||Yi,imports:n.imports||Yi,exports:n.exports||Yi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Td(n,t){if(null==n)return js;const e={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=i,t&&(t[r]=o)}return e}function On(n){return Ds(()=>{const t=mh(n);return gh(t),t})}function ss(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function nr(n){return n[pl]||null}function Co(n){return n[Qa]||null}function qo(n){return n[ch]||null}function $s(n,t){const e=n[Ol]||null;if(!e&&!0===t)throw new Error(`Type ${Un(n)} does not have '\u0275mod' property.`);return e}function mh(n){const t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputTransforms:null,inputConfig:n.inputs||js,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Yi,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Td(n.inputs,t),outputs:Td(n.outputs)}}function gh(n){n.features?.forEach(t=>t(n))}function qc(n,t){if(!n)return null;const e=t?qo:Aa;return()=>("function"==typeof n?n():n).map(i=>e(i)).filter(ph)}const eo=0,Nn=1,Ci=2,Zr=3,el=4,Dd=5,as=6,Lu=7,Io=8,pa=9,tl=10,Ii=11,Nu=12,Sa=13,Nl=14,hr=15,Bl=16,Vl=17,Ss=18,Ma=19,Ad=20,ma=21,Vi=22,zl=23,Zc=24,ji=25,Ul=1,Bu=2,ls=7,jl=9,To=11;function xs(n){return Array.isArray(n)&&"object"==typeof n[Ul]}function cs(n){return Array.isArray(n)&&!0===n[Ul]}function gc(n){return 0!=(4&n.flags)}function gl(n){return n.componentOffset>-1}function Tn(n){return 1==(1&n.flags)}function Bo(n){return!!n.template}function Nf(n){return 0!=(512&n[Ci])}function _l(n,t){return n.hasOwnProperty(Ja)?n[Ja]:null}let us=null,vc=!1;function ga(n){const t=us;return us=n,t}const mo={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Od(n){if(!ws(n)||n.dirty){if(!n.producerMustRecompute(n)&&!_a(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function zf(n){n.dirty=!0,function bs(n){if(void 0===n.liveConsumerNode)return;const t=vc;vc=!0;try{for(const e of n.liveConsumerNode)e.dirty||zf(e)}finally{vc=t}}(n),n.consumerMarkedDirty?.(n)}function Uf(n){return n&&(n.nextProducerIndex=0),ga(n)}function Eh(n,t){if(ga(t),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(ws(n))for(let e=n.nextProducerIndex;e<n.producerNode.length;e++)ds(n.producerNode[e],n.producerIndexOfThis[e]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function _a(n){Pa(n);for(let t=0;t<n.producerNode.length;t++){const e=n.producerNode[t],i=n.producerLastReadVersion[t];if(i!==e.version||(Od(e),i!==e.version))return!0}return!1}function ju(n){if(Pa(n),ws(n))for(let t=0;t<n.producerNode.length;t++)ds(n.producerNode[t],n.producerIndexOfThis[t]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function ds(n,t){if(function Yc(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),Pa(n),1===n.liveConsumerNode.length)for(let i=0;i<n.producerNode.length;i++)ds(n.producerNode[i],n.producerIndexOfThis[i]);const e=n.liveConsumerNode.length-1;if(n.liveConsumerNode[t]=n.liveConsumerNode[e],n.liveConsumerIndexOfThis[t]=n.liveConsumerIndexOfThis[e],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,t<n.liveConsumerNode.length){const i=n.liveConsumerIndexOfThis[t],r=n.liveConsumerNode[t];Pa(r),r.producerIndexOfThis[i]=t}}function ws(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Pa(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let Ih=null;const p=()=>{},v=(()=>({...mo,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:p}))();class I{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function P(){return k}function k(n){return n.type.prototype.ngOnChanges&&(n.setInput=U),N}function N(){const n=q(this),t=n?.current;if(t){const e=n.previous;if(e===js)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function U(n,t,e,i){const r=this.declaredInputs[e],o=q(n)||function le(n,t){return n[z]=t}(n,{previous:js,current:null}),l=o.current||(o.current={}),f=o.previous,g=f[r];l[r]=new I(g&&g.currentValue,t,f===js),n[i]=t}P.ngInherit=!0;const z="__ngSimpleChanges__";function q(n){return n[z]||null}const ve=function(n,t,e){},we="svg";function de(n){for(;Array.isArray(n);)n=n[eo];return n}function Se(n,t){return de(t[n])}function Ge(n,t){return de(t[n.index])}function Xe(n,t){return n.data[t]}function ct(n,t){return n[t]}function st(n,t){const e=t[n];return xs(e)?e:e[eo]}function zt(n,t){return null==t?null:n[t]}function Dt(n){n[Vl]=0}function en(n){1024&n[Ci]||(n[Ci]|=1024,Ut(n,1))}function vt(n){1024&n[Ci]&&(n[Ci]&=-1025,Ut(n,-1))}function Ut(n,t){let e=n[Zr];if(null===e)return;e[Dd]+=t;let i=e;for(e=e[Zr];null!==e&&(1===t&&1===i[Dd]||-1===t&&0===i[Dd]);)e[Dd]+=t,i=e,e=e[Zr]}const Mt={lFrame:zg(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Si(){return Mt.bindingsEnabled}function Bn(){return null!==Mt.skipHydrationRootTNode}function qt(){return Mt.lFrame.lView}function Mi(){return Mt.lFrame.tView}function _i(n){return Mt.lFrame.contextLView=n,n[Io]}function Gn(n){return Mt.lFrame.contextLView=null,n}function Ti(){let n=sr();for(;null!==n&&64===n.type;)n=n.parent;return n}function sr(){return Mt.lFrame.currentTNode}function Kr(n,t){const e=Mt.lFrame;e.currentTNode=n,e.isParent=t}function Mr(){return Mt.lFrame.isParent}function hs(){Mt.lFrame.isParent=!1}function no(){const n=Mt.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function yl(){return Mt.lFrame.bindingIndex++}function Js(n){const t=Mt.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function tm(n,t){const e=Mt.lFrame;e.bindingIndex=e.bindingRootIndex=n,qf(t)}function qf(n){Mt.lFrame.currentDirectiveIndex=n}function Th(n){const t=Mt.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}function Zf(){return Mt.lFrame.currentQueryIndex}function Kf(n){Mt.lFrame.currentQueryIndex=n}function nm(n){const t=n[Nn];return 2===t.type?t.declTNode:1===t.type?n[as]:null}function Gl(n,t,e){if(e&si.SkipSelf){let r=t,o=n;for(;!(r=r.parent,null!==r||e&si.Host||(r=nm(o),null===r||(o=o[Nl],10&r.type))););if(null===r)return!1;t=r,n=o}const i=Mt.lFrame=Ah();return i.currentTNode=t,i.lView=n,!0}function Dh(n){const t=Ah(),e=n[Nn];Mt.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function Ah(){const n=Mt.lFrame,t=null===n?null:n.child;return null===t?zg(n):t}function zg(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function I0(){const n=Mt.lFrame;return Mt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const T0=I0;function Ug(){const n=I0();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function fs(){return Mt.lFrame.selectedIndex}function ya(n){Mt.lFrame.selectedIndex=n}function gr(){const n=Mt.lFrame;return Xe(n.tView,n.selectedIndex)}function Ec(){Mt.lFrame.currentNamespace=we}let $g=!0;function im(){return $g}function Jc(n){$g=n}function ka(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const o=n.data[e].type.prototype,{ngAfterContentInit:l,ngAfterContentChecked:f,ngAfterViewInit:g,ngAfterViewChecked:b,ngOnDestroy:S}=o;l&&(n.contentHooks??=[]).push(-e,l),f&&((n.contentHooks??=[]).push(e,f),(n.contentCheckHooks??=[]).push(e,f)),g&&(n.viewHooks??=[]).push(-e,g),b&&((n.viewHooks??=[]).push(e,b),(n.viewCheckHooks??=[]).push(e,b)),null!=S&&(n.destroyHooks??=[]).push(e,S)}}function rm(n,t,e){ei(n,t,3,e)}function Sh(n,t,e,i){(3&n[Ci])===e&&ei(n,t,e,i)}function io(n,t){let e=n[Ci];(3&e)===t&&(e&=8191,e+=1,n[Ci]=e)}function ei(n,t,e,i){const o=i??-1,l=t.length-1;let f=0;for(let g=void 0!==i?65535&n[Vl]:0;g<l;g++)if("number"==typeof t[g+1]){if(f=t[g],null!=i&&f>=i)break}else t[g]<0&&(n[Vl]+=65536),(f<o||-1==o)&&(om(n,e,t,g),n[Vl]=(4294901760&n[Vl])+g+2),g++}function Wl(n,t){ve(4,n,t);const e=ga(null);try{t.call(n)}finally{ga(e),ve(5,n,t)}}function om(n,t,e,i){const r=e[i]<0,o=e[i+1],f=n[r?-e[i]:e[i]];r?n[Ci]>>13<n[Vl]>>16&&(3&n[Ci])===t&&(n[Ci]+=8192,Wl(f,o)):Wl(f,o)}const ps=-1;class Mh{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function cm(n){return n!==ps}function kh(n){return 32767&n}function Nd(n,t){let e=function xx(n){return n>>16}(n),i=t;for(;e>0;)i=i[Nl],e--;return i}let um=!0;function eu(n){const t=um;return um=n,t}const tu=255,R=5;let C=0;const D={};function Y(n,t){const e=nt(n,t);if(-1!==e)return e;const i=t[Nn];i.firstCreatePass&&(n.injectorIndex=t.length,me(i.data,n),me(t,null),me(i.blueprint,null));const r=Pt(n,t),o=n.injectorIndex;if(cm(r)){const l=kh(r),f=Nd(r,t),g=f[Nn].data;for(let b=0;b<8;b++)t[o+b]=f[l+b]|g[l+b]}return t[o+8]=r,o}function me(n,t){n.push(0,0,0,0,0,0,0,0,t)}function nt(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Pt(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;null!==r;){if(i=M0(r),null===i)return ps;if(e++,r=r[Nl],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return ps}function hn(n,t,e){!function L(n,t,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(hc)&&(i=e[hc]),null==i&&(i=e[hc]=C++);const r=i&tu;t.data[n+(r>>R)]|=1<<r}(n,t,e)}function mi(n,t,e){if(e&si.Optional||void 0!==n)return n;Nt()}function ir(n,t,e,i){if(e&si.Optional&&void 0===i&&(i=null),!(e&(si.Self|si.Host))){const r=n[pa],o=Ur(void 0);try{return r?r.get(t,i,e&si.Optional):zs(t,i,e&si.Optional)}finally{Ur(o)}}return mi(i,0,e)}function go(n,t,e,i=si.Default,r){if(null!==n){if(2048&t[Ci]&&!(i&si.Self)){const l=function Jf(n,t,e,i,r){let o=n,l=t;for(;null!==o&&null!==l&&2048&l[Ci]&&!(512&l[Ci]);){const f=nu(o,l,e,i|si.Self,D);if(f!==D)return f;let g=o.parent;if(!g){const b=l[Ad];if(b){const S=b.get(e,D,i);if(S!==D)return S}g=M0(l),l=l[Nl]}o=g}return r}(n,t,e,i,D);if(l!==D)return l}const o=nu(n,t,e,i,D);if(o!==D)return o}return ir(t,e,i,r)}function nu(n,t,e,i,r){const o=function Zu(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(hc)?n[hc]:void 0;return"number"==typeof t?t>=0?t&tu:S0:t}(e);if("function"==typeof o){if(!Gl(t,n,i))return i&si.Host?mi(r,0,i):ir(t,e,i,r);try{let l;if(l=o(i),null!=l||i&si.Optional)return l;Nt()}finally{T0()}}else if("number"==typeof o){let l=null,f=nt(n,t),g=ps,b=i&si.Host?t[hr][as]:null;for((-1===f||i&si.SkipSelf)&&(g=-1===f?Pt(n,t):t[f+8],g!==ps&&Qf(i,!1)?(l=t[Nn],f=kh(g),t=Nd(g,t)):f=-1);-1!==f;){const S=t[Nn];if(hm(o,f,S.data)){const O=dm(f,t,e,l,i,b);if(O!==D)return O}g=t[f+8],g!==ps&&Qf(i,t[Nn].data[f+8]===b)&&hm(o,f,t)?(l=S,f=kh(g),t=Nd(g,t)):f=-1}}return r}function dm(n,t,e,i,r,o){const l=t[Nn],f=l.data[n+8],S=Rh(f,l,e,null==i?gl(f)&&um:i!=l&&0!=(3&f.type),r&si.Host&&o===f);return null!==S?Tc(t,l,S,f):D}function Rh(n,t,e,i,r){const o=n.providerIndexes,l=t.data,f=1048575&o,g=n.directiveStart,S=o>>20,$=r?f+S:n.directiveEnd;for(let J=i?f:f+S;J<$;J++){const ge=l[J];if(J<g&&e===ge||J>=g&&ge.type===e)return J}if(r){const J=l[g];if(J&&Bo(J)&&J.type===e)return g}return null}function Tc(n,t,e,i){let r=n[e];const o=t.data;if(function sm(n){return n instanceof Mh}(r)){const l=r;l.resolving&&function Wa(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new gt(-200,`Circular dependency in DI detected for ${n}${e}`)}(function Hi(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Zn(n)}(o[e]));const f=eu(l.canSeeViewProviders);l.resolving=!0;const b=l.injectImpl?Ur(l.injectImpl):null;Gl(n,i,si.Default);try{r=n[e]=l.factory(void 0,o,n,i),t.firstCreatePass&&e>=i.directiveStart&&function A0(n,t,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=t.type.prototype;if(i){const l=k(t);(e.preOrderHooks??=[]).push(n,l),(e.preOrderCheckHooks??=[]).push(n,l)}r&&(e.preOrderHooks??=[]).push(0-n,r),o&&((e.preOrderHooks??=[]).push(n,o),(e.preOrderCheckHooks??=[]).push(n,o))}(e,o[e],t)}finally{null!==b&&Ur(b),eu(f),l.resolving=!1,T0()}}return r}function hm(n,t,e){return!!(e[t+(n>>R)]&1<<n)}function Qf(n,t){return!(n&si.Self||n&si.Host&&t)}class Hs{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return go(this._tNode,this._lView,t,or(i),e)}}function S0(){return new Hs(Ti(),qt())}function ms(n){return Ds(()=>{const t=n.prototype.constructor,e=t[Ja]||Oh(t),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const o=r[Ja]||Oh(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function Oh(n){return dn(n)?()=>{const t=Oh(Ke(n));return t&&t()}:_l(n)}function M0(n){const t=n[Nn],e=t.type;return 2===e?t.declTNode:1===e?n[as]:null}function Fh(n){return function Dn(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const i=e.length;let r=0;for(;r<i;){const o=e[r];if(tr(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<i&&"string"==typeof e[r];)r++;else{if(o===t)return e[r+1];r+=2}}}return null}(Ti(),n)}const Es="__parameters__";function fm(n,t,e){return Ds(()=>{const i=function Dc(n){return function(...e){if(n){const i=n(...e);for(const r in i)this[r]=i[r]}}}(t);function r(...o){if(this instanceof r)return i.apply(this,o),this;const l=new r(...o);return f.annotation=l,f;function f(g,b,S){const O=g.hasOwnProperty(Es)?g[Es]:Object.defineProperty(g,Es,{value:[]})[Es];for(;O.length<=S;)O.push(null);return(O[S]=O[S]||[]).push(l),g}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}function ou(n,t){n.forEach(e=>Array.isArray(e)?ou(e,t):t(e))}function tp(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function Vh(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function zh(n,t){const e=[];for(let i=0;i<n;i++)e.push(t);return e}function ea(n,t,e){let i=Uh(n,t);return i>=0?n[1|i]=e:(i=~i,function Ex(n,t,e,i){let r=n.length;if(r==t)n.push(e,i);else if(1===r)n.push(i,n[0]),n[0]=e;else{for(r--,n.push(n[r-1],n[r]);r>t;)n[r]=n[r-2],r--;n[t]=e,n[t+1]=i}}(n,i,t,e)),i}function R0(n,t){const e=Uh(n,t);if(e>=0)return n[1|e]}function Uh(n,t){return function wE(n,t,e){let i=0,r=n.length>>e;for(;r!==i;){const o=i+(r-i>>1),l=n[o<<e];if(t===l)return o<<e;l>t?r=o:i=o+1}return~(r<<e)}(n,t,1)}const jr=Xa(fm("Optional"),8),Vd=Xa(fm("SkipSelf"),4);function B0(n){return 128==(128&n.flags)}var Zh=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Zh||{});const V0=new Map;let ip=0;const Jg="__ngContext__";function Ra(n,t){xs(t)?(n[Jg]=t[Ma],function DA(n){V0.set(n[Ma],n)}(t)):n[Jg]=t}let i_;function r_(n,t){return i_(n,t)}function o_(n){const t=n[Zr];return cs(t)?t[Zr]:t}function FE(n){return LE(n[Nu])}function j0(n){return LE(n[el])}function LE(n){for(;null!==n&&!cs(n);)n=n[el];return n}function Kh(n,t,e,i,r){if(null!=i){let o,l=!1;cs(i)?o=i:xs(i)&&(l=!0,i=i[eo]);const f=de(i);0===n&&null!==e?null==r?VE(t,e,f):rp(t,e,f,r||null,!0):1===n&&null!==e?rp(t,e,f,r||null,!0):2===n?function l_(n,t,e){const i=Z0(n,t);i&&function q0(n,t,e,i){n.removeChild(t,e,i)}(n,i,t,e)}(t,f,l):3===n&&t.destroyNode(f),null!=o&&function Q0(n,t,e,i,r){const o=e[ls];o!==de(e)&&Kh(t,n,i,o,r);for(let f=To;f<e.length;f++){const g=e[f];c_(g[Nn],g,n,t,i,o)}}(t,n,o,e,r)}}function $0(n,t,e){return n.createElement(t,e)}function $x(n,t){const e=n[jl],i=e.indexOf(t);vt(t),e.splice(i,1)}function zd(n,t){if(n.length<=To)return;const e=To+t,i=n[e];if(i){const r=i[Bl];null!==r&&r!==n&&$x(r,i),t>0&&(n[e-1][el]=i[el]);const o=Vh(n,To+t);!function MA(n,t){c_(n,t,t[Ii],2,null,null),t[eo]=null,t[as]=null}(i[Nn],i);const l=o[Ss];null!==l&&l.detachView(o[Nn]),i[Zr]=null,i[el]=null,i[Ci]&=-129}return i}function Hx(n,t){if(!(256&t[Ci])){const e=t[Ii];t[zl]&&ju(t[zl]),t[Zc]&&ju(t[Zc]),e.destroyNode&&c_(n,t,e,3,null,null),function RA(n){let t=n[Nu];if(!t)return Gx(n[Nn],n);for(;t;){let e=null;if(xs(t))e=t[Nu];else{const i=t[To];i&&(e=i)}if(!e){for(;t&&!t[el]&&t!==n;)xs(t)&&Gx(t[Nn],t),t=t[Zr];null===t&&(t=n),xs(t)&&Gx(t[Nn],t),e=t&&t[el]}t=e}}(t)}}function Gx(n,t){if(!(256&t[Ci])){t[Ci]&=-129,t[Ci]|=256,function NE(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let i=0;i<e.length;i+=2){const r=t[e[i]];if(!(r instanceof Mh)){const o=e[i+1];if(Array.isArray(o))for(let l=0;l<o.length;l+=2){const f=r[o[l]],g=o[l+1];ve(4,f,g);try{g.call(f)}finally{ve(5,f,g)}}else{ve(4,r,o);try{o.call(r)}finally{ve(5,r,o)}}}}}(n,t),function FA(n,t){const e=n.cleanup,i=t[Lu];if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const l=e[o+3];l>=0?i[l]():i[-l].unsubscribe(),o+=2}else e[o].call(i[e[o+1]]);null!==i&&(t[Lu]=null);const r=t[ma];if(null!==r){t[ma]=null;for(let o=0;o<r.length;o++)(0,r[o])()}}(n,t),1===t[Nn].type&&t[Ii].destroy();const e=t[Bl];if(null!==e&&cs(t[Zr])){e!==t[Zr]&&$x(e,t);const i=t[Ss];null!==i&&i.detachView(n)}!function AA(n){V0.delete(n[Ma])}(t)}}function G0(n,t,e){return function BE(n,t,e){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return e[eo];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:o}=n.data[i.directiveStart+r];if(o===Us.None||o===Us.Emulated)return null}return Ge(i,e)}}(n,t.parent,e)}function rp(n,t,e,i,r){n.insertBefore(t,e,i,r)}function VE(n,t,e){n.appendChild(t,e)}function W0(n,t,e,i,r){null!==i?rp(n,t,e,i,r):VE(n,t,e)}function Z0(n,t){return n.parentNode(t)}function vm(n,t,e){return qx(n,t,e)}let op,Yh,Qx,qx=function xm(n,t,e){return 40&n.type?Ge(n,e):null};function K0(n,t,e,i){const r=G0(n,i,t),o=t[Ii],f=vm(i.parent||t[as],i,t);if(null!=r)if(Array.isArray(e))for(let g=0;g<e.length;g++)W0(o,r,e[g],f,!1);else W0(o,r,e,f,!1);void 0!==op&&op(o,i,t,e,r)}function bm(n,t){if(null!==t){const e=t.type;if(3&e)return Ge(t,n);if(4&e)return Y0(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return bm(n,i);{const r=n[t.index];return cs(r)?Y0(-1,r):de(r)}}if(32&e)return r_(t,n)()||de(n[t.index]);{const i=Kx(n,t);return null!==i?Array.isArray(i)?i[0]:bm(o_(n[hr]),i):bm(n,t.next)}}return null}function Kx(n,t){return null!==t?n[hr][as].projection[t.projection]:null}function Y0(n,t){const e=To+n+1;if(e<t.length){const i=t[e],r=i[Nn].firstChild;if(null!==r)return bm(i,r)}return t[ls]}function X0(n,t,e,i,r,o,l){for(;null!=e;){const f=i[e.index],g=e.type;if(l&&0===t&&(f&&Ra(de(f),i),e.flags|=2),32!=(32&e.flags))if(8&g)X0(n,t,e.child,i,r,o,!1),Kh(t,n,r,f,o);else if(32&g){const b=r_(e,i);let S;for(;S=b();)Kh(t,n,r,S,o);Kh(t,n,r,f,o)}else 16&g?Xx(n,t,i,e,r,o):Kh(t,n,r,f,o);e=l?e.projectionNext:e.next}}function c_(n,t,e,i,r,o){X0(e,i,n.firstChild,t,r,o,!1)}function Xx(n,t,e,i,r,o){const l=e[hr],g=l[as].projection[i.projection];if(Array.isArray(g))for(let b=0;b<g.length;b++)Kh(t,n,r,g[b],o);else{let b=g;const S=l[Zr];B0(i)&&(b.flags|=128),X0(n,t,b,S,r,o,!0)}}function wm(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function sp(n,t,e){const{mergedAttrs:i,classes:r,styles:o}=e;null!==i&&ku(n,t,i),null!==r&&wm(n,t,r),null!==o&&function Oa(n,t,e){n.setAttribute(t,"style",e)}(n,t,o)}function ap(n){return function J0(){if(void 0===Yh&&(Yh=null,yr.trustedTypes))try{Yh=yr.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Yh}()?.createHTML(n)||n}class lp{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Zi})`}}class jA extends lp{getTypeName(){return"HTML"}}class $A extends lp{getTypeName(){return"Style"}}class HA extends lp{getTypeName(){return"Script"}}class jE extends lp{getTypeName(){return"URL"}}class GA extends lp{getTypeName(){return"ResourceURL"}}function $r(n){return n instanceof lp?n.changingThisBreaksApplicationSecurity:n}function Os(n,t){const e=function tb(n){return n instanceof lp&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${Zi})`)}return e===t}class ZA{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(ap(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class HE{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const e=this.inertDocument.createElement("template");return e.innerHTML=ap(t),e}}const WE=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Tr(n){return(n=String(n)).match(WE)?n:"unsafe:"+n}function au(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function Cm(...n){const t={};for(const e of n)for(const i in e)e.hasOwnProperty(i)&&(t[i]=!0);return t}const nb=au("area,br,col,hr,img,wbr"),Qu=au("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),cp=au("rp,rt"),ib=Cm(nb,Cm(Qu,au("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Cm(cp,au("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Cm(cp,Qu)),rb=au("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),qE=Cm(rb,au("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),au("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),YA=au("script,style,template");class XA{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!ib.hasOwnProperty(e))return this.sanitizedSomething=!0,!YA.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=t.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),l=o.name,f=l.toLowerCase();if(!qE.hasOwnProperty(f)){this.sanitizedSomething=!0;continue}let g=o.value;rb[f]&&(g=Tr(g)),this.buf.push(" ",l,'="',ob(g),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();ib.hasOwnProperty(e)&&!nb.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(ob(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const iy=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Im=/([^\#-~ |!])/g;function ob(n){return n.replace(/&/g,"&amp;").replace(iy,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(Im,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let up;function ry(n,t){let e=null;try{up=up||function $E(n){const t=new HE(n);return function GE(){try{return!!(new window.DOMParser).parseFromString(ap(""),"text/html")}catch{return!1}}()?new ZA(t):t}(n);let i=t?String(t):"";e=up.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=up.getInertBodyElement(i)}while(i!==o);return ap((new XA).sanitizeChildren(sb(e)||e))}finally{if(e){const i=sb(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function sb(n){return"content"in n&&function QA(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var va=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(va||{});function ia(n){const t=function h_(){const n=qt();return n&&n[tl].sanitizer}();return t?t.sanitize(va.URL,n)||"":Os(n,"URL")?$r(n):Tr(Zn(n))}class Xt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Wt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Tm=new Xt("ENVIRONMENT_INITIALIZER"),QE=new Xt("INJECTOR",-1),cb=new Xt("INJECTOR_DEF_TYPES");class sy{get(t,e=Eo){if(e===Eo){const i=new Error(`NullInjectorError: No provider for ${Un(t)}!`);throw i.name="NullInjectorError",i}return e}}function JE(...n){return{\u0275providers:eC(0,n),\u0275fromNgModule:!0}}function eC(n,...t){const e=[],i=new Set;let r;const o=l=>{e.push(l)};return ou(t,l=>{const f=l;Sc(f,o,[],i)&&(r||=[],r.push(f))}),void 0!==r&&ub(r,o),e}function ub(n,t){for(let e=0;e<n.length;e++){const{ngModule:i,providers:r}=n[e];ay(r,o=>{t(o,i)})}}function Sc(n,t,e,i){if(!(n=Ke(n)))return!1;let r=null,o=Pl(n);const l=!o&&nr(n);if(o||l){if(l&&!l.standalone)return!1;r=n}else{const g=n.ngModule;if(o=Pl(g),!o)return!1;r=g}const f=i.has(r);if(l){if(f)return!1;if(i.add(r),l.dependencies){const g="function"==typeof l.dependencies?l.dependencies():l.dependencies;for(const b of g)Sc(b,t,e,i)}}else{if(!o)return!1;{if(null!=o.imports&&!f){let b;i.add(r);try{ou(o.imports,S=>{Sc(S,t,e,i)&&(b||=[],b.push(S))})}finally{}void 0!==b&&ub(b,t)}if(!f){const b=_l(r)||(()=>new r);t({provide:r,useFactory:b,deps:Yi},r),t({provide:cb,useValue:r,multi:!0},r),t({provide:Tm,useValue:()=>it(r),multi:!0},r)}const g=o.providers;if(null!=g&&!f){const b=n;ay(g,S=>{t(S,b)})}}}return r!==n&&void 0!==n.providers}function ay(n,t){for(let e of n)jn(e)&&(e=e.\u0275providers),Array.isArray(e)?ay(e,t):t(e)}const tC=Pn({provide:String,useValue:Pn});function ly(n){return null!==n&&"object"==typeof n&&tC in n}function Xh(n){return"function"==typeof n}const hp=new Xt("Set Injector scope."),p_={},oC={};let Kl;function Dm(){return void 0===Kl&&(Kl=new sy),Kl}class ra{}class jd extends ra{get destroyed(){return this._destroyed}constructor(t,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,db(t,l=>this.processProvider(l)),this.records.set(QE,$d(void 0,this)),r.has("environment")&&this.records.set(ra,$d(void 0,this));const o=this.records.get(hp);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(cb.multi,Yi,si.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const e of t)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(t){return this.assertNotDestroyed(),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){this.assertNotDestroyed();const e=Ya(this),i=Ur(void 0);try{return t()}finally{Ya(e),Ur(i)}}get(t,e=Eo,i=si.Default){if(this.assertNotDestroyed(),t.hasOwnProperty(Gc))return t[Gc](this);i=or(i);const o=Ya(this),l=Ur(void 0);try{if(!(i&si.SkipSelf)){let g=this.records.get(t);if(void 0===g){const b=function nS(n){return"function"==typeof n||"object"==typeof n&&n instanceof Xt}(t)&&dc(t);g=b&&this.injectableDefInScope(b)?$d(cy(t),p_):null,this.records.set(t,g)}if(null!=g)return this.hydrate(t,g)}return(i&si.Self?Dm():this.parent).get(t,e=i&si.Optional&&e===Eo?null:e)}catch(f){if("NullInjectorError"===f.name){if((f[hl]=f[hl]||[]).unshift(Un(t)),o)throw f;return function vd(n,t,e,i){const r=n[hl];throw t[_d]&&r.unshift(t[_d]),n.message=function fl(n,t,e,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Un(t);if(Array.isArray(t))r=t.map(Un).join(" -> ");else if("object"==typeof t){let o=[];for(let l in t)if(t.hasOwnProperty(l)){let f=t[l];o.push(l+":"+("string"==typeof f?JSON.stringify(f):Un(f)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${n.replace(gd,"\n  ")}`}("\n"+n.message,r,e,i),n.ngTokenPath=r,n[hl]=null,n}(f,t,"R3InjectorError",this.source)}throw f}finally{Ur(l),Ya(o)}}resolveInjectorInitializers(){const t=Ya(this),e=Ur(void 0);try{const r=this.get(Tm.multi,Yi,si.Self);for(const o of r)o()}finally{Ya(t),Ur(e)}}toString(){const t=[],e=this.records;for(const i of e.keys())t.push(Un(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new gt(205,!1)}processProvider(t){let e=Xh(t=Ke(t))?t:Ke(t&&t.provide);const i=function sC(n){return ly(n)?$d(void 0,n.useValue):$d(m_(n),p_)}(t);if(Xh(t)||!0!==t.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=$d(void 0,p_,!0),r.factory=()=>Rf(r.multi),this.records.set(e,r)),e=t,r.multi.push(t)}this.records.set(e,i)}hydrate(t,e){return e.value===p_&&(e.value=oC,e.value=e.factory()),"object"==typeof e.value&&e.value&&function tS(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=Ke(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){const e=this._onDestroyHooks.indexOf(t);-1!==e&&this._onDestroyHooks.splice(e,1)}}function cy(n){const t=dc(n),e=null!==t?t.factory:_l(n);if(null!==e)return e;if(n instanceof Xt)throw new gt(204,!1);if(n instanceof Function)return function uy(n){const t=n.length;if(t>0)throw zh(t,"?"),new gt(204,!1);const e=function Uc(n){return n&&(n[dl]||n[kl])||null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new gt(204,!1)}function m_(n,t,e){let i;if(Xh(n)){const r=Ke(n);return _l(r)||cy(r)}if(ly(n))i=()=>Ke(n.useValue);else if(function iC(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Rf(n.deps||[]));else if(function nC(n){return!(!n||!n.useExisting)}(n))i=()=>it(Ke(n.useExisting));else{const r=Ke(n&&(n.useClass||n.provide));if(!function eS(n){return!!n.deps}(n))return _l(r)||cy(r);i=()=>new r(...Rf(n.deps))}return i}function $d(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function db(n,t){for(const e of n)Array.isArray(e)?db(e,t):e&&jn(e)?db(e.\u0275providers,t):t(e)}const dy=new Xt("AppId",{providedIn:"root",factory:()=>Am}),Am="ng",fp=new Xt("Platform Initializer"),bl=new Xt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Ju=new Xt("AnimationModuleType"),hb=new Xt("CSP nonce",{providedIn:"root",factory:()=>function Ud(){if(void 0!==Qx)return Qx;if(typeof document<"u")return document;throw new gt(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let lC=(n,t,e)=>null;function gb(n,t,e=!1){return lC(n,t,e)}class yy{}class __{}class tf{resolveComponentFactory(t){throw function aS(n){const t=Error(`No component factory found for ${Un(n)}.`);return t.ngComponent=n,t}(t)}}let Pm=(()=>{class n{static#e=this.NULL=new tf}return n})();function xb(){return _p(Ti(),qt())}function _p(n,t){return new fr(Ge(n,t))}let fr=(()=>{class n{constructor(e){this.nativeElement=e}static#e=this.__NG_ELEMENT_ID__=xb}return n})();function lS(n){return n instanceof fr?n.nativeElement:n}class y_{}let Hd=(()=>{class n{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function cS(){const n=qt(),e=st(Ti().index,n);return(xs(e)?e:n)[Ii]}()}return n})(),bb=(()=>{class n{static#e=this.\u0275prov=Wt({token:n,providedIn:"root",factory:()=>null})}return n})();class nf{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const yp=new nf("16.2.9"),wb={};function Eb(n,t=null,e=null,i){const r=Cb(n,t,e,i);return r.resolveInjectorInitializers(),r}function Cb(n,t=null,e=null,i,r=new Set){const o=[e||Yi,JE(n)];return i=i||("object"==typeof n?void 0:Un(n)),new jd(o,t||Dm(),i||null,r)}let Hr=(()=>{class n{static#e=this.THROW_IF_NOT_FOUND=Eo;static#t=this.NULL=new sy;static create(e,i){if(Array.isArray(e))return Eb({name:""},i,e,"");{const r=e.name??"";return Eb({name:r},e.parent,e.providers,r)}}static#n=this.\u0275prov=Wt({token:n,providedIn:"any",factory:()=>it(QE)});static#i=this.__NG_ELEMENT_ID__=-1}return n})();function wy(n){return n.ngOriginalError}class Xl{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&wy(t);for(;e&&wy(e);)e=wy(e);return e||null}}function ed(n){return t=>{setTimeout(n,void 0,t)}}const ui=class _C extends Oe{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let r=t,o=e||(()=>null),l=i;if(t&&"object"==typeof t){const g=t;r=g.next?.bind(g),o=g.error?.bind(g),l=g.complete?.bind(g)}this.__isAsync&&(o=ed(o),r&&(r=ed(r)),l&&(l=ed(l)));const f=super.subscribe({next:r,error:o,complete:l});return t instanceof Me&&t.add(f),f}};function yC(...n){}class wi{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ui(!1),this.onMicrotaskEmpty=new ui(!1),this.onStable=new ui(!1),this.onError=new ui(!1),typeof Zone>"u")throw new gt(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function fS(){const n="function"==typeof yr.requestAnimationFrame;let t=yr[n?"requestAnimationFrame":"setTimeout"],e=yr[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&t&&e){const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function td(n){const t=()=>{!function Tb(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(yr,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,x_(n),n.isCheckStableRunning=!0,v_(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),x_(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,l,f)=>{if(function b_(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(f))return e.invokeTask(r,o,l,f);try{return Cy(n),e.invokeTask(r,o,l,f)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&t(),Pc(n)}},onInvoke:(e,i,r,o,l,f,g)=>{try{return Cy(n),e.invoke(r,o,l,f,g)}finally{n.shouldCoalesceRunChangeDetection&&t(),Pc(n)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,x_(n),v_(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!wi.isInAngularZone())throw new gt(909,!1)}static assertNotInAngularZone(){if(wi.isInAngularZone())throw new gt(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){const o=this._inner,l=o.scheduleEventTask("NgZoneEvent: "+r,t,km,yC,yC);try{return o.runTask(l,e,i)}finally{o.cancelTask(l)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const km={};function v_(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function x_(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Cy(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Pc(n){n._nesting--,v_(n)}class vp{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ui,this.onMicrotaskEmpty=new ui,this.onStable=new ui,this.onError=new ui}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}}const Db=new Xt("",{providedIn:"root",factory:Ab});function Ab(){const n=xn(wi);let t=!0;return ue(new Kt(r=>{t=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{r.next(t),r.complete()})}),new Kt(r=>{let o;n.runOutsideAngular(()=>{o=n.onStable.subscribe(()=>{wi.assertNotInAngularZone(),queueMicrotask(()=>{!t&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(t=!0,r.next(!0))})})});const l=n.onUnstable.subscribe(()=>{wi.assertInAngularZone(),t&&(t=!1,n.runOutsideAngular(()=>{r.next(!1)}))});return()=>{o.unsubscribe(),l.unsubscribe()}}).pipe(bt()))}function nd(n){return n instanceof Function?n():n}let Dy=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#e=this.\u0275prov=Wt({token:n,providedIn:"root",factory:()=>new n})}return n})();function Om(n){for(;n;){n[Ci]|=64;const t=o_(n);if(Nf(n)&&!t)return n;n=t}return null}const Pb=new Xt("",{providedIn:"root",factory:()=>!1});let M=null;function B(n,t){return n[t]??Q()}function V(n,t){const e=Q();e.producerNode?.length&&(n[t]=M,e.lView=n,M=G())}const j={...mo,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Om(n.lView)},lView:null};function G(){return Object.create(j)}function Q(){return M??=G(),M}const re={};function X(n){Ne(Mi(),qt(),fs()+n,!1)}function Ne(n,t,e,i){if(!i)if(3==(3&t[Ci])){const o=n.preOrderCheckHooks;null!==o&&rm(t,o,e)}else{const o=n.preOrderHooks;null!==o&&Sh(t,o,0,e)}ya(e)}function H(n,t=si.Default){const e=qt();return null===e?it(n,t):go(Ti(),e,Ke(n),t)}function Fe(){throw new Error("invalid")}function We(n,t,e,i,r,o,l,f,g,b,S){const O=t.blueprint.slice();return O[eo]=r,O[Ci]=140|i,(null!==b||n&&2048&n[Ci])&&(O[Ci]|=2048),Dt(O),O[Zr]=O[Nl]=n,O[Io]=e,O[tl]=l||n&&n[tl],O[Ii]=f||n&&n[Ii],O[pa]=g||n&&n[pa]||null,O[as]=o,O[Ma]=function Qg(){return ip++}(),O[Vi]=S,O[Ad]=b,O[hr]=2==t.type?n[hr]:O,O}function wt(n,t,e,i,r){let o=n.data[t];if(null===o)o=function yt(n,t,e,i,r){const o=sr(),l=Mr(),g=n.data[t]=function ki(n,t,e,i,r,o){let l=t?t.injectorIndex:-1,f=0;return Bn()&&(f|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:l,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:f,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,l?o:o&&o.parent,e,t,i,r);return null===n.firstChild&&(n.firstChild=g),null!==o&&(l?null==o.child&&null!==g.parent&&(o.child=g):null===o.next&&(o.next=g,g.prev=o)),g}(n,t,e,i,r),function Wf(){return Mt.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const l=function to(){const n=Mt.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();o.injectorIndex=null===l?-1:l.injectorIndex}return Kr(o,!0),o}function Bt(n,t,e,i){if(0===e)return-1;const r=t.length;for(let o=0;o<e;o++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function ln(n,t,e,i,r){const o=B(t,zl),l=fs(),f=2&i;try{ya(-1),f&&t.length>ji&&Ne(n,t,ji,!1),ve(f?2:0,r);const b=f?o:null,S=Uf(b);try{null!==b&&(b.dirty=!1),e(i,r)}finally{Eh(b,S)}}finally{f&&null===t[zl]&&V(t,zl),ya(l),ve(f?3:1,r)}}function At(n,t,e){if(gc(t)){const i=ga(null);try{const o=t.directiveEnd;for(let l=t.directiveStart;l<o;l++){const f=n.data[l];f.contentQueries&&f.contentQueries(1,e[l],l)}}finally{ga(i)}}}function Ht(n,t,e){Si()&&(function Zo(n,t,e,i){const r=e.directiveStart,o=e.directiveEnd;gl(e)&&function Xo(n,t,e){const i=Ge(t,n),r=Qt(e);let l=16;e.signals?l=4096:e.onPush&&(l=64);const f=af(n,We(n,r,null,l,i,t,null,n[tl].rendererFactory.createRenderer(i,e),null,null,null));n[t.index]=f}(t,e,n.data[r+e.componentOffset]),n.firstCreatePass||Y(e,t),Ra(i,t);const l=e.initialInputs;for(let f=r;f<o;f++){const g=n.data[f],b=Tc(t,n,f,e);Ra(b,t),null!==l&&La(0,f-r,b,g,0,l),Bo(g)&&(st(e.index,t)[Io]=Tc(t,n,f,e))}}(n,t,e,Ge(e,t)),64==(64&e.flags)&&Rr(n,t,e))}function Gt(n,t,e=Ge){const i=t.localNames;if(null!==i){let r=t.index+1;for(let o=0;o<i.length;o+=2){const l=i[o+1],f=-1===l?e(t,n):n[l];n[r++]=f}}}function Qt(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=cn(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):t}function cn(n,t,e,i,r,o,l,f,g,b,S){const O=ji+i,$=O+r,J=function Vt(n,t){const e=[];for(let i=0;i<t;i++)e.push(i<n?null:re);return e}(O,$),ge="function"==typeof b?b():b;return J[Nn]={type:n,blueprint:J,template:e,queries:null,viewQuery:f,declTNode:t,data:J.slice().fill(null,O),bindingStartIndex:O,expandoStartIndex:$,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof l?l():l,firstChild:null,schemas:g,consts:ge,incompleteFirstPass:!1,ssrId:S}}let An=n=>null;function cr(n,t,e,i){for(let r in n)if(n.hasOwnProperty(r)){e=null===e?{}:e;const o=n[r];null===i?Di(e,t,r,o):i.hasOwnProperty(r)&&Di(e,t,i[r],o)}return e}function Di(n,t,e,i){n.hasOwnProperty(e)?n[e].push(t,i):n[e]=[t,i]}function ci(n,t,e,i,r,o,l,f){const g=Ge(t,e);let S,b=t.inputs;!f&&null!=b&&(S=b[i])?(kc(n,e,S,i,r),gl(t)&&function Fi(n,t){const e=st(t,n);16&e[Ci]||(e[Ci]|=64)}(e,t.index)):3&t.type&&(i=function Yr(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=l?l(r,t.value||"",i):r,o.setProperty(g,i,r))}function Pr(n,t,e,i){if(Si()){const r=null===i?null:{"":-1},o=function Ko(n,t){const e=n.directiveRegistry;let i=null,r=null;if(e)for(let o=0;o<e.length;o++){const l=e[o];if(wd(t,l.selectors,!1))if(i||(i=[]),Bo(l))if(null!==l.findHostDirectiveDefs){const f=[];r=r||new Map,l.findHostDirectiveDefs(l,f,r),i.unshift(...f,l),uo(n,t,f.length)}else i.unshift(l),uo(n,t,0);else r=r||new Map,l.findHostDirectiveDefs?.(l,i,r),i.push(l)}return null===i?null:[i,r]}(n,e);let l,f;null===o?l=f=null:[l,f]=o,null!==l&&kr(n,t,e,l,r,f),r&&function _r(n,t,e){if(t){const i=n.localNames=[];for(let r=0;r<t.length;r+=2){const o=e[t[r+1]];if(null==o)throw new gt(-301,!1);i.push(t[r],o)}}}(e,i,r)}e.mergedAttrs=Fl(e.mergedAttrs,e.attrs)}function kr(n,t,e,i,r,o){for(let b=0;b<i.length;b++)hn(Y(e,t),n,i[b].type);!function Gr(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}(e,n.data.length,i.length);for(let b=0;b<i.length;b++){const S=i[b];S.providersResolver&&S.providersResolver(S)}let l=!1,f=!1,g=Bt(n,t,i.length,null);for(let b=0;b<i.length;b++){const S=i[b];e.mergedAttrs=Fl(e.mergedAttrs,S.hostAttrs),Fa(n,e,t,g,S),Yo(g,S,r),null!==S.contentQueries&&(e.flags|=4),(null!==S.hostBindings||null!==S.hostAttrs||0!==S.hostVars)&&(e.flags|=64);const O=S.type.prototype;!l&&(O.ngOnChanges||O.ngOnInit||O.ngDoCheck)&&((n.preOrderHooks??=[]).push(e.index),l=!0),!f&&(O.ngOnChanges||O.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(e.index),f=!0),g++}!function di(n,t,e){const r=t.directiveEnd,o=n.data,l=t.attrs,f=[];let g=null,b=null;for(let S=t.directiveStart;S<r;S++){const O=o[S],$=e?e.get(O):null,ge=$?$.outputs:null;g=cr(O.inputs,S,g,$?$.inputs:null),b=cr(O.outputs,S,b,ge);const Ce=null===g||null===l||Ru(t)?null:hu(g,S,l);f.push(Ce)}null!==g&&(g.hasOwnProperty("class")&&(t.flags|=8),g.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=f,t.inputs=g,t.outputs=b}(n,e,o)}function Rr(n,t,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,l=function yx(){return Mt.lFrame.currentDirectiveIndex}();try{ya(o);for(let f=i;f<r;f++){const g=n.data[f],b=t[f];qf(f),(null!==g.hostBindings||0!==g.hostVars||null!==g.hostAttrs)&&gs(g,b)}}finally{ya(-1),qf(l)}}function gs(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function uo(n,t,e){t.componentOffset=e,(n.components??=[]).push(t.index)}function Yo(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;Bo(t)&&(e[""]=n)}}function Fa(n,t,e,i,r){n.data[i]=r;const o=r.factory||(r.factory=_l(r.type)),l=new Mh(o,Bo(r),H);n.blueprint[i]=l,e[i]=l,function _o(n,t,e,i,r){const o=r.hostBindings;if(o){let l=n.hostBindingOpCodes;null===l&&(l=n.hostBindingOpCodes=[]);const f=~t.index;(function ko(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(l)!=f&&l.push(f),l.push(e,i,o)}}(n,t,i,Bt(n,e,r.hostVars,re),r)}function ho(n,t,e,i,r,o){const l=Ge(n,t);!function _s(n,t,e,i,r,o,l){if(null==o)n.removeAttribute(t,r,e);else{const f=null==l?Zn(o):l(o,i||"",r);n.setAttribute(t,r,f,e)}}(t[Ii],l,o,n.value,e,i,r)}function La(n,t,e,i,r,o){const l=o[t];if(null!==l)for(let f=0;f<l.length;)Cs(i,e,l[f++],l[f++],l[f++])}function Cs(n,t,e,i,r){const o=ga(null);try{const l=n.inputTransforms;null!==l&&l.hasOwnProperty(i)&&(r=l[i].call(t,r)),null!==n.setInput?n.setInput(t,r,e,i):t[i]=r}finally{ga(o)}}function hu(n,t,e){let i=null,r=0;for(;r<e.length;){const o=e[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(n.hasOwnProperty(o)){null===i&&(i=[]);const l=n[o];for(let f=0;f<l.length;f+=2)if(l[f]===t){i.push(o,l[f+1],e[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function bp(n,t,e,i){return[n,!0,!1,t,null,0,i,e,null,null,null]}function Lm(n,t){const e=n.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const o=e[i+1];if(-1!==o){const l=n.data[o];Kf(e[i]),l.contentQueries(2,t[o],o)}}}function af(n,t){return n[Nu]?n[Sa][el]=t:n[Nu]=t,n[Sa]=t,t}function Sy(n,t,e){Kf(0);const i=ga(null);try{t(n,e)}finally{ga(i)}}function Rb(n){return n[Lu]||(n[Lu]=[])}function Ob(n){return n.cleanup||(n.cleanup=[])}function My(n,t,e){return(null===n||Bo(n))&&(e=function Ae(n){for(;Array.isArray(n);){if("object"==typeof n[Ul])return n;n=n[eo]}return null}(e[t.index])),e[Ii]}function Py(n,t){const e=n[pa],i=e?e.get(Xl,null):null;i&&i.handleError(t)}function kc(n,t,e,i,r){for(let o=0;o<e.length;){const l=e[o++],f=e[o++];Cs(n.data[l],t[l],i,f,r)}}function id(n,t,e){const i=Se(t,n);!function a_(n,t,e){n.setValue(t,e)}(n[Ii],i,e)}function wp(n,t){const e=st(t,n),i=e[Nn];!function Fb(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])}(i,e);const r=e[eo];null!==r&&null===e[Vi]&&(e[Vi]=gb(r,e[pa])),E_(i,e,e[Io])}function E_(n,t,e){Dh(t);try{const i=n.viewQuery;null!==i&&Sy(1,i,e);const r=n.template;null!==r&&ln(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Lm(n,t),n.staticViewQueries&&Sy(2,n.viewQuery,e);const o=n.components;null!==o&&function lf(n,t){for(let e=0;e<t.length;e++)wp(n,t[e])}(t,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[Ci]&=-5,Ug()}}let ky=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(e,i,r){const o=typeof Zone>"u"?null:Zone.current,l=function u(n,t,e){const i=Object.create(v);e&&(i.consumerAllowSignalWrites=!0),i.fn=n,i.schedule=t;const r=l=>{i.cleanupFn=l};return i.ref={notify:()=>zf(i),run:()=>{if(i.dirty=!1,i.hasRun&&!_a(i))return;i.hasRun=!0;const l=Uf(i);try{i.cleanupFn(),i.cleanupFn=p,i.fn(r)}finally{Eh(i,l)}},cleanup:()=>i.cleanupFn()},i.ref}(e,b=>{this.all.has(b)&&this.queue.set(b,o)},r);let f;this.all.add(l),l.notify();const g=()=>{l.cleanup(),f?.(),this.all.delete(l),this.queue.delete(l)};return f=i?.onDestroy(g),{destroy:g}}flush(){if(0!==this.queue.size)for(const[e,i]of this.queue)this.queue.delete(e),i?i.run(()=>e.run()):e.run()}get isQueueEmpty(){return 0===this.queue.size}static#e=this.\u0275prov=Wt({token:n,providedIn:"root",factory:()=>new n})}return n})();function xa(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,o=0;if(null!==t)for(let l=0;l<t.length;l++){const f=t[l];"number"==typeof f?o=f:1==o?r=po(r,f):2==o&&(i=po(i,f+": "+t[++l]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}function oa(n,t,e,i,r=!1){for(;null!==e;){const o=t[e.index];null!==o&&i.push(de(o)),cs(o)&&Nm(o,i);const l=e.type;if(8&l)oa(n,t,e.child,i);else if(32&l){const f=r_(e,t);let g;for(;g=f();)i.push(g)}else if(16&l){const f=Kx(t,e);if(Array.isArray(f))i.push(...f);else{const g=o_(t[hr]);oa(g[Nn],g,f,i,!0)}}e=r?e.projectionNext:e.next}return i}function Nm(n,t){for(let e=To;e<n.length;e++){const i=n[e],r=i[Nn].firstChild;null!==r&&oa(i[Nn],i,r,t)}n[ls]!==n[eo]&&t.push(n[ls])}function Bm(n,t,e,i=!0){const r=t[tl],o=r.rendererFactory,l=r.afterRenderEventManager;o.begin?.(),l?.begin();try{AF(n,t,n.template,e)}catch(g){throw i&&Py(t,g),g}finally{o.end?.(),r.effectManager?.flush(),l?.end()}}function AF(n,t,e,i){const r=t[Ci];if(256!=(256&r)){t[tl].effectManager?.flush(),Dh(t);try{Dt(t),function Hl(n){return Mt.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&ln(n,t,e,2,i);const l=3==(3&r);if(l){const b=n.preOrderCheckHooks;null!==b&&rm(t,b,null)}else{const b=n.preOrderHooks;null!==b&&Sh(t,b,0,null),io(t,0)}if(function E$(n){for(let t=FE(n);null!==t;t=j0(t)){if(!t[Bu])continue;const e=t[jl];for(let i=0;i<e.length;i++){en(e[i])}}}(t),SF(t,2),null!==n.contentQueries&&Lm(n,t),l){const b=n.contentCheckHooks;null!==b&&rm(t,b)}else{const b=n.contentHooks;null!==b&&Sh(t,b,1),io(t,1)}!function Ze(n,t){const e=n.hostBindingOpCodes;if(null===e)return;const i=B(t,Zc);try{for(let r=0;r<e.length;r++){const o=e[r];if(o<0)ya(~o);else{const l=o,f=e[++r],g=e[++r];tm(f,l),i.dirty=!1;const b=Uf(i);try{g(2,t[l])}finally{Eh(i,b)}}}}finally{null===t[Zc]&&V(t,Zc),ya(-1)}}(n,t);const f=n.components;null!==f&&PF(t,f,0);const g=n.viewQuery;if(null!==g&&Sy(2,g,i),l){const b=n.viewCheckHooks;null!==b&&rm(t,b)}else{const b=n.viewHooks;null!==b&&Sh(t,b,2),io(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[Ci]&=-73,vt(t)}finally{Ug()}}}function SF(n,t){for(let e=FE(n);null!==e;e=j0(e))for(let i=To;i<e.length;i++)MF(e[i],t)}function C$(n,t,e){MF(st(t,n),e)}function MF(n,t){if(!function rn(n){return 128==(128&n[Ci])}(n))return;const e=n[Nn],i=n[Ci];if(80&i&&0===t||1024&i||2===t)AF(e,n,e.template,n[Io]);else if(n[Dd]>0){SF(n,1);const r=e.components;null!==r&&PF(n,r,1)}}function PF(n,t,e){for(let i=0;i<t.length;i++)C$(n,t[i],e)}class Lb{get rootNodes(){const t=this._lView,e=t[Nn];return oa(e,t,e.firstChild,[])}constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Io]}set context(t){this._lView[Io]=t}get destroyed(){return 256==(256&this._lView[Ci])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[Zr];if(cs(t)){const e=t[8],i=e?e.indexOf(this):-1;i>-1&&(zd(t,i),Vh(e,i))}this._attachedToViewContainer=!1}Hx(this._lView[Nn],this._lView)}onDestroy(t){!function sn(n,t){if(256==(256&n[Ci]))throw new gt(911,!1);null===n[ma]&&(n[ma]=[]),n[ma].push(t)}(this._lView,t)}markForCheck(){Om(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ci]&=-129}reattach(){this._lView[Ci]|=128}detectChanges(){Bm(this._lView[Nn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new gt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function kA(n,t){c_(n,t,t[Ii],2,null,null)}(this._lView[Nn],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new gt(902,!1);this._appRef=t}}class I$ extends Lb{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Bm(t[Nn],t,t[Io],!1)}checkNoChanges(){}get context(){return null}}class kF extends Pm{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=nr(t);return new Nb(e,this.ngModule)}}function RF(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class D${constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){i=or(i);const r=this.injector.get(t,wb,i);return r!==wb||e===wb?r:this.parentInjector.get(t,e,i)}}class Nb extends __{get inputs(){const t=this.componentDef,e=t.inputTransforms,i=RF(t.inputs);if(null!==e)for(const r of i)e.hasOwnProperty(r.propName)&&(r.transform=e[r.propName]);return i}get outputs(){return RF(this.componentDef.outputs)}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function pc(n){return n.map(Ou).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}create(t,e,i,r){let o=(r=r||this.ngModule)instanceof ra?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const l=o?new D$(t,o):t,f=l.get(y_,null);if(null===f)throw new gt(407,!1);const O={rendererFactory:f,sanitizer:l.get(bb,null),effectManager:l.get(ky,null),afterRenderEventManager:l.get(Dy,null)},$=f.createRenderer(null,this.componentDef),J=this.componentDef.selectors[0][0]||"div",ge=i?function Cn(n,t,e,i){const o=i.get(Pb,!1)||e===Us.ShadowDom,l=n.selectRootElement(t,o);return function Vn(n){An(n)}(l),l}($,i,this.componentDef.encapsulation,l):$0($,J,function T$(n){const t=n.toLowerCase();return"svg"===t?we:"math"===t?"math":null}(J)),ft=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let ot=null;null!==ge&&(ot=gb(ge,l,!0));const It=cn(0,null,null,1,0,null,null,null,null,null,null),Yt=We(null,It,null,ft,null,null,O,$,l,null,ot);let yn,ai;Dh(Yt);try{const Ri=this.componentDef;let Qr,Ha=null;Ri.findHostDirectiveDefs?(Qr=[],Ha=new Map,Ri.findHostDirectiveDefs(Ri,Qr,Ha),Qr.push(Ri)):Qr=[Ri];const Bc=function S$(n,t){const e=n[Nn],i=ji;return n[i]=t,wt(e,i,2,"#host",null)}(Yt,ge),fA=function M$(n,t,e,i,r,o,l){const f=r[Nn];!function P$(n,t,e,i){for(const r of n)t.mergedAttrs=Fl(t.mergedAttrs,r.hostAttrs);null!==t.mergedAttrs&&(xa(t,t.mergedAttrs,!0),null!==e&&sp(i,e,t))}(i,n,t,l);let g=null;null!==t&&(g=gb(t,r[pa]));const b=o.rendererFactory.createRenderer(t,e);let S=16;e.signals?S=4096:e.onPush&&(S=64);const O=We(r,Qt(e),null,S,r[n.index],n,o,b,null,null,g);return f.firstCreatePass&&uo(f,n,i.length-1),af(r,O),r[n.index]=O}(Bc,ge,Ri,Qr,Yt,O,$);ai=Xe(It,ji),ge&&function R$(n,t,e,i){if(i)ku(n,e,["ng-version",yp.full]);else{const{attrs:r,classes:o}=function fh(n){const t=[],e=[];let i=1,r=2;for(;i<n.length;){let o=n[i];if("string"==typeof o)2===r?""!==o&&t.push(o,n[++i]):8===r&&e.push(o);else{if(!Qs(r))break;r=o}i++}return{attrs:t,classes:e}}(t.selectors[0]);r&&ku(n,e,r),o&&o.length>0&&wm(n,e,o.join(" "))}}($,Ri,ge,i),void 0!==e&&function O$(n,t,e){const i=n.projection=[];for(let r=0;r<t.length;r++){const o=e[r];i.push(null!=o?Array.from(o):null)}}(ai,this.ngContentSelectors,e),yn=function k$(n,t,e,i,r,o){const l=Ti(),f=r[Nn],g=Ge(l,r);kr(f,r,l,e,null,i);for(let S=0;S<e.length;S++)Ra(Tc(r,f,l.directiveStart+S,l),r);Rr(f,r,l),g&&Ra(g,r);const b=Tc(r,f,l.directiveStart+l.componentOffset,l);if(n[Io]=r[Io]=b,null!==o)for(const S of o)S(b,t);return At(f,l,n),b}(fA,Ri,Qr,Ha,Yt,[F$]),E_(It,Yt,null)}finally{Ug()}return new A$(this.componentType,yn,_p(ai,Yt),Yt,ai)}}class A$ extends yy{constructor(t,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new I$(r),this.componentType=t}setInput(t,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[t])){if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;const o=this._rootLView;kc(o[Nn],o,r,t,e),this.previousInputValues.set(t,e),Om(st(this._tNode.index,o))}}get injector(){return new Hs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function F$(){const n=Ti();ka(qt()[Nn],n)}function Qi(n){let t=function OF(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const i=[n];for(;t;){let r;if(Bo(n))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new gt(903,!1);r=t.\u0275dir}if(r){if(e){i.push(r);const l=n;l.inputs=wC(n.inputs),l.inputTransforms=wC(n.inputTransforms),l.declaredInputs=wC(n.declaredInputs),l.outputs=wC(n.outputs);const f=r.hostBindings;f&&V$(n,f);const g=r.viewQuery,b=r.contentQueries;if(g&&N$(n,g),b&&B$(n,b),Li(n.inputs,r.inputs),Li(n.declaredInputs,r.declaredInputs),Li(n.outputs,r.outputs),null!==r.inputTransforms&&(null===l.inputTransforms&&(l.inputTransforms={}),Li(l.inputTransforms,r.inputTransforms)),Bo(r)&&r.data.animation){const S=n.data;S.animation=(S.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let l=0;l<o.length;l++){const f=o[l];f&&f.ngInherit&&f(n),f===Qi&&(e=!1)}}t=Object.getPrototypeOf(t)}!function L$(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=t+=r.hostVars,r.hostAttrs=Fl(r.hostAttrs,e=Fl(e,r.hostAttrs))}}(i)}function wC(n){return n===js?{}:n===Yi?[]:n}function N$(n,t){const e=n.viewQuery;n.viewQuery=e?(i,r)=>{t(i,r),e(i,r)}:t}function B$(n,t){const e=n.contentQueries;n.contentQueries=e?(i,r,o)=>{t(i,r,o),e(i,r,o)}:t}function V$(n,t){const e=n.hostBindings;n.hostBindings=e?(i,r)=>{t(i,r),e(i,r)}:t}function EC(n){return!!yS(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function yS(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function cf(n,t,e){return n[t]=e}function wl(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function C_(n,t,e,i){const r=wl(n,t,e);return wl(n,t+1,i)||r}function ro(n,t,e,i){const r=qt();return wl(r,yl(),t)&&(Mi(),ho(gr(),r,n,t,e,i)),ro}function Fy(n,t,e,i,r,o){const f=C_(n,function ks(){return Mt.lFrame.bindingIndex}(),e,r);return Js(2),f?t+Zn(e)+i+Zn(r)+o:re}function Yn(n,t,e,i,r,o,l,f){const g=qt(),b=Mi(),S=n+ji,O=b.firstCreatePass?function uH(n,t,e,i,r,o,l,f,g){const b=t.consts,S=wt(t,n,4,l||null,zt(b,f));Pr(t,e,S,zt(b,g)),ka(t,S);const O=S.tView=cn(2,S,i,r,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,b,null);return null!==t.queries&&(t.queries.template(t,S),O.queries=t.queries.embeddedTView(S)),S}(S,b,g,t,e,i,r,o,l):b.data[S];Kr(O,!1);const $=XF(b,g,O,n);im()&&K0(b,g,$,O),Ra($,g),af(g,g[S]=bp($,g,$,O)),Tn(O)&&Ht(b,g,O),null!=l&&Gt(g,O,f)}let XF=function QF(n,t,e,i){return Jc(!0),t[Ii].createComment("")};function AC(n){return ct(function Hu(){return Mt.lFrame.contextLView}(),ji+n)}function un(n,t,e){const i=qt();return wl(i,yl(),t)&&ci(Mi(),gr(),i,n,t,i[Ii],e,!1),un}function CS(n,t,e,i,r){const l=r?"class":"style";kc(n,e,t.inputs[l],l,i)}function ht(n,t,e,i){const r=qt(),o=Mi(),l=ji+n,f=r[Ii],g=o.firstCreatePass?function pH(n,t,e,i,r,o){const l=t.consts,g=wt(t,n,2,i,zt(l,r));return Pr(t,e,g,zt(l,o)),null!==g.attrs&&xa(g,g.attrs,!1),null!==g.mergedAttrs&&xa(g,g.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,g),g}(l,o,r,t,e,i):o.data[l],b=JF(o,r,g,f,t,n);r[l]=b;const S=Tn(g);return Kr(g,!0),sp(f,b,g),32!=(32&g.flags)&&im()&&K0(o,r,b,g),0===function Ln(){return Mt.lFrame.elementDepthCount}()&&Ra(b,r),function oi(){Mt.lFrame.elementDepthCount++}(),S&&(Ht(o,r,g),At(o,g,r)),null!==i&&Gt(r,g),ht}function pt(){let n=Ti();Mr()?hs():(n=n.parent,Kr(n,!1));const t=n;(function mr(n){return Mt.skipHydrationRootTNode===n})(t)&&function Ps(){Mt.skipHydrationRootTNode=null}(),function Ni(){Mt.lFrame.elementDepthCount--}();const e=Mi();return e.firstCreatePass&&(ka(e,n),gc(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function Ph(n){return 0!=(8&n.flags)}(t)&&CS(e,t,qt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function Ic(n){return 0!=(16&n.flags)}(t)&&CS(e,t,qt(),t.stylesWithoutHost,!1),pt}function Ji(n,t,e,i){return ht(n,t,e,i),pt(),Ji}let JF=(n,t,e,i,r,o)=>(Jc(!0),$0(i,r,function D0(){return Mt.lFrame.currentNamespace}()));function Qo(){return qt()}function jb(n){return!!n&&"function"==typeof n.then}function nL(n){return!!n&&"function"==typeof n.subscribe}function Qn(n,t,e,i){const r=qt(),o=Mi(),l=Ti();return iL(o,r,r[Ii],l,n,t,i),Qn}function SC(n,t){const e=Ti(),i=qt(),r=Mi();return iL(r,i,My(Th(r.data),e,i),e,n,t),SC}function iL(n,t,e,i,r,o,l){const f=Tn(i),b=n.firstCreatePass&&Ob(n),S=t[Io],O=Rb(t);let $=!0;if(3&i.type||l){const Ce=Ge(i,t),je=l?l(Ce):Ce,ft=O.length,ot=l?Yt=>l(de(Yt[i.index])):i.index;let It=null;if(!l&&f&&(It=function xH(n,t,e,i){const r=n.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const l=r[o];if(l===e&&r[o+1]===i){const f=t[Lu],g=r[o+2];return f.length>g?f[g]:null}"string"==typeof l&&(o+=2)}return null}(n,t,r,i.index)),null!==It)(It.__ngLastListenerFn__||It).__ngNextListenerFn__=o,It.__ngLastListenerFn__=o,$=!1;else{o=oL(i,t,S,o,!1);const Yt=e.listen(je,r,o);O.push(o,Yt),b&&b.push(r,ot,ft,ft+1)}}else o=oL(i,t,S,o,!1);const J=i.outputs;let ge;if($&&null!==J&&(ge=J[r])){const Ce=ge.length;if(Ce)for(let je=0;je<Ce;je+=2){const yn=t[ge[je]][ge[je+1]].subscribe(o),ai=O.length;O.push(o,yn),b&&b.push(r,i.index,ai,-(ai+1))}}}function rL(n,t,e,i){try{return ve(6,t,e),!1!==e(i)}catch(r){return Py(n,r),!1}finally{ve(7,t,e)}}function oL(n,t,e,i,r){return function o(l){if(l===Function)return i;Om(n.componentOffset>-1?st(n.index,t):t);let g=rL(t,e,i,l),b=o.__ngNextListenerFn__;for(;b;)g=rL(t,e,b,l)&&g,b=b.__ngNextListenerFn__;return r&&!1===g&&l.preventDefault(),g}}function In(n=1){return function jg(n){return(Mt.lFrame.contextLView=function Yf(n,t){for(;n>0;)t=t[Nl],n--;return t}(n,Mt.lFrame.contextLView))[Io]}(n)}function bH(n,t){let e=null;const i=function Ed(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(!(1&e))return t[e+1]}return null}(n);for(let r=0;r<t.length;r++){const o=t[r];if("*"!==o){if(null===i?wd(n,o,!0):Id(i,o))return r}else e=r}return e}function uf(n){const t=qt()[hr][as];if(!t.projection){const i=t.projection=zh(n?n.length:1,null),r=i.slice();let o=t.child;for(;null!==o;){const l=n?bH(o,n):0;null!==l&&(r[l]?r[l].projectionNext=o:i[l]=o,r[l]=o),o=o.next}}}function il(n,t=0,e){const i=qt(),r=Mi(),o=wt(r,ji+n,16,null,e||null);null===o.projection&&(o.projection=t),hs(),(!i[Vi]||Bn())&&32!=(32&o.flags)&&function NA(n,t,e){Xx(t[Ii],0,t,e,G0(n,e,t),vm(e.parent||t[as],e,t))}(r,i,o)}function MC(n,t){return n<<17|t<<2}function Vm(n){return n>>17&32767}function AS(n){return 2|n}function I_(n){return(131068&n)>>2}function SS(n,t){return-131069&n|t<<2}function MS(n){return 1|n}function mL(n,t,e,i,r){const o=n[e+1],l=null===t;let f=i?Vm(o):I_(o),g=!1;for(;0!==f&&(!1===g||l);){const S=n[f+1];DH(n[f],t)&&(g=!0,n[f+1]=i?MS(S):AS(S)),f=i?Vm(S):I_(S)}g&&(n[e+1]=i?AS(o):MS(o))}function DH(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&Uh(n,t)>=0}function Cp(n,t,e){return Gd(n,t,e,!1),Cp}function zo(n,t){return Gd(n,t,null,!0),zo}function Gd(n,t,e,i){const r=qt(),o=Mi(),l=Js(2);o.firstUpdatePass&&function EL(n,t,e,i){const r=n.data;if(null===r[e+1]){const o=r[fs()],l=function wL(n,t){return t>=n.expandoStartIndex}(n,e);(function DL(n,t){return 0!=(n.flags&(t?8:16))})(o,i)&&null===t&&!l&&(t=!1),t=function LH(n,t,e,i){const r=Th(n);let o=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(e=$b(e=PS(null,n,t,e,i),t.attrs,i),o=null);else{const l=t.directiveStylingLast;if(-1===l||n[l]!==r)if(e=PS(r,n,t,e,i),null===o){let g=function NH(n,t,e){const i=e?t.classBindings:t.styleBindings;if(0!==I_(i))return n[Vm(i)]}(n,t,i);void 0!==g&&Array.isArray(g)&&(g=PS(null,n,t,g[1],i),g=$b(g,t.attrs,i),function BH(n,t,e,i){n[Vm(e?t.classBindings:t.styleBindings)]=i}(n,t,i,g))}else o=function VH(n,t,e){let i;const r=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<r;o++)i=$b(i,n[o].hostAttrs,e);return $b(i,t.attrs,e)}(n,t,i)}return void 0!==o&&(i?t.residualClasses=o:t.residualStyles=o),e}(r,o,t,i),function IH(n,t,e,i,r,o){let l=o?t.classBindings:t.styleBindings,f=Vm(l),g=I_(l);n[i]=e;let S,b=!1;if(Array.isArray(e)?(S=e[1],(null===S||Uh(e,S)>0)&&(b=!0)):S=e,r)if(0!==g){const $=Vm(n[f+1]);n[i+1]=MC($,f),0!==$&&(n[$+1]=SS(n[$+1],i)),n[f+1]=function EH(n,t){return 131071&n|t<<17}(n[f+1],i)}else n[i+1]=MC(f,0),0!==f&&(n[f+1]=SS(n[f+1],i)),f=i;else n[i+1]=MC(g,0),0===f?f=i:n[g+1]=SS(n[g+1],i),g=i;b&&(n[i+1]=AS(n[i+1])),mL(n,S,i,!0),mL(n,S,i,!1),function TH(n,t,e,i,r){const o=r?n.residualClasses:n.residualStyles;null!=o&&"string"==typeof t&&Uh(o,t)>=0&&(e[i+1]=MS(e[i+1]))}(t,S,n,i,o),l=MC(f,g),o?t.classBindings=l:t.styleBindings=l}(r,o,t,e,l,i)}}(o,n,l,i),t!==re&&wl(r,l,t)&&function IL(n,t,e,i,r,o,l,f){if(!(3&t.type))return;const g=n.data,b=g[f+1],S=function CH(n){return 1==(1&n)}(b)?TL(g,t,e,r,I_(b),l):void 0;PC(S)||(PC(o)||function wH(n){return 2==(2&n)}(b)&&(o=TL(g,null,e,r,f,l)),function zE(n,t,e,i,r){if(t)r?n.addClass(e,i):n.removeClass(e,i);else{let o=-1===i.indexOf("-")?void 0:Zh.DashCase;null==r?n.removeStyle(e,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Zh.Important),n.setStyle(e,i,r,o))}}(i,l,Se(fs(),e),r,o))}(o,o.data[fs()],r,r[Ii],n,r[l+1]=function $H(n,t){return null==n||""===n||("string"==typeof t?n+=t:"object"==typeof n&&(n=Un($r(n)))),n}(t,e),i,l)}function PS(n,t,e,i,r){let o=null;const l=e.directiveEnd;let f=e.directiveStylingLast;for(-1===f?f=e.directiveStart:f++;f<l&&(o=t[f],i=$b(i,o.hostAttrs,r),o!==n);)f++;return null!==n&&(e.directiveStylingLast=f),i}function $b(n,t,e){const i=e?1:2;let r=-1;if(null!==t)for(let o=0;o<t.length;o++){const l=t[o];"number"==typeof l?r=l:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ea(n,l,!!e||t[++o]))}return void 0===n?null:n}function TL(n,t,e,i,r,o){const l=null===t;let f;for(;r>0;){const g=n[r],b=Array.isArray(g),S=b?g[1]:g,O=null===S;let $=e[r+1];$===re&&($=O?Yi:void 0);let J=O?R0($,i):S===i?$:void 0;if(b&&!PC(J)&&(J=R0(g,i)),PC(J)&&(f=J,l))return f;const ge=n[r+1];r=l?Vm(ge):I_(ge)}if(null!==t){let g=o?t.residualClasses:t.residualStyles;null!=g&&(f=R0(g,i))}return f}function PC(n){return void 0!==n}function on(n,t=""){const e=qt(),i=Mi(),r=n+ji,o=i.firstCreatePass?wt(i,r,1,t,null):i.data[r],l=AL(i,e,o,t,n);e[r]=l,im()&&K0(i,e,l,o),Kr(o,!1)}let AL=(n,t,e,i,r)=>(Jc(!0),function ym(n,t){return n.createText(t)}(t[Ii],i));function Ro(n){return ys("",n,""),Ro}function ys(n,t,e){const i=qt(),r=function Oy(n,t,e,i){return wl(n,yl(),e)?t+Zn(e)+i:re}(i,n,t,e);return r!==re&&id(i,fs(),r),ys}function $y(n,t,e,i,r){const o=qt(),l=Fy(o,n,t,e,i,r);return l!==re&&id(o,fs(),l),$y}function Hy(n,t,e){const i=qt();return wl(i,yl(),t)&&ci(Mi(),gr(),i,n,t,i[Ii],e,!0),Hy}function kC(n,t,e){const i=qt();if(wl(i,yl(),t)){const o=Mi(),l=gr();ci(o,l,i,n,t,My(Th(o.data),l,i),e,!0)}return kC}const T_=void 0;var dG=["en",[["a","p"],["AM","PM"],T_],[["AM","PM"],T_,T_],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],T_,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],T_,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",T_,"{1} 'at' {0}",T_],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function uG(n){const e=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Gy={};function Ql(n){const t=function fG(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=WL(t);if(e)return e;const i=t.split("-")[0];if(e=WL(i),e)return e;if("en"===i)return dG;throw new gt(701,!1)}function WL(n){return n in Gy||(Gy[n]=yr.ng&&yr.ng.common&&yr.ng.common.locales&&yr.ng.common.locales[n]),Gy[n]}var Uo=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(Uo||{});const Wy="en-US";let qL=Wy;function OS(n,t,e,i,r){if(n=Ke(n),Array.isArray(n))for(let o=0;o<n.length;o++)OS(n[o],t,e,i,r);else{const o=Mi(),l=qt(),f=Ti();let g=Xh(n)?n:Ke(n.provide);const b=m_(n),S=1048575&f.providerIndexes,O=f.directiveStart,$=f.providerIndexes>>20;if(Xh(n)||!n.multi){const J=new Mh(b,r,H),ge=LS(g,t,r?S:S+$,O);-1===ge?(hn(Y(f,l),o,g),FS(o,n,t.length),t.push(g),f.directiveStart++,f.directiveEnd++,r&&(f.providerIndexes+=1048576),e.push(J),l.push(J)):(e[ge]=J,l[ge]=J)}else{const J=LS(g,t,S+$,O),ge=LS(g,t,S,S+$),je=ge>=0&&e[ge];if(r&&!je||!r&&!(J>=0&&e[J])){hn(Y(f,l),o,g);const ft=function dW(n,t,e,i,r){const o=new Mh(n,e,H);return o.multi=[],o.index=t,o.componentProviders=0,yN(o,r,i&&!e),o}(r?uW:cW,e.length,r,i,b);!r&&je&&(e[ge].providerFactory=ft),FS(o,n,t.length,0),t.push(g),f.directiveStart++,f.directiveEnd++,r&&(f.providerIndexes+=1048576),e.push(ft),l.push(ft)}else FS(o,n,J>-1?J:ge,yN(e[r?ge:J],b,!r&&i));!r&&i&&je&&e[ge].componentProviders++}}}function FS(n,t,e,i){const r=Xh(t),o=function rC(n){return!!n.useClass}(t);if(r||o){const g=(o?Ke(t.useClass):t).prototype.ngOnDestroy;if(g){const b=n.destroyHooks||(n.destroyHooks=[]);if(!r&&t.multi){const S=b.indexOf(e);-1===S?b.push(e,[i,g]):b[S+1].push(i,g)}else b.push(e,g)}}}function yN(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function LS(n,t,e,i){for(let r=e;r<i;r++)if(t[r]===n)return r;return-1}function cW(n,t,e,i){return NS(this.multi,[])}function uW(n,t,e,i){const r=this.multi;let o;if(this.providerFactory){const l=this.providerFactory.componentProviders,f=Tc(e,e[Nn],this.providerFactory.index,i);o=f.slice(0,l),NS(r,o);for(let g=l;g<f.length;g++)o.push(f[g])}else o=[],NS(r,o);return o}function NS(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function oo(n,t=[]){return e=>{e.providersResolver=(i,r)=>function lW(n,t,e){const i=Mi();if(i.firstCreatePass){const r=Bo(n);OS(e,i.data,i.blueprint,r,!0),OS(t,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,t)}}class D_{}class vN{}class BS extends D_{constructor(t,e,i){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new kF(this);const r=$s(t);this._bootstrapComponents=nd(r.bootstrap),this._r3Injector=Cb(t,e,[{provide:D_,useValue:this},{provide:Pm,useValue:this.componentFactoryResolver},...i],Un(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class VS extends vN{constructor(t){super(),this.moduleType=t}create(t){return new BS(this.moduleType,t,[])}}class xN extends D_{constructor(t){super(),this.componentFactoryResolver=new kF(this),this.instance=null;const e=new jd([...t.providers,{provide:D_,useValue:this},{provide:Pm,useValue:this.componentFactoryResolver}],t.parent||Dm(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function zS(n,t,e=null){return new xN({providers:n,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}let pW=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const i=eC(0,e.type),r=i.length>0?zS([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,r)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Wt({token:n,providedIn:"environment",factory:()=>new n(it(ra))})}return n})();function bN(n){n.getStandaloneInjector=t=>t.get(pW).getOrCreateStandaloneInjector(n)}function jS(n,t,e){const i=no()+n,r=qt();return r[i]===re?cf(r,i,e?t.call(e):t()):function Bb(n,t){return n[t]}(r,i)}function Kb(n,t,e,i){return SN(qt(),no(),n,t,e,i)}function AN(n,t,e,i,r,o,l){return function kN(n,t,e,i,r,o,l,f,g){const b=t+e;return function rd(n,t,e,i,r,o){const l=C_(n,t,e,i);return C_(n,t+2,r,o)||l}(n,b,r,o,l,f)?cf(n,b+4,g?i.call(g,r,o,l,f):i(r,o,l,f)):Yb(n,b+4)}(qt(),no(),n,t,e,i,r,o,l)}function Yb(n,t){const e=n[t];return e===re?void 0:e}function SN(n,t,e,i,r,o){const l=t+e;return wl(n,l,r)?cf(n,l+1,o?i.call(o,r):i(r)):Yb(n,l+1)}function fu(n,t){const e=Mi();let i;const r=n+ji;e.firstCreatePass?(i=function MW(n,t){if(t)for(let e=t.length-1;e>=0;e--){const i=t[e];if(n===i.name)return i}}(t,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??=[]).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=_l(i.type)),f=Ur(H);try{const g=eu(!1),b=o();return eu(g),function fH(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}(e,qt(),r,b),b}finally{Ur(f)}}function qy(n,t,e){const i=n+ji,r=qt(),o=ct(r,i);return Xb(r,i)?SN(r,no(),t,o.transform,e,o):o.transform(e)}function zm(n,t,e,i){const r=n+ji,o=qt(),l=ct(o,r);return Xb(o,r)?function MN(n,t,e,i,r,o,l){const f=t+e;return C_(n,f,r,o)?cf(n,f+2,l?i.call(l,r,o):i(r,o)):Yb(n,f+2)}(o,no(),t,l.transform,e,i,l):l.transform(e,i)}function Xb(n,t){return n[Nn].data[t].pure}function OW(){return this._results[Symbol.iterator]()}class $S{static#e=Symbol.iterator;get changes(){return this._changes||(this._changes=new ui)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=$S.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=OW)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const i=this;i.dirty=!1;const r=function vl(n){return n.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function P0(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=t[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function LW(n,t,e,i=!0){const r=t[Nn];if(function H0(n,t,e,i){const r=To+i,o=e.length;i>0&&(e[r-1][el]=t),i<o-To?(t[el]=e[r],tp(e,To+i,t)):(e.push(t),t[el]=null),t[Zr]=e;const l=t[Bl];null!==l&&e!==l&&function OA(n,t){const e=n[jl];t[hr]!==t[Zr][Zr][hr]&&(n[Bu]=!0),null===e?n[jl]=[t]:e.push(t)}(l,t);const f=t[Ss];null!==f&&f.insertView(n),t[Ci]|=128}(r,t,n,e),i){const o=Y0(e,n),l=t[Ii],f=Z0(l,n[ls]);null!==f&&function PA(n,t,e,i,r,o){i[eo]=r,i[as]=t,c_(n,i,e,1,r,o)}(r,n[as],l,t,f,o)}}let qd=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=VW}return n})();const NW=qd,BW=class extends NW{constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,e){return this.createEmbeddedViewImpl(t,e)}createEmbeddedViewImpl(t,e,i){const r=function FW(n,t,e,i){const r=t.tView,f=We(n,r,e,4096&n[Ci]?4096:16,null,t,null,null,null,i?.injector??null,i?.hydrationInfo??null);f[Bl]=n[t.index];const b=n[Ss];return null!==b&&(f[Ss]=b.createEmbeddedView(r)),E_(r,f,e),f}(this._declarationLView,this._declarationTContainer,t,{injector:e,hydrationInfo:i});return new Lb(r)}};function VW(){return NC(Ti(),qt())}function NC(n,t){return 4&n.type?new BW(t,n,_p(n,t)):null}let pu=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=GW}return n})();function GW(){return zN(Ti(),qt())}const WW=pu,BN=class extends WW{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return _p(this._hostTNode,this._hostLView)}get injector(){return new Hs(this._hostTNode,this._hostLView)}get parentInjector(){const t=Pt(this._hostTNode,this._hostLView);if(cm(t)){const e=Nd(t,this._hostLView),i=kh(t);return new Hs(e[Nn].data[i+8],e)}return new Hs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=VN(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-To}createEmbeddedView(t,e,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const f=t.createEmbeddedViewImpl(e||{},o,null);return this.insertImpl(f,r,false),f}createComponent(t,e,i,r,o){const l=t&&!function qg(n){return"function"==typeof n}(t);let f;if(l)f=e;else{const Ce=e||{};f=Ce.index,i=Ce.injector,r=Ce.projectableNodes,o=Ce.environmentInjector||Ce.ngModuleRef}const g=l?t:new Nb(nr(t)),b=i||this.parentInjector;if(!o&&null==g.ngModule){const je=(l?b:this.parentInjector).get(ra,null);je&&(o=je)}nr(g.componentType??{});const J=g.create(b,r,null,o);return this.insertImpl(J.hostView,f,false),J}insert(t,e){return this.insertImpl(t,e,!1)}insertImpl(t,e,i){const r=t._lView;if(function _t(n){return cs(n[Zr])}(r)){const g=this.indexOf(t);if(-1!==g)this.detach(g);else{const b=r[Zr],S=new BN(b,b[as],b[Zr]);S.detach(S.indexOf(t))}}const l=this._adjustIndex(e),f=this._lContainer;return LW(f,r,l,!i),t.attachToViewContainerRef(),tp(HS(f),l,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=VN(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=zd(this._lContainer,e);i&&(Vh(HS(this._lContainer),e),Hx(i[Nn],i))}detach(t){const e=this._adjustIndex(t,-1),i=zd(this._lContainer,e);return i&&null!=Vh(HS(this._lContainer),e)?new Lb(i):null}_adjustIndex(t,e=0){return t??this.length+e}};function VN(n){return n[8]}function HS(n){return n[8]||(n[8]=[])}function zN(n,t){let e;const i=t[n.index];return cs(i)?e=i:(e=bp(i,t,null,n),t[n.index]=e,af(t,e)),UN(e,t,n,i),new BN(e,n,t)}let UN=function jN(n,t,e,i){if(n[ls])return;let r;r=8&e.type?de(i):function qW(n,t){const e=n[Ii],i=e.createComment(""),r=Ge(t,n);return rp(e,Z0(e,r),i,function LA(n,t){return n.nextSibling(t)}(e,r),!1),i}(t,e),n[ls]=r};class GS{constructor(t){this.queryList=t,this.matches=null}clone(){return new GS(this.queryList)}setDirty(){this.queryList.setDirty()}}class WS{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const l=e.getByIndex(o);r.push(this.queries[l.indexInDeclarationView].clone())}return new WS(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==qN(t,e).matches&&this.queries[e].setDirty()}}class $N{constructor(t,e,i=null){this.predicate=t,this.flags=e,this.read=i}}class qS{constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(t,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new qS(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class ZS{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new ZS(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(t,e,YW(e,o)),this.matchTNodeWithReadOption(t,e,Rh(e,t,o,!1,!1))}else i===qd?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Rh(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===fr||r===pu||r===qd&&4&e.type)this.addMatch(e.index,-2);else{const o=Rh(e,t,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function YW(n,t){const e=n.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1];return null}function QW(n,t,e,i){return-1===e?function XW(n,t){return 11&n.type?_p(n,t):4&n.type?NC(n,t):null}(t,n):-2===e?function JW(n,t,e){return e===fr?_p(t,n):e===qd?NC(t,n):e===pu?zN(t,n):void 0}(n,t,i):Tc(n,n[Nn],e,t)}function HN(n,t,e,i){const r=t[Ss].queries[i];if(null===r.matches){const o=n.data,l=e.matches,f=[];for(let g=0;g<l.length;g+=2){const b=l[g];f.push(b<0?null:QW(t,o[b],l[g+1],e.metadata.read))}r.matches=f}return r.matches}function KS(n,t,e,i){const r=n.queries.getByIndex(e),o=r.matches;if(null!==o){const l=HN(n,t,r,e);for(let f=0;f<o.length;f+=2){const g=o[f];if(g>0)i.push(l[f/2]);else{const b=o[f+1],S=t[-g];for(let O=To;O<S.length;O++){const $=S[O];$[Bl]===$[Zr]&&KS($[Nn],$,b,i)}if(null!==S[jl]){const O=S[jl];for(let $=0;$<O.length;$++){const J=O[$];KS(J[Nn],J,b,i)}}}}}return i}function wa(n){const t=qt(),e=Mi(),i=Zf();Kf(i+1);const r=qN(e,i);if(n.dirty&&function Ct(n){return 4==(4&n[Ci])}(t)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const o=r.crossesNgTemplate?KS(e,t,i,[]):HN(e,t,r,i);n.reset(o,lS),n.notifyOnChanges()}return!0}return!1}function Jl(n,t,e){const i=Mi();i.firstCreatePass&&(WN(i,new $N(n,t,e),-1),2==(2&t)&&(i.staticViewQueries=!0)),GN(i,qt(),t)}function Qb(n,t,e,i){const r=Mi();if(r.firstCreatePass){const o=Ti();WN(r,new $N(t,e,i),o.index),function tq(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(r,n),2==(2&e)&&(r.staticContentQueries=!0)}GN(r,qt(),e)}function Ea(){return function eq(n,t){return n[Ss].queries[t].queryList}(qt(),Zf())}function GN(n,t,e){const i=new $S(4==(4&e));(function ni(n,t,e,i){const r=Rb(t);r.push(e),n.firstCreatePass&&Ob(n).push(i,r.length-1)})(n,t,i,i.destroy),null===t[Ss]&&(t[Ss]=new WS),t[Ss].queries.push(new GS(i))}function WN(n,t,e){null===n.queries&&(n.queries=new qS),n.queries.track(new ZS(t,e))}function qN(n,t){return n.queries.getByIndex(t)}function ZN(n,t){return NC(n,t)}const tM=new Xt("Application Initializer");let nM=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i}),this.appInits=xn(tM,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const r of this.appInits){const o=r();if(jb(o))e.push(o);else if(nL(o)){const l=new Promise((f,g)=>{o.subscribe({complete:f,error:g})});e.push(l)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),h3=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();const Zd=new Xt("LocaleId",{providedIn:"root",factory:()=>xn(Zd,si.Optional|si.SkipSelf)||function wq(){return typeof $localize<"u"&&$localize.locale||Wy}()});let zC=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new ee(!1)}add(){this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class Iq{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let f3=(()=>{class n{compileModuleSync(e){return new VS(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const i=this.compileModuleSync(e),o=nd($s(e).declarations).reduce((l,f)=>{const g=nr(f);return g&&l.push(new Nb(g)),l},[]);return new Iq(i,o)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const _3=new Xt(""),jC=new Xt("");let aM,oM=(()=>{class n{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,aM||(function Gq(n){aM=n}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{wi.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(l=>l.timeoutId!==o),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||n)(it(wi),it(sM),it(jC))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})(),sM=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return aM?.findTestabilityInTree(this,e,i)??null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),Um=null;const y3=new Xt("AllowMultipleToken"),lM=new Xt("PlatformDestroyListeners"),cM=new Xt("appBootstrapListener");class x3{constructor(t,e){this.name=t,this.token=e}}function w3(n,t,e=[]){const i=`Platform: ${t}`,r=new Xt(i);return(o=[])=>{let l=uM();if(!l||l.injector.get(y3,!1)){const f=[...e,...o,{provide:r,useValue:!0}];n?n(f):function Zq(n){if(Um&&!Um.get(y3,!1))throw new gt(400,!1);(function v3(){!function $f(n){Ih=n}(()=>{throw new gt(600,!1)})})(),Um=n;const t=n.get(C3);(function b3(n){n.get(fp,null)?.forEach(e=>e())})(n)}(function E3(n=[],t){return Hr.create({name:t,providers:[{provide:hp,useValue:"platform"},{provide:lM,useValue:new Set([()=>Um=null])},...n]})}(f,i))}return function Yq(n){const t=uM();if(!t)throw new gt(401,!1);return t}()}}function uM(){return Um?.get(C3)??null}let C3=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function Xq(n="zone.js",t){return"noop"===n?new vp:"zone.js"===n?new wi(t):n}(i?.ngZone,function I3(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const o=function fW(n,t,e){return new BS(n,t,e)}(e.moduleType,this.injector,function M3(n){return[{provide:wi,useFactory:n},{provide:Tm,multi:!0,useFactory:()=>{const t=xn(Jq,{optional:!0});return()=>t.initialize()}},{provide:S3,useFactory:Qq},{provide:Db,useFactory:Ab}]}(()=>r)),l=o.injector.get(Xl,null);return r.runOutsideAngular(()=>{const f=r.onError.subscribe({next:g=>{l.handleError(g)}});o.onDestroy(()=>{$C(this._modules,o),f.unsubscribe()})}),function T3(n,t,e){try{const i=e();return jb(i)?i.catch(r=>{throw t.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}(l,r,()=>{const f=o.injector.get(nM);return f.runInitializers(),f.donePromise.then(()=>(function ZL(n){li(n,"Expected localeId to be defined"),"string"==typeof n&&(qL=n.toLowerCase().replace(/_/g,"-"))}(o.injector.get(Zd,Wy)||Wy),this._moduleDoBootstrap(o),o))})})}bootstrapModule(e,i=[]){const r=D3({},i);return function Wq(n,t,e){const i=new VS(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(jm);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new gt(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new gt(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(lM,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||n)(it(Hr))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function D3(n,t){return Array.isArray(t)?t.reduce(D3,n):{...n,...t}}let jm=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=xn(S3),this.zoneIsStable=xn(Db),this.componentTypes=[],this.components=[],this.isStable=xn(zC).hasPendingTasks.pipe(bn(e=>e?Te(!1):this.zoneIsStable),Xn(),bt()),this._injector=xn(ra)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const r=e instanceof __;if(!this._injector.get(nM).done)throw!r&&function Ll(n){const t=nr(n)||Co(n)||qo(n);return null!==t&&t.standalone}(e),new gt(405,!1);let l;l=r?e:this._injector.get(Pm).resolveComponentFactory(e),this.componentTypes.push(l.componentType);const f=function qq(n){return n.isBoundToModule}(l)?void 0:this._injector.get(D_),b=l.create(Hr.NULL,[],i||l.selector,f),S=b.location.nativeElement,O=b.injector.get(_3,null);return O?.registerApplication(S),b.onDestroy(()=>{this.detachView(b.hostView),$C(this.components,b),O?.unregisterApplication(S)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new gt(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this.internalErrorHandler(e)}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;$C(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(cM,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>$C(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new gt(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function $C(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const S3=new Xt("",{providedIn:"root",factory:()=>xn(Xl).handleError.bind(void 0)});function Qq(){const n=xn(wi),t=xn(Xl);return e=>n.runOutsideAngular(()=>t.handleError(e))}let Jq=(()=>{class n{constructor(){this.zone=xn(wi),this.applicationRef=xn(jm)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();let mu=(()=>{class n{static#e=this.__NG_ELEMENT_ID__=tZ}return n})();function tZ(n){return function nZ(n,t,e){if(gl(n)&&!e){const i=st(n.index,t);return new Lb(i,i)}return 47&n.type?new Lb(t[hr],t):null}(Ti(),qt(),16==(16&n))}class F3{constructor(){}supports(t){return EC(t)}create(t){return new lZ(t)}}const aZ=(n,t)=>t;class lZ{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||aZ}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const l=!i||e&&e.currentIndex<N3(i,r,o)?e:i,f=N3(l,r,o),g=l.currentIndex;if(l===i)r--,i=i._nextRemoved;else if(e=e._next,null==l.previousIndex)r++;else{o||(o=[]);const b=f-r,S=g-r;if(b!=S){for(let $=0;$<b;$++){const J=$<o.length?o[$]:o[$]=0,ge=J+$;S<=ge&&ge<b&&(o[$]=J+1)}o[l.previousIndex]=S-b}}f!==g&&t(l,f,g)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!EC(t))throw new gt(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,o,l,e=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let f=0;f<this.length;f++)o=t[f],l=this._trackByFn(f,o),null!==e&&Object.is(e.trackById,l)?(i&&(e=this._verifyReinsertion(e,o,l,f)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,l,f),i=!0),e=e._next}else r=0,function W$(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Symbol.iterator]();let i;for(;!(i=e.next()).done;)t(i.value)}}(t,f=>{l=this._trackByFn(r,f),null!==e&&Object.is(e.trackById,l)?(i&&(e=this._verifyReinsertion(e,f,l,r)),Object.is(e.item,f)||this._addIdentityChange(e,f)):(e=this._mismatch(e,f,l,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,r){let o;return null===t?o=this._itTail:(o=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,o,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,o,r)):t=this._addAfter(new cZ(e,i),o,r),t}_verifyReinsertion(t,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?t=this._reinsertAfter(o,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,o=t._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new L3),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new L3),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class cZ{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class uZ{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class L3{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new uZ,this.map.set(e,i)),i.add(t)}get(t,e){const r=this.map.get(t);return r?r.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function N3(n,t,e){const i=n.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+t+r}class B3{constructor(){}supports(t){return t instanceof Map||yS(t)}create(){return new dZ}}class dZ{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||yS(t)))throw new gt(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,e);const o=r._prev,l=r._next;return o&&(o._next=l),l&&(l._prev=o),r._next=null,r._prev=null,r}const i=new hZ(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class hZ{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function V3(){return new WC([new F3])}let WC=(()=>{class n{static#e=this.\u0275prov=Wt({token:n,providedIn:"root",factory:V3});constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||V3()),deps:[[n,new Vd,new jr]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new gt(901,!1)}}return n})();function z3(){return new t1([new B3])}let t1=(()=>{class n{static#e=this.\u0275prov=Wt({token:n,providedIn:"root",factory:z3});constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||z3()),deps:[[n,new Vd,new jr]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(i)return i;throw new gt(901,!1)}}return n})();const mZ=w3(null,"core",[]);let gZ=(()=>{class n{constructor(e){}static#e=this.\u0275fac=function(i){return new(i||n)(it(jm))};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({})}return n})(),gM=null;function $m(){return gM}class MZ{}const rr=new Xt("DocumentToken");let _M=(()=>{class n{historyGo(e){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:function(){return xn(kZ)},providedIn:"platform"})}return n})();const PZ=new Xt("Location Initialized");let kZ=(()=>{class n extends _M{constructor(){super(),this._doc=xn(rr),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return $m().getBaseHref(this._doc)}onPopState(e){const i=$m().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){const i=$m().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,r){this._history.pushState(e,i,r)}replaceState(e,i,r){this._history.replaceState(e,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:function(){return new n},providedIn:"platform"})}return n})();function yM(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function K3(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function Ip(n){return n&&"?"!==n[0]?"?"+n:n}let S_=(()=>{class n{historyGo(e){throw new Error("Not implemented")}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:function(){return xn(X3)},providedIn:"root"})}return n})();const Y3=new Xt("appBaseHref");let X3=(()=>{class n extends S_{constructor(e,i){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??xn(rr).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return yM(this._baseHref,e)}path(e=!1){const i=this._platformLocation.pathname+Ip(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${i}${r}`:i}pushState(e,i,r,o){const l=this.prepareExternalUrl(r+Ip(o));this._platformLocation.pushState(e,i,l)}replaceState(e,i,r,o){const l=this.prepareExternalUrl(r+Ip(o));this._platformLocation.replaceState(e,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static#e=this.\u0275fac=function(i){return new(i||n)(it(_M),it(Y3,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),RZ=(()=>{class n extends S_{constructor(e,i){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(e){const i=yM(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,r,o){let l=this.prepareExternalUrl(r+Ip(o));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(e,i,l)}replaceState(e,i,r,o){let l=this.prepareExternalUrl(r+Ip(o));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(e,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static#e=this.\u0275fac=function(i){return new(i||n)(it(_M),it(Y3,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})(),n1=(()=>{class n{constructor(e){this._subject=new ui,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const i=this._locationStrategy.getBaseHref();this._basePath=function LZ(n){if(new RegExp("^(https?:)?//").test(n)){const[,e]=n.split(/\/\/[^\/]+/);return e}return n}(K3(Q3(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+Ip(i))}normalize(e){return n.stripTrailingSlash(function FZ(n,t){if(!n||!t.startsWith(n))return t;const e=t.substring(n.length);return""===e||["/",";","?","#"].includes(e[0])?e:t}(this._basePath,Q3(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",r=null){this._locationStrategy.pushState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ip(i)),r)}replaceState(e,i="",r=null){this._locationStrategy.replaceState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ip(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(r=>r(e,i))}subscribe(e,i,r){return this._subject.subscribe({next:e,error:i,complete:r})}static#e=this.normalizeQueryParams=Ip;static#t=this.joinWithSlash=yM;static#n=this.stripTrailingSlash=K3;static#i=this.\u0275fac=function(i){return new(i||n)(it(S_))};static#r=this.\u0275prov=Wt({token:n,factory:function(){return function OZ(){return new n1(it(S_))}()},providedIn:"root"})}return n})();function Q3(n){return n.replace(/\/index.html$/,"")}var ZC=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(ZC||{}),tc=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(tc||{}),Oo=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(Oo||{}),gu=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(gu||{}),Gs=function(n){return n[n.Decimal=0]="Decimal",n[n.Group=1]="Group",n[n.List=2]="List",n[n.PercentSign=3]="PercentSign",n[n.PlusSign=4]="PlusSign",n[n.MinusSign=5]="MinusSign",n[n.Exponential=6]="Exponential",n[n.SuperscriptingExponent=7]="SuperscriptingExponent",n[n.PerMille=8]="PerMille",n[n.Infinity=9]="Infinity",n[n.NaN=10]="NaN",n[n.TimeSeparator=11]="TimeSeparator",n[n.CurrencyDecimal=12]="CurrencyDecimal",n[n.CurrencyGroup=13]="CurrencyGroup",n}(Gs||{});function KC(n,t){return sd(Ql(n)[Uo.DateFormat],t)}function YC(n,t){return sd(Ql(n)[Uo.TimeFormat],t)}function XC(n,t){return sd(Ql(n)[Uo.DateTimeFormat],t)}function od(n,t){const e=Ql(n),i=e[Uo.NumberSymbols][t];if(typeof i>"u"){if(t===Gs.CurrencyDecimal)return e[Uo.NumberSymbols][Gs.Decimal];if(t===Gs.CurrencyGroup)return e[Uo.NumberSymbols][Gs.Group]}return i}function e4(n){if(!n[Uo.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Uo.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function sd(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function xM(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const YZ=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,r1={},XZ=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Tp=function(n){return n[n.Short=0]="Short",n[n.ShortGMT=1]="ShortGMT",n[n.Long=2]="Long",n[n.Extended=3]="Extended",n}(Tp||{}),so=function(n){return n[n.FullYear=0]="FullYear",n[n.Month=1]="Month",n[n.Date=2]="Date",n[n.Hours=3]="Hours",n[n.Minutes=4]="Minutes",n[n.Seconds=5]="Seconds",n[n.FractionalSeconds=6]="FractionalSeconds",n[n.Day=7]="Day",n}(so||{}),ao=function(n){return n[n.DayPeriods=0]="DayPeriods",n[n.Days=1]="Days",n[n.Months=2]="Months",n[n.Eras=3]="Eras",n}(ao||{});function t4(n,t,e,i){let r=function sK(n){if(o4(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,o=1,l=1]=n.split("-").map(f=>+f);return QC(r,o-1,l)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let i;if(i=n.match(YZ))return function aK(n){const t=new Date(0);let e=0,i=0;const r=n[8]?t.setUTCFullYear:t.setFullYear,o=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const l=Number(n[4]||0)-e,f=Number(n[5]||0)-i,g=Number(n[6]||0),b=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return o.call(t,l,f,g,b),t}(i)}const t=new Date(n);if(!o4(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=Dp(e,t)||t;let f,l=[];for(;t;){if(f=XZ.exec(t),!f){l.push(t);break}{l=l.concat(f.slice(1));const S=l.pop();if(!S)break;t=S}}let g=r.getTimezoneOffset();i&&(g=r4(i,g),r=function oK(n,t,e){const i=e?-1:1,r=n.getTimezoneOffset();return function rK(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,i*(r4(t,r)-r))}(r,i,!0));let b="";return l.forEach(S=>{const O=function iK(n){if(wM[n])return wM[n];let t;switch(n){case"G":case"GG":case"GGG":t=jo(ao.Eras,Oo.Abbreviated);break;case"GGGG":t=jo(ao.Eras,Oo.Wide);break;case"GGGGG":t=jo(ao.Eras,Oo.Narrow);break;case"y":t=sa(so.FullYear,1,0,!1,!0);break;case"yy":t=sa(so.FullYear,2,0,!0,!0);break;case"yyy":t=sa(so.FullYear,3,0,!1,!0);break;case"yyyy":t=sa(so.FullYear,4,0,!1,!0);break;case"Y":t=nI(1);break;case"YY":t=nI(2,!0);break;case"YYY":t=nI(3);break;case"YYYY":t=nI(4);break;case"M":case"L":t=sa(so.Month,1,1);break;case"MM":case"LL":t=sa(so.Month,2,1);break;case"MMM":t=jo(ao.Months,Oo.Abbreviated);break;case"MMMM":t=jo(ao.Months,Oo.Wide);break;case"MMMMM":t=jo(ao.Months,Oo.Narrow);break;case"LLL":t=jo(ao.Months,Oo.Abbreviated,tc.Standalone);break;case"LLLL":t=jo(ao.Months,Oo.Wide,tc.Standalone);break;case"LLLLL":t=jo(ao.Months,Oo.Narrow,tc.Standalone);break;case"w":t=bM(1);break;case"ww":t=bM(2);break;case"W":t=bM(1,!0);break;case"d":t=sa(so.Date,1);break;case"dd":t=sa(so.Date,2);break;case"c":case"cc":t=sa(so.Day,1);break;case"ccc":t=jo(ao.Days,Oo.Abbreviated,tc.Standalone);break;case"cccc":t=jo(ao.Days,Oo.Wide,tc.Standalone);break;case"ccccc":t=jo(ao.Days,Oo.Narrow,tc.Standalone);break;case"cccccc":t=jo(ao.Days,Oo.Short,tc.Standalone);break;case"E":case"EE":case"EEE":t=jo(ao.Days,Oo.Abbreviated);break;case"EEEE":t=jo(ao.Days,Oo.Wide);break;case"EEEEE":t=jo(ao.Days,Oo.Narrow);break;case"EEEEEE":t=jo(ao.Days,Oo.Short);break;case"a":case"aa":case"aaa":t=jo(ao.DayPeriods,Oo.Abbreviated);break;case"aaaa":t=jo(ao.DayPeriods,Oo.Wide);break;case"aaaaa":t=jo(ao.DayPeriods,Oo.Narrow);break;case"b":case"bb":case"bbb":t=jo(ao.DayPeriods,Oo.Abbreviated,tc.Standalone,!0);break;case"bbbb":t=jo(ao.DayPeriods,Oo.Wide,tc.Standalone,!0);break;case"bbbbb":t=jo(ao.DayPeriods,Oo.Narrow,tc.Standalone,!0);break;case"B":case"BB":case"BBB":t=jo(ao.DayPeriods,Oo.Abbreviated,tc.Format,!0);break;case"BBBB":t=jo(ao.DayPeriods,Oo.Wide,tc.Format,!0);break;case"BBBBB":t=jo(ao.DayPeriods,Oo.Narrow,tc.Format,!0);break;case"h":t=sa(so.Hours,1,-12);break;case"hh":t=sa(so.Hours,2,-12);break;case"H":t=sa(so.Hours,1);break;case"HH":t=sa(so.Hours,2);break;case"m":t=sa(so.Minutes,1);break;case"mm":t=sa(so.Minutes,2);break;case"s":t=sa(so.Seconds,1);break;case"ss":t=sa(so.Seconds,2);break;case"S":t=sa(so.FractionalSeconds,1);break;case"SS":t=sa(so.FractionalSeconds,2);break;case"SSS":t=sa(so.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=eI(Tp.Short);break;case"ZZZZZ":t=eI(Tp.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=eI(Tp.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=eI(Tp.Long);break;default:return null}return wM[n]=t,t}(S);b+=O?O(r,e,g):"''"===S?"'":S.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),b}function QC(n,t,e){const i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function Dp(n,t){const e=function BZ(n){return Ql(n)[Uo.LocaleId]}(n);if(r1[e]=r1[e]||{},r1[e][t])return r1[e][t];let i="";switch(t){case"shortDate":i=KC(n,gu.Short);break;case"mediumDate":i=KC(n,gu.Medium);break;case"longDate":i=KC(n,gu.Long);break;case"fullDate":i=KC(n,gu.Full);break;case"shortTime":i=YC(n,gu.Short);break;case"mediumTime":i=YC(n,gu.Medium);break;case"longTime":i=YC(n,gu.Long);break;case"fullTime":i=YC(n,gu.Full);break;case"short":const r=Dp(n,"shortTime"),o=Dp(n,"shortDate");i=JC(XC(n,gu.Short),[r,o]);break;case"medium":const l=Dp(n,"mediumTime"),f=Dp(n,"mediumDate");i=JC(XC(n,gu.Medium),[l,f]);break;case"long":const g=Dp(n,"longTime"),b=Dp(n,"longDate");i=JC(XC(n,gu.Long),[g,b]);break;case"full":const S=Dp(n,"fullTime"),O=Dp(n,"fullDate");i=JC(XC(n,gu.Full),[S,O])}return i&&(r1[e][t]=i),i}function JC(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return null!=t&&i in t?t[i]:e})),n}function Kd(n,t,e="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,o=e));let l=String(n);for(;l.length<t;)l="0"+l;return i&&(l=l.slice(l.length-t)),o+l}function sa(n,t,e=0,i=!1,r=!1){return function(o,l){let f=function JZ(n,t){switch(n){case so.FullYear:return t.getFullYear();case so.Month:return t.getMonth();case so.Date:return t.getDate();case so.Hours:return t.getHours();case so.Minutes:return t.getMinutes();case so.Seconds:return t.getSeconds();case so.FractionalSeconds:return t.getMilliseconds();case so.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,o);if((e>0||f>-e)&&(f+=e),n===so.Hours)0===f&&-12===e&&(f=12);else if(n===so.FractionalSeconds)return function QZ(n,t){return Kd(n,3).substring(0,t)}(f,t);const g=od(l,Gs.MinusSign);return Kd(f,t,g,i,r)}}function jo(n,t,e=tc.Format,i=!1){return function(r,o){return function eK(n,t,e,i,r,o){switch(e){case ao.Months:return function UZ(n,t,e){const i=Ql(n),o=sd([i[Uo.MonthsFormat],i[Uo.MonthsStandalone]],t);return sd(o,e)}(t,r,i)[n.getMonth()];case ao.Days:return function zZ(n,t,e){const i=Ql(n),o=sd([i[Uo.DaysFormat],i[Uo.DaysStandalone]],t);return sd(o,e)}(t,r,i)[n.getDay()];case ao.DayPeriods:const l=n.getHours(),f=n.getMinutes();if(o){const b=function GZ(n){const t=Ql(n);return e4(t),(t[Uo.ExtraData][2]||[]).map(i=>"string"==typeof i?xM(i):[xM(i[0]),xM(i[1])])}(t),S=function WZ(n,t,e){const i=Ql(n);e4(i);const o=sd([i[Uo.ExtraData][0],i[Uo.ExtraData][1]],t)||[];return sd(o,e)||[]}(t,r,i),O=b.findIndex($=>{if(Array.isArray($)){const[J,ge]=$,Ce=l>=J.hours&&f>=J.minutes,je=l<ge.hours||l===ge.hours&&f<ge.minutes;if(J.hours<ge.hours){if(Ce&&je)return!0}else if(Ce||je)return!0}else if($.hours===l&&$.minutes===f)return!0;return!1});if(-1!==O)return S[O]}return function VZ(n,t,e){const i=Ql(n),o=sd([i[Uo.DayPeriodsFormat],i[Uo.DayPeriodsStandalone]],t);return sd(o,e)}(t,r,i)[l<12?0:1];case ao.Eras:return function jZ(n,t){return sd(Ql(n)[Uo.Eras],t)}(t,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,n,t,e,i)}}function eI(n){return function(t,e,i){const r=-1*i,o=od(e,Gs.MinusSign),l=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case Tp.Short:return(r>=0?"+":"")+Kd(l,2,o)+Kd(Math.abs(r%60),2,o);case Tp.ShortGMT:return"GMT"+(r>=0?"+":"")+Kd(l,1,o);case Tp.Long:return"GMT"+(r>=0?"+":"")+Kd(l,2,o)+":"+Kd(Math.abs(r%60),2,o);case Tp.Extended:return 0===i?"Z":(r>=0?"+":"")+Kd(l,2,o)+":"+Kd(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${n}"`)}}}const tK=0,tI=4;function n4(n){return QC(n.getFullYear(),n.getMonth(),n.getDate()+(tI-n.getDay()))}function bM(n,t=!1){return function(e,i){let r;if(t){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,l=e.getDate();r=1+Math.floor((l+o)/7)}else{const o=n4(e),l=function nK(n){const t=QC(n,tK,1).getDay();return QC(n,0,1+(t<=tI?tI:tI+7)-t)}(o.getFullYear()),f=o.getTime()-l.getTime();r=1+Math.round(f/6048e5)}return Kd(r,n,od(i,Gs.MinusSign))}}function nI(n,t=!1){return function(e,i){return Kd(n4(e).getFullYear(),n,od(i,Gs.MinusSign),t)}}const wM={};function r4(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function o4(n){return n instanceof Date&&!isNaN(n.valueOf())}const lK=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function TM(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function c4(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(o)}return null}const AM=/\s+/,u4=[];let s1=(()=>{class n{constructor(e,i,r,o){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this.initialClasses=u4,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(AM):u4}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(AM):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,!!e[i]);this._applyStateDiff()}_updateState(e,i){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(AM).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||n)(H(WC),H(t1),H(fr),H(Hd))};static#t=this.\u0275dir=On({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return n})();class bK{constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ap=(()=>{class n{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,l)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new bK(r.item,this._ngForOf,-1,-1),null===l?void 0:l);else if(null==l)i.remove(null===o?void 0:o);else if(null!==o){const f=i.get(o);i.move(f,l),h4(f,r)}});for(let r=0,o=i.length;r<o;r++){const f=i.get(r).context;f.index=r,f.count=o,f.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{h4(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(H(pu),H(qd),H(WC))};static#t=this.\u0275dir=On({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return n})();function h4(n,t){n.context.$implicit=t.item}let Yd=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new wK,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){f4("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){f4("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||n)(H(pu),H(qd))};static#t=this.\u0275dir=On({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return n})();class wK{constructor(){this.$implicit=null,this.ngIf=null}}function f4(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Un(t)}'.`)}class SM{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let rI=(()=>{class n{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const i of this._defaultViews)i.enforceState(e)}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=On({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}return n})(),p4=(()=>{class n{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new SM(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static#e=this.\u0275fac=function(i){return new(i||n)(H(pu),H(qd),H(rI,9))};static#t=this.\u0275dir=On({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}return n})(),MM=(()=>{class n{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split("."),l=-1===r.indexOf("-")?void 0:Zh.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,l):this._renderer.removeStyle(this._ngEl.nativeElement,r,l)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(t1),H(Hd))};static#t=this.\u0275dir=On({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return n})();function Xd(n,t){return new gt(2100,!1)}const PK=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g;let PM=(()=>{class n{transform(e){if(null==e)return null;if("string"!=typeof e)throw Xd();return e.replace(PK,i=>i[0].toUpperCase()+i.slice(1).toLowerCase())}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275pipe=ss({name:"titlecase",type:n,pure:!0,standalone:!0})}return n})();const OK=new Xt("DATE_PIPE_DEFAULT_TIMEZONE"),FK=new Xt("DATE_PIPE_DEFAULT_OPTIONS");let oI=(()=>{class n{constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,o){if(null==e||""===e||e!=e)return null;try{return t4(e,i??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(l){throw Xd()}}static#e=this.\u0275fac=function(i){return new(i||n)(H(Zd,16),H(OK,24),H(FK,24))};static#t=this.\u0275pipe=ss({name:"date",type:n,pure:!0,standalone:!0})}return n})(),_4=(()=>{class n{constructor(e){this._locale=e}transform(e,i,r){if(!function kM(n){return!(null==n||""===n||n!=n)}(e))return null;r=r||this._locale;try{return function pK(n,t,e){return function CM(n,t,e,i,r,o,l=!1){let f="",g=!1;if(isFinite(n)){let b=function gK(n){let i,r,o,l,f,t=Math.abs(n)+"",e=0;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(o=t.search(/e/i))>0?(r<0&&(r=o),r+=+t.slice(o+1),t=t.substring(0,o)):r<0&&(r=t.length),o=0;"0"===t.charAt(o);o++);if(o===(f=t.length))i=[0],r=1;else{for(f--;"0"===t.charAt(f);)f--;for(r-=o,i=[],l=0;o<=f;o++,l++)i[l]=Number(t.charAt(o))}return r>22&&(i=i.splice(0,21),e=r-1,r=1),{digits:i,exponent:e,integerLen:r}}(n);l&&(b=function mK(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(b));let S=t.minInt,O=t.minFrac,$=t.maxFrac;if(o){const ot=o.match(lK);if(null===ot)throw new Error(`${o} is not a valid digit info`);const It=ot[1],Yt=ot[3],yn=ot[5];null!=It&&(S=TM(It)),null!=Yt&&(O=TM(Yt)),null!=yn?$=TM(yn):null!=Yt&&O>$&&($=O)}!function _K(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let i=n.digits,r=i.length-n.integerLen;const o=Math.min(Math.max(t,r),e);let l=o+n.integerLen,f=i[l];if(l>0){i.splice(Math.max(n.integerLen,l));for(let O=l;O<i.length;O++)i[O]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,l=o+1),i[0]=0;for(let O=1;O<l;O++)i[O]=0}if(f>=5)if(l-1<0){for(let O=0;O>l;O--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[l-1]++;for(;r<Math.max(0,o);r++)i.push(0);let g=0!==o;const b=t+n.integerLen,S=i.reduceRight(function(O,$,J,ge){return ge[J]=($+=O)<10?$:$-10,g&&(0===ge[J]&&J>=b?ge.pop():g=!1),$>=10?1:0},0);S&&(i.unshift(S),n.integerLen++)}(b,O,$);let J=b.digits,ge=b.integerLen;const Ce=b.exponent;let je=[];for(g=J.every(ot=>!ot);ge<S;ge++)J.unshift(0);for(;ge<0;ge++)J.unshift(0);ge>0?je=J.splice(ge,J.length):(je=J,J=[0]);const ft=[];for(J.length>=t.lgSize&&ft.unshift(J.splice(-t.lgSize,J.length).join(""));J.length>t.gSize;)ft.unshift(J.splice(-t.gSize,J.length).join(""));J.length&&ft.unshift(J.join("")),f=ft.join(od(e,i)),je.length&&(f+=od(e,r)+je.join("")),Ce&&(f+=od(e,Gs.Exponential)+"+"+Ce)}else f=od(e,Gs.Infinity);return f=n<0&&!g?t.negPre+f+t.negSuf:t.posPre+f+t.posSuf,f}(n,function IM(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(";"),r=i[0],o=i[1],l=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],f=l[0],g=l[1]||"";e.posPre=f.substring(0,f.indexOf("#"));for(let S=0;S<g.length;S++){const O=g.charAt(S);"0"===O?e.minFrac=e.maxFrac=S+1:"#"===O?e.maxFrac=S+1:e.posSuf+=O}const b=f.split(",");if(e.gSize=b[1]?b[1].length:0,e.lgSize=b[2]||b[1]?(b[2]||b[1]).length:0,o){const S=r.length-e.posPre.length-e.posSuf.length,O=o.indexOf("#");e.negPre=o.substring(0,O).replace(/'/g,""),e.negSuf=o.slice(O+S).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function vM(n,t){return Ql(n)[Uo.NumberFormats][t]}(t,ZC.Decimal),od(t,Gs.MinusSign)),t,Gs.Group,Gs.Decimal,e)}(function RM(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),r,i)}catch(o){throw Xd()}}static#e=this.\u0275fac=function(i){return new(i||n)(H(Zd,16))};static#t=this.\u0275pipe=ss({name:"number",type:n,pure:!0,standalone:!0})}return n})();let a1=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({})}return n})();const y4="browser";function sI(n){return"server"===n}let ZK=(()=>{class n{static#e=this.\u0275prov=Wt({token:n,providedIn:"root",factory:()=>new KK(it(rr),window)})}return n})();class KK{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function YK(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const o=r.shadowRoot;if(o){const l=o.getElementById(t)||o.querySelector(`[name="${t}"]`);if(l)return l}r=i.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){this.supportsScrolling()&&(this.window.history.scrollRestoration=t)}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(i-o[0],r-o[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class v4{}class vY extends MZ{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class LM extends vY{static makeCurrent(){!function SZ(n){gM||(gM=n)}(new LM)}onAndCancel(t,e,i){return t.addEventListener(e,i),()=>{t.removeEventListener(e,i)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function xY(){return c1=c1||document.querySelector("base"),c1?c1.getAttribute("href"):null}();return null==e?null:function bY(n){cI=cI||document.createElement("a"),cI.setAttribute("href",n);const t=cI.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){c1=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return c4(document.cookie,t)}}let cI,c1=null,EY=(()=>{class n{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const NM=new Xt("EventManagerPlugins");let C4=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(o=>o.supports(e)),!i)throw new gt(5101,!1);return this._eventNameToPlugin.set(e,i),i}static#e=this.\u0275fac=function(i){return new(i||n)(it(NM),it(wi))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();class I4{constructor(t){this._doc=t}}const BM="ng-app-id";let T4=(()=>{class n{constructor(e,i,r,o={}){this.doc=e,this.appId=i,this.nonce=r,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=sI(o),this.resetHostNodes()}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(i=>i.remove()),e.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.elements?.forEach(r=>r.remove()),i.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${BM}="${this.appId}"]`);if(e?.length){const i=new Map;return e.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(e,i){const r=this.styleRef;if(r.has(e)){const o=r.get(e);return o.usage+=i,o.usage}return r.set(e,{usage:i,elements:[]}),i}getStyleElement(e,i){const r=this.styleNodesInDOM,o=r?.get(i);if(o?.parentNode===e)return r.delete(i),o.removeAttribute(BM),o;{const l=this.doc.createElement("style");return this.nonce&&l.setAttribute("nonce",this.nonce),l.textContent=i,this.platformIsServer&&l.setAttribute(BM,this.appId),l}}addStyleToHost(e,i){const r=this.getStyleElement(e,i);e.appendChild(r);const o=this.styleRef,l=o.get(i)?.elements;l?l.push(r):o.set(i,{elements:[r],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr),it(dy),it(hb,8),it(bl))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const VM={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},zM=/%COMP%/g,DY=new Xt("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function A4(n,t){return t.map(e=>e.replace(zM,n))}let UM=(()=>{class n{constructor(e,i,r,o,l,f,g,b=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=l,this.platformId=f,this.ngZone=g,this.nonce=b,this.rendererByCompId=new Map,this.platformIsServer=sI(f),this.defaultRenderer=new jM(e,l,g,this.platformIsServer)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Us.ShadowDom&&(i={...i,encapsulation:Us.Emulated});const r=this.getOrCreateRenderer(e,i);return r instanceof M4?r.applyToHost(e):r instanceof $M&&r.applyStyles(),r}getOrCreateRenderer(e,i){const r=this.rendererByCompId;let o=r.get(i.id);if(!o){const l=this.doc,f=this.ngZone,g=this.eventManager,b=this.sharedStylesHost,S=this.removeStylesOnCompDestroy,O=this.platformIsServer;switch(i.encapsulation){case Us.Emulated:o=new M4(g,b,i,this.appId,S,l,f,O);break;case Us.ShadowDom:return new PY(g,b,e,i,l,f,this.nonce,O);default:o=new $M(g,b,i,S,l,f,O)}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||n)(it(C4),it(T4),it(dy),it(DY),it(rr),it(bl),it(wi),it(hb))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();class jM{constructor(t,e,i,r){this.eventManager=t,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?this.doc.createElementNS(VM[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(S4(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(S4(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?this.doc.querySelector(t):t;if(!i)throw new gt(-5104,!1);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;const o=VM[r];o?t.setAttributeNS(o,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const r=VM[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(Zh.DashCase|Zh.Important)?t.style.setProperty(e,i,r&Zh.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&Zh.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){if("string"==typeof t&&!(t=$m().getGlobalEventTarget(this.doc,t)))throw new Error(`Unsupported event target ${t} for event ${e}`);return this.eventManager.addEventListener(t,e,this.decoratePreventDefault(i))}decoratePreventDefault(t){return e=>{if("__ngUnwrap__"===e)return t;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))&&e.preventDefault()}}}function S4(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class PY extends jM{constructor(t,e,i,r,o,l,f,g){super(t,o,l,g),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const b=A4(r.id,r.styles);for(const S of b){const O=document.createElement("style");f&&O.setAttribute("nonce",f),O.textContent=S,this.shadowRoot.appendChild(O)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class $M extends jM{constructor(t,e,i,r,o,l,f,g){super(t,o,l,f),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r,this.styles=g?A4(g,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class M4 extends $M{constructor(t,e,i,r,o,l,f,g){const b=r+"-"+i.id;super(t,e,i,o,l,f,g,b),this.contentAttr=function AY(n){return"_ngcontent-%COMP%".replace(zM,n)}(b),this.hostAttr=function SY(n){return"_nghost-%COMP%".replace(zM,n)}(b)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}let kY=(()=>{class n extends I4{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const P4=["alt","control","meta","shift"],RY={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},OY={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let FY=(()=>{class n extends I4{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,r){const o=n.parseEventName(i),l=n.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>$m().onAndCancel(e,o.domEventName,l))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=n._normalizeKey(i.pop());let l="",f=i.indexOf("code");if(f>-1&&(i.splice(f,1),l="code."),P4.forEach(b=>{const S=i.indexOf(b);S>-1&&(i.splice(S,1),l+=b+".")}),l+=o,0!=i.length||0===o.length)return null;const g={};return g.domEventName=r,g.fullKey=l,g}static matchEventFullKeyCode(e,i){let r=RY[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),P4.forEach(l=>{l!==r&&(0,OY[l])(e)&&(o+=l+".")}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{n.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const R4=[{provide:bl,useValue:y4},{provide:fp,useValue:function LY(){LM.makeCurrent()},multi:!0},{provide:rr,useFactory:function BY(){return function UA(n){Qx=n}(document),document},deps:[]}],VY=w3(mZ,"browser",R4),zY=new Xt(""),O4=[{provide:jC,useClass:class wY{addToWindow(t){yr.getAngularTestability=(i,r=!0)=>{const o=t.findTestabilityInTree(i,r);if(null==o)throw new gt(5103,!1);return o},yr.getAllAngularTestabilities=()=>t.getAllTestabilities(),yr.getAllAngularRootElements=()=>t.getAllRootElements(),yr.frameworkStabilizers||(yr.frameworkStabilizers=[]),yr.frameworkStabilizers.push(i=>{const r=yr.getAllAngularTestabilities();let o=r.length,l=!1;const f=function(g){l=l||g,o--,0==o&&i(l)};r.forEach(g=>{g.whenStable(f)})})}findTestabilityInTree(t,e,i){return null==e?null:t.getTestability(e)??(i?$m().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:_3,useClass:oM,deps:[wi,sM,jC]},{provide:oM,useClass:oM,deps:[wi,sM,jC]}],F4=[{provide:hp,useValue:"root"},{provide:Xl,useFactory:function NY(){return new Xl},deps:[]},{provide:NM,useClass:kY,multi:!0,deps:[rr,wi,bl]},{provide:NM,useClass:FY,multi:!0,deps:[rr]},UM,T4,C4,{provide:y_,useExisting:UM},{provide:v4,useClass:EY,deps:[]},[]];let L4=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:dy,useValue:e.appId}]}}static#e=this.\u0275fac=function(i){return new(i||n)(it(zY,12))};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[...F4,...O4],imports:[a1,gZ]})}return n})(),N4=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr))};static#t=this.\u0275prov=Wt({token:n,factory:function(i){let r=null;return r=i?new i:function jY(){return new N4(it(rr))}(),r},providedIn:"root"})}return n})();typeof window<"u"&&window;let uI=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:function(i){let r=null;return r=i?new(i||n):it(z4),r},providedIn:"root"})}return n})(),z4=(()=>{class n extends uI{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case va.NONE:return i;case va.HTML:return Os(i,"HTML")?$r(i):ry(this._doc,String(i)).toString();case va.STYLE:return Os(i,"Style")?$r(i):i;case va.SCRIPT:if(Os(i,"Script"))return $r(i);throw new gt(5200,!1);case va.URL:return Os(i,"URL")?$r(i):Tr(String(i));case va.RESOURCE_URL:if(Os(i,"ResourceURL"))return $r(i);throw new gt(5201,!1);default:throw new gt(5202,!1)}}bypassSecurityTrustHtml(e){return function ny(n){return new jA(n)}(e)}bypassSecurityTrustStyle(e){return function Em(n){return new $A(n)}(e)}bypassSecurityTrustScript(e){return function WA(n){return new HA(n)}(e)}bypassSecurityTrustUrl(e){return function qA(n){return new jE(n)}(e)}bypassSecurityTrustResourceUrl(e){return function u_(n){return new GA(n)}(e)}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr))};static#t=this.\u0275prov=Wt({token:n,factory:function(i){let r=null;return r=i?new i:function WY(n){return new z4(n.get(rr))}(it(Hr)),r},providedIn:"root"})}return n})();function Qy(n,t){return W(t)?Bi(n,t,1):Bi(n,1)}function aa(n,t){return Ot((e,i)=>{let r=0;e.subscribe(_n(i,o=>n.call(t,o,r++)&&i.next(o)))})}function Gm(n){return Ot((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}class u1{}class dI{}class ff{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?"string"==typeof t?this.lazyInit=()=>{this.headers=new Map,t.split("\n").forEach(e=>{const i=e.indexOf(":");if(i>0){const r=e.slice(0,i),o=r.toLowerCase(),l=e.slice(i+1).trim();this.maybeSetNormalizedName(r,o),this.headers.has(o)?this.headers.get(o).push(l):this.headers.set(o,[l])}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,i)=>{this.setHeaderEntries(i,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,i])=>{this.setHeaderEntries(e,i)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof ff?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new ff;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof ff?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...i),this.headers.set(e,r);break;case"d":const o=t.value;if(o){let l=this.headers.get(e);if(!l)return;l=l.filter(f=>-1===o.indexOf(f)),0===l.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,l)}else this.headers.delete(e),this.normalizedNames.delete(e)}}setHeaderEntries(t,e){const i=(Array.isArray(e)?e:[e]).map(o=>o.toString()),r=t.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(t,r)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class qY{encodeKey(t){return j4(t)}encodeValue(t){return j4(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const KY=/%(\d[a-f0-9])/gi,YY={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function j4(n){return encodeURIComponent(n).replace(KY,(t,e)=>YY[e]??t)}function hI(n){return`${n}`}class Wm{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new qY,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function ZY(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const o=r.indexOf("="),[l,f]=-1==o?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,o)),t.decodeValue(r.slice(o+1))],g=e.get(l)||[];g.push(f),e.set(l,g)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const i=t.fromObject[e],r=Array.isArray(i)?i.map(hI):[hI(i)];this.map.set(e,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(i=>{const r=t[i];Array.isArray(r)?r.forEach(o=>{e.push({param:i,value:o,op:"a"})}):e.push({param:i,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new Wm({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(hI(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let i=this.map.get(t.param)||[];const r=i.indexOf(hI(t.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class XY{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function $4(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function H4(n){return typeof Blob<"u"&&n instanceof Blob}function G4(n){return typeof FormData<"u"&&n instanceof FormData}class d1{constructor(t,e,i,r){let o;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function QY(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,o=r):o=i,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new ff),this.context||(this.context=new XY),this.params){const l=this.params.toString();if(0===l.length)this.urlWithParams=e;else{const f=e.indexOf("?");this.urlWithParams=e+(-1===f?"?":f<e.length-1?"&":"")+l}}else this.params=new Wm,this.urlWithParams=e}serializeBody(){return null===this.body?null:$4(this.body)||H4(this.body)||G4(this.body)||function JY(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Wm?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||G4(this.body)?null:H4(this.body)?this.body.type||null:$4(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Wm?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,l=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,f=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let g=t.headers||this.headers,b=t.params||this.params;const S=t.context??this.context;return void 0!==t.setHeaders&&(g=Object.keys(t.setHeaders).reduce((O,$)=>O.set($,t.setHeaders[$]),g)),t.setParams&&(b=Object.keys(t.setParams).reduce((O,$)=>O.set($,t.setParams[$]),b)),new d1(e,i,o,{params:b,headers:g,context:S,reportProgress:f,responseType:r,withCredentials:l})}}var Jy=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Jy||{});class GM{constructor(t,e=200,i="OK"){this.headers=t.headers||new ff,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class WM extends GM{constructor(t={}){super(t),this.type=Jy.ResponseHeader}clone(t={}){return new WM({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class ev extends GM{constructor(t={}){super(t),this.type=Jy.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new ev({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class W4 extends GM{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function qM(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let h1=(()=>{class n{constructor(e){this.handler=e}request(e,i,r={}){let o;if(e instanceof d1)o=e;else{let g,b;g=r.headers instanceof ff?r.headers:new ff(r.headers),r.params&&(b=r.params instanceof Wm?r.params:new Wm({fromObject:r.params})),o=new d1(e,i,void 0!==r.body?r.body:null,{headers:g,context:r.context,params:b,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const l=Te(o).pipe(Qy(g=>this.handler.handle(g)));if(e instanceof d1||"events"===r.observe)return l;const f=l.pipe(aa(g=>g instanceof ev));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return f.pipe($t(g=>{if(null!==g.body&&!(g.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return g.body}));case"blob":return f.pipe($t(g=>{if(null!==g.body&&!(g.body instanceof Blob))throw new Error("Response is not a Blob.");return g.body}));case"text":return f.pipe($t(g=>{if(null!==g.body&&"string"!=typeof g.body)throw new Error("Response is not a string.");return g.body}));default:return f.pipe($t(g=>g.body))}case"response":return f;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:(new Wm).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,r={}){return this.request("PATCH",e,qM(r,i))}post(e,i,r={}){return this.request("POST",e,qM(r,i))}put(e,i,r={}){return this.request("PUT",e,qM(r,i))}static#e=this.\u0275fac=function(i){return new(i||n)(it(u1))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();function K4(n,t){return t(n)}function tX(n,t){return(e,i)=>t.intercept(e,{handle:r=>n(r,i)})}const iX=new Xt(""),f1=new Xt(""),Y4=new Xt("");function rX(){let n=null;return(t,e)=>{null===n&&(n=(xn(iX,{optional:!0})??[]).reduceRight(tX,K4));const i=xn(zC),r=i.add();return n(t,e).pipe(Gm(()=>i.remove(r)))}}let X4=(()=>{class n extends u1{constructor(e,i){super(),this.backend=e,this.injector=i,this.chain=null,this.pendingTasks=xn(zC)}handle(e){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(f1),...this.injector.get(Y4,[])]));this.chain=r.reduceRight((o,l)=>function nX(n,t,e){return(i,r)=>e.runInContext(()=>t(i,o=>n(o,r)))}(o,l,this.injector),K4)}const i=this.pendingTasks.add();return this.chain(e,r=>this.backend.handle(r)).pipe(Gm(()=>this.pendingTasks.remove(i)))}static#e=this.\u0275fac=function(i){return new(i||n)(it(dI),it(ra))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const lX=/^\)\]\}',?\n/;let J4=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new gt(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?ne(i.\u0275loadImpl()):Te(null)).pipe(bn(()=>new Kt(o=>{const l=i.build();if(l.open(e.method,e.urlWithParams),e.withCredentials&&(l.withCredentials=!0),e.headers.forEach((Ce,je)=>l.setRequestHeader(Ce,je.join(","))),e.headers.has("Accept")||l.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const Ce=e.detectContentTypeHeader();null!==Ce&&l.setRequestHeader("Content-Type",Ce)}if(e.responseType){const Ce=e.responseType.toLowerCase();l.responseType="json"!==Ce?Ce:"text"}const f=e.serializeBody();let g=null;const b=()=>{if(null!==g)return g;const Ce=l.statusText||"OK",je=new ff(l.getAllResponseHeaders()),ft=function cX(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(l)||e.url;return g=new WM({headers:je,status:l.status,statusText:Ce,url:ft}),g},S=()=>{let{headers:Ce,status:je,statusText:ft,url:ot}=b(),It=null;204!==je&&(It=typeof l.response>"u"?l.responseText:l.response),0===je&&(je=It?200:0);let Yt=je>=200&&je<300;if("json"===e.responseType&&"string"==typeof It){const yn=It;It=It.replace(lX,"");try{It=""!==It?JSON.parse(It):null}catch(ai){It=yn,Yt&&(Yt=!1,It={error:ai,text:It})}}Yt?(o.next(new ev({body:It,headers:Ce,status:je,statusText:ft,url:ot||void 0})),o.complete()):o.error(new W4({error:It,headers:Ce,status:je,statusText:ft,url:ot||void 0}))},O=Ce=>{const{url:je}=b(),ft=new W4({error:Ce,status:l.status||0,statusText:l.statusText||"Unknown Error",url:je||void 0});o.error(ft)};let $=!1;const J=Ce=>{$||(o.next(b()),$=!0);let je={type:Jy.DownloadProgress,loaded:Ce.loaded};Ce.lengthComputable&&(je.total=Ce.total),"text"===e.responseType&&l.responseText&&(je.partialText=l.responseText),o.next(je)},ge=Ce=>{let je={type:Jy.UploadProgress,loaded:Ce.loaded};Ce.lengthComputable&&(je.total=Ce.total),o.next(je)};return l.addEventListener("load",S),l.addEventListener("error",O),l.addEventListener("timeout",O),l.addEventListener("abort",O),e.reportProgress&&(l.addEventListener("progress",J),null!==f&&l.upload&&l.upload.addEventListener("progress",ge)),l.send(f),o.next({type:Jy.Sent}),()=>{l.removeEventListener("error",O),l.removeEventListener("abort",O),l.removeEventListener("load",S),l.removeEventListener("timeout",O),e.reportProgress&&(l.removeEventListener("progress",J),null!==f&&l.upload&&l.upload.removeEventListener("progress",ge)),l.readyState!==l.DONE&&l.abort()}})))}static#e=this.\u0275fac=function(i){return new(i||n)(it(v4))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const ZM=new Xt("XSRF_ENABLED"),eB=new Xt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),tB=new Xt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class nB{}let hX=(()=>{class n{constructor(e,i,r){this.doc=e,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=c4(e,this.cookieName),this.lastCookieString=e),this.lastToken}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr),it(bl),it(eB))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();function fX(n,t){const e=n.url.toLowerCase();if(!xn(ZM)||"GET"===n.method||"HEAD"===n.method||e.startsWith("http://")||e.startsWith("https://"))return t(n);const i=xn(nB).getToken(),r=xn(tB);return null!=i&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),t(n)}var qm=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(qm||{});function pX(...n){const t=[h1,J4,X4,{provide:u1,useExisting:X4},{provide:dI,useExisting:J4},{provide:f1,useValue:fX,multi:!0},{provide:ZM,useValue:!0},{provide:nB,useClass:hX}];for(const e of n)t.push(...e.\u0275providers);return function f_(n){return{\u0275providers:n}}(t)}const iB=new Xt("LEGACY_INTERCEPTOR_FN");function mX(){return function M_(n,t){return{\u0275kind:n,\u0275providers:t}}(qm.LegacyInterceptors,[{provide:iB,useFactory:rX},{provide:f1,useExisting:iB,multi:!0}])}let gX=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[pX(mX())]})}return n})();class rB{}class wX{}const Sp="*";function p1(n,t){return{type:7,name:n,definitions:t,options:{}}}function Mp(n,t=null){return{type:4,styles:t,timings:n}}function sB(n,t=null){return{type:2,steps:n,options:t}}function Na(n){return{type:6,styles:n,offset:null}}function P_(n,t,e){return{type:0,name:n,styles:t,options:e}}function aB(n){return{type:5,steps:n}}function Pp(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}class m1{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class uB{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,r=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(l=>{l.onDone(()=>{++e==o&&this._onFinish()}),l.onDestroy(()=>{++i==o&&this._onDestroy()}),l.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((l,f)=>Math.max(l,f.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}function dB(n){return new gt(3e3,!1)}function Zm(n){switch(n.length){case 0:return new m1;case 1:return n[0];default:return new uB(n)}}function hB(n,t,e=new Map,i=new Map){const r=[],o=[];let l=-1,f=null;if(t.forEach(g=>{const b=g.get("offset"),S=b==l,O=S&&f||new Map;g.forEach(($,J)=>{let ge=J,Ce=$;if("offset"!==J)switch(ge=n.normalizePropertyName(ge,r),Ce){case"!":Ce=e.get(J);break;case Sp:Ce=i.get(J);break;default:Ce=n.normalizeStyleValue(J,ge,Ce,r)}O.set(ge,Ce)}),S||o.push(O),f=O,l=b}),r.length)throw function GX(n){return new gt(3502,!1)}();return o}function YM(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&XM(e,"start",n)));break;case"done":n.onDone(()=>i(e&&XM(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&XM(e,"destroy",n)))}}function XM(n,t,e){const o=QM(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),l=n._data;return null!=l&&(o._data=l),o}function QM(n,t,e,i,r="",o=0,l){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!l}}function _u(n,t,e){let i=n.get(t);return i||n.set(t,i=e),i}function fB(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}const iQ=(()=>typeof document>"u"?null:document.documentElement)();function JM(n){const t=n.parentNode||n.host||null;return t===iQ?null:t}let k_=null,pB=!1;function mB(n,t){for(;t;){if(t===n)return!0;t=JM(t)}return!1}function gB(n,t,e){if(e)return Array.from(n.querySelectorAll(t));const i=n.querySelector(t);return i?[i]:[]}let _B=(()=>{class n{validateStyleProperty(e){return function oQ(n){k_||(k_=function sQ(){return typeof document<"u"?document.body:null}()||{},pB=!!k_.style&&"WebkitAppearance"in k_.style);let t=!0;return k_.style&&!function rQ(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in k_.style,!t&&pB&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in k_.style)),t}(e)}matchesElement(e,i){return!1}containsElement(e,i){return mB(e,i)}getParentElement(e){return JM(e)}query(e,i,r){return gB(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,l,f=[],g){return new m1(r,o)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})(),e2=(()=>{class n{static#e=this.NOOP=new _B}return n})();const aQ=1e3,t2="ng-enter",pI="ng-leave",mI="ng-trigger",gI=".ng-trigger",vB="ng-animating",n2=".ng-animating";function kp(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:r2(parseFloat(t[1]),t[2])}function r2(n,t){return"s"===t?n*aQ:n}function _I(n,t,e){return n.hasOwnProperty("duration")?n:function cQ(n,t,e){let r,o=0,l="";if("string"==typeof n){const f=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===f)return t.push(dB()),{duration:0,delay:0,easing:""};r=r2(parseFloat(f[1]),f[2]);const g=f[3];null!=g&&(o=r2(parseFloat(g),f[4]));const b=f[5];b&&(l=b)}else r=n;if(!e){let f=!1,g=t.length;r<0&&(t.push(function EX(){return new gt(3100,!1)}()),f=!0),o<0&&(t.push(function CX(){return new gt(3101,!1)}()),f=!0),f&&t.splice(g,0,dB())}return{duration:r,delay:o,easing:l}}(n,t,e)}function g1(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function xB(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function Km(n,t=new Map,e){if(e)for(let[i,r]of e)t.set(i,r);for(let[i,r]of n)t.set(i,r);return t}function pf(n,t,e){t.forEach((i,r)=>{const o=s2(r);e&&!e.has(r)&&e.set(r,n.style[o]),n.style[o]=i})}function R_(n,t){t.forEach((e,i)=>{const r=s2(i);n.style[r]=""})}function _1(n){return Array.isArray(n)?1==n.length?n[0]:sB(n):n}const o2=new RegExp("{{\\s*(.+?)\\s*}}","g");function wB(n){let t=[];if("string"==typeof n){let e;for(;e=o2.exec(n);)t.push(e[1]);o2.lastIndex=0}return t}function y1(n,t,e){const i=n.toString(),r=i.replace(o2,(o,l)=>{let f=t[l];return null==f&&(e.push(function TX(n){return new gt(3003,!1)}()),f=""),f.toString()});return r==i?n:r}function yI(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const hQ=/-+([a-z0-9])/g;function s2(n){return n.replace(hQ,(...t)=>t[1].toUpperCase())}function yu(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function DX(n){return new gt(3004,!1)}()}}function EB(n,t){return window.getComputedStyle(n)[t]}const vI="*";function mQ(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function gQ(n,t,e){if(":"==n[0]){const g=function _Q(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(function UX(n){return new gt(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof g)return void t.push(g);n=g}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function zX(n){return new gt(3015,!1)}()),t;const r=i[1],o=i[2],l=i[3];t.push(CB(r,l));"<"==o[0]&&!(r==vI&&l==vI)&&t.push(CB(l,r))}(i,e,t)):e.push(n),e}const xI=new Set(["true","1"]),bI=new Set(["false","0"]);function CB(n,t){const e=xI.has(n)||bI.has(n),i=xI.has(t)||bI.has(t);return(r,o)=>{let l=n==vI||n==r,f=t==vI||t==o;return!l&&e&&"boolean"==typeof r&&(l=r?xI.has(n):bI.has(n)),!f&&i&&"boolean"==typeof o&&(f=o?xI.has(t):bI.has(t)),l&&f}}const yQ=new RegExp("s*:selfs*,?","g");function a2(n,t,e,i){return new vQ(n).build(t,e,i)}class vQ{constructor(t){this._driver=t}build(t,e,i){const r=new wQ(e);return this._resetContextStyleTimingState(r),yu(this,_1(t),r)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],l=[];return"@"==t.name.charAt(0)&&e.errors.push(function SX(){return new gt(3006,!1)}()),t.definitions.forEach(f=>{if(this._resetContextStyleTimingState(e),0==f.type){const g=f,b=g.name;b.toString().split(/\s*,\s*/).forEach(S=>{g.name=S,o.push(this.visitState(g,e))}),g.name=b}else if(1==f.type){const g=this.visitTransition(f,e);i+=g.queryCount,r+=g.depCount,l.push(g)}else e.errors.push(function MX(){return new gt(3007,!1)}())}),{type:7,name:t.name,states:o,transitions:l,queryCount:i,depCount:r,options:null}}visitState(t,e){const i=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const o=new Set,l=r||{};i.styles.forEach(f=>{f instanceof Map&&f.forEach(g=>{wB(g).forEach(b=>{l.hasOwnProperty(b)||o.add(b)})})}),o.size&&(yI(o.values()),e.errors.push(function PX(n,t){return new gt(3008,!1)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const i=yu(this,_1(t.animation),e);return{type:1,matchers:mQ(t.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:O_(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(i=>yu(this,i,e)),options:O_(t.options)}}visitGroup(t,e){const i=e.currentTime;let r=0;const o=t.steps.map(l=>{e.currentTime=i;const f=yu(this,l,e);return r=Math.max(r,e.currentTime),f});return e.currentTime=r,{type:3,steps:o,options:O_(t.options)}}visitAnimate(t,e){const i=function CQ(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return l2(_I(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=l2(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=_I(e,t);return l2(r.duration,r.delay,r.easing)}(t.timings,e.errors);e.currentAnimateTimings=i;let r,o=t.styles?t.styles:Na({});if(5==o.type)r=this.visitKeyframes(o,e);else{let l=t.styles,f=!1;if(!l){f=!0;const b={};i.easing&&(b.easing=i.easing),l=Na(b)}e.currentTime+=i.duration+i.delay;const g=this.visitStyle(l,e);g.isEmptyStep=f,r=g}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,e){const i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){const i=[],r=Array.isArray(t.styles)?t.styles:[t.styles];for(let f of r)"string"==typeof f?f===Sp?i.push(f):e.errors.push(new gt(3002,!1)):i.push(xB(f));let o=!1,l=null;return i.forEach(f=>{if(f instanceof Map&&(f.has("easing")&&(l=f.get("easing"),f.delete("easing")),!o))for(let g of f.values())if(g.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:i,easing:l,offset:t.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(t,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),t.styles.forEach(l=>{"string"!=typeof l&&l.forEach((f,g)=>{const b=e.collectedStyles.get(e.currentQuerySelector),S=b.get(g);let O=!0;S&&(o!=r&&o>=S.startTime&&r<=S.endTime&&(e.errors.push(function RX(n,t,e,i,r){return new gt(3010,!1)}()),O=!1),o=S.startTime),O&&b.set(g,{startTime:o,endTime:r}),e.options&&function dQ(n,t,e){const i=t.params||{},r=wB(n);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function IX(n){return new gt(3001,!1)}())})}(f,e.options,e.errors)})})}visitKeyframes(t,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function OX(){return new gt(3011,!1)}()),i;let o=0;const l=[];let f=!1,g=!1,b=0;const S=t.steps.map(ft=>{const ot=this._makeStyleAst(ft,e);let It=null!=ot.offset?ot.offset:function EQ(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;t=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(ot.styles),Yt=0;return null!=It&&(o++,Yt=ot.offset=It),g=g||Yt<0||Yt>1,f=f||Yt<b,b=Yt,l.push(Yt),ot});g&&e.errors.push(function FX(){return new gt(3012,!1)}()),f&&e.errors.push(function LX(){return new gt(3200,!1)}());const O=t.steps.length;let $=0;o>0&&o<O?e.errors.push(function NX(){return new gt(3202,!1)}()):0==o&&($=1/(O-1));const J=O-1,ge=e.currentTime,Ce=e.currentAnimateTimings,je=Ce.duration;return S.forEach((ft,ot)=>{const It=$>0?ot==J?1:$*ot:l[ot],Yt=It*je;e.currentTime=ge+Ce.delay+Yt,Ce.duration=Yt,this._validateStyleAst(ft,e),ft.offset=It,i.styles.push(ft)}),i}visitReference(t,e){return{type:8,animation:yu(this,_1(t.animation),e),options:O_(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:O_(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:O_(t.options)}}visitQuery(t,e){const i=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[o,l]=function xQ(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(yQ,"")),n=n.replace(/@\*/g,gI).replace(/@\w+/g,e=>gI+"-"+e.slice(1)).replace(/:animating/g,n2),[n,t]}(t.selector);e.currentQuerySelector=i.length?i+" "+o:o,_u(e.collectedStyles,e.currentQuerySelector,new Map);const f=yu(this,_1(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:l,animation:f,originalSelector:t.selector,options:O_(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function BX(){return new gt(3013,!1)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:_I(t.timings,e.errors,!0);return{type:12,animation:yu(this,_1(t.animation),e),timings:i,options:null}}}class wQ{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function O_(n){return n?(n=g1(n)).params&&(n.params=function bQ(n){return n?g1(n):null}(n.params)):n={},n}function l2(n,t,e){return{duration:n,delay:t,easing:e}}function c2(n,t,e,i,r,o,l=null,f=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:l,subTimeline:f}}class wI{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const DQ=new RegExp(":enter","g"),SQ=new RegExp(":leave","g");function u2(n,t,e,i,r,o=new Map,l=new Map,f,g,b=[]){return(new MQ).buildKeyframes(n,t,e,i,r,o,l,f,g,b)}class MQ{buildKeyframes(t,e,i,r,o,l,f,g,b,S=[]){b=b||new wI;const O=new d2(t,e,b,r,o,S,[]);O.options=g;const $=g.delay?kp(g.delay):0;O.currentTimeline.delayNextStep($),O.currentTimeline.setStyles([l],null,O.errors,g),yu(this,i,O);const J=O.timelines.filter(ge=>ge.containsAnimation());if(J.length&&f.size){let ge;for(let Ce=J.length-1;Ce>=0;Ce--){const je=J[Ce];if(je.element===e){ge=je;break}}ge&&!ge.allowOnlyTimelineStyles()&&ge.setStyles([f],null,O.errors,g)}return J.length?J.map(ge=>ge.buildKeyframes()):[c2(e,[],[],[],0,$,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(t.options),o=e.currentTimeline.currentTime,l=this._visitSubInstructions(i,r,r.options);o!=l&&e.transformIntoNewTimeline(l)}e.previousNode=t}visitAnimateRef(t,e){const i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,i),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,i){for(const r of t){const o=r?.delay;if(o){const l="number"==typeof o?o:kp(y1(o,r?.params??{},e.errors));i.delayNextStep(l)}}}_visitSubInstructions(t,e,i){let o=e.currentTimeline.currentTime;const l=null!=i.duration?kp(i.duration):null,f=null!=i.delay?kp(i.delay):null;return 0!==l&&t.forEach(g=>{const b=e.appendInstructionToTimeline(g,l,f);o=Math.max(o,b.duration+b.delay)}),o}visitReference(t,e){e.updateOptions(t.options,!0),yu(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const i=e.subContextCount;let r=e;const o=t.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=EI);const l=kp(o.delay);r.delayNextStep(l)}t.steps.length&&(t.steps.forEach(l=>yu(this,l,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const i=[];let r=e.currentTimeline.currentTime;const o=t.options&&t.options.delay?kp(t.options.delay):0;t.steps.forEach(l=>{const f=e.createSubContext(t.options);o&&f.delayNextStep(o),yu(this,l,f),r=Math.max(r,f.currentTimeline.currentTime),i.push(f.currentTimeline)}),i.forEach(l=>e.currentTimeline.mergeTimelineCollectedStyles(l)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const i=t.strValue;return _I(e.params?y1(i,e.params,e.errors):i,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const i=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=t.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(o):i.setStyles(t.styles,o,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,f=e.createSubContext().currentTimeline;f.easing=i.easing,t.styles.forEach(g=>{f.forwardTime((g.offset||0)*o),f.setStyles(g.styles,g.easing,e.errors,e.options),f.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(f),e.transformIntoNewTimeline(r+o),e.previousNode=t}visitQuery(t,e){const i=e.currentTimeline.currentTime,r=t.options||{},o=r.delay?kp(r.delay):0;o&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=EI);let l=i;const f=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=f.length;let g=null;f.forEach((b,S)=>{e.currentQueryIndex=S;const O=e.createSubContext(t.options,b);o&&O.delayNextStep(o),b===e.element&&(g=O.currentTimeline),yu(this,t.animation,O),O.currentTimeline.applyStylesToKeyframe(),l=Math.max(l,O.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(l),g&&(e.currentTimeline.mergeTimelineCollectedStyles(g),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const i=e.parentContext,r=e.currentTimeline,o=t.timings,l=Math.abs(o.duration),f=l*(e.currentQueryTotal-1);let g=l*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":g=f-g;break;case"full":g=i.currentStaggerTime}const S=e.currentTimeline;g&&S.delayNextStep(g);const O=S.currentTime;yu(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=r.currentTime-O+(r.startTime-i.currentTimeline.startTime)}}const EI={};class d2{constructor(t,e,i,r,o,l,f,g){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=l,this.timelines=f,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=EI,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=g||new CI(this._driver,e,0),f.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=kp(i.duration)),null!=i.delay&&(r.delay=kp(i.delay));const o=i.params;if(o){let l=r.params;l||(l=this.options.params={}),Object.keys(o).forEach(f=>{(!e||!l.hasOwnProperty(f))&&(l[f]=y1(o[f],l,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const i=t.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return t}createSubContext(t=null,e,i){const r=e||this.element,o=new d2(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(t){return this.previousNode=EI,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){const r={duration:e??t.duration,delay:this.currentTimeline.currentTime+(i??0)+t.delay,easing:""},o=new PQ(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,r,o,l){let f=[];if(r&&f.push(this.element),t.length>0){t=(t=t.replace(DQ,"."+this._enterClassName)).replace(SQ,"."+this._leaveClassName);let b=this._driver.query(this.element,t,1!=i);0!==i&&(b=i<0?b.slice(b.length+i,b.length):b.slice(0,i)),f.push(...b)}return!o&&0==f.length&&l.push(function VX(n){return new gt(3014,!1)}()),f}}class CI{constructor(t,e,i,r){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new CI(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||Sp),this._currentKeyframe.set(e,Sp);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,r){e&&this._previousKeyframe.set("easing",e);const o=r&&r.params||{},l=function kQ(n,t){const e=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||t.keys();for(let o of i)e.set(o,Sp)}else Km(r,e)}),e}(t,this._globalTimelineStyles);for(let[f,g]of l){const b=y1(g,o,i);this._pendingStyles.set(f,b),this._localTimelineStyles.has(f)||this._backFill.set(f,this._globalTimelineStyles.get(f)??Sp),this._updateStyle(f,b)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((f,g)=>{const b=Km(f,new Map,this._backFill);b.forEach((S,O)=>{"!"===S?t.add(O):S===Sp&&e.add(O)}),i||b.set("offset",g/this.duration),r.push(b)});const o=t.size?yI(t.values()):[],l=e.size?yI(e.values()):[];if(i){const f=r[0],g=new Map(f);f.set("offset",0),g.set("offset",1),r=[f,g]}return c2(this.element,r,o,l,this.duration,this.startTime,this.easing,!1)}}class PQ extends CI{constructor(t,e,i,r,o,l,f=!1){super(t,e,l.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=f,this.timings={duration:l.duration,delay:l.delay,easing:l.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],l=i+e,f=e/l,g=Km(t[0]);g.set("offset",0),o.push(g);const b=Km(t[0]);b.set("offset",DB(f)),o.push(b);const S=t.length-1;for(let O=1;O<=S;O++){let $=Km(t[O]);const J=$.get("offset");$.set("offset",DB((e+J*i)/l)),o.push($)}i=l,e=0,r="",t=o}return c2(this.element,t,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function DB(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class h2{}const RQ=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class OQ extends h2{normalizePropertyName(t,e){return s2(t)}normalizeStyleValue(t,e,i,r){let o="";const l=i.toString().trim();if(RQ.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const f=i.match(/^[+-]?[\d\.]+([a-z]*)$/);f&&0==f[1].length&&r.push(function AX(n,t){return new gt(3005,!1)}())}return l+o}}function AB(n,t,e,i,r,o,l,f,g,b,S,O,$){return{type:0,element:n,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:l,timelines:f,queriedElements:g,preStyleProps:b,postStyleProps:S,totalTime:O,errors:$}}const f2={};class SB{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,r){return function FQ(n,t,e,i,r){return n.some(o=>o(t,e,i,r))}(this.ast.matchers,t,e,i,r)}buildStyles(t,e,i){let r=this._stateStyles.get("*");return void 0!==t&&(r=this._stateStyles.get(t?.toString())||r),r?r.buildStyles(e,i):new Map}build(t,e,i,r,o,l,f,g,b,S){const O=[],$=this.ast.options&&this.ast.options.params||f2,ge=this.buildStyles(i,f&&f.params||f2,O),Ce=g&&g.params||f2,je=this.buildStyles(r,Ce,O),ft=new Set,ot=new Map,It=new Map,Yt="void"===r,yn={params:LQ(Ce,$),delay:this.ast.options?.delay},ai=S?[]:u2(t,e,this.ast.animation,o,l,ge,je,yn,b,O);let Ri=0;if(ai.forEach(Ha=>{Ri=Math.max(Ha.duration+Ha.delay,Ri)}),O.length)return AB(e,this._triggerName,i,r,Yt,ge,je,[],[],ot,It,Ri,O);ai.forEach(Ha=>{const Bc=Ha.element,fA=_u(ot,Bc,new Set);Ha.preStyleProps.forEach(x0=>fA.add(x0));const vE=_u(It,Bc,new Set);Ha.postStyleProps.forEach(x0=>vE.add(x0)),Bc!==e&&ft.add(Bc)});const Qr=yI(ft.values());return AB(e,this._triggerName,i,r,Yt,ge,je,ai,Qr,ot,It,Ri)}}function LQ(n,t){const e=g1(t);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(e[i]=n[i]);return e}class NQ{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){const i=new Map,r=g1(this.defaultParams);return Object.keys(t).forEach(o=>{const l=t[o];null!==l&&(r[o]=l)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((l,f)=>{l&&(l=y1(l,r,e));const g=this.normalizer.normalizePropertyName(f,e);l=this.normalizer.normalizeStyleValue(f,g,l,e),i.set(f,l)})}),i}}class VQ{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new NQ(r.style,r.options&&r.options.params||{},i))}),MB(this.states,"true","1"),MB(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new SB(t,r,this.states))}),this.fallbackTransition=function zQ(n,t,e){return new SB(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(l,f)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,r){return this.transitionFactories.find(l=>l.match(t,e,i,r))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}}function MB(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const UQ=new wI;class jQ{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const i=[],o=a2(this._driver,e,i,[]);if(i.length)throw function WX(n){return new gt(3503,!1)}();this._animations.set(t,o)}_buildPlayer(t,e,i){const r=t.element,o=hB(this._normalizer,t.keyframes,e,i);return this._driver.animate(r,o,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){const r=[],o=this._animations.get(t);let l;const f=new Map;if(o?(l=u2(this._driver,e,o,t2,pI,new Map,new Map,i,UQ,r),l.forEach(S=>{const O=_u(f,S.element,new Map);S.postStyleProps.forEach($=>O.set($,null))})):(r.push(function qX(){return new gt(3300,!1)}()),l=[]),r.length)throw function ZX(n){return new gt(3504,!1)}();f.forEach((S,O)=>{S.forEach(($,J)=>{S.set(J,this._driver.computeStyle(O,J,Sp))})});const b=Zm(l.map(S=>{const O=f.get(S.element);return this._buildPlayer(S,new Map,O)}));return this._playersById.set(t,b),b.onDestroy(()=>this.destroy(t)),this.players.push(b),b}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function KX(n){return new gt(3301,!1)}();return e}listen(t,e,i,r){const o=QM(e,"","","");return YM(this._getPlayer(t),i,o,r),()=>{}}command(t,e,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,e,r[0]||{});const o=this._getPlayer(t);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const PB="ng-animate-queued",p2="ng-animate-disabled",qQ=[],kB={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},ZQ={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Qd="__ng_removed";class m2{get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;const i=t&&t.hasOwnProperty("value");if(this.value=function QQ(n){return n??null}(i?t.value:t),i){const o=g1(t);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const e=t.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const v1="void",g2=new m2(v1);class KQ{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,ad(e,this._hostClassName)}listen(t,e,i,r){if(!this._triggers.has(e))throw function YX(n,t){return new gt(3302,!1)}();if(null==i||0==i.length)throw function XX(n){return new gt(3303,!1)}();if(!function JQ(n){return"start"==n||"done"==n}(i))throw function QX(n,t){return new gt(3400,!1)}();const o=_u(this._elementListeners,t,[]),l={name:e,phase:i,callback:r};o.push(l);const f=_u(this._engine.statesByElement,t,new Map);return f.has(e)||(ad(t,mI),ad(t,mI+"-"+e),f.set(e,g2)),()=>{this._engine.afterFlush(()=>{const g=o.indexOf(l);g>=0&&o.splice(g,1),this._triggers.has(e)||f.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function JX(n){return new gt(3401,!1)}();return e}trigger(t,e,i,r=!0){const o=this._getTrigger(e),l=new _2(this.id,e,t);let f=this._engine.statesByElement.get(t);f||(ad(t,mI),ad(t,mI+"-"+e),this._engine.statesByElement.set(t,f=new Map));let g=f.get(e);const b=new m2(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&g&&b.absorbOptions(g.options),f.set(e,b),g||(g=g2),b.value!==v1&&g.value===b.value){if(!function nJ(n,t){const e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!t.hasOwnProperty(o)||n[o]!==t[o])return!1}return!0}(g.params,b.params)){const Ce=[],je=o.matchStyles(g.value,g.params,Ce),ft=o.matchStyles(b.value,b.params,Ce);Ce.length?this._engine.reportError(Ce):this._engine.afterFlush(()=>{R_(t,je),pf(t,ft)})}return}const $=_u(this._engine.playersByElement,t,[]);$.forEach(Ce=>{Ce.namespaceId==this.id&&Ce.triggerName==e&&Ce.queued&&Ce.destroy()});let J=o.matchTransition(g.value,b.value,t,b.params),ge=!1;if(!J){if(!r)return;J=o.fallbackTransition,ge=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:J,fromState:g,toState:b,player:l,isFallbackTransition:ge}),ge||(ad(t,PB),l.onStart(()=>{tv(t,PB)})),l.onDone(()=>{let Ce=this.players.indexOf(l);Ce>=0&&this.players.splice(Ce,1);const je=this._engine.playersByElement.get(t);if(je){let ft=je.indexOf(l);ft>=0&&je.splice(ft,1)}}),this.players.push(l),$.push(l),l}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const i=this._engine.driver.query(t,gI,!0);i.forEach(r=>{if(r[Qd])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(l=>l.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,i,r){const o=this._engine.statesByElement.get(t),l=new Map;if(o){const f=[];if(o.forEach((g,b)=>{if(l.set(b,g.value),this._triggers.has(b)){const S=this.trigger(t,b,v1,r);S&&f.push(S)}}),f.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,l),i&&Zm(f).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){const r=new Set;e.forEach(o=>{const l=o.name;if(r.has(l))return;r.add(l);const g=this._triggers.get(l).fallbackTransition,b=i.get(l)||g2,S=new m2(v1),O=new _2(this.id,l,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:l,transition:g,fromState:b,toState:S,player:O,isFallbackTransition:!0})})}}removeNode(t,e){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(t):[];if(o&&o.length)r=!0;else{let l=t;for(;l=l.parentNode;)if(i.statesByElement.get(l)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,e);else{const o=t[Qd];(!o||o===kB)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){ad(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,l=this._elementListeners.get(o);l&&l.forEach(f=>{if(f.name==i.triggerName){const g=QM(o,i.triggerName,i.fromState.value,i.toState.value);g._data=t,YM(i.player,f.phase,g,f.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,l=r.transition.ast.depCount;return 0==o||0==l?o-l:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}}class YQ{_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,i){this.bodyNode=t,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){const i=new KQ(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let l=!1,f=this.driver.getParentElement(e);for(;f;){const g=r.get(f);if(g){const b=i.indexOf(g);i.splice(b+1,0,t),l=!0;break}f=this.driver.getParentElement(f)}l||i.unshift(t)}else i.push(t);return r.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let r=this._namespaceLookup[t];r&&r.register(e,i)&&this.totalAnimations++}destroy(t,e){t&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(t);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(e),delete this._namespaceLookup[t]}))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,i=this.statesByElement.get(t);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}return e}trigger(t,e,i,r){if(II(e)){const o=this._fetchNamespace(t);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(t,e,i,r){if(!II(e))return;const o=e[Qd];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const l=this.collectedLeaveElements.indexOf(e);l>=0&&this.collectedLeaveElements.splice(l,1)}if(t){const l=this._fetchNamespace(t);l&&l.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),ad(t,p2)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),tv(t,p2))}removeNode(t,e,i){if(II(e)){const r=t?this._fetchNamespace(t):null;r?r.removeNode(e,i):this.markElementAsRemoved(t,e,!1,i);const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,i)}else this._onRemovalComplete(e,i)}markElementAsRemoved(t,e,i,r,o){this.collectedLeaveElements.push(e),e[Qd]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(t,e,i,r,o){return II(e)?this._fetchNamespace(t).listen(e,i,r,o):()=>{}}_buildInstruction(t,e,i,r,o){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,e,o)}destroyInnerAnimations(t){let e=this.driver.query(t,gI,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,n2,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Zm(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Qd];if(e&&e.setForRemoval){if(t[Qd]=kB,e.namespaceId){this.destroyInnerAnimations(t);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(p2)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)ad(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Zm(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function eQ(n){return new gt(3402,!1)}()}_flushAnimations(t,e){const i=new wI,r=[],o=new Map,l=[],f=new Map,g=new Map,b=new Map,S=new Set;this.disabledNodes.forEach(fi=>{S.add(fi);const Oi=this.driver.query(fi,".ng-animate-queued",!0);for(let Ui=0;Ui<Oi.length;Ui++)S.add(Oi[Ui])});const O=this.bodyNode,$=Array.from(this.statesByElement.keys()),J=FB($,this.collectedEnterElements),ge=new Map;let Ce=0;J.forEach((fi,Oi)=>{const Ui=t2+Ce++;ge.set(Oi,Ui),fi.forEach(Wr=>ad(Wr,Ui))});const je=[],ft=new Set,ot=new Set;for(let fi=0;fi<this.collectedLeaveElements.length;fi++){const Oi=this.collectedLeaveElements[fi],Ui=Oi[Qd];Ui&&Ui.setForRemoval&&(je.push(Oi),ft.add(Oi),Ui.hasAnimation?this.driver.query(Oi,".ng-star-inserted",!0).forEach(Wr=>ft.add(Wr)):ot.add(Oi))}const It=new Map,Yt=FB($,Array.from(ft));Yt.forEach((fi,Oi)=>{const Ui=pI+Ce++;It.set(Oi,Ui),fi.forEach(Wr=>ad(Wr,Ui))}),t.push(()=>{J.forEach((fi,Oi)=>{const Ui=ge.get(Oi);fi.forEach(Wr=>tv(Wr,Ui))}),Yt.forEach((fi,Oi)=>{const Ui=It.get(Oi);fi.forEach(Wr=>tv(Wr,Ui))}),je.forEach(fi=>{this.processLeaveNode(fi)})});const yn=[],ai=[];for(let fi=this._namespaceList.length-1;fi>=0;fi--)this._namespaceList[fi].drainQueuedTransitions(e).forEach(Ui=>{const Wr=Ui.player,Ga=Ui.element;if(yn.push(Wr),this.collectedEnterElements.length){const Ml=Ga[Qd];if(Ml&&Ml.setForMove){if(Ml.previousTriggersValues&&Ml.previousTriggersValues.has(Ui.triggerName)){const b0=Ml.previousTriggersValues.get(Ui.triggerName),dd=this.statesByElement.get(Ui.element);if(dd&&dd.has(Ui.triggerName)){const pA=dd.get(Ui.triggerName);pA.value=b0,dd.set(Ui.triggerName,pA)}}return void Wr.destroy()}}const Pf=!O||!this.driver.containsElement(O,Ga),Tu=It.get(Ga),Mg=ge.get(Ga),Is=this._buildInstruction(Ui,i,Mg,Tu,Pf);if(Is.errors&&Is.errors.length)return void ai.push(Is);if(Pf)return Wr.onStart(()=>R_(Ga,Is.fromStyles)),Wr.onDestroy(()=>pf(Ga,Is.toStyles)),void r.push(Wr);if(Ui.isFallbackTransition)return Wr.onStart(()=>R_(Ga,Is.fromStyles)),Wr.onDestroy(()=>pf(Ga,Is.toStyles)),void r.push(Wr);const b$=[];Is.timelines.forEach(Ml=>{Ml.stretchStartingKeyframe=!0,this.disabledNodes.has(Ml.element)||b$.push(Ml)}),Is.timelines=b$,i.append(Ga,Is.timelines),l.push({instruction:Is,player:Wr,element:Ga}),Is.queriedElements.forEach(Ml=>_u(f,Ml,[]).push(Wr)),Is.preStyleProps.forEach((Ml,b0)=>{if(Ml.size){let dd=g.get(b0);dd||g.set(b0,dd=new Set),Ml.forEach((pA,pF)=>dd.add(pF))}}),Is.postStyleProps.forEach((Ml,b0)=>{let dd=b.get(b0);dd||b.set(b0,dd=new Set),Ml.forEach((pA,pF)=>dd.add(pF))})});if(ai.length){const fi=[];ai.forEach(Oi=>{fi.push(function tQ(n,t){return new gt(3505,!1)}())}),yn.forEach(Oi=>Oi.destroy()),this.reportError(fi)}const Ri=new Map,Qr=new Map;l.forEach(fi=>{const Oi=fi.element;i.has(Oi)&&(Qr.set(Oi,Oi),this._beforeAnimationBuild(fi.player.namespaceId,fi.instruction,Ri))}),r.forEach(fi=>{const Oi=fi.element;this._getPreviousPlayers(Oi,!1,fi.namespaceId,fi.triggerName,null).forEach(Wr=>{_u(Ri,Oi,[]).push(Wr),Wr.destroy()})});const Ha=je.filter(fi=>NB(fi,g,b)),Bc=new Map;OB(Bc,this.driver,ot,b,Sp).forEach(fi=>{NB(fi,g,b)&&Ha.push(fi)});const vE=new Map;J.forEach((fi,Oi)=>{OB(vE,this.driver,new Set(fi),g,"!")}),Ha.forEach(fi=>{const Oi=Bc.get(fi),Ui=vE.get(fi);Bc.set(fi,new Map([...Oi?.entries()??[],...Ui?.entries()??[]]))});const x0=[],v$=[],x$={};l.forEach(fi=>{const{element:Oi,player:Ui,instruction:Wr}=fi;if(i.has(Oi)){if(S.has(Oi))return Ui.onDestroy(()=>pf(Oi,Wr.toStyles)),Ui.disabled=!0,Ui.overrideTotalTime(Wr.totalTime),void r.push(Ui);let Ga=x$;if(Qr.size>1){let Tu=Oi;const Mg=[];for(;Tu=Tu.parentNode;){const Is=Qr.get(Tu);if(Is){Ga=Is;break}Mg.push(Tu)}Mg.forEach(Is=>Qr.set(Is,Ga))}const Pf=this._buildAnimation(Ui.namespaceId,Wr,Ri,o,vE,Bc);if(Ui.setRealPlayer(Pf),Ga===x$)x0.push(Ui);else{const Tu=this.playersByElement.get(Ga);Tu&&Tu.length&&(Ui.parentPlayer=Zm(Tu)),r.push(Ui)}}else R_(Oi,Wr.fromStyles),Ui.onDestroy(()=>pf(Oi,Wr.toStyles)),v$.push(Ui),S.has(Oi)&&r.push(Ui)}),v$.forEach(fi=>{const Oi=o.get(fi.element);if(Oi&&Oi.length){const Ui=Zm(Oi);fi.setRealPlayer(Ui)}}),r.forEach(fi=>{fi.parentPlayer?fi.syncPlayerEvents(fi.parentPlayer):fi.destroy()});for(let fi=0;fi<je.length;fi++){const Oi=je[fi],Ui=Oi[Qd];if(tv(Oi,pI),Ui&&Ui.hasAnimation)continue;let Wr=[];if(f.size){let Pf=f.get(Oi);Pf&&Pf.length&&Wr.push(...Pf);let Tu=this.driver.query(Oi,n2,!0);for(let Mg=0;Mg<Tu.length;Mg++){let Is=f.get(Tu[Mg]);Is&&Is.length&&Wr.push(...Is)}}const Ga=Wr.filter(Pf=>!Pf.destroyed);Ga.length?eJ(this,Oi,Ga):this.processLeaveNode(Oi)}return je.length=0,x0.forEach(fi=>{this.players.push(fi),fi.onDone(()=>{fi.destroy();const Oi=this.players.indexOf(fi);this.players.splice(Oi,1)}),fi.play()}),x0}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,r,o){let l=[];if(e){const f=this.playersByQueriedElement.get(t);f&&(l=f)}else{const f=this.playersByElement.get(t);if(f){const g=!o||o==v1;f.forEach(b=>{b.queued||!g&&b.triggerName!=r||l.push(b)})}}return(i||r)&&(l=l.filter(f=>!(i&&i!=f.namespaceId||r&&r!=f.triggerName))),l}_beforeAnimationBuild(t,e,i){const o=e.element,l=e.isRemovalTransition?void 0:t,f=e.isRemovalTransition?void 0:e.triggerName;for(const g of e.timelines){const b=g.element,S=b!==o,O=_u(i,b,[]);this._getPreviousPlayers(b,S,l,f,e.toState).forEach(J=>{const ge=J.getRealPlayer();ge.beforeDestroy&&ge.beforeDestroy(),J.destroy(),O.push(J)})}R_(o,e.fromStyles)}_buildAnimation(t,e,i,r,o,l){const f=e.triggerName,g=e.element,b=[],S=new Set,O=new Set,$=e.timelines.map(ge=>{const Ce=ge.element;S.add(Ce);const je=Ce[Qd];if(je&&je.removedBeforeQueried)return new m1(ge.duration,ge.delay);const ft=Ce!==g,ot=function tJ(n){const t=[];return LB(n,t),t}((i.get(Ce)||qQ).map(Ri=>Ri.getRealPlayer())).filter(Ri=>!!Ri.element&&Ri.element===Ce),It=o.get(Ce),Yt=l.get(Ce),yn=hB(this._normalizer,ge.keyframes,It,Yt),ai=this._buildPlayer(ge,yn,ot);if(ge.subTimeline&&r&&O.add(Ce),ft){const Ri=new _2(t,f,Ce);Ri.setRealPlayer(ai),b.push(Ri)}return ai});b.forEach(ge=>{_u(this.playersByQueriedElement,ge.element,[]).push(ge),ge.onDone(()=>function XQ(n,t,e){let i=n.get(t);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&n.delete(t)}return i}(this.playersByQueriedElement,ge.element,ge))}),S.forEach(ge=>ad(ge,vB));const J=Zm($);return J.onDestroy(()=>{S.forEach(ge=>tv(ge,vB)),pf(g,e.toStyles)}),O.forEach(ge=>{_u(r,ge,[]).push(J)}),J}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new m1(t.duration,t.delay)}}class _2{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new m1,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>YM(t,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){_u(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function II(n){return n&&1===n.nodeType}function RB(n,t){const e=n.style.display;return n.style.display=t??"none",e}function OB(n,t,e,i,r){const o=[];e.forEach(g=>o.push(RB(g)));const l=[];i.forEach((g,b)=>{const S=new Map;g.forEach(O=>{const $=t.computeStyle(b,O,r);S.set(O,$),(!$||0==$.length)&&(b[Qd]=ZQ,l.push(b))}),n.set(b,S)});let f=0;return e.forEach(g=>RB(g,o[f++])),l}function FB(n,t){const e=new Map;if(n.forEach(f=>e.set(f,[])),0==t.length)return e;const r=new Set(t),o=new Map;function l(f){if(!f)return 1;let g=o.get(f);if(g)return g;const b=f.parentNode;return g=e.has(b)?b:r.has(b)?1:l(b),o.set(f,g),g}return t.forEach(f=>{const g=l(f);1!==g&&e.get(g).push(f)}),e}function ad(n,t){n.classList?.add(t)}function tv(n,t){n.classList?.remove(t)}function eJ(n,t,e){Zm(e).onDone(()=>n.processLeaveNode(t))}function LB(n,t){for(let e=0;e<n.length;e++){const i=n[e];i instanceof uB?LB(i.players,t):t.push(i)}}function NB(n,t,e){const i=e.get(n);if(!i)return!1;let r=t.get(n);return r?i.forEach(o=>r.add(o)):t.set(n,i),e.delete(n),!0}class TI{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new YQ(t,e,i),this._timelineEngine=new jQ(t,e,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(t,e,i,r,o){const l=t+"-"+r;let f=this._triggerCache[l];if(!f){const g=[],S=a2(this._driver,o,g,[]);if(g.length)throw function HX(n,t){return new gt(3404,!1)}();f=function BQ(n,t,e){return new VQ(n,t,e)}(r,S,this._normalizer),this._triggerCache[l]=f}this._transitionEngine.registerTrigger(e,r,f)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,r){this._transitionEngine.insertNode(t,e,i,r)}onRemove(t,e,i){this._transitionEngine.removeNode(t,e,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,r){if("@"==i.charAt(0)){const[o,l]=fB(i);this._timelineEngine.command(o,e,l,r)}else this._transitionEngine.trigger(t,e,i,r)}listen(t,e,i,r,o){if("@"==i.charAt(0)){const[l,f]=fB(i);return this._timelineEngine.listen(l,e,f,o)}return this._transitionEngine.listen(t,e,i,r,o)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(t){this._transitionEngine.afterFlushAnimationsDone(t)}}let rJ=(()=>{class n{static#e=this.initialStylesByElement=new WeakMap;constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let o=n.initialStylesByElement.get(e);o||n.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&pf(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(pf(this._element,this._initialStyles),this._endStyles&&(pf(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(R_(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(R_(this._element,this._endStyles),this._endStyles=null),pf(this._element,this._initialStyles),this._state=3)}}return n})();function y2(n){let t=null;return n.forEach((e,i)=>{(function oJ(n){return"display"===n||"position"===n})(i)&&(t=t||new Map,t.set(i,e))}),t}class BB{constructor(t,e,i,r){this.element=t,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(t,e,i){return t.animate(this._convertKeyframesToObject(e),i)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&t.set(r,this._finished?i:EB(this.element,r))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class sJ{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return mB(t,e)}getParentElement(t){return JM(t)}query(t,e,i){return gB(t,e,i)}computeStyle(t,e,i){return window.getComputedStyle(t)[e]}animate(t,e,i,r,o,l=[]){const g={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(g.easing=o);const b=new Map,S=l.filter(J=>J instanceof BB);(function fQ(n,t){return 0===n||0===t})(i,r)&&S.forEach(J=>{J.currentSnapshot.forEach((ge,Ce)=>b.set(Ce,ge))});let O=function uQ(n){return n.length?n[0]instanceof Map?n:n.map(t=>xB(t)):[]}(e).map(J=>Km(J));O=function pQ(n,t,e){if(e.size&&t.length){let i=t[0],r=[];if(e.forEach((o,l)=>{i.has(l)||r.push(l),i.set(l,o)}),r.length)for(let o=1;o<t.length;o++){let l=t[o];r.forEach(f=>l.set(f,EB(n,f)))}}return t}(t,O,b);const $=function iJ(n,t){let e=null,i=null;return Array.isArray(t)&&t.length?(e=y2(t[0]),t.length>1&&(i=y2(t[t.length-1]))):t instanceof Map&&(e=y2(t)),e||i?new rJ(n,e,i):null}(t,O);return new BB(t,O,g,$)}}let aJ=(()=>{class n extends rB{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Us.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?sB(e):e;return VB(this._renderer,null,i,"register",[r]),new lJ(i,this._renderer)}static#e=this.\u0275fac=function(i){return new(i||n)(it(y_),it(rr))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();class lJ extends wX{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new cJ(this._id,t,e||{},this._renderer)}}class cJ{constructor(t,e,i,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return VB(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function VB(n,t,e,i,r){return n.setProperty(t,`@@${e}:${i}`,r)}const zB="@.disabled";let uJ=(()=>{class n{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(o,l)=>{const f=l?.parentNode(o);f&&l.removeChild(f,o)}}createRenderer(e,i){const o=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let S=this._rendererCache.get(o);return S||(S=new UB("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,S)),S}const l=i.id,f=i.id+"-"+this._currentId;this._currentId++,this.engine.register(f,e);const g=S=>{Array.isArray(S)?S.forEach(g):this.engine.registerTrigger(l,f,e,S.name,S)};return i.data.animation.forEach(g),new dJ(this,f,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[l,f]=o;l(f)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#e=this.\u0275fac=function(i){return new(i||n)(it(y_),it(TI),it(wi))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();class UB{constructor(t,e,i,r){this.namespaceId=t,this.delegate=e,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(t){this.delegate.destroyNode?.(t)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,r=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,r){this.delegate.setAttribute(t,e,i,r)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,r){this.delegate.setStyle(t,e,i,r)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){"@"==e.charAt(0)&&e==zB?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class dJ extends UB{constructor(t,e,i,r,o){super(e,i,r,o),this.factory=t,this.namespaceId=e}setProperty(t,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==zB?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,e.slice(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if("@"==e.charAt(0)){const r=function hJ(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let o=e.slice(1),l="";return"@"!=o.charAt(0)&&([o,l]=function fJ(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(o)),this.engine.listen(this.namespaceId,r,o,l,f=>{this.factory.scheduleListenerCallback(f._data||-1,i,f)})}return this.delegate.listen(t,e,i)}}let pJ=(()=>{class n extends TI{constructor(e,i,r,o){super(e.body,i,r)}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr),it(e2),it(h2),it(jm))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const jB=[{provide:rB,useClass:aJ},{provide:h2,useFactory:function mJ(){return new OQ}},{provide:TI,useClass:pJ},{provide:y_,useFactory:function gJ(n,t,e){return new uJ(n,t,e)},deps:[UM,TI,wi]}],v2=[{provide:e2,useFactory:()=>new sJ},{provide:Ju,useValue:"BrowserAnimations"},...jB],$B=[{provide:e2,useClass:_B},{provide:Ju,useValue:"NoopAnimations"},...jB];let _J=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?$B:v2}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:v2,imports:[L4]})}return n})();const{isArray:yJ}=Array,{getPrototypeOf:vJ,prototype:xJ,keys:bJ}=Object;function HB(n){if(1===n.length){const t=n[0];if(yJ(t))return{args:t,keys:null};if(function wJ(n){return n&&"object"==typeof n&&vJ(n)===xJ}(t)){const e=bJ(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}const{isArray:EJ}=Array;function x2(n){return $t(t=>function CJ(n,t){return EJ(t)?n(...t):n(t)}(n,t))}function GB(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}function WB(...n){const t=te(n),{args:e,keys:i}=HB(n),r=new Kt(o=>{const{length:l}=e;if(!l)return void o.complete();const f=new Array(l);let g=l,b=l;for(let S=0;S<l;S++){let O=!1;hi(e[S]).subscribe(_n(o,$=>{O||(O=!0,b--),f[S]=$},()=>g--,void 0,()=>{(!g||!O)&&(b||o.next(i?GB(i,f):f),o.complete())}))}});return t?r.pipe(x2(t)):r}let qB=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static#e=this.\u0275fac=function(i){return new(i||n)(H(Hd),H(fr))};static#t=this.\u0275dir=On({type:n})}return n})(),F_=(()=>{class n extends qB{static#e=this.\u0275fac=function(){let e;return function(r){return(e||(e=ms(n)))(r||n)}}();static#t=this.\u0275dir=On({type:n,features:[Qi]})}return n})();const vu=new Xt("NgValueAccessor"),IJ={provide:vu,useExisting:Tt(()=>b2),multi:!0};let b2=(()=>{class n extends F_{writeValue(e){this.setProperty("checked",e)}static#e=this.\u0275fac=function(){let e;return function(r){return(e||(e=ms(n)))(r||n)}}();static#t=this.\u0275dir=On({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){1&i&&Qn("change",function(l){return r.onChange(l.target.checked)})("blur",function(){return r.onTouched()})},features:[oo([IJ]),Qi]})}return n})();const TJ={provide:vu,useExisting:Tt(()=>x1),multi:!0},AJ=new Xt("CompositionEventMode");let x1=(()=>{class n extends qB{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function DJ(){const n=$m()?$m().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static#e=this.\u0275fac=function(i){return new(i||n)(H(Hd),H(fr),H(AJ,8))};static#t=this.\u0275dir=On({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&Qn("input",function(l){return r._handleInput(l.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(l){return r._compositionEnd(l.target.value)})},features:[oo([TJ]),Qi]})}return n})();function Ym(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function ZB(n){return null!=n&&"number"==typeof n.length}const Ca=new Xt("NgValidators"),Xm=new Xt("NgAsyncValidators"),SJ=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Qm{static min(t){return function KB(n){return t=>{if(Ym(t.value)||Ym(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function YB(n){return t=>{if(Ym(t.value)||Ym(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return function XB(n){return Ym(n.value)?{required:!0}:null}(t)}static requiredTrue(t){return function QB(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function JB(n){return Ym(n.value)||SJ.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function eV(n){return t=>Ym(t.value)||!ZB(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function tV(n){return t=>ZB(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static pattern(t){return function nV(n){if(!n)return AI;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),i=>{if(Ym(i.value))return null;const r=i.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}(t)}static nullValidator(t){return null}static compose(t){return lV(t)}static composeAsync(t){return cV(t)}}function AI(n){return null}function iV(n){return null!=n}function rV(n){return jb(n)?ne(n):n}function oV(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function sV(n,t){return t.map(e=>e(n))}function aV(n){return n.map(t=>function MJ(n){return!n.validate}(t)?t:e=>t.validate(e))}function lV(n){if(!n)return null;const t=n.filter(iV);return 0==t.length?null:function(e){return oV(sV(e,t))}}function w2(n){return null!=n?lV(aV(n)):null}function cV(n){if(!n)return null;const t=n.filter(iV);return 0==t.length?null:function(e){return WB(sV(e,t).map(rV)).pipe($t(oV))}}function E2(n){return null!=n?cV(aV(n)):null}function uV(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function dV(n){return n._rawValidators}function hV(n){return n._rawAsyncValidators}function C2(n){return n?Array.isArray(n)?n:[n]:[]}function SI(n,t){return Array.isArray(n)?n.includes(t):n===t}function fV(n,t){const e=C2(t);return C2(n).forEach(r=>{SI(e,r)||e.push(r)}),e}function pV(n,t){return C2(t).filter(e=>!SI(n,e))}class mV{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=w2(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=E2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class El extends mV{get formDirective(){return null}get path(){return null}}class Rp extends mV{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class gV{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let I2=(()=>{class n extends gV{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||n)(H(Rp,2))};static#t=this.\u0275dir=On({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&zo("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Qi]})}return n})(),T2=(()=>{class n extends gV{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||n)(H(El,10))};static#t=this.\u0275dir=On({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&zo("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[Qi]})}return n})();const b1="VALID",PI="INVALID",nv="PENDING",w1="DISABLED";function S2(n){return(kI(n)?n.validators:n)||null}function M2(n,t){return(kI(t)?t.asyncValidators:n)||null}function kI(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function yV(n,t,e){const i=n.controls;if(!(t?Object.keys(i):i).length)throw new gt(1e3,"");if(!i[e])throw new gt(1001,"")}function vV(n,t,e){n._forEachChild((i,r)=>{if(void 0===e[r])throw new gt(1002,"")})}class RI{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===b1}get invalid(){return this.status===PI}get pending(){return this.status==nv}get disabled(){return this.status===w1}get enabled(){return this.status!==w1}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(fV(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(fV(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(pV(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(pV(t,this._rawAsyncValidators))}hasValidator(t){return SI(this._rawValidators,t)}hasAsyncValidator(t){return SI(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=nv,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=w1,this.errors=null,this._forEachChild(i=>{i.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=b1,this._forEachChild(i=>{i.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===b1||this.status===nv)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?w1:b1}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=nv,this._hasOwnPendingAsyncValidator=!0;const e=rV(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new ui,this.statusChanges=new ui}_calculateStatus(){return this._allControlsDisabled()?w1:this.errors?PI:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(nv)?nv:this._anyControlsHaveStatus(PI)?PI:b1}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){kI(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function OJ(n){return Array.isArray(n)?w2(n):n||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function FJ(n){return Array.isArray(n)?E2(n):n||null}(this._rawAsyncValidators)}}class E1 extends RI{constructor(t,e,i){super(S2(e),M2(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){vV(this,0,t),Object.keys(t).forEach(i=>{yV(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(i=>{const r=this.controls[i];r&&r.patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,r)=>{i.reset(t?t[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&t(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(t,e){let i=t;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class xV extends E1{}const L_=new Xt("CallSetDisabledState",{providedIn:"root",factory:()=>C1}),C1="always";function I1(n,t,e=C1){P2(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(n.disabled),function NJ(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&bV(n,t)})}(n,t),function VJ(n,t){const e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function BJ(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&bV(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function LJ(n,t){if(t.valueAccessor.setDisabledState){const e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function FI(n,t,e=!0){const i=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(i),t.valueAccessor.registerOnTouched(i)),NI(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function LI(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function P2(n,t){const e=dV(n);null!==t.validator?n.setValidators(uV(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const i=hV(n);null!==t.asyncValidator?n.setAsyncValidators(uV(i,t.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();LI(t._rawValidators,r),LI(t._rawAsyncValidators,r)}function NI(n,t){let e=!1;if(null!==n){if(null!==t.validator){const r=dV(n);if(Array.isArray(r)&&r.length>0){const o=r.filter(l=>l!==t.validator);o.length!==r.length&&(e=!0,n.setValidators(o))}}if(null!==t.asyncValidator){const r=hV(n);if(Array.isArray(r)&&r.length>0){const o=r.filter(l=>l!==t.asyncValidator);o.length!==r.length&&(e=!0,n.setAsyncValidators(o))}}}const i=()=>{};return LI(t._rawValidators,i),LI(t._rawAsyncValidators,i),e}function bV(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function wV(n,t){P2(n,t)}function EV(n,t){n._syncPendingControls(),t.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}const HJ={provide:El,useExisting:Tt(()=>iv)},T1=(()=>Promise.resolve())();let iv=(()=>{class n extends El{constructor(e,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new ui,this.form=new E1({},w2(e),E2(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){T1.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),I1(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){T1.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){T1.then(()=>{const i=this._findContainer(e.path),r=new E1({});wV(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){T1.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){T1.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,EV(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static#e=this.\u0275fac=function(i){return new(i||n)(H(Ca,10),H(Xm,10),H(L_,8))};static#t=this.\u0275dir=On({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){1&i&&Qn("submit",function(l){return r.onSubmit(l)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[oo([HJ]),Qi]})}return n})();function CV(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function IV(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const D1=class extends RI{constructor(t=null,e,i){super(S2(e),M2(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),kI(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=IV(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){CV(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){CV(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){IV(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};let F2=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=On({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return n})(),PV=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({})}return n})();const L2=new Xt("NgModelWithFormControlWarning"),JJ={provide:El,useExisting:Tt(()=>Jm)};let Jm=(()=>{class n extends El{constructor(e,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ui,this._setValidators(e),this._setAsyncValidators(i)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(NI(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const i=this.form.get(e.path);return I1(i,e,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),i}getControl(e){return this.form.get(e.path)}removeControl(e){FI(e.control||null,e,!1),function $J(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,i){this.form.get(e.path).setValue(i)}onSubmit(e){return this.submitted=!0,EV(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const i=e.control,r=this.form.get(e.path);i!==r&&(FI(i||null,e),(n=>n instanceof D1)(r)&&(I1(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const i=this.form.get(e.path);wV(i,e),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const i=this.form.get(e.path);i&&function zJ(n,t){return NI(n,t)}(i,e)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){P2(this.form,this),this._oldForm&&NI(this._oldForm,this)}_checkFormPresent(){}static#e=this.\u0275fac=function(i){return new(i||n)(H(Ca,10),H(Xm,10),H(L_,8))};static#t=this.\u0275dir=On({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){1&i&&Qn("submit",function(l){return r.onSubmit(l)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[oo([JJ]),Qi,P]})}return n})();const nee={provide:Rp,useExisting:Tt(()=>BI)};let BI=(()=>{class n extends Rp{set isDisabled(e){}static#e=this._ngModelWarningSentOnce=!1;constructor(e,i,r,o,l){super(),this._ngModelWarningConfig=l,this._added=!1,this.name=null,this.update=new ui,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function O2(n,t){if(!t)return null;let e,i,r;return Array.isArray(t),t.forEach(o=>{o.constructor===x1?e=o:function jJ(n){return Object.getPrototypeOf(n.constructor)===F_}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){this._added||this._setUpControl(),function R2(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return function OI(n,t){return[...t.path,n]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#t=this.\u0275fac=function(i){return new(i||n)(H(El,13),H(Ca,10),H(Xm,10),H(vu,10),H(L2,8))};static#n=this.\u0275dir=On({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[oo([nee]),Qi,P]})}return n})();const iee={provide:vu,useExisting:Tt(()=>VI),multi:!0};function LV(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let VI=(()=>{class n extends F_{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=LV(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function ree(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static#e=this.\u0275fac=function(){let e;return function(r){return(e||(e=ms(n)))(r||n)}}();static#t=this.\u0275dir=On({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&Qn("change",function(l){return r.onChange(l.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[oo([iee]),Qi]})}return n})(),NV=(()=>{class n{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(LV(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(Hd),H(VI,9))};static#t=this.\u0275dir=On({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return n})();const oee={provide:vu,useExisting:Tt(()=>V2),multi:!0};function BV(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let V2=(()=>{class n extends F_{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,l)=>{o._setSelected(r.indexOf(l.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const l=o;for(let f=0;f<l.length;f++){const b=this._getOptionValue(l[f].value);r.push(b)}}else{const l=i.options;for(let f=0;f<l.length;f++){const g=l[f];if(g.selected){const b=this._getOptionValue(g.value);r.push(b)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function see(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static#e=this.\u0275fac=function(){let e;return function(r){return(e||(e=ms(n)))(r||n)}}();static#t=this.\u0275dir=On({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&Qn("change",function(l){return r.onChange(l.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[oo([oee]),Qi]})}return n})(),VV=(()=>{class n{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(BV(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(BV(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(Hd),H(V2,9))};static#t=this.\u0275dir=On({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return n})(),KV=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[PV]})}return n})();class YV extends RI{constructor(t,e,i){super(S2(e),M2(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,i={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,e={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,i={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),e&&(this.controls.splice(r,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){vV(this,0,t),t.forEach((i,r)=>{yV(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,i)=>!!i._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function XV(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let U2,QV=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,i=null){const r=this._reduceControls(e);let o={};return XV(i)?o=i:null!==i&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new E1(r,o)}record(e,i=null){const r=this._reduceControls(e);return new xV(r,i)}control(e,i,r){let o={};return this.useNonNullable?(XV(i)?o=i:(o.validators=i,o.asyncValidators=r),new D1(e,{...o,nonNullable:!0})):new D1(e,i,r)}array(e,i,r){const o=e.map(l=>this._createControl(l));return new YV(o,i,r)}_reduceControls(e){const i={};return Object.keys(e).forEach(r=>{i[r]=this._createControl(e[r])}),i}_createControl(e){return e instanceof D1||e instanceof RI?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),mee=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:L_,useValue:e.callSetDisabledState??C1}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[KV]})}return n})(),JV=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:L2,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:L_,useValue:e.callSetDisabledState??C1}]}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[KV]})}return n})();try{U2=typeof Intl<"u"&&Intl.v8BreakIterator}catch{U2=!1}let A1,V_,j2,rl=(()=>{class n{constructor(e){this._platformId=e,this.isBrowser=this._platformId?function qK(n){return n===y4}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!U2)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}static#e=this.\u0275fac=function(i){return new(i||n)(it(bl))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function B_(n){return function gee(){if(null==A1&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>A1=!0}))}finally{A1=A1||!1}return A1}()?n:!!n.capture}function _ee(){if(null==V_){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return V_=!1,V_;if("scrollBehavior"in document.documentElement.style)V_=!0;else{const n=Element.prototype.scrollTo;V_=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return V_}function S1(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const t=n.shadowRoot.activeElement;if(t===n)break;n=t}return n}function eg(n){return n.composedPath?n.composedPath()[0]:n.target}function $2(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function tg(n,...t){return t.length?t.some(e=>n[e]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function Ls(n){return n<=0?()=>Sr:Ot((t,e)=>{let i=0;t.subscribe(_n(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}function tz(n){return aa((t,e)=>n<=e)}function ld(n){return Ot((t,e)=>{hi(n).subscribe(_n(e,()=>e.complete(),he)),!e.closed&&t.subscribe(e)})}function nc(n){return null!=n&&"false"!=`${n}`}function nz(n,t=0){return function Tee(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):t}function HI(n){return Array.isArray(n)?n:[n]}function la(n){return null==n?"":"string"==typeof n?n:`${n}px`}function cv(n){return n instanceof fr?n.nativeElement:n}let Aee=(()=>{class n{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),See=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[Aee]})}return n})();function GI(...n){const t=oe(n),e=te(n),{args:i,keys:r}=HB(n);if(0===i.length)return ne([],t);const o=new Kt(function Mee(n,t,e=wn){return i=>{iz(t,()=>{const{length:r}=n,o=new Array(r);let l=r,f=r;for(let g=0;g<r;g++)iz(t,()=>{const b=ne(n[g],t);let S=!1;b.subscribe(_n(i,O=>{o[g]=O,S||(S=!0,f--),f||i.next(e(o.slice()))},()=>{--l||i.complete()}))},i)},i)}}(i,t,r?l=>GB(r,l):wn));return e?o.pipe(x2(e)):o}function iz(n,t,e){n?Mo(e,n,t):t()}function k1(...n){return function Pee(){return qr(1)}()(ne(n,oe(n)))}class kee extends Me{constructor(t,e){super()}schedule(t,e=0){return this}}const WI={setInterval(n,t,...e){const{delegate:i}=WI;return i?.setInterval?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=WI;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class qI extends kee{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var i;if(this.closed)return this;this.state=t;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,e),this}requestAsyncId(t,e,i=0){return WI.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&WI.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,i=!1;try{this.work(t)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,h(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const W2={now:()=>(W2.delegate||Date).now(),delegate:void 0};class R1{constructor(t,e=R1.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}R1.now=W2.now;class ZI extends R1{constructor(t,e=R1.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}const uv=new ZI(qI),Ree=uv;function mf(...n){const t=oe(n);return Ot((e,i)=>{(t?k1(n,e,t):k1(n,e)).subscribe(i)})}const rz=new Set;let z_,Fee=(()=>{class n{constructor(e,i){this._platform=e,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Nee}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function Lee(n,t){if(!rz.has(n))try{z_||(z_=document.createElement("style"),t&&(z_.nonce=t),z_.setAttribute("type","text/css"),document.head.appendChild(z_)),z_.sheet&&(z_.sheet.insertRule(`@media ${n} {body{ }}`,0),rz.add(n))}catch(e){console.error(e)}}(e,this._nonce),this._matchMedia(e)}static#e=this.\u0275fac=function(i){return new(i||n)(it(rl),it(hb,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Nee(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let q2=(()=>{class n{constructor(e,i){this._mediaMatcher=e,this._zone=i,this._queries=new Map,this._destroySubject=new Oe}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return oz(HI(e)).some(r=>this._registerQuery(r).mql.matches)}observe(e){let o=GI(oz(HI(e)).map(l=>this._registerQuery(l).observable));return o=k1(o.pipe(Ls(1)),o.pipe(tz(1),function Oee(n,t=uv){return Ot((e,i)=>{let r=null,o=null,l=null;const f=()=>{if(r){r.unsubscribe(),r=null;const b=o;o=null,i.next(b)}};function g(){const b=l+n,S=t.now();if(S<b)return r=this.schedule(void 0,b-S),void i.add(r);f()}e.subscribe(_n(i,b=>{o=b,l=t.now(),r||(r=t.schedule(g,n),i.add(r))},()=>{f(),i.complete()},void 0,()=>{o=r=null}))})}(0))),o.pipe($t(l=>{const f={matches:!1,breakpoints:{}};return l.forEach(({matches:g,query:b})=>{f.matches=f.matches||g,f.breakpoints[b]=g}),f}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const i=this._mediaMatcher.matchMedia(e),o={observable:new Kt(l=>{const f=g=>this._zone.run(()=>l.next(g));return i.addListener(f),()=>{i.removeListener(f)}}).pipe(mf(i),$t(({matches:l})=>({query:e,matches:l})),ld(this._destroySubject)),mql:i};return this._queries.set(e,o),o}static#e=this.\u0275fac=function(i){return new(i||n)(it(Fee),it(wi))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function oz(n){return n.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}let KI=(()=>{class n{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function jee(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const i=function Uee(n){try{return n.frameElement}catch{return null}}(function Yee(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(e));if(i&&(-1===cz(i)||!this.isVisible(i)))return!1;let r=e.nodeName.toLowerCase(),o=cz(e);return e.hasAttribute("contenteditable")?-1!==o:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function Zee(n){let t=n.nodeName.toLowerCase(),e="input"===t&&n.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===r?!!e.hasAttribute("controls")&&-1!==o:"video"===r?-1!==o&&(null!==o||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,i){return function Kee(n){return!function Hee(n){return function Wee(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function $ee(n){let t=n.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(n)||function Gee(n){return function qee(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||lz(n))}(e)&&!this.isDisabled(e)&&(i?.ignoreVisibility||this.isVisible(e))}static#e=this.\u0275fac=function(i){return new(i||n)(it(rl))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lz(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let t=n.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function cz(n){if(!lz(n))return null;const t=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class Xee{get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}constructor(t,e,i,r,o=!1){this._element=t,this._checker=e,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,o||this.attachAnchors()}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const i=this._getFirstTabbableElement(e);return i?.focus(t),!!i}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let i=0;i<e.length;i++){const r=e[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[i]):null;if(r)return r}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let i=e.length-1;i>=0;i--){const r=e[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[i]):null;if(r)return r}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(Ls(1)).subscribe(t)}}let YI=(()=>{class n{constructor(e,i,r){this._checker=e,this._ngZone=i,this._document=r}create(e,i=!1){return new Xee(e,this._checker,this._ngZone,this._document,i)}static#e=this.\u0275fac=function(i){return new(i||n)(it(KI),it(wi),it(rr))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qee=(()=>{class n{get enabled(){return this.focusTrap.enabled}set enabled(e){this.focusTrap.enabled=nc(e)}get autoCapture(){return this._autoCapture}set autoCapture(e){this._autoCapture=nc(e)}constructor(e,i,r){this._elementRef=e,this._focusTrapFactory=i,this._previouslyFocusedElement=null,this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0)}ngOnDestroy(){this.focusTrap.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap.hasAttached()||this.focusTrap.attachAnchors()}ngOnChanges(e){const i=e.autoCapture;i&&!i.firstChange&&this.autoCapture&&this.focusTrap.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=S1(),this.focusTrap.focusInitialElementWhenReady()}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(YI),H(rr))};static#t=this.\u0275dir=On({type:n,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:["cdkTrapFocus","enabled"],autoCapture:["cdkTrapFocusAutoCapture","autoCapture"]},exportAs:["cdkTrapFocus"],features:[P]})}return n})();function uz(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function dz(n){const t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const Jee=new Xt("cdk-input-modality-detector-options"),ete={ignoreKeys:[18,17,224,91,16]},dv=B_({passive:!0,capture:!0});let tte=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(e,i,r,o){this._platform=e,this._mostRecentTarget=null,this._modality=new ee(null),this._lastTouchMs=0,this._onKeydown=l=>{this._options?.ignoreKeys?.some(f=>f===l.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=eg(l))},this._onMousedown=l=>{Date.now()-this._lastTouchMs<650||(this._modality.next(uz(l)?"keyboard":"mouse"),this._mostRecentTarget=eg(l))},this._onTouchstart=l=>{dz(l)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=eg(l))},this._options={...ete,...o},this.modalityDetected=this._modality.pipe(tz(1)),this.modalityChanged=this.modalityDetected.pipe(Xn()),e.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,dv),r.addEventListener("mousedown",this._onMousedown,dv),r.addEventListener("touchstart",this._onTouchstart,dv)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,dv),document.removeEventListener("mousedown",this._onMousedown,dv),document.removeEventListener("touchstart",this._onTouchstart,dv))}static#e=this.\u0275fac=function(i){return new(i||n)(it(rl),it(wi),it(rr),it(Jee,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const nte=new Xt("liveAnnouncerElement",{providedIn:"root",factory:function ite(){return null}}),rte=new Xt("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let ote=0,fz=(()=>{class n{constructor(e,i,r,o){this._ngZone=i,this._defaultOptions=o,this._document=r,this._liveElement=e||this._createLiveElement()}announce(e,...i){const r=this._defaultOptions;let o,l;return 1===i.length&&"number"==typeof i[0]?l=i[0]:[o,l]=i,this.clear(),clearTimeout(this._previousTimeout),o||(o=r&&r.politeness?r.politeness:"polite"),null==l&&r&&(l=r.duration),this._liveElement.setAttribute("aria-live",o),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(f=>this._currentResolve=f)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,"number"==typeof l&&(this._previousTimeout=setTimeout(()=>this.clear(),l)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",i=this._document.getElementsByClassName(e),r=this._document.createElement("div");for(let o=0;o<i.length;o++)i[o].remove();return r.classList.add(e),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),r.id="cdk-live-announcer-"+ote++,this._document.body.appendChild(r),r}_exposeAnnouncerToModals(e){const i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<i.length;r++){const o=i[r],l=o.getAttribute("aria-owns");l?-1===l.indexOf(e)&&o.setAttribute("aria-owns",l+" "+e):o.setAttribute("aria-owns",e)}}static#e=this.\u0275fac=function(i){return new(i||n)(it(nte,8),it(wi),it(rr),it(rte,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const ste=new Xt("cdk-focus-monitor-default-options"),XI=B_({passive:!0,capture:!0});let O1=(()=>{class n{constructor(e,i,r,o,l){this._ngZone=e,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new Oe,this._rootNodeFocusAndBlurListener=f=>{for(let b=eg(f);b;b=b.parentElement)"focus"===f.type?this._onFocus(f,b):this._onBlur(f,b)},this._document=o,this._detectionMode=l?.detectionMode||0}monitor(e,i=!1){const r=cv(e);if(!this._platform.isBrowser||1!==r.nodeType)return Te();const o=function vee(n){if(function yee(){if(null==j2){const n=typeof document<"u"?document.head:null;j2=!(!n||!n.createShadowRoot&&!n.attachShadow)}return j2}()){const t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(r)||this._getDocument(),l=this._elementInfo.get(r);if(l)return i&&(l.checkChildren=!0),l.subject;const f={checkChildren:i,subject:new Oe,rootNode:o};return this._elementInfo.set(r,f),this._registerGlobalListeners(f),f.subject}stopMonitoring(e){const i=cv(e),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(e,i,r){const o=cv(e);o===this._getDocument().activeElement?this._getClosestElementsInfo(o).forEach(([f,g])=>this._originChanged(f,i,g)):(this._setOrigin(i),"function"==typeof o.focus&&o.focus(r))}ngOnDestroy(){this._elementInfo.forEach((e,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,i){e.classList.toggle("cdk-focused",!!i),e.classList.toggle("cdk-touch-focused","touch"===i),e.classList.toggle("cdk-keyboard-focused","keyboard"===i),e.classList.toggle("cdk-mouse-focused","mouse"===i),e.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(e,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,i){const r=this._elementInfo.get(i),o=eg(e);!r||!r.checkChildren&&i!==o||this._originChanged(i,this._getFocusOrigin(o),r)}_onBlur(e,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&e.relatedTarget instanceof Node&&i.contains(e.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(e,i){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(i))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const i=e.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,XI),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,XI)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(ld(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(e){const i=e.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,XI),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,XI),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,i,r){this._setClasses(e,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(e){const i=[];return this._elementInfo.forEach((r,o)=>{(o===e||r.checkChildren&&o.contains(e))&&i.push([o,r])}),i}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const o=e.labels;if(o)for(let l=0;l<o.length;l++)if(o[l].contains(i))return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||n)(it(wi),it(rl),it(tte),it(rr,8),it(ste,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pz=(()=>{class n{constructor(e,i){this._elementRef=e,this._focusMonitor=i,this._focusOrigin=null,this.cdkFocusChange=new ui}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,1===e.nodeType&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(i=>{this._focusOrigin=i,this.cdkFocusChange.emit(i)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(O1))};static#t=this.\u0275dir=On({type:n,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]})}return n})();const mz="cdk-high-contrast-black-on-white",gz="cdk-high-contrast-white-on-black",Z2="cdk-high-contrast-active";let _z=(()=>{class n{constructor(e,i){this._platform=e,this._document=i,this._breakpointSubscription=xn(q2).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(e):null,o=(r&&r.backgroundColor||"").replace(/ /g,"");switch(e.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(Z2,mz,gz),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?e.add(Z2,mz):2===i&&e.add(Z2,gz)}}static#e=this.\u0275fac=function(i){return new(i||n)(it(rl),it(rr))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yz=(()=>{class n{constructor(e){e._applyBodyHighContrastModeCssClasses()}static#e=this.\u0275fac=function(i){return new(i||n)(it(_z))};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[See]})}return n})();const ate=new Xt("cdk-dir-doc",{providedIn:"root",factory:function lte(){return xn(rr)}}),cte=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let ng=(()=>{class n{constructor(e){this.value="ltr",this.change=new ui,e&&(this.value=function ute(n){const t=n?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?cte.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static#e=this.\u0275fac=function(i){return new(i||n)(it(ate,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),F1=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({})}return n})();const hte=new Xt("mat-sanity-checks",{providedIn:"root",factory:function dte(){return!0}});let xu=(()=>{class n{constructor(e,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!$2()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}static#e=this.\u0275fac=function(i){return new(i||n)(it(_z),it(hte,8),it(rr))};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[F1,F1]})}return n})();function fte(n){return class extends n{get disabled(){return this._disabled}set disabled(t){this._disabled=nc(t)}constructor(...t){super(...t),this._disabled=!1}}}function K2(n,t){return class extends n{get color(){return this._color}set color(e){const i=e||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...e){super(...e),this.defaultColor=t,this.color=t}}}function pte(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=nc(t)}constructor(...t){super(...t),this._disableRipple=!1}}}function mte(n){return class extends n{updateErrorState(){const t=this.errorState,o=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);o!==t&&(this.errorState=o,this.stateChanges.next())}constructor(...t){super(...t),this.errorState=!1}}}const bz=new Xt("MAT_DATE_LOCALE",{providedIn:"root",factory:function gte(){return xn(Zd)}});class Ws{constructor(){this._localeChanges=new Oe,this.localeChanges=this._localeChanges}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let i=this.isValid(t),r=this.isValid(e);return i&&r?!this.compareDate(t,e):i==r}return t==e}clampDate(t,e,i){return e&&this.compareDate(t,e)<0?e:i&&this.compareDate(t,i)>0?i:t}}const gf=new Xt("mat-date-formats"),_te=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function Y2(n,t){const e=Array(n);for(let i=0;i<n;i++)e[i]=t(i);return e}let yte=(()=>{class n extends Ws{constructor(e,i){super(),this.useUtcForDisplay=!1,super.setLocale(e)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){const i=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return Y2(12,r=>this._format(i,new Date(2017,r,1)))}getDateNames(){const e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return Y2(31,i=>this._format(e,new Date(2017,0,i+1)))}getDayOfWeekNames(e){const i=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return Y2(7,r=>this._format(i,new Date(2017,0,r+1)))}getYearName(e){const i=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(i,e)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,i,r){let o=this._createDateWithOverflow(e,i,r);return o.getMonth(),o}today(){return new Date}parse(e,i){return"number"==typeof e?new Date(e):e?new Date(Date.parse(e)):null}format(e,i){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");const r=new Intl.DateTimeFormat(this.locale,{...i,timeZone:"utc"});return this._format(r,e)}addCalendarYears(e,i){return this.addCalendarMonths(e,12*i)}addCalendarMonths(e,i){let r=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+i,this.getDate(e));return this.getMonth(r)!=((this.getMonth(e)+i)%12+12)%12&&(r=this._createDateWithOverflow(this.getYear(r),this.getMonth(r),0)),r}addCalendarDays(e,i){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+i)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if("string"==typeof e){if(!e)return null;if(_te.test(e)){let i=new Date(e);if(this.isValid(i))return i}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(e,i,r){const o=new Date;return o.setFullYear(e,i,r),o.setHours(0,0,0,0),o}_2digit(e){return("00"+e).slice(-2)}_format(e,i){const r=new Date;return r.setUTCFullYear(i.getFullYear(),i.getMonth(),i.getDate()),r.setUTCHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),e.format(r)}static#e=this.\u0275fac=function(i){return new(i||n)(it(bz,8),it(rl))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const vte={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let xte=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[{provide:Ws,useClass:yte}]})}return n})(),bte=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[{provide:gf,useValue:vte}],imports:[xte]})}return n})(),X2=(()=>{class n{isErrorState(e,i){return!!(e&&e.invalid&&(e.touched||i&&i.submitted))}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class wte{constructor(t,e,i,r=!1){this._renderer=t,this.element=e,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const wz=B_({passive:!0,capture:!0});class Ete{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const e=eg(t);e&&this._events.get(t.type)?.forEach((i,r)=>{(r===e||r.contains(e))&&i.forEach(o=>o.handleEvent(t))})}}addHandler(t,e,i,r){const o=this._events.get(e);if(o){const l=o.get(i);l?l.add(r):o.set(i,new Set([r]))}else this._events.set(e,new Map([[i,new Set([r])]])),t.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,wz)})}removeHandler(t,e,i){const r=this._events.get(t);if(!r)return;const o=r.get(e);o&&(o.delete(i),0===o.size&&r.delete(e),0===r.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,wz)))}}const Ez={enterDuration:225,exitDuration:150},Cz=B_({passive:!0,capture:!0}),Iz=["mousedown","touchstart"],Tz=["mouseup","mouseleave","touchend","touchcancel"];class QI{static#e=this._eventManager=new Ete;constructor(t,e,i,r){this._target=t,this._ngZone=e,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=cv(i))}fadeInRipple(t,e,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o={...Ez,...i.animation};i.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const l=i.radius||function Ite(n,t,e){const i=Math.max(Math.abs(n-e.left),Math.abs(n-e.right)),r=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(i*i+r*r)}(t,e,r),f=t-r.left,g=e-r.top,b=o.enterDuration,S=document.createElement("div");S.classList.add("mat-ripple-element"),S.style.left=f-l+"px",S.style.top=g-l+"px",S.style.height=2*l+"px",S.style.width=2*l+"px",null!=i.color&&(S.style.backgroundColor=i.color),S.style.transitionDuration=`${b}ms`,this._containerElement.appendChild(S);const O=window.getComputedStyle(S),J=O.transitionDuration,ge="none"===O.transitionProperty||"0s"===J||"0s, 0s"===J||0===r.width&&0===r.height,Ce=new wte(this,S,i,ge);S.style.transform="scale3d(1, 1, 1)",Ce.state=0,i.persistent||(this._mostRecentTransientRipple=Ce);let je=null;return!ge&&(b||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const ft=()=>this._finishRippleTransition(Ce),ot=()=>this._destroyRipple(Ce);S.addEventListener("transitionend",ft),S.addEventListener("transitioncancel",ot),je={onTransitionEnd:ft,onTransitionCancel:ot}}),this._activeRipples.set(Ce,je),(ge||!b)&&this._finishRippleTransition(Ce),Ce}fadeOutRipple(t){if(2===t.state||3===t.state)return;const e=t.element,i={...Ez,...t.config.animation};e.style.transitionDuration=`${i.exitDuration}ms`,e.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=cv(t);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,Iz.forEach(i=>{QI._eventManager.addHandler(this._ngZone,i,e,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{Tz.forEach(e=>{this._triggerElement.addEventListener(e,this,Cz)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const e=t===this._mostRecentTransientRipple,{persistent:i}=t.config;t.state=1,!i&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==e&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel)),t.element.remove()}_onMousedown(t){const e=uz(t),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!i&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!dz(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;if(e)for(let i=0;i<e.length;i++)this.fadeInRipple(e[i].clientX,e[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(Iz.forEach(e=>QI._eventManager.removeHandler(e,t,this)),this._pointerUpEventsRegistered&&Tz.forEach(e=>t.removeEventListener(e,this,Cz)))}}const Dz=new Xt("mat-ripple-global-options");let Tte=(()=>{class n{get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}constructor(e,i,r,o,l){this._elementRef=e,this._animationMode=l,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=o||{},this._rippleRenderer=new QI(this,i,e,r)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,i=0,r){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(wi),H(rl),H(Dz,8),H(Ju,8))};static#t=this.\u0275dir=On({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&zo("mat-ripple-unbounded",r.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return n})(),Dte=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[xu,xu]})}return n})();const Az={capture:!0},Sz=["focus","click","mouseenter","touchstart"],Q2="mat-ripple-loader-uninitialized",J2="mat-ripple-loader-class-name",Mz="mat-ripple-loader-centered",JI="mat-ripple-loader-disabled";let Ate=(()=>{class n{constructor(){this._document=xn(rr,{optional:!0}),this._animationMode=xn(Ju,{optional:!0}),this._globalRippleOptions=xn(Dz,{optional:!0}),this._platform=xn(rl),this._ngZone=xn(wi),this._onInteraction=e=>{if(!(e.target instanceof HTMLElement))return;const r=e.target.closest(`[${Q2}]`);r&&this.createRipple(r)},this._ngZone.runOutsideAngular(()=>{for(const e of Sz)this._document?.addEventListener(e,this._onInteraction,Az)})}ngOnDestroy(){for(const e of Sz)this._document?.removeEventListener(e,this._onInteraction,Az)}configureRipple(e,i){e.setAttribute(Q2,""),(i.className||!e.hasAttribute(J2))&&e.setAttribute(J2,i.className||""),i.centered&&e.setAttribute(Mz,""),i.disabled&&e.setAttribute(JI,"")}getRipple(e){return e.matRipple?e.matRipple:this.createRipple(e)}setDisabled(e,i){const r=e.matRipple;r?r.disabled=i:i?e.setAttribute(JI,""):e.removeAttribute(JI)}createRipple(e){if(!this._document)return;e.querySelector(".mat-ripple")?.remove();const i=this._document.createElement("span");i.classList.add("mat-ripple",e.getAttribute(J2)),e.append(i);const r=new Tte(new fr(i),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return r._isInitialized=!0,r.trigger=e,r.centered=e.hasAttribute(Mz),r.disabled=e.hasAttribute(JI),this.attachRipple(e,r),r}attachRipple(e,i){e.removeAttribute(Q2),e.matRipple=i}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function hv(n,t){const e=W(n)?n:()=>n,i=r=>r.error(e());return new Kt(t?r=>t.schedule(i,0,r):i)}function Dr(n,t,e){const i=W(n)||t||e?{next:n,error:t,complete:e}:n;return i?Ot((r,o)=>{var l;null===(l=i.subscribe)||void 0===l||l.call(i);let f=!0;r.subscribe(_n(o,g=>{var b;null===(b=i.next)||void 0===b||b.call(i,g),o.next(g)},()=>{var g;f=!1,null===(g=i.complete)||void 0===g||g.call(i),o.complete()},g=>{var b;f=!1,null===(b=i.error)||void 0===b||b.call(i,g),o.error(g)},()=>{var g,b;f&&(null===(g=i.unsubscribe)||void 0===g||g.call(i)),null===(b=i.finalize)||void 0===b||b.call(i)}))}):wn}function ca(n){return Ot((t,e)=>{let o,i=null,r=!1;i=t.subscribe(_n(e,void 0,void 0,l=>{o=hi(n(l,ca(n)(t))),i?(i.unsubscribe(),i=null,o.subscribe(e)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(e))})}const Ste=["*"];let eT;function N1(n){return function Mte(){if(void 0===eT&&(eT=null,typeof window<"u")){const n=window;void 0!==n.trustedTypes&&(eT=n.trustedTypes.createPolicy("angular#components",{createHTML:t=>t}))}return eT}()?.createHTML(n)||n}function Pz(n){return Error(`Unable to find icon with the name "${n}"`)}function kz(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function Rz(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class U_{constructor(t,e,i){this.url=t,this.svgText=e,this.options=i}}let tT=(()=>{class n{constructor(e,i,r,o){this._httpClient=e,this._sanitizer=i,this._errorHandler=o,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(e,i,r){return this.addSvgIconInNamespace("",e,i,r)}addSvgIconLiteral(e,i,r){return this.addSvgIconLiteralInNamespace("",e,i,r)}addSvgIconInNamespace(e,i,r,o){return this._addSvgIconConfig(e,i,new U_(r,null,o))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,i,r,o){const l=this._sanitizer.sanitize(va.HTML,r);if(!l)throw Rz(r);const f=N1(l);return this._addSvgIconConfig(e,i,new U_("",f,o))}addSvgIconSet(e,i){return this.addSvgIconSetInNamespace("",e,i)}addSvgIconSetLiteral(e,i){return this.addSvgIconSetLiteralInNamespace("",e,i)}addSvgIconSetInNamespace(e,i,r){return this._addSvgIconSetConfig(e,new U_(i,null,r))}addSvgIconSetLiteralInNamespace(e,i,r){const o=this._sanitizer.sanitize(va.HTML,i);if(!o)throw Rz(i);const l=N1(o);return this._addSvgIconSetConfig(e,new U_("",l,r))}registerFontClassAlias(e,i=e){return this._fontCssClassesByAlias.set(e,i),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){const i=this._sanitizer.sanitize(va.RESOURCE_URL,e);if(!i)throw kz(e);const r=this._cachedIconsByUrl.get(i);return r?Te(nT(r)):this._loadSvgIconFromConfig(new U_(e,null)).pipe(Dr(o=>this._cachedIconsByUrl.set(i,o)),$t(o=>nT(o)))}getNamedSvgIcon(e,i=""){const r=Oz(i,e);let o=this._svgIconConfigs.get(r);if(o)return this._getSvgFromConfig(o);if(o=this._getIconConfigFromResolvers(i,e),o)return this._svgIconConfigs.set(r,o),this._getSvgFromConfig(o);const l=this._iconSetConfigs.get(i);return l?this._getSvgFromIconSetConfigs(e,l):hv(Pz(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?Te(nT(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe($t(i=>nT(i)))}_getSvgFromIconSetConfigs(e,i){const r=this._extractIconWithNameFromAnySet(e,i);return r?Te(r):WB(i.filter(l=>!l.svgText).map(l=>this._loadSvgIconSetFromConfig(l).pipe(ca(f=>{const b=`Loading icon set URL: ${this._sanitizer.sanitize(va.RESOURCE_URL,l.url)} failed: ${f.message}`;return this._errorHandler.handleError(new Error(b)),Te(null)})))).pipe($t(()=>{const l=this._extractIconWithNameFromAnySet(e,i);if(!l)throw Pz(e);return l}))}_extractIconWithNameFromAnySet(e,i){for(let r=i.length-1;r>=0;r--){const o=i[r];if(o.svgText&&o.svgText.toString().indexOf(e)>-1){const l=this._svgElementFromConfig(o),f=this._extractSvgIconFromSet(l,e,o.options);if(f)return f}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(Dr(i=>e.svgText=i),$t(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?Te(null):this._fetchIcon(e).pipe(Dr(i=>e.svgText=i))}_extractSvgIconFromSet(e,i,r){const o=e.querySelector(`[id="${i}"]`);if(!o)return null;const l=o.cloneNode(!0);if(l.removeAttribute("id"),"svg"===l.nodeName.toLowerCase())return this._setSvgAttributes(l,r);if("symbol"===l.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(l),r);const f=this._svgElementFromString(N1("<svg></svg>"));return f.appendChild(l),this._setSvgAttributes(f,r)}_svgElementFromString(e){const i=this._document.createElement("DIV");i.innerHTML=e;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(e){const i=this._svgElementFromString(N1("<svg></svg>")),r=e.attributes;for(let o=0;o<r.length;o++){const{name:l,value:f}=r[o];"id"!==l&&i.setAttribute(l,f)}for(let o=0;o<e.childNodes.length;o++)e.childNodes[o].nodeType===this._document.ELEMENT_NODE&&i.appendChild(e.childNodes[o].cloneNode(!0));return i}_setSvgAttributes(e,i){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),i&&i.viewBox&&e.setAttribute("viewBox",i.viewBox),e}_fetchIcon(e){const{url:i,options:r}=e,o=r?.withCredentials??!1;if(!this._httpClient)throw function Pte(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const l=this._sanitizer.sanitize(va.RESOURCE_URL,i);if(!l)throw kz(i);const f=this._inProgressUrlFetches.get(l);if(f)return f;const g=this._httpClient.get(l,{responseType:"text",withCredentials:o}).pipe($t(b=>N1(b)),Gm(()=>this._inProgressUrlFetches.delete(l)),bt());return this._inProgressUrlFetches.set(l,g),g}_addSvgIconConfig(e,i,r){return this._svgIconConfigs.set(Oz(e,i),r),this}_addSvgIconSetConfig(e,i){const r=this._iconSetConfigs.get(e);return r?r.push(i):this._iconSetConfigs.set(e,[i]),this}_svgElementFromConfig(e){if(!e.svgElement){const i=this._svgElementFromString(e.svgText);this._setSvgAttributes(i,e.options),e.svgElement=i}return e.svgElement}_getIconConfigFromResolvers(e,i){for(let r=0;r<this._resolvers.length;r++){const o=this._resolvers[r](i,e);if(o)return Rte(o)?new U_(o.url,null,o.options):new U_(o,null)}}static#e=this.\u0275fac=function(i){return new(i||n)(it(h1,8),it(uI),it(rr,8),it(Xl))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function nT(n){return n.cloneNode(!0)}function Oz(n,t){return n+":"+t}function Rte(n){return!(!n.url||!n.options)}const Ote=K2(class{constructor(n){this._elementRef=n}}),Fte=new Xt("MAT_ICON_DEFAULT_OPTIONS"),Lte=new Xt("mat-icon-location",{providedIn:"root",factory:function Nte(){const n=xn(rr),t=n?n.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}}),Fz=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Bte=Fz.map(n=>`[${n}]`).join(", "),Vte=/^url\(['"]?#(.*?)['"]?\)$/;let iT=(()=>{class n extends Ote{get inline(){return this._inline}set inline(e){this._inline=nc(e)}get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}get fontSet(){return this._fontSet}set fontSet(e){const i=this._cleanupFontValue(e);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(e){const i=this._cleanupFontValue(e);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}constructor(e,i,r,o,l,f){super(e),this._iconRegistry=i,this._location=o,this._errorHandler=l,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=Me.EMPTY,f&&(f.color&&(this.color=this.defaultColor=f.color),f.fontSet&&(this.fontSet=f.fontSet)),r||e.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];const i=e.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const e=this._elementsWithExternalReferences;if(e&&e.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){const e=this._elementRef.nativeElement;let i=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=e.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const e=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>e.classList.remove(r)),i.forEach(r=>e.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return"string"==typeof e?e.trim().split(" ")[0]:e}_prependPathToReferences(e){const i=this._elementsWithExternalReferences;i&&i.forEach((r,o)=>{r.forEach(l=>{o.setAttribute(l.name,`url('${e}#${l.value}')`)})})}_cacheChildrenWithExternalReferences(e){const i=e.querySelectorAll(Bte),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let o=0;o<i.length;o++)Fz.forEach(l=>{const f=i[o],g=f.getAttribute(l),b=g?g.match(Vte):null;if(b){let S=r.get(f);S||(S=[],r.set(f,S)),S.push({name:l,value:b[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){const[i,r]=this._splitIconName(e);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Ls(1)).subscribe(o=>this._setSvgElement(o),o=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${o.message}`))})}}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(tT),Fh("aria-hidden"),H(Lte),H(Xl),H(Fte,8))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(i,r){2&i&&(ro("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),zo("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Qi],ngContentSelectors:Ste,decls:1,vars:0,template:function(i,r){1&i&&(uf(),il(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return n})(),Lz=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[xu,xu]})}return n})();const rT=ie(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function oT(n){return new Kt(t=>{hi(n()).subscribe(t)})}function eP(){return Ot((n,t)=>{let e=null;n._refCount++;const i=_n(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const r=n._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}class Nz extends Kt{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Ft(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Me;const e=this.getSubject();t.add(this.source.subscribe(_n(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Me.EMPTY)}return t}refCount(){return eP()(this)}}function sT(n){return Ot((t,e)=>{let i=!1;t.subscribe(_n(e,r=>{i=!0,e.next(r)},()=>{i||e.next(n),e.complete()}))})}function Bz(n=Ute){return Ot((t,e)=>{let i=!1;t.subscribe(_n(e,r=>{i=!0,e.next(r)},()=>i?e.complete():e.error(n())))})}function Ute(){return new rT}function _f(n,t){const e=arguments.length>=2;return i=>i.pipe(n?aa((r,o)=>n(r,o,i)):wn,Ls(1),e?sT(t):Bz(()=>new rT))}function aT(n,t){return Ot(function jte(n,t,e,i,r){return(o,l)=>{let f=e,g=t,b=0;o.subscribe(_n(l,S=>{const O=b++;g=f?n(g,S,O):(f=!0,S),i&&l.next(g)},r&&(()=>{f&&l.next(g),l.complete()})))}}(n,t,arguments.length>=2,!0))}function tP(n){return n<=0?()=>Sr:Ot((t,e)=>{let i=[];t.subscribe(_n(e,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)e.next(r);e.complete()},void 0,()=>{i=null}))})}function Vz(n){return $t(()=>n)}const ar="primary",B1=Symbol("RouteTitle");class Hte{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function fv(n){return new Hte(n)}function Gte(n,t,e){const i=e.path.split("/");if(i.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||i.length<n.length))return null;const r={};for(let o=0;o<i.length;o++){const l=i[o],f=n[o];if(l.startsWith(":"))r[l.substring(1)]=f;else if(l!==f.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function yf(n,t){const e=n?Object.keys(n):void 0,i=t?Object.keys(t):void 0;if(!e||!i||e.length!=i.length)return!1;let r;for(let o=0;o<e.length;o++)if(r=e[o],!zz(n[r],t[r]))return!1;return!0}function zz(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),i=[...t].sort();return e.every((r,o)=>i[o]===r)}return n===t}function Uz(n){return n.length>0?n[n.length-1]:null}function ig(n){return function zte(n){return!!n&&(n instanceof Kt||W(n.lift)&&W(n.subscribe))}(n)?n:jb(n)?ne(Promise.resolve(n)):Te(n)}const qte={exact:function Hz(n,t,e){if(!j_(n.segments,t.segments)||!lT(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!n.children[i]||!Hz(n.children[i],t.children[i],e))return!1;return!0},subset:Gz},jz={exact:function Zte(n,t){return yf(n,t)},subset:function Kte(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>zz(n[e],t[e]))},ignored:()=>!0};function $z(n,t,e){return qte[e.paths](n.root,t.root,e.matrixParams)&&jz[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function Gz(n,t,e){return Wz(n,t,t.segments,e)}function Wz(n,t,e,i){if(n.segments.length>e.length){const r=n.segments.slice(0,e.length);return!(!j_(r,e)||t.hasChildren()||!lT(r,e,i))}if(n.segments.length===e.length){if(!j_(n.segments,e)||!lT(n.segments,e,i))return!1;for(const r in t.children)if(!n.children[r]||!Gz(n.children[r],t.children[r],i))return!1;return!0}{const r=e.slice(0,n.segments.length),o=e.slice(n.segments.length);return!!(j_(n.segments,r)&&lT(n.segments,r,i)&&n.children[ar])&&Wz(n.children[ar],t,o,i)}}function lT(n,t,e){return t.every((i,r)=>jz[e](n[r].parameters,i.parameters))}class pv{constructor(t=new yo([],{}),e={},i=null){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fv(this.queryParams)),this._queryParamMap}toString(){return Qte.serialize(this)}}class yo{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Object.values(e).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return cT(this)}}class V1{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=fv(this.parameters)),this._parameterMap}toString(){return Kz(this)}}function j_(n,t){return n.length===t.length&&n.every((e,i)=>e.path===t[i].path)}let z1=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:function(){return new nP},providedIn:"root"})}return n})();class nP{parse(t){const e=new cne(t);return new pv(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${U1(t.root,!0)}`,i=function tne(n){const t=Object.keys(n).map(e=>{const i=n[e];return Array.isArray(i)?i.map(r=>`${uT(e)}=${uT(r)}`).join("&"):`${uT(e)}=${uT(i)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${i}${"string"==typeof t.fragment?`#${function Jte(n){return encodeURI(n)}(t.fragment)}`:""}`}}const Qte=new nP;function cT(n){return n.segments.map(t=>Kz(t)).join("/")}function U1(n,t){if(!n.hasChildren())return cT(n);if(t){const e=n.children[ar]?U1(n.children[ar],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==ar&&i.push(`${r}:${U1(o,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function Xte(n,t){let e=[];return Object.entries(n.children).forEach(([i,r])=>{i===ar&&(e=e.concat(t(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==ar&&(e=e.concat(t(r,i)))}),e}(n,(i,r)=>r===ar?[U1(n.children[ar],!1)]:[`${r}:${U1(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[ar]?`${cT(n)}/${e[0]}`:`${cT(n)}/(${e.join("//")})`}}function qz(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function uT(n){return qz(n).replace(/%3B/gi,";")}function iP(n){return qz(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function dT(n){return decodeURIComponent(n)}function Zz(n){return dT(n.replace(/\+/g,"%20"))}function Kz(n){return`${iP(n.path)}${function ene(n){return Object.keys(n).map(t=>`;${iP(t)}=${iP(n[t])}`).join("")}(n.parameters)}`}const nne=/^[^\/()?;#]+/;function rP(n){const t=n.match(nne);return t?t[0]:""}const ine=/^[^\/()?;=#]+/,one=/^[^=?&#]+/,ane=/^[^&#]+/;class cne{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new yo([],{}):new yo([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[ar]=new yo(t,e)),i}parseSegment(){const t=rP(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new gt(4009,!1);return this.capture(t),new V1(dT(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=function rne(n){const t=n.match(ine);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const r=rP(this.remaining);r&&(i=r,this.capture(i))}t[dT(e)]=dT(i)}parseQueryParam(t){const e=function sne(n){const t=n.match(one);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const l=function lne(n){const t=n.match(ane);return t?t[0]:""}(this.remaining);l&&(i=l,this.capture(i))}const r=Zz(e),o=Zz(i);if(t.hasOwnProperty(r)){let l=t[r];Array.isArray(l)||(l=[l],t[r]=l),l.push(o)}else t[r]=o}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=rP(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new gt(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=ar);const l=this.parseChildren();e[o]=1===Object.keys(l).length?l[ar]:new yo([],l),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new gt(4011,!1)}}function Yz(n){return n.segments.length>0?new yo([],{[ar]:n}):n}function Xz(n){const t={};for(const i of Object.keys(n.children)){const o=Xz(n.children[i]);if(i===ar&&0===o.segments.length&&o.hasChildren())for(const[l,f]of Object.entries(o.children))t[l]=f;else(o.segments.length>0||o.hasChildren())&&(t[i]=o)}return function une(n){if(1===n.numberOfChildren&&n.children[ar]){const t=n.children[ar];return new yo(n.segments.concat(t.segments),t.children)}return n}(new yo(n.segments,t))}function $_(n){return n instanceof pv}function Qz(n){let t;const r=Yz(function e(o){const l={};for(const g of o.children){const b=e(g);l[g.outlet]=b}const f=new yo(o.url,l);return o===n&&(t=f),f}(n.root));return t??r}function Jz(n,t,e,i){let r=n;for(;r.parent;)r=r.parent;if(0===t.length)return oP(r,r,r,e,i);const o=function hne(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new t5(!0,0,n);let t=0,e=!1;const i=n.reduce((r,o,l)=>{if("object"==typeof o&&null!=o){if(o.outlets){const f={};return Object.entries(o.outlets).forEach(([g,b])=>{f[g]="string"==typeof b?b.split("/"):b}),[...r,{outlets:f}]}if(o.segmentPath)return[...r,o.segmentPath]}return"string"!=typeof o?[...r,o]:0===l?(o.split("/").forEach((f,g)=>{0==g&&"."===f||(0==g&&""===f?e=!0:".."===f?t++:""!=f&&r.push(f))}),r):[...r,o]},[]);return new t5(e,t,i)}(t);if(o.toRoot())return oP(r,r,new yo([],{}),e,i);const l=function fne(n,t,e){if(n.isAbsolute)return new fT(t,!0,0);if(!e)return new fT(t,!1,NaN);if(null===e.parent)return new fT(e,!0,0);const i=hT(n.commands[0])?0:1;return function pne(n,t,e){let i=n,r=t,o=e;for(;o>r;){if(o-=r,i=i.parent,!i)throw new gt(4005,!1);r=i.segments.length}return new fT(i,!1,r-o)}(e,e.segments.length-1+i,n.numberOfDoubleDots)}(o,r,n),f=l.processChildren?$1(l.segmentGroup,l.index,o.commands):n5(l.segmentGroup,l.index,o.commands);return oP(r,l.segmentGroup,f,e,i)}function hT(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function j1(n){return"object"==typeof n&&null!=n&&n.outlets}function oP(n,t,e,i,r){let l,o={};i&&Object.entries(i).forEach(([g,b])=>{o[g]=Array.isArray(b)?b.map(S=>`${S}`):`${b}`}),l=n===t?e:e5(n,t,e);const f=Yz(Xz(l));return new pv(f,o,r)}function e5(n,t,e){const i={};return Object.entries(n.children).forEach(([r,o])=>{i[r]=o===t?e:e5(o,t,e)}),new yo(n.segments,i)}class t5{constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&hT(i[0]))throw new gt(4003,!1);const r=i.find(j1);if(r&&r!==Uz(i))throw new gt(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class fT{constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function n5(n,t,e){if(n||(n=new yo([],{})),0===n.segments.length&&n.hasChildren())return $1(n,t,e);const i=function gne(n,t,e){let i=0,r=t;const o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=e.length)return o;const l=n.segments[r],f=e[i];if(j1(f))break;const g=`${f}`,b=i<e.length-1?e[i+1]:null;if(r>0&&void 0===g)break;if(g&&b&&"object"==typeof b&&void 0===b.outlets){if(!o5(g,b,l))return o;i+=2}else{if(!o5(g,{},l))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,t,e),r=e.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const o=new yo(n.segments.slice(0,i.pathIndex),{});return o.children[ar]=new yo(n.segments.slice(i.pathIndex),n.children),$1(o,0,r)}return i.match&&0===r.length?new yo(n.segments,{}):i.match&&!n.hasChildren()?sP(n,t,e):i.match?$1(n,0,r):sP(n,t,e)}function $1(n,t,e){if(0===e.length)return new yo(n.segments,{});{const i=function mne(n){return j1(n[0])?n[0].outlets:{[ar]:n}}(e),r={};if(Object.keys(i).some(o=>o!==ar)&&n.children[ar]&&1===n.numberOfChildren&&0===n.children[ar].segments.length){const o=$1(n.children[ar],t,e);return new yo(n.segments,o.children)}return Object.entries(i).forEach(([o,l])=>{"string"==typeof l&&(l=[l]),null!==l&&(r[o]=n5(n.children[o],t,l))}),Object.entries(n.children).forEach(([o,l])=>{void 0===i[o]&&(r[o]=l)}),new yo(n.segments,r)}}function sP(n,t,e){const i=n.segments.slice(0,t);let r=0;for(;r<e.length;){const o=e[r];if(j1(o)){const g=_ne(o.outlets);return new yo(i,g)}if(0===r&&hT(e[0])){i.push(new V1(n.segments[t].path,r5(e[0]))),r++;continue}const l=j1(o)?o.outlets[ar]:`${o}`,f=r<e.length-1?e[r+1]:null;l&&f&&hT(f)?(i.push(new V1(l,r5(f))),r+=2):(i.push(new V1(l,{})),r++)}return new yo(i,{})}function _ne(n){const t={};return Object.entries(n).forEach(([e,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(t[e]=sP(new yo([],{}),0,i))}),t}function r5(n){const t={};return Object.entries(n).forEach(([e,i])=>t[e]=`${i}`),t}function o5(n,t,e){return n==e.path&&yf(t,e.parameters)}const H1="imperative";class vf{constructor(t,e){this.id=t,this.url=e}}class pT extends vf{constructor(t,e,i="imperative",r=null){super(t,e),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class rg extends vf{constructor(t,e,i){super(t,e),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class G1 extends vf{constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class mv extends vf{constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r,this.type=16}}class mT extends vf{constructor(t,e,i,r){super(t,e),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class s5 extends vf{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yne extends vf{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vne extends vf{constructor(t,e,i,r,o){super(t,e),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class xne extends vf{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bne extends vf{constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class wne{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Ene{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Cne{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ine{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Tne{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Dne{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class a5{constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class aP{}class lP{constructor(t){this.url=t}}class Ane{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new W1,this.attachRef=null}}let W1=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,i){const r=this.getOrCreateContext(e);r.outlet=i,this.contexts.set(e,r)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new Ane,this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class l5{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=cP(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){const e=cP(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=uP(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return uP(t,this._root).map(e=>e.value)}}function cP(n,t){if(n===t.value)return t;for(const e of t.children){const i=cP(n,e);if(i)return i}return null}function uP(n,t){if(n===t.value)return[t];for(const e of t.children){const i=uP(n,e);if(i.length)return i.unshift(t),i}return[]}class Op{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function gv(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class c5 extends l5{constructor(t,e){super(t),this.snapshot=e,dP(this,t)}toString(){return this.snapshot.toString()}}function u5(n,t){const e=function Sne(n,t){const l=new gT([],{},{},"",{},ar,t,null,{});return new h5("",new Op(l,[]))}(0,t),i=new ee([new V1("",{})]),r=new ee({}),o=new ee({}),l=new ee({}),f=new ee(""),g=new _v(i,r,l,f,o,ar,t,e.root);return g.snapshot=e.root,new c5(new Op(g,[]),e)}class _v{constructor(t,e,i,r,o,l,f,g){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=l,this.component=f,this._futureSnapshot=g,this.title=this.dataSubject?.pipe($t(b=>b[B1]))??Te(void 0),this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe($t(t=>fv(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe($t(t=>fv(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function d5(n,t="emptyOnly"){const e=n.pathFromRoot;let i=0;if("always"!==t)for(i=e.length-1;i>=1;){const r=e[i],o=e[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(o.component)break;i--}}return function Mne(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(i))}class gT{get title(){return this.data?.[B1]}constructor(t,e,i,r,o,l,f,g,b){this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=l,this.component=f,this.routeConfig=g,this._resolve=b}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=fv(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fv(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class h5 extends l5{constructor(t,e){super(e),this.url=t,dP(this,e)}toString(){return f5(this._root)}}function dP(n,t){t.value._routerState=n,t.children.forEach(e=>dP(n,e))}function f5(n){const t=n.children.length>0?` { ${n.children.map(f5).join(", ")} } `:"";return`${n.value}${t}`}function hP(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,yf(t.queryParams,e.queryParams)||n.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&n.fragmentSubject.next(e.fragment),yf(t.params,e.params)||n.paramsSubject.next(e.params),function Wte(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!yf(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.urlSubject.next(e.url),yf(t.data,e.data)||n.dataSubject.next(e.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function fP(n,t){const e=yf(n.params,t.params)&&function Yte(n,t){return j_(n,t)&&n.every((e,i)=>yf(e.parameters,t[i].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||fP(n.parent,t.parent))}let pP=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=ar,this.activateEvents=new ui,this.deactivateEvents=new ui,this.attachEvents=new ui,this.detachEvents=new ui,this.parentContexts=xn(W1),this.location=xn(pu),this.changeDetector=xn(mu),this.environmentInjector=xn(ra),this.inputBinder=xn(_T,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(e){if(e.name){const{firstChange:i,previousValue:r}=e.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new gt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new gt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new gt(4012,!1);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new gt(4013,!1);this._activatedRoute=e;const r=this.location,l=e.snapshot.component,f=this.parentContexts.getOrCreateContext(this.name).children,g=new Pne(e,f,r.injector);this.activated=r.createComponent(l,{index:r.length,injector:g,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=On({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[P]})}return n})();class Pne{constructor(t,e,i){this.route=t,this.childContexts=e,this.parent=i}get(t,e){return t===_v?this.route:t===W1?this.childContexts:this.parent.get(t,e)}}const _T=new Xt("");let p5=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){const{activatedRoute:i}=e,r=GI([i.queryParams,i.params,i.data]).pipe(bn(([o,l,f],g)=>(f={...o,...l,...f},0===g?Te(f):Promise.resolve(f)))).subscribe(o=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(e);const l=function AZ(n){const t=nr(n);if(!t)return null;const e=new Nb(t);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}(i.component);if(l)for(const{templateName:f}of l.inputs)e.activatedComponentRef.setInput(f,o[f]);else this.unsubscribeFromRouteData(e)});this.outletDataSubscriptions.set(e,r)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();function q1(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const i=e.value;i._futureSnapshot=t.value;const r=function Rne(n,t,e){return t.children.map(i=>{for(const r of e.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return q1(n,i,r);return q1(n,i)})}(n,t,e);return new Op(i,r)}{if(n.shouldAttach(t.value)){const o=n.retrieve(t.value);if(null!==o){const l=o.route;return l.value._futureSnapshot=t.value,l.children=t.children.map(f=>q1(n,f)),l}}const i=function One(n){return new _v(new ee(n.url),new ee(n.params),new ee(n.queryParams),new ee(n.fragment),new ee(n.data),n.outlet,n.component,n)}(t.value),r=t.children.map(o=>q1(n,o));return new Op(i,r)}}const mP="ngNavigationCancelingError";function m5(n,t){const{redirectTo:e,navigationBehaviorOptions:i}=$_(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=g5(!1,0,t);return r.url=e,r.navigationBehaviorOptions=i,r}function g5(n,t,e){const i=new Error("NavigationCancelingError: "+(n||""));return i[mP]=!0,i.cancellationCode=t,e&&(i.url=e),i}function _5(n){return n&&n[mP]}let y5=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Wi({type:n,selectors:[["ng-component"]],standalone:!0,features:[bN],decls:1,vars:0,template:function(i,r){1&i&&Ji(0,"router-outlet")},dependencies:[pP],encapsulation:2})}return n})();function gP(n){const t=n.children&&n.children.map(gP),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==ar&&(e.component=y5),e}function Jd(n){return n.outlet||ar}function Z1(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class jne{constructor(t,e,i,r,o){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),hP(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const r=gv(e);t.children.forEach(o=>{const l=o.value.outlet;this.deactivateRoutes(o,r[l],i),delete r[l]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(t,e,i){const r=t.value,o=e?e.value:null;if(r===o)if(r.component){const l=i.getContext(r.outlet);l&&this.deactivateChildRoutes(t,e,l.children)}else this.deactivateChildRoutes(t,e,i);else o&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,o=gv(t);for(const l of Object.keys(o))this.deactivateRouteAndItsChildren(o[l],r);if(i&&i.outlet){const l=i.outlet.detach(),f=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:l,route:t,contexts:f})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,o=gv(t);for(const l of Object.keys(o))this.deactivateRouteAndItsChildren(o[l],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(t,e,i){const r=gv(e);t.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new Dne(o.value.snapshot))}),t.children.length&&this.forwardEvent(new Ine(t.value.snapshot))}activateRoutes(t,e,i){const r=t.value,o=e?e.value:null;if(hP(r),r===o)if(r.component){const l=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,l.children)}else this.activateChildRoutes(t,e,i);else if(r.component){const l=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const f=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),l.children.onOutletReAttached(f.contexts),l.attachRef=f.componentRef,l.route=f.route.value,l.outlet&&l.outlet.attach(f.componentRef,f.route.value),hP(f.route.value),this.activateChildRoutes(t,null,l.children)}else{const f=Z1(r.snapshot);l.attachRef=null,l.route=r,l.injector=f,l.outlet&&l.outlet.activateWith(r,l.injector),this.activateChildRoutes(t,null,l.children)}}else this.activateChildRoutes(t,null,i)}}class v5{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class yT{constructor(t,e){this.component=t,this.route=e}}function $ne(n,t,e){const i=n._root;return K1(i,t?t._root:null,e,[i.value])}function yv(n,t){const e=Symbol(),i=t.get(n,e);return i===e?"function"!=typeof n||function Du(n){return null!==dc(n)}(n)?t.get(n):n:i}function K1(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=gv(t);return n.children.forEach(l=>{(function Gne(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=n.value,l=t?t.value:null,f=e?e.getContext(n.value.outlet):null;if(l&&o.routeConfig===l.routeConfig){const g=function Wne(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!j_(n.url,t.url);case"pathParamsOrQueryParamsChange":return!j_(n.url,t.url)||!yf(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!fP(n,t)||!yf(n.queryParams,t.queryParams);default:return!fP(n,t)}}(l,o,o.routeConfig.runGuardsAndResolvers);g?r.canActivateChecks.push(new v5(i)):(o.data=l.data,o._resolvedData=l._resolvedData),K1(n,t,o.component?f?f.children:null:e,i,r),g&&f&&f.outlet&&f.outlet.isActivated&&r.canDeactivateChecks.push(new yT(f.outlet.component,l))}else l&&Y1(t,f,r),r.canActivateChecks.push(new v5(i)),K1(n,null,o.component?f?f.children:null:e,i,r)})(l,o[l.value.outlet],e,i.concat([l.value]),r),delete o[l.value.outlet]}),Object.entries(o).forEach(([l,f])=>Y1(f,e.getContext(l),r)),r}function Y1(n,t,e){const i=gv(n),r=n.value;Object.entries(i).forEach(([o,l])=>{Y1(l,r.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new yT(r.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,r))}function X1(n){return"function"==typeof n}function x5(n){return n instanceof rT||"EmptyError"===n?.name}const vT=Symbol("INITIAL_VALUE");function vv(){return bn(n=>GI(n.map(t=>t.pipe(Ls(1),mf(vT)))).pipe($t(t=>{for(const e of t)if(!0!==e){if(e===vT)return vT;if(!1===e||e instanceof pv)return e}return!0}),aa(t=>t!==vT),Ls(1)))}function b5(n){return function Rt(...n){return Jn(n)}(Dr(t=>{if($_(t))throw m5(0,t)}),$t(t=>!0===t))}class xT{constructor(t){this.segmentGroup=t||null}}class w5{constructor(t){this.urlTree=t}}function xv(n){return hv(new xT(n))}function E5(n){return hv(new w5(n))}class hie{constructor(t,e){this.urlSerializer=t,this.urlTree=e}noMatchError(t){return new gt(4002,!1)}lineralizeSegments(t,e){let i=[],r=e.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Te(i);if(r.numberOfChildren>1||!r.children[ar])return hv(new gt(4e3,!1));r=r.children[ar]}}applyRedirectCommands(t,e,i){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,i)}applyRedirectCreateUrlTree(t,e,i,r){const o=this.createSegmentGroup(t,e.root,i,r);return new pv(o,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return Object.entries(t).forEach(([r,o])=>{if("string"==typeof o&&o.startsWith(":")){const f=o.substring(1);i[r]=e[f]}else i[r]=o}),i}createSegmentGroup(t,e,i,r){const o=this.createSegments(t,e.segments,i,r);let l={};return Object.entries(e.children).forEach(([f,g])=>{l[f]=this.createSegmentGroup(t,g,i,r)}),new yo(o,l)}createSegments(t,e,i,r){return e.map(o=>o.path.startsWith(":")?this.findPosParam(t,o,r):this.findOrReturn(o,i))}findPosParam(t,e,i){const r=i[e.path.substring(1)];if(!r)throw new gt(4001,!1);return r}findOrReturn(t,e){let i=0;for(const r of e){if(r.path===t.path)return e.splice(i),r;i++}return t}}const _P={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function fie(n,t,e,i,r){const o=yP(n,t,e);return o.matched?(i=function Lne(n,t){return n.providers&&!n._injector&&(n._injector=zS(n.providers,t,`Route: ${n.path}`)),n._injector??t}(t,i),function cie(n,t,e,i){const r=t.canMatch;return r&&0!==r.length?Te(r.map(l=>{const f=yv(l,n);return ig(function Qne(n){return n&&X1(n.canMatch)}(f)?f.canMatch(t,e):n.runInContext(()=>f(t,e)))})).pipe(vv(),b5()):Te(!0)}(i,t,e).pipe($t(l=>!0===l?o:{..._P}))):Te(o)}function yP(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{..._P}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const r=(t.matcher||Gte)(e,n,t);if(!r)return{..._P};const o={};Object.entries(r.posParams??{}).forEach(([f,g])=>{o[f]=g.path});const l=r.consumed.length>0?{...o,...r.consumed[r.consumed.length-1].parameters}:o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:l,positionalParamSegments:r.posParams??{}}}function C5(n,t,e,i){return e.length>0&&function gie(n,t,e){return e.some(i=>bT(n,t,i)&&Jd(i)!==ar)}(n,e,i)?{segmentGroup:new yo(t,mie(i,new yo(e,n.children))),slicedSegments:[]}:0===e.length&&function _ie(n,t,e){return e.some(i=>bT(n,t,i))}(n,e,i)?{segmentGroup:new yo(n.segments,pie(n,0,e,i,n.children)),slicedSegments:e}:{segmentGroup:new yo(n.segments,n.children),slicedSegments:e}}function pie(n,t,e,i,r){const o={};for(const l of i)if(bT(n,e,l)&&!r[Jd(l)]){const f=new yo([],{});o[Jd(l)]=f}return{...r,...o}}function mie(n,t){const e={};e[ar]=t;for(const i of n)if(""===i.path&&Jd(i)!==ar){const r=new yo([],{});e[Jd(i)]=r}return e}function bT(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}class bie{constructor(t,e,i,r,o,l,f){this.injector=t,this.configLoader=e,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=l,this.urlSerializer=f,this.allowRedirects=!0,this.applyRedirects=new hie(this.urlSerializer,this.urlTree)}noMatchError(t){return new gt(4002,!1)}recognize(){const t=C5(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,ar).pipe(ca(e=>{if(e instanceof w5)return this.allowRedirects=!1,this.urlTree=e.urlTree,this.match(e.urlTree);throw e instanceof xT?this.noMatchError(e):e}),$t(e=>{const i=new gT([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ar,this.rootComponentType,null,{}),r=new Op(i,e),o=new h5("",r),l=function dne(n,t,e=null,i=null){return Jz(Qz(n),t,e,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return l.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(l),this.inheritParamsAndData(o._root),{state:o,tree:l}}))}match(t){return this.processSegmentGroup(this.injector,this.config,t.root,ar).pipe(ca(i=>{throw i instanceof xT?this.noMatchError(i):i}))}inheritParamsAndData(t){const e=t.value,i=d5(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),t.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(t,e,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(t,e,i):this.processSegment(t,e,i,i.segments,r,!0)}processChildren(t,e,i){const r=[];for(const o of Object.keys(i.children))"primary"===o?r.unshift(o):r.push(o);return ne(r).pipe(Qy(o=>{const l=i.children[o],f=function zne(n,t){const e=n.filter(i=>Jd(i)===t);return e.push(...n.filter(i=>Jd(i)!==t)),e}(e,o);return this.processSegmentGroup(t,f,l,o)}),aT((o,l)=>(o.push(...l),o)),sT(null),function $te(n,t){const e=arguments.length>=2;return i=>i.pipe(n?aa((r,o)=>n(r,o,i)):wn,tP(1),e?sT(t):Bz(()=>new rT))}(),Bi(o=>{if(null===o)return xv(i);const l=I5(o);return function wie(n){n.sort((t,e)=>t.value.outlet===ar?-1:e.value.outlet===ar?1:t.value.outlet.localeCompare(e.value.outlet))}(l),Te(l)}))}processSegment(t,e,i,r,o,l){return ne(e).pipe(Qy(f=>this.processSegmentAgainstRoute(f._injector??t,e,f,i,r,o,l).pipe(ca(g=>{if(g instanceof xT)return Te(null);throw g}))),_f(f=>!!f),ca(f=>{if(x5(f))return function vie(n,t,e){return 0===t.length&&!n.children[e]}(i,r,o)?Te([]):xv(i);throw f}))}processSegmentAgainstRoute(t,e,i,r,o,l,f){return function yie(n,t,e,i){return!!(Jd(n)===i||i!==ar&&bT(t,e,n))&&("**"===n.path||yP(t,n,e).matched)}(i,r,o,l)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,r,i,o,l,f):f&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,r,e,i,o,l):xv(r):xv(r)}expandSegmentAgainstRouteUsingRedirect(t,e,i,r,o,l){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,r,l):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,r,o,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,i,r){const o=this.applyRedirects.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?E5(o):this.applyRedirects.lineralizeSegments(i,o).pipe(Bi(l=>{const f=new yo(l,{});return this.processSegment(t,e,f,l,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,r,o,l){const{matched:f,consumedSegments:g,remainingSegments:b,positionalParamSegments:S}=yP(e,r,o);if(!f)return xv(e);const O=this.applyRedirects.applyRedirectCommands(g,r.redirectTo,S);return r.redirectTo.startsWith("/")?E5(O):this.applyRedirects.lineralizeSegments(r,O).pipe(Bi($=>this.processSegment(t,i,e,$.concat(b),l,!1)))}matchSegmentAgainstRoute(t,e,i,r,o,l){let f;if("**"===i.path){const g=r.length>0?Uz(r).parameters:{};f=Te({snapshot:new gT(r,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,T5(i),Jd(i),i.component??i._loadedComponent??null,i,D5(i)),consumedSegments:[],remainingSegments:[]}),e.children={}}else f=fie(e,i,r,t).pipe($t(({matched:g,consumedSegments:b,remainingSegments:S,parameters:O})=>g?{snapshot:new gT(b,O,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,T5(i),Jd(i),i.component??i._loadedComponent??null,i,D5(i)),consumedSegments:b,remainingSegments:S}:null));return f.pipe(bn(g=>null===g?xv(e):this.getChildConfig(t=i._injector??t,i,r).pipe(bn(({routes:b})=>{const S=i._loadedInjector??t,{snapshot:O,consumedSegments:$,remainingSegments:J}=g,{segmentGroup:ge,slicedSegments:Ce}=C5(e,$,J,b);if(0===Ce.length&&ge.hasChildren())return this.processChildren(S,b,ge).pipe($t(ft=>null===ft?null:[new Op(O,ft)]));if(0===b.length&&0===Ce.length)return Te([new Op(O,[])]);const je=Jd(i)===o;return this.processSegment(S,b,ge,Ce,je?ar:o,!0).pipe($t(ft=>[new Op(O,ft)]))}))))}getChildConfig(t,e,i){return e.children?Te({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?Te({routes:e._loadedRoutes,injector:e._loadedInjector}):function lie(n,t,e,i){const r=t.canLoad;return void 0===r||0===r.length?Te(!0):Te(r.map(l=>{const f=yv(l,n);return ig(function Zne(n){return n&&X1(n.canLoad)}(f)?f.canLoad(t,e):n.runInContext(()=>f(t,e)))})).pipe(vv(),b5())}(t,e,i).pipe(Bi(r=>r?this.configLoader.loadChildren(t,e).pipe(Dr(o=>{e._loadedRoutes=o.routes,e._loadedInjector=o.injector})):function die(n){return hv(g5(!1,3))}())):Te({routes:[],injector:t})}}function Eie(n){const t=n.value.routeConfig;return t&&""===t.path}function I5(n){const t=[],e=new Set;for(const i of n){if(!Eie(i)){t.push(i);continue}const r=t.find(o=>i.value.routeConfig===o.value.routeConfig);void 0!==r?(r.children.push(...i.children),e.add(r)):t.push(i)}for(const i of e){const r=I5(i.children);t.push(new Op(i.value,r))}return t.filter(i=>!e.has(i))}function T5(n){return n.data||{}}function D5(n){return n.resolve||{}}function A5(n){return"string"==typeof n.title||null===n.title}function vP(n){return bn(t=>{const e=n(t);return e?ne(e).pipe($t(()=>t)):Te(t)})}const bv=new Xt("ROUTES");let xP=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=xn(f3)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return Te(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const i=ig(e.loadComponent()).pipe($t(S5),Dr(o=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=o}),Gm(()=>{this.componentLoaders.delete(e)})),r=new Nz(i,()=>new Oe).pipe(eP());return this.componentLoaders.set(e,r),r}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Te({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const o=function Mie(n,t,e,i){return ig(n.loadChildren()).pipe($t(S5),Bi(r=>r instanceof vN||Array.isArray(r)?Te(r):ne(t.compileModuleAsync(r))),$t(r=>{i&&i(n);let o,l,f=!1;return Array.isArray(r)?(l=r,!0):(o=r.create(e).injector,l=o.get(bv,[],{optional:!0,self:!0}).flat()),{routes:l.map(gP),injector:o}}))}(i,this.compiler,e,this.onLoadEndListener).pipe(Gm(()=>{this.childrenLoaders.delete(i)})),l=new Nz(o,()=>new Oe).pipe(eP());return this.childrenLoaders.set(i,l),l}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function S5(n){return function Pie(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let wT=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Oe,this.transitionAbortSubject=new Oe,this.configLoader=xn(xP),this.environmentInjector=xn(ra),this.urlSerializer=xn(z1),this.rootContexts=xn(W1),this.inputBindingEnabled=null!==xn(_T,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Te(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new Ene(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new wne(r))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:i})}setupNavigations(e,i,r){return this.transitions=new ee({id:0,currentUrlTree:i,currentRawUrl:i,currentBrowserUrl:i,extractedUrl:e.urlHandlingStrategy.extract(i),urlAfterRedirects:e.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:H1,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(aa(o=>0!==o.id),$t(o=>({...o,extractedUrl:e.urlHandlingStrategy.extract(o.rawUrl)})),bn(o=>{this.currentTransition=o;let l=!1,f=!1;return Te(o).pipe(Dr(g=>{this.currentNavigation={id:g.id,initialUrl:g.rawUrl,extractedUrl:g.extractedUrl,trigger:g.source,extras:g.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),bn(g=>{const b=g.currentBrowserUrl.toString(),S=!e.navigated||g.extractedUrl.toString()!==b||b!==g.currentUrlTree.toString();if(!S&&"reload"!==(g.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const $="";return this.events.next(new mv(g.id,this.urlSerializer.serialize(g.rawUrl),$,0)),g.resolve(null),Sr}if(e.urlHandlingStrategy.shouldProcessUrl(g.rawUrl))return Te(g).pipe(bn($=>{const J=this.transitions?.getValue();return this.events.next(new pT($.id,this.urlSerializer.serialize($.extractedUrl),$.source,$.restoredState)),J!==this.transitions?.getValue()?Sr:Promise.resolve($)}),function Cie(n,t,e,i,r,o){return Bi(l=>function xie(n,t,e,i,r,o,l="emptyOnly"){return new bie(n,t,e,i,r,l,o).recognize()}(n,t,e,i,l.extractedUrl,r,o).pipe($t(({state:f,tree:g})=>({...l,targetSnapshot:f,urlAfterRedirects:g}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),Dr($=>{o.targetSnapshot=$.targetSnapshot,o.urlAfterRedirects=$.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:$.urlAfterRedirects};const J=new s5($.id,this.urlSerializer.serialize($.extractedUrl),this.urlSerializer.serialize($.urlAfterRedirects),$.targetSnapshot);this.events.next(J)}));if(S&&e.urlHandlingStrategy.shouldProcessUrl(g.currentRawUrl)){const{id:$,extractedUrl:J,source:ge,restoredState:Ce,extras:je}=g,ft=new pT($,this.urlSerializer.serialize(J),ge,Ce);this.events.next(ft);const ot=u5(0,this.rootComponentType).snapshot;return this.currentTransition=o={...g,targetSnapshot:ot,urlAfterRedirects:J,extras:{...je,skipLocationChange:!1,replaceUrl:!1}},Te(o)}{const $="";return this.events.next(new mv(g.id,this.urlSerializer.serialize(g.extractedUrl),$,1)),g.resolve(null),Sr}}),Dr(g=>{const b=new yne(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(b)}),$t(g=>(this.currentTransition=o={...g,guards:$ne(g.targetSnapshot,g.currentSnapshot,this.rootContexts)},o)),function eie(n,t){return Bi(e=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:l}}=e;return 0===l.length&&0===o.length?Te({...e,guardsResult:!0}):function tie(n,t,e,i){return ne(n).pipe(Bi(r=>function aie(n,t,e,i,r){const o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return o&&0!==o.length?Te(o.map(f=>{const g=Z1(t)??r,b=yv(f,g);return ig(function Xne(n){return n&&X1(n.canDeactivate)}(b)?b.canDeactivate(n,t,e,i):g.runInContext(()=>b(n,t,e,i))).pipe(_f())})).pipe(vv()):Te(!0)}(r.component,r.route,e,t,i)),_f(r=>!0!==r,!0))}(l,i,r,n).pipe(Bi(f=>f&&function qne(n){return"boolean"==typeof n}(f)?function nie(n,t,e,i){return ne(t).pipe(Qy(r=>k1(function rie(n,t){return null!==n&&t&&t(new Cne(n)),Te(!0)}(r.route.parent,i),function iie(n,t){return null!==n&&t&&t(new Tne(n)),Te(!0)}(r.route,i),function sie(n,t,e){const i=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(l=>function Hne(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(l)).filter(l=>null!==l).map(l=>oT(()=>Te(l.guards.map(g=>{const b=Z1(l.node)??e,S=yv(g,b);return ig(function Yne(n){return n&&X1(n.canActivateChild)}(S)?S.canActivateChild(i,n):b.runInContext(()=>S(i,n))).pipe(_f())})).pipe(vv())));return Te(o).pipe(vv())}(n,r.path,e),function oie(n,t,e){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return Te(!0);const r=i.map(o=>oT(()=>{const l=Z1(t)??e,f=yv(o,l);return ig(function Kne(n){return n&&X1(n.canActivate)}(f)?f.canActivate(t,n):l.runInContext(()=>f(t,n))).pipe(_f())}));return Te(r).pipe(vv())}(n,r.route,e))),_f(r=>!0!==r,!0))}(i,o,n,t):Te(f)),$t(f=>({...e,guardsResult:f})))})}(this.environmentInjector,g=>this.events.next(g)),Dr(g=>{if(o.guardsResult=g.guardsResult,$_(g.guardsResult))throw m5(0,g.guardsResult);const b=new vne(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot,!!g.guardsResult);this.events.next(b)}),aa(g=>!!g.guardsResult||(this.cancelNavigationTransition(g,"",3),!1)),vP(g=>{if(g.guards.canActivateChecks.length)return Te(g).pipe(Dr(b=>{const S=new xne(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(S)}),bn(b=>{let S=!1;return Te(b).pipe(function Iie(n,t){return Bi(e=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=e;if(!r.length)return Te(e);let o=0;return ne(r).pipe(Qy(l=>function Tie(n,t,e,i){const r=n.routeConfig,o=n._resolve;return void 0!==r?.title&&!A5(r)&&(o[B1]=r.title),function Die(n,t,e,i){const r=function Aie(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return Te({});const o={};return ne(r).pipe(Bi(l=>function Sie(n,t,e,i){const r=Z1(t)??i,o=yv(n,r);return ig(o.resolve?o.resolve(t,e):r.runInContext(()=>o(t,e)))}(n[l],t,e,i).pipe(_f(),Dr(f=>{o[l]=f}))),tP(1),Vz(o),ca(l=>x5(l)?Sr:hv(l)))}(o,n,t,i).pipe($t(l=>(n._resolvedData=l,n.data=d5(n,e).resolve,r&&A5(r)&&(n.data[B1]=r.title),null)))}(l.route,i,n,t)),Dr(()=>o++),tP(1),Bi(l=>o===r.length?Te(e):Sr))})}(e.paramsInheritanceStrategy,this.environmentInjector),Dr({next:()=>S=!0,complete:()=>{S||this.cancelNavigationTransition(b,"",2)}}))}),Dr(b=>{const S=new bne(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(S)}))}),vP(g=>{const b=S=>{const O=[];S.routeConfig?.loadComponent&&!S.routeConfig._loadedComponent&&O.push(this.configLoader.loadComponent(S.routeConfig).pipe(Dr($=>{S.component=$}),$t(()=>{})));for(const $ of S.children)O.push(...b($));return O};return GI(b(g.targetSnapshot.root)).pipe(sT(),Ls(1))}),vP(()=>this.afterPreactivation()),$t(g=>{const b=function kne(n,t,e){const i=q1(n,t._root,e?e._root:void 0);return new c5(i,t)}(e.routeReuseStrategy,g.targetSnapshot,g.currentRouterState);return this.currentTransition=o={...g,targetRouterState:b},o}),Dr(()=>{this.events.next(new aP)}),((n,t,e,i)=>$t(r=>(new jne(t,r.targetRouterState,r.currentRouterState,e,i).activate(n),r)))(this.rootContexts,e.routeReuseStrategy,g=>this.events.next(g),this.inputBindingEnabled),Ls(1),Dr({next:g=>{l=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new rg(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects))),e.titleStrategy?.updateTitle(g.targetRouterState.snapshot),g.resolve(!0)},complete:()=>{l=!0}}),ld(this.transitionAbortSubject.pipe(Dr(g=>{throw g}))),Gm(()=>{l||f||this.cancelNavigationTransition(o,"",1),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),ca(g=>{if(f=!0,_5(g))this.events.next(new G1(o.id,this.urlSerializer.serialize(o.extractedUrl),g.message,g.cancellationCode)),function Fne(n){return _5(n)&&$_(n.url)}(g)?this.events.next(new lP(g.url)):o.resolve(!1);else{this.events.next(new mT(o.id,this.urlSerializer.serialize(o.extractedUrl),g,o.targetSnapshot??void 0));try{o.resolve(e.errorHandler(g))}catch(b){o.reject(b)}}return Sr}))}))}cancelNavigationTransition(e,i,r){const o=new G1(e.id,this.urlSerializer.serialize(e.extractedUrl),i,r);this.events.next(o),e.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function M5(n){return n!==H1}let P5=(()=>{class n{buildTitle(e){let i,r=e.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===ar);return i}getResolvedTitleForRoute(e){return e.data[B1]}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:function(){return xn(kie)},providedIn:"root"})}return n})(),kie=(()=>{class n extends P5{constructor(e){super(),this.title=e}updateTitle(e){const i=this.buildTitle(e);void 0!==i&&this.title.setTitle(i)}static#e=this.\u0275fac=function(i){return new(i||n)(it(N4))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Rie=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:function(){return xn(Fie)},providedIn:"root"})}return n})();class Oie{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let Fie=(()=>{class n extends Oie{static#e=this.\u0275fac=function(){let e;return function(r){return(e||(e=ms(n)))(r||n)}}();static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const ET=new Xt("",{providedIn:"root",factory:()=>({})});let Lie=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:function(){return xn(Nie)},providedIn:"root"})}return n})(),Nie=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Q1=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Q1||{});function k5(n,t){n.events.pipe(aa(e=>e instanceof rg||e instanceof G1||e instanceof mT||e instanceof mv),$t(e=>e instanceof rg||e instanceof mv?Q1.COMPLETE:e instanceof G1&&(0===e.code||1===e.code)?Q1.REDIRECTING:Q1.FAILED),aa(e=>e!==Q1.REDIRECTING),Ls(1)).subscribe(()=>{t()})}function Bie(n){throw n}function Vie(n,t,e){return t.parse("/")}const zie={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Uie={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ic=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=xn(h3),this.isNgZoneEnabled=!1,this._events=new Oe,this.options=xn(ET,{optional:!0})||{},this.pendingTasks=xn(zC),this.errorHandler=this.options.errorHandler||Bie,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Vie,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=xn(Lie),this.routeReuseStrategy=xn(Rie),this.titleStrategy=xn(P5),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=xn(bv,{optional:!0})?.flat()??[],this.navigationTransitions=xn(wT),this.urlSerializer=xn(z1),this.location=xn(n1),this.componentInputBindingEnabled=!!xn(_T,{optional:!0}),this.eventsSubscription=new Me,this.isNgZoneEnabled=xn(wi)instanceof wi&&wi.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new pv,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=u5(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const e=this.navigationTransitions.events.subscribe(i=>{try{const{currentTransition:r}=this.navigationTransitions;if(null===r)return void(R5(i)&&this._events.next(i));if(i instanceof pT)M5(r.source)&&(this.browserUrlTree=r.extractedUrl);else if(i instanceof mv)this.rawUrlTree=r.rawUrl;else if(i instanceof s5){if("eager"===this.urlUpdateStrategy){if(!r.extras.skipLocationChange){const o=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl);this.setBrowserUrl(o,r)}this.browserUrlTree=r.urlAfterRedirects}}else if(i instanceof aP)this.currentUrlTree=r.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(r.urlAfterRedirects,r.rawUrl),this.routerState=r.targetRouterState,"deferred"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r),this.browserUrlTree=r.urlAfterRedirects);else if(i instanceof G1)0!==i.code&&1!==i.code&&(this.navigated=!0),(3===i.code||2===i.code)&&this.restoreHistory(r);else if(i instanceof lP){const o=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),l={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||M5(r.source)};this.scheduleNavigation(o,H1,null,l,{resolve:r.resolve,reject:r.reject,promise:r.promise})}i instanceof mT&&this.restoreHistory(r,!0),i instanceof rg&&(this.navigated=!0),R5(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),H1,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const i="popstate"===e.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,i,e.state)},0)}))}navigateToSyncWithBrowser(e,i,r){const o={replaceUrl:!0},l=r?.navigationId?r:null;if(r){const g={...r};delete g.navigationId,delete g.\u0275routerPageId,0!==Object.keys(g).length&&(o.state=g)}const f=this.parseUrl(e);this.scheduleNavigation(f,i,l,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(gP),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,i={}){const{relativeTo:r,queryParams:o,fragment:l,queryParamsHandling:f,preserveFragment:g}=i,b=g?this.currentUrlTree.fragment:l;let O,S=null;switch(f){case"merge":S={...this.currentUrlTree.queryParams,...o};break;case"preserve":S=this.currentUrlTree.queryParams;break;default:S=o||null}null!==S&&(S=this.removeEmptyProps(S));try{O=Qz(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof e[0]||!e[0].startsWith("/"))&&(e=[]),O=this.currentUrlTree.root}return Jz(O,e,S,b??null)}navigateByUrl(e,i={skipLocationChange:!1}){const r=$_(e)?e:this.parseUrl(e),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,H1,null,i)}navigate(e,i={skipLocationChange:!1}){return function jie(n){for(let t=0;t<n.length;t++)if(null==n[t])throw new gt(4008,!1)}(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let i;try{i=this.urlSerializer.parse(e)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return i}isActive(e,i){let r;if(r=!0===i?{...zie}:!1===i?{...Uie}:i,$_(e))return $z(this.currentUrlTree,e,r);const o=this.parseUrl(e);return $z(this.currentUrlTree,o,r)}removeEmptyProps(e){return Object.keys(e).reduce((i,r)=>{const o=e[r];return null!=o&&(i[r]=o),i},{})}scheduleNavigation(e,i,r,o,l){if(this.disposed)return Promise.resolve(!1);let f,g,b;l?(f=l.resolve,g=l.reject,b=l.promise):b=new Promise((O,$)=>{f=O,g=$});const S=this.pendingTasks.add();return k5(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(S))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:e,extras:o,resolve:f,reject:g,promise:b,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),b.catch(O=>Promise.reject(O))}setBrowserUrl(e,i){const r=this.urlSerializer.serialize(e);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const l={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",l)}else{const o={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",o)}}restoreHistory(e,i=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-this.browserPageId;0!==o?this.location.historyGo(o):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===o&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function R5(n){return!(n instanceof aP||n instanceof lP)}class O5{}let Gie=(()=>{class n{constructor(e,i,r,o,l){this.router=e,this.injector=r,this.preloadingStrategy=o,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(aa(e=>e instanceof rg),Qy(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){const r=[];for(const o of i){o.providers&&!o._injector&&(o._injector=zS(o.providers,e,`Route: ${o.path}`));const l=o._injector??e,f=o._loadedInjector??l;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&r.push(this.preloadConfig(l,o)),(o.children||o._loadedRoutes)&&r.push(this.processRoutes(f,o.children??o._loadedRoutes))}return ne(r).pipe(qr())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(e,i):Te(null);const o=r.pipe(Bi(l=>null===l?Te(void 0):(i._loadedRoutes=l.routes,i._loadedInjector=l.injector,this.processRoutes(l.injector??e,l.routes))));return i.loadComponent&&!i._loadedComponent?ne([o,this.loader.loadComponent(i)]).pipe(qr()):o})}static#e=this.\u0275fac=function(i){return new(i||n)(it(ic),it(f3),it(ra),it(O5),it(xP))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const wP=new Xt("");let F5=(()=>{class n{constructor(e,i,r,o,l={}){this.urlSerializer=e,this.transitions=i,this.viewportScroller=r,this.zone=o,this.options=l,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},l.scrollPositionRestoration=l.scrollPositionRestoration||"disabled",l.anchorScrolling=l.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof pT?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof rg?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof mv&&0===e.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof a5&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new a5(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){Fe()};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();function Fp(n,t){return{\u0275kind:n,\u0275providers:t}}function N5(){const n=xn(Hr);return t=>{const e=n.get(jm);if(t!==e.components[0])return;const i=n.get(ic),r=n.get(B5);1===n.get(EP)&&i.initialNavigation(),n.get(V5,null,si.Optional)?.setUpPreloading(),n.get(wP,null,si.Optional)?.init(),i.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const B5=new Xt("",{factory:()=>new Oe}),EP=new Xt("",{providedIn:"root",factory:()=>1}),V5=new Xt("");function Kie(n){return Fp(0,[{provide:V5,useExisting:Gie},{provide:O5,useExisting:n}])}const z5=new Xt("ROUTER_FORROOT_GUARD"),Xie=[n1,{provide:z1,useClass:nP},ic,W1,{provide:_v,useFactory:function L5(n){return n.routerState.root},deps:[ic]},xP,[]];function Qie(){return new x3("Router",ic)}let CT=(()=>{class n{constructor(e){}static forRoot(e,i){return{ngModule:n,providers:[Xie,[],{provide:bv,multi:!0,useValue:e},{provide:z5,useFactory:nre,deps:[[ic,new jr,new Vd]]},{provide:ET,useValue:i||{}},i?.useHash?{provide:S_,useClass:RZ}:{provide:S_,useClass:X3},{provide:wP,useFactory:()=>{const n=xn(ZK),t=xn(wi),e=xn(ET),i=xn(wT),r=xn(z1);return e.scrollOffset&&n.setOffset(e.scrollOffset),new F5(r,i,n,t,e)}},i?.preloadingStrategy?Kie(i.preloadingStrategy).\u0275providers:[],{provide:x3,multi:!0,useFactory:Qie},i?.initialNavigation?ire(i):[],i?.bindToComponentInputs?Fp(8,[p5,{provide:_T,useExisting:p5}]).\u0275providers:[],[{provide:U5,useFactory:N5},{provide:cM,multi:!0,useExisting:U5}]]}}static forChild(e){return{ngModule:n,providers:[{provide:bv,multi:!0,useValue:e}]}}static#e=this.\u0275fac=function(i){return new(i||n)(it(z5,8))};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({})}return n})();function nre(n){return"guarded"}function ire(n){return["disabled"===n.initialNavigation?Fp(3,[{provide:tM,multi:!0,useFactory:()=>{const t=xn(ic);return()=>{t.setUpLocationChangeListener()}}},{provide:EP,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Fp(2,[{provide:EP,useValue:0},{provide:tM,multi:!0,deps:[Hr],useFactory:t=>{const e=t.get(PZ,Promise.resolve());return()=>e.then(()=>new Promise(i=>{const r=t.get(ic),o=t.get(B5);k5(r,()=>{i(!0)}),t.get(wT).afterPreactivation=()=>(i(!0),o.closed?Te(void 0):o),r.initialNavigation()}))}}]).\u0275providers:[]]}const U5=new Xt("");var j5=Ve(8217),Do=Ve(9058),rc=Ve(534),xf=Ve(7879),$5=Ve(4537);Ve(6365),(0,rc.registerVersion)("firebase","10.7.1","app");const cre=new class lre extends ZI{}(class are extends qI{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,i=0){return null!=i&&i>0||null==i&&this.delay>0?super.requestAsyncId(t,e,i):(t.flush(this),0)}}),wv=new nf("ANGULARFIRE2_VERSION");const CP=(n,t)=>{const e=t?[t]:(0,rc.getApps)(),i=[];return e.forEach(r=>{r.container.getProvider(n).instances.forEach(l=>{i.includes(l)||i.push(l)})}),i};class IP{constructor(){return CP(ure)}}const ure="app-check";function Ev(){}class G5{zone;delegate;constructor(t,e=cre){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,i){const r=this.zone;return this.delegate.schedule(function(l){r.runGuarded(()=>{t.apply(this,[l])})},e,i)}}class dre{zone;task=null;constructor(t){this.zone=t}call(t,e){const i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ev,{},Ev,Ev)),e.pipe(Dr({next:i,complete:i,error:i})).subscribe(t).add(i)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let IT=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new G5(Zone.current)),this.insideAngular=e.run(()=>new G5(Zone.current,uv)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(it(wi))};static \u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Cv(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function H_(n){return Cv().ngZone.run(()=>n())}function bu(n){return function fre(n){return function(e){return(e=e.lift(new dre(n.ngZone))).pipe(Qe(n.outsideAngular),Be(n.insideAngular))}}(Cv())(n)}const pre=(n,t)=>function(){const i=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),H_(()=>n.apply(void 0,i))},TP=(n,t)=>function(){let e;const i=arguments;for(let o=0;o<arguments.length;o++)"function"==typeof i[o]&&(t&&(e||=H_(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ev,{},Ev,Ev))),i[o]=pre(i[o],e));const r=function hre(n){return Cv().ngZone.runOutsideAngular(()=>n())}(()=>n.apply(this,i));if(!t){if(r instanceof Kt){const o=Cv();return r.pipe(Qe(o.outsideAngular),Be(o.insideAngular))}return H_(()=>r)}return r instanceof Kt?r.pipe(bu):r instanceof Promise?H_(()=>new Promise((o,l)=>r.then(f=>H_(()=>o(f)),f=>H_(()=>l(f))))):"function"==typeof r&&e?function(){return setTimeout(()=>{e&&"scheduled"===e.state&&e.invoke()},10),r.apply(this,arguments)}:H_(()=>r)};var og=Ve(3106);og.Z.registerVersion("firebase","10.7.1","app-compat");const _re=["ngOnDestroy"];class W5{constructor(t){return t}}const TT=new Xt("angularfire2.app.options"),DT=new Xt("angularfire2.app.name");function DP(n,t,e){const r="object"==typeof e&&e||{};r.name=r.name||"string"==typeof e&&e||"[DEFAULT]";const l=og.Z.apps.filter(f=>f&&f.name===r.name)[0]||t.runOutsideAngular(()=>og.Z.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(l.options)){const f=!!module.hot;xre("error",`${l.name} Firebase App already initialized with different options${f?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new W5(l)}const xre=(n,...t)=>{},bre={provide:W5,useFactory:DP,deps:[TT,wi,[new jr,DT]]};let wre=(()=>{class n{static initializeApp(e,i){return{ngModule:n,providers:[{provide:TT,useValue:e},{provide:DT,useValue:i}]}}constructor(e){og.Z.registerVersion("angularfire",wv.full,"core"),og.Z.registerVersion("angularfire",wv.full,"app-compat"),og.Z.registerVersion("angular",yp.full,e.toString())}static \u0275fac=function(i){return new(i||n)(it(bl))};static \u0275mod=qi({type:n});static \u0275inj=Ai({providers:[bre]})}return n})();function q5(n,t,e,i,r){const[,o,l]=globalThis.\u0275AngularfireInstanceCache.find(f=>f[0]===n)||[];if(o)return function Ere(n,t){try{return n.toString()===t.toString()}catch{return n===t}}(r,l)||(Z5("error",`${t} was already initialized on the ${e} Firebase App with different settings.${Cre?" You may need to reload as Firebase is not HMR aware.":""}`),Z5("warn",{is:r,was:l})),o;{const f=i();return globalThis.\u0275AngularfireInstanceCache.push([n,f,r]),f}}const Cre=typeof module<"u"&&!!module.hot,Z5=(n,...t)=>{};globalThis.\u0275AngularfireInstanceCache||=[];class Ire extends Oe{constructor(t=1/0,e=1/0,i=W2){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:o,_windowTime:l}=this;e||(i.push(t),!r&&i.push(o.now()+l)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:i,_buffer:r}=this,o=r.slice();for(let l=0;l<o.length&&!t.closed;l+=i?1:2)t.next(o[l]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:i,_infiniteTimeWindow:r}=this,o=(r?1:2)*t;if(t<1/0&&o<i.length&&i.splice(0,i.length-o),!r){const l=e.now();let f=0;for(let g=1;g<i.length&&i[g]<=l;g+=2)f=g;f&&i.splice(0,f+1)}}}function K5(n,t,e){let i,r=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:t=1/0,refCount:r=!1,scheduler:e}=n):i=n??1/0,bt({connector:()=>new Ire(i,t,e),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function Y5(n,t){return W(t)?bn(()=>n,t):bn(()=>n)}const X5=new Xt("angularfire2.auth.use-emulator"),Q5=new Xt("angularfire2.auth.settings"),J5=new Xt("angularfire2.auth.tenant-id"),e6=new Xt("angularfire2.auth.langugage-code"),t6=new Xt("angularfire2.auth.use-device-language"),n6=new Xt("angularfire.auth.persistence"),i6=(n,t,e,i,r,o,l,f)=>q5(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const g=t.runOutsideAngular(()=>n.auth());if(e&&g.useEmulator(...e),i&&(g.tenantId=i),g.languageCode=r,o&&g.useDeviceLanguage(),l)for(const[b,S]of Object.entries(l))g.settings[b]=S;return f&&g.setPersistence(f),g},[e,i,r,o,l,f]);let J1=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(e,i,r,o,l,f,g,b,S,O,$,J){const ge=new Oe,Ce=Te(void 0).pipe(Be(l.outsideAngular),bn(()=>o.runOutsideAngular(()=>Promise.resolve().then(Ve.bind(Ve,6365)))),$t(()=>DP(e,o,i)),$t(je=>i6(je,o,f,b,S,O,g,$)),K5({bufferSize:1,refCount:!1}));if(sI(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Te(null);else{Ce.pipe(_f()).subscribe();const je=Ce.pipe(bn(It=>It.getRedirectResult().then(Yt=>Yt,()=>null)),bu,K5({bufferSize:1,refCount:!1})),ft=Ce.pipe(bn(It=>new Kt(Yt=>({unsubscribe:o.runOutsideAngular(()=>It.onAuthStateChanged(yn=>Yt.next(yn),yn=>Yt.error(yn),()=>Yt.complete()))})))),ot=Ce.pipe(bn(It=>new Kt(Yt=>({unsubscribe:o.runOutsideAngular(()=>It.onIdTokenChanged(yn=>Yt.next(yn),yn=>Yt.error(yn),()=>Yt.complete()))}))));this.authState=je.pipe(Y5(ft),Qe(l.outsideAngular),Be(l.insideAngular)),this.user=je.pipe(Y5(ot),Qe(l.outsideAngular),Be(l.insideAngular)),this.idToken=this.user.pipe(bn(It=>It?ne(It.getIdToken()):Te(null))),this.idTokenResult=this.user.pipe(bn(It=>It?ne(It.getIdTokenResult()):Te(null))),this.credential=ue(je,ge,this.authState.pipe(aa(It=>!It))).pipe($t(It=>It?.user?It:null),Qe(l.outsideAngular),Be(l.insideAngular))}return((n,t,e,i={})=>new Proxy(n,{get:(r,o)=>e.runOutsideAngular(()=>{if(n[o])return i?.spy?.get&&i.spy.get(o,n[o]),n[o];if(_re.indexOf(o)>-1)return()=>{};const l=t.toPromise().then(f=>{const g=f?.[o];return"function"==typeof g?g.bind(f):g?.then?g.then(b=>e.run(()=>b)):e.run(()=>g)});return new Proxy(()=>{},{get:(f,g)=>l[g],apply:(f,g,b)=>l.then(S=>{const O=S?.(...b);return i?.spy?.apply&&i.spy.apply(o,b,O),O})})})}))(this,Ce,o,{spy:{apply:(je,ft,ot)=>{(je.startsWith("signIn")||je.startsWith("createUser"))&&ot.then(It=>ge.next(It))}}})}static \u0275fac=function(i){return new(i||n)(it(TT),it(DT,8),it(bl),it(wi),it(IT),it(X5,8),it(Q5,8),it(J5,8),it(e6,8),it(t6,8),it(n6,8),it(IP,8))};static \u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();function Dre(n,t){if(1&n){const e=Qo();ht(0,"div")(1,"button",1),Qn("click",function(){return _i(e),Gn(In().userLogin())}),on(2," Clic aqu\xed para iniciar sesi\xf3n "),pt()()}}function Are(n,t){1&n&&(ht(0,"div")(1,"div",2),on(2,"Esperando login..."),pt(),Ji(3,"div",3),pt())}let Sre=(()=>{class n{constructor(e,i){this._afAuth=e,this._router=i,this.login=!1}userLogin(){this.login=!0,this._afAuth.signInWithPopup(new j5.X).then(()=>{this._router.navigate(["/add-locations"])}).catch(()=>{this.login=!1,this._router.navigate(["/"])})}static#e=this.\u0275fac=function(i){return new(i||n)(H(J1),H(ic))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["root-access"]],decls:2,vars:2,consts:[[4,"ngIf"],[3,"click"],[1,"text"],[1,"loader"]],template:function(i,r){1&i&&(Yn(0,Dre,3,0,"div",0),Yn(1,Are,4,0,"div",0)),2&i&&(un("ngIf",!r.login),X(1),un("ngIf",r.login))},dependencies:[Yd],styles:["div[_ngcontent-%COMP%]{margin-top:30%;width:100%}div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;margin:auto}div[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{text-align:center;margin-bottom:35px}div[_ngcontent-%COMP%]   .loader[_ngcontent-%COMP%]{margin:auto;border:16px solid #f3f3f3;border-radius:50%;border-top:16px solid #3498db;width:120px;height:120px;animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})}return n})();function r6(n,t){return t?e=>k1(t.pipe(Ls(1),function Mre(){return Ot((n,t)=>{n.subscribe(_n(t,he))})}()),e.pipe(r6(n))):Bi((e,i)=>hi(n(e,i)).pipe(Ls(1),Vz(e)))}function o6(n=0,t,e=Ree){let i=-1;return null!=t&&(zr(t)?e=t:i=t),new Kt(r=>{let o=function Pre(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;o<0&&(o=0);let l=0;return e.schedule(function(){r.closed||(r.next(l++),0<=i?this.schedule(void 0,i):r.complete())},o)})}function s6(n,t=uv){const e=o6(n,t);return r6(()=>e)}const Ba="new-localizations";var Cl=function(n){return n.BLUE="#07a8b7",n.CORAL="#DB795E",n.LIGHTSLATEGRAY="#778899",n.GREEN="#91c792",n.YELLOW="#f0bd67",n.LIGHTGREY="#d3d3d3",n.FOREST="#228B22",n.BROWNIERED="#8B2121",n.BLACK="#000000",n}(Cl||{}),a6=function(n){return n.UPWARD="upward",n.DOWNWARD="downward",n}(a6||{});const AP=[Cl.BLUE,Cl.CORAL,Cl.LIGHTSLATEGRAY,Cl.GREEN,Cl.YELLOW,Cl.LIGHTGREY,Cl.BROWNIERED],l6=[Cl.BLUE,Cl.CORAL,Cl.LIGHTSLATEGRAY,Cl.GREEN,Cl.YELLOW,Cl.LIGHTGREY,Cl.FOREST,Cl.BROWNIERED],AT="https://turismoambrozcaparra.es//planificador/imagenes",c6={"D\xf3nde dormir":"where-to-sleep","D\xf3nde comer":"where-to-eat","Museos, Centros de Interpretaci\xf3n y oficinas de turismo":"culture-resource","Recursos acu\xe1ticos":"aquatic-resources",Astroturismo:"astrotourism",Monumentos:"monuments","Empresas de actividad":"activity"},u6={Restablecer:"restore","D\xf3nde dormir":"where-to-sleep","D\xf3nde comer":"where-to-eat","Museos, Centros de Interpretaci\xf3n y oficinas de turismo":"culture-resource","Recursos acu\xe1ticos":"aquatic-resources",Astroturismo:"astrotourism",Monumentos:"monuments","Empresas de actividad":"activity"},SP={"where-to-sleep":"alojamiento","where-to-eat":"restauracion","culture-resource":"museos-ci","aquatic-resources":"agua",astrotourism:"astroturismo",nature:"",monuments:"monumentos",activity:"actividades"};var Iv=Ve(2574),Rre=Ve.n(Iv);let Ore=(()=>{class n extends h1{constructor(e){super(e),this.baseUrl="https://api.mapbox.com/directions/v5/mapbox/driving"}get(e){return super.get(e=this.baseUrl+e,{params:{alternatives:!1,geometries:"geojson",language:"es",overview:"simplified",steps:!0,access_token:"pk.eyJ1IjoiaGFzY2hlbGwiLCJhIjoiY2xvOGRkc2I5MDA1ZTJrcXFvY3Y4czB6eiJ9.SLGgLTFgBhwDoK_eiQBBxw"}})}static#e=this.\u0275fac=function(i){return new(i||n)(it(u1))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Fre=["mat-button",""],Lre=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],Nre=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],Vre=["mat-icon-button",""],zre=["*"],Ure=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],jre=K2(fte(pte(class{constructor(n){this._elementRef=n}})));let d6=(()=>{class n extends jre{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(e){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,e)}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=nc(e),this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(e){this._disabled=nc(e),this._updateRippleDisabled()}constructor(e,i,r,o){super(e),this._platform=i,this._ngZone=r,this._animationMode=o,this._focusMonitor=xn(O1),this._rippleLoader=xn(Ate),this._isFab=!1,this._disableRipple=!1,this._disabled=!1,this._rippleLoader?.configureRipple(this._elementRef.nativeElement,{className:"mat-mdc-button-ripple"});const l=e.nativeElement.classList;for(const f of Ure)this._hasHostAttributes(f.selector)&&f.mdcClasses.forEach(g=>{l.add(g)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e="program",i){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...e){return e.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static#e=this.\u0275fac=function(i){Fe()};static#t=this.\u0275dir=On({type:n,features:[Qi]})}return n})(),MP=(()=>{class n extends d6{constructor(e,i,r,o){super(e,i,r,o)}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(rl),H(wi),H(Ju,8))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(i,r){2&i&&(ro("disabled",r.disabled||null),zo("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Qi],attrs:Fre,ngContentSelectors:Nre,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(uf(Lre),Ji(0,"span",0),il(1),ht(2,"span",1),il(3,1),pt(),il(4,2),Ji(5,"span",2)(6,"span",3)),2&i&&zo("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return n})(),h6=(()=>{class n extends d6{constructor(e,i,r,o){super(e,i,r,o),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(rl),H(wi),H(Ju,8))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(i,r){2&i&&(ro("disabled",r.disabled||null),zo("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Qi],attrs:Vre,ngContentSelectors:zre,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(uf(),Ji(0,"span",0),il(1),Ji(2,"span",1)(3,"span",2))},styles:['.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size);width:var(--mdc-icon-button-state-layer-size);color:var(--mdc-icon-button-icon-color);--mdc-icon-button-state-layer-size:48px;--mdc-icon-button-icon-size:24px;--mdc-icon-button-disabled-icon-color:black;--mdc-icon-button-disabled-icon-opacity:0.38}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size);height:var(--mdc-icon-button-icon-size)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color)}.mat-mdc-icon-button{padding:12px;font-size:var(--mdc-icon-button-icon-size);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0})}return n})(),f6=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[xu,Dte,xu]})}return n})();class PP{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class G_ extends PP{constructor(t,e,i,r,o){super(),this.component=t,this.viewContainerRef=e,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=o}}class kP extends PP{constructor(t,e,i,r){super(),this.templateRef=t,this.viewContainerRef=e,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class Gre extends PP{constructor(t){super(),this.element=t instanceof fr?t.nativeElement:t}}class ST{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof G_?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof kP?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof Gre?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Wre extends ST{constructor(t,e,i,r,o){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=l=>{const f=l.element,g=this._document.createComment("dom-portal");f.parentNode.insertBefore(g,f),this.outletElement.appendChild(f),this._attachedPortal=l,super.setDisposeFn(()=>{g.parentNode&&g.parentNode.replaceChild(f,g)})},this._document=o}attachComponentPortal(t){const i=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let r;return t.viewContainerRef?(r=t.viewContainerRef.createComponent(i,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(t.injector||this._defaultInjector||Hr.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=t,r}attachTemplatePortal(t){let e=t.viewContainerRef,i=e.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=e.indexOf(i);-1!==r&&e.remove(r)}),this._attachedPortal=t,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let W_=(()=>{class n extends ST{constructor(e,i,r){super(),this._componentFactoryResolver=e,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new ui,this.attachDomPortal=o=>{const l=o.element,f=this._document.createComment("dom-portal");o.setAttachedHost(this),l.parentNode.insertBefore(f,l),this._getRootNode().appendChild(l),this._attachedPortal=o,super.setDisposeFn(()=>{f.parentNode&&f.parentNode.replaceChild(l,f)})},this._document=r}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);const i=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,o=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),l=i.createComponent(o,i.length,e.injector||i.injector,e.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(l.hostView.rootNodes[0]),super.setDisposeFn(()=>l.destroy()),this._attachedPortal=e,this._attachedRef=l,this.attached.emit(l),l}attachTemplatePortal(e){e.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}static#e=this.\u0275fac=function(i){return new(i||n)(H(Pm),H(pu),H(rr))};static#t=this.\u0275dir=On({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Qi]})}return n})(),Tv=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({})}return n})();const qre=["addListener","removeListener"],Zre=["addEventListener","removeEventListener"],Kre=["on","off"];function RP(n,t,e,i){if(W(e)&&(i=e,e=void 0),i)return RP(n,t,e).pipe(x2(i));const[r,o]=function Qre(n){return W(n.addEventListener)&&W(n.removeEventListener)}(n)?Zre.map(l=>f=>n[l](t,f,e)):function Yre(n){return W(n.addListener)&&W(n.removeListener)}(n)?qre.map(p6(n,t)):function Xre(n){return W(n.on)&&W(n.off)}(n)?Kre.map(p6(n,t)):[];if(!r&&bi(n))return Bi(l=>RP(l,t,e))(hi(n));if(!r)throw new TypeError("Invalid event target");return new Kt(l=>{const f=(...g)=>l.next(1<g.length?g:g[0]);return r(f),()=>o(f)})}function p6(n,t){return e=>i=>n[e](t,i)}const ew={schedule(n){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:i}=ew;i&&(t=i.requestAnimationFrame,e=i.cancelAnimationFrame);const r=t(o=>{e=void 0,n(o)});return new Me(()=>e?.(r))},requestAnimationFrame(...n){const{delegate:t}=ew;return(t?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:t}=ew;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0};new class eoe extends ZI{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw r}}}(class Jre extends qI{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=ew.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,e,i);const{actions:o}=t;null!=e&&(null===(r=o[o.length-1])||void 0===r?void 0:r.id)!==e&&(ew.cancelAnimationFrame(e),t._scheduled=void 0)}});let OP,noe=1;const MT={};function m6(n){return n in MT&&(delete MT[n],!0)}const ioe={setImmediate(n){const t=noe++;return MT[t]=!0,OP||(OP=Promise.resolve()),OP.then(()=>m6(t)&&n()),t},clearImmediate(n){m6(n)}},{setImmediate:roe,clearImmediate:ooe}=ioe,PT={setImmediate(...n){const{delegate:t}=PT;return(t?.setImmediate||roe)(...n)},clearImmediate(n){const{delegate:t}=PT;return(t?.clearImmediate||ooe)(n)},delegate:void 0};new class aoe extends ZI{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;t=t||i.shift();do{if(r=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,r){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw r}}}(class soe extends qI{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=PT.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,e,i);const{actions:o}=t;null!=e&&(null===(r=o[o.length-1])||void 0===r?void 0:r.id)!==e&&(PT.clearImmediate(e),t._scheduled===e&&(t._scheduled=void 0))}});function g6(n,t=uv){return function coe(n){return Ot((t,e)=>{let i=!1,r=null,o=null,l=!1;const f=()=>{if(o?.unsubscribe(),o=null,i){i=!1;const b=r;r=null,e.next(b)}l&&e.complete()},g=()=>{o=null,l&&e.complete()};t.subscribe(_n(e,b=>{i=!0,r=b,o||hi(n(b)).subscribe(o=_n(e,f,g))},()=>{l=!0,(!i||!o||o.closed)&&e.complete()}))})}(()=>o6(n,t))}let doe=(()=>{class n{constructor(e,i,r){this._ngZone=e,this._platform=i,this._scrolled=new Oe,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const i=this.scrollContainers.get(e);i&&(i.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new Kt(i=>{this._globalSubscription||this._addGlobalListener();const r=e>0?this._scrolled.pipe(g6(e)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Te()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(e,i){const r=this.getAncestorScrollContainers(e);return this.scrolled(i).pipe(aa(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(e){const i=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,e)&&i.push(o)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,i){let r=cv(i),o=e.getElementRef().nativeElement;do{if(r==o)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>RP(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static#e=this.\u0275fac=function(i){return new(i||n)(it(wi),it(rl),it(rr,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_6=(()=>{class n{constructor(e,i,r){this._platform=e,this._change=new Oe,this._changeListener=o=>{this._change.next(o)},this._document=r,i.runOutsideAngular(()=>{if(e.isBrowser){const o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+r,right:e.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,i=this._getWindow(),r=e.documentElement,o=r.getBoundingClientRect();return{top:-o.top||e.body.scrollTop||i.scrollY||r.scrollTop||0,left:-o.left||e.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(g6(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static#e=this.\u0275fac=function(i){return new(i||n)(it(rl),it(wi),it(rr,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),FP=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({})}return n})(),y6=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[F1,FP,F1,FP]})}return n})();const v6=_ee();class foe{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=la(-this._previousScrollPosition.left),t.style.top=la(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,i=t.style,r=this._document.body.style,o=i.scrollBehavior||"",l=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),v6&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),v6&&(i.scrollBehavior=o,r.scrollBehavior=l)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,i=this._viewportRuler.getViewportSize();return e.scrollHeight>i.height||e.scrollWidth>i.width}}class poe{constructor(t,e,i,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0).pipe(aa(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class x6{enable(){}disable(){}attach(){}}function LP(n,t){return t.some(e=>n.bottom<e.top||n.top>e.bottom||n.right<e.left||n.left>e.right)}function b6(n,t){return t.some(e=>n.top<e.top||n.bottom>e.bottom||n.left<e.left||n.right>e.right)}class moe{constructor(t,e,i,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();LP(e,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let goe=(()=>{class n{constructor(e,i,r,o){this._scrollDispatcher=e,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new x6,this.close=l=>new poe(this._scrollDispatcher,this._ngZone,this._viewportRuler,l),this.block=()=>new foe(this._viewportRuler,this._document),this.reposition=l=>new moe(this._scrollDispatcher,this._viewportRuler,this._ngZone,l),this._document=o}static#e=this.\u0275fac=function(i){return new(i||n)(it(doe),it(_6),it(wi),it(rr))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class kT{constructor(t){if(this.scrollStrategy=new x6,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const i of e)void 0!==t[i]&&(this[i]=t[i])}}}class _oe{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}let w6=(()=>{class n{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const i=this._attachedOverlays.indexOf(e);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),yoe=(()=>{class n extends w6{constructor(e,i){super(e),this._ngZone=i,this._keydownListener=r=>{const o=this._attachedOverlays;for(let l=o.length-1;l>-1;l--)if(o[l]._keydownEvents.observers.length>0){const f=o[l]._keydownEvents;this._ngZone?this._ngZone.run(()=>f.next(r)):f.next(r);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr),it(wi,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),voe=(()=>{class n extends w6{constructor(e,i,r){super(e),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=o=>{this._pointerDownEventTarget=eg(o)},this._clickListener=o=>{const l=eg(o),f="click"===o.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:l;this._pointerDownEventTarget=null;const g=this._attachedOverlays.slice();for(let b=g.length-1;b>-1;b--){const S=g[b];if(S._outsidePointerEvents.observers.length<1||!S.hasAttached())continue;if(S.overlayElement.contains(l)||S.overlayElement.contains(f))break;const O=S._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>O.next(o)):O.next(o)}}}add(e){if(super.add(e),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr),it(rl),it(wi,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),RT=(()=>{class n{constructor(e,i){this._platform=i,this._document=e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||$2()){const r=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let o=0;o<r.length;o++)r[o].remove()}const i=this._document.createElement("div");i.classList.add(e),$2()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}static#e=this.\u0275fac=function(i){return new(i||n)(it(rr),it(rl))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class tw{constructor(t,e,i,r,o,l,f,g,b,S=!1){this._portalOutlet=t,this._host=e,this._pane=i,this._config=r,this._ngZone=o,this._keyboardDispatcher=l,this._document=f,this._location=g,this._outsideClickDispatcher=b,this._animationsDisabled=S,this._backdropElement=null,this._backdropClick=new Oe,this._attachments=new Oe,this._detachments=new Oe,this._locationChanges=Me.EMPTY,this._backdropClickHandler=O=>this._backdropClick.next(O),this._backdropTransitionendHandler=O=>{this._disposeBackdrop(O.target)},this._keydownEvents=new Oe,this._outsidePointerEvents=new Oe,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Ls(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=la(this._config.width),t.height=la(this._config.height),t.minWidth=la(this._config.minWidth),t.minHeight=la(this._config.minHeight),t.maxWidth=la(this._config.maxWidth),t.maxHeight=la(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,e,i){const r=HI(e||[]).filter(o=>!!o);r.length&&(i?t.classList.add(...r):t.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(ld(ue(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const E6="cdk-overlay-connected-position-bounding-box",xoe=/([A-Za-z%]+)$/;class C6{get positions(){return this._preferredPositions}constructor(t,e,i,r,o){this._viewportRuler=e,this._document=i,this._platform=r,this._overlayContainer=o,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Oe,this._resizeSubscription=Me.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._validatePositions(),t.hostElement.classList.add(E6),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,i=this._viewportRect,r=this._containerRect,o=[];let l;for(let f of this._preferredPositions){let g=this._getOriginPoint(t,r,f),b=this._getOverlayPoint(g,e,f),S=this._getOverlayFit(b,e,i,f);if(S.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(f,g);this._canFitWithFlexibleDimensions(S,b,i)?o.push({position:f,origin:g,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(g,f)}):(!l||l.overlayFit.visibleArea<S.visibleArea)&&(l={overlayFit:S,overlayPoint:b,originPoint:g,position:f,overlayRect:e})}if(o.length){let f=null,g=-1;for(const b of o){const S=b.boundingBoxRect.width*b.boundingBoxRect.height*(b.position.weight||1);S>g&&(g=S,f=b)}return this._isPushed=!1,void this._applyPosition(f.position,f.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(l.position,l.originPoint);this._applyPosition(l.position,l.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&q_(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(E6),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,i){let r,o;if("center"==i.originX)r=t.left+t.width/2;else{const l=this._isRtl()?t.right:t.left,f=this._isRtl()?t.left:t.right;r="start"==i.originX?l:f}return e.left<0&&(r-=e.left),o="center"==i.originY?t.top+t.height/2:"top"==i.originY?t.top:t.bottom,e.top<0&&(o-=e.top),{x:r,y:o}}_getOverlayPoint(t,e,i){let r,o;return r="center"==i.overlayX?-e.width/2:"start"===i.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,o="center"==i.overlayY?-e.height/2:"top"==i.overlayY?0:-e.height,{x:t.x+r,y:t.y+o}}_getOverlayFit(t,e,i,r){const o=T6(e);let{x:l,y:f}=t,g=this._getOffset(r,"x"),b=this._getOffset(r,"y");g&&(l+=g),b&&(f+=b);let $=0-f,J=f+o.height-i.height,ge=this._subtractOverflows(o.width,0-l,l+o.width-i.width),Ce=this._subtractOverflows(o.height,$,J),je=ge*Ce;return{visibleArea:je,isCompletelyWithinViewport:o.width*o.height===je,fitsInViewportVertically:Ce===o.height,fitsInViewportHorizontally:ge==o.width}}_canFitWithFlexibleDimensions(t,e,i){if(this._hasFlexibleDimensions){const r=i.bottom-e.y,o=i.right-e.x,l=I6(this._overlayRef.getConfig().minHeight),f=I6(this._overlayRef.getConfig().minWidth);return(t.fitsInViewportVertically||null!=l&&l<=r)&&(t.fitsInViewportHorizontally||null!=f&&f<=o)}return!1}_pushOverlayOnScreen(t,e,i){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=T6(e),o=this._viewportRect,l=Math.max(t.x+r.width-o.width,0),f=Math.max(t.y+r.height-o.height,0),g=Math.max(o.top-i.top-t.y,0),b=Math.max(o.left-i.left-t.x,0);let S=0,O=0;return S=r.width<=o.width?b||-l:t.x<this._viewportMargin?o.left-i.left-t.x:0,O=r.height<=o.height?g||-f:t.y<this._viewportMargin?o.top-i.top-t.y:0,this._previousPushAmount={x:S,y:O},{x:t.x+S,y:t.y+O}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new _oe(t,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=t.overlayY;i="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let o=0;o<e.length;o++)e[o].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(t,e){const i=this._viewportRect,r=this._isRtl();let o,l,f,S,O,$;if("top"===e.overlayY)l=t.y,o=i.height-l+this._viewportMargin;else if("bottom"===e.overlayY)f=i.height-t.y+2*this._viewportMargin,o=i.height-f+this._viewportMargin;else{const J=Math.min(i.bottom-t.y+i.top,t.y),ge=this._lastBoundingBoxSize.height;o=2*J,l=t.y-J,o>ge&&!this._isInitialRender&&!this._growAfterOpen&&(l=t.y-ge/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)$=i.width-t.x+this._viewportMargin,S=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)O=t.x,S=i.right-t.x;else{const J=Math.min(i.right-t.x+i.left,t.x),ge=this._lastBoundingBoxSize.width;S=2*J,O=t.x-J,S>ge&&!this._isInitialRender&&!this._growAfterOpen&&(O=t.x-ge/2)}return{top:l,left:O,bottom:f,right:$,width:S,height:o}}_setBoundingBoxStyles(t,e){const i=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const o=this._overlayRef.getConfig().maxHeight,l=this._overlayRef.getConfig().maxWidth;r.height=la(i.height),r.top=la(i.top),r.bottom=la(i.bottom),r.width=la(i.width),r.left=la(i.left),r.right=la(i.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",o&&(r.maxHeight=la(o)),l&&(r.maxWidth=la(l))}this._lastBoundingBoxSize=i,q_(this._boundingBox.style,r)}_resetBoundingBoxStyles(){q_(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){q_(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const i={},r=this._hasExactPosition(),o=this._hasFlexibleDimensions,l=this._overlayRef.getConfig();if(r){const S=this._viewportRuler.getViewportScrollPosition();q_(i,this._getExactOverlayY(e,t,S)),q_(i,this._getExactOverlayX(e,t,S))}else i.position="static";let f="",g=this._getOffset(e,"x"),b=this._getOffset(e,"y");g&&(f+=`translateX(${g}px) `),b&&(f+=`translateY(${b}px)`),i.transform=f.trim(),l.maxHeight&&(r?i.maxHeight=la(l.maxHeight):o&&(i.maxHeight="")),l.maxWidth&&(r?i.maxWidth=la(l.maxWidth):o&&(i.maxWidth="")),q_(this._pane.style,i)}_getExactOverlayY(t,e,i){let r={top:"",bottom:""},o=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,i)),"bottom"===t.overlayY?r.bottom=this._document.documentElement.clientHeight-(o.y+this._overlayRect.height)+"px":r.top=la(o.y),r}_getExactOverlayX(t,e,i){let l,r={left:"",right:""},o=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,i)),l=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===l?r.right=this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)+"px":r.left=la(o.x),r}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:b6(t,i),isOriginOutsideView:LP(t,i),isOverlayClipped:b6(e,i),isOverlayOutsideView:LP(e,i)}}_subtractOverflows(t,...e){return e.reduce((i,r)=>i-Math.max(r,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+t-this._viewportMargin,bottom:i.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&HI(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof fr)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,i=t.height||0;return{top:t.y,bottom:t.y+i,left:t.x,right:t.x+e,height:i,width:e}}}function q_(n,t){for(let e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function I6(n){if("number"!=typeof n&&null!=n){const[t,e]=n.split(xoe);return e&&"px"!==e?null:parseFloat(t)}return n||null}function T6(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const D6="cdk-global-overlay-wrapper";class boe{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(D6),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:o,maxWidth:l,maxHeight:f}=i,g=!("100%"!==r&&"100vw"!==r||l&&"100%"!==l&&"100vw"!==l),b=!("100%"!==o&&"100vh"!==o||f&&"100%"!==f&&"100vh"!==f),S=this._xPosition,O=this._xOffset,$="rtl"===this._overlayRef.getConfig().direction;let J="",ge="",Ce="";g?Ce="flex-start":"center"===S?(Ce="center",$?ge=O:J=O):$?"left"===S||"end"===S?(Ce="flex-end",J=O):("right"===S||"start"===S)&&(Ce="flex-start",ge=O):"left"===S||"start"===S?(Ce="flex-start",J=O):("right"===S||"end"===S)&&(Ce="flex-end",ge=O),t.position=this._cssPosition,t.marginLeft=g?"0":J,t.marginTop=b?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=g?"0":ge,e.justifyContent=Ce,e.alignItems=b?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,i=e.style;e.classList.remove(D6),i.justifyContent=i.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let woe=(()=>{class n{constructor(e,i,r,o){this._viewportRuler=e,this._document=i,this._platform=r,this._overlayContainer=o}global(){return new boe}flexibleConnectedTo(e){return new C6(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static#e=this.\u0275fac=function(i){return new(i||n)(it(_6),it(rr),it(rl),it(RT))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Eoe=0,bf=(()=>{class n{constructor(e,i,r,o,l,f,g,b,S,O,$,J){this.scrollStrategies=e,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=o,this._keyboardDispatcher=l,this._injector=f,this._ngZone=g,this._document=b,this._directionality=S,this._location=O,this._outsideClickDispatcher=$,this._animationsModuleType=J}create(e){const i=this._createHostElement(),r=this._createPaneElement(i),o=this._createPortalOutlet(r),l=new kT(e);return l.direction=l.direction||this._directionality.value,new tw(o,i,r,l,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(e){const i=this._document.createElement("div");return i.id="cdk-overlay-"+Eoe++,i.classList.add("cdk-overlay-pane"),e.appendChild(i),i}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(jm)),new Wre(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}static#e=this.\u0275fac=function(i){return new(i||n)(it(goe),it(RT),it(Pm),it(woe),it(yoe),it(Hr),it(wi),it(rr),it(ng),it(n1),it(voe),it(Ju,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Toe={provide:new Xt("cdk-connected-overlay-scroll-strategy"),deps:[bf],useFactory:function Ioe(n){return()=>n.scrollStrategies.reposition()}};let OT=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[bf,Toe],imports:[F1,Tv,y6,y6]})}return n})();function Doe(n,t){if(1&n){const e=Qo();ht(0,"div",2)(1,"button",3),Qn("click",function(){return _i(e),Gn(In().action())}),on(2),pt()()}if(2&n){const e=In();X(2),ys(" ",e.data.action," ")}}const Aoe=["label"];function Soe(n,t){}const Moe=Math.pow(2,31)-1;class NP{constructor(t,e){this._overlayRef=e,this._afterDismissed=new Oe,this._afterOpened=new Oe,this._onAction=new Oe,this._dismissedByAction=!1,this.containerInstance=t,t._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(t){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(t,Moe))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}const A6=new Xt("MatSnackBarData");class FT{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}let Poe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=On({type:n,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return n})(),koe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=On({type:n,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return n})(),Roe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=On({type:n,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return n})(),Ooe=(()=>{class n{constructor(e,i){this.snackBarRef=e,this.data=i}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static#e=this.\u0275fac=function(i){return new(i||n)(H(NP),H(A6))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions","",4,"ngIf"],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(i,r){1&i&&(ht(0,"div",0),on(1),pt(),Yn(2,Doe,3,1,"div",1)),2&i&&(X(1),ys(" ",r.data.message,"\n"),X(1),un("ngIf",r.hasAction))},dependencies:[Yd,MP,Poe,koe,Roe],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0})}return n})();const Foe={snackBarState:p1("state",[P_("void, hidden",Na({transform:"scale(0.8)",opacity:0})),P_("visible",Na({transform:"scale(1)",opacity:1})),Pp("* => visible",Mp("150ms cubic-bezier(0, 0, 0.2, 1)")),Pp("* => void, * => hidden",Mp("75ms cubic-bezier(0.4, 0.0, 1, 1)",Na({opacity:0})))])};let Loe=0,Noe=(()=>{class n extends ST{constructor(e,i,r,o,l){super(),this._ngZone=e,this._elementRef=i,this._changeDetectorRef=r,this._platform=o,this.snackBarConfig=l,this._document=xn(rr),this._trackedModals=new Set,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new Oe,this._onExit=new Oe,this._onEnter=new Oe,this._animationState="void",this._liveElementId="mat-snack-bar-container-live-"+Loe++,this.attachDomPortal=f=>{this._assertNotAttached();const g=this._portalOutlet.attachDomPortal(f);return this._afterPortalAttached(),g},this._live="assertive"!==l.politeness||l.announcementMessage?"off"===l.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(e){this._assertNotAttached();const i=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),i}attachTemplatePortal(e){this._assertNotAttached();const i=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),i}onAnimationEnd(e){const{fromState:i,toState:r}=e;if(("void"===r&&"void"!==i||"hidden"===r)&&this._completeExit(),"visible"===r){const o=this._onEnter;this._ngZone.run(()=>{o.next(),o.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe(Ls(1)).subscribe(()=>{this._ngZone.run(()=>{this._onExit.next(),this._onExit.complete()})})}_afterPortalAttached(){const e=this._elementRef.nativeElement,i=this.snackBarConfig.panelClass;i&&(Array.isArray(i)?i.forEach(r=>e.classList.add(r)):e.classList.add(i)),this._exposeToModals()}_exposeToModals(){const e=this._liveElementId,i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<i.length;r++){const o=i[r],l=o.getAttribute("aria-owns");this._trackedModals.add(o),l?-1===l.indexOf(e)&&o.setAttribute("aria-owns",l+" "+e):o.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{const i=e.getAttribute("aria-owns");if(i){const r=i.replace(this._liveElementId,"").trim();r.length>0?e.setAttribute("aria-owns",r):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const e=this._elementRef.nativeElement.querySelector("[aria-hidden]"),i=this._elementRef.nativeElement.querySelector("[aria-live]");if(e&&i){let r=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&e.contains(document.activeElement)&&(r=document.activeElement),e.removeAttribute("aria-hidden"),i.appendChild(e),r?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static#e=this.\u0275fac=function(i){return new(i||n)(H(wi),H(fr),H(mu),H(rl),H(FT))};static#t=this.\u0275dir=On({type:n,viewQuery:function(i,r){if(1&i&&Jl(W_,7),2&i){let o;wa(o=Ea())&&(r._portalOutlet=o.first)}},features:[Qi]})}return n})(),Boe=(()=>{class n extends Noe{_afterPortalAttached(){super._afterPortalAttached();const e=this._label.nativeElement,i="mdc-snackbar__label";e.classList.toggle(i,!e.querySelector(`.${i}`))}static#e=this.\u0275fac=function(){let e;return function(r){return(e||(e=ms(n)))(r||n)}}();static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-snack-bar-container"]],viewQuery:function(i,r){if(1&i&&Jl(Aoe,7),2&i){let o;wa(o=Ea())&&(r._label=o.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container","mdc-snackbar--open"],hostVars:1,hostBindings:function(i,r){1&i&&SC("@state.done",function(l){return r.onAnimationEnd(l)}),2&i&&kC("@state",r._animationState)},features:[Qi],decls:6,vars:3,consts:[[1,"mdc-snackbar__surface"],[1,"mat-mdc-snack-bar-label"],["label",""],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(i,r){1&i&&(ht(0,"div",0)(1,"div",1,2)(3,"div",3),Yn(4,Soe,0,0,"ng-template",4),pt(),Ji(5,"div"),pt()()),2&i&&(X(5),ro("aria-live",r._live)("role",r._role)("id",r._liveElementId))},dependencies:[W_],styles:['.mdc-snackbar{display:none;position:fixed;right:0;bottom:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;pointer-events:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mdc-snackbar--opening,.mdc-snackbar--open,.mdc-snackbar--closing{display:flex}.mdc-snackbar--open .mdc-snackbar__label,.mdc-snackbar--open .mdc-snackbar__actions{visibility:visible}.mdc-snackbar__surface{padding-left:0;padding-right:8px;display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;transform:scale(0.8);opacity:0}.mdc-snackbar__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-snackbar__surface::before{border-color:CanvasText}}[dir=rtl] .mdc-snackbar__surface,.mdc-snackbar__surface[dir=rtl]{padding-left:8px;padding-right:0}.mdc-snackbar--open .mdc-snackbar__surface{transform:scale(1);opacity:1;pointer-events:auto}.mdc-snackbar--closing .mdc-snackbar__surface{transform:scale(1)}.mdc-snackbar__label{padding-left:16px;padding-right:8px;width:100%;flex-grow:1;box-sizing:border-box;margin:0;visibility:hidden;padding-top:14px;padding-bottom:14px}[dir=rtl] .mdc-snackbar__label,.mdc-snackbar__label[dir=rtl]{padding-left:8px;padding-right:16px}.mdc-snackbar__label::before{display:inline;content:attr(data-mdc-snackbar-label-text)}.mdc-snackbar__actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box;visibility:hidden}.mdc-snackbar__action+.mdc-snackbar__dismiss{margin-left:8px;margin-right:0}[dir=rtl] .mdc-snackbar__action+.mdc-snackbar__dismiss,.mdc-snackbar__action+.mdc-snackbar__dismiss[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-snack-bar-container{margin:8px;--mdc-snackbar-container-shape:4px;position:static}.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:344px}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container .mdc-snackbar__surface{min-width:100%}}@media(max-width: 480px),(max-width: 344px){.mat-mdc-snack-bar-container{width:100vw}}.mat-mdc-snack-bar-container .mdc-snackbar__surface{max-width:672px}.mat-mdc-snack-bar-container .mdc-snackbar__surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{background-color:var(--mdc-snackbar-container-color)}.mat-mdc-snack-bar-container .mdc-snackbar__surface{border-radius:var(--mdc-snackbar-container-shape)}.mat-mdc-snack-bar-container .mdc-snackbar__label{color:var(--mdc-snackbar-supporting-text-color)}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-size:var(--mdc-snackbar-supporting-text-size);font-family:var(--mdc-snackbar-supporting-text-font);font-weight:var(--mdc-snackbar-supporting-text-weight);line-height:var(--mdc-snackbar-supporting-text-line-height)}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){color:var(--mat-snack-bar-button-color);--mat-mdc-button-persistent-ripple-color: currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{background-color:currentColor;opacity:.1}.mat-mdc-snack-bar-container .mdc-snackbar__label::before{display:none}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-handset .mdc-snackbar__surface{width:100%}'],encapsulation:2,data:{animation:[Foe.snackBarState]}})}return n})(),S6=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[OT,Tv,a1,f6,xu,xu]})}return n})();const M6=new Xt("mat-snack-bar-default-options",{providedIn:"root",factory:function Voe(){return new FT}});let zoe=(()=>{class n{get _openedSnackBarRef(){const e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(e,i,r,o,l,f){this._overlay=e,this._live=i,this._injector=r,this._breakpointObserver=o,this._parentSnackBar=l,this._defaultConfig=f,this._snackBarRefAtThisLevel=null}openFromComponent(e,i){return this._attach(e,i)}openFromTemplate(e,i){return this._attach(e,i)}open(e,i="",r){const o={...this._defaultConfig,...r};return o.data={message:e,action:i},o.announcementMessage===e&&(o.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,o)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,i){const o=Hr.create({parent:i&&i.viewContainerRef&&i.viewContainerRef.injector||this._injector,providers:[{provide:FT,useValue:i}]}),l=new G_(this.snackBarContainerComponent,i.viewContainerRef,o),f=e.attach(l);return f.instance.snackBarConfig=i,f.instance}_attach(e,i){const r={...new FT,...this._defaultConfig,...i},o=this._createOverlay(r),l=this._attachSnackBarContainer(o,r),f=new NP(l,o);if(e instanceof qd){const g=new kP(e,null,{$implicit:r.data,snackBarRef:f});f.instance=l.attachTemplatePortal(g)}else{const g=this._createInjector(r,f),b=new G_(e,void 0,g),S=l.attachComponentPortal(b);f.instance=S.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(ld(o.detachments())).subscribe(g=>{o.overlayElement.classList.toggle(this.handsetCssClass,g.matches)}),r.announcementMessage&&l._onAnnounce.subscribe(()=>{this._live.announce(r.announcementMessage,r.politeness)}),this._animateSnackBar(f,r),this._openedSnackBarRef=f,this._openedSnackBarRef}_animateSnackBar(e,i){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),i.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter(),i.duration&&i.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(i.duration))}_createOverlay(e){const i=new kT;i.direction=e.direction;let r=this._overlay.position().global();const o="rtl"===e.direction,l="left"===e.horizontalPosition||"start"===e.horizontalPosition&&!o||"end"===e.horizontalPosition&&o,f=!l&&"center"!==e.horizontalPosition;return l?r.left("0"):f?r.right("0"):r.centerHorizontally(),"top"===e.verticalPosition?r.top("0"):r.bottom("0"),i.positionStrategy=r,this._overlay.create(i)}_createInjector(e,i){return Hr.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:NP,useValue:i},{provide:A6,useValue:e.data}]})}static#e=this.\u0275fac=function(i){return new(i||n)(it(bf),it(fz),it(Hr),it(q2),it(n,12),it(M6))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})(),P6=(()=>{class n extends zoe{constructor(e,i,r,o,l,f){super(e,i,r,o,l,f),this.simpleSnackBarComponent=Ooe,this.snackBarContainerComponent=Boe,this.handsetCssClass="mat-mdc-snack-bar-handset"}static#e=this.\u0275fac=function(i){return new(i||n)(it(bf),it(fz),it(Hr),it(q2),it(n,12),it(M6))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:S6})}return n})();var Jt=Ve(5861);class nw{constructor(t){return t}}class k6{constructor(){return(0,rc.getApps)()}}const BP=new Xt("angularfire2._apps"),joe={provide:nw,useFactory:function Uoe(n){return n&&1===n.length?n[0]:new nw((0,rc.getApp)())},deps:[[new jr,BP]]},$oe={provide:k6,deps:[[new jr,BP]]};function Hoe(n){return(t,e)=>{const i=t.runOutsideAngular(()=>n(e));return new nw(i)}}let Goe=(()=>{class n{constructor(e){(0,rc.registerVersion)("angularfire",wv.full,"core"),(0,rc.registerVersion)("angularfire",wv.full,"app"),(0,rc.registerVersion)("angular",yp.full,e.toString())}static \u0275fac=function(i){return new(i||n)(it(bl))};static \u0275mod=qi({type:n});static \u0275inj=Ai({providers:[joe,$oe]})}return n})();function Woe(n,...t){return{ngModule:Goe,providers:[{provide:BP,useFactory:Hoe(n),multi:!0,deps:[wi,Hr,IT,...t]}]}}const qoe=TP(rc.initializeApp,!0);class O6{constructor(){return CP("auth")}}var Wn,Xoe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},eh={},UP=UP||{},er=Xoe||self;function LT(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function iw(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var jP="closure_uid_"+(1e9*Math.random()>>>0),Joe=0;function ese(n,t,e){return n.call.apply(n.bind,arguments)}function tse(n,t,e){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,i),n.apply(t,r)}}return function(){return n.apply(t,arguments)}}function Il(n,t,e){return(Il=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ese:tse).apply(null,arguments)}function NT(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var i=e.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function Va(n,t){function e(){}e.prototype=t.prototype,n.$=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.ac=function(i,r,o){for(var l=Array(arguments.length-2),f=2;f<arguments.length;f++)l[f-2]=arguments[f];return t.prototype[r].apply(i,l)}}function sg(){this.s=this.s,this.o=this.o}sg.prototype.s=!1,sg.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Qoe(n){Object.prototype.hasOwnProperty.call(n,jP)&&n[jP]||(n[jP]=++Joe)}(this)},sg.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const F6=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function $P(n){const t=n.length;if(0<t){const e=Array(t);for(let i=0;i<t;i++)e[i]=n[i];return e}return[]}function L6(n,t){for(let e=1;e<arguments.length;e++){const i=arguments[e];if(LT(i)){const r=n.length||0,o=i.length||0;n.length=r+o;for(let l=0;l<o;l++)n[r+l]=i[l]}else n.push(i)}}function Tl(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}Tl.prototype.h=function(){this.defaultPrevented=!0};var ise=function(){if(!er.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{const e=()=>{};er.addEventListener("test",e,t),er.removeEventListener("test",e,t)}catch{}return n}();function rw(n){return/^[\s\xa0]*$/.test(n)}function BT(){var n=er.navigator;return n&&(n=n.userAgent)?n:""}function wf(n){return-1!=BT().indexOf(n)}function HP(n){return HP[" "](n),n}HP[" "]=function(){};var WP,n,ose=wf("Opera"),Dv=wf("Trident")||wf("MSIE"),N6=wf("Edge"),GP=N6||Dv,B6=wf("Gecko")&&!(-1!=BT().toLowerCase().indexOf("webkit")&&!wf("Edge"))&&!(wf("Trident")||wf("MSIE"))&&!wf("Edge"),sse=-1!=BT().toLowerCase().indexOf("webkit")&&!wf("Edge");function V6(){var n=er.document;return n?n.documentMode:void 0}e:{var qP="",ZP=(n=BT(),B6?/rv:([^\);]+)(\)|;)/.exec(n):N6?/Edge\/([\d\.]+)/.exec(n):Dv?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):sse?/WebKit\/(\S+)/.exec(n):ose?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(ZP&&(qP=ZP?ZP[1]:""),Dv){var KP=V6();if(null!=KP&&KP>parseFloat(qP)){WP=String(KP);break e}}WP=qP}var ase=er.document&&Dv&&(V6()||parseInt(WP,10))||void 0;function ow(n,t){if(Tl.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(B6){e:{try{HP(t.nodeName);var r=!0;break e}catch{}r=!1}r||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:lse[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&ow.$.h.call(this)}}Va(ow,Tl);var lse={2:"touch",3:"pen",4:"mouse"};ow.prototype.h=function(){ow.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var sw="closure_listenable_"+(1e6*Math.random()|0),cse=0;function use(n,t,e,i,r){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!i,this.la=r,this.key=++cse,this.fa=this.ia=!1}function VT(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function XP(n,t,e){for(const i in n)t.call(e,n[i],i,n)}function U6(n){const t={};for(const e in n)t[e]=n[e];return t}const j6="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $6(n,t){let e,i;for(let r=1;r<arguments.length;r++){for(e in i=arguments[r],i)n[e]=i[e];for(let o=0;o<j6.length;o++)e=j6[o],Object.prototype.hasOwnProperty.call(i,e)&&(n[e]=i[e])}}function zT(n){this.src=n,this.g={},this.h=0}function QP(n,t){var e=t.type;if(e in n.g){var o,i=n.g[e],r=F6(i,t);(o=0<=r)&&Array.prototype.splice.call(i,r,1),o&&(VT(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function JP(n,t,e,i){for(var r=0;r<n.length;++r){var o=n[r];if(!o.fa&&o.listener==t&&o.capture==!!e&&o.la==i)return r}return-1}zT.prototype.add=function(n,t,e,i,r){var o=n.toString();(n=this.g[o])||(n=this.g[o]=[],this.h++);var l=JP(n,t,i,r);return-1<l?(t=n[l],e||(t.ia=!1)):((t=new use(t,this.src,o,!!i,r)).ia=e,n.push(t)),t};var ek="closure_lm_"+(1e6*Math.random()|0),tk={};function H6(n,t,e,i,r){if(i&&i.once)return W6(n,t,e,i,r);if(Array.isArray(t)){for(var o=0;o<t.length;o++)H6(n,t[o],e,i,r);return null}return e=ok(e),n&&n[sw]?n.O(t,e,iw(i)?!!i.capture:!!i,r):G6(n,t,e,!1,i,r)}function G6(n,t,e,i,r,o){if(!t)throw Error("Invalid event type");var l=iw(r)?!!r.capture:!!r,f=ik(n);if(f||(n[ek]=f=new zT(n)),(e=f.add(t,e,i,l,o)).proxy)return e;if(i=function hse(){const t=fse;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=i,i.src=n,i.listener=e,n.addEventListener)ise||(r=l),void 0===r&&(r=!1),n.addEventListener(t.toString(),i,r);else if(n.attachEvent)n.attachEvent(Z6(t.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return e}function W6(n,t,e,i,r){if(Array.isArray(t)){for(var o=0;o<t.length;o++)W6(n,t[o],e,i,r);return null}return e=ok(e),n&&n[sw]?n.P(t,e,iw(i)?!!i.capture:!!i,r):G6(n,t,e,!0,i,r)}function q6(n,t,e,i,r){if(Array.isArray(t))for(var o=0;o<t.length;o++)q6(n,t[o],e,i,r);else i=iw(i)?!!i.capture:!!i,e=ok(e),n&&n[sw]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=JP(o=n.g[t],e,i,r))&&(VT(o[e]),Array.prototype.splice.call(o,e,1),0==o.length&&(delete n.g[t],n.h--))):n&&(n=ik(n))&&(t=n.g[t.toString()],n=-1,t&&(n=JP(t,e,i,r)),(e=-1<n?t[n]:null)&&nk(e))}function nk(n){if("number"!=typeof n&&n&&!n.fa){var t=n.src;if(t&&t[sw])QP(t.i,n);else{var e=n.type,i=n.proxy;t.removeEventListener?t.removeEventListener(e,i,n.capture):t.detachEvent?t.detachEvent(Z6(e),i):t.addListener&&t.removeListener&&t.removeListener(i),(e=ik(t))?(QP(e,n),0==e.h&&(e.src=null,t[ek]=null)):VT(n)}}}function Z6(n){return n in tk?tk[n]:tk[n]="on"+n}function fse(n,t){if(n.fa)n=!0;else{t=new ow(t,this);var e=n.listener,i=n.la||n.src;n.ia&&nk(n),n=e.call(i,t)}return n}function ik(n){return(n=n[ek])instanceof zT?n:null}var rk="__closure_events_fn_"+(1e9*Math.random()>>>0);function ok(n){return"function"==typeof n?n:(n[rk]||(n[rk]=function(t){return n.handleEvent(t)}),n[rk])}function za(){sg.call(this),this.i=new zT(this),this.S=this,this.J=null}function ol(n,t){var e,i=n.J;if(i)for(e=[];i;i=i.J)e.push(i);if(n=n.S,i=t.type||t,"string"==typeof t)t=new Tl(t,n);else if(t instanceof Tl)t.target=t.target||n;else{var r=t;$6(t=new Tl(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var l=t.g=e[o];r=UT(l,i,!0,t)&&r}if(r=UT(l=t.g=n,i,!0,t)&&r,r=UT(l,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=UT(l=t.g=e[o],i,!1,t)&&r}function UT(n,t,e,i){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var r=!0,o=0;o<t.length;++o){var l=t[o];if(l&&!l.fa&&l.capture==e){var f=l.listener,g=l.la||l.src;l.ia&&QP(n.i,l),r=!1!==f.call(g,i)&&r}}return r&&!i.defaultPrevented}Va(za,sg),za.prototype[sw]=!0,za.prototype.removeEventListener=function(n,t,e,i){q6(this,n,t,e,i)},za.prototype.N=function(){if(za.$.N.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],i=0;i<e.length;i++)VT(e[i]);delete n.g[t],n.h--}}this.J=null},za.prototype.O=function(n,t,e,i){return this.i.add(String(n),t,!1,e,i)},za.prototype.P=function(n,t,e,i){return this.i.add(String(n),t,!0,e,i)};var sk=er.JSON.stringify;function mse(){var n=ak;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var K6=new class pse{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new _se,n=>n.reset());class _se{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function yse(n){var t=1;n=n.split(":");const e=[];for(;0<t&&n.length;)e.push(n.shift()),t--;return n.length&&e.push(n.join(":")),e}function vse(n){er.setTimeout(()=>{throw n},0)}let aw,lw=!1,ak=new class gse{constructor(){this.h=this.g=null}add(t,e){const i=K6.get();i.set(t,e),this.h?this.h.next=i:this.g=i,this.h=i}},Y6=()=>{const n=er.Promise.resolve(void 0);aw=()=>{n.then(xse)}};var xse=()=>{for(var n;n=mse();){try{n.h.call(n.g)}catch(e){vse(e)}var t=K6;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}lw=!1};function jT(n,t){za.call(this),this.h=n||1,this.g=t||er,this.j=Il(this.qb,this),this.l=Date.now()}function lk(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}function ck(n,t,e){if("function"==typeof n)e&&(n=Il(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Il(n.handleEvent,n)}return 2147483647<Number(t)?-1:er.setTimeout(n,t||0)}function X6(n){n.g=ck(()=>{n.g=null,n.i&&(n.i=!1,X6(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}Va(jT,za),(Wn=jT.prototype).ga=!1,Wn.T=null,Wn.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ol(this,"tick"),this.ga&&(lk(this),this.start()))}},Wn.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Wn.N=function(){jT.$.N.call(this),lk(this),delete this.g};class bse extends sg{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:X6(this)}N(){super.N(),this.g&&(er.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cw(n){sg.call(this),this.h=n,this.g={}}Va(cw,sg);var Q6=[];function J6(n,t,e,i){Array.isArray(e)||(e&&(Q6[0]=e.toString()),e=Q6);for(var r=0;r<e.length;r++){var o=H6(t,e[r],i||n.handleEvent,!1,n.h||n);if(!o)break;n.g[o.key]=o}}function e8(n){XP(n.g,function(t,e){this.g.hasOwnProperty(e)&&nk(t)},n),n.g={}}function $T(){this.g=!0}function Av(n,t,e,i){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function Ise(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var i=e[n];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var l=1;l<r.length;l++)r[l]=""}}}return sk(e)}catch{return t}}(n,e)+(i?" "+i:"")})}cw.prototype.N=function(){cw.$.N.call(this),e8(this)},cw.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},$T.prototype.Ea=function(){this.g=!1},$T.prototype.info=function(){};var Z_={},t8=null;function HT(){return t8=t8||new za}function n8(n){Tl.call(this,Z_.Ta,n)}function uw(n){const t=HT();ol(t,new n8(t))}function i8(n,t){Tl.call(this,Z_.STAT_EVENT,n),this.stat=t}function oc(n){const t=HT();ol(t,new i8(t,n))}function r8(n,t){Tl.call(this,Z_.Ua,n),this.size=t}function dw(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return er.setTimeout(function(){n()},t)}Z_.Ta="serverreachability",Va(n8,Tl),Z_.STAT_EVENT="statevent",Va(i8,Tl),Z_.Ua="timingevent",Va(r8,Tl);var GT={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},o8={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function uk(){}function a8(){}uk.prototype.h=null;var fk,hw={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function dk(){Tl.call(this,"d")}function hk(){Tl.call(this,"c")}function WT(){}function fw(n,t,e,i){this.l=n,this.j=t,this.m=e,this.W=i||1,this.U=new cw(this),this.P=Tse,this.V=new jT(n=GP?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new l8}function l8(){this.i=null,this.g="",this.h=!1}Va(dk,Tl),Va(hk,Tl),Va(WT,uk),WT.prototype.g=function(){return new XMLHttpRequest},WT.prototype.i=function(){return{}},fk=new WT;var Tse=45e3,c8={},pk={};function mk(n,t,e){n.L=1,n.A=YT(Lp(t)),n.u=e,n.S=!0,u8(n,null)}function u8(n,t){n.G=Date.now(),pw(n),n.B=Lp(n.A);var e=n.B,i=n.W;Array.isArray(i)||(i=[String(i)]),x8(e.i,"t",i),n.o=0,e=n.l.J,n.h=new l8,n.g=H8(n.l,e?t:null,!n.u),0<n.O&&(n.M=new bse(Il(n.Pa,n,n.g),n.O)),J6(n.U,n.g,"readystatechange",n.nb),t=n.I?U6(n.I):{},n.u?(n.v||(n.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.B,n.v,n.u,t)):(n.v="GET",n.g.ha(n.B,n.v,null,t)),uw(),function wse(n,t,e,i,r,o){n.info(function(){if(n.g)if(o)for(var l="",f=o.split("&"),g=0;g<f.length;g++){var b=f[g].split("=");if(1<b.length){var S=b[0];b=b[1];var O=S.split("_");l=2<=O.length&&"type"==O[1]?l+(S+"=")+b+"&":l+(S+"=redacted&")}}else l=null;else l=o;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+t+"\n"+e+"\n"+l})}(n.j,n.v,n.B,n.m,n.W,n.u)}function d8(n){return!!n.g&&"GET"==n.v&&2!=n.L&&n.l.Ha}function h8(n,t,e){let r,i=!0;for(;!n.J&&n.o<e.length;){if(r=Dse(n,e),r==pk){4==t&&(n.s=4,oc(14),i=!1),Av(n.j,n.m,null,"[Incomplete Response]");break}if(r==c8){n.s=4,oc(15),Av(n.j,n.m,e,"[Invalid Chunk]"),i=!1;break}Av(n.j,n.m,r,null),gk(n,r)}d8(n)&&0!=n.o&&(n.h.g=n.h.g.slice(n.o),n.o=0),4!=t||0!=e.length||n.h.h||(n.s=1,oc(16),i=!1),n.i=n.i&&i,i?0<e.length&&!n.ba&&(n.ba=!0,(t=n.l).g==n&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+e.length),Ek(t),t.M=!0,oc(11))):(Av(n.j,n.m,e,"[Invalid Chunked Response]"),K_(n),mw(n))}function Dse(n,t){var e=n.o,i=t.indexOf("\n",e);return-1==i?pk:(e=Number(t.substring(e,i)),isNaN(e)?c8:(i+=1)+e>t.length?pk:(t=t.slice(i,i+e),n.o=i+e,t))}function pw(n){n.Y=Date.now()+n.P,f8(n,n.P)}function f8(n,t){if(null!=n.C)throw Error("WatchDog timer not null");n.C=dw(Il(n.lb,n),t)}function qT(n){n.C&&(er.clearTimeout(n.C),n.C=null)}function mw(n){0==n.l.H||n.J||z8(n.l,n)}function K_(n){qT(n);var t=n.M;t&&"function"==typeof t.sa&&t.sa(),n.M=null,lk(n.V),e8(n.U),n.g&&(t=n.g,n.g=null,t.abort(),t.sa())}function gk(n,t){try{var e=n.l;if(0!=e.H&&(e.g==n||_k(e.i,n)))if(!n.K&&_k(e.i,n)&&3==e.H){try{var i=e.Ja.g.parse(t)}catch{i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){e:if(!e.u){if(e.g){if(!(e.g.G+3e3<n.G))break e;nD(e),eD(e)}wk(e),oc(18)}}else e.Fa=r[1],0<e.Fa-e.V&&37500>r[2]&&e.G&&0==e.A&&!e.v&&(e.v=dw(Il(e.ib,e),6e3));if(1>=E8(e.i)&&e.oa){try{e.oa()}catch{}e.oa=void 0}}else X_(e,11)}else if((n.K||e.g==n)&&nD(e),!rw(t))for(r=e.Ja.g.parse(t),t=0;t<r.length;t++){let b=r[t];if(e.V=b[0],b=b[1],2==e.H)if("c"==b[0]){e.K=b[1],e.pa=b[2];const S=b[3];null!=S&&(e.ra=S,e.l.info("VER="+e.ra));const O=b[4];null!=O&&(e.Ga=O,e.l.info("SVER="+e.Ga));const $=b[5];null!=$&&"number"==typeof $&&0<$&&(e.L=i=1.5*$,e.l.info("backChannelRequestTimeoutMs_="+i)),i=e;const J=n.g;if(J){const ge=J.g?J.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ge){var o=i.i;o.g||-1==ge.indexOf("spdy")&&-1==ge.indexOf("quic")&&-1==ge.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(yk(o,o.h),o.h=null))}if(i.F){const Ce=J.g?J.g.getResponseHeader("X-HTTP-Session-Id"):null;Ce&&(i.Da=Ce,Jo(i.I,i.F,Ce))}}e.H=3,e.h&&e.h.Ba(),e.ca&&(e.S=Date.now()-n.G,e.l.info("Handshake RTT: "+e.S+"ms"));var l=n;if((i=e).wa=$8(i,i.J?i.pa:null,i.Y),l.K){C8(i.i,l);var f=l,g=i.L;g&&f.setTimeout(g),f.C&&(qT(f),pw(f)),i.g=l}else B8(i);0<e.j.length&&tD(e)}else"stop"!=b[0]&&"close"!=b[0]||X_(e,7);else 3==e.H&&("stop"==b[0]||"close"==b[0]?"stop"==b[0]?X_(e,7):bk(e):"noop"!=b[0]&&e.h&&e.h.Aa(b),e.A=0)}uw()}catch{}}function p8(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(LT(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function Sse(n){if(n.ta&&"function"==typeof n.ta)return n.ta();if(!n.Z||"function"!=typeof n.Z){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(LT(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const i in n)t[e++]=i;return t}}}(n),i=function Ase(n){if(n.Z&&"function"==typeof n.Z)return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(LT(n)){for(var t=[],e=n.length,i=0;i<e;i++)t.push(n[i]);return t}for(i in t=[],e=0,n)t[e++]=n[i];return t}(n),r=i.length,o=0;o<r;o++)t.call(void 0,i[o],e&&e[o],n)}(Wn=fw.prototype).setTimeout=function(n){this.P=n},Wn.nb=function(n){n=n.target;const t=this.M;t&&3==Ef(n)?t.l():this.Pa(n)},Wn.Pa=function(n){try{if(n==this.g)e:{const S=Ef(this.g);var t=this.g.Ia();if(this.g.da(),!(3>S)&&(3!=S||GP||this.g&&(this.h.h||this.g.ja()||k8(this.g)))){this.J||4!=S||7==t||uw(),qT(this);var e=this.g.da();this.ca=e;t:if(d8(this)){var i=k8(this.g);n="";var r=i.length,o=4==Ef(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){K_(this),mw(this);var l="";break t}this.h.i=new er.TextDecoder}for(t=0;t<r;t++)this.h.h=!0,n+=this.h.i.decode(i[t],{stream:o&&t==r-1});i.length=0,this.h.g+=n,this.o=0,l=this.h.g}else l=this.g.ja();if(this.i=200==e,function Ese(n,t,e,i,r,o,l){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+t+"\n"+e+"\n"+o+" "+l})}(this.j,this.v,this.B,this.m,this.W,S,e),this.i){if(this.aa&&!this.K){t:{if(this.g){var f,g=this.g;if((f=g.g?g.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!rw(f)){var b=f;break t}}b=null}if(!(e=b)){this.i=!1,this.s=3,oc(12),K_(this),mw(this);break e}Av(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,gk(this,e)}this.S?(h8(this,S,l),GP&&this.i&&3==S&&(J6(this.U,this.V,"tick",this.mb),this.V.start())):(Av(this.j,this.m,l,null),gk(this,l)),4==S&&K_(this),this.i&&!this.J&&(4==S?z8(this.l,this):(this.i=!1,pw(this)))}else(function qse(n){const t={};n=(n.g&&2<=Ef(n)&&n.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<n.length;i++){if(rw(n[i]))continue;var e=yse(n[i]);const r=e[0];if("string"!=typeof(e=e[1]))continue;e=e.trim();const o=t[r]||[];t[r]=o,o.push(e)}!function dse(n,t){for(const e in n)t.call(void 0,n[e],e,n)}(t,function(i){return i.join(", ")})})(this.g),400==e&&0<l.indexOf("Unknown SID")?(this.s=3,oc(12)):(this.s=0,oc(13)),K_(this),mw(this)}}}catch{}},Wn.mb=function(){if(this.g){var n=Ef(this.g),t=this.g.ja();this.o<t.length&&(qT(this),h8(this,n,t),this.i&&4!=n&&pw(this))}},Wn.cancel=function(){this.J=!0,K_(this)},Wn.lb=function(){this.C=null;const n=Date.now();0<=n-this.Y?(function Cse(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.B),2!=this.L&&(uw(),oc(17)),K_(this),this.s=2,mw(this)):f8(this,this.Y-n)};var m8=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Y_(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Y_){this.h=n.h,ZT(this,n.j),this.s=n.s,this.g=n.g,KT(this,n.m),this.l=n.l;var t=n.i,e=new yw;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),g8(this,e),this.o=n.o}else n&&(t=String(n).match(m8))?(this.h=!1,ZT(this,t[1]||"",!0),this.s=gw(t[2]||""),this.g=gw(t[3]||"",!0),KT(this,t[4]),this.l=gw(t[5]||"",!0),g8(this,t[6]||"",!0),this.o=gw(t[7]||"")):(this.h=!1,this.i=new yw(null,this.h))}function Lp(n){return new Y_(n)}function ZT(n,t,e){n.j=e?gw(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function KT(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function g8(n,t,e){t instanceof yw?(n.i=t,function Lse(n,t){t&&!n.j&&(ag(n),n.i=null,n.g.forEach(function(e,i){var r=i.toLowerCase();i!=r&&(y8(this,i),x8(this,r,e))},n)),n.j=t}(n.i,n.h)):(e||(t=_w(t,Ose)),n.i=new yw(t,n.h))}function Jo(n,t,e){n.i.set(t,e)}function YT(n){return Jo(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function gw(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function _w(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,Pse),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Pse(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Y_.prototype.toString=function(){var n=[],t=this.j;t&&n.push(_w(t,_8,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(_w(t,_8,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(_w(e,"/"==e.charAt(0)?Rse:kse,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",_w(e,Fse)),n.join("")};var _8=/[#\/\?@]/g,kse=/[#\?:]/g,Rse=/[#\?]/g,Ose=/[#\?@]/g,Fse=/#/g;function yw(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function ag(n){n.g||(n.g=new Map,n.h=0,n.i&&function Mse(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var i=n[e].indexOf("="),r=null;if(0<=i){var o=n[e].substring(0,i);r=n[e].substring(i+1)}else o=n[e];t(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function y8(n,t){ag(n),t=Sv(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function v8(n,t){return ag(n),t=Sv(n,t),n.g.has(t)}function x8(n,t,e){y8(n,t),0<e.length&&(n.i=null,n.g.set(Sv(n,t),$P(e)),n.h+=e.length)}function Sv(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function b8(n){this.l=n||Bse,n=er.PerformanceNavigationTiming?0<(n=er.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(er.g&&er.g.Ka&&er.g.Ka()&&er.g.Ka().dc),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Wn=yw.prototype).add=function(n,t){ag(this),this.i=null,n=Sv(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},Wn.forEach=function(n,t){ag(this),this.g.forEach(function(e,i){e.forEach(function(r){n.call(t,r,i,this)},this)},this)},Wn.ta=function(){ag(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let i=0;i<t.length;i++){const r=n[i];for(let o=0;o<r.length;o++)e.push(t[i])}return e},Wn.Z=function(n){ag(this);let t=[];if("string"==typeof n)v8(this,n)&&(t=t.concat(this.g.get(Sv(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},Wn.set=function(n,t){return ag(this),this.i=null,v8(this,n=Sv(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},Wn.get=function(n,t){return n&&0<(n=this.Z(n)).length?String(n[0]):t},Wn.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var i=t[e];const o=encodeURIComponent(String(i)),l=this.Z(i);for(i=0;i<l.length;i++){var r=o;""!==l[i]&&(r+="="+encodeURIComponent(String(l[i]))),n.push(r)}}return this.i=n.join("&")};var Bse=10;function w8(n){return!!n.h||!!n.g&&n.g.size>=n.j}function E8(n){return n.h?1:n.g?n.g.size:0}function _k(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function yk(n,t){n.g?n.g.add(t):n.h=t}function C8(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function I8(n){if(null!=n.h)return n.i.concat(n.h.F);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.F);return t}return $P(n.i)}b8.prototype.cancel=function(){if(this.i=I8(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}};var Vse=class{stringify(n){return er.JSON.stringify(n,void 0)}parse(n){return er.JSON.parse(n,void 0)}};function zse(){this.g=new Vse}function Use(n,t,e){const i=e||"";try{p8(n,function(r,o){let l=r;iw(r)&&(l=sk(r)),t.push(i+o+"="+encodeURIComponent(l))})}catch(r){throw t.push(i+"type="+encodeURIComponent("_badmap")),r}}function XT(n,t,e,i,r){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,r(i)}catch{}}function vw(n){this.l=n.ec||null,this.j=n.ob||!1}function QT(n,t){za.call(this),this.F=n,this.u=t,this.m=void 0,this.readyState=vk,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Va(vw,uk),vw.prototype.g=function(){return new QT(this.l,this.j)},vw.prototype.i=function(n){return function(){return n}}({}),Va(QT,za);var vk=0;function T8(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}function xw(n){n.readyState=4,n.l=null,n.j=null,n.A=null,bw(n)}function bw(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(Wn=QT.prototype).open=function(n,t){if(this.readyState!=vk)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,bw(this)},Wn.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.F||er).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},Wn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,xw(this)),this.readyState=vk},Wn.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,bw(this)),this.g&&(this.readyState=3,bw(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof er.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;T8(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))},Wn.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?xw(this):bw(this),3==this.readyState&&T8(this)}},Wn.Za=function(n){this.g&&(this.response=this.responseText=n,xw(this))},Wn.Ya=function(n){this.g&&(this.response=n,xw(this))},Wn.ka=function(){this.g&&xw(this)},Wn.setRequestHeader=function(n,t){this.v.append(n,t)},Wn.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},Wn.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(QT.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var $se=er.JSON.parse;function Ns(n){za.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=D8,this.L=this.M=!1}Va(Ns,za);var D8="",Hse=/^https?$/i,Gse=["POST","PUT"];function A8(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,S8(n),JT(n)}function S8(n){n.F||(n.F=!0,ol(n,"complete"),ol(n,"error"))}function M8(n){if(n.h&&typeof UP<"u"&&(!n.C[1]||4!=Ef(n)||2!=n.da()))if(n.v&&4==Ef(n))ck(n.La,0,n);else if(ol(n,"readystatechange"),4==Ef(n)){n.h=!1;try{const l=n.da();e:switch(l){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var i;if(i=0===l){var r=String(n.I).match(m8)[1]||null;!r&&er.self&&er.self.location&&(r=er.self.location.protocol.slice(0,-1)),i=!Hse.test(r?r.toLowerCase():"")}e=i}if(e)ol(n,"complete"),ol(n,"success");else{n.m=6;try{var o=2<Ef(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.da()+"]",S8(n)}}finally{JT(n)}}}function JT(n,t){if(n.g){P8(n);const e=n.g,i=n.C[0]?()=>{}:null;n.g=null,n.C=null,t||ol(n,"ready");try{e.onreadystatechange=i}catch{}}}function P8(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(er.clearTimeout(n.A),n.A=null)}function Ef(n){return n.g?n.g.readyState:0}function k8(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case D8:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function R8(n){let t="";return XP(n,function(e,i){t+=i,t+=":",t+=e,t+="\r\n"}),t}function xk(n,t,e){e:{for(i in e){var i=!1;break e}i=!0}i||(e=R8(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):Jo(n,t,e))}function ww(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function O8(n){this.Ga=0,this.j=[],this.l=new $T,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ww("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ww("baseRetryDelayMs",5e3,n),this.hb=ww("retryDelaySeedMs",1e4,n),this.eb=ww("forwardChannelMaxRetries",2,n),this.xa=ww("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.useFetchStreams||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new b8(n&&n.concurrentRequestLimit),this.Ja=new zse,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function bk(n){if(F8(n),3==n.H){var t=n.W++,e=Lp(n.I);if(Jo(e,"SID",n.K),Jo(e,"RID",t),Jo(e,"TYPE","terminate"),Ew(n,e),(t=new fw(n,n.l,t)).L=2,t.A=YT(Lp(e)),e=!1,er.navigator&&er.navigator.sendBeacon)try{e=er.navigator.sendBeacon(t.A.toString(),"")}catch{}!e&&er.Image&&((new Image).src=t.A,e=!0),e||(t.g=H8(t.l,null),t.g.ha(t.A)),t.G=Date.now(),pw(t)}j8(n)}function eD(n){n.g&&(Ek(n),n.g.cancel(),n.g=null)}function F8(n){eD(n),n.u&&(er.clearTimeout(n.u),n.u=null),nD(n),n.i.cancel(),n.m&&("number"==typeof n.m&&er.clearTimeout(n.m),n.m=null)}function tD(n){if(!w8(n.i)&&!n.m){n.m=!0;var t=n.Na;aw||Y6(),lw||(aw(),lw=!0),ak.add(t,n),n.C=0}}function L8(n,t){var e;e=t?t.m:n.W++;const i=Lp(n.I);Jo(i,"SID",n.K),Jo(i,"RID",e),Jo(i,"AID",n.V),Ew(n,i),n.o&&n.s&&xk(i,n.o,n.s),e=new fw(n,n.l,e,n.C+1),null===n.o&&(e.I=n.s),t&&(n.j=t.F.concat(n.j)),t=N8(n,e,1e3),e.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),yk(n.i,e),mk(e,i,t)}function Ew(n,t){n.na&&XP(n.na,function(e,i){Jo(t,i,e)}),n.h&&p8({},function(e,i){Jo(t,i,e)})}function N8(n,t,e){e=Math.min(n.j.length,e);var i=n.h?Il(n.h.Va,n.h,n):null;e:{var r=n.j;let o=-1;for(;;){const l=["count="+e];-1==o?0<e?(o=r[0].g,l.push("ofs="+o)):o=0:l.push("ofs="+o);let f=!0;for(let g=0;g<e;g++){let b=r[g].g;const S=r[g].map;if(b-=o,0>b)o=Math.max(0,r[g].g-100),f=!1;else try{Use(S,l,"req"+b+"_")}catch{i&&i(S)}}if(f){i=l.join("&");break e}}}return n=n.j.splice(0,e),t.F=n,i}function B8(n){if(!n.g&&!n.u){n.ba=1;var t=n.Ma;aw||Y6(),lw||(aw(),lw=!0),ak.add(t,n),n.A=0}}function wk(n){return!(n.g||n.u||3<=n.A||(n.ba++,n.u=dw(Il(n.Ma,n),U8(n,n.A)),n.A++,0))}function Ek(n){null!=n.B&&(er.clearTimeout(n.B),n.B=null)}function V8(n){n.g=new fw(n,n.l,"rpc",n.ba),null===n.o&&(n.g.I=n.s),n.g.O=0;var t=Lp(n.wa);Jo(t,"RID","rpc"),Jo(t,"SID",n.K),Jo(t,"AID",n.V),Jo(t,"CI",n.G?"0":"1"),!n.G&&n.qa&&Jo(t,"TO",n.qa),Jo(t,"TYPE","xmlhttp"),Ew(n,t),n.o&&n.s&&xk(t,n.o,n.s),n.L&&n.g.setTimeout(n.L);var e=n.g;n=n.pa,e.L=1,e.A=YT(Lp(t)),e.u=null,e.S=!0,u8(e,n)}function nD(n){null!=n.v&&(er.clearTimeout(n.v),n.v=null)}function z8(n,t){var e=null;if(n.g==t){nD(n),Ek(n),n.g=null;var i=2}else{if(!_k(n.i,t))return;e=t.F,C8(n.i,t),i=1}if(0!=n.H)if(t.i)if(1==i){e=t.u?t.u.length:0,t=Date.now()-t.G;var r=n.C;ol(i=HT(),new r8(i,e)),tD(n)}else B8(n);else if(3==(r=t.s)||0==r&&0<t.ca||!(1==i&&function Zse(n,t){return!(E8(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.j=t.F.concat(n.j),0):1==n.H||2==n.H||n.C>=(n.cb?0:n.eb)||(n.m=dw(Il(n.Na,n,t),U8(n,n.C)),n.C++,0)))}(n,t)||2==i&&wk(n)))switch(e&&0<e.length&&(t=n.i,t.i=t.i.concat(e)),r){case 1:X_(n,5);break;case 4:X_(n,10);break;case 3:X_(n,6);break;default:X_(n,2)}}function U8(n,t){let e=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(e*=2),e*t}function X_(n,t){if(n.l.info("Error code "+t),2==t){var e=null;n.h&&(e=null);var i=Il(n.pb,n);e||(e=new Y_("//www.google.com/images/cleardot.gif"),er.location&&"http"==er.location.protocol||ZT(e,"https"),YT(e)),function jse(n,t){const e=new $T;if(er.Image){const i=new Image;i.onload=NT(XT,e,i,"TestLoadImage: loaded",!0,t),i.onerror=NT(XT,e,i,"TestLoadImage: error",!1,t),i.onabort=NT(XT,e,i,"TestLoadImage: abort",!1,t),i.ontimeout=NT(XT,e,i,"TestLoadImage: timeout",!1,t),er.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else t(!1)}(e.toString(),i)}else oc(2);n.H=0,n.h&&n.h.za(t),j8(n),F8(n)}function j8(n){if(n.H=0,n.ma=[],n.h){const t=I8(n.i);(0!=t.length||0!=n.j.length)&&(L6(n.ma,t),L6(n.ma,n.j),n.i.i.length=0,$P(n.j),n.j.length=0),n.h.ya()}}function $8(n,t,e){var i=e instanceof Y_?Lp(e):new Y_(e);if(""!=i.g)t&&(i.g=t+"."+i.g),KT(i,i.m);else{var r=er.location;i=r.protocol,t=t?t+"."+r.hostname:r.hostname,r=+r.port;var o=new Y_(null);i&&ZT(o,i),t&&(o.g=t),r&&KT(o,r),e&&(o.l=e),i=o}return t=n.Da,(e=n.F)&&t&&Jo(i,e,t),Jo(i,"VER",n.ra),Ew(n,i),i}function H8(n,t,e){if(t&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Ns(n.Ha&&!n.va?new vw({ob:e}):n.va)).Oa(n.J),t}function G8(){}function iD(){if(Dv&&!(10<=Number(ase)))throw Error("Environmental error: no available transport.")}function wu(n,t){za.call(this),this.g=new O8(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(n?n["X-WebChannel-Client-Profile"]=t.Ca:n={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=n,(n=t&&t.cc)&&!rw(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!rw(t)&&(this.g.F=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new Mv(this)}function W8(n){dk.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function q8(){hk.call(this),this.status=1}function Mv(n){this.g=n}function th(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Ck(n,t,e){e||(e=0);var i=Array(16);if("string"==typeof t)for(var r=0;16>r;++r)i[r]=t.charCodeAt(e++)|t.charCodeAt(e++)<<8|t.charCodeAt(e++)<<16|t.charCodeAt(e++)<<24;else for(r=0;16>r;++r)i[r]=t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24;var o=n.g[3],l=(t=n.g[0])+(o^(e=n.g[1])&((r=n.g[2])^o))+i[0]+3614090360&4294967295;l=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=(e=(r=(o=(t=e+(l<<7&4294967295|l>>>25))+((l=o+(r^t&(e^r))+i[1]+3905402710&4294967295)<<12&4294967295|l>>>20))+((l=r+(e^o&(t^e))+i[2]+606105819&4294967295)<<17&4294967295|l>>>15))+((l=e+(t^r&(o^t))+i[3]+3250441966&4294967295)<<22&4294967295|l>>>10))+((l=t+(o^e&(r^o))+i[4]+4118548399&4294967295)<<7&4294967295|l>>>25))+((l=o+(r^t&(e^r))+i[5]+1200080426&4294967295)<<12&4294967295|l>>>20))+((l=r+(e^o&(t^e))+i[6]+2821735955&4294967295)<<17&4294967295|l>>>15))+((l=e+(t^r&(o^t))+i[7]+4249261313&4294967295)<<22&4294967295|l>>>10))+((l=t+(o^e&(r^o))+i[8]+1770035416&4294967295)<<7&4294967295|l>>>25))+((l=o+(r^t&(e^r))+i[9]+2336552879&4294967295)<<12&4294967295|l>>>20))+((l=r+(e^o&(t^e))+i[10]+4294925233&4294967295)<<17&4294967295|l>>>15))+((l=e+(t^r&(o^t))+i[11]+2304563134&4294967295)<<22&4294967295|l>>>10))+((l=t+(o^e&(r^o))+i[12]+1804603682&4294967295)<<7&4294967295|l>>>25))+((l=o+(r^t&(e^r))+i[13]+4254626195&4294967295)<<12&4294967295|l>>>20))+((l=r+(e^o&(t^e))+i[14]+2792965006&4294967295)<<17&4294967295|l>>>15))+((l=e+(t^r&(o^t))+i[15]+1236535329&4294967295)<<22&4294967295|l>>>10))+((l=t+(r^o&(e^r))+i[1]+4129170786&4294967295)<<5&4294967295|l>>>27))+((l=o+(e^r&(t^e))+i[6]+3225465664&4294967295)<<9&4294967295|l>>>23))+((l=r+(t^e&(o^t))+i[11]+643717713&4294967295)<<14&4294967295|l>>>18))+((l=e+(o^t&(r^o))+i[0]+3921069994&4294967295)<<20&4294967295|l>>>12))+((l=t+(r^o&(e^r))+i[5]+3593408605&4294967295)<<5&4294967295|l>>>27))+((l=o+(e^r&(t^e))+i[10]+38016083&4294967295)<<9&4294967295|l>>>23))+((l=r+(t^e&(o^t))+i[15]+3634488961&4294967295)<<14&4294967295|l>>>18))+((l=e+(o^t&(r^o))+i[4]+3889429448&4294967295)<<20&4294967295|l>>>12))+((l=t+(r^o&(e^r))+i[9]+568446438&4294967295)<<5&4294967295|l>>>27))+((l=o+(e^r&(t^e))+i[14]+3275163606&4294967295)<<9&4294967295|l>>>23))+((l=r+(t^e&(o^t))+i[3]+4107603335&4294967295)<<14&4294967295|l>>>18))+((l=e+(o^t&(r^o))+i[8]+1163531501&4294967295)<<20&4294967295|l>>>12))+((l=t+(r^o&(e^r))+i[13]+2850285829&4294967295)<<5&4294967295|l>>>27))+((l=o+(e^r&(t^e))+i[2]+4243563512&4294967295)<<9&4294967295|l>>>23))+((l=r+(t^e&(o^t))+i[7]+1735328473&4294967295)<<14&4294967295|l>>>18))+((l=e+(o^t&(r^o))+i[12]+2368359562&4294967295)<<20&4294967295|l>>>12))+((l=t+(e^r^o)+i[5]+4294588738&4294967295)<<4&4294967295|l>>>28))+((l=o+(t^e^r)+i[8]+2272392833&4294967295)<<11&4294967295|l>>>21))+((l=r+(o^t^e)+i[11]+1839030562&4294967295)<<16&4294967295|l>>>16))+((l=e+(r^o^t)+i[14]+4259657740&4294967295)<<23&4294967295|l>>>9))+((l=t+(e^r^o)+i[1]+2763975236&4294967295)<<4&4294967295|l>>>28))+((l=o+(t^e^r)+i[4]+1272893353&4294967295)<<11&4294967295|l>>>21))+((l=r+(o^t^e)+i[7]+4139469664&4294967295)<<16&4294967295|l>>>16))+((l=e+(r^o^t)+i[10]+3200236656&4294967295)<<23&4294967295|l>>>9))+((l=t+(e^r^o)+i[13]+681279174&4294967295)<<4&4294967295|l>>>28))+((l=o+(t^e^r)+i[0]+3936430074&4294967295)<<11&4294967295|l>>>21))+((l=r+(o^t^e)+i[3]+3572445317&4294967295)<<16&4294967295|l>>>16))+((l=e+(r^o^t)+i[6]+76029189&4294967295)<<23&4294967295|l>>>9))+((l=t+(e^r^o)+i[9]+3654602809&4294967295)<<4&4294967295|l>>>28))+((l=o+(t^e^r)+i[12]+3873151461&4294967295)<<11&4294967295|l>>>21))+((l=r+(o^t^e)+i[15]+530742520&4294967295)<<16&4294967295|l>>>16))+((l=e+(r^o^t)+i[2]+3299628645&4294967295)<<23&4294967295|l>>>9))+((l=t+(r^(e|~o))+i[0]+4096336452&4294967295)<<6&4294967295|l>>>26))+((l=o+(e^(t|~r))+i[7]+1126891415&4294967295)<<10&4294967295|l>>>22))+((l=r+(t^(o|~e))+i[14]+2878612391&4294967295)<<15&4294967295|l>>>17))+((l=e+(o^(r|~t))+i[5]+4237533241&4294967295)<<21&4294967295|l>>>11))+((l=t+(r^(e|~o))+i[12]+1700485571&4294967295)<<6&4294967295|l>>>26))+((l=o+(e^(t|~r))+i[3]+2399980690&4294967295)<<10&4294967295|l>>>22))+((l=r+(t^(o|~e))+i[10]+4293915773&4294967295)<<15&4294967295|l>>>17))+((l=e+(o^(r|~t))+i[1]+2240044497&4294967295)<<21&4294967295|l>>>11))+((l=t+(r^(e|~o))+i[8]+1873313359&4294967295)<<6&4294967295|l>>>26))+((l=o+(e^(t|~r))+i[15]+4264355552&4294967295)<<10&4294967295|l>>>22))+((l=r+(t^(o|~e))+i[6]+2734768916&4294967295)<<15&4294967295|l>>>17))+((l=e+(o^(r|~t))+i[13]+1309151649&4294967295)<<21&4294967295|l>>>11))+((o=(t=e+((l=t+(r^(e|~o))+i[4]+4149444226&4294967295)<<6&4294967295|l>>>26))+((l=o+(e^(t|~r))+i[11]+3174756917&4294967295)<<10&4294967295|l>>>22))^((r=o+((l=r+(t^(o|~e))+i[2]+718787259&4294967295)<<15&4294967295|l>>>17))|~t))+i[9]+3951481745&4294967295,n.g[0]=n.g[0]+t&4294967295,n.g[1]=n.g[1]+(r+(l<<21&4294967295|l>>>11))&4294967295,n.g[2]=n.g[2]+r&4294967295,n.g[3]=n.g[3]+o&4294967295}function vo(n,t){this.h=t;for(var e=[],i=!0,r=n.length-1;0<=r;r--){var o=0|n[r];i&&o==t||(e[r]=o,i=!1)}this.g=e}(Wn=Ns.prototype).Oa=function(n){this.M=n},Wn.ha=function(n,t,e,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);t=t?t.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():fk.g(),this.C=function s8(n){return n.h||(n.h=n.i())}(this.u?this.u:fk),this.g.onreadystatechange=Il(this.La,this);try{this.G=!0,this.g.open(t,String(n),!0),this.G=!1}catch(o){return void A8(this,o)}if(n=e||"",e=new Map(this.headers),i)if(Object.getPrototypeOf(i)===Object.prototype)for(var r in i)e.set(r,i[r]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));for(const o of i.keys())e.set(o,i.get(o))}i=Array.from(e.keys()).find(o=>"content-type"==o.toLowerCase()),r=er.FormData&&n instanceof er.FormData,!(0<=F6(Gse,t))||i||r||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,l]of e)this.g.setRequestHeader(o,l);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{P8(this),0<this.B&&((this.L=function Wse(n){return Dv&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Il(this.ua,this)):this.A=ck(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(o){A8(this,o)}},Wn.ua=function(){typeof UP<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ol(this,"timeout"),this.abort(8))},Wn.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,ol(this,"complete"),ol(this,"abort"),JT(this))},Wn.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),JT(this,!0)),Ns.$.N.call(this)},Wn.La=function(){this.s||(this.G||this.v||this.l?M8(this):this.kb())},Wn.kb=function(){M8(this)},Wn.isActive=function(){return!!this.g},Wn.da=function(){try{return 2<Ef(this)?this.g.status:-1}catch{return-1}},Wn.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},Wn.Wa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),$se(t)}},Wn.Ia=function(){return this.m},Wn.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Wn=O8.prototype).ra=8,Wn.H=1,Wn.Na=function(n){if(this.m)if(this.m=null,1==this.H){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;const r=new fw(this,this.l,n);let o=this.s;if(this.U&&(o?(o=U6(o),$6(o,this.U)):o=this.U),null!==this.o||this.O||(r.I=o,o=null),this.P)e:{for(var t=0,e=0;e<this.j.length;e++){var i=this.j[e];if(void 0===(i="__data__"in i.map&&"string"==typeof(i=i.map.__data__)?i.length:void 0))break;if(4096<(t+=i)){t=e;break e}if(4096===t||e===this.j.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=N8(this,r,t),Jo(e=Lp(this.I),"RID",n),Jo(e,"CVER",22),this.F&&Jo(e,"X-HTTP-Session-Id",this.F),Ew(this,e),o&&(this.O?t="headers="+encodeURIComponent(String(R8(o)))+"&"+t:this.o&&xk(e,this.o,o)),yk(this.i,r),this.bb&&Jo(e,"TYPE","init"),this.P?(Jo(e,"$req",t),Jo(e,"SID","null"),r.aa=!0,mk(r,e,null)):mk(r,e,t),this.H=2}}else 3==this.H&&(n?L8(this,n):0==this.j.length||w8(this.i)||L8(this))},Wn.Ma=function(){if(this.u=null,V8(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=dw(Il(this.jb,this),n)}},Wn.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,oc(10),eD(this),V8(this))},Wn.ib=function(){null!=this.v&&(this.v=null,eD(this),wk(this),oc(19))},Wn.pb=function(n){n?(this.l.info("Successfully pinged google.com"),oc(2)):(this.l.info("Failed to ping google.com"),oc(1))},Wn.isActive=function(){return!!this.h&&this.h.isActive(this)},(Wn=G8.prototype).Ba=function(){},Wn.Aa=function(){},Wn.za=function(){},Wn.ya=function(){},Wn.isActive=function(){return!0},Wn.Va=function(){},iD.prototype.g=function(n,t){return new wu(n,t)},Va(wu,za),wu.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,t=this.l,e=this.h||void 0;oc(0),n.Y=t,n.na=e||{},n.G=n.aa,n.I=$8(n,null,n.Y),tD(n)},wu.prototype.close=function(){bk(this.g)},wu.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=sk(n),n=e);t.j.push(new class{constructor(n,t){this.g=n,this.map=t}}(t.fb++,n)),3==t.H&&tD(t)},wu.prototype.N=function(){this.g.h=null,delete this.j,bk(this.g),delete this.g,wu.$.N.call(this)},Va(W8,dk),Va(q8,hk),Va(Mv,G8),Mv.prototype.Ba=function(){ol(this.g,"a")},Mv.prototype.Aa=function(n){ol(this.g,new W8(n))},Mv.prototype.za=function(n){ol(this.g,new q8)},Mv.prototype.ya=function(){ol(this.g,"b")},Va(th,function Kse(){this.blockSize=-1}),th.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},th.prototype.j=function(n,t){void 0===t&&(t=n.length);for(var e=t-this.blockSize,i=this.m,r=this.h,o=0;o<t;){if(0==r)for(;o<=e;)Ck(this,n,o),o+=this.blockSize;if("string"==typeof n){for(;o<t;)if(i[r++]=n.charCodeAt(o++),r==this.blockSize){Ck(this,i),r=0;break}}else for(;o<t;)if(i[r++]=n[o++],r==this.blockSize){Ck(this,i),r=0;break}}this.h=r,this.i+=t},th.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var t=1;t<n.length-8;++t)n[t]=0;var e=8*this.i;for(t=n.length-8;t<n.length;++t)n[t]=255&e,e/=256;for(this.j(n),n=Array(16),t=e=0;4>t;++t)for(var i=0;32>i;i+=8)n[e++]=this.g[t]>>>i&255;return n};var Yse={};function Ik(n){return-128<=n&&128>n?function rse(n,t){var e=Yse;return Object.prototype.hasOwnProperty.call(e,n)?e[n]:e[n]=t(n)}(n,function(t){return new vo([0|t],0>t?-1:0)}):new vo([0|n],0>n?-1:0)}function Cf(n){if(isNaN(n)||!isFinite(n))return Pv;if(0>n)return sl(Cf(-n));for(var t=[],e=1,i=0;n>=e;i++)t[i]=n/e|0,e*=Tk;return new vo(t,0)}var Tk=4294967296,Pv=Ik(0),Dk=Ik(1),K8=Ik(16777216);function Np(n){if(0!=n.h)return!1;for(var t=0;t<n.g.length;t++)if(0!=n.g[t])return!1;return!0}function cd(n){return-1==n.h}function sl(n){for(var t=n.g.length,e=[],i=0;i<t;i++)e[i]=~n.g[i];return new vo(e,~n.h).add(Dk)}function rD(n,t){return n.add(sl(t))}function oD(n,t){for(;(65535&n[t])!=n[t];)n[t+1]+=n[t]>>>16,n[t]&=65535,t++}function Cw(n,t){this.g=n,this.h=t}function sD(n,t){if(Np(t))throw Error("division by zero");if(Np(n))return new Cw(Pv,Pv);if(cd(n))return t=sD(sl(n),t),new Cw(sl(t.g),sl(t.h));if(cd(t))return t=sD(n,sl(t)),new Cw(sl(t.g),t.h);if(30<n.g.length){if(cd(n)||cd(t))throw Error("slowDivide_ only works with positive integers.");for(var e=Dk,i=t;0>=i.X(n);)e=Y8(e),i=Y8(i);var r=kv(e,1),o=kv(i,1);for(i=kv(i,2),e=kv(e,2);!Np(i);){var l=o.add(i);0>=l.X(n)&&(r=r.add(e),o=l),i=kv(i,1),e=kv(e,1)}return t=rD(n,r.R(t)),new Cw(r,t)}for(r=Pv;0<=n.X(t);){for(e=Math.max(1,Math.floor(n.ea()/t.ea())),i=48>=(i=Math.ceil(Math.log(e)/Math.LN2))?1:Math.pow(2,i-48),l=(o=Cf(e)).R(t);cd(l)||0<l.X(n);)l=(o=Cf(e-=i)).R(t);Np(o)&&(o=Dk),r=r.add(o),n=rD(n,l)}return new Cw(r,n)}function Y8(n){for(var t=n.g.length+1,e=[],i=0;i<t;i++)e[i]=n.D(i)<<1|n.D(i-1)>>>31;return new vo(e,n.h)}function kv(n,t){var e=t>>5;t%=32;for(var i=n.g.length-e,r=[],o=0;o<i;o++)r[o]=0<t?n.D(o+e)>>>t|n.D(o+e+1)<<32-t:n.D(o+e);return new vo(r,n.h)}(Wn=vo.prototype).ea=function(){if(cd(this))return-sl(this).ea();for(var n=0,t=1,e=0;e<this.g.length;e++){var i=this.D(e);n+=(0<=i?i:Tk+i)*t,t*=Tk}return n},Wn.toString=function(n){if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if(Np(this))return"0";if(cd(this))return"-"+sl(this).toString(n);for(var t=Cf(Math.pow(n,6)),e=this,i="";;){var r=sD(e,t).g,o=((0<(e=rD(e,r.R(t))).g.length?e.g[0]:e.h)>>>0).toString(n);if(Np(e=r))return o+i;for(;6>o.length;)o="0"+o;i=o+i}},Wn.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h},Wn.X=function(n){return cd(n=rD(this,n))?-1:Np(n)?0:1},Wn.abs=function(){return cd(this)?sl(this):this},Wn.add=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0,r=0;r<=t;r++){var o=i+(65535&this.D(r))+(65535&n.D(r)),l=(o>>>16)+(this.D(r)>>>16)+(n.D(r)>>>16);i=l>>>16,e[r]=(l&=65535)<<16|(o&=65535)}return new vo(e,-2147483648&e[e.length-1]?-1:0)},Wn.R=function(n){if(Np(this)||Np(n))return Pv;if(cd(this))return cd(n)?sl(this).R(sl(n)):sl(sl(this).R(n));if(cd(n))return sl(this.R(sl(n)));if(0>this.X(K8)&&0>n.X(K8))return Cf(this.ea()*n.ea());for(var t=this.g.length+n.g.length,e=[],i=0;i<2*t;i++)e[i]=0;for(i=0;i<this.g.length;i++)for(var r=0;r<n.g.length;r++){var o=this.D(i)>>>16,l=65535&this.D(i),f=n.D(r)>>>16,g=65535&n.D(r);e[2*i+2*r]+=l*g,oD(e,2*i+2*r),e[2*i+2*r+1]+=o*g,oD(e,2*i+2*r+1),e[2*i+2*r+1]+=l*f,oD(e,2*i+2*r+1),e[2*i+2*r+2]+=o*f,oD(e,2*i+2*r+2)}for(i=0;i<t;i++)e[i]=e[2*i+1]<<16|e[2*i];for(i=t;i<2*t;i++)e[i]=0;return new vo(e,0)},Wn.gb=function(n){return sD(this,n).h},Wn.and=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0;i<t;i++)e[i]=this.D(i)&n.D(i);return new vo(e,this.h&n.h)},Wn.or=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0;i<t;i++)e[i]=this.D(i)|n.D(i);return new vo(e,this.h|n.h)},Wn.xor=function(n){for(var t=Math.max(this.g.length,n.g.length),e=[],i=0;i<t;i++)e[i]=this.D(i)^n.D(i);return new vo(e,this.h^n.h)},iD.prototype.createWebChannel=iD.prototype.g,wu.prototype.send=wu.prototype.u,wu.prototype.open=wu.prototype.m,wu.prototype.close=wu.prototype.close,GT.NO_ERROR=0,GT.TIMEOUT=8,GT.HTTP_ERROR=6,o8.COMPLETE="complete",a8.EventType=hw,hw.OPEN="a",hw.CLOSE="b",hw.ERROR="c",hw.MESSAGE="d",za.prototype.listen=za.prototype.O,Ns.prototype.listenOnce=Ns.prototype.P,Ns.prototype.getLastError=Ns.prototype.Sa,Ns.prototype.getLastErrorCode=Ns.prototype.Ia,Ns.prototype.getStatus=Ns.prototype.da,Ns.prototype.getResponseJson=Ns.prototype.Wa,Ns.prototype.getResponseText=Ns.prototype.ja,Ns.prototype.send=Ns.prototype.ha,Ns.prototype.setWithCredentials=Ns.prototype.Oa,th.prototype.digest=th.prototype.l,th.prototype.reset=th.prototype.reset,th.prototype.update=th.prototype.j,vo.prototype.add=vo.prototype.add,vo.prototype.multiply=vo.prototype.R,vo.prototype.modulo=vo.prototype.gb,vo.prototype.compare=vo.prototype.X,vo.prototype.toNumber=vo.prototype.ea,vo.prototype.toString=vo.prototype.toString,vo.prototype.getBits=vo.prototype.D,vo.fromNumber=Cf,vo.fromString=function Z8(n,t){if(0==n.length)throw Error("number format error: empty string");if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if("-"==n.charAt(0))return sl(Z8(n.substring(1),t));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var e=Cf(Math.pow(t,8)),i=Pv,r=0;r<n.length;r+=8){var o=Math.min(8,n.length-r),l=parseInt(n.substring(r,r+o),t);8>o?(o=Cf(Math.pow(t,o)),i=i.R(o).add(Cf(l))):i=(i=i.R(e)).add(Cf(l))}return i};var Xse=eh.createWebChannelTransport=function(){return new iD},Qse=eh.getStatEventTarget=function(){return HT()},Ak=eh.ErrorCode=GT,Jse=eh.EventType=o8,eae=eh.Event=Z_,X8=eh.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},aD=(eh.FetchXmlHttpFactory=vw,eh.WebChannel=a8),tae=eh.XhrIo=Ns,nae=eh.Md5=th,Rv=eh.Integer=vo;const Q8="@firebase/firestore";class Ua{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Ua.UNAUTHENTICATED=new Ua(null),Ua.GOOGLE_CREDENTIALS=new Ua("google-credentials-uid"),Ua.FIRST_PARTY=new Ua("first-party-uid"),Ua.MOCK_USER=new Ua("mock-user");let Ov="10.7.0";const lg=new xf.Yd("@firebase/firestore");function Fv(){return lg.logLevel}function vn(n,...t){if(lg.logLevel<=xf.in.DEBUG){const e=t.map(Sk);lg.debug(`Firestore (${Ov}): ${n}`,...e)}}function qs(n,...t){if(lg.logLevel<=xf.in.ERROR){const e=t.map(Sk);lg.error(`Firestore (${Ov}): ${n}`,...e)}}function Fc(n,...t){if(lg.logLevel<=xf.in.WARN){const e=t.map(Sk);lg.warn(`Firestore (${Ov}): ${n}`,...e)}}function Sk(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function ii(n="Unexpected state"){const t=`FIRESTORE (${Ov}) INTERNAL ASSERTION FAILED: `+n;throw qs(t),new Error(t)}function gi(n,t){n||ii()}function zn(n,t){return n}const jt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class gn extends Do.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ia{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class J8{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class oae{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Ua.UNAUTHENTICATED))}shutdown(){}}class sae{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class aae{constructor(t){this.t=t,this.currentUser=Ua.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var i=this;let r=this.i;const o=b=>this.i!==r?(r=this.i,e(b)):Promise.resolve();let l=new Ia;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ia,t.enqueueRetryable(()=>o(this.currentUser))};const f=()=>{const b=l;t.enqueueRetryable((0,Jt.Z)(function*(){yield b.promise,yield o(i.currentUser)}))},g=b=>{vn("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=b,this.auth.addAuthTokenListener(this.o),f()};this.t.onInit(b=>g(b)),setTimeout(()=>{if(!this.auth){const b=this.t.getImmediate({optional:!0});b?g(b):(vn("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ia)}},0),f()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(i=>this.i!==t?(vn("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(gi("string"==typeof i.accessToken),new J8(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return gi(null===t||"string"==typeof t),new Ua(t)}}class lae{constructor(t,e,i){this.l=t,this.h=e,this.P=i,this.type="FirstParty",this.user=Ua.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class cae{constructor(t,e,i){this.l=t,this.h=e,this.P=i}getToken(){return Promise.resolve(new lae(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(Ua.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class eU{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uae{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const i=o=>{null!=o.error&&vn("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.R;return this.R=o.token,vn("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable(()=>i(o))};const r=o=>{vn("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>r(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?r(o):vn("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(gi("string"==typeof e.token),this.R=e.token,new eU(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function dae(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}class tU{static newId(){const e=62*Math.floor(256/62);let i="";for(;i.length<20;){const r=dae(40);for(let o=0;o<r.length;++o)i.length<20&&r[o]<e&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[o]%62))}return i}}function Xi(n,t){return n<t?-1:n>t?1:0}function Lv(n,t,e){return n.length===t.length&&n.every((i,r)=>e(i,t[r]))}function nU(n){return n+"\0"}class es{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new gn(jt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new gn(jt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new gn(jt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new gn(jt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return es.fromMillis(Date.now())}static fromDate(t){return es.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*e));return new es(e,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?Xi(this.nanoseconds,t.nanoseconds):Xi(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class xi{constructor(t){this.timestamp=t}static fromTimestamp(t){return new xi(t)}static min(){return new xi(new es(0,0))}static max(){return new xi(new es(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Iw{constructor(t,e,i){void 0===e?e=0:e>t.length&&ii(),void 0===i?i=t.length-e:i>t.length-e&&ii(),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return 0===Iw.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Iw?t.forEach(i=>{e.push(i)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let r=0;r<i;r++){const o=t.get(r),l=e.get(r);if(o<l)return-1;if(o>l)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Nr extends Iw{construct(t,e,i){return new Nr(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new gn(jt.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(r=>r.length>0))}return new Nr(e)}static emptyPath(){return new Nr([])}}const hae=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ts extends Iw{construct(t,e,i){return new ts(t,e,i)}static isValidIdentifier(t){return hae.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ts.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ts(["__name__"])}static fromServerFormat(t){const e=[];let i="",r=0;const o=()=>{if(0===i.length)throw new gn(jt.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let l=!1;for(;r<t.length;){const f=t[r];if("\\"===f){if(r+1===t.length)throw new gn(jt.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const g=t[r+1];if("\\"!==g&&"."!==g&&"`"!==g)throw new gn(jt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=g,r+=2}else"`"===f?(l=!l,r++):"."!==f||l?(i+=f,r++):(o(),r++)}if(o(),l)throw new gn(jt.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ts(e)}static emptyPath(){return new ts([])}}class $n{constructor(t){this.path=t}static fromPath(t){return new $n(Nr.fromString(t))}static fromName(t){return new $n(Nr.fromString(t).popFirst(5))}static empty(){return new $n(Nr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Nr.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Nr.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new $n(new Nr(t.slice()))}}class Nv{constructor(t,e,i,r){this.indexId=t,this.collectionGroup=e,this.fields=i,this.indexState=r}}function Mk(n){return n.fields.find(t=>2===t.kind)}function Q_(n){return n.fields.filter(t=>2!==t.kind)}Nv.UNKNOWN_ID=-1;class J_{constructor(t,e){this.fieldPath=t,this.kind=e}}class Bv{constructor(t,e){this.sequenceNumber=t,this.offset=e}static empty(){return new Bv(0,Eu.min())}}function iU(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=xi.fromTimestamp(1e9===i?new es(e+1,0):new es(e,i));return new Eu(r,$n.empty(),t)}function rU(n){return new Eu(n.readTime,n.key,-1)}class Eu{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new Eu(xi.min(),$n.empty(),-1)}static max(){return new Eu(xi.max(),$n.empty(),-1)}}function Pk(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=$n.comparator(n.documentKey,t.documentKey),0!==e?e:Xi(n.largestBatchId,t.largestBatchId))}const oU="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class sU{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}function cg(n){return kk.apply(this,arguments)}function kk(){return kk=(0,Jt.Z)(function*(n){if(n.code!==jt.FAILED_PRECONDITION||n.message!==oU)throw n;vn("LocalStore","Unexpectedly lost primary lease")}),kk.apply(this,arguments)}class St{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&ii(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new St((i,r)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(i,r)},this.catchCallback=o=>{this.wrapFailure(e,o).next(i,r)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof St?e:St.resolve(e)}catch(e){return St.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):St.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):St.reject(e)}static resolve(t){return new St((e,i)=>{e(t)})}static reject(t){return new St((e,i)=>{i(t)})}static waitFor(t){return new St((e,i)=>{let r=0,o=0,l=!1;t.forEach(f=>{++r,f.next(()=>{++o,l&&o===r&&e()},g=>i(g))}),l=!0,o===r&&e()})}static or(t){let e=St.resolve(!1);for(const i of t)e=e.next(r=>r?St.resolve(r):i());return e}static forEach(t,e){const i=[];return t.forEach((r,o)=>{i.push(e.call(this,r,o))}),this.waitFor(i)}static mapArray(t,e){return new St((i,r)=>{const o=t.length,l=new Array(o);let f=0;for(let g=0;g<o;g++){const b=g;e(t[b]).next(S=>{l[b]=S,++f,f===o&&i(l)},S=>r(S))}})}static doWhile(t,e){return new St((i,r)=>{const o=()=>{!0===t()?e().next(()=>{o()},r):i()};o()})}}class lD{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new Ia,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Tw(t,e.error)):this.V.resolve()},this.transaction.onerror=i=>{const r=Rk(i.target.error);this.V.reject(new Tw(t,r))}}static open(t,e,i,r){try{return new lD(e,t.transaction(r,i))}catch(o){throw new Tw(e,o)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(vn("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new gae(e)}}class nh{constructor(t,e,i){this.name=t,this.version=e,this.p=i,12.2===nh.S((0,Do.z$)())&&qs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return vn("SimpleDb","Removing database:",t),e0(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!(0,Do.hl)())return!1;if(nh.C())return!0;const t=(0,Do.z$)(),e=nh.S(t),i=0<e&&e<10,r=nh.v(t),o=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||i||o)}static C(){var t;return typeof process<"u"&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static v(t){const e=t.match(/Android ([\d.]+)/i),i=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(i)}O(t){var e=this;return(0,Jt.Z)(function*(){return e.db||(vn("SimpleDb","Opening database:",e.name),e.db=yield new Promise((i,r)=>{const o=indexedDB.open(e.name,e.version);o.onsuccess=l=>{i(l.target.result)},o.onblocked=()=>{r(new Tw(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=l=>{const f=l.target.error;r("VersionError"===f.name?new gn(jt.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===f.name?new gn(jt.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+f):new Tw(t,f))},o.onupgradeneeded=l=>{vn("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',l.oldVersion),e.p.N(l.target.result,o.transaction,l.oldVersion,e.version).next(()=>{vn("SimpleDb","Database upgrade to version "+e.version+" complete")})}})),e.B&&(e.db.onversionchange=i=>e.B(i)),e.db})()}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}runTransaction(t,e,i,r){var o=this;return(0,Jt.Z)(function*(){const l="readonly"===e;let f=0;for(;;){++f;try{o.db=yield o.O(t);const g=lD.open(o.db,t,l?"readonly":"readwrite",i),b=r(g).next(S=>(g.g(),S)).catch(S=>(g.abort(S),St.reject(S))).toPromise();return b.catch(()=>{}),yield g.m,b}catch(g){const b=g,S="FirebaseError"!==b.name&&f<3;if(vn("SimpleDb","Transaction failed with error:",b.message,"Retrying:",S),o.close(),!S)return Promise.reject(b)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class mae{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return e0(this.k.delete())}}class Tw extends gn{constructor(t,e){super(jt.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function ug(n){return"IndexedDbTransactionError"===n.name}class gae{constructor(t){this.store=t}put(t,e){let i;return void 0!==e?(vn("SimpleDb","PUT",this.store.name,t,e),i=this.store.put(e,t)):(vn("SimpleDb","PUT",this.store.name,"<auto-key>",t),i=this.store.put(t)),e0(i)}add(t){return vn("SimpleDb","ADD",this.store.name,t,t),e0(this.store.add(t))}get(t){return e0(this.store.get(t)).next(e=>(void 0===e&&(e=null),vn("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return vn("SimpleDb","DELETE",this.store.name,t),e0(this.store.delete(t))}count(){return vn("SimpleDb","COUNT",this.store.name),e0(this.store.count())}W(t,e){const i=this.options(t,e);if(i.index||"function"!=typeof this.store.getAll){const r=this.cursor(i),o=[];return this.G(r,(l,f)=>{o.push(f)}).next(()=>o)}{const r=this.store.getAll(i.range);return new St((o,l)=>{r.onerror=f=>{l(f.target.error)},r.onsuccess=f=>{o(f.target.result)}})}}j(t,e){const i=this.store.getAll(t,null===e?void 0:e);return new St((r,o)=>{i.onerror=l=>{o(l.target.error)},i.onsuccess=l=>{r(l.target.result)}})}H(t,e){vn("SimpleDb","DELETE ALL",this.store.name);const i=this.options(t,e);i.J=!1;const r=this.cursor(i);return this.G(r,(o,l,f)=>f.delete())}Y(t,e){let i;e?i=t:(i={},e=t);const r=this.cursor(i);return this.G(r,e)}Z(t){const e=this.cursor({});return new St((i,r)=>{e.onerror=o=>{const l=Rk(o.target.error);r(l)},e.onsuccess=o=>{const l=o.target.result;l?t(l.primaryKey,l.value).next(f=>{f?l.continue():i()}):i()}})}G(t,e){const i=[];return new St((r,o)=>{t.onerror=l=>{o(l.target.error)},t.onsuccess=l=>{const f=l.target.result;if(!f)return void r();const g=new mae(f),b=e(f.primaryKey,f.value,g);if(b instanceof St){const S=b.catch(O=>(g.done(),St.reject(O)));i.push(S)}g.isDone?r():null===g.$?f.continue():f.continue(g.$)}}).next(()=>St.waitFor(i))}options(t,e){let i;return void 0!==t&&("string"==typeof t?i=t:e=t),{index:i,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const i=this.store.index(t.index);return t.J?i.openKeyCursor(t.range,e):i.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function e0(n){return new St((t,e)=>{n.onsuccess=i=>{t(i.target.result)},n.onerror=i=>{const r=Rk(i.target.error);e(r)}})}let aU=!1;function Rk(n){const t=nh.S((0,Do.z$)());if(t>=12.2&&t<13){const e="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(e)>=0){const i=new gn("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return aU||(aU=!0,setTimeout(()=>{throw i},0)),i}}return n}class _ae{constructor(t,e){this.asyncQueue=t,this.X=e,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(t){var e=this;vn("IndexBackiller",`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,(0,Jt.Z)(function*(){e.task=null;try{vn("IndexBackiller",`Documents written: ${yield e.X.te()}`)}catch(i){ug(i)?vn("IndexBackiller","Ignoring IndexedDB error during index backfill: ",i):yield cg(i)}yield e.ee(6e4)}))}}class yae{constructor(t,e){this.localStore=t,this.persistence=e}te(t=50){var e=this;return(0,Jt.Z)(function*(){return e.persistence.runTransaction("Backfill Indexes","readwrite-primary",i=>e.ne(i,t))})()}ne(t,e){const i=new Set;let r=e,o=!0;return St.doWhile(()=>!0===o&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next(l=>{if(null!==l&&!i.has(l))return vn("IndexBackiller",`Processing collection: ${l}`),this.re(t,l,r).next(f=>{r-=f,i.add(l)});o=!1})).next(()=>e-r)}re(t,e,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,e).next(r=>this.localStore.localDocuments.getNextDocuments(t,e,r,i).next(o=>{const l=o.changes;return this.localStore.indexManager.updateIndexEntries(t,l).next(()=>this.ie(r,o)).next(f=>(vn("IndexBackiller",`Updating offset: ${f}`),this.localStore.indexManager.updateCollectionGroup(t,e,f))).next(()=>l.size)}))}ie(t,e){let i=t;return e.changes.forEach((r,o)=>{const l=rU(o);Pk(l,i)>0&&(i=l)}),new Eu(i.readTime,i.documentKey,Math.max(e.batchId,t.largestBatchId))}}let Cu=(()=>{class n{constructor(e,i){this.previousValue=e,i&&(i.sequenceNumberHandler=r=>this.se(r),this.oe=r=>i.writeSequenceNumber(r))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}return n._e=-1,n})();function Dw(n){return null==n}function Aw(n){return 0===n&&1/n==-1/0}function lU(n){return"number"==typeof n&&Number.isInteger(n)&&!Aw(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Dl(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=cU(t)),t=vae(n.get(e),t);return cU(t)}function vae(n,t){let e=t;const i=n.length;for(let r=0;r<i;r++){const o=n.charAt(r);switch(o){case"\0":e+="\x01\x10";break;case"\x01":e+="\x01\x11";break;default:e+=o}}return e}function cU(n){return n+"\x01\x01"}function If(n){const t=n.length;if(gi(t>=2),2===t)return gi("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Nr.emptyPath();const e=t-2,i=[];let r="";for(let o=0;o<t;){const l=n.indexOf("\x01",o);switch((l<0||l>e)&&ii(),n.charAt(l+1)){case"\x01":const f=n.substring(o,l);let g;0===r.length?g=f:(r+=f,g=r,r=""),i.push(g);break;case"\x10":r+=n.substring(o,l),r+="\0";break;case"\x11":r+=n.substring(o,l+1);break;default:ii()}o=l+2}return new Nr(i)}const uU=["userId","batchId"];function cD(n,t){return[n,Dl(t)]}function dU(n,t,e){return[n,Dl(t),e]}const xae={},bae=["prefixPath","collectionGroup","readTime","documentId"],wae=["prefixPath","collectionGroup","documentId"],Eae=["collectionGroup","readTime","prefixPath","documentId"],Cae=["canonicalId","targetId"],Iae=["targetId","path"],Tae=["path","targetId"],Dae=["collectionId","parent"],Aae=["indexId","uid"],Sae=["uid","sequenceNumber"],Mae=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Pae=["indexId","uid","orderedDocumentKey"],kae=["userId","collectionPath","documentId"],Rae=["userId","collectionPath","largestBatchId"],Oae=["userId","collectionGroup","largestBatchId"],hU=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Fae=[...hU,"documentOverlays"],fU=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],pU=fU,Lae=[...pU,"indexConfiguration","indexState","indexEntries"];class Ok extends sU{constructor(t,e){super(),this.ae=t,this.currentSequenceNumber=e}}function ja(n,t){const e=zn(n);return nh.M(e.ae,t)}function mU(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function dg(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function gU(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class $o{constructor(t,e){this.comparator=t,this.root=e||al.EMPTY}insert(t,e){return new $o(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,al.BLACK,null,null))}remove(t){return new $o(this.comparator,this.root.remove(t,this.comparator).copy(null,null,al.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(0===i)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(t,i.key);if(0===r)return e+i.left.size;r<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,i)=>(t(e,i),!1))}toString(){const t=[];return this.inorderTraversal((e,i)=>(t.push(`${e}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new uD(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new uD(this.root,t,this.comparator,!1)}getReverseIterator(){return new uD(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new uD(this.root,t,this.comparator,!0)}}class uD{constructor(t,e,i,r){this.isReverse=r,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=e?i(t.key,e):1,e&&r&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(0===o){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class al{constructor(t,e,i,r,o){this.key=t,this.value=e,this.color=i??al.RED,this.left=r??al.EMPTY,this.right=o??al.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,r,o){return new al(t??this.key,e??this.value,i??this.color,r??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let r=this;const o=i(t,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(t,e,i),null):0===o?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return al.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return al.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,al.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,al.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ii();const t=this.left.check();if(t!==this.right.check())throw ii();return t+(this.isRed()?0:1)}}al.EMPTY=null,al.RED=!0,al.BLACK=!1,al.EMPTY=new class{constructor(){this.size=0}get key(){throw ii()}get value(){throw ii()}get color(){throw ii()}get left(){throw ii()}get right(){throw ii()}copy(t,e,i,r,o){return this}insert(t,e,i){return new al(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ao{constructor(t){this.comparator=t,this.data=new $o(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,i)=>(t(e),!1))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let i;for(i=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new _U(this.data.getIterator())}getIteratorFrom(t){return new _U(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(i=>{e=e.add(i)}),e}isEqual(t){if(!(t instanceof Ao)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const r=e.getNext().key,o=i.getNext().key;if(0!==this.comparator(r,o))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new Ao(this.comparator);return e.data=t,e}}class _U{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Vv(n){return n.hasNext()?n.getNext():void 0}class Lc{constructor(t){this.fields=t,t.sort(ts.comparator)}static empty(){return new Lc([])}unionWith(t){let e=new Ao(ts.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new Lc(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Lv(this.fields,t.fields,(e,i)=>e.isEqual(i))}}class yU extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ta{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(r){try{return atob(r)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new yU("Invalid base64 string: "+o):o}}(t);return new Ta(e)}static fromUint8Array(t){const e=function(r){let o="";for(let l=0;l<r.length;++l)o+=String.fromCharCode(r[l]);return o}(t);return new Ta(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Xi(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ta.EMPTY_BYTE_STRING=new Ta("");const Bae=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hg(n){if(gi(!!n),"string"==typeof n){let t=0;const e=Bae.exec(n);if(gi(!!e),e[1]){let r=e[1];r=(r+"000000000").substr(0,9),t=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Bs(n.seconds),nanos:Bs(n.nanos)}}function Bs(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Bp(n){return"string"==typeof n?Ta.fromBase64String(n):Ta.fromUint8Array(n)}function dD(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function hD(n){const t=n.mapValue.fields.__previous_value__;return dD(t)?hD(t):t}function Sw(n){const t=hg(n.mapValue.fields.__local_write_time__.timestampValue);return new es(t.seconds,t.nanos)}class Vae{constructor(t,e,i,r,o,l,f,g,b){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=r,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=f,this.longPollingOptions=g,this.useFetchStreams=b}}class fg{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new fg("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof fg&&t.projectId===this.projectId&&t.database===this.database}}const pg={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},fD={nullValue:"NULL_VALUE"};function mg(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?dD(n)?4:wU(n)?9007199254740991:10:ii()}function Tf(n,t){if(n===t)return!0;const e=mg(n);if(e!==mg(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Sw(n).isEqual(Sw(t));case 3:return function(r,o){if("string"==typeof r.timestampValue&&"string"==typeof o.timestampValue&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;const l=hg(r.timestampValue),f=hg(o.timestampValue);return l.seconds===f.seconds&&l.nanos===f.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return o=t,Bp(n.bytesValue).isEqual(Bp(o.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,o){return Bs(r.geoPointValue.latitude)===Bs(o.geoPointValue.latitude)&&Bs(r.geoPointValue.longitude)===Bs(o.geoPointValue.longitude)}(n,t);case 2:return function(r,o){if("integerValue"in r&&"integerValue"in o)return Bs(r.integerValue)===Bs(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){const l=Bs(r.doubleValue),f=Bs(o.doubleValue);return l===f?Aw(l)===Aw(f):isNaN(l)&&isNaN(f)}return!1}(n,t);case 9:return Lv(n.arrayValue.values||[],t.arrayValue.values||[],Tf);case 10:return function(r,o){const l=r.mapValue.fields||{},f=o.mapValue.fields||{};if(mU(l)!==mU(f))return!1;for(const g in l)if(l.hasOwnProperty(g)&&(void 0===f[g]||!Tf(l[g],f[g])))return!1;return!0}(n,t);default:return ii()}var o}function Mw(n,t){return void 0!==(n.values||[]).find(e=>Tf(e,t))}function gg(n,t){if(n===t)return 0;const e=mg(n),i=mg(t);if(e!==i)return Xi(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return Xi(n.booleanValue,t.booleanValue);case 2:return function(o,l){const f=Bs(o.integerValue||o.doubleValue),g=Bs(l.integerValue||l.doubleValue);return f<g?-1:f>g?1:f===g?0:isNaN(f)?isNaN(g)?0:-1:1}(n,t);case 3:return vU(n.timestampValue,t.timestampValue);case 4:return vU(Sw(n),Sw(t));case 5:return Xi(n.stringValue,t.stringValue);case 6:return function(o,l){const f=Bp(o),g=Bp(l);return f.compareTo(g)}(n.bytesValue,t.bytesValue);case 7:return function(o,l){const f=o.split("/"),g=l.split("/");for(let b=0;b<f.length&&b<g.length;b++){const S=Xi(f[b],g[b]);if(0!==S)return S}return Xi(f.length,g.length)}(n.referenceValue,t.referenceValue);case 8:return function(o,l){const f=Xi(Bs(o.latitude),Bs(l.latitude));return 0!==f?f:Xi(Bs(o.longitude),Bs(l.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(o,l){const f=o.values||[],g=l.values||[];for(let b=0;b<f.length&&b<g.length;++b){const S=gg(f[b],g[b]);if(S)return S}return Xi(f.length,g.length)}(n.arrayValue,t.arrayValue);case 10:return function(o,l){if(o===pg.mapValue&&l===pg.mapValue)return 0;if(o===pg.mapValue)return 1;if(l===pg.mapValue)return-1;const f=o.fields||{},g=Object.keys(f),b=l.fields||{},S=Object.keys(b);g.sort(),S.sort();for(let O=0;O<g.length&&O<S.length;++O){const $=Xi(g[O],S[O]);if(0!==$)return $;const J=gg(f[g[O]],b[S[O]]);if(0!==J)return J}return Xi(g.length,S.length)}(n.mapValue,t.mapValue);default:throw ii()}}function vU(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return Xi(n,t);const e=hg(n),i=hg(t),r=Xi(e.seconds,i.seconds);return 0!==r?r:Xi(e.nanos,i.nanos)}function zv(n){return Fk(n)}function Fk(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const i=hg(e);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Bp(n.bytesValue).toBase64():"referenceValue"in n?$n.fromName(n.referenceValue).toString():"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let i="[",r=!0;for(const o of e.values||[])r?r=!1:i+=",",i+=Fk(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(e){const i=Object.keys(e.fields||{}).sort();let r="{",o=!0;for(const l of i)o?o=!1:r+=",",r+=`${l}:${Fk(e.fields[l])}`;return r+"}"}(n.mapValue):ii()}function t0(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function Lk(n){return!!n&&"integerValue"in n}function Pw(n){return!!n&&"arrayValue"in n}function xU(n){return!!n&&"nullValue"in n}function bU(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function mD(n){return!!n&&"mapValue"in n}function kw(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return dg(n.mapValue.fields,(e,i)=>t.mapValue.fields[e]=kw(i)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=kw(n.arrayValue.values[e]);return t}return Object.assign({},n)}function wU(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function zae(n){return"nullValue"in n?fD:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?t0(fg.empty(),$n.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:ii()}function Uae(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?t0(fg.empty(),$n.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?pg:ii()}function EU(n,t){const e=gg(n.value,t.value);return 0!==e?e:n.inclusive&&!t.inclusive?-1:!n.inclusive&&t.inclusive?1:0}function CU(n,t){const e=gg(n.value,t.value);return 0!==e?e:n.inclusive&&!t.inclusive?1:!n.inclusive&&t.inclusive?-1:0}class ll{constructor(t){this.value=t}static empty(){return new ll({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!mD(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=kw(e)}setAll(t){let e=ts.emptyPath(),i={},r=[];t.forEach((l,f)=>{if(!e.isImmediateParentOf(f)){const g=this.getFieldsMap(e);this.applyChanges(g,i,r),i={},r=[],e=f.popLast()}l?i[f.lastSegment()]=kw(l):r.push(f.lastSegment())});const o=this.getFieldsMap(e);this.applyChanges(o,i,r)}delete(t){const e=this.field(t.popLast());mD(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Tf(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=e.mapValue.fields[t.get(i)];mD(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,i){dg(e,(r,o)=>t[r]=o);for(const r of i)delete t[r]}clone(){return new ll(kw(this.value))}}function IU(n){const t=[];return dg(n.fields,(e,i)=>{const r=new ts([e]);if(mD(i)){const o=IU(i.mapValue).fields;if(0===o.length)t.push(r);else for(const l of o)t.push(r.child(l))}else t.push(r)}),new Lc(t)}class ns{constructor(t,e,i,r,o,l,f){this.key=t,this.documentType=e,this.version=i,this.readTime=r,this.createTime=o,this.data=l,this.documentState=f}static newInvalidDocument(t){return new ns(t,0,xi.min(),xi.min(),xi.min(),ll.empty(),0)}static newFoundDocument(t,e,i,r){return new ns(t,1,e,xi.min(),i,r,0)}static newNoDocument(t,e){return new ns(t,2,e,xi.min(),xi.min(),ll.empty(),0)}static newUnknownDocument(t,e){return new ns(t,3,e,xi.min(),xi.min(),ll.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(xi.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=ll.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=ll.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xi.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof ns&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new ns(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class _g{constructor(t,e){this.position=t,this.inclusive=e}}function TU(n,t,e){let i=0;for(let r=0;r<n.position.length;r++){const o=t[r],l=n.position[r];if(i=o.field.isKeyField()?$n.comparator($n.fromName(l.referenceValue),e.key):gg(l,e.data.field(o.field)),"desc"===o.dir&&(i*=-1),0!==i)break}return i}function DU(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Tf(n.position[e],t.position[e]))return!1;return!0}class Rw{constructor(t,e="asc"){this.field=t,this.dir=e}}function jae(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class AU{}class Ar extends AU{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,i):new $ae(t,e,i):"array-contains"===e?new Wae(t,i):"in"===e?new OU(t,i):"not-in"===e?new qae(t,i):"array-contains-any"===e?new Zae(t,i):new Ar(t,e,i)}static createKeyFieldInFilter(t,e,i){return"in"===e?new Hae(t,i):new Gae(t,i)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(gg(e,this.value)):null!==e&&mg(this.value)===mg(e)&&this.matchesComparison(gg(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return ii()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xo extends AU{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new xo(t,e)}matches(t){return Uv(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Uv(n){return"and"===n.op}function Nk(n){return"or"===n.op}function Bk(n){return SU(n)&&Uv(n)}function SU(n){for(const t of n.filters)if(t instanceof xo)return!1;return!0}function Vk(n){if(n instanceof Ar)return n.field.canonicalString()+n.op.toString()+zv(n.value);if(Bk(n))return n.filters.map(t=>Vk(t)).join(",");{const t=n.filters.map(e=>Vk(e)).join(",");return`${n.op}(${t})`}}function MU(n,t){return n instanceof Ar?(i=n,(r=t)instanceof Ar&&i.op===r.op&&i.field.isEqual(r.field)&&Tf(i.value,r.value)):n instanceof xo?function(i,r){return r instanceof xo&&i.op===r.op&&i.filters.length===r.filters.length&&i.filters.reduce((o,l,f)=>o&&MU(l,r.filters[f]),!0)}(n,t):void ii();var i,r}function PU(n,t){const e=n.filters.concat(t);return xo.create(e,n.op)}function kU(n){return n instanceof Ar?`${(e=n).field.canonicalString()} ${e.op} ${zv(e.value)}`:n instanceof xo?function(e){return e.op.toString()+" {"+e.getFilters().map(kU).join(" ,")+"}"}(n):"Filter";var e}class $ae extends Ar{constructor(t,e,i){super(t,e,i),this.key=$n.fromName(i.referenceValue)}matches(t){const e=$n.comparator(t.key,this.key);return this.matchesComparison(e)}}class Hae extends Ar{constructor(t,e){super(t,"in",e),this.keys=RU(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Gae extends Ar{constructor(t,e){super(t,"not-in",e),this.keys=RU(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function RU(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(i=>$n.fromName(i.referenceValue))}class Wae extends Ar{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Pw(e)&&Mw(e.arrayValue,this.value)}}class OU extends Ar{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Mw(this.value.arrayValue,e)}}class qae extends Ar{constructor(t,e){super(t,"not-in",e)}matches(t){if(Mw(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Mw(this.value.arrayValue,e)}}class Zae extends Ar{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Pw(e)||!e.arrayValue.values)&&e.arrayValue.values.some(i=>Mw(this.value.arrayValue,i))}}class Kae{constructor(t,e=null,i=[],r=[],o=null,l=null,f=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=r,this.limit=o,this.startAt=l,this.endAt=f,this.ce=null}}function zk(n,t=null,e=[],i=[],r=null,o=null,l=null){return new Kae(n,t,e,i,r,o,l)}function n0(n){const t=zn(n);if(null===t.ce){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(i=>Vk(i)).join(","),e+="|ob:",e+=t.orderBy.map(i=>{return(o=i).field.canonicalString()+o.dir;var o}).join(","),Dw(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(i=>zv(i)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(i=>zv(i)).join(",")),t.ce=e}return t.ce}function Ow(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!jae(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!MU(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!DU(n.startAt,t.startAt)&&DU(n.endAt,t.endAt)}function gD(n){return $n.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function _D(n,t){return n.filters.filter(e=>e instanceof Ar&&e.field.isEqual(t))}function FU(n,t,e){let i=fD,r=!0;for(const o of _D(n,t)){let l=fD,f=!0;switch(o.op){case"<":case"<=":l=zae(o.value);break;case"==":case"in":case">=":l=o.value;break;case">":l=o.value,f=!1;break;case"!=":case"not-in":l=fD}EU({value:i,inclusive:r},{value:l,inclusive:f})<0&&(i=l,r=f)}if(null!==e)for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(t)){const l=e.position[o];EU({value:i,inclusive:r},{value:l,inclusive:e.inclusive})<0&&(i=l,r=e.inclusive);break}return{value:i,inclusive:r}}function LU(n,t,e){let i=pg,r=!0;for(const o of _D(n,t)){let l=pg,f=!0;switch(o.op){case">=":case">":l=Uae(o.value),f=!1;break;case"==":case"in":case"<=":l=o.value;break;case"<":l=o.value,f=!1;break;case"!=":case"not-in":l=pg}CU({value:i,inclusive:r},{value:l,inclusive:f})>0&&(i=l,r=f)}if(null!==e)for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(t)){const l=e.position[o];CU({value:i,inclusive:r},{value:l,inclusive:e.inclusive})>0&&(i=l,r=e.inclusive);break}return{value:i,inclusive:r}}class Vp{constructor(t,e=null,i=[],r=[],o=null,l="F",f=null,g=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=r,this.limit=o,this.limitType=l,this.startAt=f,this.endAt=g,this.le=null,this.he=null,this.Pe=null}}function NU(n,t,e,i,r,o,l,f){return new Vp(n,t,e,i,r,o,l,f)}function jv(n){return new Vp(n)}function BU(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Uk(n){return null!==n.collectionGroup}function $v(n){const t=zn(n);if(null===t.le){t.le=[];const e=new Set;for(const o of t.explicitOrderBy)t.le.push(o),e.add(o.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let f=new Ao(ts.comparator);return l.filters.forEach(g=>{g.getFlattenedFilters().forEach(b=>{b.isInequality()&&(f=f.add(b.field))})}),f})(t).forEach(o=>{e.has(o.canonicalString())||o.isKeyField()||t.le.push(new Rw(o,i))}),e.has(ts.keyField().canonicalString())||t.le.push(new Rw(ts.keyField(),i))}return t.le}function sc(n){const t=zn(n);return t.he||(t.he=function VU(n,t){if("F"===n.limitType)return zk(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(r=>new Rw(r.field,"desc"===r.dir?"asc":"desc"));const e=n.endAt?new _g(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new _g(n.startAt.position,n.startAt.inclusive):null;return zk(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}(t,$v(n))),t.he}function jk(n,t){const e=n.filters.concat([t]);return new Vp(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function yD(n,t,e){return new Vp(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Fw(n,t){return Ow(sc(n),sc(t))&&n.limitType===t.limitType}function zU(n){return`${n0(sc(n))}|lt:${n.limitType}`}function Hv(n){return`Query(target=${function(e){let i=e.path.canonicalString();return null!==e.collectionGroup&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map(r=>kU(r)).join(", ")}]`),Dw(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map(r=>{return`${(l=r).field.canonicalString()} (${l.dir})`;var l}).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(r=>zv(r)).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(r=>zv(r)).join(",")),`Target(${i})`}(sc(n))}; limitType=${n.limitType})`}function Lw(n,t){return t.isFoundDocument()&&function(i,r){const o=r.key.path;return null!==i.collectionGroup?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):$n.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(n,t)&&function(i,r){for(const o of $v(i))if(!o.field.isKeyField()&&null===r.data.field(o.field))return!1;return!0}(n,t)&&function(i,r){for(const o of i.filters)if(!o.matches(r))return!1;return!0}(n,t)&&(r=t,!((i=n).startAt&&!function(l,f,g){const b=TU(l,f,g);return l.inclusive?b<=0:b<0}(i.startAt,$v(i),r)||i.endAt&&!function(l,f,g){const b=TU(l,f,g);return l.inclusive?b>=0:b>0}(i.endAt,$v(i),r)));var i,r}function UU(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function jU(n){return(t,e)=>{let i=!1;for(const r of $v(n)){const o=Yae(r,t,e);if(0!==o)return o;i=i||r.field.isKeyField()}return 0}}function Yae(n,t,e){const i=n.field.isKeyField()?$n.comparator(t.key,e.key):function(o,l,f){const g=l.data.field(o),b=f.data.field(o);return null!==g&&null!==b?gg(g,b):ii()}(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ii()}}class zp{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(void 0!==i)for(const[r,o]of i)if(this.equalsFn(r,t))return o}has(t){return void 0!==this.get(t)}set(t,e){const i=this.mapKeyFn(t),r=this.inner[i];if(void 0===r)return this.inner[i]=[[t,e]],void this.innerSize++;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],t))return void(r[o]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(void 0===i)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return 1===i.length?delete this.inner[e]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(t){dg(this.inner,(e,i)=>{for(const[r,o]of i)t(r,o)})}isEmpty(){return gU(this.inner)}size(){return this.innerSize}}const Xae=new $o($n.comparator);function Nc(){return Xae}const $U=new $o($n.comparator);function Nw(...n){let t=$U;for(const e of n)t=t.insert(e.key,e);return t}function HU(n){let t=$U;return n.forEach((e,i)=>t=t.insert(e,i.overlayedDocument)),t}function Df(){return Bw()}function GU(){return Bw()}function Bw(){return new zp(n=>n.toString(),(n,t)=>n.isEqual(t))}const Qae=new $o($n.comparator),Jae=new Ao($n.comparator);function lr(...n){let t=Jae;for(const e of n)t=t.add(e);return t}const ele=new Ao(Xi);function $k(){return ele}function WU(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Aw(t)?"-0":t}}function qU(n){return{integerValue:""+n}}function ZU(n,t){return lU(t)?qU(t):WU(n,t)}class vD{constructor(){this._=void 0}}function tle(n,t,e){return n instanceof Gv?function(r,o){const l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&dD(o)&&(o=hD(o)),o&&(l.fields.__previous_value__=o),{mapValue:l}}(e,t):n instanceof r0?YU(n,t):n instanceof o0?XU(n,t):function(r,o){const l=KU(r,o),f=QU(l)+QU(r.Ie);return Lk(l)&&Lk(r.Ie)?qU(f):WU(r.serializer,f)}(n,t)}function nle(n,t,e){return n instanceof r0?YU(n,t):n instanceof o0?XU(n,t):e}function KU(n,t){return n instanceof Wv?Lk(i=t)||(o=i)&&"doubleValue"in o?t:{integerValue:0}:null;var i,o}class Gv extends vD{}class r0 extends vD{constructor(t){super(),this.elements=t}}function YU(n,t){const e=JU(t);for(const i of n.elements)e.some(r=>Tf(r,i))||e.push(i);return{arrayValue:{values:e}}}class o0 extends vD{constructor(t){super(),this.elements=t}}function XU(n,t){let e=JU(t);for(const i of n.elements)e=e.filter(r=>!Tf(r,i));return{arrayValue:{values:e}}}class Wv extends vD{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function QU(n){return Bs(n.integerValue||n.doubleValue)}function JU(n){return Pw(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Vw{constructor(t,e){this.field=t,this.transform=e}}class rle{constructor(t,e){this.version=t,this.transformResults=e}}class vs{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new vs}static exists(t){return new vs(void 0,t)}static updateTime(t){return new vs(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function xD(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class bD{}function ej(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new Zv(n.key,vs.none()):new qv(n.key,n.data,vs.none());{const e=n.data,i=ll.empty();let r=new Ao(ts.comparator);for(let o of t.fields)if(!r.has(o)){let l=e.field(o);null===l&&o.length>1&&(o=o.popLast(),l=e.field(o)),null===l?i.delete(o):i.set(o,l),r=r.add(o)}return new Up(n.key,i,new Lc(r.toArray()),vs.none())}}function ole(n,t,e){n instanceof qv?function(r,o,l){const f=r.value.clone(),g=ij(r.fieldTransforms,o,l.transformResults);f.setAll(g),o.convertToFoundDocument(l.version,f).setHasCommittedMutations()}(n,t,e):n instanceof Up?function(r,o,l){if(!xD(r.precondition,o))return void o.convertToUnknownDocument(l.version);const f=ij(r.fieldTransforms,o,l.transformResults),g=o.data;g.setAll(nj(r)),g.setAll(f),o.convertToFoundDocument(l.version,g).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function zw(n,t,e,i){return n instanceof qv?function(o,l,f,g){if(!xD(o.precondition,l))return f;const b=o.value.clone(),S=rj(o.fieldTransforms,g,l);return b.setAll(S),l.convertToFoundDocument(l.version,b).setHasLocalMutations(),null}(n,t,e,i):n instanceof Up?function(o,l,f,g){if(!xD(o.precondition,l))return f;const b=rj(o.fieldTransforms,g,l),S=l.data;return S.setAll(nj(o)),S.setAll(b),l.convertToFoundDocument(l.version,S).setHasLocalMutations(),null===f?null:f.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(O=>O.field))}(n,t,e,i):(f=e,xD(n.precondition,l=t)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):f);var l,f}function sle(n,t){let e=null;for(const i of n.fieldTransforms){const r=t.data.field(i.field),o=KU(i.transform,r||null);null!=o&&(null===e&&(e=ll.empty()),e.set(i.field,o))}return e||null}function tj(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(i=n.fieldTransforms)&&void 0===r||i&&r&&Lv(i,r,(o,l)=>function ile(n,t){return n.field.isEqual(t.field)&&(r=t.transform,(i=n.transform)instanceof r0&&r instanceof r0||i instanceof o0&&r instanceof o0?Lv(i.elements,r.elements,Tf):i instanceof Wv&&r instanceof Wv?Tf(i.Ie,r.Ie):i instanceof Gv&&r instanceof Gv);var i,r}(o,l))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var i,r}class qv extends bD{constructor(t,e,i,r=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Up extends bD{constructor(t,e,i,r,o=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=r,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function nj(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}}),t}function ij(n,t,e){const i=new Map;gi(n.length===e.length);for(let r=0;r<e.length;r++){const o=n[r],l=o.transform,f=t.data.field(o.field);i.set(o.field,nle(l,f,e[r]))}return i}function rj(n,t,e){const i=new Map;for(const r of n){const o=r.transform,l=e.data.field(r.field);i.set(r.field,tle(o,l,t))}return i}class Zv extends bD{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Hk extends bD{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Gk{constructor(t,e,i,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let r=0;r<this.mutations.length;r++){const o=this.mutations[r];o.key.isEqual(t.key)&&ole(o,t,i[r])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=zw(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=zw(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=GU();return this.mutations.forEach(r=>{const o=t.get(r.key),l=o.overlayedDocument;let f=this.applyToLocalView(l,o.mutatedFields);f=e.has(r.key)?null:f;const g=ej(l,f);null!==g&&i.set(r.key,g),l.isValidDocument()||l.convertToNoDocument(xi.min())}),i}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),lr())}isEqual(t){return this.batchId===t.batchId&&Lv(this.mutations,t.mutations,(e,i)=>tj(e,i))&&Lv(this.baseMutations,t.baseMutations,(e,i)=>tj(e,i))}}class Wk{constructor(t,e,i,r){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=r}static from(t,e,i){gi(t.mutations.length===i.length);let r=Qae;const o=t.mutations;for(let l=0;l<o.length;l++)r=r.insert(o[l].key,i[l].version);return new Wk(t,e,i,r)}}class qk{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class lle{constructor(t,e){this.count=t,this.unchangedNames=e}}var ua,Br;function oj(n){switch(n){default:return ii();case jt.CANCELLED:case jt.UNKNOWN:case jt.DEADLINE_EXCEEDED:case jt.RESOURCE_EXHAUSTED:case jt.INTERNAL:case jt.UNAVAILABLE:case jt.UNAUTHENTICATED:return!1;case jt.INVALID_ARGUMENT:case jt.NOT_FOUND:case jt.ALREADY_EXISTS:case jt.PERMISSION_DENIED:case jt.FAILED_PRECONDITION:case jt.ABORTED:case jt.OUT_OF_RANGE:case jt.UNIMPLEMENTED:case jt.DATA_LOSS:return!0}}function sj(n){if(void 0===n)return qs("GRPC error has no .code"),jt.UNKNOWN;switch(n){case ua.OK:return jt.OK;case ua.CANCELLED:return jt.CANCELLED;case ua.UNKNOWN:return jt.UNKNOWN;case ua.DEADLINE_EXCEEDED:return jt.DEADLINE_EXCEEDED;case ua.RESOURCE_EXHAUSTED:return jt.RESOURCE_EXHAUSTED;case ua.INTERNAL:return jt.INTERNAL;case ua.UNAVAILABLE:return jt.UNAVAILABLE;case ua.UNAUTHENTICATED:return jt.UNAUTHENTICATED;case ua.INVALID_ARGUMENT:return jt.INVALID_ARGUMENT;case ua.NOT_FOUND:return jt.NOT_FOUND;case ua.ALREADY_EXISTS:return jt.ALREADY_EXISTS;case ua.PERMISSION_DENIED:return jt.PERMISSION_DENIED;case ua.FAILED_PRECONDITION:return jt.FAILED_PRECONDITION;case ua.ABORTED:return jt.ABORTED;case ua.OUT_OF_RANGE:return jt.OUT_OF_RANGE;case ua.UNIMPLEMENTED:return jt.UNIMPLEMENTED;case ua.DATA_LOSS:return jt.DATA_LOSS;default:return ii()}}(Br=ua||(ua={}))[Br.OK=0]="OK",Br[Br.CANCELLED=1]="CANCELLED",Br[Br.UNKNOWN=2]="UNKNOWN",Br[Br.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Br[Br.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Br[Br.NOT_FOUND=5]="NOT_FOUND",Br[Br.ALREADY_EXISTS=6]="ALREADY_EXISTS",Br[Br.PERMISSION_DENIED=7]="PERMISSION_DENIED",Br[Br.UNAUTHENTICATED=16]="UNAUTHENTICATED",Br[Br.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Br[Br.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Br[Br.ABORTED=10]="ABORTED",Br[Br.OUT_OF_RANGE=11]="OUT_OF_RANGE",Br[Br.UNIMPLEMENTED=12]="UNIMPLEMENTED",Br[Br.INTERNAL=13]="INTERNAL",Br[Br.UNAVAILABLE=14]="UNAVAILABLE",Br[Br.DATA_LOSS=15]="DATA_LOSS";function aj(){return new TextEncoder}const cle=new Rv([4294967295,4294967295],0);function lj(n){const t=aj().encode(n),e=new nae;return e.update(t),new Uint8Array(e.digest())}function cj(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new Rv([e,i],0),new Rv([r,o],0)]}class Zk{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new Uw(`Invalid padding: ${e}`);if(i<0)throw new Uw(`Invalid hash count: ${i}`);if(t.length>0&&0===this.hashCount)throw new Uw(`Invalid hash count: ${i}`);if(0===t.length&&0!==e)throw new Uw(`Invalid padding when bitmap length is 0: ${e}`);this.Te=8*t.length-e,this.Ee=Rv.fromNumber(this.Te)}de(t,e,i){let r=t.add(e.multiply(Rv.fromNumber(i)));return 1===r.compare(cle)&&(r=new Rv([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}Ae(t){return 0!=(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.Te)return!1;const e=lj(t),[i,r]=cj(e);for(let o=0;o<this.hashCount;o++){const l=this.de(i,r,o);if(!this.Ae(l))return!1}return!0}static create(t,e,i){const r=t%8==0?0:8-t%8,o=new Uint8Array(Math.ceil(t/8)),l=new Zk(o,r,e);return i.forEach(f=>l.insert(f)),l}insert(t){if(0===this.Te)return;const e=lj(t),[i,r]=cj(e);for(let o=0;o<this.hashCount;o++){const l=this.de(i,r,o);this.Re(l)}}Re(t){const e=Math.floor(t/8);this.bitmap[e]|=1<<t%8}}class Uw extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class jw{constructor(t,e,i,r,o){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const r=new Map;return r.set(t,$w.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new jw(xi.min(),r,new $o(Xi),Nc(),lr())}}class $w{constructor(t,e,i,r,o){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new $w(i,e,lr(),lr(),lr())}}class ED{constructor(t,e,i,r){this.Ve=t,this.removedTargetIds=e,this.key=i,this.me=r}}class uj{constructor(t,e){this.targetId=t,this.fe=e}}class dj{constructor(t,e,i=Ta.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=r}}class hj{constructor(){this.ge=0,this.pe=pj(),this.ye=Ta.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(t){t.approximateByteSize()>0&&(this.Se=!0,this.ye=t)}ve(){let t=lr(),e=lr(),i=lr();return this.pe.forEach((r,o)=>{switch(o){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:i=i.add(r);break;default:ii()}}),new $w(this.ye,this.we,t,e,i)}Fe(){this.Se=!1,this.pe=pj()}Me(t,e){this.Se=!0,this.pe=this.pe.insert(t,e)}xe(t){this.Se=!0,this.pe=this.pe.remove(t)}Oe(){this.ge+=1}Ne(){this.ge-=1,gi(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class ule{constructor(t){this.Le=t,this.ke=new Map,this.qe=Nc(),this.Qe=fj(),this.Ke=new $o(Xi)}$e(t){for(const e of t.Ve)t.me&&t.me.isFoundDocument()?this.Ue(e,t.me):this.We(e,t.key,t.me);for(const e of t.removedTargetIds)this.We(e,t.key,t.me)}Ge(t){this.forEachTarget(t,e=>{const i=this.ze(e);switch(t.state){case 0:this.je(e)&&i.Ce(t.resumeToken);break;case 1:i.Ne(),i.be||i.Fe(),i.Ce(t.resumeToken);break;case 2:i.Ne(),i.be||this.removeTarget(e);break;case 3:this.je(e)&&(i.Be(),i.Ce(t.resumeToken));break;case 4:this.je(e)&&(this.He(e),i.Ce(t.resumeToken));break;default:ii()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ke.forEach((i,r)=>{this.je(r)&&e(r)})}Je(t){const e=t.targetId,i=t.fe.count,r=this.Ye(e);if(r){const o=r.target;if(gD(o))if(0===i){const l=new $n(o.path);this.We(e,l,ns.newNoDocument(l,xi.min()))}else gi(1===i);else{const l=this.Ze(e);if(l!==i){const f=this.Xe(t),g=f?this.et(f,t,l):1;0!==g&&(this.He(e),this.Ke=this.Ke.insert(e,2===g?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Xe(t){const e=t.fe.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:o=0}=e;let l,f;try{l=Bp(i).toUint8Array()}catch(g){if(g instanceof yU)return Fc("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{f=new Zk(l,r,o)}catch(g){return Fc(g instanceof Uw?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return 0===f.Te?null:f}et(t,e,i){return e.fe.count===i-this.rt(t,e.targetId)?0:2}rt(t,e){const i=this.Le.getRemoteKeysForTarget(e);let r=0;return i.forEach(o=>{const l=this.Le.nt(),f=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;t.mightContain(f)||(this.We(e,o,null),r++)}),r}it(t){const e=new Map;this.ke.forEach((o,l)=>{const f=this.Ye(l);if(f){if(o.current&&gD(f.target)){const g=new $n(f.target.path);null!==this.qe.get(g)||this.st(l,g)||this.We(l,g,ns.newNoDocument(g,t))}o.De&&(e.set(l,o.ve()),o.Fe())}});let i=lr();this.Qe.forEach((o,l)=>{let f=!0;l.forEachWhile(g=>{const b=this.Ye(g);return!b||"TargetPurposeLimboResolution"===b.purpose||(f=!1,!1)}),f&&(i=i.add(o))}),this.qe.forEach((o,l)=>l.setReadTime(t));const r=new jw(t,e,this.Ke,this.qe,i);return this.qe=Nc(),this.Qe=fj(),this.Ke=new $o(Xi),r}Ue(t,e){if(!this.je(t))return;const i=this.st(t,e.key)?2:0;this.ze(t).Me(e.key,i),this.qe=this.qe.insert(e.key,e),this.Qe=this.Qe.insert(e.key,this.ot(e.key).add(t))}We(t,e,i){if(!this.je(t))return;const r=this.ze(t);this.st(t,e)?r.Me(e,1):r.xe(e),this.Qe=this.Qe.insert(e,this.ot(e).delete(t)),i&&(this.qe=this.qe.insert(e,i))}removeTarget(t){this.ke.delete(t)}Ze(t){const e=this.ze(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Oe(t){this.ze(t).Oe()}ze(t){let e=this.ke.get(t);return e||(e=new hj,this.ke.set(t,e)),e}ot(t){let e=this.Qe.get(t);return e||(e=new Ao(Xi),this.Qe=this.Qe.insert(t,e)),e}je(t){const e=null!==this.Ye(t);return e||vn("WatchChangeAggregator","Detected inactive target",t),e}Ye(t){const e=this.ke.get(t);return e&&e.be?null:this.Le._t(t)}He(t){this.ke.set(t,new hj),this.Le.getRemoteKeysForTarget(t).forEach(e=>{this.We(t,e,null)})}st(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}}function fj(){return new $o($n.comparator)}function pj(){return new $o($n.comparator)}const dle={asc:"ASCENDING",desc:"DESCENDING"},hle={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fle={and:"AND",or:"OR"};class ple{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Kk(n,t){return n.useProto3Json||Dw(t)?t:{value:t}}function Kv(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function mj(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function mle(n,t){return Kv(n,t.toTimestamp())}function Zs(n){return gi(!!n),xi.fromTimestamp(function(e){const i=hg(e);return new es(i.seconds,i.nanos)}(n))}function Yk(n,t){return(i=n,new Nr(["projects",i.projectId,"databases",i.database])).child("documents").child(t).canonicalString();var i}function gj(n){const t=Nr.fromString(n);return gi(Ij(t)),t}function Hw(n,t){return Yk(n.databaseId,t.path)}function Af(n,t){const e=gj(t);if(e.get(1)!==n.databaseId.projectId)throw new gn(jt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new gn(jt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new $n(yj(e))}function Xk(n,t){return Yk(n.databaseId,t)}function _j(n){const t=gj(n);return 4===t.length?Nr.emptyPath():yj(t)}function Gw(n){return new Nr(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yj(n){return gi(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function vj(n,t,e){return{name:Hw(n,t),fields:e.value.mapValue.fields}}function xj(n,t,e){const i=Af(n,t.name),r=Zs(t.updateTime),o=t.createTime?Zs(t.createTime):xi.min(),l=new ll({mapValue:{fields:t.fields}}),f=ns.newFoundDocument(i,r,o,l);return e&&f.setHasCommittedMutations(),e?f.setHasCommittedMutations():f}function Ww(n,t){let e;if(t instanceof qv)e={update:vj(n,t.key,t.value)};else if(t instanceof Zv)e={delete:Hw(n,t.key)};else if(t instanceof Up)e={update:vj(n,t.key,t.data),updateMask:Ele(t.fieldMask)};else{if(!(t instanceof Hk))return ii();e={verify:Hw(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(i=>function(o,l){const f=l.transform;if(f instanceof Gv)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof r0)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof o0)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Wv)return{fieldPath:l.field.canonicalString(),increment:f.Ie};throw ii()}(0,i))),t.precondition.isNone||(e.currentDocument=void 0!==(o=t.precondition).updateTime?{updateTime:mle(n,o.updateTime)}:void 0!==o.exists?{exists:o.exists}:ii()),e;var o}function Qk(n,t){const e=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?vs.updateTime(Zs(o.updateTime)):void 0!==o.exists?vs.exists(o.exists):vs.none():vs.none(),i=t.updateTransforms?t.updateTransforms.map(r=>function(l,f){let g=null;"setToServerValue"in f?(gi("REQUEST_TIME"===f.setToServerValue),g=new Gv):"appendMissingElements"in f?g=new r0(f.appendMissingElements.values||[]):"removeAllFromArray"in f?g=new o0(f.removeAllFromArray.values||[]):"increment"in f?g=new Wv(l,f.increment):ii();const b=ts.fromServerFormat(f.fieldPath);return new Vw(b,g)}(n,r)):[];var o;if(t.update){const r=Af(n,t.update.name),o=new ll({mapValue:{fields:t.update.fields}});if(t.updateMask){const l=new Lc((t.updateMask.fieldPaths||[]).map(S=>ts.fromServerFormat(S)));return new Up(r,o,l,e,i)}return new qv(r,o,e,i)}if(t.delete){const r=Af(n,t.delete);return new Zv(r,e)}if(t.verify){const r=Af(n,t.verify);return new Hk(r,e)}return ii()}function bj(n,t){return{documents:[Xk(n,t.path)]}}function Jk(n,t){const e={structuredQuery:{}},i=t.path;null!==t.collectionGroup?(e.parent=Xk(n,i),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=Xk(n,i.popLast()),e.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(g){if(0!==g.length)return Cj(xo.create(g,"and"))}(t.filters);r&&(e.structuredQuery.where=r);const o=function(g){if(0!==g.length)return g.map(b=>{return{field:yg((O=b).field),direction:xle(O.dir)};var O})}(t.orderBy);o&&(e.structuredQuery.orderBy=o);const l=Kk(n,t.limit);return null!==l&&(e.structuredQuery.limit=l),t.startAt&&(e.structuredQuery.startAt={before:(g=t.startAt).inclusive,values:g.position}),t.endAt&&(e.structuredQuery.endAt=function(g){return{before:!g.inclusive,values:g.position}}(t.endAt)),e;var g}function wj(n){let t=_j(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let r=null;if(i>0){gi(1===i);const S=e.from[0];S.allDescendants?r=S.collectionId:t=t.child(S.collectionId)}let o=[];e.where&&(o=function(O){const $=Ej(O);return $ instanceof xo&&Bk($)?$.getFilters():[$]}(e.where));let l=[];e.orderBy&&(l=e.orderBy.map($=>{return new Rw(Yv((ge=$).field),function(je){switch(je){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(ge.direction));var ge}));let f=null;e.limit&&(f=function(O){let $;return $="object"==typeof O?O.value:O,Dw($)?null:$}(e.limit));let g=null;var O;e.startAt&&(g=new _g((O=e.startAt).values||[],!!O.before));let b=null;return e.endAt&&(b=function(O){return new _g(O.values||[],!O.before)}(e.endAt)),NU(t,r,l,o,f,"F",g,b)}function Ej(n){return void 0!==n.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=Yv(e.unaryFilter.field);return Ar.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Yv(e.unaryFilter.field);return Ar.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Yv(e.unaryFilter.field);return Ar.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Yv(e.unaryFilter.field);return Ar.create(l,"!=",{nullValue:"NULL_VALUE"});default:return ii()}}(n):void 0!==n.fieldFilter?Ar.create(Yv((e=n).fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ii()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==n.compositeFilter?function(e){return xo.create(e.compositeFilter.filters.map(i=>Ej(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ii()}}(e.compositeFilter.op))}(n):ii();var e}function xle(n){return dle[n]}function ble(n){return hle[n]}function wle(n){return fle[n]}function yg(n){return{fieldPath:n.canonicalString()}}function Yv(n){return ts.fromServerFormat(n.fieldPath)}function Cj(n){return n instanceof Ar?function(e){if("=="===e.op){if(bU(e.value))return{unaryFilter:{field:yg(e.field),op:"IS_NAN"}};if(xU(e.value))return{unaryFilter:{field:yg(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(bU(e.value))return{unaryFilter:{field:yg(e.field),op:"IS_NOT_NAN"}};if(xU(e.value))return{unaryFilter:{field:yg(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yg(e.field),op:ble(e.op),value:e.value}}}(n):n instanceof xo?function(e){const i=e.getFilters().map(r=>Cj(r));return 1===i.length?i[0]:{compositeFilter:{op:wle(e.op),filters:i}}}(n):ii()}function Ele(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Ij(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class jp{constructor(t,e,i,r,o=xi.min(),l=xi.min(),f=Ta.EMPTY_BYTE_STRING,g=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=f,this.expectedCount=g}withSequenceNumber(t){return new jp(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new jp(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new jp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new jp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Tj{constructor(t){this.ut=t}}function Dj(n,t){const e=t.key,i={prefixPath:e.getCollectionPath().popLast().toArray(),collectionGroup:e.collectionGroup,documentId:e.path.lastSegment(),readTime:CD(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())i.document={name:Hw(o=n.ut,(l=t).key),fields:l.data.value.mapValue.fields,updateTime:Kv(o,l.version.toTimestamp()),createTime:Kv(o,l.createTime.toTimestamp())};else if(t.isNoDocument())i.noDocument={path:e.path.toArray(),readTime:s0(t.version)};else{if(!t.isUnknownDocument())return ii();i.unknownDocument={path:e.path.toArray(),version:s0(t.version)}}var o,l;return i}function CD(n){const t=n.toTimestamp();return[t.seconds,t.nanoseconds]}function s0(n){const t=n.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function a0(n){const t=new es(n.seconds,n.nanoseconds);return xi.fromTimestamp(t)}function l0(n,t){const e=(t.baseMutations||[]).map(o=>Qk(n.ut,o));for(let o=0;o<t.mutations.length-1;++o)o+1<t.mutations.length&&void 0!==t.mutations[o+1].transform&&(t.mutations[o].updateTransforms=t.mutations[o+1].transform.fieldTransforms,t.mutations.splice(o+1,1),++o);const i=t.mutations.map(o=>Qk(n.ut,o)),r=es.fromMillis(t.localWriteTimeMs);return new Gk(t.batchId,r,e,i)}function qw(n){const t=a0(n.readTime),e=void 0!==n.lastLimboFreeSnapshotVersion?a0(n.lastLimboFreeSnapshotVersion):xi.min();let i;return i=void 0!==n.query.documents?(gi(1===(o=n.query).documents.length),sc(jv(_j(o.documents[0])))):function(o){return sc(wj(o))}(n.query),new jp(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,t,e,Ta.fromBase64String(n.resumeToken));var o}function Aj(n,t){const e=s0(t.snapshotVersion),i=s0(t.lastLimboFreeSnapshotVersion);let r;r=gD(t.target)?bj(n.ut,t.target):Jk(n.ut,t.target);const o=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:n0(t.target),readTime:e,resumeToken:o,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function eR(n){const t=wj({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?yD(t,t.limit,"L"):t}function tR(n,t){return new qk(t.largestBatchId,Qk(n.ut,t.overlayMutation))}function Sj(n,t){const e=t.path.lastSegment();return[n,Dl(t.path.popLast()),e]}function Mj(n,t,e,i){return{indexId:n,uid:t.uid||"",sequenceNumber:e,readTime:s0(i.readTime),documentKey:Dl(i.documentKey.path),largestBatchId:i.largestBatchId}}class Ile{getBundleMetadata(t,e){return Pj(t).get(e).next(i=>{if(i)return{id:(o=i).bundleId,createTime:a0(o.createTime),version:o.version};var o})}saveBundleMetadata(t,e){return Pj(t).put({bundleId:(r=e).id,createTime:s0(Zs(r.createTime)),version:r.version});var r}getNamedQuery(t,e){return kj(t).get(e).next(i=>{if(i)return{name:(o=i).name,query:eR(o.bundledQuery),readTime:a0(o.readTime)};var o})}saveNamedQuery(t,e){return kj(t).put({name:(r=e).name,readTime:s0(Zs(r.readTime)),bundledQuery:r.bundledQuery});var r}}function Pj(n){return ja(n,"bundles")}function kj(n){return ja(n,"namedQueries")}class ID{constructor(t,e){this.serializer=t,this.userId=e}static ct(t,e){return new ID(t,e.uid||"")}getOverlay(t,e){return Zw(t).get(Sj(this.userId,e)).next(i=>i?tR(this.serializer,i):null)}getOverlays(t,e){const i=Df();return St.forEach(e,r=>this.getOverlay(t,r).next(o=>{null!==o&&i.set(r,o)})).next(()=>i)}saveOverlays(t,e,i){const r=[];return i.forEach((o,l)=>{const f=new qk(e,l);r.push(this.lt(t,f))}),St.waitFor(r)}removeOverlaysForBatchId(t,e,i){const r=new Set;e.forEach(l=>r.add(Dl(l.getCollectionPath())));const o=[];return r.forEach(l=>{const f=IDBKeyRange.bound([this.userId,l,i],[this.userId,l,i+1],!1,!0);o.push(Zw(t).H("collectionPathOverlayIndex",f))}),St.waitFor(o)}getOverlaysForCollection(t,e,i){const r=Df(),o=Dl(e),l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Zw(t).W("collectionPathOverlayIndex",l).next(f=>{for(const g of f){const b=tR(this.serializer,g);r.set(b.getKey(),b)}return r})}getOverlaysForCollectionGroup(t,e,i,r){const o=Df();let l;const f=IDBKeyRange.bound([this.userId,e,i],[this.userId,e,Number.POSITIVE_INFINITY],!0);return Zw(t).Y({index:"collectionGroupOverlayIndex",range:f},(g,b,S)=>{const O=tR(this.serializer,b);o.size()<r||O.largestBatchId===l?(o.set(O.getKey(),O),l=O.largestBatchId):S.done()}).next(()=>o)}lt(t,e){return Zw(t).put(function(r,o,l){const[f,g,b]=Sj(o,l.mutation.key);return{userId:o,collectionPath:g,documentId:b,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Ww(r.ut,l.mutation)}}(this.serializer,this.userId,e))}}function Zw(n){return ja(n,"documentOverlays")}class c0{constructor(){}ht(t,e){this.Pt(t,e),e.It()}Pt(t,e){if("nullValue"in t)this.Tt(e,5);else if("booleanValue"in t)this.Tt(e,10),e.Et(t.booleanValue?1:0);else if("integerValue"in t)this.Tt(e,15),e.Et(Bs(t.integerValue));else if("doubleValue"in t){const i=Bs(t.doubleValue);isNaN(i)?this.Tt(e,13):(this.Tt(e,15),Aw(i)?e.Et(0):e.Et(i))}else if("timestampValue"in t){const i=t.timestampValue;this.Tt(e,20),"string"==typeof i?e.dt(i):(e.dt(`${i.seconds||""}`),e.Et(i.nanos||0))}else if("stringValue"in t)this.At(t.stringValue,e),this.Rt(e);else if("bytesValue"in t)this.Tt(e,30),e.Vt(Bp(t.bytesValue)),this.Rt(e);else if("referenceValue"in t)this.ft(t.referenceValue,e);else if("geoPointValue"in t){const i=t.geoPointValue;this.Tt(e,45),e.Et(i.latitude||0),e.Et(i.longitude||0)}else"mapValue"in t?wU(t)?this.Tt(e,Number.MAX_SAFE_INTEGER):(this.gt(t.mapValue,e),this.Rt(e)):"arrayValue"in t?(this.yt(t.arrayValue,e),this.Rt(e)):ii()}At(t,e){this.Tt(e,25),this.wt(t,e)}wt(t,e){e.dt(t)}gt(t,e){const i=t.fields||{};this.Tt(e,55);for(const r of Object.keys(i))this.At(r,e),this.Pt(i[r],e)}yt(t,e){const i=t.values||[];this.Tt(e,50);for(const r of i)this.Pt(r,e)}ft(t,e){this.Tt(e,37),$n.fromName(t).path.forEach(i=>{this.Tt(e,60),this.wt(i,e)})}Tt(t,e){t.Et(e)}Rt(t){t.Et(2)}}function Tle(n){if(0===n)return 8;let t=0;return!(n>>4)&&(t+=4,n<<=4),!(n>>6)&&(t+=2,n<<=2),!(n>>7)&&(t+=1),t}function Rj(n){const t=64-function(i){let r=0;for(let o=0;o<8;++o){const l=Tle(255&i[o]);if(r+=l,8!==l)break}return r}(n);return Math.ceil(t/8)}c0.St=new c0;class Dle{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(t){const e=t[Symbol.iterator]();let i=e.next();for(;!i.done;)this.Dt(i.value),i=e.next();this.Ct()}vt(t){const e=t[Symbol.iterator]();let i=e.next();for(;!i.done;)this.Ft(i.value),i=e.next();this.Mt()}xt(t){for(const e of t){const i=e.charCodeAt(0);if(i<128)this.Dt(i);else if(i<2048)this.Dt(960|i>>>6),this.Dt(128|63&i);else if(e<"\ud800"||"\udbff"<e)this.Dt(480|i>>>12),this.Dt(128|63&i>>>6),this.Dt(128|63&i);else{const r=e.codePointAt(0);this.Dt(240|r>>>18),this.Dt(128|63&r>>>12),this.Dt(128|63&r>>>6),this.Dt(128|63&r)}}this.Ct()}Ot(t){for(const e of t){const i=e.charCodeAt(0);if(i<128)this.Ft(i);else if(i<2048)this.Ft(960|i>>>6),this.Ft(128|63&i);else if(e<"\ud800"||"\udbff"<e)this.Ft(480|i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i);else{const r=e.codePointAt(0);this.Ft(240|r>>>18),this.Ft(128|63&r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r)}}this.Mt()}Nt(t){const e=this.Bt(t),i=Rj(e);this.Lt(1+i),this.buffer[this.position++]=255&i;for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=255&e[r]}kt(t){const e=this.Bt(t),i=Rj(e);this.Lt(1+i),this.buffer[this.position++]=~(255&i);for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=~(255&e[r])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(t){this.Lt(t.length),this.buffer.set(t,this.position),this.position+=t.length}Ut(){return this.buffer.slice(0,this.position)}Bt(t){const e=function(o){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,o,!1),new Uint8Array(l.buffer)}(t),i=0!=(128&e[0]);e[0]^=i?255:128;for(let r=1;r<e.length;++r)e[r]^=i?255:0;return e}Dt(t){const e=255&t;0===e?(this.Qt(0),this.Qt(255)):255===e?(this.Qt(255),this.Qt(0)):this.Qt(e)}Ft(t){const e=255&t;0===e?(this.$t(0),this.$t(255)):255===e?(this.$t(255),this.$t(0)):this.$t(t)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(t){this.Lt(1),this.buffer[this.position++]=t}$t(t){this.Lt(1),this.buffer[this.position++]=~t}Lt(t){const e=t+this.position;if(e<=this.buffer.length)return;let i=2*this.buffer.length;i<e&&(i=e);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class Ale{constructor(t){this.Wt=t}Vt(t){this.Wt.bt(t)}dt(t){this.Wt.xt(t)}Et(t){this.Wt.Nt(t)}It(){this.Wt.qt()}}class Sle{constructor(t){this.Wt=t}Vt(t){this.Wt.vt(t)}dt(t){this.Wt.Ot(t)}Et(t){this.Wt.kt(t)}It(){this.Wt.Kt()}}class Kw{constructor(){this.Wt=new Dle,this.Gt=new Ale(this.Wt),this.zt=new Sle(this.Wt)}seed(t){this.Wt.seed(t)}jt(t){return 0===t?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class u0{constructor(t,e,i,r){this.indexId=t,this.documentKey=e,this.arrayValue=i,this.directionalValue=r}Ht(){const t=this.directionalValue.length,e=0===t||255===this.directionalValue[t-1]?t+1:t,i=new Uint8Array(e);return i.set(this.directionalValue,0),e!==t?i.set([0],this.directionalValue.length):++i[i.length-1],new u0(this.indexId,this.documentKey,this.arrayValue,i)}}function vg(n,t){let e=n.indexId-t.indexId;return 0!==e?e:(e=Oj(n.arrayValue,t.arrayValue),0!==e?e:(e=Oj(n.directionalValue,t.directionalValue),0!==e?e:$n.comparator(n.documentKey,t.documentKey)))}function Oj(n,t){for(let e=0;e<n.length&&e<t.length;++e){const i=n[e]-t[e];if(0!==i)return i}return n.length-t.length}class Fj{constructor(t){this.Jt=new Ao((e,i)=>ts.comparator(e.field,i.field)),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Yt=t.orderBy,this.Zt=[];for(const e of t.filters){const i=e;i.isInequality()?this.Jt=this.Jt.add(i):this.Zt.push(i)}}get Xt(){return this.Jt.size>1}en(t){if(gi(t.collectionGroup===this.collectionId),this.Xt)return!1;const e=Mk(t);if(void 0!==e&&!this.tn(e))return!1;const i=Q_(t);let r=new Set,o=0,l=0;for(;o<i.length&&this.tn(i[o]);++o)r=r.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.Jt.size>0){const f=this.Jt.getIterator().getNext();if(!r.has(f.field.canonicalString())){const g=i[o];if(!this.nn(f,g)||!this.rn(this.Yt[l++],g))return!1}++o}for(;o<i.length;++o)if(l>=this.Yt.length||!this.rn(this.Yt[l++],i[o]))return!1;return!0}sn(){if(this.Xt)return null;let t=new Ao(ts.comparator);const e=[];for(const i of this.Zt)if(!i.field.isKeyField())if("array-contains"===i.op||"array-contains-any"===i.op)e.push(new J_(i.field,2));else{if(t.has(i.field))continue;t=t.add(i.field),e.push(new J_(i.field,0))}for(const i of this.Yt)i.field.isKeyField()||t.has(i.field)||(t=t.add(i.field),e.push(new J_(i.field,"asc"===i.dir?0:1)));return new Nv(Nv.UNKNOWN_ID,this.collectionId,e,Bv.empty())}tn(t){for(const e of this.Zt)if(this.nn(e,t))return!0;return!1}nn(t,e){return!(void 0===t||!t.field.isEqual(e.fieldPath))&&2===e.kind==("array-contains"===t.op||"array-contains-any"===t.op)}rn(t,e){return!!t.field.isEqual(e.fieldPath)&&(0===e.kind&&"asc"===t.dir||1===e.kind&&"desc"===t.dir)}}function Lj(n){var t,e;if(gi(n instanceof Ar||n instanceof xo),n instanceof Ar){if(n instanceof OU){const r=(null===(e=null===(t=n.value.arrayValue)||void 0===t?void 0:t.values)||void 0===e?void 0:e.map(o=>Ar.create(n.field,"==",o)))||[];return xo.create(r,"or")}return n}const i=n.filters.map(r=>Lj(r));return xo.create(i,n.op)}function Mle(n){if(0===n.getFilters().length)return[];const t=rR(Lj(n));return gi(Nj(t)),nR(t)||iR(t)?[t]:t.getFilters()}function nR(n){return n instanceof Ar}function iR(n){return n instanceof xo&&Bk(n)}function Nj(n){return nR(n)||iR(n)||function(e){if(e instanceof xo&&Nk(e)){for(const i of e.getFilters())if(!nR(i)&&!iR(i))return!1;return!0}return!1}(n)}function rR(n){if(gi(n instanceof Ar||n instanceof xo),n instanceof Ar)return n;if(1===n.filters.length)return rR(n.filters[0]);const t=n.filters.map(i=>rR(i));let e=xo.create(t,n.op);return e=TD(e),Nj(e)?e:(gi(e instanceof xo),gi(Uv(e)),gi(e.filters.length>1),e.filters.reduce((i,r)=>oR(i,r)))}function oR(n,t){let e;return gi(n instanceof Ar||n instanceof xo),gi(t instanceof Ar||t instanceof xo),e=n instanceof Ar?t instanceof Ar?xo.create([n,t],"and"):Bj(n,t):t instanceof Ar?Bj(t,n):function(r,o){if(gi(r.filters.length>0&&o.filters.length>0),Uv(r)&&Uv(o))return PU(r,o.getFilters());const l=Nk(r)?r:o,f=Nk(r)?o:r,g=l.filters.map(b=>oR(b,f));return xo.create(g,"or")}(n,t),TD(e)}function Bj(n,t){if(Uv(t))return PU(t,n.getFilters());{const e=t.filters.map(i=>oR(n,i));return xo.create(e,"or")}}function TD(n){if(gi(n instanceof Ar||n instanceof xo),n instanceof Ar)return n;const t=n.getFilters();if(1===t.length)return TD(t[0]);if(SU(n))return n;const e=t.map(r=>TD(r)),i=[];return e.forEach(r=>{r instanceof Ar?i.push(r):r instanceof xo&&(r.op===n.op?i.push(...r.filters):i.push(r))}),1===i.length?i[0]:xo.create(i,n.op)}class Ple{constructor(){this.on=new sR}addToCollectionParentIndex(t,e){return this.on.add(e),St.resolve()}getCollectionParents(t,e){return St.resolve(this.on.getEntries(e))}addFieldIndex(t,e){return St.resolve()}deleteFieldIndex(t,e){return St.resolve()}deleteAllFieldIndexes(t){return St.resolve()}createTargetIndexes(t,e){return St.resolve()}getDocumentsMatchingTarget(t,e){return St.resolve(null)}getIndexType(t,e){return St.resolve(0)}getFieldIndexes(t,e){return St.resolve([])}getNextCollectionGroupToUpdate(t){return St.resolve(null)}getMinOffset(t,e){return St.resolve(Eu.min())}getMinOffsetFromCollectionGroup(t,e){return St.resolve(Eu.min())}updateCollectionGroup(t,e,i){return St.resolve()}updateIndexEntries(t,e){return St.resolve()}}class sR{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),r=this.index[e]||new Ao(Nr.comparator),o=!r.has(i);return this.index[e]=r.add(i),o}has(t){const e=t.lastSegment(),i=t.popLast(),r=this.index[e];return r&&r.has(i)}getEntries(t){return(this.index[t]||new Ao(Nr.comparator)).toArray()}}const DD=new Uint8Array(0);class kle{constructor(t,e){this.user=t,this.databaseId=e,this._n=new sR,this.an=new zp(i=>n0(i),(i,r)=>Ow(i,r)),this.uid=t.uid||""}addToCollectionParentIndex(t,e){if(!this._n.has(e)){const i=e.lastSegment(),r=e.popLast();t.addOnCommittedListener(()=>{this._n.add(e)});const o={collectionId:i,parent:Dl(r)};return Vj(t).put(o)}return St.resolve()}getCollectionParents(t,e){const i=[],r=IDBKeyRange.bound([e,""],[nU(e),""],!1,!0);return Vj(t).W(r).next(o=>{for(const l of o){if(l.collectionId!==e)break;i.push(If(l.parent))}return i})}addFieldIndex(t,e){const i=Yw(t),r={indexId:(f=e).indexId,collectionGroup:f.collectionGroup,fields:f.fields.map(g=>[g.fieldPath.canonicalString(),g.kind])};var f;delete r.indexId;const o=i.add(r);if(e.indexState){const l=Qv(t);return o.next(f=>{l.put(Mj(f,this.user,e.indexState.sequenceNumber,e.indexState.offset))})}return o.next()}deleteFieldIndex(t,e){const i=Yw(t),r=Qv(t),o=Xv(t);return i.delete(e.indexId).next(()=>r.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0)))}deleteAllFieldIndexes(t){const e=Yw(t),i=Xv(t),r=Qv(t);return e.H().next(()=>i.H()).next(()=>r.H())}createTargetIndexes(t,e){return St.forEach(this.un(e),i=>this.getIndexType(t,i).next(r=>{if(0===r||1===r){const o=new Fj(i).sn();if(null!=o)return this.addFieldIndex(t,o)}}))}getDocumentsMatchingTarget(t,e){const i=Xv(t);let r=!0;const o=new Map;return St.forEach(this.un(e),l=>this.cn(t,l).next(f=>{r&&(r=!!f),o.set(l,f)})).next(()=>{if(r){let l=lr();const f=[];return St.forEach(o,(g,b)=>{var It;vn("IndexedDbIndexManager",`Using index ${It=g,`id=${It.indexId}|cg=${It.collectionGroup}|f=${It.fields.map(Yt=>`${Yt.fieldPath}:${Yt.kind}`).join(",")}`} to execute ${n0(e)}`);const S=function(It,Yt){const yn=Mk(Yt);if(void 0===yn)return null;for(const ai of _D(It,yn.fieldPath))switch(ai.op){case"array-contains-any":return ai.value.arrayValue.values||[];case"array-contains":return[ai.value]}return null}(b,g),O=function(It,Yt){const yn=new Map;for(const ai of Q_(Yt))for(const Ri of _D(It,ai.fieldPath))switch(Ri.op){case"==":case"in":yn.set(ai.fieldPath.canonicalString(),Ri.value);break;case"not-in":case"!=":return yn.set(ai.fieldPath.canonicalString(),Ri.value),Array.from(yn.values())}return null}(b,g),$=function(It,Yt){const yn=[];let ai=!0;for(const Ri of Q_(Yt)){const Qr=0===Ri.kind?FU(It,Ri.fieldPath,It.startAt):LU(It,Ri.fieldPath,It.startAt);yn.push(Qr.value),ai&&(ai=Qr.inclusive)}return new _g(yn,ai)}(b,g),J=function(It,Yt){const yn=[];let ai=!0;for(const Ri of Q_(Yt)){const Qr=0===Ri.kind?LU(It,Ri.fieldPath,It.endAt):FU(It,Ri.fieldPath,It.endAt);yn.push(Qr.value),ai&&(ai=Qr.inclusive)}return new _g(yn,ai)}(b,g),ge=this.ln(g,b,$),Ce=this.ln(g,b,J),je=this.hn(g,b,O),ft=this.Pn(g.indexId,S,ge,$.inclusive,Ce,J.inclusive,je);return St.forEach(ft,ot=>i.j(ot,e.limit).next(It=>{It.forEach(Yt=>{const yn=$n.fromSegments(Yt.documentKey);l.has(yn)||(l=l.add(yn),f.push(yn))})}))}).next(()=>f)}return St.resolve(null)})}un(t){let e=this.an.get(t);return e||(e=0===t.filters.length?[t]:Mle(xo.create(t.filters,"and")).map(i=>zk(t.path,t.collectionGroup,t.orderBy,i.getFilters(),t.limit,t.startAt,t.endAt)),this.an.set(t,e),e)}Pn(t,e,i,r,o,l,f){const g=(null!=e?e.length:1)*Math.max(i.length,o.length),b=g/(null!=e?e.length:1),S=[];for(let O=0;O<g;++O){const $=e?this.In(e[O/b]):DD,J=this.Tn(t,$,i[O%b],r),ge=this.En(t,$,o[O%b],l),Ce=f.map(je=>this.Tn(t,$,je,!0));S.push(...this.createRange(J,ge,Ce))}return S}Tn(t,e,i,r){const o=new u0(t,$n.empty(),e,i);return r?o:o.Ht()}En(t,e,i,r){const o=new u0(t,$n.empty(),e,i);return r?o.Ht():o}cn(t,e){const i=new Fj(e),r=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment();return this.getFieldIndexes(t,r).next(o=>{let l=null;for(const f of o)i.en(f)&&(!l||f.fields.length>l.fields.length)&&(l=f);return l})}getIndexType(t,e){let i=2;const r=this.un(e);return St.forEach(r,o=>this.cn(t,o).next(l=>{l?0!==i&&l.fields.length<function(g){let b=new Ao(ts.comparator),S=!1;for(const O of g.filters)for(const $ of O.getFlattenedFilters())$.field.isKeyField()||("array-contains"===$.op||"array-contains-any"===$.op?S=!0:b=b.add($.field));for(const O of g.orderBy)O.field.isKeyField()||(b=b.add(O.field));return b.size+(S?1:0)}(o)&&(i=1):i=0})).next(()=>null!==e.limit&&r.length>1&&2===i?1:i)}dn(t,e){const i=new Kw;for(const r of Q_(t)){const o=e.data.field(r.fieldPath);if(null==o)return null;const l=i.jt(r.kind);c0.St.ht(o,l)}return i.Ut()}In(t){const e=new Kw;return c0.St.ht(t,e.jt(0)),e.Ut()}An(t,e){const i=new Kw;return c0.St.ht(t0(this.databaseId,e),i.jt(function(o){const l=Q_(o);return 0===l.length?0:l[l.length-1].kind}(t))),i.Ut()}hn(t,e,i){if(null===i)return[];let r=[];r.push(new Kw);let o=0;for(const l of Q_(t)){const f=i[o++];for(const g of r)if(this.Rn(e,l.fieldPath)&&Pw(f))r=this.Vn(r,l,f);else{const b=g.jt(l.kind);c0.St.ht(f,b)}}return this.mn(r)}ln(t,e,i){return this.hn(t,e,i.position)}mn(t){const e=[];for(let i=0;i<t.length;++i)e[i]=t[i].Ut();return e}Vn(t,e,i){const r=[...t],o=[];for(const l of i.arrayValue.values||[])for(const f of r){const g=new Kw;g.seed(f.Ut()),c0.St.ht(l,g.jt(e.kind)),o.push(g)}return o}Rn(t,e){return!!t.filters.find(i=>i instanceof Ar&&i.field.isEqual(e)&&("in"===i.op||"not-in"===i.op))}getFieldIndexes(t,e){const i=Yw(t),r=Qv(t);return(e?i.W("collectionGroupIndex",IDBKeyRange.bound(e,e)):i.W()).next(o=>{const l=[];return St.forEach(o,f=>r.get([f.indexId,this.uid]).next(g=>{l.push(function(S,O){const $=O?new Bv(O.sequenceNumber,new Eu(a0(O.readTime),new $n(If(O.documentKey)),O.largestBatchId)):Bv.empty(),J=S.fields.map(([ge,Ce])=>new J_(ts.fromServerFormat(ge),Ce));return new Nv(S.indexId,S.collectionGroup,J,$)}(f,g))})).next(()=>l)})}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next(e=>0===e.length?null:(e.sort((i,r)=>{const o=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==o?o:Xi(i.collectionGroup,r.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(t,e,i){const r=Yw(t),o=Qv(t);return this.fn(t).next(l=>r.W("collectionGroupIndex",IDBKeyRange.bound(e,e)).next(f=>St.forEach(f,g=>o.put(Mj(g.indexId,this.user,l,i)))))}updateIndexEntries(t,e){const i=new Map;return St.forEach(e,(r,o)=>{const l=i.get(r.collectionGroup);return(l?St.resolve(l):this.getFieldIndexes(t,r.collectionGroup)).next(f=>(i.set(r.collectionGroup,f),St.forEach(f,g=>this.gn(t,r,g).next(b=>{const S=this.pn(o,g);return b.isEqual(S)?St.resolve():this.yn(t,o,g,b,S)}))))})}wn(t,e,i,r){return Xv(t).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.An(i,e.key),documentKey:e.key.path.toArray()})}Sn(t,e,i,r){return Xv(t).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.An(i,e.key),e.key.path.toArray()])}gn(t,e,i){const r=Xv(t);let o=new Ao(vg);return r.Y({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.An(i,e)])},(l,f)=>{o=o.add(new u0(i.indexId,e,f.arrayValue,f.directionalValue))}).next(()=>o)}pn(t,e){let i=new Ao(vg);const r=this.dn(e,t);if(null==r)return i;const o=Mk(e);if(null!=o){const l=t.data.field(o.fieldPath);if(Pw(l))for(const f of l.arrayValue.values||[])i=i.add(new u0(e.indexId,t.key,this.In(f),r))}else i=i.add(new u0(e.indexId,t.key,DD,r));return i}yn(t,e,i,r,o){vn("IndexedDbIndexManager","Updating index entries for document '%s'",e.key);const l=[];return function(g,b,S,O,$){const J=g.getIterator(),ge=b.getIterator();let Ce=Vv(J),je=Vv(ge);for(;Ce||je;){let ft=!1,ot=!1;if(Ce&&je){const It=S(Ce,je);It<0?ot=!0:It>0&&(ft=!0)}else null!=Ce?ot=!0:ft=!0;ft?(O(je),je=Vv(ge)):ot?($(Ce),Ce=Vv(J)):(Ce=Vv(J),je=Vv(ge))}}(r,o,vg,f=>{l.push(this.wn(t,e,i,f))},f=>{l.push(this.Sn(t,e,i,f))}),St.waitFor(l)}fn(t){let e=1;return Qv(t).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,o)=>{o.done(),e=r.sequenceNumber+1}).next(()=>e)}createRange(t,e,i){i=i.sort((l,f)=>vg(l,f)).filter((l,f,g)=>!f||0!==vg(l,g[f-1]));const r=[];r.push(t);for(const l of i){const f=vg(l,t),g=vg(l,e);if(0===f)r[0]=t.Ht();else if(f>0&&g<0)r.push(l),r.push(l.Ht());else if(g>0)break}r.push(e);const o=[];for(let l=0;l<r.length;l+=2){if(this.bn(r[l],r[l+1]))return[];o.push(IDBKeyRange.bound([r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,DD,[]],[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,DD,[]]))}return o}bn(t,e){return vg(t,e)>0}getMinOffsetFromCollectionGroup(t,e){return this.getFieldIndexes(t,e).next(zj)}getMinOffset(t,e){return St.mapArray(this.un(e),i=>this.cn(t,i).next(r=>r||ii())).next(zj)}}function Vj(n){return ja(n,"collectionParents")}function Xv(n){return ja(n,"indexEntries")}function Yw(n){return ja(n,"indexConfiguration")}function Qv(n){return ja(n,"indexState")}function zj(n){gi(0!==n.length);let t=n[0].indexState.offset,e=t.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;Pk(r,t)<0&&(t=r),e<r.largestBatchId&&(e=r.largestBatchId)}return new Eu(t.readTime,t.documentKey,e)}const Uj={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Al{constructor(t,e,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=i}static withCacheSize(t){return new Al(t,Al.DEFAULT_COLLECTION_PERCENTILE,Al.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function jj(n,t,e){const i=n.store("mutations"),r=n.store("documentMutations"),o=[],l=IDBKeyRange.only(e.batchId);let f=0;const g=i.Y({range:l},(S,O,$)=>(f++,$.delete()));o.push(g.next(()=>{gi(1===f)}));const b=[];for(const S of e.mutations){const O=dU(t,S.key.path,e.batchId);o.push(r.delete(O)),b.push(S.key)}return St.waitFor(o).next(()=>b)}function AD(n){if(!n)return 0;let t;if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw ii();t=n.noDocument}return JSON.stringify(t).length}Al.DEFAULT_COLLECTION_PERCENTILE=10,Al.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Al.DEFAULT=new Al(41943040,Al.DEFAULT_COLLECTION_PERCENTILE,Al.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Al.DISABLED=new Al(-1,0,0);class SD{constructor(t,e,i,r){this.userId=t,this.serializer=e,this.indexManager=i,this.referenceDelegate=r,this.Dn={}}static ct(t,e,i,r){gi(""!==t.uid);const o=t.isAuthenticated()?t.uid:"";return new SD(o,e,i,r)}checkEmpty(t){let e=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xg(t).Y({index:"userMutationsIndex",range:i},(r,o,l)=>{e=!1,l.done()}).next(()=>e)}addMutationBatch(t,e,i,r){const o=Jv(t),l=xg(t);return l.add({}).next(f=>{gi("number"==typeof f);const g=new Gk(f,e,i,r),b=function(J,ge,Ce){const je=Ce.baseMutations.map(ot=>Ww(J.ut,ot)),ft=Ce.mutations.map(ot=>Ww(J.ut,ot));return{userId:ge,batchId:Ce.batchId,localWriteTimeMs:Ce.localWriteTime.toMillis(),baseMutations:je,mutations:ft}}(this.serializer,this.userId,g),S=[];let O=new Ao(($,J)=>Xi($.canonicalString(),J.canonicalString()));for(const $ of r){const J=dU(this.userId,$.key.path,f);O=O.add($.key.path.popLast()),S.push(l.put(b)),S.push(o.put(J,xae))}return O.forEach($=>{S.push(this.indexManager.addToCollectionParentIndex(t,$))}),t.addOnCommittedListener(()=>{this.Dn[f]=g.keys()}),St.waitFor(S).next(()=>g)})}lookupMutationBatch(t,e){return xg(t).get(e).next(i=>i?(gi(i.userId===this.userId),l0(this.serializer,i)):null)}Cn(t,e){return this.Dn[e]?St.resolve(this.Dn[e]):this.lookupMutationBatch(t,e).next(i=>{if(i){const r=i.keys();return this.Dn[e]=r,r}return null})}getNextMutationBatchAfterBatchId(t,e){const i=e+1,r=IDBKeyRange.lowerBound([this.userId,i]);let o=null;return xg(t).Y({index:"userMutationsIndex",range:r},(l,f,g)=>{f.userId===this.userId&&(gi(f.batchId>=i),o=l0(this.serializer,f)),g.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(t){const e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return xg(t).Y({index:"userMutationsIndex",range:e,reverse:!0},(r,o,l)=>{i=o.batchId,l.done()}).next(()=>i)}getAllMutationBatches(t){const e=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return xg(t).W("userMutationsIndex",e).next(i=>i.map(r=>l0(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(t,e){const i=cD(this.userId,e.path),r=IDBKeyRange.lowerBound(i),o=[];return Jv(t).Y({range:r},(l,f,g)=>{const[b,S,O]=l,$=If(S);if(b===this.userId&&e.path.isEqual($))return xg(t).get(O).next(J=>{if(!J)throw ii();gi(J.userId===this.userId),o.push(l0(this.serializer,J))});g.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Ao(Xi);const r=[];return e.forEach(o=>{const l=cD(this.userId,o.path),f=IDBKeyRange.lowerBound(l),g=Jv(t).Y({range:f},(b,S,O)=>{const[$,J,ge]=b,Ce=If(J);$===this.userId&&o.path.isEqual(Ce)?i=i.add(ge):O.done()});r.push(g)}),St.waitFor(r).next(()=>this.vn(t,i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,r=i.length+1,o=cD(this.userId,i),l=IDBKeyRange.lowerBound(o);let f=new Ao(Xi);return Jv(t).Y({range:l},(g,b,S)=>{const[O,$,J]=g,ge=If($);O===this.userId&&i.isPrefixOf(ge)?ge.length===r&&(f=f.add(J)):S.done()}).next(()=>this.vn(t,f))}vn(t,e){const i=[],r=[];return e.forEach(o=>{r.push(xg(t).get(o).next(l=>{if(null===l)throw ii();gi(l.userId===this.userId),i.push(l0(this.serializer,l))}))}),St.waitFor(r).next(()=>i)}removeMutationBatch(t,e){return jj(t.ae,this.userId,e).next(i=>(t.addOnCommittedListener(()=>{this.Fn(e.batchId)}),St.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(t,r))))}Fn(t){delete this.Dn[t]}performConsistencyCheck(t){return this.checkEmpty(t).next(e=>{if(!e)return St.resolve();const i=IDBKeyRange.lowerBound([this.userId]),r=[];return Jv(t).Y({range:i},(o,l,f)=>{if(o[0]===this.userId){const g=If(o[1]);r.push(g)}else f.done()}).next(()=>{gi(0===r.length)})})}containsKey(t,e){return $j(t,this.userId,e)}Mn(t){return Hj(t).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function $j(n,t,e){const i=cD(t,e.path),r=i[1],o=IDBKeyRange.lowerBound(i);let l=!1;return Jv(n).Y({range:o,J:!0},(f,g,b)=>{const[S,O,$]=f;S===t&&O===r&&(l=!0),b.done()}).next(()=>l)}function xg(n){return ja(n,"mutations")}function Jv(n){return ja(n,"documentMutations")}function Hj(n){return ja(n,"mutationQueues")}class d0{constructor(t){this.xn=t}next(){return this.xn+=2,this.xn}static On(){return new d0(0)}static Nn(){return new d0(-1)}}class Rle{constructor(t,e){this.referenceDelegate=t,this.serializer=e}allocateTargetId(t){return this.Bn(t).next(e=>{const i=new d0(e.highestTargetId);return e.highestTargetId=i.next(),this.Ln(t,e).next(()=>e.highestTargetId)})}getLastRemoteSnapshotVersion(t){return this.Bn(t).next(e=>xi.fromTimestamp(new es(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(t){return this.Bn(t).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(t,e,i){return this.Bn(t).next(r=>(r.highestListenSequenceNumber=e,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),e>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e),this.Ln(t,r)))}addTargetData(t,e){return this.kn(t,e).next(()=>this.Bn(t).next(i=>(i.targetCount+=1,this.qn(e,i),this.Ln(t,i))))}updateTargetData(t,e){return this.kn(t,e)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(()=>ex(t).delete(e.targetId)).next(()=>this.Bn(t)).next(i=>(gi(i.targetCount>0),i.targetCount-=1,this.Ln(t,i)))}removeTargets(t,e,i){let r=0;const o=[];return ex(t).Y((l,f)=>{const g=qw(f);g.sequenceNumber<=e&&null===i.get(g.targetId)&&(r++,o.push(this.removeTargetData(t,g)))}).next(()=>St.waitFor(o)).next(()=>r)}forEachTarget(t,e){return ex(t).Y((i,r)=>{const o=qw(r);e(o)})}Bn(t){return Gj(t).get("targetGlobalKey").next(e=>(gi(null!==e),e))}Ln(t,e){return Gj(t).put("targetGlobalKey",e)}kn(t,e){return ex(t).put(Aj(this.serializer,e))}qn(t,e){let i=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,i=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,i=!0),i}getTargetCount(t){return this.Bn(t).next(e=>e.targetCount)}getTargetData(t,e){const i=n0(e),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let o=null;return ex(t).Y({range:r,index:"queryTargetsIndex"},(l,f,g)=>{const b=qw(f);Ow(e,b.target)&&(o=b,g.done())}).next(()=>o)}addMatchingKeys(t,e,i){const r=[],o=bg(t);return e.forEach(l=>{const f=Dl(l.path);r.push(o.put({targetId:i,path:f})),r.push(this.referenceDelegate.addReference(t,i,l))}),St.waitFor(r)}removeMatchingKeys(t,e,i){const r=bg(t);return St.forEach(e,o=>{const l=Dl(o.path);return St.waitFor([r.delete([i,l]),this.referenceDelegate.removeReference(t,i,o)])})}removeMatchingKeysForTargetId(t,e){const i=bg(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(t,e){const i=IDBKeyRange.bound([e],[e+1],!1,!0),r=bg(t);let o=lr();return r.Y({range:i,J:!0},(l,f,g)=>{const b=If(l[1]),S=new $n(b);o=o.add(S)}).next(()=>o)}containsKey(t,e){const i=Dl(e.path),r=IDBKeyRange.bound([i],[nU(i)],!1,!0);let o=0;return bg(t).Y({index:"documentTargetsIndex",J:!0,range:r},([l,f],g,b)=>{0!==l&&(o++,b.done())}).next(()=>o>0)}_t(t,e){return ex(t).get(e).next(i=>i?qw(i):null)}}function ex(n){return ja(n,"targets")}function Gj(n){return ja(n,"targetGlobal")}function bg(n){return ja(n,"targetDocuments")}function Wj([n,t],[e,i]){const r=Xi(n,e);return 0===r?Xi(t,i):r}class Ole{constructor(t){this.Qn=t,this.buffer=new Ao(Wj),this.Kn=0}$n(){return++this.Kn}Un(t){const e=[t,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(e);else{const i=this.buffer.last();Wj(e,i)<0&&(this.buffer=this.buffer.delete(i).add(e))}}get maxValue(){return this.buffer.last()[0]}}class qj{constructor(t,e,i){this.garbageCollector=t,this.asyncQueue=e,this.localStore=i,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(t){var e=this;vn("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(0,Jt.Z)(function*(){e.Wn=null;try{yield e.localStore.collectGarbage(e.garbageCollector)}catch(i){ug(i)?vn("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i):yield cg(i)}yield e.Gn(3e5)}))}}class Fle{constructor(t,e){this.zn=t,this.params=e}calculateTargetCount(t,e){return this.zn.jn(t).next(i=>Math.floor(e/100*i))}nthSequenceNumber(t,e){if(0===e)return St.resolve(Cu._e);const i=new Ole(e);return this.zn.forEachTarget(t,r=>i.Un(r.sequenceNumber)).next(()=>this.zn.Hn(t,r=>i.Un(r))).next(()=>i.maxValue)}removeTargets(t,e,i){return this.zn.removeTargets(t,e,i)}removeOrphanedDocuments(t,e){return this.zn.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(vn("LruGarbageCollector","Garbage collection skipped; disabled"),St.resolve(Uj)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(vn("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Uj):this.Jn(t,e))}getCacheSize(t){return this.zn.getCacheSize(t)}Jn(t,e){let i,r,o,l,f,g,b;const S=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(O=>(O>this.params.maximumSequenceNumbersToCollect?(vn("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${O}`),r=this.params.maximumSequenceNumbersToCollect):r=O,l=Date.now(),this.nthSequenceNumber(t,r))).next(O=>(i=O,f=Date.now(),this.removeTargets(t,i,e))).next(O=>(o=O,g=Date.now(),this.removeOrphanedDocuments(t,i))).next(O=>(b=Date.now(),Fv()<=xf.in.DEBUG&&vn("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-S}ms\n\tDetermined least recently used ${r} in `+(f-l)+`ms\n\tRemoved ${o} targets in `+(g-f)+`ms\n\tRemoved ${O} documents in `+(b-g)+`ms\nTotal Duration: ${b-S}ms`),St.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:O})))}}class Lle{constructor(t,e){this.db=t,this.garbageCollector=function Zj(n,t){return new Fle(n,t)}(this,e)}jn(t){const e=this.Yn(t);return this.db.getTargetCache().getTargetCount(t).next(i=>e.next(r=>i+r))}Yn(t){let e=0;return this.Hn(t,i=>{e++}).next(()=>e)}forEachTarget(t,e){return this.db.getTargetCache().forEachTarget(t,e)}Hn(t,e){return this.Zn(t,(i,r)=>e(r))}addReference(t,e,i){return MD(t,i)}removeReference(t,e,i){return MD(t,i)}removeTargets(t,e,i){return this.db.getTargetCache().removeTargets(t,e,i)}markPotentiallyOrphaned(t,e){return MD(t,e)}Xn(t,e){return function(r,o){let l=!1;return Hj(r).Z(f=>$j(r,f,o).next(g=>(g&&(l=!0),St.resolve(!g)))).next(()=>l)}(t,e)}removeOrphanedDocuments(t,e){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let o=0;return this.Zn(t,(l,f)=>{if(f<=e){const g=this.Xn(t,l).next(b=>{if(!b)return o++,i.getEntry(t,l).next(()=>(i.removeEntry(l,xi.min()),bg(t).delete([0,Dl(l.path)])))});r.push(g)}}).next(()=>St.waitFor(r)).next(()=>i.apply(t)).next(()=>o)}removeTarget(t,e){const i=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,i)}updateLimboDocument(t,e){return MD(t,e)}Zn(t,e){const i=bg(t);let r,o=Cu._e;return i.Y({index:"documentTargetsIndex"},([l,f],{path:g,sequenceNumber:b})=>{0===l?(o!==Cu._e&&e(new $n(If(r)),o),o=b,r=g):o=Cu._e}).next(()=>{o!==Cu._e&&e(new $n(If(r)),o)})}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}}function MD(n,t){return bg(n).put((r=n.currentSequenceNumber,{targetId:0,path:Dl(t.path),sequenceNumber:r}));var r}class Kj{constructor(){this.changes=new zp(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,ns.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return void 0!==i?St.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class Nle{constructor(t){this.serializer=t}setIndexManager(t){this.indexManager=t}addEntry(t,e,i){return h0(t).put(i)}removeEntry(t,e,i){return h0(t).delete(function(o,l){const f=o.path.toArray();return[f.slice(0,f.length-2),f[f.length-2],CD(l),f[f.length-1]]}(e,i))}updateMetadata(t,e){return this.getMetadata(t).next(i=>(i.byteSize+=e,this.er(t,i)))}getEntry(t,e){let i=ns.newInvalidDocument(e);return h0(t).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Xw(e))},(r,o)=>{i=this.tr(e,o)}).next(()=>i)}nr(t,e){let i={size:0,document:ns.newInvalidDocument(e)};return h0(t).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Xw(e))},(r,o)=>{i={document:this.tr(e,o),size:AD(o)}}).next(()=>i)}getEntries(t,e){let i=Nc();return this.rr(t,e,(r,o)=>{const l=this.tr(r,o);i=i.insert(r,l)}).next(()=>i)}ir(t,e){let i=Nc(),r=new $o($n.comparator);return this.rr(t,e,(o,l)=>{const f=this.tr(o,l);i=i.insert(o,f),r=r.insert(o,AD(l))}).next(()=>({documents:i,sr:r}))}rr(t,e,i){if(e.isEmpty())return St.resolve();let r=new Ao(Jj);e.forEach(g=>r=r.add(g));const o=IDBKeyRange.bound(Xw(r.first()),Xw(r.last())),l=r.getIterator();let f=l.getNext();return h0(t).Y({index:"documentKeyIndex",range:o},(g,b,S)=>{const O=$n.fromSegments([...b.prefixPath,b.collectionGroup,b.documentId]);for(;f&&Jj(f,O)<0;)i(f,null),f=l.getNext();f&&f.isEqual(O)&&(i(f,b),f=l.hasNext()?l.getNext():null),f?S.U(Xw(f)):S.done()}).next(()=>{for(;f;)i(f,null),f=l.hasNext()?l.getNext():null})}getDocumentsMatchingQuery(t,e,i,r,o){const l=e.path,f=[l.popLast().toArray(),l.lastSegment(),CD(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],g=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return h0(t).W(IDBKeyRange.bound(f,g,!0)).next(b=>{o?.incrementDocumentReadCount(b.length);let S=Nc();for(const O of b){const $=this.tr($n.fromSegments(O.prefixPath.concat(O.collectionGroup,O.documentId)),O);$.isFoundDocument()&&(Lw(e,$)||r.has($.key))&&(S=S.insert($.key,$))}return S})}getAllFromCollectionGroup(t,e,i,r){let o=Nc();const l=Qj(e,i),f=Qj(e,Eu.max());return h0(t).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,f,!0)},(g,b,S)=>{const O=this.tr($n.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);o=o.insert(O.key,O),o.size===r&&S.done()}).next(()=>o)}newChangeBuffer(t){return new Ble(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next(e=>e.byteSize)}getMetadata(t){return Xj(t).get("remoteDocumentGlobalKey").next(e=>(gi(!!e),e))}er(t,e){return Xj(t).put("remoteDocumentGlobalKey",e)}tr(t,e){if(e){const i=function Cle(n,t){let e;if(t.document)e=xj(n.ut,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const i=$n.fromSegments(t.noDocument.path),r=a0(t.noDocument.readTime);e=ns.newNoDocument(i,r),t.hasCommittedMutations&&e.setHasCommittedMutations()}else{if(!t.unknownDocument)return ii();{const i=$n.fromSegments(t.unknownDocument.path),r=a0(t.unknownDocument.version);e=ns.newUnknownDocument(i,r)}}return t.readTime&&e.setReadTime(function(r){const o=new es(r[0],r[1]);return xi.fromTimestamp(o)}(t.readTime)),e}(this.serializer,e);if(!i.isNoDocument()||!i.version.isEqual(xi.min()))return i}return ns.newInvalidDocument(t)}}function Yj(n){return new Nle(n)}class Ble extends Kj{constructor(t,e){super(),this._r=t,this.trackRemovals=e,this.ar=new zp(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(t){const e=[];let i=0,r=new Ao((o,l)=>Xi(o.canonicalString(),l.canonicalString()));return this.changes.forEach((o,l)=>{const f=this.ar.get(o);if(e.push(this._r.removeEntry(t,o,f.readTime)),l.isValidDocument()){const g=Dj(this._r.serializer,l);r=r.add(o.path.popLast());const b=AD(g);i+=b-f.size,e.push(this._r.addEntry(t,o,g))}else if(i-=f.size,this.trackRemovals){const g=Dj(this._r.serializer,l.convertToNoDocument(xi.min()));e.push(this._r.addEntry(t,o,g))}}),r.forEach(o=>{e.push(this._r.indexManager.addToCollectionParentIndex(t,o))}),e.push(this._r.updateMetadata(t,i)),St.waitFor(e)}getFromCache(t,e){return this._r.nr(t,e).next(i=>(this.ar.set(e,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(t,e){return this._r.ir(t,e).next(({documents:i,sr:r})=>(r.forEach((o,l)=>{this.ar.set(o,{size:l,readTime:i.get(o).readTime})}),i))}}function Xj(n){return ja(n,"remoteDocumentGlobal")}function h0(n){return ja(n,"remoteDocumentsV14")}function Xw(n){const t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Qj(n,t){const e=t.documentKey.path.toArray();return[n,CD(t.readTime),e.slice(0,e.length-2),e.length>0?e[e.length-1]:""]}function Jj(n,t){const e=n.path.toArray(),i=t.path.toArray();let r=0;for(let o=0;o<e.length-2&&o<i.length-2;++o)if(r=Xi(e[o],i[o]),r)return r;return r=Xi(e.length,i.length),r||(r=Xi(e[e.length-2],i[i.length-2]),r||Xi(e[e.length-1],i[i.length-1]))}class Vle{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class e7{constructor(t,e,i,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=r}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next(r=>(i=r,this.remoteDocumentCache.getEntry(t,e))).next(r=>(null!==i&&zw(i.mutation,r,Lc.empty(),es.now()),r))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.getLocalViewOfDocuments(t,i,lr()).next(()=>i))}getLocalViewOfDocuments(t,e,i=lr()){const r=Df();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,i).next(o=>{let l=Nw();return o.forEach((f,g)=>{l=l.insert(f,g.overlayedDocument)}),l}))}getOverlayedDocuments(t,e){const i=Df();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,lr()))}populateOverlays(t,e,i){const r=[];return i.forEach(o=>{e.has(o)||r.push(o)}),this.documentOverlayCache.getOverlays(t,r).next(o=>{o.forEach((l,f)=>{e.set(l,f)})})}computeViews(t,e,i,r){let o=Nc();const l=Bw(),f=Bw();return e.forEach((g,b)=>{const S=i.get(b.key);r.has(b.key)&&(void 0===S||S.mutation instanceof Up)?o=o.insert(b.key,b):void 0!==S?(l.set(b.key,S.mutation.getFieldMask()),zw(S.mutation,b,S.mutation.getFieldMask(),es.now())):l.set(b.key,Lc.empty())}),this.recalculateAndSaveOverlays(t,o).next(g=>(g.forEach((b,S)=>l.set(b,S)),e.forEach((b,S)=>{var O;return f.set(b,new Vle(S,null!==(O=l.get(b))&&void 0!==O?O:null))}),f))}recalculateAndSaveOverlays(t,e){const i=Bw();let r=new $o((l,f)=>l-f),o=lr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(l=>{for(const f of l)f.keys().forEach(g=>{const b=e.get(g);if(null===b)return;let S=i.get(g)||Lc.empty();S=f.applyToLocalView(b,S),i.set(g,S);const O=(r.get(f.batchId)||lr()).add(g);r=r.insert(f.batchId,O)})}).next(()=>{const l=[],f=r.getReverseIterator();for(;f.hasNext();){const g=f.getNext(),b=g.key,S=g.value,O=GU();S.forEach($=>{if(!o.has($)){const J=ej(e.get($),i.get($));null!==J&&O.set($,J),o=o.add($)}}),l.push(this.documentOverlayCache.saveOverlays(t,b,O))}return St.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,e,i,r){return $n.isDocumentKey((l=e).path)&&null===l.collectionGroup&&0===l.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):Uk(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,r):this.getDocumentsMatchingCollectionQuery(t,e,i,r);var l}getNextDocuments(t,e,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,r).next(o=>{const l=r-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,r-o.size):St.resolve(Df());let f=-1,g=o;return l.next(b=>St.forEach(b,(S,O)=>(f<O.largestBatchId&&(f=O.largestBatchId),o.get(S)?St.resolve():this.remoteDocumentCache.getEntry(t,S).next($=>{g=g.insert(S,$)}))).next(()=>this.populateOverlays(t,b,o)).next(()=>this.computeViews(t,g,b,lr())).next(S=>({batchId:f,changes:HU(S)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new $n(e)).next(i=>{let r=Nw();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(t,e,i,r){const o=e.collectionGroup;let l=Nw();return this.indexManager.getCollectionParents(t,o).next(f=>St.forEach(f,g=>{const b=(O=e,$=g.child(o),new Vp($,null,O.explicitOrderBy.slice(),O.filters.slice(),O.limit,O.limitType,O.startAt,O.endAt));var O,$;return this.getDocumentsMatchingCollectionQuery(t,b,i,r).next(S=>{S.forEach((O,$)=>{l=l.insert(O,$)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(t,e,i,r){let o;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next(l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,o,r))).next(l=>{o.forEach((g,b)=>{const S=b.getKey();null===l.get(S)&&(l=l.insert(S,ns.newInvalidDocument(S)))});let f=Nw();return l.forEach((g,b)=>{const S=o.get(g);void 0!==S&&zw(S.mutation,b,Lc.empty(),es.now()),Lw(e,b)&&(f=f.insert(g,b))}),f})}}class zle{constructor(t){this.serializer=t,this.ur=new Map,this.cr=new Map}getBundleMetadata(t,e){return St.resolve(this.ur.get(e))}saveBundleMetadata(t,e){return this.ur.set(e.id,{id:(r=e).id,version:r.version,createTime:Zs(r.createTime)}),St.resolve();var r}getNamedQuery(t,e){return St.resolve(this.cr.get(e))}saveNamedQuery(t,e){return this.cr.set(e.name,{name:(r=e).name,query:eR(r.bundledQuery),readTime:Zs(r.readTime)}),St.resolve();var r}}class Ule{constructor(){this.overlays=new $o($n.comparator),this.lr=new Map}getOverlay(t,e){return St.resolve(this.overlays.get(e))}getOverlays(t,e){const i=Df();return St.forEach(e,r=>this.getOverlay(t,r).next(o=>{null!==o&&i.set(r,o)})).next(()=>i)}saveOverlays(t,e,i){return i.forEach((r,o)=>{this.lt(t,e,o)}),St.resolve()}removeOverlaysForBatchId(t,e,i){const r=this.lr.get(i);return void 0!==r&&(r.forEach(o=>this.overlays=this.overlays.remove(o)),this.lr.delete(i)),St.resolve()}getOverlaysForCollection(t,e,i){const r=Df(),o=e.length+1,l=new $n(e.child("")),f=this.overlays.getIteratorFrom(l);for(;f.hasNext();){const g=f.getNext().value,b=g.getKey();if(!e.isPrefixOf(b.path))break;b.path.length===o&&g.largestBatchId>i&&r.set(g.getKey(),g)}return St.resolve(r)}getOverlaysForCollectionGroup(t,e,i,r){let o=new $o((b,S)=>b-S);const l=this.overlays.getIterator();for(;l.hasNext();){const b=l.getNext().value;if(b.getKey().getCollectionGroup()===e&&b.largestBatchId>i){let S=o.get(b.largestBatchId);null===S&&(S=Df(),o=o.insert(b.largestBatchId,S)),S.set(b.getKey(),b)}}const f=Df(),g=o.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach((b,S)=>f.set(b,S)),!(f.size()>=r)););return St.resolve(f)}lt(t,e,i){const r=this.overlays.get(i.key);if(null!==r){const l=this.lr.get(r.largestBatchId).delete(i.key);this.lr.set(r.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new qk(e,i));let o=this.lr.get(e);void 0===o&&(o=lr(),this.lr.set(e,o)),this.lr.set(e,o.add(i.key))}}class aR{constructor(){this.hr=new Ao($a.Pr),this.Ir=new Ao($a.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(t,e){const i=new $a(t,e);this.hr=this.hr.add(i),this.Ir=this.Ir.add(i)}Er(t,e){t.forEach(i=>this.addReference(i,e))}removeReference(t,e){this.dr(new $a(t,e))}Ar(t,e){t.forEach(i=>this.removeReference(i,e))}Rr(t){const e=new $n(new Nr([])),i=new $a(e,t),r=new $a(e,t+1),o=[];return this.Ir.forEachInRange([i,r],l=>{this.dr(l),o.push(l.key)}),o}Vr(){this.hr.forEach(t=>this.dr(t))}dr(t){this.hr=this.hr.delete(t),this.Ir=this.Ir.delete(t)}mr(t){const e=new $n(new Nr([])),i=new $a(e,t),r=new $a(e,t+1);let o=lr();return this.Ir.forEachInRange([i,r],l=>{o=o.add(l.key)}),o}containsKey(t){const e=new $a(t,0),i=this.hr.firstAfterOrEqual(e);return null!==i&&t.isEqual(i.key)}}class $a{constructor(t,e){this.key=t,this.gr=e}static Pr(t,e){return $n.comparator(t.key,e.key)||Xi(t.gr,e.gr)}static Tr(t,e){return Xi(t.gr,e.gr)||$n.comparator(t.key,e.key)}}class jle{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.pr=1,this.yr=new Ao($a.Pr)}checkEmpty(t){return St.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,i,r){const o=this.pr;this.pr++;const l=new Gk(o,e,i,r);this.mutationQueue.push(l);for(const f of r)this.yr=this.yr.add(new $a(f.key,o)),this.indexManager.addToCollectionParentIndex(t,f.key.path.popLast());return St.resolve(l)}lookupMutationBatch(t,e){return St.resolve(this.wr(e))}getNextMutationBatchAfterBatchId(t,e){const r=this.Sr(e+1),o=r<0?0:r;return St.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return St.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(t){return St.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new $a(e,0),r=new $a(e,Number.POSITIVE_INFINITY),o=[];return this.yr.forEachInRange([i,r],l=>{const f=this.wr(l.gr);o.push(f)}),St.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Ao(Xi);return e.forEach(r=>{const o=new $a(r,0),l=new $a(r,Number.POSITIVE_INFINITY);this.yr.forEachInRange([o,l],f=>{i=i.add(f.gr)})}),St.resolve(this.br(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,r=i.length+1;let o=i;$n.isDocumentKey(o)||(o=o.child(""));const l=new $a(new $n(o),0);let f=new Ao(Xi);return this.yr.forEachWhile(g=>{const b=g.key.path;return!!i.isPrefixOf(b)&&(b.length===r&&(f=f.add(g.gr)),!0)},l),St.resolve(this.br(f))}br(t){const e=[];return t.forEach(i=>{const r=this.wr(i);null!==r&&e.push(r)}),e}removeMutationBatch(t,e){gi(0===this.Dr(e.batchId,"removed")),this.mutationQueue.shift();let i=this.yr;return St.forEach(e.mutations,r=>{const o=new $a(r.key,e.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.yr=i})}Fn(t){}containsKey(t,e){const i=new $a(e,0),r=this.yr.firstAfterOrEqual(i);return St.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return St.resolve()}Dr(t,e){return this.Sr(t)}Sr(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}wr(t){const e=this.Sr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class $le{constructor(t){this.Cr=t,this.docs=new $o($n.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,r=this.docs.get(i),o=r?r.size:0,l=this.Cr(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return St.resolve(i?i.document.mutableCopy():ns.newInvalidDocument(e))}getEntries(t,e){let i=Nc();return e.forEach(r=>{const o=this.docs.get(r);i=i.insert(r,o?o.document.mutableCopy():ns.newInvalidDocument(r))}),St.resolve(i)}getDocumentsMatchingQuery(t,e,i,r){let o=Nc();const l=e.path,f=new $n(l.child("")),g=this.docs.getIteratorFrom(f);for(;g.hasNext();){const{key:b,value:{document:S}}=g.getNext();if(!l.isPrefixOf(b.path))break;b.path.length>l.length+1||Pk(rU(S),i)<=0||(r.has(S.key)||Lw(e,S))&&(o=o.insert(S.key,S.mutableCopy()))}return St.resolve(o)}getAllFromCollectionGroup(t,e,i,r){ii()}vr(t,e){return St.forEach(this.docs,i=>e(i))}newChangeBuffer(t){return new Hle(this)}getSize(t){return St.resolve(this.size)}}class Hle extends Kj{constructor(t){super(),this._r=t}applyChanges(t){const e=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?e.push(this._r.addEntry(t,r)):this._r.removeEntry(i)}),St.waitFor(e)}getFromCache(t,e){return this._r.getEntry(t,e)}getAllFromCache(t,e){return this._r.getEntries(t,e)}}class Gle{constructor(t){this.persistence=t,this.Fr=new zp(e=>n0(e),Ow),this.lastRemoteSnapshotVersion=xi.min(),this.highestTargetId=0,this.Mr=0,this.Or=new aR,this.targetCount=0,this.Nr=d0.On()}forEachTarget(t,e){return this.Fr.forEach((i,r)=>e(r)),St.resolve()}getLastRemoteSnapshotVersion(t){return St.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return St.resolve(this.Mr)}allocateTargetId(t){return this.highestTargetId=this.Nr.next(),St.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.Mr&&(this.Mr=e),St.resolve()}kn(t){this.Fr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Nr=new d0(e),this.highestTargetId=e),t.sequenceNumber>this.Mr&&(this.Mr=t.sequenceNumber)}addTargetData(t,e){return this.kn(e),this.targetCount+=1,St.resolve()}updateTargetData(t,e){return this.kn(e),St.resolve()}removeTargetData(t,e){return this.Fr.delete(e.target),this.Or.Rr(e.targetId),this.targetCount-=1,St.resolve()}removeTargets(t,e,i){let r=0;const o=[];return this.Fr.forEach((l,f)=>{f.sequenceNumber<=e&&null===i.get(f.targetId)&&(this.Fr.delete(l),o.push(this.removeMatchingKeysForTargetId(t,f.targetId)),r++)}),St.waitFor(o).next(()=>r)}getTargetCount(t){return St.resolve(this.targetCount)}getTargetData(t,e){const i=this.Fr.get(e)||null;return St.resolve(i)}addMatchingKeys(t,e,i){return this.Or.Er(e,i),St.resolve()}removeMatchingKeys(t,e,i){this.Or.Ar(e,i);const r=this.persistence.referenceDelegate,o=[];return r&&e.forEach(l=>{o.push(r.markPotentiallyOrphaned(t,l))}),St.waitFor(o)}removeMatchingKeysForTargetId(t,e){return this.Or.Rr(e),St.resolve()}getMatchingKeysForTargetId(t,e){const i=this.Or.mr(e);return St.resolve(i)}containsKey(t,e){return St.resolve(this.Or.containsKey(e))}}class lR{constructor(t,e){this.Br={},this.overlays={},this.Lr=new Cu(0),this.kr=!1,this.kr=!0,this.referenceDelegate=t(this),this.qr=new Gle(this),this.indexManager=new Ple,this.remoteDocumentCache=new $le(i=>this.referenceDelegate.Qr(i)),this.serializer=new Tj(e),this.Kr=new zle(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Ule,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.Br[t.toKey()];return i||(i=new jle(e,this.referenceDelegate),this.Br[t.toKey()]=i),i}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(t,e,i){vn("MemoryPersistence","Starting transaction:",t);const r=new Wle(this.Lr.next());return this.referenceDelegate.$r(),i(r).next(o=>this.referenceDelegate.Ur(r).next(()=>o)).toPromise().then(o=>(r.raiseOnCommittedEvent(),o))}Wr(t,e){return St.or(Object.values(this.Br).map(i=>()=>i.containsKey(t,e)))}}class Wle extends sU{constructor(t){super(),this.currentSequenceNumber=t}}class PD{constructor(t){this.persistence=t,this.Gr=new aR,this.zr=null}static jr(t){return new PD(t)}get Hr(){if(this.zr)return this.zr;throw ii()}addReference(t,e,i){return this.Gr.addReference(i,e),this.Hr.delete(i.toString()),St.resolve()}removeReference(t,e,i){return this.Gr.removeReference(i,e),this.Hr.add(i.toString()),St.resolve()}markPotentiallyOrphaned(t,e){return this.Hr.add(e.toString()),St.resolve()}removeTarget(t,e){this.Gr.Rr(e.targetId).forEach(r=>this.Hr.add(r.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next(r=>{r.forEach(o=>this.Hr.add(o.toString()))}).next(()=>i.removeTargetData(t,e))}$r(){this.zr=new Set}Ur(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return St.forEach(this.Hr,i=>{const r=$n.fromPath(i);return this.Jr(t,r).next(o=>{o||e.removeEntry(r,xi.min())})}).next(()=>(this.zr=null,e.apply(t)))}updateLimboDocument(t,e){return this.Jr(t,e).next(i=>{i?this.Hr.delete(e.toString()):this.Hr.add(e.toString())})}Qr(t){return 0}Jr(t,e){return St.or([()=>St.resolve(this.Gr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Wr(t,e)])}}class qle{constructor(t){this.serializer=t}N(t,e,i,r){const o=new lD("createOrUpgrade",e);var g;i<1&&r>=1&&(t.createObjectStore("owner"),(g=t).createObjectStore("mutationQueues",{keyPath:"userId"}),g.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uU,{unique:!0}),g.createObjectStore("documentMutations"),t7(t),function(g){g.createObjectStore("remoteDocuments")}(t));let l=St.resolve();return i<3&&r>=3&&(0!==i&&(function(g){g.deleteObjectStore("targetDocuments"),g.deleteObjectStore("targets"),g.deleteObjectStore("targetGlobal")}(t),t7(t)),l=l.next(()=>function(g){const b=g.store("targetGlobal"),S={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:xi.min().toTimestamp(),targetCount:0};return b.put("targetGlobalKey",S)}(o))),i<4&&r>=4&&(0!==i&&(l=l.next(()=>function(g,b){return b.store("mutations").W().next(S=>{g.deleteObjectStore("mutations"),g.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uU,{unique:!0});const O=b.store("mutations"),$=S.map(J=>O.put(J));return St.waitFor($)})}(t,o))),l=l.next(()=>{!function(g){g.createObjectStore("clientMetadata",{keyPath:"clientId"})}(t)})),i<5&&r>=5&&(l=l.next(()=>this.Zr(o))),i<6&&r>=6&&(l=l.next(()=>(function(g){g.createObjectStore("remoteDocumentGlobal")}(t),this.Xr(o)))),i<7&&r>=7&&(l=l.next(()=>this.ei(o))),i<8&&r>=8&&(l=l.next(()=>this.ti(t,o))),i<9&&r>=9&&(l=l.next(()=>{!function(g){g.objectStoreNames.contains("remoteDocumentChanges")&&g.deleteObjectStore("remoteDocumentChanges")}(t)})),i<10&&r>=10&&(l=l.next(()=>this.ni(o))),i<11&&r>=11&&(l=l.next(()=>{(function(g){g.createObjectStore("bundles",{keyPath:"bundleId"})})(t),function(g){g.createObjectStore("namedQueries",{keyPath:"name"})}(t)})),i<12&&r>=12&&(l=l.next(()=>{!function(g){const b=g.createObjectStore("documentOverlays",{keyPath:kae});b.createIndex("collectionPathOverlayIndex",Rae,{unique:!1}),b.createIndex("collectionGroupOverlayIndex",Oae,{unique:!1})}(t)})),i<13&&r>=13&&(l=l.next(()=>function(g){const b=g.createObjectStore("remoteDocumentsV14",{keyPath:bae});b.createIndex("documentKeyIndex",wae),b.createIndex("collectionGroupIndex",Eae)}(t)).next(()=>this.ri(t,o)).next(()=>t.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(l=l.next(()=>this.ii(t,o))),i<15&&r>=15&&(l=l.next(()=>function(g){g.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),g.createObjectStore("indexState",{keyPath:Aae}).createIndex("sequenceNumberIndex",Sae,{unique:!1}),g.createObjectStore("indexEntries",{keyPath:Mae}).createIndex("documentKeyIndex",Pae,{unique:!1})}(t))),l}Xr(t){let e=0;return t.store("remoteDocuments").Y((i,r)=>{e+=AD(r)}).next(()=>{const i={byteSize:e};return t.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}Zr(t){const e=t.store("mutationQueues"),i=t.store("mutations");return e.W().next(r=>St.forEach(r,o=>{const l=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return i.W("userMutationsIndex",l).next(f=>St.forEach(f,g=>{gi(g.userId===o.userId);const b=l0(this.serializer,g);return jj(t,o.userId,b).next(()=>{})}))}))}ei(t){const e=t.store("targetDocuments"),i=t.store("remoteDocuments");return t.store("targetGlobal").get("targetGlobalKey").next(r=>{const o=[];return i.Y((l,f)=>{const g=new Nr(l),b=[0,Dl(g)];o.push(e.get(b).next(S=>S?St.resolve():e.put({targetId:0,path:Dl(g),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>St.waitFor(o))})}ti(t,e){t.createObjectStore("collectionParents",{keyPath:Dae});const i=e.store("collectionParents"),r=new sR,o=l=>{if(r.add(l)){const f=l.lastSegment(),g=l.popLast();return i.put({collectionId:f,parent:Dl(g)})}};return e.store("remoteDocuments").Y({J:!0},(l,f)=>{const g=new Nr(l);return o(g.popLast())}).next(()=>e.store("documentMutations").Y({J:!0},([l,f,g],b)=>{const S=If(f);return o(S.popLast())}))}ni(t){const e=t.store("targets");return e.Y((i,r)=>{const o=qw(r),l=Aj(this.serializer,o);return e.put(l)})}ri(t,e){const i=e.store("remoteDocuments"),r=[];return i.Y((o,l)=>{const f=e.store("remoteDocumentsV14"),g=(O=l,O.document?new $n(Nr.fromString(O.document.name).popFirst(5)):O.noDocument?$n.fromSegments(O.noDocument.path):O.unknownDocument?$n.fromSegments(O.unknownDocument.path):ii()).path.toArray(),b={prefixPath:g.slice(0,g.length-2),collectionGroup:g[g.length-2],documentId:g[g.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};var O;r.push(f.put(b))}).next(()=>St.waitFor(r))}ii(t,e){const i=e.store("mutations"),r=Yj(this.serializer),o=new lR(PD.jr,this.serializer.ut);return i.W().next(l=>{const f=new Map;return l.forEach(g=>{var b;let S=null!==(b=f.get(g.userId))&&void 0!==b?b:lr();l0(this.serializer,g).keys().forEach(O=>S=S.add(O)),f.set(g.userId,S)}),St.forEach(f,(g,b)=>{const S=new Ua(b),O=ID.ct(this.serializer,S),$=o.getIndexManager(S),J=SD.ct(S,this.serializer,$,o.referenceDelegate);return new e7(r,J,O,$).recalculateAndSaveOverlaysForDocumentKeys(new Ok(e,Cu._e),g).next()})})}}function t7(n){n.createObjectStore("targetDocuments",{keyPath:Iae}).createIndex("documentTargetsIndex",Tae,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Cae,{unique:!0}),n.createObjectStore("targetGlobal")}const cR="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class uR{constructor(t,e,i,r,o,l,f,g,b,S,O=15){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=i,this.si=o,this.window=l,this.document=f,this.oi=b,this._i=S,this.ai=O,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=$=>Promise.resolve(),!uR.D())throw new gn(jt.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Lle(this,r),this.Ii=e+"main",this.serializer=new Tj(g),this.Ti=new nh(this.Ii,this.ai,new qle(this.serializer)),this.qr=new Rle(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Yj(this.serializer),this.Kr=new Ile,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===S&&qs("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new gn(jt.FAILED_PRECONDITION,cR);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.qr.getHighestSequenceNumber(t))}).then(t=>{this.Lr=new Cu(t,this.oi)}).then(()=>{this.kr=!0}).catch(t=>(this.Ti&&this.Ti.close(),Promise.reject(t)))}mi(t){var e=this;return this.Pi=function(){var i=(0,Jt.Z)(function*(r){if(e.started)return t(r)});return function(r){return i.apply(this,arguments)}}(),t(this.isPrimary)}setDatabaseDeletedListener(t){this.Ti.L(function(){var e=(0,Jt.Z)(function*(i){null===i.newVersion&&(yield t())});return function(i){return e.apply(this,arguments)}}())}setNetworkEnabled(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.si.enqueueAndForget((0,Jt.Z)(function*(){e.started&&(yield e.di())})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>RD(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(t).next(e=>{e||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)))})}).next(()=>this.gi(t)).next(e=>this.isPrimary&&!e?this.pi(t).next(()=>!1):!!e&&this.yi(t).next(()=>!0))).catch(t=>{if(ug(t))return vn("IndexedDbPersistence","Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return vn("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.si.enqueueRetryable(()=>this.Pi(t)),this.isPrimary=t})}fi(t){return Qw(t).get("owner").next(e=>St.resolve(this.wi(e)))}Si(t){return RD(t).delete(this.clientId)}bi(){var t=this;return(0,Jt.Z)(function*(){if(t.isPrimary&&!t.Di(t.hi,18e5)){t.hi=Date.now();const e=yield t.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const r=ja(i,"clientMetadata");return r.W().next(o=>{const l=t.Ci(o,18e5),f=o.filter(g=>-1===l.indexOf(g));return St.forEach(f,g=>r.delete(g.clientId)).next(()=>f)})}).catch(()=>[]);if(t.Ei)for(const i of e)t.Ei.removeItem(t.vi(i.clientId))}})()}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.di().then(()=>this.bi()).then(()=>this.Vi()))}wi(t){return!!t&&t.ownerId===this.clientId}gi(t){return this._i?St.resolve(!0):Qw(t).get("owner").next(e=>{if(null!==e&&this.Di(e.leaseTimestampMs,5e3)&&!this.Fi(e.ownerId)){if(this.wi(e)&&this.networkEnabled)return!0;if(!this.wi(e)){if(!e.allowTabSynchronization)throw new gn(jt.FAILED_PRECONDITION,cR);return!1}}return!(!this.networkEnabled||!this.inForeground)||RD(t).W().next(i=>void 0===this.Ci(i,5e3).find(r=>!(this.clientId===r.clientId||!(!this.networkEnabled&&r.networkEnabled||!this.inForeground&&r.inForeground&&this.networkEnabled===r.networkEnabled))))}).next(e=>(this.isPrimary!==e&&vn("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}shutdown(){var t=this;return(0,Jt.Z)(function*(){t.kr=!1,t.Mi(),t.li&&(t.li.cancel(),t.li=null),t.xi(),t.Oi(),yield t.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const i=new Ok(e,Cu._e);return t.pi(i).next(()=>t.Si(i))}),t.Ti.close(),t.Ni()})()}Ci(t,e){return t.filter(i=>this.Di(i.updateTimeMs,e)&&!this.Fi(i.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",t=>RD(t).W().next(e=>this.Ci(e,18e5).map(i=>i.clientId)))}get started(){return this.kr}getMutationQueue(t,e){return SD.ct(t,this.serializer,e,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new kle(t,this.serializer.ut.databaseId)}getDocumentOverlayCache(t){return ID.ct(this.serializer,t)}getBundleCache(){return this.Kr}runTransaction(t,e,i){vn("IndexedDbPersistence","Starting transaction:",t);const r="readonly"===e?"readonly":"readwrite",o=15===(g=this.ai)?Lae:14===g?pU:13===g?fU:12===g?Fae:11===g?hU:void ii();var g;let l;return this.Ti.runTransaction(t,r,o,f=>(l=new Ok(f,this.Lr?this.Lr.next():Cu._e),"readwrite-primary"===e?this.fi(l).next(g=>!!g||this.gi(l)).next(g=>{if(!g)throw qs(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.Pi(!1)),new gn(jt.FAILED_PRECONDITION,oU);return i(l)}).next(g=>this.yi(l).next(()=>g)):this.Li(l).next(()=>i(l)))).then(f=>(l.raiseOnCommittedEvent(),f))}Li(t){return Qw(t).get("owner").next(e=>{if(null!==e&&this.Di(e.leaseTimestampMs,5e3)&&!this.Fi(e.ownerId)&&!this.wi(e)&&!(this._i||this.allowTabSynchronization&&e.allowTabSynchronization))throw new gn(jt.FAILED_PRECONDITION,cR)})}yi(t){const e={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Qw(t).put("owner",e)}static D(){return nh.D()}pi(t){const e=Qw(t);return e.get("owner").next(i=>this.wi(i)?(vn("IndexedDbPersistence","Releasing primary lease."),e.delete("owner")):St.resolve())}Di(t,e){const i=Date.now();return!(t<i-e||t>i&&(qs(`Detected an update time that is in the future: ${t} > ${i}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.di()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var t;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ui=()=>{this.Mi();const e=/(?:Version|Mobile)\/1[456]/;(0,Do.G6)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(t){var e;try{const i=null!==(null===(e=this.Ei)||void 0===e?void 0:e.getItem(this.vi(t)));return vn("IndexedDbPersistence",`Client '${t}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return qs("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(t){qs("Failed to set zombie client id.",t)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch{}}vi(t){return`firestore_zombie_${this.persistenceKey}_${t}`}}function Qw(n){return ja(n,"owner")}function RD(n){return ja(n,"clientMetadata")}function dR(n,t){let e=n.projectId;return n.isDefaultDatabase||(e+="."+n.database),"firestore/"+t+"/"+e+"/"}class hR{constructor(t,e,i,r){this.targetId=t,this.fromCache=e,this.ki=i,this.qi=r}static Qi(t,e){let i=lr(),r=lr();for(const o of e.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:r=r.add(o.doc.key)}return new hR(t,e.fromCache,i,r)}}class Zle{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class n7{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(t,e){this.Gi=t,this.indexManager=e,this.Ki=!0}getDocumentsMatchingQuery(t,e,i,r){const o={result:null};return this.zi(t,e).next(l=>{o.result=l}).next(()=>{if(!o.result)return this.ji(t,e,r,i).next(l=>{o.result=l})}).next(()=>{if(o.result)return;const l=new Zle;return this.Hi(t,e,l).next(f=>{if(o.result=f,this.$i)return this.Ji(t,e,l,f.size)})}).next(()=>o.result)}Ji(t,e,i,r){return i.documentReadCount<this.Ui?(Fv()<=xf.in.DEBUG&&vn("QueryEngine","SDK will not create cache indexes for query:",Hv(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),St.resolve()):(Fv()<=xf.in.DEBUG&&vn("QueryEngine","Query:",Hv(e),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Wi*r?(Fv()<=xf.in.DEBUG&&vn("QueryEngine","The SDK decides to create cache indexes for query:",Hv(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,sc(e))):St.resolve())}zi(t,e){if(BU(e))return St.resolve(null);let i=sc(e);return this.indexManager.getIndexType(t,i).next(r=>0===r?null:(null!==e.limit&&1===r&&(e=yD(e,null,"F"),i=sc(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next(o=>{const l=lr(...o);return this.Gi.getDocuments(t,l).next(f=>this.indexManager.getMinOffset(t,i).next(g=>{const b=this.Yi(e,f);return this.Zi(e,b,l,g.readTime)?this.zi(t,yD(e,null,"F")):this.Xi(t,b,e,g)}))})))}ji(t,e,i,r){return BU(e)||r.isEqual(xi.min())?St.resolve(null):this.Gi.getDocuments(t,i).next(o=>{const l=this.Yi(e,o);return this.Zi(e,l,i,r)?St.resolve(null):(Fv()<=xf.in.DEBUG&&vn("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Hv(e)),this.Xi(t,l,e,iU(r,-1)).next(f=>f))})}Yi(t,e){let i=new Ao(jU(t));return e.forEach((r,o)=>{Lw(t,o)&&(i=i.add(o))}),i}Zi(t,e,i,r){if(null===t.limit)return!1;if(i.size!==e.size)return!0;const o="F"===t.limitType?e.last():e.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(r)>0)}Hi(t,e,i){return Fv()<=xf.in.DEBUG&&vn("QueryEngine","Using full collection scan to execute query:",Hv(e)),this.Gi.getDocumentsMatchingQuery(t,e,Eu.min(),i)}Xi(t,e,i,r){return this.Gi.getDocumentsMatchingQuery(t,i,r).next(o=>(e.forEach(l=>{o=o.insert(l.key,l)}),o))}}class Kle{constructor(t,e,i,r){this.persistence=t,this.es=e,this.serializer=r,this.ts=new $o(Xi),this.ns=new zp(o=>n0(o),Ow),this.rs=new Map,this.ss=t.getRemoteDocumentCache(),this.qr=t.getTargetCache(),this.Kr=t.getBundleCache(),this.os(i)}os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new e7(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.ts))}}function i7(n,t,e,i){return new Kle(n,t,e,i)}function r7(n,t){return fR.apply(this,arguments)}function fR(){return fR=(0,Jt.Z)(function*(n,t){const e=zn(n);return yield e.persistence.runTransaction("Handle user change","readonly",i=>{let r;return e.mutationQueue.getAllMutationBatches(i).next(o=>(r=o,e.os(t),e.mutationQueue.getAllMutationBatches(i))).next(o=>{const l=[],f=[];let g=lr();for(const b of r){l.push(b.batchId);for(const S of b.mutations)g=g.add(S.key)}for(const b of o){f.push(b.batchId);for(const S of b.mutations)g=g.add(S.key)}return e.localDocuments.getDocuments(i,g).next(b=>({_s:b,removedBatchIds:l,addedBatchIds:f}))})})}),fR.apply(this,arguments)}function o7(n){const t=zn(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.qr.getLastRemoteSnapshotVersion(e))}function s7(n,t,e){let i=lr(),r=lr();return e.forEach(o=>i=i.add(o)),t.getEntries(n,i).next(o=>{let l=Nc();return e.forEach((f,g)=>{const b=o.get(f);g.isFoundDocument()!==b.isFoundDocument()&&(r=r.add(f)),g.isNoDocument()&&g.version.isEqual(xi.min())?(t.removeEntry(f,g.readTime),l=l.insert(f,g)):!b.isValidDocument()||g.version.compareTo(b.version)>0||0===g.version.compareTo(b.version)&&b.hasPendingWrites?(t.addEntry(g),l=l.insert(f,g)):vn("LocalStore","Ignoring outdated watch update for ",f,". Current version:",b.version," Watch version:",g.version)}),{us:l,cs:r}})}function Qle(n,t){const e=zn(n);return e.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function tx(n,t){const e=zn(n);return e.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return e.qr.getTargetData(i,t).next(o=>o?(r=o,St.resolve(r)):e.qr.allocateTargetId(i).next(l=>(r=new jp(t,l,"TargetPurposeListen",i.currentSequenceNumber),e.qr.addTargetData(i,r).next(()=>r))))}).then(i=>{const r=e.ts.get(i.targetId);return(null===r||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(e.ts=e.ts.insert(i.targetId,i),e.ns.set(t,i.targetId)),i})}function nx(n,t,e){return pR.apply(this,arguments)}function pR(){return pR=(0,Jt.Z)(function*(n,t,e){const i=zn(n),r=i.ts.get(t),o=e?"readwrite":"readwrite-primary";try{e||(yield i.persistence.runTransaction("Release target",o,l=>i.persistence.referenceDelegate.removeTarget(l,r)))}catch(l){if(!ug(l))throw l;vn("LocalStore",`Failed to update sequence numbers for target ${t}: ${l}`)}i.ts=i.ts.remove(t),i.ns.delete(r.target)}),pR.apply(this,arguments)}function OD(n,t,e){const i=zn(n);let r=xi.min(),o=lr();return i.persistence.runTransaction("Execute query","readwrite",l=>function(g,b,S){const O=zn(g),$=O.ns.get(S);return void 0!==$?St.resolve(O.ts.get($)):O.qr.getTargetData(b,S)}(i,l,sc(t)).next(f=>{if(f)return r=f.lastLimboFreeSnapshotVersion,i.qr.getMatchingKeysForTargetId(l,f.targetId).next(g=>{o=g})}).next(()=>i.es.getDocumentsMatchingQuery(l,t,e?r:xi.min(),e?o:lr())).next(f=>(c7(i,UU(t),f),{documents:f,ls:o})))}function a7(n,t){const e=zn(n),i=zn(e.qr),r=e.ts.get(t);return r?Promise.resolve(r.target):e.persistence.runTransaction("Get target data","readonly",o=>i._t(o,t).next(l=>l?l.target:null))}function l7(n,t){const e=zn(n),i=e.rs.get(t)||xi.min();return e.persistence.runTransaction("Get new document changes","readonly",r=>e.ss.getAllFromCollectionGroup(r,t,iU(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(c7(e,t,r),r))}function c7(n,t,e){let i=n.rs.get(t)||xi.min();e.forEach((r,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.rs.set(t,i)}function mR(){return mR=(0,Jt.Z)(function*(n,t,e,i){const r=zn(n);let o=lr(),l=Nc();for(const b of e){const S=t.hs(b.metadata.name);b.document&&(o=o.add(S));const O=t.Ps(b);O.setReadTime(t.Is(b.metadata.readTime)),l=l.insert(S,O)}const f=r.ss.newChangeBuffer({trackRemovals:!0}),g=yield tx(r,(S=i,sc(jv(Nr.fromString(`__bundle__/docs/${S}`)))));var S;return r.persistence.runTransaction("Apply bundle documents","readwrite",b=>s7(b,f,l).next(S=>(f.apply(b),S)).next(S=>r.qr.removeMatchingKeysForTargetId(b,g.targetId).next(()=>r.qr.addMatchingKeys(b,o,g.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(b,S.us,S.cs)).next(()=>S.us)))}),mR.apply(this,arguments)}function ece(n,t){return gR.apply(this,arguments)}function gR(){return gR=(0,Jt.Z)(function*(n,t,e=lr()){const i=yield tx(n,sc(eR(t.bundledQuery))),r=zn(n);return r.persistence.runTransaction("Save named query","readwrite",o=>{const l=Zs(t.readTime);if(i.snapshotVersion.compareTo(l)>=0)return r.Kr.saveNamedQuery(o,t);const f=i.withResumeToken(Ta.EMPTY_BYTE_STRING,l);return r.ts=r.ts.insert(f.targetId,f),r.qr.updateTargetData(o,f).next(()=>r.qr.removeMatchingKeysForTargetId(o,i.targetId)).next(()=>r.qr.addMatchingKeys(o,e,i.targetId)).next(()=>r.Kr.saveNamedQuery(o,t))})}),gR.apply(this,arguments)}function u7(n,t){return`firestore_clients_${n}_${t}`}function d7(n,t,e){let i=`firestore_mutations_${n}_${e}`;return t.isAuthenticated()&&(i+=`_${t.uid}`),i}function _R(n,t){return`firestore_targets_${n}_${t}`}class FD{constructor(t,e,i,r){this.user=t,this.batchId=e,this.state=i,this.error=r}static Ts(t,e,i){const r=JSON.parse(i);let o,l="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return l&&r.error&&(l="string"==typeof r.error.message&&"string"==typeof r.error.code,l&&(o=new gn(r.error.code,r.error.message))),l?new FD(t,e,r.state,o):(qs("SharedClientState",`Failed to parse mutation state for ID '${e}': ${i}`),null)}Es(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class Jw{constructor(t,e,i){this.targetId=t,this.state=e,this.error=i}static Ts(t,e){const i=JSON.parse(e);let r,o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(r=new gn(i.error.code,i.error.message))),o?new Jw(t,i.state,r):(qs("SharedClientState",`Failed to parse target state for ID '${t}': ${e}`),null)}Es(){const t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}}class LD{constructor(t,e){this.clientId=t,this.activeTargetIds=e}static Ts(t,e){const i=JSON.parse(e);let r="object"==typeof i&&i.activeTargetIds instanceof Array,o=$k();for(let l=0;r&&l<i.activeTargetIds.length;++l)r=lU(i.activeTargetIds[l]),o=o.add(i.activeTargetIds[l]);return r?new LD(t,o):(qs("SharedClientState",`Failed to parse client data for instance '${t}': ${e}`),null)}}class yR{constructor(t,e){this.clientId=t,this.onlineState=e}static Ts(t){const e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new yR(e.clientId,e.onlineState):(qs("SharedClientState",`Failed to parse online state: ${t}`),null)}}class vR{constructor(){this.activeTargetIds=$k()}ds(t){this.activeTargetIds=this.activeTargetIds.add(t)}As(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Es(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class xR{constructor(t,e,i,r,o){this.window=t,this.si=e,this.persistenceKey=i,this.Rs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new $o(Xi),this.started=!1,this.ps=[];const l=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.ys=u7(this.persistenceKey,this.Rs),this.ws=`firestore_sequence_number_${this.persistenceKey}`,this.gs=this.gs.insert(this.Rs,new vR),this.Ss=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.Cs=`firestore_online_state_${this.persistenceKey}`,this.vs=function(g){return`firestore_bundle_loaded_v2_${g}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(t){return!(!t||!t.localStorage)}start(){var t=this;return(0,Jt.Z)(function*(){const e=yield t.syncEngine.Bi();for(const r of e){if(r===t.Rs)continue;const o=t.getItem(u7(t.persistenceKey,r));if(o){const l=LD.Ts(r,o);l&&(t.gs=t.gs.insert(l.clientId,l))}}t.Fs();const i=t.storage.getItem(t.Cs);if(i){const r=t.Ms(i);r&&t.xs(r)}for(const r of t.ps)t.fs(r);t.ps=[],t.window.addEventListener("pagehide",()=>t.shutdown()),t.started=!0})()}writeSequenceNumber(t){this.setItem(this.ws,JSON.stringify(t))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(t){let e=!1;return this.gs.forEach((i,r)=>{r.activeTargetIds.has(t)&&(e=!0)}),e}addPendingMutation(t){this.Ns(t,"pending")}updateMutationState(t,e,i){this.Ns(t,e,i),this.Bs(t)}addLocalQueryTarget(t){let e="not-current";if(this.isActiveQueryTarget(t)){const i=this.storage.getItem(_R(this.persistenceKey,t));if(i){const r=Jw.Ts(t,i);r&&(e=r.state)}}return this.Ls.ds(t),this.Fs(),e}removeLocalQueryTarget(t){this.Ls.As(t),this.Fs()}isLocalQueryTarget(t){return this.Ls.activeTargetIds.has(t)}clearQueryState(t){this.removeItem(_R(this.persistenceKey,t))}updateQueryState(t,e,i){this.ks(t,e,i)}handleUserChange(t,e,i){e.forEach(r=>{this.Bs(r)}),this.currentUser=t,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(t){this.qs(t)}notifyBundleLoaded(t){this.Qs(t)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(t){const e=this.storage.getItem(t);return vn("SharedClientState","READ",t,e),e}setItem(t,e){vn("SharedClientState","SET",t,e),this.storage.setItem(t,e)}removeItem(t){vn("SharedClientState","REMOVE",t),this.storage.removeItem(t)}fs(t){var e=this;const i=t;if(i.storageArea===this.storage){if(vn("SharedClientState","EVENT",i.key,i.newValue),i.key===this.ys)return void qs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((0,Jt.Z)(function*(){if(e.started){if(null!==i.key)if(e.Ss.test(i.key)){if(null==i.newValue){const r=e.Ks(i.key);return e.$s(r,null)}{const r=e.Us(i.key,i.newValue);if(r)return e.$s(r.clientId,r)}}else if(e.bs.test(i.key)){if(null!==i.newValue){const r=e.Ws(i.key,i.newValue);if(r)return e.Gs(r)}}else if(e.Ds.test(i.key)){if(null!==i.newValue){const r=e.zs(i.key,i.newValue);if(r)return e.js(r)}}else if(i.key===e.Cs){if(null!==i.newValue){const r=e.Ms(i.newValue);if(r)return e.xs(r)}}else if(i.key===e.ws){const r=function(l){let f=Cu._e;if(null!=l)try{const g=JSON.parse(l);gi("number"==typeof g),f=g}catch(g){qs("SharedClientState","Failed to read sequence number from WebStorage",g)}return f}(i.newValue);r!==Cu._e&&e.sequenceNumberHandler(r)}else if(i.key===e.vs){const r=e.Hs(i.newValue);yield Promise.all(r.map(o=>e.syncEngine.Js(o)))}}else e.ps.push(i)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(t,e,i){const r=new FD(this.currentUser,t,e,i),o=d7(this.persistenceKey,this.currentUser,t);this.setItem(o,r.Es())}Bs(t){const e=d7(this.persistenceKey,this.currentUser,t);this.removeItem(e)}qs(t){this.storage.setItem(this.Cs,JSON.stringify({clientId:this.Rs,onlineState:t}))}ks(t,e,i){const r=_R(this.persistenceKey,t),o=new Jw(t,e,i);this.setItem(r,o.Es())}Qs(t){const e=JSON.stringify(Array.from(t));this.setItem(this.vs,e)}Ks(t){const e=this.Ss.exec(t);return e?e[1]:null}Us(t,e){const i=this.Ks(t);return LD.Ts(i,e)}Ws(t,e){const i=this.bs.exec(t),r=Number(i[1]);return FD.Ts(new Ua(void 0!==i[2]?i[2]:null),r,e)}zs(t,e){const i=this.Ds.exec(t),r=Number(i[1]);return Jw.Ts(r,e)}Ms(t){return yR.Ts(t)}Hs(t){return JSON.parse(t)}Gs(t){var e=this;return(0,Jt.Z)(function*(){if(t.user.uid===e.currentUser.uid)return e.syncEngine.Ys(t.batchId,t.state,t.error);vn("SharedClientState",`Ignoring mutation for non-active user ${t.user.uid}`)})()}js(t){return this.syncEngine.Zs(t.targetId,t.state,t.error)}$s(t,e){const i=e?this.gs.insert(t,e):this.gs.remove(t),r=this.Os(this.gs),o=this.Os(i),l=[],f=[];return o.forEach(g=>{r.has(g)||l.push(g)}),r.forEach(g=>{o.has(g)||f.push(g)}),this.syncEngine.Xs(l,f).then(()=>{this.gs=i})}xs(t){this.gs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)}Os(t){let e=$k();return t.forEach((i,r)=>{e=e.unionWith(r.activeTargetIds)}),e}}class h7{constructor(){this.eo=new vR,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t){return this.eo.ds(t),this.no[t]||"not-current"}updateQueryState(t,e,i){this.no[t]=e}removeLocalQueryTarget(t){this.eo.As(t)}isLocalQueryTarget(t){return this.eo.activeTargetIds.has(t)}clearQueryState(t){delete this.no[t]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(t){return this.eo.activeTargetIds.has(t)}start(){return this.eo=new vR,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class tce{ro(t){}shutdown(){}}class f7{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(t){this.ao.push(t)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){vn("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.ao)t(0)}_o(){vn("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.ao)t(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ND=null;function bR(){return null===ND?ND=268435456+Math.round(2147483648*Math.random()):ND++,"0x"+ND.toString(16)}const nce={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ice{constructor(t){this.co=t.co,this.lo=t.lo}ho(t){this.Po=t}Io(t){this.To=t}onMessage(t){this.Eo=t}close(){this.lo()}send(t){this.co(t)}Ao(){this.Po()}Ro(t){this.To(t)}Vo(t){this.Eo(t)}}const Sl="WebChannelConnection";class rce extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const i=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.mo=i+"://"+e.host,this.fo=`projects/${r}/databases/${o}`,this.po="(default)"===this.databaseId.database?`project_id=${r}`:`project_id=${r}&database_id=${o}`}get yo(){return!1}wo(e,i,r,o,l){const f=bR(),g=this.So(e,i);vn("RestConnection",`Sending RPC '${e}' ${f}:`,g,r);const b={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(b,o,l),this.Do(e,g,b,r).then(S=>(vn("RestConnection",`Received RPC '${e}' ${f}: `,S),S),S=>{throw Fc("RestConnection",`RPC '${e}' ${f} failed with error: `,S,"url: ",g,"request:",r),S})}Co(e,i,r,o,l,f){return this.wo(e,i,r,o,l)}bo(e,i,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ov,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((o,l)=>e[l]=o),r&&r.headers.forEach((o,l)=>e[l]=o)}So(e,i){return`${this.mo}/v1/${i}:${nce[e]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Do(t,e,i,r){const o=bR();return new Promise((l,f)=>{const g=new tae;g.setWithCredentials(!0),g.listenOnce(Jse.COMPLETE,()=>{try{switch(g.getLastErrorCode()){case Ak.NO_ERROR:const S=g.getResponseJson();vn(Sl,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(S)),l(S);break;case Ak.TIMEOUT:vn(Sl,`RPC '${t}' ${o} timed out`),f(new gn(jt.DEADLINE_EXCEEDED,"Request time out"));break;case Ak.HTTP_ERROR:const O=g.getStatus();if(vn(Sl,`RPC '${t}' ${o} failed with status:`,O,"response text:",g.getResponseText()),O>0){let $=g.getResponseJson();Array.isArray($)&&($=$[0]);const J=$?.error;if(J&&J.status&&J.message){const ge=function(je){const ft=je.toLowerCase().replace(/_/g,"-");return Object.values(jt).indexOf(ft)>=0?ft:jt.UNKNOWN}(J.status);f(new gn(ge,J.message))}else f(new gn(jt.UNKNOWN,"Server responded with status "+g.getStatus()))}else f(new gn(jt.UNAVAILABLE,"Connection failed."));break;default:ii()}}finally{vn(Sl,`RPC '${t}' ${o} completed.`)}});const b=JSON.stringify(r);vn(Sl,`RPC '${t}' ${o} sending request:`,r),g.send(e,"POST",b,i,15)})}vo(t,e,i){const r=bR(),o=[this.mo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=Xse(),f=Qse(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},b=this.longPollingOptions.timeoutSeconds;void 0!==b&&(g.longPollingTimeout=Math.round(1e3*b)),this.useFetchStreams&&(g.useFetchStreams=!0),this.bo(g.initMessageHeaders,e,i),g.encodeInitMessageHeaders=!0;const S=o.join("");vn(Sl,`Creating RPC '${t}' stream ${r}: ${S}`,g);const O=l.createWebChannel(S,g);let $=!1,J=!1;const ge=new ice({co:je=>{J?vn(Sl,`Not sending because RPC '${t}' stream ${r} is closed:`,je):($||(vn(Sl,`Opening RPC '${t}' stream ${r} transport.`),O.open(),$=!0),vn(Sl,`RPC '${t}' stream ${r} sending:`,je),O.send(je))},lo:()=>O.close()}),Ce=(je,ft,ot)=>{je.listen(ft,It=>{try{ot(It)}catch(Yt){setTimeout(()=>{throw Yt},0)}})};return Ce(O,aD.EventType.OPEN,()=>{J||vn(Sl,`RPC '${t}' stream ${r} transport opened.`)}),Ce(O,aD.EventType.CLOSE,()=>{J||(J=!0,vn(Sl,`RPC '${t}' stream ${r} transport closed`),ge.Ro())}),Ce(O,aD.EventType.ERROR,je=>{J||(J=!0,Fc(Sl,`RPC '${t}' stream ${r} transport errored:`,je),ge.Ro(new gn(jt.UNAVAILABLE,"The operation could not be completed")))}),Ce(O,aD.EventType.MESSAGE,je=>{var ft;if(!J){const ot=je.data[0];gi(!!ot);const Yt=ot.error||(null===(ft=ot[0])||void 0===ft?void 0:ft.error);if(Yt){vn(Sl,`RPC '${t}' stream ${r} received error:`,Yt);const yn=Yt.status;let ai=function(Ha){const Bc=ua[Ha];if(void 0!==Bc)return sj(Bc)}(yn),Ri=Yt.message;void 0===ai&&(ai=jt.INTERNAL,Ri="Unknown error status: "+yn+" with message "+Yt.message),J=!0,ge.Ro(new gn(ai,Ri)),O.close()}else vn(Sl,`RPC '${t}' stream ${r} received:`,ot),ge.Vo(ot)}}),Ce(f,eae.STAT_EVENT,je=>{je.stat===X8.PROXY?vn(Sl,`RPC '${t}' stream ${r} detected buffering proxy`):je.stat===X8.NOPROXY&&vn(Sl,`RPC '${t}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{ge.Ao()},0),ge}}function p7(){return typeof window<"u"?window:null}function BD(){return typeof document<"u"?document:null}function eE(n){return new ple(n,!0)}class wR{constructor(t,e,i=1e3,r=1.5,o=6e4){this.si=t,this.timerId=e,this.Fo=i,this.Mo=r,this.xo=o,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(t){this.cancel();const e=Math.floor(this.Oo+this.qo()),i=Math.max(0,Date.now()-this.Bo),r=Math.max(0,e-i);r>0&&vn("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Oo} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,r,()=>(this.Bo=Date.now(),t())),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class m7{constructor(t,e,i,r,o,l,f,g){this.si=t,this.Ko=i,this.$o=r,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=f,this.listener=g,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new wR(t,e)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}stop(){var t=this;return(0,Jt.Z)(function*(){t.jo()&&(yield t.close(0))})()}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,()=>this.Xo()))}e_(t){this.t_(),this.stream.send(t)}Xo(){var t=this;return(0,Jt.Z)(function*(){if(t.Ho())return t.close(0)})()}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}close(t,e){var i=this;return(0,Jt.Z)(function*(){i.t_(),i.n_(),i.zo.cancel(),i.Uo++,4!==t?i.zo.reset():e&&e.code===jt.RESOURCE_EXHAUSTED?(qs(e.toString()),qs("Using maximum backoff delay to prevent overloading the backend."),i.zo.Lo()):e&&e.code===jt.UNAUTHENTICATED&&3!==i.state&&(i.authCredentialsProvider.invalidateToken(),i.appCheckCredentialsProvider.invalidateToken()),null!==i.stream&&(i.r_(),i.stream.close(),i.stream=null),i.state=t,yield i.listener.Io(e)})()}r_(){}auth(){this.state=1;const t=this.i_(this.Uo),e=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Uo===e&&this.s_(i,r)},i=>{t(()=>{const r=new gn(jt.UNKNOWN,"Fetching auth token failed: "+i.message);return this.o_(r)})})}s_(t,e){const i=this.i_(this.Uo);this.stream=this.__(t,e),this.stream.ho(()=>{i(()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,()=>(this.Ho()&&(this.state=3),Promise.resolve())),this.listener.ho()))}),this.stream.Io(r=>{i(()=>this.o_(r))}),this.stream.onMessage(r=>{i(()=>this.onMessage(r))})}Jo(){var t=this;this.state=5,this.zo.ko((0,Jt.Z)(function*(){t.state=0,t.start()}))}o_(t){return vn("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}i_(t){return e=>{this.si.enqueueAndForget(()=>this.Uo===t?e():(vn("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class oce extends m7{constructor(t,e,i,r,o,l){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,r,l),this.serializer=o}__(t,e){return this.connection.vo("Listen",t,e)}onMessage(t){this.zo.reset();const e=function _le(n,t){let e;if("targetChange"in t){const i="NO_CHANGE"===(b=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===b?1:"REMOVE"===b?2:"CURRENT"===b?3:"RESET"===b?4:ii(),r=t.targetChange.targetIds||[],o=function(b,S){return b.useProto3Json?(gi(void 0===S||"string"==typeof S),Ta.fromBase64String(S||"")):(gi(void 0===S||S instanceof Uint8Array),Ta.fromUint8Array(S||new Uint8Array))}(n,t.targetChange.resumeToken),l=t.targetChange.cause,f=l&&function(b){const S=void 0===b.code?jt.UNKNOWN:sj(b.code);return new gn(S,b.message||"")}(l);e=new dj(i,r,o,f||null)}else if("documentChange"in t){const i=t.documentChange,r=Af(n,i.document.name),o=Zs(i.document.updateTime),l=i.document.createTime?Zs(i.document.createTime):xi.min(),f=new ll({mapValue:{fields:i.document.fields}}),g=ns.newFoundDocument(r,o,l,f);e=new ED(i.targetIds||[],i.removedTargetIds||[],g.key,g)}else if("documentDelete"in t){const i=t.documentDelete,r=Af(n,i.document),o=i.readTime?Zs(i.readTime):xi.min(),l=ns.newNoDocument(r,o);e=new ED([],i.removedTargetIds||[],l.key,l)}else if("documentRemove"in t){const i=t.documentRemove,r=Af(n,i.document);e=new ED([],i.removedTargetIds||[],r,null)}else{if(!("filter"in t))return ii();{const i=t.filter,{count:r=0,unchangedNames:o}=i,l=new lle(r,o);e=new uj(i.targetId,l)}}var b;return e}(this.serializer,t),i=function(o){if(!("targetChange"in o))return xi.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?xi.min():l.readTime?Zs(l.readTime):xi.min()}(t);return this.listener.a_(e,i)}u_(t){const e={};e.database=Gw(this.serializer),e.addTarget=function(o,l){let f;const g=l.target;if(f=gD(g)?{documents:bj(o,g)}:{query:Jk(o,g)},f.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){f.resumeToken=mj(o,l.resumeToken);const b=Kk(o,l.expectedCount);null!==b&&(f.expectedCount=b)}else if(l.snapshotVersion.compareTo(xi.min())>0){f.readTime=Kv(o,l.snapshotVersion.toTimestamp());const b=Kk(o,l.expectedCount);null!==b&&(f.expectedCount=b)}return f}(this.serializer,t);const i=function vle(n,t){const e=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ii()}}(t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);i&&(e.labels=i),this.e_(e)}c_(t){const e={};e.database=Gw(this.serializer),e.removeTarget=t,this.e_(e)}}class sce extends m7{constructor(t,e,i,r,o,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,r,l),this.serializer=o,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(t,e){return this.connection.vo("Write",t,e)}onMessage(t){if(gi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.l_){this.zo.reset();const e=function yle(n,t){return n&&n.length>0?(gi(void 0!==t),n.map(e=>function(r,o){let l=Zs(r.updateTime?r.updateTime:o);return l.isEqual(xi.min())&&(l=Zs(o)),new rle(l,r.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),i=Zs(t.commitTime);return this.listener.I_(i,e)}return gi(!t.writeResults||0===t.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const t={};t.database=Gw(this.serializer),this.e_(t)}P_(t){const e={streamToken:this.lastStreamToken,writes:t.map(i=>Ww(this.serializer,i))};this.e_(e)}}class ace extends class{}{constructor(t,e,i,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=r,this.d_=!1}A_(){if(this.d_)throw new gn(jt.FAILED_PRECONDITION,"The client has already been terminated.")}wo(t,e,i){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.wo(t,e,i,r,o)).catch(r=>{throw"FirebaseError"===r.name?(r.code===jt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new gn(jt.UNKNOWN,r.toString())})}Co(t,e,i,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Co(t,e,i,o,l,r)).catch(o=>{throw"FirebaseError"===o.name?(o.code===jt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new gn(jt.UNKNOWN,o.toString())})}terminate(){this.d_=!0}}class cce{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve())))}w_(t){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.p_("Offline")))}set(t){this.S_(),this.V_=0,"Online"===t&&(this.f_=!1),this.p_(t)}p_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}y_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(qs(e),this.f_=!1):vn("OnlineStateTracker",e)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class uce{constructor(t,e,i,r,o){var l=this;this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=o,this.F_.ro(f=>{i.enqueueAndForget((0,Jt.Z)(function*(){var g;wg(l)&&(vn("RemoteStore","Restarting streams for network reachability change."),yield(g=(0,Jt.Z)(function*(S){const O=zn(S);O.C_.add(4),yield ix(O),O.M_.set("Unknown"),O.C_.delete(4),yield tE(O)}),function b(S){return g.apply(this,arguments)})(l))}))}),this.M_=new cce(i,r)}}function tE(n){return CR.apply(this,arguments)}function CR(){return CR=(0,Jt.Z)(function*(n){if(wg(n))for(const t of n.v_)yield t(!0)}),CR.apply(this,arguments)}function ix(n){return IR.apply(this,arguments)}function IR(){return IR=(0,Jt.Z)(function*(n){for(const t of n.v_)yield t(!1)}),IR.apply(this,arguments)}function VD(n,t){const e=zn(n);e.D_.has(t.targetId)||(e.D_.set(t.targetId,t),AR(e)?DR(e):ox(e).Ho()&&TR(e,t))}function nE(n,t){const e=zn(n),i=ox(e);e.D_.delete(t),i.Ho()&&g7(e,t),0===e.D_.size&&(i.Ho()?i.Zo():wg(e)&&e.M_.set("Unknown"))}function TR(n,t){if(n.x_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(xi.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}ox(n).u_(t)}function g7(n,t){n.x_.Oe(t),ox(n).c_(t)}function DR(n){n.x_=new ule({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>n.D_.get(t)||null,nt:()=>n.datastore.serializer.databaseId}),ox(n).start(),n.M_.g_()}function AR(n){return wg(n)&&!ox(n).jo()&&n.D_.size>0}function wg(n){return 0===zn(n).C_.size}function _7(n){n.x_=void 0}function dce(n){return SR.apply(this,arguments)}function SR(){return SR=(0,Jt.Z)(function*(n){n.D_.forEach((t,e)=>{TR(n,t)})}),SR.apply(this,arguments)}function hce(n,t){return MR.apply(this,arguments)}function MR(){return MR=(0,Jt.Z)(function*(n,t){_7(n),AR(n)?(n.M_.w_(t),DR(n)):n.M_.set("Unknown")}),MR.apply(this,arguments)}function fce(n,t,e){return PR.apply(this,arguments)}function PR(){return PR=(0,Jt.Z)(function*(n,t,e){if(n.M_.set("Online"),t instanceof dj&&2===t.state&&t.cause)try{yield(i=(0,Jt.Z)(function*(o,l){const f=l.cause;for(const g of l.targetIds)o.D_.has(g)&&(yield o.remoteSyncer.rejectListen(g,f),o.D_.delete(g),o.x_.removeTarget(g))}),function r(o,l){return i.apply(this,arguments)})(n,t)}catch(i){vn("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),yield zD(n,i)}else if(t instanceof ED?n.x_.$e(t):t instanceof uj?n.x_.Je(t):n.x_.Ge(t),!e.isEqual(xi.min()))try{const i=yield o7(n.localStore);e.compareTo(i)>=0&&(yield function(o,l){const f=o.x_.it(l);return f.targetChanges.forEach((g,b)=>{if(g.resumeToken.approximateByteSize()>0){const S=o.D_.get(b);S&&o.D_.set(b,S.withResumeToken(g.resumeToken,l))}}),f.targetMismatches.forEach((g,b)=>{const S=o.D_.get(g);if(!S)return;o.D_.set(g,S.withResumeToken(Ta.EMPTY_BYTE_STRING,S.snapshotVersion)),g7(o,g);const O=new jp(S.target,g,b,S.sequenceNumber);TR(o,O)}),o.remoteSyncer.applyRemoteEvent(f)}(n,e))}catch(i){vn("RemoteStore","Failed to raise snapshot:",i),yield zD(n,i)}var i}),PR.apply(this,arguments)}function zD(n,t,e){return kR.apply(this,arguments)}function kR(){return kR=(0,Jt.Z)(function*(n,t,e){if(!ug(t))throw t;n.C_.add(1),yield ix(n),n.M_.set("Offline"),e||(e=()=>o7(n.localStore)),n.asyncQueue.enqueueRetryable((0,Jt.Z)(function*(){vn("RemoteStore","Retrying IndexedDB access"),yield e(),n.C_.delete(1),yield tE(n)}))}),kR.apply(this,arguments)}function y7(n,t){return t().catch(e=>zD(n,e,t))}function rx(n){return RR.apply(this,arguments)}function RR(){return RR=(0,Jt.Z)(function*(n){const t=zn(n),e=Eg(t);let i=t.b_.length>0?t.b_[t.b_.length-1].batchId:-1;for(;pce(t);)try{const r=yield Qle(t.localStore,i);if(null===r){0===t.b_.length&&e.Zo();break}i=r.batchId,mce(t,r)}catch(r){yield zD(t,r)}v7(t)&&x7(t)}),RR.apply(this,arguments)}function pce(n){return wg(n)&&n.b_.length<10}function mce(n,t){n.b_.push(t);const e=Eg(n);e.Ho()&&e.h_&&e.P_(t.mutations)}function v7(n){return wg(n)&&!Eg(n).jo()&&n.b_.length>0}function x7(n){Eg(n).start()}function gce(n){return OR.apply(this,arguments)}function OR(){return OR=(0,Jt.Z)(function*(n){Eg(n).E_()}),OR.apply(this,arguments)}function _ce(n){return FR.apply(this,arguments)}function FR(){return FR=(0,Jt.Z)(function*(n){const t=Eg(n);for(const e of n.b_)t.P_(e.mutations)}),FR.apply(this,arguments)}function yce(n,t,e){return LR.apply(this,arguments)}function LR(){return LR=(0,Jt.Z)(function*(n,t,e){const i=n.b_.shift(),r=Wk.from(i,t,e);yield y7(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield rx(n)}),LR.apply(this,arguments)}function vce(n,t){return NR.apply(this,arguments)}function NR(){return NR=(0,Jt.Z)(function*(n,t){var e;t&&Eg(n).h_&&(yield(e=(0,Jt.Z)(function*(r,o){if(oj(f=o.code)&&f!==jt.ABORTED){const l=r.b_.shift();Eg(r).Yo(),yield y7(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,o)),yield rx(r)}var f}),function i(r,o){return e.apply(this,arguments)})(n,t)),v7(n)&&x7(n)}),NR.apply(this,arguments)}function b7(n,t){return BR.apply(this,arguments)}function BR(){return BR=(0,Jt.Z)(function*(n,t){const e=zn(n);e.asyncQueue.verifyOperationInProgress(),vn("RemoteStore","RemoteStore received new credentials");const i=wg(e);e.C_.add(3),yield ix(e),i&&e.M_.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e.C_.delete(3),yield tE(e)}),BR.apply(this,arguments)}function VR(n,t){return zR.apply(this,arguments)}function zR(){return zR=(0,Jt.Z)(function*(n,t){const e=zn(n);t?(e.C_.delete(2),yield tE(e)):t||(e.C_.add(2),yield ix(e),e.M_.set("Unknown"))}),zR.apply(this,arguments)}function ox(n){return n.O_||(n.O_=function(e,i,r){const o=zn(e);return o.A_(),new oce(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(n.datastore,n.asyncQueue,{ho:dce.bind(null,n),Io:hce.bind(null,n),a_:fce.bind(null,n)}),n.v_.push(function(){var t=(0,Jt.Z)(function*(e){e?(n.O_.Yo(),AR(n)?DR(n):n.M_.set("Unknown")):(yield n.O_.stop(),_7(n))});return function(e){return t.apply(this,arguments)}}())),n.O_}function Eg(n){return n.N_||(n.N_=function(e,i,r){const o=zn(e);return o.A_(),new sce(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,r)}(n.datastore,n.asyncQueue,{ho:gce.bind(null,n),Io:vce.bind(null,n),T_:_ce.bind(null,n),I_:yce.bind(null,n)}),n.v_.push(function(){var t=(0,Jt.Z)(function*(e){e?(n.N_.Yo(),yield rx(n)):(yield n.N_.stop(),n.b_.length>0&&(vn("RemoteStore",`Stopping write stream with ${n.b_.length} pending writes`),n.b_=[]))});return function(e){return t.apply(this,arguments)}}())),n.N_}class UR{constructor(t,e,i,r,o){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=r,this.removalCallback=o,this.deferred=new Ia,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,r,o){const l=Date.now()+i,f=new UR(t,e,l,r,o);return f.start(i),f}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new gn(jt.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sx(n,t){if(qs("AsyncQueue",`${t}: ${n}`),ug(n))return new gn(jt.UNAVAILABLE,`${t}: ${n}`);throw n}class ax{constructor(t){this.comparator=t?(e,i)=>t(e,i)||$n.comparator(e.key,i.key):(e,i)=>$n.comparator(e.key,i.key),this.keyedMap=Nw(),this.sortedSet=new $o(this.comparator)}static emptySet(t){return new ax(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,i)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof ax)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const r=e.getNext().key,o=i.getNext().key;if(!r.isEqual(o))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const i=new ax;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}class w7{constructor(){this.B_=new $o($n.comparator)}track(t){const e=t.doc.key,i=this.B_.get(e);i?0!==t.type&&3===i.type?this.B_=this.B_.insert(e,t):3===t.type&&1!==i.type?this.B_=this.B_.insert(e,{type:i.type,doc:t.doc}):2===t.type&&2===i.type?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):2===t.type&&0===i.type?this.B_=this.B_.insert(e,{type:0,doc:t.doc}):1===t.type&&0===i.type?this.B_=this.B_.remove(e):1===t.type&&2===i.type?this.B_=this.B_.insert(e,{type:1,doc:i.doc}):0===t.type&&1===i.type?this.B_=this.B_.insert(e,{type:2,doc:t.doc}):ii():this.B_=this.B_.insert(e,t)}L_(){const t=[];return this.B_.inorderTraversal((e,i)=>{t.push(i)}),t}}class lx{constructor(t,e,i,r,o,l,f,g,b){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=f,this.excludesMetadataChanges=g,this.hasCachedResults=b}static fromInitialDocuments(t,e,i,r,o){const l=[];return e.forEach(f=>{l.push({type:0,doc:f})}),new lx(t,e,ax.emptySet(e),l,i,r,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Fw(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(e[r].type!==i[r].type||!e[r].doc.isEqual(i[r].doc))return!1;return!0}}class xce{constructor(){this.k_=void 0,this.listeners=[]}}class bce{constructor(){this.queries=new zp(t=>zU(t),Fw),this.onlineState="Unknown",this.q_=new Set}}function jR(n,t){return $R.apply(this,arguments)}function $R(){return $R=(0,Jt.Z)(function*(n,t){const e=zn(n),i=t.query;let r=!1,o=e.queries.get(i);if(o||(r=!0,o=new xce),r)try{o.k_=yield e.onListen(i)}catch(l){const f=sx(l,`Initialization of query '${Hv(t.query)}' failed`);return void t.onError(f)}e.queries.set(i,o),o.listeners.push(t),t.Q_(e.onlineState),o.k_&&t.K_(o.k_)&&WR(e)}),$R.apply(this,arguments)}function HR(n,t){return GR.apply(this,arguments)}function GR(){return GR=(0,Jt.Z)(function*(n,t){const e=zn(n),i=t.query;let r=!1;const o=e.queries.get(i);if(o){const l=o.listeners.indexOf(t);l>=0&&(o.listeners.splice(l,1),r=0===o.listeners.length)}if(r)return e.queries.delete(i),e.onUnlisten(i)}),GR.apply(this,arguments)}function wce(n,t){const e=zn(n);let i=!1;for(const r of t){const l=e.queries.get(r.query);if(l){for(const f of l.listeners)f.K_(r)&&(i=!0);l.k_=r}}i&&WR(e)}function Ece(n,t,e){const i=zn(n),r=i.queries.get(t);if(r)for(const o of r.listeners)o.onError(e);i.queries.delete(t)}function WR(n){n.q_.forEach(t=>{t.next()})}class qR{constructor(t,e,i){this.query=t,this.U_=e,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=i||{}}K_(t){if(!this.options.includeMetadataChanges){const i=[];for(const r of t.docChanges)3!==r.type&&i.push(r);t=new lx(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.W_?this.z_(t)&&(this.U_.next(t),e=!0):this.j_(t,this.onlineState)&&(this.H_(t),e=!0),this.G_=t,e}onError(t){this.U_.error(t)}Q_(t){this.onlineState=t;let e=!1;return this.G_&&!this.W_&&this.j_(this.G_,t)&&(this.H_(this.G_),e=!0),e}j_(t,e){return!t.fromCache||(!this.options.J_||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}z_(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.G_&&this.G_.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}H_(t){t=lx.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.W_=!0,this.U_.next(t)}}class Cce{constructor(t,e){this.Y_=t,this.byteLength=e}Z_(){return"metadata"in this.Y_}}class E7{constructor(t){this.serializer=t}hs(t){return Af(this.serializer,t)}Ps(t){return t.metadata.exists?xj(this.serializer,t.document,!1):ns.newNoDocument(this.hs(t.metadata.name),this.Is(t.metadata.readTime))}Is(t){return Zs(t)}}class Ice{constructor(t,e,i){this.X_=t,this.localStore=e,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=C7(t)}ea(t){this.progress.bytesLoaded+=t.byteLength;let e=this.progress.documentsLoaded;if(t.Y_.namedQuery)this.queries.push(t.Y_.namedQuery);else if(t.Y_.documentMetadata){this.documents.push({metadata:t.Y_.documentMetadata}),t.Y_.documentMetadata.exists||++e;const i=Nr.fromString(t.Y_.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else t.Y_.document&&(this.documents[this.documents.length-1].document=t.Y_.document,++e);return e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null}ta(t){const e=new Map,i=new E7(this.serializer);for(const r of t)if(r.metadata.queries){const o=i.hs(r.metadata.name);for(const l of r.metadata.queries){const f=(e.get(l)||lr()).add(o);e.set(l,f)}}return e}complete(){var t=this;return(0,Jt.Z)(function*(){const e=yield function Jle(n,t,e,i){return mR.apply(this,arguments)}(t.localStore,new E7(t.serializer),t.documents,t.X_.id),i=t.ta(t.documents);for(const r of t.queries)yield ece(t.localStore,r,i.get(r.name));return t.progress.taskState="Success",{progress:t.progress,na:t.collectionGroups,ra:e}})()}}function C7(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class I7{constructor(t){this.key=t}}class T7{constructor(t){this.key=t}}class D7{constructor(t,e){this.query=t,this.ia=e,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=lr(),this.mutatedKeys=lr(),this._a=jU(t),this.aa=new ax(this._a)}get ua(){return this.ia}ca(t,e){const i=e?e.la:new w7,r=e?e.aa:this.aa;let o=e?e.mutatedKeys:this.mutatedKeys,l=r,f=!1;const g="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,b="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((S,O)=>{const $=r.get(S),J=Lw(this.query,O)?O:null,ge=!!$&&this.mutatedKeys.has($.key),Ce=!!J&&(J.hasLocalMutations||this.mutatedKeys.has(J.key)&&J.hasCommittedMutations);let je=!1;$&&J?$.data.isEqual(J.data)?ge!==Ce&&(i.track({type:3,doc:J}),je=!0):this.ha($,J)||(i.track({type:2,doc:J}),je=!0,(g&&this._a(J,g)>0||b&&this._a(J,b)<0)&&(f=!0)):!$&&J?(i.track({type:0,doc:J}),je=!0):$&&!J&&(i.track({type:1,doc:$}),je=!0,(g||b)&&(f=!0)),je&&(J?(l=l.add(J),o=Ce?o.add(S):o.delete(S)):(l=l.delete(S),o=o.delete(S)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const S="F"===this.query.limitType?l.last():l.first();l=l.delete(S.key),o=o.delete(S.key),i.track({type:1,doc:S})}return{aa:l,la:i,Zi:f,mutatedKeys:o}}ha(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i,r){const o=this.aa;this.aa=t.aa,this.mutatedKeys=t.mutatedKeys;const l=t.la.L_();l.sort((S,O)=>function(J,ge){const Ce=je=>{switch(je){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ii()}};return Ce(J)-Ce(ge)}(S.type,O.type)||this._a(S.doc,O.doc)),this.Pa(i),r=null!=r&&r;const f=e&&!r?this.Ia():[],g=0===this.oa.size&&this.current&&!r?1:0,b=g!==this.sa;return this.sa=g,0!==l.length||b?{snapshot:new lx(this.query,t.aa,o,l,t.mutatedKeys,0===g,b,!1,!!i&&i.resumeToken.approximateByteSize()>0),Ta:f}:{Ta:f}}Q_(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({aa:this.aa,la:new w7,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(t){return!this.ia.has(t)&&!!this.aa.has(t)&&!this.aa.get(t).hasLocalMutations}Pa(t){t&&(t.addedDocuments.forEach(e=>this.ia=this.ia.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.ia=this.ia.delete(e)),this.current=t.current)}Ia(){if(!this.current)return[];const t=this.oa;this.oa=lr(),this.aa.forEach(i=>{this.Ea(i.key)&&(this.oa=this.oa.add(i.key))});const e=[];return t.forEach(i=>{this.oa.has(i)||e.push(new T7(i))}),this.oa.forEach(i=>{t.has(i)||e.push(new I7(i))}),e}da(t){this.ia=t.ls,this.oa=lr();const e=this.ca(t.documents);return this.applyChanges(e,!0)}Aa(){return lx.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class Tce{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class Dce{constructor(t){this.key=t,this.Ra=!1}}class Ace{constructor(t,e,i,r,o,l){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=r,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Va={},this.ma=new zp(f=>zU(f),Fw),this.fa=new Map,this.ga=new Set,this.pa=new $o($n.comparator),this.ya=new Map,this.wa=new aR,this.Sa={},this.ba=new Map,this.Da=d0.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}function Sce(n,t){return ZR.apply(this,arguments)}function ZR(){return ZR=(0,Jt.Z)(function*(n,t){const e=_O(n);let i,r;const o=e.ma.get(t);if(o)i=o.targetId,e.sharedClientState.addLocalQueryTarget(i),r=o.view.Aa();else{const l=yield tx(e.localStore,sc(t)),f=e.sharedClientState.addLocalQueryTarget(l.targetId);i=l.targetId,r=yield KR(e,t,i,"current"===f,l.resumeToken),e.isPrimaryClient&&VD(e.remoteStore,l)}return r}),ZR.apply(this,arguments)}function KR(n,t,e,i,r){return YR.apply(this,arguments)}function YR(){return YR=(0,Jt.Z)(function*(n,t,e,i,r){n.va=(O,$,J)=>{return(ge=(0,Jt.Z)(function*(je,ft,ot,It){let Yt=ft.view.ca(ot);Yt.Zi&&(Yt=yield OD(je.localStore,ft.query,!1).then(({documents:Qr})=>ft.view.ca(Qr,Yt)));const yn=It&&It.targetChanges.get(ft.targetId),ai=It&&null!=It.targetMismatches.get(ft.targetId),Ri=ft.view.applyChanges(Yt,je.isPrimaryClient,yn,ai);return sO(je,ft.targetId,Ri.Ta),Ri.snapshot}),function Ce(je,ft,ot,It){return ge.apply(this,arguments)})(n,O,$,J);var ge};const o=yield OD(n.localStore,t,!0),l=new D7(t,o.ls),f=l.ca(o.documents),g=$w.createSynthesizedTargetChangeForCurrentChange(e,i&&"Offline"!==n.onlineState,r),b=l.applyChanges(f,n.isPrimaryClient,g);sO(n,e,b.Ta);const S=new Tce(t,e,l);return n.ma.set(t,S),n.fa.has(e)?n.fa.get(e).push(t):n.fa.set(e,[t]),b.snapshot}),YR.apply(this,arguments)}function Mce(n,t){return XR.apply(this,arguments)}function XR(){return XR=(0,Jt.Z)(function*(n,t){const e=zn(n),i=e.ma.get(t),r=e.fa.get(i.targetId);if(r.length>1)return e.fa.set(i.targetId,r.filter(o=>!Fw(o,t))),void e.ma.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(i.targetId),e.sharedClientState.isActiveQueryTarget(i.targetId)||(yield nx(e.localStore,i.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(i.targetId),nE(e.remoteStore,i.targetId),cx(e,i.targetId)}).catch(cg))):(cx(e,i.targetId),yield nx(e.localStore,i.targetId,!0))}),XR.apply(this,arguments)}function QR(){return QR=(0,Jt.Z)(function*(n,t,e){const i=yO(n);try{const r=yield function(l,f){const g=zn(l),b=es.now(),S=f.reduce((J,ge)=>J.add(ge.key),lr());let O,$;return g.persistence.runTransaction("Locally write mutations","readwrite",J=>{let ge=Nc(),Ce=lr();return g.ss.getEntries(J,S).next(je=>{ge=je,ge.forEach((ft,ot)=>{ot.isValidDocument()||(Ce=Ce.add(ft))})}).next(()=>g.localDocuments.getOverlayedDocuments(J,ge)).next(je=>{O=je;const ft=[];for(const ot of f){const It=sle(ot,O.get(ot.key).overlayedDocument);null!=It&&ft.push(new Up(ot.key,It,IU(It.value.mapValue),vs.exists(!0)))}return g.mutationQueue.addMutationBatch(J,b,ft,f)}).next(je=>{$=je;const ft=je.applyToLocalDocumentSet(O,Ce);return g.documentOverlayCache.saveOverlays(J,je.batchId,ft)})}).then(()=>({batchId:$.batchId,changes:HU(O)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(r.batchId),function(l,f,g){let b=l.Sa[l.currentUser.toKey()];b||(b=new $o(Xi)),b=b.insert(f,g),l.Sa[l.currentUser.toKey()]=b}(i,r.batchId,e),yield $p(i,r.changes),yield rx(i.remoteStore)}catch(r){const o=sx(r,"Failed to persist write");e.reject(o)}}),QR.apply(this,arguments)}function A7(n,t){return JR.apply(this,arguments)}function JR(){return JR=(0,Jt.Z)(function*(n,t){const e=zn(n);try{const i=yield function Xle(n,t){const e=zn(n),i=t.snapshotVersion;let r=e.ts;return e.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const l=e.ss.newChangeBuffer({trackRemovals:!0});r=e.ts;const f=[];t.targetChanges.forEach((S,O)=>{const $=r.get(O);if(!$)return;f.push(e.qr.removeMatchingKeys(o,S.removedDocuments,O).next(()=>e.qr.addMatchingKeys(o,S.addedDocuments,O)));let J=$.withSequenceNumber(o.currentSequenceNumber);var Ce,je,ft;null!==t.targetMismatches.get(O)?J=J.withResumeToken(Ta.EMPTY_BYTE_STRING,xi.min()).withLastLimboFreeSnapshotVersion(xi.min()):S.resumeToken.approximateByteSize()>0&&(J=J.withResumeToken(S.resumeToken,i)),r=r.insert(O,J),je=J,ft=S,(0===(Ce=$).resumeToken.approximateByteSize()||je.snapshotVersion.toMicroseconds()-Ce.snapshotVersion.toMicroseconds()>=3e8||ft.addedDocuments.size+ft.modifiedDocuments.size+ft.removedDocuments.size>0)&&f.push(e.qr.updateTargetData(o,J))});let g=Nc(),b=lr();if(t.documentUpdates.forEach(S=>{t.resolvedLimboDocuments.has(S)&&f.push(e.persistence.referenceDelegate.updateLimboDocument(o,S))}),f.push(s7(o,l,t.documentUpdates).next(S=>{g=S.us,b=S.cs})),!i.isEqual(xi.min())){const S=e.qr.getLastRemoteSnapshotVersion(o).next(O=>e.qr.setTargetsMetadata(o,o.currentSequenceNumber,i));f.push(S)}return St.waitFor(f).next(()=>l.apply(o)).next(()=>e.localDocuments.getLocalViewOfDocuments(o,g,b)).next(()=>g)}).then(o=>(e.ts=r,o))}(e.localStore,t);t.targetChanges.forEach((r,o)=>{const l=e.ya.get(o);l&&(gi(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?l.Ra=!0:r.modifiedDocuments.size>0?gi(l.Ra):r.removedDocuments.size>0&&(gi(l.Ra),l.Ra=!1))}),yield $p(e,i,t)}catch(i){yield cg(i)}}),JR.apply(this,arguments)}function S7(n,t,e){const i=zn(n);if(i.isPrimaryClient&&0===e||!i.isPrimaryClient&&1===e){const r=[];i.ma.forEach((o,l)=>{const f=l.view.Q_(t);f.snapshot&&r.push(f.snapshot)}),function(l,f){const g=zn(l);g.onlineState=f;let b=!1;g.queries.forEach((S,O)=>{for(const $ of O.listeners)$.Q_(f)&&(b=!0)}),b&&WR(g)}(i.eventManager,t),r.length&&i.Va.a_(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}function kce(n,t,e){return eO.apply(this,arguments)}function eO(){return eO=(0,Jt.Z)(function*(n,t,e){const i=zn(n);i.sharedClientState.updateQueryState(t,"rejected",e);const r=i.ya.get(t),o=r&&r.key;if(o){let l=new $o($n.comparator);l=l.insert(o,ns.newNoDocument(o,xi.min()));const f=lr().add(o),g=new jw(xi.min(),new Map,new $o(Xi),l,f);yield A7(i,g),i.pa=i.pa.remove(o),i.ya.delete(t),aO(i)}else yield nx(i.localStore,t,!1).then(()=>cx(i,t,e)).catch(cg)}),eO.apply(this,arguments)}function Rce(n,t){return tO.apply(this,arguments)}function tO(){return tO=(0,Jt.Z)(function*(n,t){const e=zn(n),i=t.batch.batchId;try{const r=yield function Yle(n,t){const e=zn(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const r=t.batch.keys(),o=e.ss.newChangeBuffer({trackRemovals:!0});return function(f,g,b,S){const O=b.batch,$=O.keys();let J=St.resolve();return $.forEach(ge=>{J=J.next(()=>S.getEntry(g,ge)).next(Ce=>{const je=b.docVersions.get(ge);gi(null!==je),Ce.version.compareTo(je)<0&&(O.applyToRemoteDocument(Ce,b),Ce.isValidDocument()&&(Ce.setReadTime(b.commitVersion),S.addEntry(Ce)))})}),J.next(()=>f.mutationQueue.removeMutationBatch(g,O))}(e,i,t,o).next(()=>o.apply(i)).next(()=>e.mutationQueue.performConsistencyCheck(i)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(i,r,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(f){let g=lr();for(let b=0;b<f.mutationResults.length;++b)f.mutationResults[b].transformResults.length>0&&(g=g.add(f.batch.mutations[b].key));return g}(t))).next(()=>e.localDocuments.getDocuments(i,r))})}(e.localStore,t);oO(e,i,null),rO(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),yield $p(e,r)}catch(r){yield cg(r)}}),tO.apply(this,arguments)}function Oce(n,t,e){return nO.apply(this,arguments)}function nO(){return nO=(0,Jt.Z)(function*(n,t,e){const i=zn(n);try{const r=yield function(l,f){const g=zn(l);return g.persistence.runTransaction("Reject batch","readwrite-primary",b=>{let S;return g.mutationQueue.lookupMutationBatch(b,f).next(O=>(gi(null!==O),S=O.keys(),g.mutationQueue.removeMutationBatch(b,O))).next(()=>g.mutationQueue.performConsistencyCheck(b)).next(()=>g.documentOverlayCache.removeOverlaysForBatchId(b,S,f)).next(()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(b,S)).next(()=>g.localDocuments.getDocuments(b,S))})}(i.localStore,t);oO(i,t,e),rO(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),yield $p(i,r)}catch(r){yield cg(r)}}),nO.apply(this,arguments)}function iO(){return iO=(0,Jt.Z)(function*(n,t){const e=zn(n);wg(e.remoteStore)||vn("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=yield function(l){const f=zn(l);return f.persistence.runTransaction("Get highest unacknowledged batch id","readonly",g=>f.mutationQueue.getHighestUnacknowledgedBatchId(g))}(e.localStore);if(-1===i)return void t.resolve();const r=e.ba.get(i)||[];r.push(t),e.ba.set(i,r)}catch(i){const r=sx(i,"Initialization of waitForPendingWrites() operation failed");t.reject(r)}}),iO.apply(this,arguments)}function rO(n,t){(n.ba.get(t)||[]).forEach(e=>{e.resolve()}),n.ba.delete(t)}function oO(n,t,e){const i=zn(n);let r=i.Sa[i.currentUser.toKey()];if(r){const o=r.get(t);o&&(e?o.reject(e):o.resolve(),r=r.remove(t)),i.Sa[i.currentUser.toKey()]=r}}function cx(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.fa.get(t))n.ma.delete(i),e&&n.Va.Fa(i,e);n.fa.delete(t),n.isPrimaryClient&&n.wa.Rr(t).forEach(i=>{n.wa.containsKey(i)||M7(n,i)})}function M7(n,t){n.ga.delete(t.path.canonicalString());const e=n.pa.get(t);null!==e&&(nE(n.remoteStore,e),n.pa=n.pa.remove(t),n.ya.delete(e),aO(n))}function sO(n,t,e){for(const i of e)i instanceof I7?(n.wa.addReference(i.key,t),Lce(n,i)):i instanceof T7?(vn("SyncEngine","Document no longer in limbo: "+i.key),n.wa.removeReference(i.key,t),n.wa.containsKey(i.key)||M7(n,i.key)):ii()}function Lce(n,t){const e=t.key,i=e.path.canonicalString();n.pa.get(e)||n.ga.has(i)||(vn("SyncEngine","New document in limbo: "+e),n.ga.add(i),aO(n))}function aO(n){for(;n.ga.size>0&&n.pa.size<n.maxConcurrentLimboResolutions;){const t=n.ga.values().next().value;n.ga.delete(t);const e=new $n(Nr.fromString(t)),i=n.Da.next();n.ya.set(i,new Dce(e)),n.pa=n.pa.insert(e,i),VD(n.remoteStore,new jp(sc(jv(e.path)),i,"TargetPurposeLimboResolution",Cu._e))}}function $p(n,t,e){return lO.apply(this,arguments)}function lO(){return lO=(0,Jt.Z)(function*(n,t,e){const i=zn(n),r=[],o=[],l=[];var f;i.ma.isEmpty()||(i.ma.forEach((f,g)=>{l.push(i.va(g,t,e).then(b=>{if((b||e)&&i.isPrimaryClient&&i.sharedClientState.updateQueryState(g.targetId,b?.fromCache?"not-current":"current"),b){r.push(b);const S=hR.Qi(g.targetId,b);o.push(S)}}))}),yield Promise.all(l),i.Va.a_(r),yield(f=(0,Jt.Z)(function*(b,S){const O=zn(b);try{yield O.persistence.runTransaction("notifyLocalViewChanges","readwrite",$=>St.forEach(S,J=>St.forEach(J.ki,ge=>O.persistence.referenceDelegate.addReference($,J.targetId,ge)).next(()=>St.forEach(J.qi,ge=>O.persistence.referenceDelegate.removeReference($,J.targetId,ge)))))}catch($){if(!ug($))throw $;vn("LocalStore","Failed to update sequence numbers: "+$)}for(const $ of S){const J=$.targetId;if(!$.fromCache){const ge=O.ts.get(J),je=ge.withLastLimboFreeSnapshotVersion(ge.snapshotVersion);O.ts=O.ts.insert(J,je)}}}),function g(b,S){return f.apply(this,arguments)})(i.localStore,o))}),lO.apply(this,arguments)}function Nce(n,t){return cO.apply(this,arguments)}function cO(){return cO=(0,Jt.Z)(function*(n,t){const e=zn(n);if(!e.currentUser.isEqual(t)){vn("SyncEngine","User change. New user:",t.toKey());const i=yield r7(e.localStore,t);e.currentUser=t,(o=e).ba.forEach(f=>{f.forEach(g=>{g.reject(new gn(jt.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.ba.clear(),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),yield $p(e,i._s)}var o}),cO.apply(this,arguments)}function Bce(n,t){const e=zn(n),i=e.ya.get(t);if(i&&i.Ra)return lr().add(i.key);{let r=lr();const o=e.fa.get(t);if(!o)return r;for(const l of o){const f=e.ma.get(l);r=r.unionWith(f.view.ua)}return r}}function Vce(n,t){return uO.apply(this,arguments)}function uO(){return uO=(0,Jt.Z)(function*(n,t){const e=zn(n),i=yield OD(e.localStore,t.query,!0),r=t.view.da(i);return e.isPrimaryClient&&sO(e,t.targetId,r.Ta),r}),uO.apply(this,arguments)}function zce(n,t){return dO.apply(this,arguments)}function dO(){return dO=(0,Jt.Z)(function*(n,t){const e=zn(n);return l7(e.localStore,t).then(i=>$p(e,i))}),dO.apply(this,arguments)}function Uce(n,t,e,i){return hO.apply(this,arguments)}function hO(){return hO=(0,Jt.Z)(function*(n,t,e,i){const r=zn(n),o=yield function(f,g){const b=zn(f),S=zn(b.mutationQueue);return b.persistence.runTransaction("Lookup mutation documents","readonly",O=>S.Cn(O,g).next($=>$?b.localDocuments.getDocuments(O,$):St.resolve(null)))}(r.localStore,t);var g;null!==o?("pending"===e?yield rx(r.remoteStore):"acknowledged"===e||"rejected"===e?(oO(r,t,i||null),rO(r,t),g=t,zn(zn(r.localStore).mutationQueue).Fn(g)):ii(),yield $p(r,o)):vn("SyncEngine","Cannot apply mutation batch with id: "+t)}),hO.apply(this,arguments)}function fO(){return fO=(0,Jt.Z)(function*(n,t){const e=zn(n);if(_O(e),yO(e),!0===t&&!0!==e.Ca){const i=e.sharedClientState.getAllActiveQueryTargets(),r=yield P7(e,i.toArray());e.Ca=!0,yield VR(e.remoteStore,!0);for(const o of r)VD(e.remoteStore,o)}else if(!1===t&&!1!==e.Ca){const i=[];let r=Promise.resolve();e.fa.forEach((o,l)=>{e.sharedClientState.isLocalQueryTarget(l)?i.push(l):r=r.then(()=>(cx(e,l),nx(e.localStore,l,!0))),nE(e.remoteStore,l)}),yield r,yield P7(e,i),function(l){const f=zn(l);f.ya.forEach((g,b)=>{nE(f.remoteStore,b)}),f.wa.Vr(),f.ya=new Map,f.pa=new $o($n.comparator)}(e),e.Ca=!1,yield VR(e.remoteStore,!1)}}),fO.apply(this,arguments)}function P7(n,t,e){return pO.apply(this,arguments)}function pO(){return pO=(0,Jt.Z)(function*(n,t,e){const i=zn(n),r=[],o=[];for(const l of t){let f;const g=i.fa.get(l);if(g&&0!==g.length){f=yield tx(i.localStore,sc(g[0]));for(const b of g){const S=i.ma.get(b),O=yield Vce(i,S);O.snapshot&&o.push(O.snapshot)}}else{const b=yield a7(i.localStore,l);f=yield tx(i.localStore,b),yield KR(i,k7(b),l,!1,f.resumeToken)}r.push(f)}return i.Va.a_(o),r}),pO.apply(this,arguments)}function k7(n){return NU(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function $ce(n){return e=zn(n).localStore,zn(zn(e).persistence).Bi();var e}function Hce(n,t,e,i){return mO.apply(this,arguments)}function mO(){return mO=(0,Jt.Z)(function*(n,t,e,i){const r=zn(n);if(r.Ca)return void vn("SyncEngine","Ignoring unexpected query state notification.");const o=r.fa.get(t);if(o&&o.length>0)switch(e){case"current":case"not-current":{const l=yield l7(r.localStore,UU(o[0])),f=jw.createSynthesizedRemoteEventForCurrentChange(t,"current"===e,Ta.EMPTY_BYTE_STRING);yield $p(r,l,f);break}case"rejected":yield nx(r.localStore,t,!0),cx(r,t,i);break;default:ii()}}),mO.apply(this,arguments)}function Gce(n,t,e){return gO.apply(this,arguments)}function gO(){return gO=(0,Jt.Z)(function*(n,t,e){const i=_O(n);if(i.Ca){for(const r of t){if(i.fa.has(r)){vn("SyncEngine","Adding an already active target "+r);continue}const o=yield a7(i.localStore,r),l=yield tx(i.localStore,o);yield KR(i,k7(o),l.targetId,!1,l.resumeToken),VD(i.remoteStore,l)}for(const r of e)i.fa.has(r)&&(yield nx(i.localStore,r,!1).then(()=>{nE(i.remoteStore,r),cx(i,r)}).catch(cg))}}),gO.apply(this,arguments)}function _O(n){const t=zn(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=A7.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Bce.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=kce.bind(null,t),t.Va.a_=wce.bind(null,t.eventManager),t.Va.Fa=Ece.bind(null,t.eventManager),t}function yO(n){const t=zn(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Rce.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Oce.bind(null,t),t}class iE{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return(0,Jt.Z)(function*(){e.serializer=eE(t.databaseInfo.databaseId),e.sharedClientState=e.createSharedClientState(t),e.persistence=e.createPersistence(t),yield e.persistence.start(),e.localStore=e.createLocalStore(t),e.gcScheduler=e.createGarbageCollectionScheduler(t,e.localStore),e.indexBackfillerScheduler=e.createIndexBackfillerScheduler(t,e.localStore)})()}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return i7(this.persistence,new n7,t.initialUser,this.serializer)}createPersistence(t){return new lR(PD.jr,this.serializer)}createSharedClientState(t){return new h7}terminate(){var t=this;return(0,Jt.Z)(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class vO extends iE{constructor(t,e,i){super(),this.xa=t,this.cacheSizeBytes=e,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(t){var e=()=>super.initialize,i=this;return(0,Jt.Z)(function*(){yield e().call(i,t),yield i.xa.initialize(i,t),yield yO(i.xa.syncEngine),yield rx(i.xa.remoteStore),yield i.persistence.mi(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()))})()}createLocalStore(t){return i7(this.persistence,new n7,t.initialUser,this.serializer)}createGarbageCollectionScheduler(t,e){return new qj(this.persistence.referenceDelegate.garbageCollector,t.asyncQueue,e)}createIndexBackfillerScheduler(t,e){const i=new yae(e,this.persistence);return new _ae(t.asyncQueue,i)}createPersistence(t){const e=dR(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?Al.withCacheSize(this.cacheSizeBytes):Al.DEFAULT;return new uR(this.synchronizeTabs,e,t.clientId,i,t.asyncQueue,p7(),BD(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(t){return new h7}}class R7 extends vO{constructor(t,e){super(t,e,!1),this.xa=t,this.cacheSizeBytes=e,this.synchronizeTabs=!0}initialize(t){var e=()=>super.initialize,i=this;return(0,Jt.Z)(function*(){yield e().call(i,t);const r=i.xa.syncEngine;i.sharedClientState instanceof xR&&(i.sharedClientState.syncEngine={Ys:Uce.bind(null,r),Zs:Hce.bind(null,r),Xs:Gce.bind(null,r),Bi:$ce.bind(null,r),Js:zce.bind(null,r)},yield i.sharedClientState.start()),yield i.persistence.mi(function(){var o=(0,Jt.Z)(function*(l){yield function jce(n,t){return fO.apply(this,arguments)}(i.xa.syncEngine,l),i.gcScheduler&&(l&&!i.gcScheduler.started?i.gcScheduler.start():l||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(l&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():l||i.indexBackfillerScheduler.stop())});return function(l){return o.apply(this,arguments)}}())})()}createSharedClientState(t){const e=p7();if(!xR.D(e))throw new gn(jt.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=dR(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new xR(e,t.asyncQueue,i,t.clientId,t.initialUser)}}class ux{initialize(t,e){var i=this;return(0,Jt.Z)(function*(){i.localStore||(i.localStore=t.localStore,i.sharedClientState=t.sharedClientState,i.datastore=i.createDatastore(e),i.remoteStore=i.createRemoteStore(e),i.eventManager=i.createEventManager(e),i.syncEngine=i.createSyncEngine(e,!t.synchronizeTabs),i.sharedClientState.onlineStateHandler=r=>S7(i.syncEngine,r,1),i.remoteStore.remoteSyncer.handleCredentialChange=Nce.bind(null,i.syncEngine),yield VR(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(t){return new bce}createDatastore(t){const e=eE(t.databaseInfo.databaseId),i=new rce(t.databaseInfo);return new ace(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return i=this.localStore,r=this.datastore,o=t.asyncQueue,l=e=>S7(this.syncEngine,e,0),f=f7.D()?new f7:new tce,new uce(i,r,o,l,f);var i,r,o,l,f}createSyncEngine(t,e){return function(r,o,l,f,g,b,S){const O=new Ace(r,o,l,f,g,b);return S&&(O.Ca=!0),O}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=(0,Jt.Z)(function*(i){const r=zn(i);vn("RemoteStore","RemoteStore shutting down."),r.C_.add(5),yield ix(r),r.F_.shutdown(),r.M_.set("Unknown")}),function e(i){return t.apply(this,arguments)})(this.remoteStore);var t}}function O7(n,t=10240){let e=0;return{read:()=>(0,Jt.Z)(function*(){if(e<n.byteLength){const i={value:n.slice(e,e+t),done:!1};return e+=t,i}return{done:!0}})(),cancel:()=>(0,Jt.Z)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class UD{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Oa(this.observer.next,t)}error(t){this.observer.error?this.Oa(this.observer.error,t):qs("Uncaught Error in snapshot listener:",t.toString())}Na(){this.muted=!0}Oa(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class Zce{constructor(t,e){this.Ba=t,this.serializer=e,this.metadata=new Ia,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then(i=>{i&&i.Z_()?this.metadata.resolve(i.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(i?.Y_)}`))},i=>this.metadata.reject(i))}close(){return this.Ba.cancel()}getMetadata(){var t=this;return(0,Jt.Z)(function*(){return t.metadata.promise})()}Ma(){var t=this;return(0,Jt.Z)(function*(){return yield t.getMetadata(),t.ka()})()}ka(){var t=this;return(0,Jt.Z)(function*(){const e=yield t.qa();if(null===e)return null;const i=t.La.decode(e),r=Number(i);isNaN(r)&&t.Qa(`length string (${i}) is not valid number`);const o=yield t.Ka(r);return new Cce(JSON.parse(o),e.length+r)})()}$a(){return this.buffer.findIndex(t=>t==="{".charCodeAt(0))}qa(){var t=this;return(0,Jt.Z)(function*(){for(;t.$a()<0&&!(yield t.Ua()););if(0===t.buffer.length)return null;const e=t.$a();e<0&&t.Qa("Reached the end of bundle when a length string is expected.");const i=t.buffer.slice(0,e);return t.buffer=t.buffer.slice(e),i})()}Ka(t){var e=this;return(0,Jt.Z)(function*(){for(;e.buffer.length<t;)(yield e.Ua())&&e.Qa("Reached the end of bundle when more is expected.");const i=e.La.decode(e.buffer.slice(0,t));return e.buffer=e.buffer.slice(t),i})()}Qa(t){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${t}`)}Ua(){var t=this;return(0,Jt.Z)(function*(){const e=yield t.Ba.read();if(!e.done){const i=new Uint8Array(t.buffer.length+e.value.length);i.set(t.buffer),i.set(e.value,t.buffer.length),t.buffer=i}return e.done})()}}class Kce{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(t){var e=this;return(0,Jt.Z)(function*(){if(e.ensureCommitNotCalled(),e.mutations.length>0)throw new gn(jt.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const i=yield(r=(0,Jt.Z)(function*(l,f){const g=zn(l),b=Gw(g.serializer)+"/documents",S={documents:f.map(ge=>Hw(g.serializer,ge))},O=yield g.Co("BatchGetDocuments",b,S,f.length),$=new Map;O.forEach(ge=>{const Ce=function gle(n,t){return"found"in t?function(i,r){gi(!!r.found);const o=Af(i,r.found.name),l=Zs(r.found.updateTime),f=r.found.createTime?Zs(r.found.createTime):xi.min(),g=new ll({mapValue:{fields:r.found.fields}});return ns.newFoundDocument(o,l,f,g)}(n,t):"missing"in t?function(i,r){gi(!!r.missing),gi(!!r.readTime);const o=Af(i,r.missing),l=Zs(r.readTime);return ns.newNoDocument(o,l)}(n,t):ii()}(g.serializer,ge);$.set(Ce.key.toString(),Ce)});const J=[];return f.forEach(ge=>{const Ce=$.get(ge.toString());gi(!!Ce),J.push(Ce)}),J}),function o(l,f){return r.apply(this,arguments)})(e.datastore,t);var r;return i.forEach(r=>e.recordVersion(r)),i})()}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(t.toString())}delete(t){this.write(new Zv(t,this.precondition(t))),this.writtenDocs.add(t.toString())}commit(){var t=this;return(0,Jt.Z)(function*(){if(t.ensureCommitNotCalled(),t.lastWriteError)throw t.lastWriteError;const e=t.readVersions;var i;t.mutations.forEach(i=>{e.delete(i.key.toString())}),e.forEach((i,r)=>{const o=$n.fromPath(r);t.mutations.push(new Hk(o,t.precondition(o)))}),yield(i=(0,Jt.Z)(function*(o,l){const f=zn(o),g=Gw(f.serializer)+"/documents",b={writes:l.map(S=>Ww(f.serializer,S))};yield f.wo("Commit",g,b)}),function r(o,l){return i.apply(this,arguments)})(t.datastore,t.mutations),t.committed=!0})()}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw ii();e=xi.min()}const i=this.readVersions.get(t.key.toString());if(i){if(!e.isEqual(i))throw new gn(jt.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){const e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(xi.min())?vs.exists(!1):vs.updateTime(e):vs.none()}preconditionForUpdate(t){const e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(xi.min()))throw new gn(jt.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return vs.updateTime(e)}return vs.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}}class Yce{constructor(t,e,i,r,o){this.asyncQueue=t,this.datastore=e,this.options=i,this.updateFunction=r,this.deferred=o,this.Wa=i.maxAttempts,this.zo=new wR(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){var t=this;this.zo.ko((0,Jt.Z)(function*(){const e=new Kce(t.datastore),i=t.za(e);i&&i.then(r=>{t.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{t.deferred.resolve(r)}).catch(o=>{t.ja(o)}))}).catch(r=>{t.ja(r)})}))}za(t){try{const e=this.updateFunction(t);return!Dw(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ja(t){this.Wa>0&&this.Ha(t)?(this.Wa-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ga(),Promise.resolve()))):this.deferred.reject(t)}Ha(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||"already-exists"===e||!oj(e)}return!1}}class Xce{constructor(t,e,i,r){var o=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=r,this.user=Ua.UNAUTHENTICATED,this.clientId=tU.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,function(){var l=(0,Jt.Z)(function*(f){vn("FirestoreClient","Received user=",f.uid),yield o.authCredentialListener(f),o.user=f});return function(f){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(i,l=>(vn("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var t=this;return(0,Jt.Z)(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new gn(jt.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new Ia;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Jt.Z)(function*(){try{t._onlineComponents&&(yield t._onlineComponents.terminate()),t._offlineComponents&&(yield t._offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(i){const r=sx(i,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}function jD(n,t){return xO.apply(this,arguments)}function xO(){return xO=(0,Jt.Z)(function*(n,t){n.asyncQueue.verifyOperationInProgress(),vn("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener(function(){var r=(0,Jt.Z)(function*(o){i.isEqual(o)||(yield r7(t.localStore,o),i=o)});return function(o){return r.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}),xO.apply(this,arguments)}function bO(n,t){return wO.apply(this,arguments)}function wO(){return wO=(0,Jt.Z)(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield EO(n);vn("FirestoreClient","Initializing OnlineComponentProvider");const i=yield n.getConfiguration();yield t.initialize(e,i),n.setCredentialChangeListener(r=>b7(t.remoteStore,r)),n.setAppCheckTokenChangeListener((r,o)=>b7(t.remoteStore,o)),n._onlineComponents=t}),wO.apply(this,arguments)}function F7(n){return"FirebaseError"===n.name?n.code===jt.FAILED_PRECONDITION||n.code===jt.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code}function EO(n){return CO.apply(this,arguments)}function CO(){return CO=(0,Jt.Z)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){vn("FirestoreClient","Using user provided OfflineComponentProvider");try{yield jD(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!F7(e))throw e;Fc("Error using user provided cache. Falling back to memory cache: "+e),yield jD(n,new iE)}}else vn("FirestoreClient","Using default OfflineComponentProvider"),yield jD(n,new iE);return n._offlineComponents}),CO.apply(this,arguments)}function $D(n){return IO.apply(this,arguments)}function IO(){return IO=(0,Jt.Z)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(vn("FirestoreClient","Using user provided OnlineComponentProvider"),yield bO(n,n._uninitializedComponentsProvider._online)):(vn("FirestoreClient","Using default OnlineComponentProvider"),yield bO(n,new ux))),n._onlineComponents}),IO.apply(this,arguments)}function L7(n){return EO(n).then(t=>t.persistence)}function dx(n){return EO(n).then(t=>t.localStore)}function N7(n){return $D(n).then(t=>t.remoteStore)}function TO(n){return $D(n).then(t=>t.syncEngine)}function hx(n){return DO.apply(this,arguments)}function DO(){return DO=(0,Jt.Z)(function*(n){const t=yield $D(n),e=t.eventManager;return e.onListen=Sce.bind(null,t.syncEngine),e.onUnlisten=Mce.bind(null,t.syncEngine),e}),DO.apply(this,arguments)}function V7(n,t,e={}){const i=new Ia;return n.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return function(o,l,f,g,b){const S=new UD({next:$=>{l.enqueueAndForget(()=>HR(o,O));const J=$.docs.has(f);!J&&$.fromCache?b.reject(new gn(jt.UNAVAILABLE,"Failed to get document because the client is offline.")):J&&$.fromCache&&g&&"server"===g.source?b.reject(new gn(jt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):b.resolve($)},error:$=>b.reject($)}),O=new qR(jv(f.path),S,{includeMetadataChanges:!0,J_:!0});return jR(o,O)}(yield hx(n),n.asyncQueue,t,e,i)})),i.promise}function z7(n,t,e={}){const i=new Ia;return n.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return function(o,l,f,g,b){const S=new UD({next:$=>{l.enqueueAndForget(()=>HR(o,O)),$.fromCache&&"server"===g.source?b.reject(new gn(jt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):b.resolve($)},error:$=>b.reject($)}),O=new qR(f,S,{includeMetadataChanges:!0,J_:!0});return jR(o,O)}(yield hx(n),n.asyncQueue,t,e,i)})),i.promise}function U7(n){const t={};return void 0!==n.timeoutSeconds&&(t.timeoutSeconds=n.timeoutSeconds),t}const j7=new Map;function AO(n,t,e){if(!e)throw new gn(jt.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function $7(n,t,e,i){if(!0===t&&!0===i)throw new gn(jt.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function H7(n){if(!$n.isDocumentKey(n))throw new gn(jt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function G7(n){if($n.isDocumentKey(n))throw new gn(jt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function HD(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(i=n).constructor?i.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var i;return"function"==typeof n?"a function":ii()}function Cr(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new gn(jt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=HD(n);throw new gn(jt.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function W7(n,t){if(t<=0)throw new gn(jt.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}class q7{constructor(t){var e,i;if(void 0===t.host){if(void 0!==t.ssl)throw new gn(jt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new gn(jt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}$7("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==t.experimentalAutoDetectLongPolling&&!t.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=U7(null!==(i=t.experimentalLongPollingOptions)&&void 0!==i?i:{}),function(o){if(void 0!==o.timeoutSeconds){if(isNaN(o.timeoutSeconds))throw new gn(jt.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new gn(jt.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new gn(jt.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===t.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class rE{constructor(t,e,i,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new q7({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new gn(jt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new gn(jt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new q7(t),void 0!==t.credentials&&(this._authCredentials=function(i){if(!i)return new oae;switch(i.type){case"firstParty":return new cae(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new gn(jt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const i=j7.get(e);i&&(vn("ComponentProvider","Removing Datastore"),j7.delete(e),i.terminate())}(this),Promise.resolve()}}function Z7(n,t,e,i={}){var r;const o=(n=Cr(n,rE))._getSettings(),l=`${t}:${e}`;if("firestore.googleapis.com"!==o.host&&o.host!==l&&Fc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:l,ssl:!1})),i.mockUserToken){let f,g;if("string"==typeof i.mockUserToken)f=i.mockUserToken,g=Ua.MOCK_USER;else{f=(0,Do.Sg)(i.mockUserToken,null===(r=n._app)||void 0===r?void 0:r.options.projectId);const b=i.mockUserToken.sub||i.mockUserToken.user_id;if(!b)throw new gn(jt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new Ua(b)}n._authCredentials=new sae(new J8(f,g))}}class cl{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new cl(this.firestore,t,this._query)}}class is{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sf(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new is(this.firestore,t,this._key)}}class Sf extends cl{constructor(t,e,i){super(t,e,jv(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new is(this.firestore,null,new $n(t))}withConverter(t){return new Sf(this.firestore,t,this._path)}}function oE(n,t,...e){if(n=(0,Do.m9)(n),AO("collection","path",t),n instanceof rE){const i=Nr.fromString(t,...e);return G7(i),new Sf(n,null,i)}{if(!(n instanceof is||n instanceof Sf))throw new gn(jt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Nr.fromString(t,...e));return G7(i),new Sf(n.firestore,null,i)}}function GD(n,t,...e){if(n=(0,Do.m9)(n),1===arguments.length&&(t=tU.newId()),AO("doc","path",t),n instanceof rE){const i=Nr.fromString(t,...e);return H7(i),new is(n,null,new $n(i))}{if(!(n instanceof is||n instanceof Sf))throw new gn(jt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Nr.fromString(t,...e));return H7(i),new is(n.firestore,n instanceof Sf?n.converter:null,new $n(i))}}function K7(n,t){return n=(0,Do.m9)(n),t=(0,Do.m9)(t),(n instanceof is||n instanceof Sf)&&(t instanceof is||t instanceof Sf)&&n.firestore===t.firestore&&n.path===t.path&&n.converter===t.converter}function SO(n,t){return n=(0,Do.m9)(n),t=(0,Do.m9)(t),n instanceof cl&&t instanceof cl&&n.firestore===t.firestore&&Fw(n._query,t._query)&&n.converter===t.converter}class cue{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new wR(this,"async_queue_retry"),this.iu=()=>{const e=BD();e&&vn("AsyncQueue","Visibility state changed to "+e.visibilityState),this.zo.Qo()};const t=BD();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.su(),this.ou(t)}enterRestrictedMode(t){if(!this.Za){this.Za=!0,this.nu=t||!1;const e=BD();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.iu)}}enqueue(t){if(this.su(),this.Za)return new Promise(()=>{});const e=new Ia;return this.ou(()=>this.Za&&this.nu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Ya.push(t),this._u()))}_u(){var t=this;return(0,Jt.Z)(function*(){if(0!==t.Ya.length){try{yield t.Ya[0](),t.Ya.shift(),t.zo.reset()}catch(e){if(!ug(e))throw e;vn("AsyncQueue","Operation failed with retryable error: "+e)}t.Ya.length>0&&t.zo.ko(()=>t._u())}})()}ou(t){const e=this.Ja.then(()=>(this.tu=!0,t().catch(i=>{throw this.eu=i,this.tu=!1,qs("INTERNAL UNHANDLED ERROR: ",function(l){let f=l.message||"";return l.stack&&(f=l.stack.includes(l.message)?l.stack:l.message+"\n"+l.stack),f}(i)),i}).then(i=>(this.tu=!1,i))));return this.Ja=e,e}enqueueAfterDelay(t,e,i){this.su(),this.ru.indexOf(t)>-1&&(e=0);const r=UR.createAndSchedule(this,t,e,i,o=>this.au(o));return this.Xa.push(r),r}su(){this.eu&&ii()}verifyOperationInProgress(){}uu(){var t=this;return(0,Jt.Z)(function*(){let e;do{e=t.Ja,yield e}while(e!==t.Ja)})()}cu(t){for(const e of this.Xa)if(e.timerId===t)return!0;return!1}lu(t){return this.uu().then(()=>{this.Xa.sort((e,i)=>e.targetTimeMs-i.targetTimeMs);for(const e of this.Xa)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.uu()})}hu(t){this.ru.push(t)}au(t){const e=this.Xa.indexOf(t);this.Xa.splice(e,1)}}function MO(n){return function(e,i){if("object"!=typeof e||null===e)return!1;const r=e;for(const o of["next","error","complete"])if(o in r&&"function"==typeof r[o])return!0;return!1}(n)}class uue{constructor(){this._progressObserver={},this._taskCompletionResolver=new Ia,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(t,e,i){this._progressObserver={next:t,error:e,complete:i}}catch(t){return this._taskCompletionResolver.promise.catch(t)}then(t,e){return this._taskCompletionResolver.promise.then(t,e)}_completeWith(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)}_failWith(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)}_updateProgress(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}}class Ho extends rE{constructor(t,e,i,r){super(t,e,i,r),this.type="firestore",this._queue=new cue,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Y7(this),this._firestoreClient.terminate()}}function hue(n,t){const e="object"==typeof n?n:(0,rc.getApp)(),i="string"==typeof n?n:t||"(default)",r=(0,rc._getProvider)(e,"firestore").getImmediate({identifier:i});if(!r._initialized){const o=(0,Do.P0)("firestore");o&&Z7(r,...o)}return r}function Vs(n){return n._firestoreClient||Y7(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Y7(n){var t,e,i;const r=n._freezeSettings(),o=(g=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new Vae(n._databaseId,g,n._persistenceKey,(S=r).host,S.ssl,S.experimentalForceLongPolling,S.experimentalAutoDetectLongPolling,U7(S.experimentalLongPollingOptions),S.useFetchStreams));var g,S;n._firestoreClient=new Xce(n._authCredentials,n._appCheckCredentials,n._queue,o),null!==(e=r.localCache)&&void 0!==e&&e._offlineComponentProvider&&null!==(i=r.localCache)&&void 0!==i&&i._onlineComponentProvider&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}function X7(n,t,e){const i=new Ia;return n.asyncQueue.enqueue((0,Jt.Z)(function*(){try{yield jD(n,e),yield bO(n,t),i.resolve()}catch(r){const o=r;if(!F7(o))throw o;Fc("Error enabling indexeddb cache. Falling back to memory cache: "+o),i.reject(o)}})).then(()=>i.promise)}function Q7(n){if(n._initialized||n._terminated)throw new gn(jt.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Mf{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Mf(Ta.fromBase64String(t))}catch(e){throw new gn(jt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Mf(Ta.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Hp{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new gn(jt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ts(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class f0{constructor(t){this._methodName=t}}class WD{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new gn(jt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new gn(jt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return Xi(this._lat,t._lat)||Xi(this._long,t._long)}}const wue=/^__.*__$/;class Eue{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return null!==this.fieldMask?new Up(t,this.data,this.fieldMask,e,this.fieldTransforms):new qv(t,this.data,e,this.fieldTransforms)}}class J7{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return new Up(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function e9(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ii()}}class qD{constructor(t,e,i,r,o,l){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=r,void 0===o&&this.Pu(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(t){return new qD(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(t){var e;const i=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Tu({path:i,du:!1});return r.Au(t),r}Ru(t){var e;const i=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Tu({path:i,du:!1});return r.Pu(),r}Vu(t){return this.Tu({path:void 0,du:!0})}mu(t){return YD(t,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}Pu(){if(this.path)for(let t=0;t<this.path.length;t++)this.Au(this.path.get(t))}Au(t){if(0===t.length)throw this.mu("Document fields must not be empty");if(e9(this.Iu)&&wue.test(t))throw this.mu('Document fields cannot begin and end with "__"')}}class Cue{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||eE(t)}pu(t,e,i,r=!1){return new qD({Iu:t,methodName:e,gu:i,path:ts.emptyPath(),du:!1,fu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function p0(n){const t=n._freezeSettings(),e=eE(n._databaseId);return new Cue(n._databaseId,!!t.ignoreUndefinedProperties,e)}function ZD(n,t,e,i,r,o={}){const l=n.pu(o.merge||o.mergeFields?2:0,t,e,r);OO("Data must be an object, but it was:",l,i);const f=i9(i,l);let g,b;if(o.merge)g=new Lc(l.fieldMask),b=l.fieldTransforms;else if(o.mergeFields){const S=[];for(const O of o.mergeFields){const $=lE(t,O,e);if(!l.contains($))throw new gn(jt.INVALID_ARGUMENT,`Field '${$}' is specified in your field mask but missing from your input data.`);o9(S,$)||S.push($)}g=new Lc(S),b=l.fieldTransforms.filter(O=>g.covers(O.field))}else g=null,b=l.fieldTransforms;return new Eue(new ll(f),g,b)}class aE extends f0{_toFieldTransform(t){if(2!==t.Iu)throw t.mu(1===t.Iu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof aE}}function t9(n,t,e){return new qD({Iu:3,gu:t.settings.gu,methodName:n._methodName,du:e},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class PO extends f0{_toFieldTransform(t){return new Vw(t.path,new Gv)}isEqual(t){return t instanceof PO}}class Iue extends f0{constructor(t,e){super(t),this.yu=e}_toFieldTransform(t){const e=t9(this,t,!0),i=this.yu.map(o=>m0(o,e)),r=new r0(i);return new Vw(t.path,r)}isEqual(t){return this===t}}class Tue extends f0{constructor(t,e){super(t),this.yu=e}_toFieldTransform(t){const e=t9(this,t,!0),i=this.yu.map(o=>m0(o,e)),r=new o0(i);return new Vw(t.path,r)}isEqual(t){return this===t}}class Due extends f0{constructor(t,e){super(t),this.wu=e}_toFieldTransform(t){const e=new Wv(t.serializer,ZU(t.serializer,this.wu));return new Vw(t.path,e)}isEqual(t){return this===t}}function kO(n,t,e,i){const r=n.pu(1,t,e);OO("Data must be an object, but it was:",r,i);const o=[],l=ll.empty();dg(i,(g,b)=>{const S=KD(t,g,e);b=(0,Do.m9)(b);const O=r.Ru(S);if(b instanceof aE)o.push(S);else{const $=m0(b,O);null!=$&&(o.push(S),l.set(S,$))}});const f=new Lc(o);return new J7(l,f,r.fieldTransforms)}function RO(n,t,e,i,r,o){const l=n.pu(1,t,e),f=[lE(t,i,e)],g=[r];if(o.length%2!=0)throw new gn(jt.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let $=0;$<o.length;$+=2)f.push(lE(t,o[$])),g.push(o[$+1]);const b=[],S=ll.empty();for(let $=f.length-1;$>=0;--$)if(!o9(b,f[$])){const J=f[$];let ge=g[$];ge=(0,Do.m9)(ge);const Ce=l.Ru(J);if(ge instanceof aE)b.push(J);else{const je=m0(ge,Ce);null!=je&&(b.push(J),S.set(J,je))}}const O=new Lc(b);return new J7(S,O,l.fieldTransforms)}function n9(n,t,e,i=!1){return m0(e,n.pu(i?4:3,t))}function m0(n,t){if(r9(n=(0,Do.m9)(n)))return OO("Unsupported field value:",t,n),i9(n,t);if(n instanceof f0)return function(i,r){if(!e9(r.Iu))throw r.mu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.mu(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(r);o&&r.fieldTransforms.push(o)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.du&&4!==t.Iu)throw t.mu("Nested arrays are not supported");return function(i,r){const o=[];let l=0;for(const f of i){let g=m0(f,r.Vu(l));null==g&&(g={nullValue:"NULL_VALUE"}),o.push(g),l++}return{arrayValue:{values:o}}}(n,t)}return function(i,r){if(null===(i=(0,Do.m9)(i)))return{nullValue:"NULL_VALUE"};if("number"==typeof i)return ZU(r.serializer,i);if("boolean"==typeof i)return{booleanValue:i};if("string"==typeof i)return{stringValue:i};if(i instanceof Date){const o=es.fromDate(i);return{timestampValue:Kv(r.serializer,o)}}if(i instanceof es){const o=new es(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Kv(r.serializer,o)}}if(i instanceof WD)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Mf)return{bytesValue:mj(r.serializer,i._byteString)};if(i instanceof is){const o=r.databaseId,l=i.firestore._databaseId;if(!l.isEqual(o))throw r.mu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Yk(i.firestore._databaseId||r.databaseId,i._key.path)}}throw r.mu(`Unsupported field value: ${HD(i)}`)}(n,t)}function i9(n,t){const e={};return gU(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):dg(n,(i,r)=>{const o=m0(r,t.Eu(i));null!=o&&(e[i]=o)}),{mapValue:{fields:e}}}function r9(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof es||n instanceof WD||n instanceof Mf||n instanceof is||n instanceof f0)}function OO(n,t,e){if(!r9(e)||"object"!=typeof(r=e)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const i=HD(e);throw t.mu("an object"===i?n+" a custom object":n+" "+i)}var r}function lE(n,t,e){if((t=(0,Do.m9)(t))instanceof Hp)return t._internalPath;if("string"==typeof t)return KD(n,t);throw YD("Field path arguments must be of type string or ",n,!1,void 0,e)}const Aue=new RegExp("[~\\*/\\[\\]]");function KD(n,t,e){if(t.search(Aue)>=0)throw YD(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Hp(...t.split("."))._internalPath}catch{throw YD(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function YD(n,t,e,i,r){const o=i&&!i.isEmpty(),l=void 0!==r;let f=`Function ${t}() called with invalid data`;e&&(f+=" (via `toFirestore()`)"),f+=". ";let g="";return(o||l)&&(g+=" (found",o&&(g+=` in field ${i}`),l&&(g+=` in document ${r}`),g+=")"),new gn(jt.INVALID_ARGUMENT,f+n+g)}function o9(n,t){return n.some(e=>e.isEqual(t))}class cE{constructor(t,e,i,r,o){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=r,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new is(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new Sue(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(XD("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class Sue extends cE{data(){return super.data()}}function XD(n,t){return"string"==typeof t?KD(n,t):t instanceof Hp?t._internalPath:t._delegate._internalPath}function s9(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new gn(jt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class FO{}class uE extends FO{}function Cg(n,t,...e){let i=[];t instanceof FO&&i.push(t),i=i.concat(e),function(o){const l=o.filter(g=>g instanceof fx).length,f=o.filter(g=>g instanceof dE).length;if(l>1||l>0&&f>0)throw new gn(jt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const r of i)n=r._apply(n);return n}class dE extends uE{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new dE(t,e,i)}_apply(t){const e=this._parse(t);return u9(t._query,e),new cl(t.firestore,t.converter,jk(t._query,e))}_parse(t){const e=p0(t.firestore);return function(o,l,f,g,b,S,O){let $;if(b.isKeyField()){if("array-contains"===S||"array-contains-any"===S)throw new gn(jt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${S}' queries on documentId().`);if("in"===S||"not-in"===S){c9(O,S);const J=[];for(const ge of O)J.push(l9(g,o,ge));$={arrayValue:{values:J}}}else $=l9(g,o,O)}else"in"!==S&&"not-in"!==S&&"array-contains-any"!==S||c9(O,S),$=n9(f,"where",O,"in"===S||"not-in"===S);return Ar.create(b,S,$)}(t._query,0,e,t.firestore._databaseId,this._field,this._op,this._value)}}class fx extends FO{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new fx(t,e)}_parse(t){const e=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return 1===e.length?e[0]:xo.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(r,o){let l=r;const f=o.getFlattenedFilters();for(const g of f)u9(l,g),l=jk(l,g)}(t._query,e),new cl(t.firestore,t.converter,jk(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class LO extends uE{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new LO(t,e)}_apply(t){const e=function(r,o,l){if(null!==r.startAt)throw new gn(jt.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new gn(jt.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Rw(o,l)}(t._query,this._field,this._direction);return new cl(t.firestore,t.converter,function(r,o){const l=r.explicitOrderBy.concat([o]);return new Vp(r.path,r.collectionGroup,l,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}class QD extends uE{constructor(t,e,i){super(),this.type=t,this._limit=e,this._limitType=i}static _create(t,e,i){return new QD(t,e,i)}_apply(t){return new cl(t.firestore,t.converter,yD(t._query,this._limit,this._limitType))}}class JD extends uE{constructor(t,e,i){super(),this.type=t,this._docOrFields=e,this._inclusive=i}static _create(t,e,i){return new JD(t,e,i)}_apply(t){const e=a9(t,this.type,this._docOrFields,this._inclusive);return new cl(t.firestore,t.converter,(o=e,new Vp((r=t._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,o,r.endAt)));var r,o}}class eA extends uE{constructor(t,e,i){super(),this.type=t,this._docOrFields=e,this._inclusive=i}static _create(t,e,i){return new eA(t,e,i)}_apply(t){const e=a9(t,this.type,this._docOrFields,this._inclusive);return new cl(t.firestore,t.converter,(o=e,new Vp((r=t._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,o)));var r,o}}function a9(n,t,e,i){if(e[0]=(0,Do.m9)(e[0]),e[0]instanceof cE)return function(o,l,f,g,b){if(!g)throw new gn(jt.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${f}().`);const S=[];for(const O of $v(o))if(O.field.isKeyField())S.push(t0(l,g.key));else{const $=g.data.field(O.field);if(dD($))throw new gn(jt.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+O.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===$){const J=O.field.canonicalString();throw new gn(jt.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${J}' (used as the orderBy) does not exist.`)}S.push($)}return new _g(S,b)}(n._query,n.firestore._databaseId,t,e[0]._document,i);{const r=p0(n.firestore);return function(l,f,g,b,S,O){const $=l.explicitOrderBy;if(S.length>$.length)throw new gn(jt.INVALID_ARGUMENT,`Too many arguments provided to ${b}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const J=[];for(let ge=0;ge<S.length;ge++){const Ce=S[ge];if($[ge].field.isKeyField()){if("string"!=typeof Ce)throw new gn(jt.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${b}(), but got a ${typeof Ce}`);if(!Uk(l)&&-1!==Ce.indexOf("/"))throw new gn(jt.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${b}() must be a plain document ID, but '${Ce}' contains a slash.`);const je=l.path.child(Nr.fromString(Ce));if(!$n.isDocumentKey(je))throw new gn(jt.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${b}() must result in a valid document path, but '${je}' is not because it contains an odd number of segments.`);const ft=new $n(je);J.push(t0(f,ft))}else{const je=n9(g,b,Ce);J.push(je)}}return new _g(J,O)}(n._query,n.firestore._databaseId,r,t,e,i)}}function l9(n,t,e){if("string"==typeof(e=(0,Do.m9)(e))){if(""===e)throw new gn(jt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Uk(t)&&-1!==e.indexOf("/"))throw new gn(jt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const i=t.path.child(Nr.fromString(e));if(!$n.isDocumentKey(i))throw new gn(jt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return t0(n,new $n(i))}if(e instanceof is)return t0(n,e._key);throw new gn(jt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${HD(e)}.`)}function c9(n,t){if(!Array.isArray(n)||0===n.length)throw new gn(jt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function u9(n,t){const e=function(r,o){for(const l of r)for(const f of l.getFlattenedFilters())if(o.indexOf(f.op)>=0)return f.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==e)throw new gn(jt.INVALID_ARGUMENT,e===t.op?`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`:`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class NO{convertValue(t,e="none"){switch(mg(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bs(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Bp(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw ii()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return dg(t,(r,o)=>{i[r]=this.convertValue(o,e)}),i}convertGeoPoint(t){return new WD(Bs(t.latitude),Bs(t.longitude))}convertArray(t,e){return(t.values||[]).map(i=>this.convertValue(i,e))}convertServerTimestamp(t,e){switch(e){case"previous":const i=hD(t);return null==i?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(Sw(t));default:return null}}convertTimestamp(t){const e=hg(t);return new es(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=Nr.fromString(t);gi(Ij(i));const r=new fg(i.get(1),i.get(3)),o=new $n(i.popFirst(5));return r.isEqual(e)||qs(`Document ${o} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),o}}function tA(n,t,e){let i;return i=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,i}class Bue extends NO{constructor(t){super(),this.firestore=t}convertBytes(t){return new Mf(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new is(this.firestore,null,e)}}class g0{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Gp extends cE{constructor(t,e,i,r,o,l){super(t,e,i,r,l),this._firestore=t,this._firestoreImpl=t,this.metadata=o}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new hE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(XD("DocumentSnapshot.get",t));if(null!==i)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}}class hE extends Gp{data(t={}){return super.data(t)}}class Ig{constructor(t,e,i,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new g0(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(i=>{t.call(e,new hE(this._firestore,this._userDataWriter,i.key,i,new g0(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new gn(jt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,o){if(r._snapshot.oldDocs.isEmpty()){let l=0;return r._snapshot.docChanges.map(f=>({type:"added",doc:new hE(r._firestore,r._userDataWriter,f.doc.key,f.doc,new g0(r._snapshot.mutatedKeys.has(f.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:l++}))}{let l=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(f=>o||3!==f.type).map(f=>{const g=new hE(r._firestore,r._userDataWriter,f.doc.key,f.doc,new g0(r._snapshot.mutatedKeys.has(f.doc.key),r._snapshot.fromCache),r.query.converter);let b=-1,S=-1;return 0!==f.type&&(b=l.indexOf(f.doc.key),l=l.delete(f.doc.key)),1!==f.type&&(l=l.add(f.doc),S=l.indexOf(f.doc.key)),{type:zue(f.type),doc:g,oldIndex:b,newIndex:S}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function zue(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ii()}}function h9(n,t){return n instanceof Gp&&t instanceof Gp?n._firestore===t._firestore&&n._key.isEqual(t._key)&&(null===n._document?null===t._document:n._document.isEqual(t._document))&&n._converter===t._converter:n instanceof Ig&&t instanceof Ig&&n._firestore===t._firestore&&SO(n.query,t.query)&&n.metadata.isEqual(t.metadata)&&n._snapshot.isEqual(t._snapshot)}class Tg extends NO{constructor(t){super(),this.firestore=t}convertBytes(t){return new Mf(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new is(this.firestore,null,e)}}function f9(n,t,e){n=Cr(n,is);const i=Cr(n.firestore,Ho),r=tA(n.converter,t,e);return px(i,[ZD(p0(i),"setDoc",n._key,r,null!==n.converter,e).toMutation(n._key,vs.none())])}function p9(n,t,e,...i){n=Cr(n,is);const r=Cr(n.firestore,Ho),o=p0(r);let l;return l="string"==typeof(t=(0,Do.m9)(t))||t instanceof Hp?RO(o,"updateDoc",n._key,t,e,i):kO(o,"updateDoc",n._key,t),px(r,[l.toMutation(n._key,vs.exists(!0))])}function BO(n,t){const e=Cr(n.firestore,Ho),i=GD(n),r=tA(n.converter,t);return px(e,[ZD(p0(n.firestore),"addDoc",i._key,r,null!==n.converter,{}).toMutation(i._key,vs.exists(!1))]).then(()=>i)}function VO(n,...t){var e,i,r;n=(0,Do.m9)(n);let o={includeMetadataChanges:!1},l=0;"object"!=typeof t[l]||MO(t[l])||(o=t[l],l++);const f={includeMetadataChanges:o.includeMetadataChanges};if(MO(t[l])){const O=t[l];t[l]=null===(e=O.next)||void 0===e?void 0:e.bind(O),t[l+1]=null===(i=O.error)||void 0===i?void 0:i.bind(O),t[l+2]=null===(r=O.complete)||void 0===r?void 0:r.bind(O)}let g,b,S;if(n instanceof is)b=Cr(n.firestore,Ho),S=jv(n._key.path),g={next:O=>{t[l]&&t[l](zO(b,n,O))},error:t[l+1],complete:t[l+2]};else{const O=Cr(n,cl);b=Cr(O.firestore,Ho),S=O._query;const $=new Tg(b);g={next:J=>{t[l]&&t[l](new Ig(b,$,O,J))},error:t[l+1],complete:t[l+2]},s9(n._query)}return function($,J,ge,Ce){const je=new UD(Ce),ft=new qR(J,je,ge);return $.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return jR(yield hx($),ft)})),()=>{je.Na(),$.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return HR(yield hx($),ft)}))}}(Vs(b),S,f,g)}function px(n,t){return function(i,r){const o=new Ia;return i.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return function Pce(n,t,e){return QR.apply(this,arguments)}(yield TO(i),r,o)})),o.promise}(Vs(n),t)}function zO(n,t,e){const i=e.docs.get(t._key),r=new Tg(n);return new Gp(n,r,t._key,i,new g0(e.hasPendingWrites,e.fromCache),t.converter)}const ide={maxAttempts:5};class m9{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=p0(t)}set(t,e,i){this._verifyNotCommitted();const r=Dg(t,this._firestore),o=tA(r.converter,e,i),l=ZD(this._dataReader,"WriteBatch.set",r._key,o,null!==r.converter,i);return this._mutations.push(l.toMutation(r._key,vs.none())),this}update(t,e,i,...r){this._verifyNotCommitted();const o=Dg(t,this._firestore);let l;return l="string"==typeof(e=(0,Do.m9)(e))||e instanceof Hp?RO(this._dataReader,"WriteBatch.update",o._key,e,i,r):kO(this._dataReader,"WriteBatch.update",o._key,e),this._mutations.push(l.toMutation(o._key,vs.exists(!0))),this}delete(t){this._verifyNotCommitted();const e=Dg(t,this._firestore);return this._mutations=this._mutations.concat(new Zv(e._key,vs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new gn(jt.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Dg(n,t){if((n=(0,Do.m9)(n)).firestore!==t)throw new gn(jt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class rde extends class{constructor(e,i){this._firestore=e,this._transaction=i,this._dataReader=p0(e)}get(e){const i=Dg(e,this._firestore),r=new Bue(this._firestore);return this._transaction.lookup([i._key]).then(o=>{if(!o||1!==o.length)return ii();const l=o[0];if(l.isFoundDocument())return new cE(this._firestore,r,l.key,l,i.converter);if(l.isNoDocument())return new cE(this._firestore,r,i._key,null,i.converter);throw ii()})}set(e,i,r){const o=Dg(e,this._firestore),l=tA(o.converter,i,r),f=ZD(this._dataReader,"Transaction.set",o._key,l,null!==o.converter,r);return this._transaction.set(o._key,f),this}update(e,i,r,...o){const l=Dg(e,this._firestore);let f;return f="string"==typeof(i=(0,Do.m9)(i))||i instanceof Hp?RO(this._dataReader,"Transaction.update",l._key,i,r,o):kO(this._dataReader,"Transaction.update",l._key,i),this._transaction.update(l._key,f),this}delete(e){const i=Dg(e,this._firestore);return this._transaction.delete(i._key),this}}{constructor(t,e){super(t,e),this._firestore=t}get(t){const e=Dg(t,this._firestore),i=new Tg(this._firestore);return super.get(t).then(r=>new Gp(this._firestore,i,e._key,r._document,new g0(!1,!1),e.converter))}}!function(t,e=!0){Ov=rc.SDK_VERSION,(0,rc._registerComponent)(new $5.wA("firestore",(i,{instanceIdentifier:r,options:o})=>{const l=i.getProvider("app").getImmediate(),f=new Ho(new aae(i.getProvider("auth-internal")),new uae(i.getProvider("app-check-internal")),function(b,S){if(!Object.prototype.hasOwnProperty.apply(b.options,["projectId"]))throw new gn(jt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fg(b.options.projectId,S)}(l,r),l);return o=Object.assign({useFetchStreams:e},o),f._setSettings(o),f},"PUBLIC").setMultipleInstances(!0)),(0,rc.registerVersion)(Q8,"4.4.0",t),(0,rc.registerVersion)(Q8,"4.4.0","esm2017")}();var iA=function(){return iA=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},iA.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var hde={includeMetadataChanges:!1};function vde(n,t){return void 0===t&&(t={}),function yde(n){return function $O(n,t){return void 0===t&&(t=hde),new Kt(function(e){return{unsubscribe:VO(n,t,{next:e.next.bind(e),error:e.error.bind(e),complete:e.complete.bind(e)})}})}(n,{includeMetadataChanges:!0}).pipe($t(function(t){return t.docs}))}(n).pipe($t(function(e){return e.map(function(i){return function v9(n,t){var e;void 0===t&&(t={});var i=n.data(t);return n.exists()&&"object"==typeof i&&null!==i&&t.idField?iA(iA({},i),((e={})[t.idField]=n.id,e)):i}(i,t)})}))}class rA{constructor(t){return t}}const E9="firestore",WO=new Xt("angularfire2.firestore-instances");function Ede(n){return(t,e)=>{const i=t.runOutsideAngular(()=>n(e));return new rA(i)}}const Cde={provide:class bde{constructor(){return CP(E9)}},deps:[[new jr,WO]]},Ide={provide:rA,useFactory:function wde(n,t){const e=function H5(n,t,e){if(t){if(1===t.length)return t[0];const o=t.filter(l=>l.app===e);if(1===o.length)return o[0]}return e.container.getProvider(n).getImmediate({optional:!0})}(E9,n,t);return e&&new rA(e)},deps:[[new jr,WO],nw]};let Tde=(()=>{class n{constructor(){(0,rc.registerVersion)("angularfire",wv.full,"fst")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=qi({type:n});static \u0275inj=Ai({providers:[Ide,Cde]})}return n})();function Dde(n,...t){return{ngModule:Tde,providers:[{provide:WO,useFactory:Ede(n),multi:!0,deps:[wi,Hr,IT,k6,[new jr,O6],[new jr,IP],...t]}]}}const Ade=TP(vde,!0),Sde=TP(hue,!0);function qO(){return Ot((n,t)=>{let e,i=!1;n.subscribe(_n(t,r=>{const o=e;e=r,i&&t.next([o,r]),i=!0}))})}function ZO(n,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new gn("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return t}function C9(){if(typeof Uint8Array>"u")throw new gn("unimplemented","Uint8Arrays are not available in this environment.")}function I9(){if(!function Nae(){return typeof atob<"u"}())throw new gn("unimplemented","Blobs are unavailable in Firestore in this environment.")}class fE{constructor(t){this._delegate=t}static fromBase64String(t){return I9(),new fE(Mf.fromBase64String(t))}static fromUint8Array(t){return C9(),new fE(Mf.fromUint8Array(t))}toBase64(){return I9(),this._delegate.toBase64()}toUint8Array(){return C9(),this._delegate.toUint8Array()}isEqual(t){return this._delegate.isEqual(t._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function KO(n){return function kde(n,t){if("object"!=typeof n||null===n)return!1;const e=n;for(const i of t)if(i in e&&"function"==typeof e[i])return!0;return!1}(n,["next","error","complete"])}class Rde{enableIndexedDbPersistence(t,e){return function fue(n,t){Q7(n=Cr(n,Ho));const e=Vs(n);if(e._uninitializedComponentsProvider)throw new gn(jt.FAILED_PRECONDITION,"SDK cache is already specified.");Fc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const i=n._freezeSettings(),r=new ux;return X7(e,r,new vO(r,i.cacheSizeBytes,t?.forceOwnership))}(t._delegate,{forceOwnership:e})}enableMultiTabIndexedDbPersistence(t){return function pue(n){Q7(n=Cr(n,Ho));const t=Vs(n);if(t._uninitializedComponentsProvider)throw new gn(jt.FAILED_PRECONDITION,"SDK cache is already specified.");Fc("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings(),i=new ux;return X7(t,i,new R7(i,e.cacheSizeBytes))}(t._delegate)}clearIndexedDbPersistence(t){return function mue(n){if(n._initialized&&!n._terminated)throw new gn(jt.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new Ia;return n._queue.enqueueAndForgetEvenWhileRestricted((0,Jt.Z)(function*(){try{yield(e=(0,Jt.Z)(function*(r){if(!nh.D())return Promise.resolve();const o=r+"main";yield nh.delete(o)}),function i(r){return e.apply(this,arguments)})(dR(n._databaseId,n._persistenceKey)),t.resolve()}catch(e){t.reject(e)}var e})),t.promise}(t._delegate)}}class T9{constructor(t,e,i){this._delegate=e,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},t instanceof fg||(this._appCompat=t)}get _databaseId(){return this._delegate._databaseId}settings(t){const e=this._delegate._getSettings();!t.merge&&e.host!==t.host&&Fc("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)}useEmulator(t,e,i={}){Z7(this._delegate,t,e,i)}enableNetwork(){return function _ue(n){return function Qce(n){return n.asyncQueue.enqueue((0,Jt.Z)(function*(){const t=yield L7(n),e=yield N7(n);return t.setNetworkEnabled(!0),function(r){const o=zn(r);return o.C_.delete(0),tE(o)}(e)}))}(Vs(n=Cr(n,Ho)))}(this._delegate)}disableNetwork(){return function yue(n){return function Jce(n){return n.asyncQueue.enqueue((0,Jt.Z)(function*(){const t=yield L7(n),e=yield N7(n);return t.setNetworkEnabled(!1),(i=(0,Jt.Z)(function*(o){const l=zn(o);l.C_.add(0),yield ix(l),l.M_.set("Offline")}),function r(o){return i.apply(this,arguments)})(e);var i}))}(Vs(n=Cr(n,Ho)))}(this._delegate)}enablePersistence(t){let e=!1,i=!1;return t&&(e=!!t.synchronizeTabs,i=!!t.experimentalForceOwningTab,$7("synchronizeTabs",e,"experimentalForceOwningTab",i)),e?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function gue(n){return function(e){const i=new Ia;return e.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return function Fce(n,t){return iO.apply(this,arguments)}(yield TO(e),i)})),i.promise}(Vs(n=Cr(n,Ho)))}(this._delegate)}onSnapshotsInSync(t){return function Zue(n,t){return function nue(n,t){const e=new UD(t);return n.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return r=yield hx(n),o=e,zn(r).q_.add(o),void o.next();var r,o})),()=>{e.Na(),n.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return r=yield hx(n),o=e,void zn(r).q_.delete(o);var r,o}))}}(Vs(n=Cr(n,Ho)),MO(t)?t:{next:t})}(this._delegate,t)}get app(){if(!this._appCompat)throw new gn("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(t){try{return new mx(this,oE(this._delegate,t))}catch(e){throw ac(e,"collection()","Firestore.collection()")}}doc(t){try{return new ud(this,GD(this._delegate,t))}catch(e){throw ac(e,"doc()","Firestore.doc()")}}collectionGroup(t){try{return new lc(this,function lue(n,t){if(n=Cr(n,rE),AO("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new gn(jt.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new cl(n,null,(i=t,new Vp(Nr.emptyPath(),i)));var i}(this._delegate,t))}catch(e){throw ac(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(t){return function ode(n,t,e){n=Cr(n,Ho);const i=Object.assign(Object.assign({},ide),e);return function(o){if(o.maxAttempts<1)throw new gn(jt.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(o,l,f){const g=new Ia;return o.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){const b=yield function B7(n){return $D(n).then(t=>t.datastore)}(o);new Yce(o.asyncQueue,b,f,l,g).run()})),g.promise}(Vs(n),r=>t(new rde(n,r)),i)}(this._delegate,e=>t(new D9(this,e)))}batch(){return Vs(this._delegate),new A9(new m9(this._delegate,t=>px(this._delegate,t)))}loadBundle(t){return function vue(n,t){const e=Vs(n=Cr(n,Ho)),i=new uue;return function iue(n,t,e,i){const r=function(l,f){let g;return g="string"==typeof l?aj().encode(l):l,S=function(S,O){if(S instanceof Uint8Array)return O7(S,O);if(S instanceof ArrayBuffer)return O7(new Uint8Array(S),O);if(S instanceof ReadableStream)return S.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(g),new Zce(S,f);var S}(e,eE(t));n.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){!function Wce(n,t,e){const i=zn(n);var r;(r=(0,Jt.Z)(function*(l,f,g){try{const b=yield f.getMetadata();if(yield function(ge,Ce){const je=zn(ge),ft=Zs(Ce.createTime);return je.persistence.runTransaction("hasNewerBundle","readonly",ot=>je.Kr.getBundleMetadata(ot,Ce.id)).then(ot=>!!ot&&ot.createTime.compareTo(ft)>=0)}(l.localStore,b))return yield f.close(),g._completeWith({taskState:"Success",documentsLoaded:(ge=b).totalDocuments,bytesLoaded:ge.totalBytes,totalDocuments:ge.totalDocuments,totalBytes:ge.totalBytes}),Promise.resolve(new Set);g._updateProgress(C7(b));const S=new Ice(b,l.localStore,f.serializer);let O=yield f.Ma();for(;O;){const J=yield S.ea(O);J&&g._updateProgress(J),O=yield f.Ma()}const $=yield S.complete();return yield $p(l,$.ra,void 0),yield function(ge,Ce){const je=zn(ge);return je.persistence.runTransaction("Save bundle","readwrite",ft=>je.Kr.saveBundleMetadata(ft,Ce))}(l.localStore,b),g._completeWith($.progress),Promise.resolve($.na)}catch(b){return Fc("SyncEngine",`Loading bundle failed with ${b}`),g._failWith(b),Promise.resolve(new Set)}var ge}),function o(l,f,g){return r.apply(this,arguments)})(i,t,e).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}(yield TO(n),r,i)}))}(e,n._databaseId,t,i),i}(this._delegate,t)}namedQuery(t){return function xue(n,t){return function rue(n,t){return n.asyncQueue.enqueue((0,Jt.Z)(function*(){return function(i,r){const o=zn(i);return o.persistence.runTransaction("Get named query","readonly",l=>o.Kr.getNamedQuery(l,r))}(yield dx(n),t)}))}(Vs(n=Cr(n,Ho)),t).then(e=>e?new cl(n,null,e.query):null)}(this._delegate,t).then(e=>e?new lc(this,e):null)}}class oA extends NO{constructor(t){super(),this.firestore=t}convertBytes(t){return new fE(new Mf(t))}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return ud.forKey(e,this.firestore,null)}}class D9{constructor(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new oA(t)}get(t){const e=y0(t);return this._delegate.get(e).then(i=>new pE(this._firestore,new Gp(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,e.converter)))}set(t,e,i){const r=y0(t);return i?(ZO("Transaction.set",i),this._delegate.set(r,e,i)):this._delegate.set(r,e),this}update(t,e,i,...r){const o=y0(t);return 2===arguments.length?this._delegate.update(o,e):this._delegate.update(o,e,i,...r),this}delete(t){const e=y0(t);return this._delegate.delete(e),this}}class A9{constructor(t){this._delegate=t}set(t,e,i){const r=y0(t);return i?(ZO("WriteBatch.set",i),this._delegate.set(r,e,i)):this._delegate.set(r,e),this}update(t,e,i,...r){const o=y0(t);return 2===arguments.length?this._delegate.update(o,e):this._delegate.update(o,e,i,...r),this}delete(t){const e=y0(t);return this._delegate.delete(e),this}commit(){return this._delegate.commit()}}class _0{constructor(t,e,i){this._firestore=t,this._userDataWriter=e,this._delegate=i}fromFirestore(t,e){const i=new hE(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new mE(this._firestore,i),e??{})}toFirestore(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)}static getInstance(t,e){const i=_0.INSTANCES;let r=i.get(t);r||(r=new WeakMap,i.set(t,r));let o=r.get(e);return o||(o=new _0(t,new oA(t),e),r.set(e,o)),o}}_0.INSTANCES=new WeakMap;class ud{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new oA(t)}static forPath(t,e,i){if(t.length%2!=0)throw new gn("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${t.canonicalString()} has ${t.length}`);return new ud(e,new is(e._delegate,i,new $n(t)))}static forKey(t,e,i){return new ud(e,new is(e._delegate,i,t))}get id(){return this._delegate.id}get parent(){return new mx(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(t){try{return new mx(this.firestore,oE(this._delegate,t))}catch(e){throw ac(e,"collection()","DocumentReference.collection()")}}isEqual(t){return(t=(0,Do.m9)(t))instanceof is&&K7(this._delegate,t)}set(t,e){e=ZO("DocumentReference.set",e);try{return e?f9(this._delegate,t,e):f9(this._delegate,t)}catch(i){throw ac(i,"setDoc()","DocumentReference.set()")}}update(t,e,...i){try{return 1===arguments.length?p9(this._delegate,t):p9(this._delegate,t,e,...i)}catch(r){throw ac(r,"updateDoc()","DocumentReference.update()")}}delete(){return function que(n){return px(Cr(n.firestore,Ho),[new Zv(n._key,vs.none())])}(this._delegate)}onSnapshot(...t){const e=S9(t),i=M9(t,r=>new pE(this.firestore,new Gp(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return VO(this._delegate,e,i)}get(t){let e;return e="cache"===t?.source?function jue(n){n=Cr(n,is);const t=Cr(n.firestore,Ho),e=Vs(t),i=new Tg(t);return function eue(n,t){const e=new Ia;return n.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return(i=(0,Jt.Z)(function*(o,l,f){try{const g=yield function(S,O){const $=zn(S);return $.persistence.runTransaction("read document","readonly",J=>$.localDocuments.getDocument(J,O))}(o,l);g.isFoundDocument()?f.resolve(g):g.isNoDocument()?f.resolve(null):f.reject(new gn(jt.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(g){const b=sx(g,`Failed to get document '${l} from cache`);f.reject(b)}}),function r(o,l,f){return i.apply(this,arguments)})(yield dx(n),t,e);var i})),e.promise}(e,n._key).then(r=>new Gp(t,i,n._key,r,new g0(null!==r&&r.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===t?.source?function $ue(n){n=Cr(n,is);const t=Cr(n.firestore,Ho);return V7(Vs(t),n._key,{source:"server"}).then(e=>zO(t,n,e))}(this._delegate):function Uue(n){n=Cr(n,is);const t=Cr(n.firestore,Ho);return V7(Vs(t),n._key).then(e=>zO(t,n,e))}(this._delegate),e.then(i=>new pE(this.firestore,new Gp(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(t){return new ud(this.firestore,this._delegate.withConverter(t?_0.getInstance(this.firestore,t):null))}}function ac(n,t,e){return n.message=n.message.replace(t,e),n}function S9(n){for(const t of n)if("object"==typeof t&&!KO(t))return t;return{}}function M9(n,t){var e,i;let r;return r=KO(n[0])?n[0]:KO(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:o=>{r.next&&r.next(t(o))},error:null===(e=r.error)||void 0===e?void 0:e.bind(r),complete:null===(i=r.complete)||void 0===i?void 0:i.bind(r)}}class pE{constructor(t,e){this._firestore=t,this._delegate=e}get ref(){return new ud(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(t){return this._delegate.data(t)}get(t,e){return this._delegate.get(t,e)}isEqual(t){return h9(this._delegate,t._delegate)}}class mE extends pE{data(t){const e=this._delegate.data(t);return this._delegate._converter||function rae(n,t){n||ii()}(void 0!==e),e}}class lc{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new oA(t)}where(t,e,i){try{return new lc(this.firestore,Cg(this._delegate,function Mue(n,t,e){const i=t,r=XD("where",n);return dE._create(r,i,e)}(t,e,i)))}catch(r){throw ac(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(t,e){try{return new lc(this.firestore,Cg(this._delegate,function Pue(n,t="asc"){const e=t,i=XD("orderBy",n);return LO._create(i,e)}(t,e)))}catch(i){throw ac(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(t){try{return new lc(this.firestore,Cg(this._delegate,function kue(n){return W7("limit",n),QD._create("limit",n,"F")}(t)))}catch(e){throw ac(e,"limit()","Query.limit()")}}limitToLast(t){try{return new lc(this.firestore,Cg(this._delegate,function Rue(n){return W7("limitToLast",n),QD._create("limitToLast",n,"L")}(t)))}catch(e){throw ac(e,"limitToLast()","Query.limitToLast()")}}startAt(...t){try{return new lc(this.firestore,Cg(this._delegate,function Oue(...n){return JD._create("startAt",n,!0)}(...t)))}catch(e){throw ac(e,"startAt()","Query.startAt()")}}startAfter(...t){try{return new lc(this.firestore,Cg(this._delegate,function Fue(...n){return JD._create("startAfter",n,!1)}(...t)))}catch(e){throw ac(e,"startAfter()","Query.startAfter()")}}endBefore(...t){try{return new lc(this.firestore,Cg(this._delegate,function Lue(...n){return eA._create("endBefore",n,!1)}(...t)))}catch(e){throw ac(e,"endBefore()","Query.endBefore()")}}endAt(...t){try{return new lc(this.firestore,Cg(this._delegate,function Nue(...n){return eA._create("endAt",n,!0)}(...t)))}catch(e){throw ac(e,"endAt()","Query.endAt()")}}isEqual(t){return SO(this._delegate,t._delegate)}get(t){let e;return e="cache"===t?.source?function Gue(n){n=Cr(n,cl);const t=Cr(n.firestore,Ho),e=Vs(t),i=new Tg(t);return function tue(n,t){const e=new Ia;return n.asyncQueue.enqueueAndForget((0,Jt.Z)(function*(){return(i=(0,Jt.Z)(function*(o,l,f){try{const g=yield OD(o,l,!0),b=new D7(l,g.ls),S=b.ca(g.documents),O=b.applyChanges(S,!1);f.resolve(O.snapshot)}catch(g){const b=sx(g,`Failed to execute query '${l} against cache`);f.reject(b)}}),function r(o,l,f){return i.apply(this,arguments)})(yield dx(n),t,e);var i})),e.promise}(e,n._query).then(r=>new Ig(t,i,n,r))}(this._delegate):"server"===t?.source?function Wue(n){n=Cr(n,cl);const t=Cr(n.firestore,Ho),e=Vs(t),i=new Tg(t);return z7(e,n._query,{source:"server"}).then(r=>new Ig(t,i,n,r))}(this._delegate):function Hue(n){n=Cr(n,cl);const t=Cr(n.firestore,Ho),e=Vs(t),i=new Tg(t);return s9(n._query),z7(e,n._query).then(r=>new Ig(t,i,n,r))}(this._delegate),e.then(i=>new YO(this.firestore,new Ig(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...t){const e=S9(t),i=M9(t,r=>new YO(this.firestore,new Ig(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return VO(this._delegate,e,i)}withConverter(t){return new lc(this.firestore,this._delegate.withConverter(t?_0.getInstance(this.firestore,t):null))}}class Fde{constructor(t,e){this._firestore=t,this._delegate=e}get type(){return this._delegate.type}get doc(){return new mE(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class YO{constructor(t,e){this._firestore=t,this._delegate=e}get query(){return new lc(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(t=>new mE(this._firestore,t))}docChanges(t){return this._delegate.docChanges(t).map(e=>new Fde(this._firestore,e))}forEach(t,e){this._delegate.forEach(i=>{t.call(e,new mE(this._firestore,i))})}isEqual(t){return h9(this._delegate,t._delegate)}}class mx extends lc{constructor(t,e){super(t,e),this.firestore=t,this._delegate=e}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const t=this._delegate.parent;return t?new ud(this.firestore,t):null}doc(t){try{return new ud(this.firestore,void 0===t?GD(this._delegate):GD(this._delegate,t))}catch(e){throw ac(e,"doc()","CollectionReference.doc()")}}add(t){return BO(this._delegate,t).then(e=>new ud(this.firestore,e))}isEqual(t){return K7(this._delegate,t._delegate)}withConverter(t){return new mx(this.firestore,this._delegate.withConverter(t?_0.getInstance(this.firestore,t):null))}}function y0(n){return Cr(n,is)}class XO{constructor(...t){this._delegate=new Hp(...t)}static documentId(){return new XO(ts.keyField().canonicalString())}isEqual(t){return(t=(0,Do.m9)(t))instanceof Hp&&this._delegate._internalPath.isEqual(t._internalPath)}}class v0{constructor(t){this._delegate=t}static serverTimestamp(){const t=function ade(){return new PO("serverTimestamp")}();return t._methodName="FieldValue.serverTimestamp",new v0(t)}static delete(){const t=function sde(){return new aE("deleteField")}();return t._methodName="FieldValue.delete",new v0(t)}static arrayUnion(...t){const e=function lde(...n){return new Iue("arrayUnion",n)}(...t);return e._methodName="FieldValue.arrayUnion",new v0(e)}static arrayRemove(...t){const e=function cde(...n){return new Tue("arrayRemove",n)}(...t);return e._methodName="FieldValue.arrayRemove",new v0(e)}static increment(t){const e=function ude(n){return new Due("increment",n)}(t);return e._methodName="FieldValue.increment",new v0(e)}isEqual(t){return this._delegate.isEqual(t._delegate)}}const Lde={Firestore:T9,GeoPoint:WD,Timestamp:es,Blob:fE,Transaction:D9,WriteBatch:A9,DocumentReference:ud,DocumentSnapshot:pE,Query:lc,QueryDocumentSnapshot:mE,QuerySnapshot:YO,CollectionReference:mx,FieldPath:XO,FieldValue:v0,setLogLevel:function Ode(n){!function iae(n){lg.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function P9(n,t){return function Vde(n,t=uv){return new Kt(e=>{let i;return null!=t?t.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},e)}):i=n.onSnapshot({includeMetadataChanges:!0},e),()=>{i?.()}})}(n,t)}function QO(n,t){return P9(n,t).pipe($t(e=>({payload:e,type:"query"})))}!function Bde(n){(function Nde(n,t){n.INTERNAL.registerComponent(new $5.wA("firestore-compat",e=>{const i=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(i,r)},"PUBLIC").setServiceProps(Object.assign({},Lde)))})(n,(t,e)=>new T9(t,e,new Rde)),n.registerVersion("@firebase/firestore-compat","0.3.23")}(og.Z);class k9{ref;afs;constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const i=this.ref.collection(t),{ref:r,query:o}=B9(i,e);return new F9(r,o,this.afs)}snapshotChanges(){return function zde(n,t){return P9(n,t).pipe(mf(void 0),qO(),$t(e=>{const[i,r]=e;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(bu)}valueChanges(t={}){return this.snapshotChanges().pipe($t(({payload:e})=>t.idField?{...e.data(),[t.idField]:e.id}:e.data()))}get(t){return ne(this.ref.get(t)).pipe(bu)}}function sA(n,t){return QO(n,t).pipe(mf(void 0),qO(),$t(e=>{const[i,r]=e,o=r.payload.docChanges(),l=o.map(f=>({type:f.type,payload:f}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((f,g)=>{const b=o.find(O=>O.doc.ref.isEqual(f.ref)),S=i?.payload.docs.find(O=>O.ref.isEqual(f.ref));b&&JSON.stringify(b.doc.metadata)===JSON.stringify(f.metadata)||!b&&S&&JSON.stringify(S.metadata)===JSON.stringify(f.metadata)||l.push({type:"modified",payload:{oldIndex:g,newIndex:g,type:"modified",doc:f}})}),l}))}function R9(n,t,e){return sA(n,e).pipe(aT((i,r)=>function Ude(n,t,e){return t.forEach(i=>{e.indexOf(i.type)>-1&&(n=function jde(n,t){switch(t.type){case"added":if(!n[t.newIndex]||!n[t.newIndex].doc.ref.isEqual(t.doc.ref))return JO(n,t.newIndex,0,t);break;case"modified":if(null==n[t.oldIndex]||n[t.oldIndex].doc.ref.isEqual(t.doc.ref)){if(t.oldIndex!==t.newIndex){const e=n.slice();return e.splice(t.oldIndex,1),e.splice(t.newIndex,0,t),e}return JO(n,t.newIndex,1,t)}break;case"removed":if(n[t.oldIndex]&&n[t.oldIndex].doc.ref.isEqual(t.doc.ref))return JO(n,t.oldIndex,1)}return n}(n,i))}),n}(i,r.map(o=>o.payload),t),[]),Xn(),$t(i=>i.map(r=>({type:r.type,payload:r}))))}function JO(n,t,e,...i){const r=n.slice();return r.splice(t,e,...i),r}function O9(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class F9{ref;query;afs;constructor(t,e,i){this.ref=t,this.query=e,this.afs=i}stateChanges(t){let e=sA(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe($t(i=>i.filter(r=>t.indexOf(r.type)>-1)))),e.pipe(mf(void 0),qO(),aa(([i,r])=>r.length>0||!i),$t(([,i])=>i),bu)}auditTrail(t){return this.stateChanges(t).pipe(aT((e,i)=>[...e,...i],[]))}snapshotChanges(t){const e=O9(t);return R9(this.query,e,this.afs.schedulers.outsideAngular).pipe(bu)}valueChanges(t={}){return QO(this.query,this.afs.schedulers.outsideAngular).pipe($t(e=>e.payload.docs.map(i=>t.idField?{...i.data(),[t.idField]:i.id}:i.data())),bu)}get(t){return ne(this.query.get(t)).pipe(bu)}add(t){return this.ref.add(t)}doc(t){return new k9(this.ref.doc(t),this.afs)}}class $de{query;afs;constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?sA(this.query,this.afs.schedulers.outsideAngular).pipe($t(e=>e.filter(i=>t.indexOf(i.type)>-1)),aa(e=>e.length>0),bu):sA(this.query,this.afs.schedulers.outsideAngular).pipe(bu)}auditTrail(t){return this.stateChanges(t).pipe(aT((e,i)=>[...e,...i],[]))}snapshotChanges(t){const e=O9(t);return R9(this.query,e,this.afs.schedulers.outsideAngular).pipe(bu)}valueChanges(t={}){return QO(this.query,this.afs.schedulers.outsideAngular).pipe($t(i=>i.payload.docs.map(r=>t.idField?{[t.idField]:r.id,...r.data()}:r.data())),bu)}get(t){return ne(this.query.get(t)).pipe(bu)}}const L9=new Xt("angularfire2.enableFirestorePersistence"),N9=new Xt("angularfire2.firestore.persistenceSettings"),Hde=new Xt("angularfire2.firestore.settings"),Gde=new Xt("angularfire2.firestore.use-emulator");function B9(n,t=(e=>e)){return{query:t(n),ref:n}}let V9=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(e,i,r,o,l,f,g,b,S,O,$,J,ge,Ce,je,ft,ot){this.schedulers=g;const It=DP(e,f,i),Yt=S;O&&i6(It,f,$,ge,Ce,je,J,ft),[this.firestore,this.persistenceEnabled$]=q5(`${It.name}.firestore`,"AngularFirestore",It.name,()=>{const yn=f.runOutsideAngular(()=>It.firestore());if(o&&yn.settings(o),Yt&&yn.useEmulator(...Yt),r&&!sI(l)){const ai=()=>{try{return ne(yn.enablePersistence(b||void 0).then(()=>!0,()=>!1))}catch(Ri){return typeof console<"u"&&console.warn(Ri),Te(!1)}};return[yn,f.runOutsideAngular(ai)]}return[yn,Te(!1)]},[o,Yt,r])}collection(e,i){let r;r="string"==typeof e?this.firestore.collection(e):e;const{ref:o,query:l}=B9(r,i),f=this.schedulers.ngZone.run(()=>o);return new F9(f,l,this)}collectionGroup(e,i){const r=i||(l=>l),o=this.firestore.collectionGroup(e);return new $de(r(o),this)}doc(e){let i;i="string"==typeof e?this.firestore.doc(e):e;const r=this.schedulers.ngZone.run(()=>i);return new k9(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(i){return new(i||n)(it(TT),it(DT,8),it(L9,8),it(Hde,8),it(bl),it(wi),it(IT),it(N9,8),it(Gde,8),it(J1,8),it(X5,8),it(Q5,8),it(J5,8),it(e6,8),it(t6,8),it(n6,8),it(IP,8))};static \u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Wde=(()=>{class n{constructor(){og.Z.registerVersion("angularfire",wv.full,"fst-compat")}static enablePersistence(e){return{ngModule:n,providers:[{provide:L9,useValue:!0},{provide:N9,useValue:e}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=qi({type:n});static \u0275inj=Ai({providers:[V9]})}return n})(),z9=(()=>{class n{constructor(e){this.http=e,this.CryptoJS=Ve(7874),this._secretKey="superSecretKeyThatShouldBeStoredSecurely"}set(e,i){localStorage.setItem(e,this.CryptoJS.AES.encrypt(i,this._secretKey).toString())}get(e){const i=localStorage.getItem(e);if(!i)return[];try{const o=this.CryptoJS.AES.decrypt(i,this._secretKey).toString(this.CryptoJS.enc.Utf8);return JSON.parse(o)}catch{return[]}}getJsonData(){return this.http.get("assets/files/new-localizations.json")}static#e=this.\u0275fac=function(i){return new(i||n)(it(h1))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),gE=(()=>{class n{constructor(e,i,r,o,l,f){this.afAuth=e,this.firestore=i,this.angularFirestore=r,this.localStorageService=o,this.router=l,this.snackBar=f,this.localizationsSubject=new ee(null),this.localizations$=this.localizationsSubject.asObservable()}checkUserSession(){const e=localStorage.getItem("email");return e?ne(this.angularFirestore.collection("user-session",r=>r.where("email","==",e)).get()).pipe(ca(r=>(console.error("Error fetching documents:",r),Te(null))),bn(r=>{const o=r?.docs[0];return o?Te(o.data()):(console.error("No document found with email:",e),Te(null))}),ca(r=>(console.error("Error fetching user session data:",r),Te(null)))):Te(null)}saveSelection(e,i,r){const o={email:r,data:e,whishlist:i,updatedAt:(new Date).toISOString()},l=this.angularFirestore.collection("user-session",f=>f.where("email","==",r));return this._updateRef(l,o)}_updateRef(e,i){return ne(e.get()).pipe(ca(r=>(console.error("Error fetching documents:",r),Te(null))),bn(r=>{const o=r?.docs[0];return o?ne(o.ref.update(i)):Te(this._addRef(i))}),Dr(()=>{}),ca(r=>(console.error("Error updating document:",r),Te(null))))}_addRef(e){return ne(BO(oE(this.firestore,"user-session"),e)).pipe(Dr(()=>{}),ca(r=>(console.error(" No se ha a\xf1adido -> ",r),Te(null))))}getPlaces(){if(localStorage.getItem("lastUpdateTimestamp")){const r=this.localStorageService.get("lastUpdateTimestamp"),o=Date.now()-r>54e5;if(localStorage.getItem(Ba)&&this.localStorageService.get(Ba)&&this.localStorageService.get(Ba).length>0&&!o)return Te(this.localStorageService.get(Ba)).pipe(Dr(f=>{this.localizationsSubject.next(f)}),bn(()=>this.localizationsSubject.asObservable()))}const i=oE(this.firestore,Ba);return Ade(i,{idField:"id"}).pipe(Dr(r=>{this.localStorageService.set(Ba,JSON.stringify(r)),this.localStorageService.set("lastUpdateTimestamp",JSON.stringify(Date.now())),this.localizationsSubject.next(r)}))}postFirestoreLocalization(e){return this.afAuth.authState.pipe(bn(i=>i?(this.currentLocation&&(this.currentLocation=null),this.handleAuthenticatedUser(e)):(this.currentLocation=e,this.signInAndRetry())),ca(i=>(console.error("Error en la autenticaci\xf3n: ",i),Te(null))))}updateFirestoreLocalization(e,i){return ne(this.angularFirestore.collection(Ba,o=>o.where("customId","==",e)).get()).pipe(ca(o=>(console.error("Error fetching documents:",o),Te(null))),bn(o=>{const l=o?.docs[0];return l?ne(l.ref.update(i)):(console.error("No document found with customId:",e),Te(null))}),Dr(()=>{this._showNotification(`Localizaci\xf3n actualizada correctamente: ${i.name}`)}),ca(o=>(console.error("Error updating document:",o),Te(null))))}deleteFirestoreLocalization(e,i){return ne(this.angularFirestore.collection(Ba,o=>o.where("customId","==",e)).get()).pipe(ca(o=>(console.error("Error fetching documents:",o),Te(null))),bn(o=>{const l=o?.docs[0];return l?ne(l.ref.delete()):(console.error("No document found with customId:",e),Te(null))}),Dr(()=>{this._showNotification(`Localizaci\xf3n eliminada correctamente: ${i}`)}),ca(o=>(console.error("Error deleting document:",o),Te(null))))}firestoreLogout(){this.afAuth.signOut().then(()=>{this.router.navigate(["/"])}).catch(e=>{console.error("No se pudo completar el logout -> ",e)})}handleAuthenticatedUser(e){const i=[];i.push(e);const r=oE(this.firestore,Ba);return ne(Promise.all(i.map(o=>BO(r,o)))).pipe(Dr(()=>{this._showNotification(`Localizaci\xf3n a\xf1adida correctamente: ${e.name}`)}),ca(o=>(console.error(e.name," no se ha a\xf1adido -> ",o),Te(null))))}signInAndRetry(){return ne(this.afAuth.signInWithPopup(new j5.X)).pipe(bn(()=>this.postFirestoreLocalization(this.currentLocation)),ca(()=>Te(null)))}_showNotification(e){this.snackBar.open(e,"Cerrar",{duration:4e3,verticalPosition:"top",horizontalPosition:"center"})}eliminarDuplicados(){return(0,Jt.Z)(function*(){})()}static#e=this.\u0275fac=function(i){return new(i||n)(it(J1),it(rA),it(V9),it(z9),it(ic),it(P6))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),gx=(()=>{class n{get isMapReady(){return!!this._map}set selectedDay(e){this._selectedDay=e,0!==this._addedRouteIds.size&&this.clearRouteIds(),document.querySelector(".mapboxgl-popup")?.remove(),this._dates.filter(r=>r!==this._selectedDay).forEach(r=>{r.isSelected=!1});const i=this._dates.find(r=>r===this._selectedDay);i&&(i.isSelected=!0),i&&i.wishlist.length>1?this._checkDirections():this._centerMap()}get selectedDay(){return this._selectedDay}get selectedDayIndex(){return this.dates.findIndex(e=>e.isSelected)}get dates(){return this._dates}get whishlist(){return this._wishlist}set whishlist(e){this._wishlist=e}set dates(e){this._dates=e}set allowSave(e){this._saveChanges=e}set routeMarkers(e){this._routeMarkers=e}constructor(e,i,r){this.directionsApiClient=e,this.snackBar=i,this.localizationsService=r,this._markers=[],this._routeMarkers=[],this._addedRouteIds=new Set,this._dates=[],this._wishlist=[],this._route=[],this._saveChanges=!1,this._imageBaseUrl=AT,this.showArrows=new ui}setMap(e){this._map=e}flyTo(e){if(!this.isMapReady)throw Error("El mapa no est\xe1 inicializado");this._map?.flyTo({zoom:14,center:e})}saveSelection(){const e=localStorage.getItem("email");if(!e||!this._saveChanges)return;const i=this._dates.map(o=>({date:o.date,isSelected:o.isSelected,weekDay:o.weekDay,wishlist:JSON.stringify(o.wishlist.map(l=>({coords:JSON.stringify(l.coords),name:l.name,placeType:l.type,placeId:l.placeId??l.id,description:l.description}))),markers:JSON.stringify(o.markers)})),r=this.whishlist.map(o=>({placeName:o.placeName,customId:o.customId,description:o.description??"",coords:JSON.stringify(o.coords),marker:{}}));this.localizationsService.saveSelection(i,r,e).pipe(Dr(()=>{this._saveChanges=!1,localStorage.removeItem("favorites")})).subscribe()}wishlistFromSelectedDay(e){const i=this._dates.find(r=>r===this._selectedDay);i&&(i.wishlist=e)}resetMarkersFromPlaces(){this._markers.forEach(e=>e.remove())}addToRouteFromWhishlist(e,i){this._saveChanges=!0;const r=this._places.find(o=>o.name===e.placeName);this._checkDirections(e.coords,e.placeName,e.marker,i,r.type,r.customId,r.description,r.hasImage)}getPlaceData(e){const i=this._places.find(r=>r.name===e);if(i)return i}createMarkersFromPlaces(e,i){if(!this._map)throw Error("Mapa no inicializado");this._markers.forEach(g=>g.remove());const r=[];this._places=e,this._userLocation=i;const o=(g,b,S,O,$,J,ge)=>{this._selectedDay?(this._saveChanges=!0,this._checkDirections(g,b,S,void 0,O,$,J,ge)):this._showNotification("A\xf1ade al menos dos puntos a la lista de deseos para calcular la ruta.")},l=(g,b,S,O,$,J,ge,Ce,je,ft)=>{-1===this._wishlist.findIndex(It=>It.id===g)&&(this._wishlist.push({id:g,coords:b,placeName:S,marker:O,address:$,location:J,type:ge,customId:Ce,description:je,hasImage:ft}),this._saveChanges=!0,this.saveSelection())};for(const g of e){const[b,S]=[g.coords[0],g.coords[1]];let O=document.createElement("div");O.id=g.id;const $=g.type,J=l6[Object.values(c6).findIndex(ft=>ft===$)];O.className=`marker ${$}-marker`;let ge=g.description?`<h6 id="placeName">${g.name}</h6>\n        <span class="description">${g.description}</span>\n        <span>${g.adress}</span>\n        <br>\n        <span>${g.phoneNumber}</span>\n         ${g.infoUrl?`<span class="center-button">\n            <button target onclick="window.open('${g.infoUrl}','_blank')">Ver m\xe1s</button>\n          </span>`:""}\n        <div class="popup-buttons">\n          <button id="add-to-route" disabled>A\xf1adir a d\xeda seleccionado</button>\n          <span class="material-icons heart" id="add-to-wishlist" title="A\xf1adir a favoritos" style="cursor: not-allowed;">favorite</span>\n        </div>`:`<h6 id="placeName">${g.name}</h6>\n        ${g.description?`<span class="description">${g.description}</span>`:""}\n        <span>${g.adress}</span>\n        <br>\n        <span>${g.phoneNumber}</span>\n        ${g.infoUrl?`<span class="center-button">\n            <button target onclick="window.open('${g.infoUrl}','_blank')">Ver m\xe1s</button>\n          </span>`:""}\n        <div class="popup-buttons">\n          <button id="add-to-route" disabled>A\xf1adir a d\xeda seleccionado</button>\n          <span class="material-icons heart" id="add-to-wishlist" title="A\xf1adir a favoritos" style="cursor: not-allowed;">favorite</span>\n        </div>\n      `,Ce=(new Iv.Popup).setHTML(`<div class="custom-popup">${ge}</div>`);const je=new Iv.Marker({color:`${J}`}).setLngLat([b,S]).setPopup(Ce).addTo(this._map);je.getElement().addEventListener("click",()=>{setTimeout(()=>{const ft=document.getElementById("placeName");let ot=!0;if(ft){const yn=document.createElement("img");yn.src=`${this._imageBaseUrl}/${SP[g.type]}/${g.customId}.jpg`,yn.id=g.customId,ft.parentNode?.insertBefore(yn,ft.nextSibling);const ai=setTimeout(()=>{yn.src="",yn.remove(),ot=!1,this._enableButtons()},1500);yn.onload=()=>{clearTimeout(ai),ft.parentNode?.insertBefore(yn,ft.nextSibling);const Ri=function(Qr){const Ha=document.querySelector(".custom-popup");Ha&&!Ha.contains(Qr.target)&&(yn.remove(),document.removeEventListener("click",Ri))};document.addEventListener("click",Ri),this._enableButtons()}}setTimeout(()=>{const yn=document.getElementsByTagName("img")[0];yn?(!yn.id||"logo"===yn.id||100!==(yn.clientWidth||yn.width)&&(yn.clientHeight||yn.height)<50)&&(yn.parentNode?.removeChild(yn),ot=!1):ot=!1,g.hasImage=ot},60);const It=document.querySelector("#add-to-route");It instanceof HTMLButtonElement&&(It.onclick=function(){o([[b,S]],g.name,je,g.type,g.customId,g.description,g.hasImage),document.querySelector(".mapboxgl-popup")?.remove()});const Yt=document.querySelector("#add-to-wishlist");Yt instanceof HTMLElement&&(Yt.onclick=function(){l(g.id,[[b,S]],g.name,je,g.adress,g.location,g.type,g.customId,g.description,g.hasImage),document.querySelector(".mapboxgl-popup")?.remove()}),ft||this._enableButtons()},160)}),r.push(je)}this._markers=r;const f=localStorage.getItem("favorites");f&&(JSON.parse(f).forEach(b=>{const S=this.getPlaceData(b);if(S){const O={id:S.id,coords:S.coords,placeName:S.name,address:S.adress,location:S.location,type:S.type,customId:S.customId,description:S.description,marker:this.getMarker(S.coords),hasImage:S.hasImage};this.whishlist.push(O)}}),this._saveChanges=!0),0!==e.length&&this._centerMap()}getMarker(e){const i=this._markers.findIndex(r=>r.getLngLat().lat===e[1]&&r.getLngLat().lng===e[0]);if(-1!==i)return this._markers[i]}_enableButtons(){setTimeout(()=>{const e=document.getElementById("add-to-route"),i=document.getElementById("add-to-wishlist");e&&(e.disabled=!1),i&&(i.style.cursor="pointer",i.classList.remove("disabled"))},80)}_centerMap(){const e=new Iv.LngLatBounds;this._markers.forEach(i=>e.extend(i.getLngLat())),e.extend(this._userLocation),this._map?.fitBounds(e,{padding:100})}_showNotification(e){this.snackBar.open(e,"Cerrar",{duration:4e3,verticalPosition:"top",horizontalPosition:"center"})}_checkDirections(e,i,r,o,l,f,g,b){const S=o??this._selectedDay,O=this._dates.findIndex(ge=>ge===S),$=this._dates[O],J=(O%6+6)%6;if($){if(e&&i){if($.wishlist.find(Ce=>Ce.id===f))return void this._showNotification("Destino a\xf1adido previamente al d\xeda seleccionado");$.wishlist.push({coords:e,name:i,marker:r,type:l,id:f,description:g,hasImage:b}),r&&this._routeMarkers.push(r),this._showNotification("Destino a\xf1adido correctamente")}this.showArrows.emit($.wishlist.length),$.wishlist.length>1&&(0!==this._addedRouteIds.size&&this.clearRouteIds(),$.wishlist.forEach(ge=>{this._routeMarkers.find(je=>je===ge.marker)||this._routeMarkers.push(ge.marker)}),this._calculateRouteRecursively($.wishlist.map(ge=>ge.coords),J),setTimeout(()=>{this.generateReport()},800))}}_createCustomMarker(e){const i=document.createElement("div");return i.className=`${e}-marker`,i}recalculateDirections(){this._checkDirections()}clearRouteIds(){this._route=[],this._routeMarkers=[],this._addedRouteIds.forEach(e=>{this._map?.getLayer(e)&&(this._map.removeLayer(e),this._map.removeSource(e))}),this._addedRouteIds.clear()}_calculateRouteRecursively(e,i){if(e.length<2)return;const r=e[0],o=e[1];if(r&&o){const l=`RouteString_${r.join(",")}_${o.join(",")}`;this.getRouteBetweenPoints(r,o,l,AP[i]),this._calculateRouteRecursively(e.slice(1),i)}}getRouteBetweenPoints(e,i,r,o){this._route=[],this.directionsApiClient.get(`/${e.join(",")};${i.join(",")}`).pipe(Dr(l=>{this._route.push(l.routes[0]),this.drawPolyline(r,o);const f=new Iv.LngLatBounds;this._routeMarkers.forEach(g=>f.extend(g?.getLngLat())),this._map?.fitBounds(f,{padding:200})})).subscribe()}drawPolyline(e,i){if(!this._map)throw Error("Mapa no inicializado");this._route.forEach(r=>{this._addedRouteIds.add(e);const o={type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:r.geometry.coordinates}}]}};this._map?.getLayer(e)&&(this._map.removeLayer(e),this._map.removeSource(e)),this._map?.addSource(e,o),this._map?.addLayer({id:e,type:"line",source:e,layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":i,"line-width":3}})})}generateReport(){const e=[];return this._route=this.removeDuplicatedByProperty(this._route),this._route.forEach((i,r)=>{i.legs.forEach(o=>{o.steps.forEach(l=>{e.push({route:r,instructions:{duration:l.duration,distance:l.distance/1e3,maneuver:l.maneuver.instruction},totalDistance:i.distance/1e3,totalDuration:i.duration})})})}),e}removeDuplicatedByProperty(e){return e.filter((r,o,l)=>o===l.findIndex(f=>JSON.stringify(f)===JSON.stringify(r)))}static#e=this.\u0275fac=function(i){return new(i||n)(it(Ore),it(P6),it(gE))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qde(n,t){if(1&n&&(ht(0,"option",26),on(1),pt()),2&n){const e=t.$implicit;un("value",In(2).typesMapping[e]),X(1),Ro(e)}}function Zde(n,t){if(1&n){const e=Qo();ht(0,"button",31),Qn("click",function(){return _i(e),Gn(In(2).resetAddMore())}),on(1,"Limpiar campos"),pt()}}function Kde(n,t){if(1&n){const e=Qo();ht(0,"div",4)(1,"div",5)(2,"form",6),Qn("ngSubmit",function(){return _i(e),Gn(In().onSubmit())}),ht(3,"label",7),on(4,"Nombre:"),pt(),Ji(5,"input",8),ht(6,"label",9),on(7,"Tipo:"),pt(),ht(8,"select",10),Yn(9,qde,2,2,"option",11),pt(),ht(10,"label",12),on(11,"Ubicaci\xf3n:"),pt(),Ji(12,"input",13),ht(13,"label",14),on(14,"Coords:"),pt(),Ji(15,"input",15),ht(16,"label",16),on(17,"Direcci\xf3n:"),pt(),Ji(18,"input",17),ht(19,"label",18),on(20,"Tel\xe9fono:"),pt(),Ji(21,"input",19),ht(22,"label",20),on(23,"Tiempo estimado:"),pt(),Ji(24,"input",21),ht(25,"label",22),on(26,"Descripci\xf3n:"),pt(),Ji(27,"input",23),ht(28,"label",24),on(29,"Visible:"),pt(),ht(30,"select",25)(31,"option",26),on(32,"Mostrar"),pt(),ht(33,"option",26),on(34,"Ocultar"),pt()(),ht(35,"label",27),on(36,"Custom ID:"),pt(),Ji(37,"input",28),ht(38,"button",29),on(39,"Guardar"),pt(),Yn(40,Zde,2,0,"button",30),pt()()()}if(2&n){const e=In();X(2),un("formGroup",e.form),X(7),un("ngForOf",e.typesMappingKeys),X(22),un("value",!0),X(2),un("value",!1),X(4),ro("readonly",!!e.isEditForm||null),X(1),un("disabled",e.form.invalid),X(2),un("ngIf",!e.isEditForm)}}let Yde=(()=>{class n{constructor(e){this.formBuilder=e,this.isEditForm=!1,this.formSubmitted=new ui,this.modalClosed=new ui,this.typesMapping=c6,this.typesMappingKeys=[]}ngOnInit(){this.typesMappingKeys=Object.keys(this.typesMapping),this.initializeForm(),this.toggleCustomIdValidation()}ngOnChanges(e){e.isEditForm&&!e.isEditForm.isFirstChange()&&this.toggleCustomIdValidation()}initializeForm(){this.formData.type||(this.formData.type=Object.values(this.typesMapping)[0]),this.formData&&(this.form=this.formBuilder.group({name:[this.formData.name||"",Qm.required],type:[this.formData.type,Qm.required],location:[this.formData.location||""],coords:[this.formData.coords||[],Qm.required],adress:[this.formData.adress||""],phoneNumber:[this.formData.phoneNumber||""],estimatedTime:[this.formData.estimatedTime||""],description:[this.formData.description||""],visible:[this.formData.visible??!0],customId:[this.formData.customId||""]}))}toggleCustomIdValidation(){const e=this.form.get("customId");e&&(this.isEditForm?e.clearValidators():e.setValidators([Qm.required]),e.updateValueAndValidity())}onSubmit(){this.form.valid&&this.formSubmitted.emit(this.form.value)}closeModal(){this.modalClosed.emit()}resetAddMore(){this.form.reset()}static#e=this.\u0275fac=function(i){return new(i||n)(H(QV))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-edit-location"]],inputs:{formData:"formData",isEditForm:"isEditForm"},outputs:{formSubmitted:"formSubmitted",modalClosed:"modalClosed"},features:[P],decls:4,vars:1,consts:[[1,"modal-overlay",3,"click"],[1,"modal-container"],[1,"modal-content"],["class","popup-container",4,"ngIf"],[1,"popup-container"],[1,"popup-content"],[3,"formGroup","ngSubmit"],["for","nombre"],["type","text","formControlName","name","id","nombre"],["for","type"],["formControlName","type","id","type"],[3,"value",4,"ngFor","ngForOf"],["for","location"],["type","text","formControlName","location","id","location"],["for","coords"],["type","text","formControlName","coords","id","coords"],["for","adress"],["type","text","formControlName","adress","id","adress"],["for","phoneNumber"],["type","text","formControlName","phoneNumber","id","phoneNumber"],["for","estimatedTime"],["type","text","formControlName","estimatedTime","id","estimatedTime"],["for","description"],["type","text","formControlName","description","id","description"],["for","visible"],["formControlName","visible","id","visible"],[3,"value"],["for","customId"],["type","text","formControlName","customId","id","customId"],["type","submit",3,"disabled"],["type","button",3,"click",4,"ngIf"],["type","button",3,"click"]],template:function(i,r){1&i&&(ht(0,"div",0),Qn("click",function(){return r.closeModal()}),pt(),ht(1,"div",1)(2,"div",2),Yn(3,Kde,41,7,"div",3),pt()()),2&i&&(X(3),un("ngIf",r.formData))},dependencies:[Ap,Yd,F2,NV,VV,x1,VI,I2,T2,Jm,BI],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px;padding:15px}form[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%]{background-color:#f4f4f4;color:#666;border:1px solid #ccc;cursor:not-allowed}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080}.modal-container[_ngcontent-%COMP%]{width:25%;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#fff;padding:20px;border-radius:5px;z-index:9999}"]})}return n})();function Xde(n,t){if(1&n){const e=Qo();ht(0,"app-edit-location",7),Qn("formSubmitted",function(r){return _i(e),Gn(In(2).saveNewLocation(r))})("modalClosed",function(){return _i(e),Gn(In(2).showEditModal=!1)}),pt()}2&n&&un("formData",In(2).formEditData)("isEditForm",!1)}function Qde(n,t){if(1&n&&(ht(0,"div"),Yn(1,Xde,1,2,"app-edit-location",6),pt()),2&n){const e=In();X(1),un("ngIf",e.showEditModal)}}function Jde(n,t){if(1&n){const e=Qo();ht(0,"button",3),Qn("click",function(){return _i(e),Gn(In(3).toggleExample())}),on(1,"Ver ejemplo"),pt()}}function ehe(n,t){if(1&n&&(ht(0,"div",20),Ji(1,"textarea",21)(2,"br"),Yn(3,Jde,2,0,"button",22),pt()),2&n){const e=In(2);X(3),un("ngIf",e.form.value.useText)}}function the(n,t){1&n&&(ht(0,"div",20),Ji(1,"input",23),pt())}function nhe(n,t){1&n&&(ht(0,"span"),on(1,"Debe marcar la casilla de conformidad"),pt())}function ihe(n,t){if(1&n&&(ht(0,"span"),on(1),pt()),2&n){const e=In(2);X(1),ys("Hay un error en el texto introducido: ",e.errorMessage,"")}}function rhe(n,t){1&n&&(ht(0,"span",24),on(1,"\xa1Localizaciones actualizadas correctamente!"),pt())}function ohe(n,t){if(1&n&&(ht(0,"span"),Ji(1,"br"),ht(2,"span"),on(3,"El valor de coords debe ser primero el valor negativo y despu\xe9s el valor positivo"),pt(),Ji(4,"br"),ht(5,"code"),on(6,"Datos de ejemplo:"),pt(),Ji(7,"br"),ht(8,"pre")(9,"code"),on(10),pt()()()),2&n){const e=In(2);X(10),Ro(e.jsonExample)}}const U9=function(n){return{enabled:n}};function she(n,t){if(1&n){const e=Qo();ht(0,"div")(1,"form",8),Qn("ngSubmit",function(){return _i(e),Gn(In().onSubmit())}),ht(2,"div",9)(3,"div",10)(4,"label",11),on(5,"Archivo JSON "),pt(),ht(6,"div",12),Qn("click",function(){return _i(e),Gn(In().toggleCheckbox())}),Ji(7,"input",13)(8,"label"),pt(),ht(9,"label",11),on(10,"Texto "),pt()(),Yn(11,ehe,4,1,"div",14),Yn(12,the,2,0,"div",14),pt(),ht(13,"div",15)(14,"input",16),Qn("change",function(){return _i(e),Gn(In().onCheckboxChange())}),pt(),ht(15,"label"),on(16,"Al marcar el siguiente check se confirma que la integridad de los datos a a\xf1adir ha sido revisada por el autor de la actualizaci\xf3n de los datos"),pt()(),ht(17,"span",17)(18,"button",18),on(19,"Enviar"),pt(),Yn(20,nhe,2,0,"span",4),Yn(21,ihe,2,1,"span",4),Yn(22,rhe,2,0,"span",19),pt(),Yn(23,ohe,11,1,"span",4),pt()()}if(2&n){const e=In();let i;X(1),un("formGroup",e.form),X(3),un("ngClass",Kb(11,U9,!e.form.value.useText)),X(3),un("checked",null==(i=e.form.get("useText"))?null:i.value),X(2),un("ngClass",Kb(13,U9,e.form.value.useText)),X(2),un("ngIf",e.form.value.useText),X(1),un("ngIf",!e.form.value.useText),X(6),un("disabled",!e.acceptTerms),X(2),un("ngIf",!e.acceptTerms),X(1),un("ngIf",e.showError),X(1),un("ngIf",e.showSuccess),X(1),un("ngIf",e.showExample&&e.form.value.useText)}}function ahe(n,t){if(1&n){const e=Qo();ht(0,"button",34),Qn("click",function(){return _i(e),Gn(In(2).toggleFilters())}),on(1," * FILTROS * "),pt()}}function lhe(n,t){if(1&n){const e=Qo();ht(0,"button",34),Qn("click",function(){_i(e);const r=In(2);return Gn(r.showSearchBox=!r.showSearchBox)}),on(1," * BUSCAR * "),pt()}}function che(n,t){if(1&n){const e=Qo();ht(0,"div",26),Ji(1,"input",35,36),ht(3,"button",3),Qn("click",function(){_i(e);const r=AC(2);return Gn(In(2).search(r.value))}),ht(4,"span",37),on(5,"search"),pt()(),ht(6,"button",3),Qn("click",function(){return _i(e),Gn(In(2).closeSearch())}),on(7,"Cerrar"),pt()()}}function uhe(n,t){if(1&n){const e=Qo();ht(0,"div",40)(1,"button",3),Qn("click",function(){const r=_i(e),o=r.$implicit,l=r.index;return Gn(In(3).setFilter(o,l))}),on(2),pt()()}if(2&n){const e=t.$implicit,i=t.index,r=In(3);X(1),zo("active",i===r.activeButtonIndex),X(1),Ro(e)}}function dhe(n,t){if(1&n&&(ht(0,"div",38),Yn(1,uhe,3,3,"div",39),pt()),2&n){const e=In(2);X(1),un("ngForOf",e.options)}}function hhe(n,t){if(1&n){const e=Qo();ht(0,"tr")(1,"td",41),on(2),pt(),ht(3,"td"),on(4),pt(),ht(5,"td"),on(6),pt(),ht(7,"td"),on(8),pt(),ht(9,"td"),on(10),pt(),ht(11,"td"),on(12),pt(),ht(13,"td"),on(14),pt(),ht(15,"td"),on(16),pt(),ht(17,"td")(18,"span",42),Qn("click",function(){const o=_i(e).$implicit;return Gn(In(2).openEditForm(o))}),ht(19,"mat-icon"),on(20,"edit"),pt()(),ht(21,"span",43),Qn("click",function(){const o=_i(e).$implicit;return Gn(In(2).removeItem(o.customId))}),ht(22,"mat-icon"),on(23,"delete"),pt()()()()}if(2&n){const e=t.$implicit;X(2),Ro(e.name),X(2),Ro(e.location),X(2),Ro(e.type),X(2),Ro(e.adress),X(2),Ro(e.phoneNumber),X(2),Ro(e.estimatedTime),X(2),Ro(e.description),X(2),Ro(e.visible)}}function fhe(n,t){if(1&n){const e=Qo();ht(0,"app-edit-location",44),Qn("formSubmitted",function(r){return _i(e),Gn(In(2).editItem(r))})("modalClosed",function(){return _i(e),Gn(In(2).showEditModal=!1)}),pt()}if(2&n){const e=In(2);un("isEditForm",!0)("formData",e.formEditData)}}function phe(n,t){if(1&n){const e=Qo();ht(0,"div",25)(1,"div",26),Yn(2,ahe,2,0,"button",27),Yn(3,lhe,2,0,"button",27),Yn(4,che,8,0,"div",28),pt(),Yn(5,dhe,2,1,"div",29),ht(6,"table")(7,"thead")(8,"tr")(9,"th"),on(10,"Nombre"),pt(),ht(11,"th"),on(12,"Localidad"),pt(),ht(13,"th"),on(14,"Tipo de recurso"),pt(),ht(15,"th"),on(16,"Direcci\xf3n"),pt(),ht(17,"th"),on(18,"Tel\xe9fono"),pt(),ht(19,"th"),on(20,"Tiempo estimado"),pt(),ht(21,"th"),on(22,"Descripci\xf3n"),pt(),ht(23,"th"),on(24,"Visible"),pt(),ht(25,"th"),on(26,"Acciones"),pt()()(),ht(27,"tbody"),Yn(28,hhe,24,8,"tr",30),pt()(),ht(29,"div",31)(30,"button",32),Qn("click",function(){return _i(e),Gn(In().goToFirstPage())}),on(31,"Primera"),pt(),ht(32,"button",32),Qn("click",function(){return _i(e),Gn(In().previousPage())}),on(33,"Anterior"),pt(),ht(34,"span"),on(35),pt(),ht(36,"button",32),Qn("click",function(){return _i(e),Gn(In().nextPage())}),on(37,"Siguiente"),pt(),ht(38,"button",32),Qn("click",function(){return _i(e),Gn(In().goToLastPage())}),on(39,"\xdaltima"),pt()(),Yn(40,fhe,1,2,"app-edit-location",33),pt()}if(2&n){const e=In();X(2),un("ngIf","tableTab"===e.currentTab),X(1),un("ngIf","tableTab"===e.currentTab&&!e.showSearchBox),X(1),un("ngIf","tableTab"===e.currentTab&&e.showSearchBox),X(1),un("ngIf",e.showFilters&&"tableTab"===e.currentTab),X(23),un("ngForOf",e.currentItems),X(2),un("disabled",1===e.currentPage),X(2),un("disabled",1===e.currentPage),X(3),$y("",e.currentPage," de ",e.totalPages,""),X(1),un("disabled",e.currentPage===e.totalPages),X(2),un("disabled",e.currentPage===e.totalPages),X(2),un("ngIf",e.showEditModal)}}let mhe=(()=>{class n{constructor(e,i,r){this.localizationsService=e,this.formBuilder=i,this.localStorageService=r,this.formData={},this.formEditData={},this.acceptTerms=!1,this.showError=!1,this.showSuccess=!1,this.errorMessage="",this._prevLocations=this.localStorageService.get(Ba),this._safePrevLocations=[],this.currentTab="add-text-locations",this.currentPage=1,this.itemsPerPage=20,this.currentItems=[],this.showFilters=!1,this.activeButtonIndex=null,this.isChecked=!1,this.showEditModal=!1,this.jsonExample='\n  [\n    {\n      "adress": "",\n      "phoneNumber": "",\n      "estimatedTime": "",\n      "location": "",\n      "type": "",\n      "customId": "",\n      "name": "", \n      "description": "",\n      "coords": [-5.92976892902797, 40.259144108962104],\n      "visible": ""\n    },\n    {\n      "adress": "",\n      "phoneNumber": "",\n      "estimatedTime": "",\n      "location": "",\n      "type": "",\n      "customId": "",\n      "name": "", \n      "description": "",\n      "coords": [-5.92976892902797, 40.259144108962104],\n      "visible": ""\n    }\n  ]',this.showExample=!1,this.showSearchBox=!1,this.optionsMapping=u6,this.options=Object.keys(this.optionsMapping),this.unsubscribe$=new Oe,this.form=this.formBuilder.group({useText:[!1],textData:[""],jsonData:[""],isChecked:[!1]})}ngOnInit(){this._prevLocations.length<=0?this.localizationsService.getPlaces().pipe(ld(this.unsubscribe$),Ls(1),s6(10),$t(e=>e.filter(i=>"true"===i.visible)),Dr(e=>{this._safePrevLocations=e,this._prevLocations=e,this._splitItemsIntoPages()}),Gm(()=>{})).subscribe():(this._safePrevLocations=JSON.parse(JSON.stringify(this._prevLocations)),this._splitItemsIntoPages())}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}postLocation(e){const i=this.localStorageService.get(Ba);this.localizationsService.postFirestoreLocalization(e).pipe(ld(this.unsubscribe$),Dr(()=>{i.push(e),this._prevLocations=[...i],this.localStorageService.set(Ba,JSON.stringify(this._prevLocations)),this.currentPage=1,this._splitItemsIntoPages()})).subscribe()}toggleExample(){this.showExample=!this.showExample}onCheckboxChange(){this.acceptTerms=!this.acceptTerms}firestoreLogout(){this.localizationsService.firestoreLogout()}saveNewLocation(e){if(this.form.valid){const[i,r]=e.coords.split(",").map(b=>Number(b.trim())),g={adress:e.adress,phoneNumber:e.phoneNumber,estimatedTime:e.estimatedTime,location:e.location,type:e.type,name:e.name,description:e.description,coords:[i<0?i:r,r>0?r:i],customId:e.customId,visible:!0};try{this.showError=!1,this.showSuccess=!1;const b=JSON.parse(JSON.stringify(g));this._manageObject(b,!1)}catch{this.showError=!0,this.showSuccess=!1,this.errorMessage="Error en el formato JSON"}}}onSubmit(){if(this.acceptTerms&&this.form.valid){if(this.isChecked=!1,this.formData={textData:this.form.value.useText?this.form.value.textData:void 0,jsonData:this.form.value.useText?void 0:this.form.value.jsonData},this.form.value.useText&&this.formData.textData)try{this.showError=!1,this.showSuccess=!1;const e=JSON.parse(this.formData.textData),i=Array.isArray(e);i||this._manageObject(e),i&&e.forEach(r=>{this._manageObject(r)})}catch{this.showError=!0,this.showSuccess=!1,this.errorMessage="Error en el formato JSON"}if(!this.form.value.useText&&this.formData.jsonData){const i=document.getElementById("fileInput").files[0];if(i){const r=new FileReader;try{r.onload=o=>{this._fileContent=JSON.parse(r.result),Array.isArray(this._fileContent)?this._fileContent.forEach(l=>{this._manageObject(l)}):this._manageObject(location)}}catch{this.showError=!0,this.showSuccess=!1,this.errorMessage="Error al analizar el archivo JSON"}r.onerror=o=>{console.error("Filereader error: ",r.error)},r.readAsText(i)}}}}toggleFilters(){this.showFilters=!this.showFilters}setFilter(e,i){this.activeButtonIndex=0===i?null:i,"Restablecer"===e?this._restoreLocalizations():this._getLocalizationsWithFilter(this.optionsMapping[e])}_restoreLocalizations(){this._prevLocations=this.localStorageService.get(Ba),this.currentPage=1,this._splitItemsIntoPages()}_getLocalizationsWithFilter(e){this._prevLocations=this.localStorageService.get(Ba),this._prevLocations=this._prevLocations.filter(i=>i.type.includes(e)),this.currentPage=1,this._splitItemsIntoPages()}openEditForm(e){this.formEditData=e,this.showEditModal=!0}editItem(e){const i=this.localStorageService.get(Ba),r=i.findIndex(o=>o.customId===e.customId);-1!==r&&this.localizationsService.updateFirestoreLocalization(e.customId,e).pipe(ld(this.unsubscribe$),Dr(()=>{i[r]=e,this._prevLocations=i,this.localStorageService.set(Ba,JSON.stringify(this._prevLocations)),this._splitItemsIntoPages(),this.showEditModal=!1})).subscribe()}removeItem(e){const i=this.localStorageService.get(Ba),r=i.findIndex(o=>o.customId===e);-1!==r&&this.localizationsService.deleteFirestoreLocalization(e,i[r].name).pipe(ld(this.unsubscribe$),Dr(()=>{this._prevLocations=i.filter(o=>o.customId!==e),this.currentPage=1,this.localStorageService.set(Ba,JSON.stringify(this._prevLocations)),this._splitItemsIntoPages()})).subscribe()}previousPage(){this.currentPage>1&&(this.currentPage--,this._splitItemsIntoPages())}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this._splitItemsIntoPages())}goToFirstPage(){this.currentPage=1,this._splitItemsIntoPages()}goToLastPage(){this.currentPage=this.totalPages,this._splitItemsIntoPages()}_manageObject(e,i=!0){this._checkLocationProperties(e,i)?this._handleLocation(e,i):(this.showError=!0,this.showSuccess=!1,this.errorMessage="Error en el formato")}_handleLocation(e,i=!1){const r=e.coords[0]<0?e.coords[0]:e.coords[1],o=e.coords[0]>0?e.coords[0]:e.coords[1],l=this._prevLocations.filter(f=>f.coords[0]===r&&f.coords[1]===o);this.showError=l.length>0&&!this._checkLocationProperties(e,i),this.showError&&(this.errorMessage="Esta localizaci\xf3n ya existe"),this.showError||(this.postLocation(e),this.showError=!1,this.errorMessage="",this.acceptTerms=!1,this.showSuccess=!0,setTimeout(()=>{this.showSuccess=!1,this.form.patchValue({isChecked:!1}),this.toggleCheckbox()},900))}_checkLocationProperties(e,i){return"coords"in e&&Array.isArray(e.coords)&&"number"==typeof e.coords[0]&&"number"==typeof e.coords[1]&&(!i||"customId"in e&&"string"==typeof e.customId)&&"location"in e&&"string"==typeof e.location&&"name"in e&&"string"==typeof e.name&&"type"in e&&"string"==typeof e.type}_splitItemsIntoPages(){this._prevLocations.sort((o,l)=>o.name.localeCompare(l.name));const e=this._prevLocations.length;this.totalPages=Math.ceil(e/this.itemsPerPage);const i=(this.currentPage-1)*this.itemsPerPage,r=Math.min(i+this.itemsPerPage,e);this.currentItems=this._prevLocations.slice(i,r)}toggleCheckbox(){const e=this.form.get("useText")?.value;this.form.get("useText")?.setValue(!e)}search(e){const i=this._prevLocations.filter(r=>r.name.toLowerCase().includes(e.toLowerCase())||r.location.toLowerCase().includes(e.toLowerCase()));this._prevLocations=i,this._splitItemsIntoPages(),this.currentPage=1}closeSearch(){this.showSearchBox=!1,this._prevLocations=this._safePrevLocations,this._splitItemsIntoPages(),this.currentPage=1}static#e=this.\u0275fac=function(i){return new(i||n)(H(gE),H(QV),H(z9))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-add-locations"]],decls:14,vars:9,consts:[[1,"logout-button"],[1,"logout",3,"click"],[1,"tab-buttons"],[3,"click"],[4,"ngIf"],["class","table",4,"ngIf"],[3,"formData","isEditForm","formSubmitted","modalClosed",4,"ngIf"],[3,"formData","isEditForm","formSubmitted","modalClosed"],[3,"formGroup","ngSubmit"],[1,"inputs"],[1,"selector"],[3,"ngClass"],[1,"toggle",3,"click"],["type","checkbox","formControlName","useText",3,"checked"],["class","form-input",4,"ngIf"],[1,"user-info"],["type","checkbox","formControlName","isChecked",3,"change"],[1,"footer"],["type","submit",3,"disabled"],["class","showSuccess",4,"ngIf"],[1,"form-input"],["id","text","type","text","formControlName","textData"],[3,"click",4,"ngIf"],["id","fileInput","type","file","formControlName","jsonData"],[1,"showSuccess"],[1,"table"],[1,"search-btn"],["class","filter-btn",3,"click",4,"ngIf"],["class","search-btn",4,"ngIf"],["class","filters",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"pagination"],[3,"disabled","click"],[3,"isEditForm","formData","formSubmitted","modalClosed",4,"ngIf"],[1,"filter-btn",3,"click"],["type","text","placeholder","Escribe aqu\xed..."],["searchInput",""],[1,"material-icons"],[1,"filters"],["class","buttons",4,"ngFor","ngForOf"],[1,"buttons"],[1,"name"],[1,"arrow","edit",3,"click"],[1,"arrow","remove",3,"click"],[3,"isEditForm","formData","formSubmitted","modalClosed"]],template:function(i,r){1&i&&(ht(0,"div")(1,"span",0)(2,"button",1),Qn("click",function(){return r.firestoreLogout()}),on(3," Cerrar sesi\xf3n y volver al mapa "),pt()(),ht(4,"div",2)(5,"button",3),Qn("click",function(){return r.currentTab="add-form-location"})("click",function(){return r.openEditForm({})}),on(6,"A\xf1adir ubicaci\xf3n"),pt(),ht(7,"button",3),Qn("click",function(){return r.currentTab="add-text-locations"}),on(8,"A\xf1adir texto"),pt(),ht(9,"button",3),Qn("click",function(){return r.currentTab="tableTab"}),on(10,"Editar/eliminar"),pt()(),Yn(11,Qde,2,1,"div",4),Yn(12,she,24,15,"div",4),Yn(13,phe,41,12,"div",5),pt()),2&i&&(X(5),zo("active","add-form-location"===r.currentTab),X(2),zo("active","add-text-locations"===r.currentTab),X(2),zo("active","tableTab"===r.currentTab),X(2),un("ngIf","add-form-location"===r.currentTab),X(1),un("ngIf","add-text-locations"===r.currentTab),X(1),un("ngIf","tableTab"===r.currentTab))},dependencies:[s1,Ap,Yd,iT,F2,x1,b2,I2,T2,Jm,BI,Yde],styles:[".mat-ripple[_ngcontent-%COMP%]{overflow:hidden;position:relative}.mat-ripple[_ngcontent-%COMP%]:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded[_ngcontent-%COMP%]{overflow:visible}.mat-ripple-element[_ngcontent-%COMP%]{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0,0,.2,1);transform:scale3d(0,0,0)}.cdk-high-contrast-active[_ngcontent-%COMP%]   .mat-ripple-element[_ngcontent-%COMP%]{display:none}.cdk-visually-hidden[_ngcontent-%COMP%]{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl][_ngcontent-%COMP%]   .cdk-visually-hidden[_ngcontent-%COMP%]{left:auto;right:0}.cdk-overlay-container[_ngcontent-%COMP%], .cdk-global-overlay-wrapper[_ngcontent-%COMP%]{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container[_ngcontent-%COMP%]{position:fixed;z-index:1000}.cdk-overlay-container[_ngcontent-%COMP%]:empty{display:none}.cdk-global-overlay-wrapper[_ngcontent-%COMP%]{display:flex;position:absolute;z-index:1000}.cdk-overlay-pane[_ngcontent-%COMP%]{position:absolute;pointer-events:auto;box-sizing:border-box;z-index:1000;display:flex;max-width:100%;max-height:100%}.cdk-overlay-backdrop[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:1000;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);transition:opacity .4s cubic-bezier(.25,.8,.25,1);opacity:0}.cdk-overlay-backdrop.cdk-overlay-backdrop-showing[_ngcontent-%COMP%]{opacity:1}.cdk-high-contrast-active[_ngcontent-%COMP%]   .cdk-overlay-backdrop.cdk-overlay-backdrop-showing[_ngcontent-%COMP%]{opacity:.6}.cdk-overlay-dark-backdrop[_ngcontent-%COMP%]{background:rgba(0,0,0,.32)}.cdk-overlay-transparent-backdrop[_ngcontent-%COMP%]{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing[_ngcontent-%COMP%]{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation[_ngcontent-%COMP%]{transition:none}.cdk-overlay-connected-position-bounding-box[_ngcontent-%COMP%]{position:absolute;z-index:1000;display:flex;flex-direction:column;min-width:1px;min-height:1px}.cdk-global-scrollblock[_ngcontent-%COMP%]{position:fixed;width:100%;overflow-y:scroll}textarea.cdk-textarea-autosize[_ngcontent-%COMP%]{resize:none}textarea.cdk-textarea-autosize-measuring[_ngcontent-%COMP%]{padding:2px 0!important;box-sizing:content-box!important;height:auto!important;overflow:hidden!important}textarea.cdk-textarea-autosize-measuring-firefox[_ngcontent-%COMP%]{padding:2px 0!important;box-sizing:content-box!important;height:0!important}@keyframes _ngcontent-%COMP%_cdk-text-field-autofill-start{}@keyframes _ngcontent-%COMP%_cdk-text-field-autofill-end{}.cdk-text-field-autofill-monitored[_ngcontent-%COMP%]:-webkit-autofill{animation:_ngcontent-%COMP%_cdk-text-field-autofill-start 0s 1ms}.cdk-text-field-autofill-monitored[_ngcontent-%COMP%]:not(:-webkit-autofill){animation:_ngcontent-%COMP%_cdk-text-field-autofill-end 0s 1ms}.mat-focus-indicator[_ngcontent-%COMP%]{position:relative}.mat-focus-indicator[_ngcontent-%COMP%]:before{inset:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border:var(--mat-focus-indicator-border-width, 3px) var(--mat-focus-indicator-border-style, solid) var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator[_ngcontent-%COMP%]:focus:before{content:\"\"}.cdk-high-contrast-active[_ngcontent-%COMP%]{--mat-focus-indicator-display: block}.mat-mdc-focus-indicator[_ngcontent-%COMP%]{position:relative}.mat-mdc-focus-indicator[_ngcontent-%COMP%]:before{inset:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-mdc-focus-indicator-display, none);border:var(--mat-mdc-focus-indicator-border-width, 3px) var(--mat-mdc-focus-indicator-border-style, solid) var(--mat-mdc-focus-indicator-border-color, transparent);border-radius:var(--mat-mdc-focus-indicator-border-radius, 4px)}.mat-mdc-focus-indicator[_ngcontent-%COMP%]:focus:before{content:\"\"}.cdk-high-contrast-active[_ngcontent-%COMP%]{--mat-mdc-focus-indicator-display: block}.mat-ripple-element[_ngcontent-%COMP%]{background-color:#0000001a}html[_ngcontent-%COMP%]{--mat-option-selected-state-label-text-color:#673ab7;--mat-option-label-text-color:rgba(0, 0, 0, .87);--mat-option-hover-state-layer-color:rgba(0, 0, 0, .04);--mat-option-focus-state-layer-color:rgba(0, 0, 0, .04);--mat-option-selected-state-layer-color:rgba(0, 0, 0, .04)}.mat-accent[_ngcontent-%COMP%]{--mat-option-selected-state-label-text-color:#ffd740}.mat-warn[_ngcontent-%COMP%]{--mat-option-selected-state-label-text-color:#f44336}html[_ngcontent-%COMP%]{--mat-optgroup-label-text-color:rgba(0, 0, 0, .87)}.mat-pseudo-checkbox-full[_ngcontent-%COMP%]{color:#0000008a}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled[_ngcontent-%COMP%]{color:#b0b0b0}.mat-primary[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after, .mat-primary[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after{color:#673ab7}.mat-primary[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked.mat-pseudo-checkbox-full[_ngcontent-%COMP%], .mat-primary[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-full[_ngcontent-%COMP%]{background:#673ab7}.mat-primary[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked.mat-pseudo-checkbox-full[_ngcontent-%COMP%]:after, .mat-primary[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-full[_ngcontent-%COMP%]:after{color:#fafafa}.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after, .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after{color:#ffd740}.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-full[_ngcontent-%COMP%], .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-full[_ngcontent-%COMP%]{background:#ffd740}.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-full[_ngcontent-%COMP%]:after, .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-full[_ngcontent-%COMP%]:after{color:#fafafa}.mat-accent[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after, .mat-accent[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after{color:#ffd740}.mat-accent[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked.mat-pseudo-checkbox-full[_ngcontent-%COMP%], .mat-accent[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-full[_ngcontent-%COMP%]{background:#ffd740}.mat-accent[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked.mat-pseudo-checkbox-full[_ngcontent-%COMP%]:after, .mat-accent[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-full[_ngcontent-%COMP%]:after{color:#fafafa}.mat-warn[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after, .mat-warn[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after{color:#f44336}.mat-warn[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked.mat-pseudo-checkbox-full[_ngcontent-%COMP%], .mat-warn[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-full[_ngcontent-%COMP%]{background:#f44336}.mat-warn[_ngcontent-%COMP%]   .mat-pseudo-checkbox-checked.mat-pseudo-checkbox-full[_ngcontent-%COMP%]:after, .mat-warn[_ngcontent-%COMP%]   .mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-full[_ngcontent-%COMP%]:after{color:#fafafa}.mat-pseudo-checkbox-disabled.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after, .mat-pseudo-checkbox-disabled.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-minimal[_ngcontent-%COMP%]:after{color:#b0b0b0}.mat-pseudo-checkbox-disabled.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-full[_ngcontent-%COMP%], .mat-pseudo-checkbox-disabled.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-full[_ngcontent-%COMP%]{background:#b0b0b0}.mat-app-background[_ngcontent-%COMP%]{background-color:#fafafa;color:#000000de}.mat-elevation-z0[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z0[_ngcontent-%COMP%]{box-shadow:0 0 #0003,0 0 #00000024,0 0 #0000001f}.mat-elevation-z1[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z1[_ngcontent-%COMP%]{box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f}.mat-elevation-z2[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z2[_ngcontent-%COMP%]{box-shadow:0 3px 1px -2px #0003,0 2px 2px #00000024,0 1px 5px #0000001f}.mat-elevation-z3[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z3[_ngcontent-%COMP%]{box-shadow:0 3px 3px -2px #0003,0 3px 4px #00000024,0 1px 8px #0000001f}.mat-elevation-z4[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z4[_ngcontent-%COMP%]{box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f}.mat-elevation-z5[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z5[_ngcontent-%COMP%]{box-shadow:0 3px 5px -1px #0003,0 5px 8px #00000024,0 1px 14px #0000001f}.mat-elevation-z6[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z6[_ngcontent-%COMP%]{box-shadow:0 3px 5px -1px #0003,0 6px 10px #00000024,0 1px 18px #0000001f}.mat-elevation-z7[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z7[_ngcontent-%COMP%]{box-shadow:0 4px 5px -2px #0003,0 7px 10px 1px #00000024,0 2px 16px 1px #0000001f}.mat-elevation-z8[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z8[_ngcontent-%COMP%]{box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.mat-elevation-z9[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z9[_ngcontent-%COMP%]{box-shadow:0 5px 6px -3px #0003,0 9px 12px 1px #00000024,0 3px 16px 2px #0000001f}.mat-elevation-z10[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z10[_ngcontent-%COMP%]{box-shadow:0 6px 6px -3px #0003,0 10px 14px 1px #00000024,0 4px 18px 3px #0000001f}.mat-elevation-z11[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z11[_ngcontent-%COMP%]{box-shadow:0 6px 7px -4px #0003,0 11px 15px 1px #00000024,0 4px 20px 3px #0000001f}.mat-elevation-z12[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z12[_ngcontent-%COMP%]{box-shadow:0 7px 8px -4px #0003,0 12px 17px 2px #00000024,0 5px 22px 4px #0000001f}.mat-elevation-z13[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z13[_ngcontent-%COMP%]{box-shadow:0 7px 8px -4px #0003,0 13px 19px 2px #00000024,0 5px 24px 4px #0000001f}.mat-elevation-z14[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z14[_ngcontent-%COMP%]{box-shadow:0 7px 9px -4px #0003,0 14px 21px 2px #00000024,0 5px 26px 4px #0000001f}.mat-elevation-z15[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z15[_ngcontent-%COMP%]{box-shadow:0 8px 9px -5px #0003,0 15px 22px 2px #00000024,0 6px 28px 5px #0000001f}.mat-elevation-z16[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z16[_ngcontent-%COMP%]{box-shadow:0 8px 10px -5px #0003,0 16px 24px 2px #00000024,0 6px 30px 5px #0000001f}.mat-elevation-z17[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z17[_ngcontent-%COMP%]{box-shadow:0 8px 11px -5px #0003,0 17px 26px 2px #00000024,0 6px 32px 5px #0000001f}.mat-elevation-z18[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z18[_ngcontent-%COMP%]{box-shadow:0 9px 11px -5px #0003,0 18px 28px 2px #00000024,0 7px 34px 6px #0000001f}.mat-elevation-z19[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z19[_ngcontent-%COMP%]{box-shadow:0 9px 12px -6px #0003,0 19px 29px 2px #00000024,0 7px 36px 6px #0000001f}.mat-elevation-z20[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z20[_ngcontent-%COMP%]{box-shadow:0 10px 13px -6px #0003,0 20px 31px 3px #00000024,0 8px 38px 7px #0000001f}.mat-elevation-z21[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z21[_ngcontent-%COMP%]{box-shadow:0 10px 13px -6px #0003,0 21px 33px 3px #00000024,0 8px 40px 7px #0000001f}.mat-elevation-z22[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z22[_ngcontent-%COMP%]{box-shadow:0 10px 14px -6px #0003,0 22px 35px 3px #00000024,0 8px 42px 7px #0000001f}.mat-elevation-z23[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z23[_ngcontent-%COMP%]{box-shadow:0 11px 14px -7px #0003,0 23px 36px 3px #00000024,0 9px 44px 8px #0000001f}.mat-elevation-z24[_ngcontent-%COMP%], .mat-mdc-elevation-specific.mat-elevation-z24[_ngcontent-%COMP%]{box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f}.mat-theme-loaded-marker[_ngcontent-%COMP%]{display:none}html[_ngcontent-%COMP%]{--mat-option-label-text-font:Roboto, sans-serif;--mat-option-label-text-line-height:24px;--mat-option-label-text-size:16px;--mat-option-label-text-tracking:.03125em;--mat-option-label-text-weight:400}html[_ngcontent-%COMP%]{--mat-optgroup-label-text-font:Roboto, sans-serif;--mat-optgroup-label-text-line-height:24px;--mat-optgroup-label-text-size:16px;--mat-optgroup-label-text-tracking:.03125em;--mat-optgroup-label-text-weight:400}.mat-mdc-card[_ngcontent-%COMP%]{--mdc-elevated-card-container-color:white;--mdc-elevated-card-container-elevation:0px 2px 1px -1px rgba(0, 0, 0, .2), 0px 1px 1px 0px rgba(0, 0, 0, .14), 0px 1px 3px 0px rgba(0, 0, 0, .12);--mdc-outlined-card-container-color:white;--mdc-outlined-card-outline-color:rgba(0, 0, 0, .12);--mdc-outlined-card-container-elevation:0px 0px 0px 0px rgba(0, 0, 0, .2), 0px 0px 0px 0px rgba(0, 0, 0, .14), 0px 0px 0px 0px rgba(0, 0, 0, .12);--mat-card-subtitle-text-color:rgba(0, 0, 0, .54)}.mat-mdc-card[_ngcontent-%COMP%]{--mat-card-title-text-font:Roboto, sans-serif;--mat-card-title-text-line-height:32px;--mat-card-title-text-size:20px;--mat-card-title-text-tracking:.0125em;--mat-card-title-text-weight:500;--mat-card-subtitle-text-font:Roboto, sans-serif;--mat-card-subtitle-text-line-height:22px;--mat-card-subtitle-text-size:14px;--mat-card-subtitle-text-tracking:.0071428571em;--mat-card-subtitle-text-weight:500}.mat-mdc-progress-bar[_ngcontent-%COMP%]{--mdc-linear-progress-active-indicator-color:#673ab7;--mdc-linear-progress-track-color:rgba(103, 58, 183, .25)}.mat-mdc-progress-bar[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-dots[_ngcontent-%COMP%]{background-color:#673ab740;background-color:var(--mdc-linear-progress-track-color, rgba(103, 58, 183, .25))}@media (forced-colors: active){.mat-mdc-progress-bar[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-dots[_ngcontent-%COMP%]{background-color:ButtonBorder}}@media all and (-ms-high-contrast: none),(-ms-high-contrast: active){.mat-mdc-progress-bar[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-dots[_ngcontent-%COMP%]{background-color:#0000;background-image:url(\"data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='rgba(103, 58, 183, 0.25)'/%3E%3C/svg%3E\")}}.mat-mdc-progress-bar[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-bar[_ngcontent-%COMP%]{background-color:#673ab740;background-color:var(--mdc-linear-progress-track-color, rgba(103, 58, 183, .25))}.mat-mdc-progress-bar.mat-accent[_ngcontent-%COMP%]{--mdc-linear-progress-active-indicator-color:#ffd740;--mdc-linear-progress-track-color:rgba(255, 215, 64, .25)}.mat-mdc-progress-bar.mat-accent[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-dots[_ngcontent-%COMP%]{background-color:#ffd74040;background-color:var(--mdc-linear-progress-track-color, rgba(255, 215, 64, .25))}@media (forced-colors: active){.mat-mdc-progress-bar.mat-accent[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-dots[_ngcontent-%COMP%]{background-color:ButtonBorder}}@media all and (-ms-high-contrast: none),(-ms-high-contrast: active){.mat-mdc-progress-bar.mat-accent[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-dots[_ngcontent-%COMP%]{background-color:#0000;background-image:url(\"data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='rgba(255, 215, 64, 0.25)'/%3E%3C/svg%3E\")}}.mat-mdc-progress-bar.mat-accent[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-bar[_ngcontent-%COMP%]{background-color:#ffd74040;background-color:var(--mdc-linear-progress-track-color, rgba(255, 215, 64, .25))}.mat-mdc-progress-bar.mat-warn[_ngcontent-%COMP%]{--mdc-linear-progress-active-indicator-color:#f44336;--mdc-linear-progress-track-color:rgba(244, 67, 54, .25)}@keyframes _ngcontent-%COMP%_mdc-linear-progress-buffering{}.mat-mdc-progress-bar.mat-warn[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-dots[_ngcontent-%COMP%]{background-color:#f4433640;background-color:var(--mdc-linear-progress-track-color, rgba(244, 67, 54, .25))}@media (forced-colors: active){.mat-mdc-progress-bar.mat-warn[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-dots[_ngcontent-%COMP%]{background-color:ButtonBorder}}@media all and (-ms-high-contrast: none),(-ms-high-contrast: active){.mat-mdc-progress-bar.mat-warn[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-dots[_ngcontent-%COMP%]{background-color:#0000;background-image:url(\"data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='rgba(244, 67, 54, 0.25)'/%3E%3C/svg%3E\")}}.mat-mdc-progress-bar.mat-warn[_ngcontent-%COMP%]   .mdc-linear-progress__buffer-bar[_ngcontent-%COMP%]{background-color:#f4433640;background-color:var(--mdc-linear-progress-track-color, rgba(244, 67, 54, .25))}.mat-mdc-tooltip[_ngcontent-%COMP%]{--mdc-plain-tooltip-container-color:#616161;--mdc-plain-tooltip-supporting-text-color:#fff}.mat-mdc-tooltip[_ngcontent-%COMP%]{--mdc-plain-tooltip-supporting-text-font:Roboto, sans-serif;--mdc-plain-tooltip-supporting-text-size:12px;--mdc-plain-tooltip-supporting-text-weight:400;--mdc-plain-tooltip-supporting-text-tracking:.0333333333em}html[_ngcontent-%COMP%]{--mdc-filled-text-field-caret-color:#673ab7;--mdc-filled-text-field-focus-active-indicator-color:#673ab7;--mdc-filled-text-field-focus-label-text-color:rgba(103, 58, 183, .87);--mdc-filled-text-field-container-color:whitesmoke;--mdc-filled-text-field-disabled-container-color:#fafafa;--mdc-filled-text-field-label-text-color:rgba(0, 0, 0, .6);--mdc-filled-text-field-disabled-label-text-color:rgba(0, 0, 0, .38);--mdc-filled-text-field-input-text-color:rgba(0, 0, 0, .87);--mdc-filled-text-field-disabled-input-text-color:rgba(0, 0, 0, .38);--mdc-filled-text-field-input-text-placeholder-color:rgba(0, 0, 0, .6);--mdc-filled-text-field-error-focus-label-text-color:#f44336;--mdc-filled-text-field-error-label-text-color:#f44336;--mdc-filled-text-field-error-caret-color:#f44336;--mdc-filled-text-field-active-indicator-color:rgba(0, 0, 0, .42);--mdc-filled-text-field-disabled-active-indicator-color:rgba(0, 0, 0, .06);--mdc-filled-text-field-hover-active-indicator-color:rgba(0, 0, 0, .87);--mdc-filled-text-field-error-active-indicator-color:#f44336;--mdc-filled-text-field-error-focus-active-indicator-color:#f44336;--mdc-filled-text-field-error-hover-active-indicator-color:#f44336;--mdc-outlined-text-field-caret-color:#673ab7;--mdc-outlined-text-field-focus-outline-color:#673ab7;--mdc-outlined-text-field-focus-label-text-color:rgba(103, 58, 183, .87);--mdc-outlined-text-field-label-text-color:rgba(0, 0, 0, .6);--mdc-outlined-text-field-disabled-label-text-color:rgba(0, 0, 0, .38);--mdc-outlined-text-field-input-text-color:rgba(0, 0, 0, .87);--mdc-outlined-text-field-disabled-input-text-color:rgba(0, 0, 0, .38);--mdc-outlined-text-field-input-text-placeholder-color:rgba(0, 0, 0, .6);--mdc-outlined-text-field-error-caret-color:#f44336;--mdc-outlined-text-field-error-focus-label-text-color:#f44336;--mdc-outlined-text-field-error-label-text-color:#f44336;--mdc-outlined-text-field-outline-color:rgba(0, 0, 0, .38);--mdc-outlined-text-field-disabled-outline-color:rgba(0, 0, 0, .06);--mdc-outlined-text-field-hover-outline-color:rgba(0, 0, 0, .87);--mdc-outlined-text-field-error-focus-outline-color:#f44336;--mdc-outlined-text-field-error-hover-outline-color:#f44336;--mdc-outlined-text-field-error-outline-color:#f44336;--mat-form-field-disabled-input-text-placeholder-color:rgba(0, 0, 0, .38)}.mat-mdc-form-field-error[_ngcontent-%COMP%]{color:var(--mdc-theme-error, #f44336)}.mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%], .mat-mdc-form-field-bottom-align[_ngcontent-%COMP%]:before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font);line-height:var(--mat-form-field-subscript-text-line-height);font-size:var(--mat-form-field-subscript-text-size);letter-spacing:var(--mat-form-field-subscript-text-tracking);font-weight:var(--mat-form-field-subscript-text-weight)}.mat-mdc-form-field-focus-overlay[_ngcontent-%COMP%]{background-color:#000000de}.mat-mdc-form-field[_ngcontent-%COMP%]:hover   .mat-mdc-form-field-focus-overlay[_ngcontent-%COMP%]{opacity:.04}.mat-mdc-form-field.mat-focused[_ngcontent-%COMP%]   .mat-mdc-form-field-focus-overlay[_ngcontent-%COMP%]{opacity:.12}.mat-mdc-form-field-type-mat-native-select[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]:after{color:#0000008a}.mat-mdc-form-field-type-mat-native-select.mat-focused.mat-primary[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]:after{color:#673ab7de}.mat-mdc-form-field-type-mat-native-select.mat-focused.mat-accent[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]:after{color:#ffd740de}.mat-mdc-form-field-type-mat-native-select.mat-focused.mat-warn[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]:after{color:#f44336de}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]:after{color:#00000061}.mat-mdc-form-field.mat-accent[_ngcontent-%COMP%]{--mdc-filled-text-field-caret-color:#ffd740;--mdc-filled-text-field-focus-active-indicator-color:#ffd740;--mdc-filled-text-field-focus-label-text-color:rgba(255, 215, 64, .87);--mdc-outlined-text-field-caret-color:#ffd740;--mdc-outlined-text-field-focus-outline-color:#ffd740;--mdc-outlined-text-field-focus-label-text-color:rgba(255, 215, 64, .87)}.mat-mdc-form-field.mat-warn[_ngcontent-%COMP%]{--mdc-filled-text-field-caret-color:#f44336;--mdc-filled-text-field-focus-active-indicator-color:#f44336;--mdc-filled-text-field-focus-label-text-color:rgba(244, 67, 54, .87);--mdc-outlined-text-field-caret-color:#f44336;--mdc-outlined-text-field-focus-outline-color:#f44336;--mdc-outlined-text-field-focus-label-text-color:rgba(244, 67, 54, .87)}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-notched-outline__notch[_ngcontent-%COMP%]{border-left:1px solid rgba(0,0,0,0)}[dir=rtl][_ngcontent-%COMP%]   .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field[_ngcontent-%COMP%]   .mdc-notched-outline__notch[_ngcontent-%COMP%]{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix[_ngcontent-%COMP%]{min-height:56px}.mat-mdc-text-field-wrapper[_ngcontent-%COMP%]   .mat-mdc-form-field-flex[_ngcontent-%COMP%]   .mat-mdc-floating-label[_ngcontent-%COMP%]{top:28px}.mat-mdc-text-field-wrapper.mdc-text-field--outlined[_ngcontent-%COMP%]   .mdc-notched-outline--upgraded[_ngcontent-%COMP%]   .mdc-floating-label--float-above[_ngcontent-%COMP%]{--mat-mdc-form-field-label-transform: translateY( -34.75px) scale(var(--mat-mdc-form-field-floating-label-scale, .75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding-top:16px;padding-bottom:16px}.mat-mdc-text-field-wrapper[_ngcontent-%COMP%]:not(.mdc-text-field--outlined)   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding-top:24px;padding-bottom:8px}.mdc-text-field--no-label[_ngcontent-%COMP%]:not(.mdc-text-field--outlined):not(.mdc-text-field--textarea)   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding-top:16px;padding-bottom:16px}html[_ngcontent-%COMP%]{--mdc-filled-text-field-label-text-font:Roboto, sans-serif;--mdc-filled-text-field-label-text-size:16px;--mdc-filled-text-field-label-text-tracking:.03125em;--mdc-filled-text-field-label-text-weight:400;--mdc-outlined-text-field-label-text-font:Roboto, sans-serif;--mdc-outlined-text-field-label-text-size:16px;--mdc-outlined-text-field-label-text-tracking:.03125em;--mdc-outlined-text-field-label-text-weight:400;--mat-form-field-container-text-font:Roboto, sans-serif;--mat-form-field-container-text-line-height:24px;--mat-form-field-container-text-size:16px;--mat-form-field-container-text-tracking:.03125em;--mat-form-field-container-text-weight:400;--mat-form-field-outlined-label-text-populated-size:16px;--mat-form-field-subscript-text-font:Roboto, sans-serif;--mat-form-field-subscript-text-line-height:20px;--mat-form-field-subscript-text-size:12px;--mat-form-field-subscript-text-tracking:.0333333333em;--mat-form-field-subscript-text-weight:400}html[_ngcontent-%COMP%]{--mat-select-panel-background-color:white;--mat-select-enabled-trigger-text-color:rgba(0, 0, 0, .87);--mat-select-disabled-trigger-text-color:rgba(0, 0, 0, .38);--mat-select-placeholder-text-color:rgba(0, 0, 0, .6);--mat-select-enabled-arrow-color:rgba(0, 0, 0, .54);--mat-select-disabled-arrow-color:rgba(0, 0, 0, .38);--mat-select-focused-arrow-color:rgba(103, 58, 183, .87);--mat-select-invalid-arrow-color:rgba(244, 67, 54, .87)}html[_ngcontent-%COMP%]   .mat-mdc-form-field.mat-accent[_ngcontent-%COMP%]{--mat-select-panel-background-color:white;--mat-select-enabled-trigger-text-color:rgba(0, 0, 0, .87);--mat-select-disabled-trigger-text-color:rgba(0, 0, 0, .38);--mat-select-placeholder-text-color:rgba(0, 0, 0, .6);--mat-select-enabled-arrow-color:rgba(0, 0, 0, .54);--mat-select-disabled-arrow-color:rgba(0, 0, 0, .38);--mat-select-focused-arrow-color:rgba(255, 215, 64, .87);--mat-select-invalid-arrow-color:rgba(244, 67, 54, .87)}html[_ngcontent-%COMP%]   .mat-mdc-form-field.mat-warn[_ngcontent-%COMP%]{--mat-select-panel-background-color:white;--mat-select-enabled-trigger-text-color:rgba(0, 0, 0, .87);--mat-select-disabled-trigger-text-color:rgba(0, 0, 0, .38);--mat-select-placeholder-text-color:rgba(0, 0, 0, .6);--mat-select-enabled-arrow-color:rgba(0, 0, 0, .54);--mat-select-disabled-arrow-color:rgba(0, 0, 0, .38);--mat-select-focused-arrow-color:rgba(244, 67, 54, .87);--mat-select-invalid-arrow-color:rgba(244, 67, 54, .87)}html[_ngcontent-%COMP%]{--mat-select-trigger-text-font:Roboto, sans-serif;--mat-select-trigger-text-line-height:24px;--mat-select-trigger-text-size:16px;--mat-select-trigger-text-tracking:.03125em;--mat-select-trigger-text-weight:400}html[_ngcontent-%COMP%]{--mat-autocomplete-background-color:white}.mat-mdc-dialog-container[_ngcontent-%COMP%]{--mdc-dialog-container-color:white;--mdc-dialog-subhead-color:rgba(0, 0, 0, .87);--mdc-dialog-supporting-text-color:rgba(0, 0, 0, .6)}.mat-mdc-dialog-container[_ngcontent-%COMP%]{--mdc-dialog-subhead-font:Roboto, sans-serif;--mdc-dialog-subhead-line-height:32px;--mdc-dialog-subhead-size:20px;--mdc-dialog-subhead-weight:500;--mdc-dialog-subhead-tracking:.0125em;--mdc-dialog-supporting-text-font:Roboto, sans-serif;--mdc-dialog-supporting-text-line-height:24px;--mdc-dialog-supporting-text-size:16px;--mdc-dialog-supporting-text-weight:400;--mdc-dialog-supporting-text-tracking:.03125em}.mat-mdc-standard-chip[_ngcontent-%COMP%]{--mdc-chip-disabled-label-text-color:#212121;--mdc-chip-elevated-container-color:#e0e0e0;--mdc-chip-elevated-disabled-container-color:#e0e0e0;--mdc-chip-focus-state-layer-color:black;--mdc-chip-focus-state-layer-opacity:.12;--mdc-chip-label-text-color:#212121;--mdc-chip-with-icon-icon-color:#212121;--mdc-chip-with-icon-disabled-icon-color:#212121;--mdc-chip-with-icon-selected-icon-color:#212121;--mdc-chip-with-trailing-icon-disabled-trailing-icon-color:#212121;--mdc-chip-with-trailing-icon-trailing-icon-color:#212121}.mat-mdc-standard-chip.mat-mdc-chip-selected.mat-primary[_ngcontent-%COMP%], .mat-mdc-standard-chip.mat-mdc-chip-highlighted.mat-primary[_ngcontent-%COMP%]{--mdc-chip-disabled-label-text-color:white;--mdc-chip-elevated-container-color:#673ab7;--mdc-chip-elevated-disabled-container-color:#673ab7;--mdc-chip-focus-state-layer-color:black;--mdc-chip-focus-state-layer-opacity:.12;--mdc-chip-label-text-color:white;--mdc-chip-with-icon-icon-color:white;--mdc-chip-with-icon-disabled-icon-color:white;--mdc-chip-with-icon-selected-icon-color:white;--mdc-chip-with-trailing-icon-disabled-trailing-icon-color:white;--mdc-chip-with-trailing-icon-trailing-icon-color:white}.mat-mdc-standard-chip.mat-mdc-chip-selected.mat-accent[_ngcontent-%COMP%], .mat-mdc-standard-chip.mat-mdc-chip-highlighted.mat-accent[_ngcontent-%COMP%]{--mdc-chip-disabled-label-text-color:rgba(0, 0, 0, .87);--mdc-chip-elevated-container-color:#ffd740;--mdc-chip-elevated-disabled-container-color:#ffd740;--mdc-chip-focus-state-layer-color:black;--mdc-chip-focus-state-layer-opacity:.12;--mdc-chip-label-text-color:rgba(0, 0, 0, .87);--mdc-chip-with-icon-icon-color:rgba(0, 0, 0, .87);--mdc-chip-with-icon-disabled-icon-color:rgba(0, 0, 0, .87);--mdc-chip-with-icon-selected-icon-color:rgba(0, 0, 0, .87);--mdc-chip-with-trailing-icon-disabled-trailing-icon-color:rgba(0, 0, 0, .87);--mdc-chip-with-trailing-icon-trailing-icon-color:rgba(0, 0, 0, .87)}.mat-mdc-standard-chip.mat-mdc-chip-selected.mat-warn[_ngcontent-%COMP%], .mat-mdc-standard-chip.mat-mdc-chip-highlighted.mat-warn[_ngcontent-%COMP%]{--mdc-chip-disabled-label-text-color:white;--mdc-chip-elevated-container-color:#f44336;--mdc-chip-elevated-disabled-container-color:#f44336;--mdc-chip-focus-state-layer-color:black;--mdc-chip-focus-state-layer-opacity:.12;--mdc-chip-label-text-color:white;--mdc-chip-with-icon-icon-color:white;--mdc-chip-with-icon-disabled-icon-color:white;--mdc-chip-with-icon-selected-icon-color:white;--mdc-chip-with-trailing-icon-disabled-trailing-icon-color:white;--mdc-chip-with-trailing-icon-trailing-icon-color:white}.mat-mdc-chip.mat-mdc-standard-chip[_ngcontent-%COMP%]{--mdc-chip-container-height:32px}.mat-mdc-standard-chip[_ngcontent-%COMP%]{--mdc-chip-label-text-font:Roboto, sans-serif;--mdc-chip-label-text-line-height:20px;--mdc-chip-label-text-size:14px;--mdc-chip-label-text-tracking:.0178571429em;--mdc-chip-label-text-weight:400}.mat-mdc-slide-toggle[_ngcontent-%COMP%]{--mdc-switch-selected-focus-state-layer-color:#5e35b1;--mdc-switch-selected-handle-color:#5e35b1;--mdc-switch-selected-hover-state-layer-color:#5e35b1;--mdc-switch-selected-pressed-state-layer-color:#5e35b1;--mdc-switch-selected-focus-handle-color:#311b92;--mdc-switch-selected-hover-handle-color:#311b92;--mdc-switch-selected-pressed-handle-color:#311b92;--mdc-switch-selected-focus-track-color:#9575cd;--mdc-switch-selected-hover-track-color:#9575cd;--mdc-switch-selected-pressed-track-color:#9575cd;--mdc-switch-selected-track-color:#9575cd;--mdc-switch-disabled-selected-handle-color:#424242;--mdc-switch-disabled-selected-icon-color:#fff;--mdc-switch-disabled-selected-track-color:#424242;--mdc-switch-disabled-unselected-handle-color:#424242;--mdc-switch-disabled-unselected-icon-color:#fff;--mdc-switch-disabled-unselected-track-color:#424242;--mdc-switch-handle-surface-color:var(--mdc-theme-surface, #fff);--mdc-switch-handle-elevation-shadow:0px 2px 1px -1px rgba(0, 0, 0, .2), 0px 1px 1px 0px rgba(0, 0, 0, .14), 0px 1px 3px 0px rgba(0, 0, 0, .12);--mdc-switch-handle-shadow-color:black;--mdc-switch-disabled-handle-elevation-shadow:0px 0px 0px 0px rgba(0, 0, 0, .2), 0px 0px 0px 0px rgba(0, 0, 0, .14), 0px 0px 0px 0px rgba(0, 0, 0, .12);--mdc-switch-selected-icon-color:#fff;--mdc-switch-unselected-focus-handle-color:#212121;--mdc-switch-unselected-focus-state-layer-color:#424242;--mdc-switch-unselected-focus-track-color:#e0e0e0;--mdc-switch-unselected-handle-color:#616161;--mdc-switch-unselected-hover-handle-color:#212121;--mdc-switch-unselected-hover-state-layer-color:#424242;--mdc-switch-unselected-hover-track-color:#e0e0e0;--mdc-switch-unselected-icon-color:#fff;--mdc-switch-unselected-pressed-handle-color:#212121;--mdc-switch-unselected-pressed-state-layer-color:#424242;--mdc-switch-unselected-pressed-track-color:#e0e0e0;--mdc-switch-unselected-track-color:#e0e0e0}.mat-mdc-slide-toggle[_ngcontent-%COMP%]   .mdc-form-field[_ngcontent-%COMP%]{color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, .87))}.mat-mdc-slide-toggle[_ngcontent-%COMP%]   .mdc-switch--disabled[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{color:#00000061}.mat-mdc-slide-toggle.mat-accent[_ngcontent-%COMP%]{--mdc-switch-selected-focus-state-layer-color:#ffb300;--mdc-switch-selected-handle-color:#ffb300;--mdc-switch-selected-hover-state-layer-color:#ffb300;--mdc-switch-selected-pressed-state-layer-color:#ffb300;--mdc-switch-selected-focus-handle-color:#ff6f00;--mdc-switch-selected-hover-handle-color:#ff6f00;--mdc-switch-selected-pressed-handle-color:#ff6f00;--mdc-switch-selected-focus-track-color:#ffd54f;--mdc-switch-selected-hover-track-color:#ffd54f;--mdc-switch-selected-pressed-track-color:#ffd54f;--mdc-switch-selected-track-color:#ffd54f}.mat-mdc-slide-toggle.mat-warn[_ngcontent-%COMP%]{--mdc-switch-selected-focus-state-layer-color:#e53935;--mdc-switch-selected-handle-color:#e53935;--mdc-switch-selected-hover-state-layer-color:#e53935;--mdc-switch-selected-pressed-state-layer-color:#e53935;--mdc-switch-selected-focus-handle-color:#b71c1c;--mdc-switch-selected-hover-handle-color:#b71c1c;--mdc-switch-selected-pressed-handle-color:#b71c1c;--mdc-switch-selected-focus-track-color:#e57373;--mdc-switch-selected-hover-track-color:#e57373;--mdc-switch-selected-pressed-track-color:#e57373;--mdc-switch-selected-track-color:#e57373}.mat-mdc-slide-toggle[_ngcontent-%COMP%]{--mdc-switch-state-layer-size:48px}.mat-mdc-slide-toggle[_ngcontent-%COMP%]{--mat-slide-toggle-label-text-font:Roboto, sans-serif;--mat-slide-toggle-label-text-size:14px;--mat-slide-toggle-label-text-tracking:.0178571429em;--mat-slide-toggle-label-text-line-height:20px;--mat-slide-toggle-label-text-weight:400}.mat-mdc-slide-toggle[_ngcontent-%COMP%]   .mdc-form-field[_ngcontent-%COMP%]{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size, .875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height, 1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing, .0178571429em);text-decoration:inherit;-webkit-text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform, inherit)}.mat-mdc-radio-button[_ngcontent-%COMP%]   .mdc-form-field[_ngcontent-%COMP%]{color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, .87))}.mat-mdc-radio-button.mat-primary[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color:#000;--mdc-radio-disabled-unselected-icon-color:#000;--mdc-radio-unselected-hover-icon-color:#212121;--mdc-radio-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-radio-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-radio-selected-focus-icon-color:#673ab7;--mdc-radio-selected-hover-icon-color:#673ab7;--mdc-radio-selected-icon-color:#673ab7;--mdc-radio-selected-pressed-icon-color:#673ab7;--mat-radio-ripple-color:#000;--mat-radio-checked-ripple-color:#673ab7;--mat-radio-disabled-label-color:rgba(0, 0, 0, .38)}.mat-mdc-radio-button.mat-accent[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color:#000;--mdc-radio-disabled-unselected-icon-color:#000;--mdc-radio-unselected-hover-icon-color:#212121;--mdc-radio-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-radio-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-radio-selected-focus-icon-color:#ffd740;--mdc-radio-selected-hover-icon-color:#ffd740;--mdc-radio-selected-icon-color:#ffd740;--mdc-radio-selected-pressed-icon-color:#ffd740;--mat-radio-ripple-color:#000;--mat-radio-checked-ripple-color:#ffd740;--mat-radio-disabled-label-color:rgba(0, 0, 0, .38)}.mat-mdc-radio-button.mat-warn[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color:#000;--mdc-radio-disabled-unselected-icon-color:#000;--mdc-radio-unselected-hover-icon-color:#212121;--mdc-radio-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-radio-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-radio-selected-focus-icon-color:#f44336;--mdc-radio-selected-hover-icon-color:#f44336;--mdc-radio-selected-icon-color:#f44336;--mdc-radio-selected-pressed-icon-color:#f44336;--mat-radio-ripple-color:#000;--mat-radio-checked-ripple-color:#f44336;--mat-radio-disabled-label-color:rgba(0, 0, 0, .38)}.mat-mdc-radio-button[_ngcontent-%COMP%]   .mdc-radio[_ngcontent-%COMP%]{--mdc-radio-state-layer-size:40px}.mat-mdc-radio-button[_ngcontent-%COMP%]   .mdc-form-field[_ngcontent-%COMP%]{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:var(--mdc-typography-body2-font-size, 14px);line-height:var(--mdc-typography-body2-line-height, 20px);font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:var(--mdc-typography-body2-letter-spacing, .0178571429em);-webkit-text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:var(--mdc-typography-body2-text-transform, none)}.mat-mdc-slider[_ngcontent-%COMP%]{--mdc-slider-label-container-color:black;--mdc-slider-label-label-text-color:white;--mdc-slider-disabled-handle-color:#000;--mdc-slider-disabled-active-track-color:#000;--mdc-slider-disabled-inactive-track-color:#000;--mdc-slider-with-tick-marks-disabled-container-color:#000;--mat-mdc-slider-value-indicator-opacity: .6}.mat-mdc-slider.mat-primary[_ngcontent-%COMP%]{--mdc-slider-handle-color:#673ab7;--mdc-slider-focus-handle-color:#673ab7;--mdc-slider-hover-handle-color:#673ab7;--mdc-slider-active-track-color:#673ab7;--mdc-slider-inactive-track-color:#673ab7;--mdc-slider-with-tick-marks-active-container-color:#fff;--mdc-slider-with-tick-marks-inactive-container-color:#673ab7;--mat-mdc-slider-ripple-color: #673ab7;--mat-mdc-slider-hover-ripple-color: rgba(103, 58, 183, .05);--mat-mdc-slider-focus-ripple-color: rgba(103, 58, 183, .2)}.mat-mdc-slider.mat-accent[_ngcontent-%COMP%]{--mdc-slider-handle-color:#ffd740;--mdc-slider-focus-handle-color:#ffd740;--mdc-slider-hover-handle-color:#ffd740;--mdc-slider-active-track-color:#ffd740;--mdc-slider-inactive-track-color:#ffd740;--mdc-slider-with-tick-marks-active-container-color:#000;--mdc-slider-with-tick-marks-inactive-container-color:#ffd740;--mat-mdc-slider-ripple-color: #ffd740;--mat-mdc-slider-hover-ripple-color: rgba(255, 215, 64, .05);--mat-mdc-slider-focus-ripple-color: rgba(255, 215, 64, .2)}.mat-mdc-slider.mat-warn[_ngcontent-%COMP%]{--mdc-slider-handle-color:#f44336;--mdc-slider-focus-handle-color:#f44336;--mdc-slider-hover-handle-color:#f44336;--mdc-slider-active-track-color:#f44336;--mdc-slider-inactive-track-color:#f44336;--mdc-slider-with-tick-marks-active-container-color:#fff;--mdc-slider-with-tick-marks-inactive-container-color:#f44336;--mat-mdc-slider-ripple-color: #f44336;--mat-mdc-slider-hover-ripple-color: rgba(244, 67, 54, .05);--mat-mdc-slider-focus-ripple-color: rgba(244, 67, 54, .2)}.mat-mdc-slider[_ngcontent-%COMP%]{--mdc-slider-label-label-text-font:Roboto, sans-serif;--mdc-slider-label-label-text-size:14px;--mdc-slider-label-label-text-line-height:22px;--mdc-slider-label-label-text-tracking:.0071428571em;--mdc-slider-label-label-text-weight:500}html[_ngcontent-%COMP%]{--mat-menu-item-label-text-color:rgba(0, 0, 0, .87);--mat-menu-item-icon-color:rgba(0, 0, 0, .87);--mat-menu-item-hover-state-layer-color:rgba(0, 0, 0, .04);--mat-menu-item-focus-state-layer-color:rgba(0, 0, 0, .04);--mat-menu-container-color:white}html[_ngcontent-%COMP%]{--mat-menu-item-label-text-font:Roboto, sans-serif;--mat-menu-item-label-text-size:16px;--mat-menu-item-label-text-tracking:.03125em;--mat-menu-item-label-text-line-height:24px;--mat-menu-item-label-text-weight:400}.mat-mdc-list-base[_ngcontent-%COMP%]{--mdc-list-list-item-label-text-color:rgba(0, 0, 0, .87);--mdc-list-list-item-supporting-text-color:rgba(0, 0, 0, .54);--mdc-list-list-item-leading-icon-color:rgba(0, 0, 0, .38);--mdc-list-list-item-trailing-supporting-text-color:rgba(0, 0, 0, .38);--mdc-list-list-item-trailing-icon-color:rgba(0, 0, 0, .38);--mdc-list-list-item-selected-trailing-icon-color:rgba(0, 0, 0, .38);--mdc-list-list-item-disabled-label-text-color:black;--mdc-list-list-item-disabled-leading-icon-color:black;--mdc-list-list-item-disabled-trailing-icon-color:black;--mdc-list-list-item-hover-label-text-color:rgba(0, 0, 0, .87);--mdc-list-list-item-hover-leading-icon-color:rgba(0, 0, 0, .38);--mdc-list-list-item-hover-trailing-icon-color:rgba(0, 0, 0, .38);--mdc-list-list-item-focus-label-text-color:rgba(0, 0, 0, .87);--mdc-list-list-item-hover-state-layer-color:black;--mdc-list-list-item-hover-state-layer-opacity:.04;--mdc-list-list-item-focus-state-layer-color:black;--mdc-list-list-item-focus-state-layer-opacity:.12}.mdc-list-item__start[_ngcontent-%COMP%], .mdc-list-item__end[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color:#000;--mdc-radio-disabled-unselected-icon-color:#000;--mdc-radio-unselected-hover-icon-color:#212121;--mdc-radio-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-radio-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-radio-selected-focus-icon-color:#673ab7;--mdc-radio-selected-hover-icon-color:#673ab7;--mdc-radio-selected-icon-color:#673ab7;--mdc-radio-selected-pressed-icon-color:#673ab7}.mat-accent[_ngcontent-%COMP%]   .mdc-list-item__start[_ngcontent-%COMP%], .mat-accent[_ngcontent-%COMP%]   .mdc-list-item__end[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color:#000;--mdc-radio-disabled-unselected-icon-color:#000;--mdc-radio-unselected-hover-icon-color:#212121;--mdc-radio-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-radio-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-radio-selected-focus-icon-color:#ffd740;--mdc-radio-selected-hover-icon-color:#ffd740;--mdc-radio-selected-icon-color:#ffd740;--mdc-radio-selected-pressed-icon-color:#ffd740}.mat-warn[_ngcontent-%COMP%]   .mdc-list-item__start[_ngcontent-%COMP%], .mat-warn[_ngcontent-%COMP%]   .mdc-list-item__end[_ngcontent-%COMP%]{--mdc-radio-disabled-selected-icon-color:#000;--mdc-radio-disabled-unselected-icon-color:#000;--mdc-radio-unselected-hover-icon-color:#212121;--mdc-radio-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-radio-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-radio-selected-focus-icon-color:#f44336;--mdc-radio-selected-hover-icon-color:#f44336;--mdc-radio-selected-icon-color:#f44336;--mdc-radio-selected-pressed-icon-color:#f44336}.mat-mdc-list-option[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-disabled-unselected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-selected-checkmark-color:#fff;--mdc-checkbox-selected-focus-icon-color:#673ab7;--mdc-checkbox-selected-hover-icon-color:#673ab7;--mdc-checkbox-selected-icon-color:#673ab7;--mdc-checkbox-selected-pressed-icon-color:#673ab7;--mdc-checkbox-unselected-focus-icon-color:#212121;--mdc-checkbox-unselected-hover-icon-color:#212121;--mdc-checkbox-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-selected-focus-state-layer-color:#673ab7;--mdc-checkbox-selected-hover-state-layer-color:#673ab7;--mdc-checkbox-selected-pressed-state-layer-color:#673ab7;--mdc-checkbox-unselected-focus-state-layer-color:black;--mdc-checkbox-unselected-hover-state-layer-color:black;--mdc-checkbox-unselected-pressed-state-layer-color:black}.mat-mdc-list-option.mat-accent[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-disabled-unselected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-selected-checkmark-color:#000;--mdc-checkbox-selected-focus-icon-color:#ffd740;--mdc-checkbox-selected-hover-icon-color:#ffd740;--mdc-checkbox-selected-icon-color:#ffd740;--mdc-checkbox-selected-pressed-icon-color:#ffd740;--mdc-checkbox-unselected-focus-icon-color:#212121;--mdc-checkbox-unselected-hover-icon-color:#212121;--mdc-checkbox-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-selected-focus-state-layer-color:#ffd740;--mdc-checkbox-selected-hover-state-layer-color:#ffd740;--mdc-checkbox-selected-pressed-state-layer-color:#ffd740;--mdc-checkbox-unselected-focus-state-layer-color:black;--mdc-checkbox-unselected-hover-state-layer-color:black;--mdc-checkbox-unselected-pressed-state-layer-color:black}.mat-mdc-list-option.mat-warn[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-disabled-unselected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-selected-checkmark-color:#fff;--mdc-checkbox-selected-focus-icon-color:#f44336;--mdc-checkbox-selected-hover-icon-color:#f44336;--mdc-checkbox-selected-icon-color:#f44336;--mdc-checkbox-selected-pressed-icon-color:#f44336;--mdc-checkbox-unselected-focus-icon-color:#212121;--mdc-checkbox-unselected-hover-icon-color:#212121;--mdc-checkbox-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-selected-focus-state-layer-color:#f44336;--mdc-checkbox-selected-hover-state-layer-color:#f44336;--mdc-checkbox-selected-pressed-state-layer-color:#f44336;--mdc-checkbox-unselected-focus-state-layer-color:black;--mdc-checkbox-unselected-hover-state-layer-color:black;--mdc-checkbox-unselected-pressed-state-layer-color:black}.mat-mdc-list-base.mat-mdc-list-base[_ngcontent-%COMP%]   .mdc-list-item--selected[_ngcontent-%COMP%]   .mdc-list-item__primary-text[_ngcontent-%COMP%], .mat-mdc-list-base.mat-mdc-list-base[_ngcontent-%COMP%]   .mdc-list-item--activated[_ngcontent-%COMP%]   .mdc-list-item__primary-text[_ngcontent-%COMP%], .mat-mdc-list-base.mat-mdc-list-base[_ngcontent-%COMP%]   .mdc-list-item--selected.mdc-list-item--with-leading-icon[_ngcontent-%COMP%]   .mdc-list-item__start[_ngcontent-%COMP%], .mat-mdc-list-base.mat-mdc-list-base[_ngcontent-%COMP%]   .mdc-list-item--activated.mdc-list-item--with-leading-icon[_ngcontent-%COMP%]   .mdc-list-item__start[_ngcontent-%COMP%]{color:#673ab7}.mat-mdc-list-base[_ngcontent-%COMP%]   .mdc-list-item--disabled[_ngcontent-%COMP%]   .mdc-list-item__start[_ngcontent-%COMP%], .mat-mdc-list-base[_ngcontent-%COMP%]   .mdc-list-item--disabled[_ngcontent-%COMP%]   .mdc-list-item__content[_ngcontent-%COMP%], .mat-mdc-list-base[_ngcontent-%COMP%]   .mdc-list-item--disabled[_ngcontent-%COMP%]   .mdc-list-item__end[_ngcontent-%COMP%]{opacity:1}.mat-mdc-list-base[_ngcontent-%COMP%]{--mdc-list-list-item-one-line-container-height:48px;--mdc-list-list-item-two-line-container-height:64px;--mdc-list-list-item-three-line-container-height:88px}.mat-mdc-list-item.mdc-list-item--with-leading-avatar.mdc-list-item--with-one-line[_ngcontent-%COMP%], .mat-mdc-list-item.mdc-list-item--with-leading-checkbox.mdc-list-item--with-one-line[_ngcontent-%COMP%], .mat-mdc-list-item.mdc-list-item--with-leading-icon.mdc-list-item--with-one-line[_ngcontent-%COMP%]{height:56px}.mat-mdc-list-item.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines[_ngcontent-%COMP%], .mat-mdc-list-item.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines[_ngcontent-%COMP%], .mat-mdc-list-item.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines[_ngcontent-%COMP%]{height:72px}.mat-mdc-list-base[_ngcontent-%COMP%]{--mdc-list-list-item-label-text-font:Roboto, sans-serif;--mdc-list-list-item-label-text-line-height:24px;--mdc-list-list-item-label-text-size:16px;--mdc-list-list-item-label-text-tracking:.03125em;--mdc-list-list-item-label-text-weight:400;--mdc-list-list-item-supporting-text-font:Roboto, sans-serif;--mdc-list-list-item-supporting-text-line-height:20px;--mdc-list-list-item-supporting-text-size:14px;--mdc-list-list-item-supporting-text-tracking:.0178571429em;--mdc-list-list-item-supporting-text-weight:400;--mdc-list-list-item-trailing-supporting-text-font:Roboto, sans-serif;--mdc-list-list-item-trailing-supporting-text-line-height:20px;--mdc-list-list-item-trailing-supporting-text-size:12px;--mdc-list-list-item-trailing-supporting-text-tracking:.0333333333em;--mdc-list-list-item-trailing-supporting-text-weight:400}.mdc-list-group__subheader[_ngcontent-%COMP%]{font-size:16px;font-weight:400;line-height:28px;font-family:Roboto,sans-serif;letter-spacing:.009375em}html[_ngcontent-%COMP%]{--mat-paginator-container-text-color:rgba(0, 0, 0, .87);--mat-paginator-container-background-color:white;--mat-paginator-enabled-icon-color:rgba(0, 0, 0, .54);--mat-paginator-disabled-icon-color:rgba(0, 0, 0, .12)}html[_ngcontent-%COMP%]{--mat-paginator-container-size:56px}.mat-mdc-paginator[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{min-height:40px}.mat-mdc-paginator[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]   .mat-mdc-form-field-flex[_ngcontent-%COMP%]   .mat-mdc-floating-label[_ngcontent-%COMP%]{top:20px}.mat-mdc-paginator[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper.mdc-text-field--outlined[_ngcontent-%COMP%]   .mdc-notched-outline--upgraded[_ngcontent-%COMP%]   .mdc-floating-label--float-above[_ngcontent-%COMP%]{--mat-mdc-form-field-label-transform: translateY( -26.75px) scale(var(--mat-mdc-form-field-floating-label-scale, .75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-paginator[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper.mdc-text-field--outlined[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px}.mat-mdc-paginator[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]:not(.mdc-text-field--outlined)   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px}.mat-mdc-paginator[_ngcontent-%COMP%]   .mdc-text-field--no-label[_ngcontent-%COMP%]:not(.mdc-text-field--outlined):not(.mdc-text-field--textarea)   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{padding-top:8px;padding-bottom:8px}.mat-mdc-paginator[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]:not(.mdc-text-field--outlined)   .mat-mdc-floating-label[_ngcontent-%COMP%]{display:none}html[_ngcontent-%COMP%]{--mat-paginator-container-text-font:Roboto, sans-serif;--mat-paginator-container-text-line-height:20px;--mat-paginator-container-text-size:12px;--mat-paginator-container-text-tracking:.0333333333em;--mat-paginator-container-text-weight:400;--mat-paginator-select-trigger-text-size:12px}.mat-mdc-tab-group[_ngcontent-%COMP%], .mat-mdc-tab-nav-bar[_ngcontent-%COMP%]{--mdc-tab-indicator-active-indicator-color:#673ab7;--mat-tab-header-disabled-ripple-color:rgba(0, 0, 0, .38);--mat-tab-header-pagination-icon-color:#000;--mat-tab-header-inactive-label-text-color:rgba(0, 0, 0, .6);--mat-tab-header-active-label-text-color:#673ab7;--mat-tab-header-active-ripple-color:#673ab7;--mat-tab-header-inactive-ripple-color:#673ab7;--mat-tab-header-inactive-focus-label-text-color:rgba(0, 0, 0, .6);--mat-tab-header-inactive-hover-label-text-color:rgba(0, 0, 0, .6);--mat-tab-header-active-focus-label-text-color:#673ab7;--mat-tab-header-active-hover-label-text-color:#673ab7;--mat-tab-header-active-focus-indicator-color:#673ab7;--mat-tab-header-active-hover-indicator-color:#673ab7}.mat-mdc-tab-group.mat-accent[_ngcontent-%COMP%], .mat-mdc-tab-nav-bar.mat-accent[_ngcontent-%COMP%]{--mdc-tab-indicator-active-indicator-color:#ffd740;--mat-tab-header-disabled-ripple-color:rgba(0, 0, 0, .38);--mat-tab-header-pagination-icon-color:#000;--mat-tab-header-inactive-label-text-color:rgba(0, 0, 0, .6);--mat-tab-header-active-label-text-color:#ffd740;--mat-tab-header-active-ripple-color:#ffd740;--mat-tab-header-inactive-ripple-color:#ffd740;--mat-tab-header-inactive-focus-label-text-color:rgba(0, 0, 0, .6);--mat-tab-header-inactive-hover-label-text-color:rgba(0, 0, 0, .6);--mat-tab-header-active-focus-label-text-color:#ffd740;--mat-tab-header-active-hover-label-text-color:#ffd740;--mat-tab-header-active-focus-indicator-color:#ffd740;--mat-tab-header-active-hover-indicator-color:#ffd740}.mat-mdc-tab-group.mat-warn[_ngcontent-%COMP%], .mat-mdc-tab-nav-bar.mat-warn[_ngcontent-%COMP%]{--mdc-tab-indicator-active-indicator-color:#f44336;--mat-tab-header-disabled-ripple-color:rgba(0, 0, 0, .38);--mat-tab-header-pagination-icon-color:#000;--mat-tab-header-inactive-label-text-color:rgba(0, 0, 0, .6);--mat-tab-header-active-label-text-color:#f44336;--mat-tab-header-active-ripple-color:#f44336;--mat-tab-header-inactive-ripple-color:#f44336;--mat-tab-header-inactive-focus-label-text-color:rgba(0, 0, 0, .6);--mat-tab-header-inactive-hover-label-text-color:rgba(0, 0, 0, .6);--mat-tab-header-active-focus-label-text-color:#f44336;--mat-tab-header-active-hover-label-text-color:#f44336;--mat-tab-header-active-focus-indicator-color:#f44336;--mat-tab-header-active-hover-indicator-color:#f44336}.mat-mdc-tab-group.mat-background-primary[_ngcontent-%COMP%], .mat-mdc-tab-nav-bar.mat-background-primary[_ngcontent-%COMP%]{--mat-tab-header-with-background-background-color:#673ab7;--mat-tab-header-with-background-foreground-color:white}.mat-mdc-tab-group.mat-background-accent[_ngcontent-%COMP%], .mat-mdc-tab-nav-bar.mat-background-accent[_ngcontent-%COMP%]{--mat-tab-header-with-background-background-color:#ffd740;--mat-tab-header-with-background-foreground-color:rgba(0, 0, 0, .87)}.mat-mdc-tab-group.mat-background-warn[_ngcontent-%COMP%], .mat-mdc-tab-nav-bar.mat-background-warn[_ngcontent-%COMP%]{--mat-tab-header-with-background-background-color:#f44336;--mat-tab-header-with-background-foreground-color:white}.mat-mdc-tab-header[_ngcontent-%COMP%]{--mdc-secondary-navigation-tab-container-height:48px}.mat-mdc-tab-header[_ngcontent-%COMP%]{--mat-tab-header-label-text-font:Roboto, sans-serif;--mat-tab-header-label-text-size:14px;--mat-tab-header-label-text-tracking:.0892857143em;--mat-tab-header-label-text-line-height:36px;--mat-tab-header-label-text-weight:500}html[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-disabled-unselected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-selected-checkmark-color:#000;--mdc-checkbox-selected-focus-icon-color:#ffd740;--mdc-checkbox-selected-hover-icon-color:#ffd740;--mdc-checkbox-selected-icon-color:#ffd740;--mdc-checkbox-selected-pressed-icon-color:#ffd740;--mdc-checkbox-unselected-focus-icon-color:#212121;--mdc-checkbox-unselected-hover-icon-color:#212121;--mdc-checkbox-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-selected-focus-state-layer-color:#ffd740;--mdc-checkbox-selected-hover-state-layer-color:#ffd740;--mdc-checkbox-selected-pressed-state-layer-color:#ffd740;--mdc-checkbox-unselected-focus-state-layer-color:black;--mdc-checkbox-unselected-hover-state-layer-color:black;--mdc-checkbox-unselected-pressed-state-layer-color:black}.mat-mdc-checkbox.mat-primary[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-disabled-unselected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-selected-checkmark-color:#fff;--mdc-checkbox-selected-focus-icon-color:#673ab7;--mdc-checkbox-selected-hover-icon-color:#673ab7;--mdc-checkbox-selected-icon-color:#673ab7;--mdc-checkbox-selected-pressed-icon-color:#673ab7;--mdc-checkbox-unselected-focus-icon-color:#212121;--mdc-checkbox-unselected-hover-icon-color:#212121;--mdc-checkbox-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-selected-focus-state-layer-color:#673ab7;--mdc-checkbox-selected-hover-state-layer-color:#673ab7;--mdc-checkbox-selected-pressed-state-layer-color:#673ab7;--mdc-checkbox-unselected-focus-state-layer-color:black;--mdc-checkbox-unselected-hover-state-layer-color:black;--mdc-checkbox-unselected-pressed-state-layer-color:black}.mat-mdc-checkbox.mat-warn[_ngcontent-%COMP%]{--mdc-checkbox-disabled-selected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-disabled-unselected-icon-color:rgba(0, 0, 0, .38);--mdc-checkbox-selected-checkmark-color:#fff;--mdc-checkbox-selected-focus-icon-color:#f44336;--mdc-checkbox-selected-hover-icon-color:#f44336;--mdc-checkbox-selected-icon-color:#f44336;--mdc-checkbox-selected-pressed-icon-color:#f44336;--mdc-checkbox-unselected-focus-icon-color:#212121;--mdc-checkbox-unselected-hover-icon-color:#212121;--mdc-checkbox-unselected-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-unselected-pressed-icon-color:rgba(0, 0, 0, .54);--mdc-checkbox-selected-focus-state-layer-color:#f44336;--mdc-checkbox-selected-hover-state-layer-color:#f44336;--mdc-checkbox-selected-pressed-state-layer-color:#f44336;--mdc-checkbox-unselected-focus-state-layer-color:black;--mdc-checkbox-unselected-hover-state-layer-color:black;--mdc-checkbox-unselected-pressed-state-layer-color:black}.mat-mdc-checkbox[_ngcontent-%COMP%]   .mdc-form-field[_ngcontent-%COMP%]{color:var(--mdc-theme-text-primary-on-background, rgba(0, 0, 0, .87))}.mat-mdc-checkbox.mat-mdc-checkbox-disabled[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#00000061}html[_ngcontent-%COMP%]{--mdc-checkbox-state-layer-size:40px}.mat-mdc-checkbox[_ngcontent-%COMP%]   .mdc-form-field[_ngcontent-%COMP%]{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mdc-typography-body2-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:var(--mdc-typography-body2-font-size, 14px);line-height:var(--mdc-typography-body2-line-height, 20px);font-weight:var(--mdc-typography-body2-font-weight, 400);letter-spacing:var(--mdc-typography-body2-letter-spacing, .0178571429em);-webkit-text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-decoration:var(--mdc-typography-body2-text-decoration, inherit);text-transform:var(--mdc-typography-body2-text-transform, none)}.mat-mdc-button.mat-unthemed[_ngcontent-%COMP%]{--mdc-text-button-label-text-color:#000}.mat-mdc-button.mat-primary[_ngcontent-%COMP%]{--mdc-text-button-label-text-color:#673ab7}.mat-mdc-button.mat-accent[_ngcontent-%COMP%]{--mdc-text-button-label-text-color:#ffd740}.mat-mdc-button.mat-warn[_ngcontent-%COMP%]{--mdc-text-button-label-text-color:#f44336}.mat-mdc-button[disabled][disabled][_ngcontent-%COMP%]{--mdc-text-button-disabled-label-text-color:rgba(0, 0, 0, .38);--mdc-text-button-label-text-color:rgba(0, 0, 0, .38)}.mat-mdc-unelevated-button.mat-unthemed[_ngcontent-%COMP%]{--mdc-filled-button-container-color:#fff;--mdc-filled-button-label-text-color:#000}.mat-mdc-unelevated-button.mat-primary[_ngcontent-%COMP%]{--mdc-filled-button-container-color:#673ab7;--mdc-filled-button-label-text-color:#fff}.mat-mdc-unelevated-button.mat-accent[_ngcontent-%COMP%]{--mdc-filled-button-container-color:#ffd740;--mdc-filled-button-label-text-color:#000}.mat-mdc-unelevated-button.mat-warn[_ngcontent-%COMP%]{--mdc-filled-button-container-color:#f44336;--mdc-filled-button-label-text-color:#fff}.mat-mdc-unelevated-button[disabled][disabled][_ngcontent-%COMP%]{--mdc-filled-button-disabled-container-color:rgba(0, 0, 0, .12);--mdc-filled-button-disabled-label-text-color:rgba(0, 0, 0, .38);--mdc-filled-button-container-color:rgba(0, 0, 0, .12);--mdc-filled-button-label-text-color:rgba(0, 0, 0, .38)}.mat-mdc-raised-button.mat-unthemed[_ngcontent-%COMP%]{--mdc-protected-button-container-color:#fff;--mdc-protected-button-label-text-color:#000}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%]{--mdc-protected-button-container-color:#673ab7;--mdc-protected-button-label-text-color:#fff}.mat-mdc-raised-button.mat-accent[_ngcontent-%COMP%]{--mdc-protected-button-container-color:#ffd740;--mdc-protected-button-label-text-color:#000}.mat-mdc-raised-button.mat-warn[_ngcontent-%COMP%]{--mdc-protected-button-container-color:#f44336;--mdc-protected-button-label-text-color:#fff}.mat-mdc-raised-button[disabled][disabled][_ngcontent-%COMP%]{--mdc-protected-button-disabled-container-color:rgba(0, 0, 0, .12);--mdc-protected-button-disabled-label-text-color:rgba(0, 0, 0, .38);--mdc-protected-button-container-color:rgba(0, 0, 0, .12);--mdc-protected-button-label-text-color:rgba(0, 0, 0, .38);--mdc-protected-button-container-elevation:0}.mat-mdc-outlined-button[_ngcontent-%COMP%]{--mdc-outlined-button-outline-color:rgba(0, 0, 0, .12)}.mat-mdc-outlined-button.mat-unthemed[_ngcontent-%COMP%]{--mdc-outlined-button-label-text-color:#000}.mat-mdc-outlined-button.mat-primary[_ngcontent-%COMP%]{--mdc-outlined-button-label-text-color:#673ab7}.mat-mdc-outlined-button.mat-accent[_ngcontent-%COMP%]{--mdc-outlined-button-label-text-color:#ffd740}.mat-mdc-outlined-button.mat-warn[_ngcontent-%COMP%]{--mdc-outlined-button-label-text-color:#f44336}.mat-mdc-outlined-button[disabled][disabled][_ngcontent-%COMP%]{--mdc-outlined-button-label-text-color:rgba(0, 0, 0, .38);--mdc-outlined-button-disabled-label-text-color:rgba(0, 0, 0, .38);--mdc-outlined-button-outline-color:rgba(0, 0, 0, .12);--mdc-outlined-button-disabled-outline-color:rgba(0, 0, 0, .12)}.mat-mdc-button[_ngcontent-%COMP%], .mat-mdc-outlined-button[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #000;--mat-mdc-button-ripple-color: rgba(0, 0, 0, .1)}.mat-mdc-button[_ngcontent-%COMP%]:hover   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-outlined-button[_ngcontent-%COMP%]:hover   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.04}.mat-mdc-button.cdk-program-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-button.cdk-keyboard-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-outlined-button.cdk-program-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-outlined-button.cdk-keyboard-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.12}.mat-mdc-button[_ngcontent-%COMP%]:active   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-outlined-button[_ngcontent-%COMP%]:active   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.12}.mat-mdc-button.mat-primary[_ngcontent-%COMP%], .mat-mdc-outlined-button.mat-primary[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #673ab7;--mat-mdc-button-ripple-color: rgba(103, 58, 183, .1)}.mat-mdc-button.mat-accent[_ngcontent-%COMP%], .mat-mdc-outlined-button.mat-accent[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #ffd740;--mat-mdc-button-ripple-color: rgba(255, 215, 64, .1)}.mat-mdc-button.mat-warn[_ngcontent-%COMP%], .mat-mdc-outlined-button.mat-warn[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #f44336;--mat-mdc-button-ripple-color: rgba(244, 67, 54, .1)}.mat-mdc-raised-button[_ngcontent-%COMP%], .mat-mdc-unelevated-button[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #000;--mat-mdc-button-ripple-color: rgba(0, 0, 0, .1)}.mat-mdc-raised-button[_ngcontent-%COMP%]:hover   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-unelevated-button[_ngcontent-%COMP%]:hover   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.04}.mat-mdc-raised-button.cdk-program-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-raised-button.cdk-keyboard-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-unelevated-button.cdk-program-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-unelevated-button.cdk-keyboard-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.12}.mat-mdc-raised-button[_ngcontent-%COMP%]:active   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-unelevated-button[_ngcontent-%COMP%]:active   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.12}.mat-mdc-raised-button.mat-primary[_ngcontent-%COMP%], .mat-mdc-unelevated-button.mat-primary[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #fff;--mat-mdc-button-ripple-color: rgba(255, 255, 255, .1)}.mat-mdc-raised-button.mat-accent[_ngcontent-%COMP%], .mat-mdc-unelevated-button.mat-accent[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #000;--mat-mdc-button-ripple-color: rgba(0, 0, 0, .1)}.mat-mdc-raised-button.mat-warn[_ngcontent-%COMP%], .mat-mdc-unelevated-button.mat-warn[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #fff;--mat-mdc-button-ripple-color: rgba(255, 255, 255, .1)}.mat-mdc-button.mat-mdc-button-base[_ngcontent-%COMP%], .mat-mdc-raised-button.mat-mdc-button-base[_ngcontent-%COMP%], .mat-mdc-unelevated-button.mat-mdc-button-base[_ngcontent-%COMP%], .mat-mdc-outlined-button.mat-mdc-button-base[_ngcontent-%COMP%]{height:36px}.mdc-button[_ngcontent-%COMP%]{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mdc-typography-button-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:var(--mdc-typography-button-font-size, 14px);line-height:var(--mdc-typography-button-line-height, 36px);font-weight:var(--mdc-typography-button-font-weight, 500);letter-spacing:var(--mdc-typography-button-letter-spacing, .0892857143em);-webkit-text-decoration:var(--mdc-typography-button-text-decoration, none);text-decoration:var(--mdc-typography-button-text-decoration, none);text-transform:var(--mdc-typography-button-text-transform, none)}.mat-mdc-icon-button[_ngcontent-%COMP%]{--mdc-icon-button-icon-color:inherit;--mat-mdc-button-persistent-ripple-color: #000;--mat-mdc-button-ripple-color: rgba(0, 0, 0, .1)}.mat-mdc-icon-button[_ngcontent-%COMP%]:hover   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.04}.mat-mdc-icon-button.cdk-program-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-icon-button.cdk-keyboard-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.12}.mat-mdc-icon-button[_ngcontent-%COMP%]:active   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.12}.mat-mdc-icon-button.mat-primary[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #6200ee;--mat-mdc-button-ripple-color: rgba(98, 0, 238, .1)}.mat-mdc-icon-button.mat-accent[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #018786;--mat-mdc-button-ripple-color: rgba(1, 135, 134, .1)}.mat-mdc-icon-button.mat-warn[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #b00020;--mat-mdc-button-ripple-color: rgba(176, 0, 32, .1)}.mat-mdc-icon-button.mat-primary[_ngcontent-%COMP%]{--mdc-icon-button-icon-color:#673ab7;--mat-mdc-button-persistent-ripple-color: #673ab7;--mat-mdc-button-ripple-color: rgba(103, 58, 183, .1)}.mat-mdc-icon-button.mat-accent[_ngcontent-%COMP%]{--mdc-icon-button-icon-color:#ffd740;--mat-mdc-button-persistent-ripple-color: #ffd740;--mat-mdc-button-ripple-color: rgba(255, 215, 64, .1)}.mat-mdc-icon-button.mat-warn[_ngcontent-%COMP%]{--mdc-icon-button-icon-color:#f44336;--mat-mdc-button-persistent-ripple-color: #f44336;--mat-mdc-button-ripple-color: rgba(244, 67, 54, .1)}.mat-mdc-icon-button[disabled][disabled][_ngcontent-%COMP%]{--mdc-icon-button-icon-color:rgba(0, 0, 0, .38);--mdc-icon-button-disabled-icon-color:rgba(0, 0, 0, .38)}.mat-mdc-icon-button.mat-mdc-button-base[_ngcontent-%COMP%]{--mdc-icon-button-state-layer-size:48px;width:var(--mdc-icon-button-state-layer-size);height:var(--mdc-icon-button-state-layer-size);padding:12px}.mat-mdc-fab[_ngcontent-%COMP%], .mat-mdc-mini-fab[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #000;--mat-mdc-button-ripple-color: rgba(0, 0, 0, .1)}.mat-mdc-fab[_ngcontent-%COMP%]:hover   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-mini-fab[_ngcontent-%COMP%]:hover   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.04}.mat-mdc-fab.cdk-program-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-fab.cdk-keyboard-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-mini-fab.cdk-program-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-mini-fab.cdk-keyboard-focused[_ngcontent-%COMP%]   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.12}.mat-mdc-fab[_ngcontent-%COMP%]:active   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before, .mat-mdc-mini-fab[_ngcontent-%COMP%]:active   .mat-mdc-button-persistent-ripple[_ngcontent-%COMP%]:before{opacity:.12}.mat-mdc-fab.mat-primary[_ngcontent-%COMP%], .mat-mdc-mini-fab.mat-primary[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #fff;--mat-mdc-button-ripple-color: rgba(255, 255, 255, .1)}.mat-mdc-fab.mat-accent[_ngcontent-%COMP%], .mat-mdc-mini-fab.mat-accent[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #000;--mat-mdc-button-ripple-color: rgba(0, 0, 0, .1)}.mat-mdc-fab.mat-warn[_ngcontent-%COMP%], .mat-mdc-mini-fab.mat-warn[_ngcontent-%COMP%]{--mat-mdc-button-persistent-ripple-color: #fff;--mat-mdc-button-ripple-color: rgba(255, 255, 255, .1)}.mat-mdc-fab[disabled][disabled][_ngcontent-%COMP%], .mat-mdc-mini-fab[disabled][disabled][_ngcontent-%COMP%]{--mdc-fab-container-color:rgba(0, 0, 0, .12);--mdc-fab-icon-color:rgba(0, 0, 0, .38);--mat-mdc-fab-color: rgba(0, 0, 0, .38)}.mat-mdc-fab.mat-unthemed[_ngcontent-%COMP%], .mat-mdc-mini-fab.mat-unthemed[_ngcontent-%COMP%]{--mdc-fab-container-color:white;--mdc-fab-icon-color:black;--mat-mdc-fab-color: #000}.mat-mdc-fab.mat-primary[_ngcontent-%COMP%], .mat-mdc-mini-fab.mat-primary[_ngcontent-%COMP%]{--mdc-fab-container-color:#673ab7;--mdc-fab-icon-color:white;--mat-mdc-fab-color: #fff}.mat-mdc-fab.mat-accent[_ngcontent-%COMP%], .mat-mdc-mini-fab.mat-accent[_ngcontent-%COMP%]{--mdc-fab-container-color:#ffd740;--mdc-fab-icon-color:black;--mat-mdc-fab-color: #000}.mat-mdc-fab.mat-warn[_ngcontent-%COMP%], .mat-mdc-mini-fab.mat-warn[_ngcontent-%COMP%]{--mdc-fab-container-color:#f44336;--mdc-fab-icon-color:white;--mat-mdc-fab-color: #fff}.mdc-fab--extended[_ngcontent-%COMP%]{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mdc-typography-button-font-family, var(--mdc-typography-font-family, Roboto, sans-serif));font-size:var(--mdc-typography-button-font-size, 14px);line-height:var(--mdc-typography-button-line-height, 36px);font-weight:var(--mdc-typography-button-font-weight, 500);letter-spacing:var(--mdc-typography-button-letter-spacing, .0892857143em);-webkit-text-decoration:var(--mdc-typography-button-text-decoration, none);text-decoration:var(--mdc-typography-button-text-decoration, none);text-transform:var(--mdc-typography-button-text-transform, none)}.mat-mdc-extended-fab[_ngcontent-%COMP%]{--mdc-extended-fab-label-text-font:Roboto, sans-serif;--mdc-extended-fab-label-text-size:14px;--mdc-extended-fab-label-text-tracking:.0892857143em;--mdc-extended-fab-label-text-weight:500}.mat-mdc-snack-bar-container[_ngcontent-%COMP%]{--mdc-snackbar-container-color:#333333;--mdc-snackbar-supporting-text-color:rgba(255, 255, 255, .87);--mat-snack-bar-button-color:#ffd740}.mat-mdc-snack-bar-container[_ngcontent-%COMP%]{--mdc-snackbar-supporting-text-font:Roboto, sans-serif;--mdc-snackbar-supporting-text-line-height:20px;--mdc-snackbar-supporting-text-size:14px;--mdc-snackbar-supporting-text-weight:400}html[_ngcontent-%COMP%]{--mat-table-background-color:white;--mat-table-header-headline-color:rgba(0, 0, 0, .87);--mat-table-row-item-label-text-color:rgba(0, 0, 0, .87);--mat-table-row-item-outline-color:rgba(0, 0, 0, .12)}html[_ngcontent-%COMP%]{--mat-table-header-container-height:56px;--mat-table-footer-container-height:52px;--mat-table-row-item-container-height:52px}html[_ngcontent-%COMP%]{--mat-table-header-headline-font:Roboto, sans-serif;--mat-table-header-headline-line-height:22px;--mat-table-header-headline-size:14px;--mat-table-header-headline-weight:500;--mat-table-header-headline-tracking:.0071428571em;--mat-table-row-item-label-text-font:Roboto, sans-serif;--mat-table-row-item-label-text-line-height:20px;--mat-table-row-item-label-text-size:14px;--mat-table-row-item-label-text-weight:400;--mat-table-row-item-label-text-tracking:.0178571429em;--mat-table-footer-supporting-text-font:Roboto, sans-serif;--mat-table-footer-supporting-text-line-height:20px;--mat-table-footer-supporting-text-size:14px;--mat-table-footer-supporting-text-weight:400;--mat-table-footer-supporting-text-tracking:.0178571429em}.mat-mdc-progress-spinner[_ngcontent-%COMP%]{--mdc-circular-progress-active-indicator-color:#673ab7}.mat-mdc-progress-spinner.mat-accent[_ngcontent-%COMP%]{--mdc-circular-progress-active-indicator-color:#ffd740}.mat-mdc-progress-spinner.mat-warn[_ngcontent-%COMP%]{--mdc-circular-progress-active-indicator-color:#f44336}.mat-badge[_ngcontent-%COMP%]{position:relative}.mat-badge.mat-badge[_ngcontent-%COMP%]{overflow:visible}.mat-badge-content[_ngcontent-%COMP%]{position:absolute;text-align:center;display:inline-block;border-radius:50%;transition:transform .2s ease-in-out;transform:scale(.6);overflow:hidden;white-space:nowrap;text-overflow:ellipsis;pointer-events:none;background-color:var(--mat-badge-background-color);color:var(--mat-badge-text-color);font-family:Roboto,sans-serif;font-family:var(--mat-badge-text-font, Roboto, sans-serif);font-size:12px;font-size:var(--mat-badge-text-size, 12px);font-weight:600;font-weight:var(--mat-badge-text-weight, 600)}.cdk-high-contrast-active[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{outline:solid 1px;border-radius:0}.mat-badge-disabled[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{background-color:var(--mat-badge-disabled-state-background-color);color:var(--mat-badge-disabled-state-text-color)}.mat-badge-hidden[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{display:none}.ng-animate-disabled[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%], .mat-badge-content._mat-animation-noopable[_ngcontent-%COMP%]{transition:none}.mat-badge-content.mat-badge-active[_ngcontent-%COMP%]{transform:none}.mat-badge-small[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{width:16px;height:16px;line-height:16px;font-size:9px;font-size:var(--mat-badge-small-size-text-size, 9px)}.mat-badge-small.mat-badge-above[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{top:-8px}.mat-badge-small.mat-badge-below[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{bottom:-8px}.mat-badge-small.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:-16px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-small.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:auto;right:-16px}.mat-badge-small.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:-16px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-small.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:auto;left:-16px}.mat-badge-small.mat-badge-overlap.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:-8px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-small.mat-badge-overlap.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:auto;right:-8px}.mat-badge-small.mat-badge-overlap.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:-8px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-small.mat-badge-overlap.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:auto;left:-8px}.mat-badge-medium[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{width:22px;height:22px;line-height:22px}.mat-badge-medium.mat-badge-above[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{top:-11px}.mat-badge-medium.mat-badge-below[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{bottom:-11px}.mat-badge-medium.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:-22px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-medium.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:auto;right:-22px}.mat-badge-medium.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:-22px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-medium.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:auto;left:-22px}.mat-badge-medium.mat-badge-overlap.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:-11px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-medium.mat-badge-overlap.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:auto;right:-11px}.mat-badge-medium.mat-badge-overlap.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:-11px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-medium.mat-badge-overlap.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:auto;left:-11px}.mat-badge-large[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{width:28px;height:28px;line-height:28px;font-size:24px;font-size:var(--mat-badge-large-size-text-size, 24px)}.mat-badge-large.mat-badge-above[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{top:-14px}.mat-badge-large.mat-badge-below[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{bottom:-14px}.mat-badge-large.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:-28px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-large.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:auto;right:-28px}.mat-badge-large.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:-28px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-large.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:auto;left:-28px}.mat-badge-large.mat-badge-overlap.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:-14px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-large.mat-badge-overlap.mat-badge-before[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{left:auto;right:-14px}.mat-badge-large.mat-badge-overlap.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:-14px}[dir=rtl][_ngcontent-%COMP%]   .mat-badge-large.mat-badge-overlap.mat-badge-after[_ngcontent-%COMP%]   .mat-badge-content[_ngcontent-%COMP%]{right:auto;left:-14px}html[_ngcontent-%COMP%]{--mat-badge-background-color:#673ab7;--mat-badge-text-color:white;--mat-badge-disabled-state-background-color:#b9b9b9;--mat-badge-disabled-state-text-color:rgba(0, 0, 0, .38)}.mat-badge-accent[_ngcontent-%COMP%]{--mat-badge-background-color:#ffd740;--mat-badge-text-color:rgba(0, 0, 0, .87)}.mat-badge-warn[_ngcontent-%COMP%]{--mat-badge-background-color:#f44336;--mat-badge-text-color:white}html[_ngcontent-%COMP%]{--mat-badge-text-font:Roboto, sans-serif;--mat-badge-text-size:12px;--mat-badge-text-weight:600;--mat-badge-small-size-text-size:9px;--mat-badge-large-size-text-size:24px}html[_ngcontent-%COMP%]{--mat-bottom-sheet-container-text-color:rgba(0, 0, 0, .87);--mat-bottom-sheet-container-background-color:white}html[_ngcontent-%COMP%]{--mat-bottom-sheet-container-text-font:Roboto, sans-serif;--mat-bottom-sheet-container-text-line-height:20px;--mat-bottom-sheet-container-text-size:14px;--mat-bottom-sheet-container-text-tracking:.0178571429em;--mat-bottom-sheet-container-text-weight:400}html[_ngcontent-%COMP%]{--mat-legacy-button-toggle-text-color:rgba(0, 0, 0, .38);--mat-legacy-button-toggle-state-layer-color:rgba(0, 0, 0, .12);--mat-legacy-button-toggle-selected-state-text-color:rgba(0, 0, 0, .54);--mat-legacy-button-toggle-selected-state-background-color:#e0e0e0;--mat-legacy-button-toggle-disabled-state-text-color:rgba(0, 0, 0, .26);--mat-legacy-button-toggle-disabled-state-background-color:#eeeeee;--mat-legacy-button-toggle-disabled-selected-state-background-color:#bdbdbd;--mat-standard-button-toggle-text-color:rgba(0, 0, 0, .87);--mat-standard-button-toggle-background-color:white;--mat-standard-button-toggle-state-layer-color:black;--mat-standard-button-toggle-selected-state-background-color:#e0e0e0;--mat-standard-button-toggle-selected-state-text-color:rgba(0, 0, 0, .87);--mat-standard-button-toggle-disabled-state-text-color:rgba(0, 0, 0, .26);--mat-standard-button-toggle-disabled-state-background-color:white;--mat-standard-button-toggle-disabled-selected-state-text-color:rgba(0, 0, 0, .87);--mat-standard-button-toggle-disabled-selected-state-background-color:#bdbdbd;--mat-standard-button-toggle-divider-color:#e0e0e0}html[_ngcontent-%COMP%]{--mat-standard-button-toggle-height:48px}html[_ngcontent-%COMP%]{--mat-legacy-button-toggle-text-font:Roboto, sans-serif;--mat-standard-button-toggle-text-font:Roboto, sans-serif}html[_ngcontent-%COMP%]{--mat-datepicker-calendar-date-selected-state-text-color:white;--mat-datepicker-calendar-date-selected-state-background-color:#673ab7;--mat-datepicker-calendar-date-selected-disabled-state-background-color:rgba(103, 58, 183, .4);--mat-datepicker-calendar-date-today-selected-state-outline-color:white;--mat-datepicker-calendar-date-focus-state-background-color:rgba(103, 58, 183, .3);--mat-datepicker-calendar-date-hover-state-background-color:rgba(103, 58, 183, .3);--mat-datepicker-toggle-active-state-icon-color:#673ab7;--mat-datepicker-calendar-date-in-range-state-background-color:rgba(103, 58, 183, .2);--mat-datepicker-calendar-date-in-comparison-range-state-background-color:rgba(249, 171, 0, .2);--mat-datepicker-calendar-date-in-overlap-range-state-background-color:#a8dab5;--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color:#46a35e;--mat-datepicker-toggle-icon-color:rgba(0, 0, 0, .54);--mat-datepicker-calendar-body-label-text-color:rgba(0, 0, 0, .54);--mat-datepicker-calendar-period-button-icon-color:rgba(0, 0, 0, .54);--mat-datepicker-calendar-navigation-button-icon-color:rgba(0, 0, 0, .54);--mat-datepicker-calendar-header-divider-color:rgba(0, 0, 0, .12);--mat-datepicker-calendar-header-text-color:rgba(0, 0, 0, .54);--mat-datepicker-calendar-date-today-outline-color:rgba(0, 0, 0, .38);--mat-datepicker-calendar-date-today-disabled-state-outline-color:rgba(0, 0, 0, .18);--mat-datepicker-calendar-date-text-color:rgba(0, 0, 0, .87);--mat-datepicker-calendar-date-outline-color:transparent;--mat-datepicker-calendar-date-disabled-state-text-color:rgba(0, 0, 0, .38);--mat-datepicker-calendar-date-preview-state-outline-color:rgba(0, 0, 0, .24);--mat-datepicker-range-input-separator-color:rgba(0, 0, 0, .87);--mat-datepicker-range-input-disabled-state-separator-color:rgba(0, 0, 0, .38);--mat-datepicker-range-input-disabled-state-text-color:rgba(0, 0, 0, .38);--mat-datepicker-calendar-container-background-color:white;--mat-datepicker-calendar-container-text-color:rgba(0, 0, 0, .87)}.mat-datepicker-content.mat-accent[_ngcontent-%COMP%]{--mat-datepicker-calendar-date-selected-state-text-color:rgba(0, 0, 0, .87);--mat-datepicker-calendar-date-selected-state-background-color:#ffd740;--mat-datepicker-calendar-date-selected-disabled-state-background-color:rgba(255, 215, 64, .4);--mat-datepicker-calendar-date-today-selected-state-outline-color:rgba(0, 0, 0, .87);--mat-datepicker-calendar-date-focus-state-background-color:rgba(255, 215, 64, .3);--mat-datepicker-calendar-date-hover-state-background-color:rgba(255, 215, 64, .3);--mat-datepicker-calendar-date-in-range-state-background-color:rgba(255, 215, 64, .2);--mat-datepicker-calendar-date-in-comparison-range-state-background-color:rgba(249, 171, 0, .2);--mat-datepicker-calendar-date-in-overlap-range-state-background-color:#a8dab5;--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color:#46a35e}.mat-datepicker-content.mat-warn[_ngcontent-%COMP%]{--mat-datepicker-calendar-date-selected-state-text-color:white;--mat-datepicker-calendar-date-selected-state-background-color:#f44336;--mat-datepicker-calendar-date-selected-disabled-state-background-color:rgba(244, 67, 54, .4);--mat-datepicker-calendar-date-today-selected-state-outline-color:white;--mat-datepicker-calendar-date-focus-state-background-color:rgba(244, 67, 54, .3);--mat-datepicker-calendar-date-hover-state-background-color:rgba(244, 67, 54, .3);--mat-datepicker-calendar-date-in-range-state-background-color:rgba(244, 67, 54, .2);--mat-datepicker-calendar-date-in-comparison-range-state-background-color:rgba(249, 171, 0, .2);--mat-datepicker-calendar-date-in-overlap-range-state-background-color:#a8dab5;--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color:#46a35e}.mat-datepicker-toggle-active.mat-accent[_ngcontent-%COMP%]{--mat-datepicker-toggle-active-state-icon-color:#ffd740}.mat-datepicker-toggle-active.mat-warn[_ngcontent-%COMP%]{--mat-datepicker-toggle-active-state-icon-color:#f44336}.mat-calendar-controls[_ngcontent-%COMP%]   .mat-mdc-icon-button.mat-mdc-button-base[_ngcontent-%COMP%]{--mdc-icon-button-state-layer-size:40px;width:var(--mdc-icon-button-state-layer-size);height:var(--mdc-icon-button-state-layer-size);padding:8px}.mat-calendar-controls[_ngcontent-%COMP%]   .mat-mdc-icon-button.mat-mdc-button-base[_ngcontent-%COMP%]   .mat-mdc-button-touch-target[_ngcontent-%COMP%]{display:none}html[_ngcontent-%COMP%]{--mat-datepicker-calendar-text-font:Roboto, sans-serif;--mat-datepicker-calendar-text-size:13px;--mat-datepicker-calendar-body-label-text-size:14px;--mat-datepicker-calendar-body-label-text-weight:500;--mat-datepicker-calendar-period-button-text-size:14px;--mat-datepicker-calendar-period-button-text-weight:500;--mat-datepicker-calendar-header-text-size:11px;--mat-datepicker-calendar-header-text-weight:400}html[_ngcontent-%COMP%]{--mat-divider-color:rgba(0, 0, 0, .12)}html[_ngcontent-%COMP%]{--mat-expansion-container-background-color:white;--mat-expansion-container-text-color:rgba(0, 0, 0, .87);--mat-expansion-actions-divider-color:rgba(0, 0, 0, .12);--mat-expansion-header-hover-state-layer-color:rgba(0, 0, 0, .04);--mat-expansion-header-focus-state-layer-color:rgba(0, 0, 0, .04);--mat-expansion-header-disabled-state-text-color:rgba(0, 0, 0, .26);--mat-expansion-header-text-color:rgba(0, 0, 0, .87);--mat-expansion-header-description-color:rgba(0, 0, 0, .54);--mat-expansion-header-indicator-color:rgba(0, 0, 0, .54)}html[_ngcontent-%COMP%]{--mat-expansion-header-collapsed-state-height:48px;--mat-expansion-header-expanded-state-height:64px}html[_ngcontent-%COMP%]{--mat-expansion-header-text-font:Roboto, sans-serif;--mat-expansion-header-text-size:14px;--mat-expansion-header-text-weight:500;--mat-expansion-header-text-line-height:inherit;--mat-expansion-header-text-tracking:inherit;--mat-expansion-container-text-font:Roboto, sans-serif;--mat-expansion-container-text-line-height:20px;--mat-expansion-container-text-size:14px;--mat-expansion-container-text-tracking:.0178571429em;--mat-expansion-container-text-weight:400}html[_ngcontent-%COMP%]{--mat-grid-list-tile-header-primary-text-size:14px;--mat-grid-list-tile-header-secondary-text-size:12px;--mat-grid-list-tile-footer-primary-text-size:14px;--mat-grid-list-tile-footer-secondary-text-size:12px}html[_ngcontent-%COMP%]{--mat-icon-color:inherit}.mat-icon.mat-primary[_ngcontent-%COMP%]{--mat-icon-color:#673ab7}.mat-icon.mat-accent[_ngcontent-%COMP%]{--mat-icon-color:#ffd740}.mat-icon.mat-warn[_ngcontent-%COMP%]{--mat-icon-color:#f44336}html[_ngcontent-%COMP%]{--mat-sidenav-container-divider-color:rgba(0, 0, 0, .12);--mat-sidenav-container-background-color:white;--mat-sidenav-container-text-color:rgba(0, 0, 0, .87);--mat-sidenav-content-background-color:#fafafa;--mat-sidenav-content-text-color:rgba(0, 0, 0, .87);--mat-sidenav-scrim-color:rgba(0, 0, 0, .6)}html[_ngcontent-%COMP%]{--mat-stepper-header-icon-foreground-color:white;--mat-stepper-header-selected-state-icon-background-color:#673ab7;--mat-stepper-header-selected-state-icon-foreground-color:white;--mat-stepper-header-done-state-icon-background-color:#673ab7;--mat-stepper-header-done-state-icon-foreground-color:white;--mat-stepper-header-edit-state-icon-background-color:#673ab7;--mat-stepper-header-edit-state-icon-foreground-color:white;--mat-stepper-container-color:white;--mat-stepper-line-color:rgba(0, 0, 0, .12);--mat-stepper-header-hover-state-layer-color:rgba(0, 0, 0, .04);--mat-stepper-header-focus-state-layer-color:rgba(0, 0, 0, .04);--mat-stepper-header-label-text-color:rgba(0, 0, 0, .54);--mat-stepper-header-optional-label-text-color:rgba(0, 0, 0, .54);--mat-stepper-header-selected-state-label-text-color:rgba(0, 0, 0, .87);--mat-stepper-header-error-state-label-text-color:#f44336;--mat-stepper-header-icon-background-color:rgba(0, 0, 0, .54);--mat-stepper-header-error-state-icon-foreground-color:#f44336;--mat-stepper-header-error-state-icon-background-color:transparent}html[_ngcontent-%COMP%]   .mat-step-header.mat-accent[_ngcontent-%COMP%]{--mat-stepper-header-icon-foreground-color:rgba(0, 0, 0, .87);--mat-stepper-header-selected-state-icon-background-color:#ffd740;--mat-stepper-header-selected-state-icon-foreground-color:rgba(0, 0, 0, .87);--mat-stepper-header-done-state-icon-background-color:#ffd740;--mat-stepper-header-done-state-icon-foreground-color:rgba(0, 0, 0, .87);--mat-stepper-header-edit-state-icon-background-color:#ffd740;--mat-stepper-header-edit-state-icon-foreground-color:rgba(0, 0, 0, .87)}html[_ngcontent-%COMP%]   .mat-step-header.mat-warn[_ngcontent-%COMP%]{--mat-stepper-header-icon-foreground-color:white;--mat-stepper-header-selected-state-icon-background-color:#f44336;--mat-stepper-header-selected-state-icon-foreground-color:white;--mat-stepper-header-done-state-icon-background-color:#f44336;--mat-stepper-header-done-state-icon-foreground-color:white;--mat-stepper-header-edit-state-icon-background-color:#f44336;--mat-stepper-header-edit-state-icon-foreground-color:white}html[_ngcontent-%COMP%]{--mat-stepper-header-height:72px}html[_ngcontent-%COMP%]{--mat-stepper-container-text-font:Roboto, sans-serif;--mat-stepper-header-label-text-font:Roboto, sans-serif;--mat-stepper-header-label-text-size:14px;--mat-stepper-header-label-text-weight:400;--mat-stepper-header-error-state-label-text-size:16px;--mat-stepper-header-selected-state-label-text-size:16px;--mat-stepper-header-selected-state-label-text-weight:400}.mat-sort-header-arrow[_ngcontent-%COMP%]{color:#757575}html[_ngcontent-%COMP%]{--mat-toolbar-container-background-color:whitesmoke;--mat-toolbar-container-text-color:rgba(0, 0, 0, .87)}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{--mat-toolbar-container-background-color:#673ab7;--mat-toolbar-container-text-color:white}.mat-toolbar.mat-accent[_ngcontent-%COMP%]{--mat-toolbar-container-background-color:#ffd740;--mat-toolbar-container-text-color:rgba(0, 0, 0, .87)}.mat-toolbar.mat-warn[_ngcontent-%COMP%]{--mat-toolbar-container-background-color:#f44336;--mat-toolbar-container-text-color:white}html[_ngcontent-%COMP%]{--mat-toolbar-standard-height:64px;--mat-toolbar-mobile-height:56px}html[_ngcontent-%COMP%]{--mat-toolbar-title-text-font:Roboto, sans-serif;--mat-toolbar-title-text-line-height:32px;--mat-toolbar-title-text-size:20px;--mat-toolbar-title-text-tracking:.0125em;--mat-toolbar-title-text-weight:500}.mat-tree[_ngcontent-%COMP%]{background:#fff}.mat-tree-node[_ngcontent-%COMP%], .mat-nested-tree-node[_ngcontent-%COMP%]{color:#000000de}.mat-tree-node[_ngcontent-%COMP%]{min-height:48px}.mat-tree[_ngcontent-%COMP%]{font-family:Roboto,sans-serif}.mat-tree-node[_ngcontent-%COMP%], .mat-nested-tree-node[_ngcontent-%COMP%]{font-weight:400;font-size:14px}.mat-h1[_ngcontent-%COMP%], .mat-headline-5[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-h1[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-headline-5[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:400;line-height:32px;font-family:Roboto,sans-serif;letter-spacing:normal;margin:0 0 16px}.mat-h2[_ngcontent-%COMP%], .mat-headline-6[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-h2[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-headline-6[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px;font-weight:500;line-height:32px;font-family:Roboto,sans-serif;letter-spacing:.0125em;margin:0 0 16px}.mat-h3[_ngcontent-%COMP%], .mat-subtitle-1[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-h3[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-subtitle-1[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:400;line-height:28px;font-family:Roboto,sans-serif;letter-spacing:.009375em;margin:0 0 16px}.mat-h4[_ngcontent-%COMP%], .mat-body-1[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-h4[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-body-1[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;font-weight:400;line-height:24px;font-family:Roboto,sans-serif;letter-spacing:.03125em;margin:0 0 16px}.mat-h5[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-h5[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font:400 11.62px/20px Roboto,sans-serif;margin:0 0 12px}.mat-h6[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-h6[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font:400 9.38px/20px Roboto,sans-serif;margin:0 0 12px}.mat-body-strong[_ngcontent-%COMP%], .mat-subtitle-2[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-body-strong[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-subtitle-2[_ngcontent-%COMP%]{font-size:14px;font-weight:500;line-height:22px;font-family:Roboto,sans-serif;letter-spacing:.0071428571em}.mat-body[_ngcontent-%COMP%], .mat-body-2[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-body[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-body-2[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]{font-size:14px;font-weight:400;line-height:20px;font-family:Roboto,sans-serif;letter-spacing:.0178571429em}.mat-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .mat-body-2[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-body-2[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px}.mat-small[_ngcontent-%COMP%], .mat-caption[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-small[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-caption[_ngcontent-%COMP%]{font-size:12px;font-weight:400;line-height:20px;font-family:Roboto,sans-serif;letter-spacing:.0333333333em}.mat-headline-1[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-headline-1[_ngcontent-%COMP%]{font-size:96px;font-weight:300;line-height:96px;font-family:Roboto,sans-serif;letter-spacing:-.015625em;margin:0 0 56px}.mat-headline-2[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-headline-2[_ngcontent-%COMP%]{font-size:60px;font-weight:300;line-height:60px;font-family:Roboto,sans-serif;letter-spacing:-.0083333333em;margin:0 0 64px}.mat-headline-3[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-headline-3[_ngcontent-%COMP%]{font-size:48px;font-weight:400;line-height:50px;font-family:Roboto,sans-serif;letter-spacing:normal;margin:0 0 64px}.mat-headline-4[_ngcontent-%COMP%], .mat-typography[_ngcontent-%COMP%]   .mat-headline-4[_ngcontent-%COMP%]{font-size:34px;font-weight:400;line-height:40px;font-family:Roboto,sans-serif;letter-spacing:.0073529412em;margin:0 0 64px}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{margin:0;font-family:Roboto,Helvetica Neue,sans-serif}@font-face{font-family:Karla;src:url(Karla.b15eeab18b5ec393.ttf)}div[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{font-family:Karla!important}button[_ngcontent-%COMP%]{padding:10px;font-size:16px;background-color:#007bff;border:none;border-radius:4px;color:#fff;font-weight:700;transition:background-color .3s;cursor:pointer}button[_ngcontent-%COMP%]:not(.date-selector):hover{background-color:#0056b3}.date-selector[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:transparent!important}button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}.custom-popup[_ngcontent-%COMP%]{background-color:#fff;padding:10px}#add-to-wishlist[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3!important}.custom-popup[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:15px;font-weight:700}.custom-popup[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{display:block;text-align:justify;margin-bottom:5px;margin-top:5px}.custom-popup[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px;border-radius:10px;display:block;margin:auto}.custom-popup[_ngcontent-%COMP%]   .popup-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:8px;padding-top:15px}.center-button[_ngcontent-%COMP%]{display:flex;width:50%;padding-top:15px;align-items:center;margin:0 auto}.custom-popup[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:10px;font-size:12px;background-color:#007bff;border:none;border-radius:4px;color:#fff;font-weight:700;transition:background-color .3s;cursor:pointer}.custom-popup[_ngcontent-%COMP%]   .heart[_ngcontent-%COMP%]{cursor:pointer;transition:color .3s ease;color:#dc143c}.custom-popup[_ngcontent-%COMP%]   .heart[_ngcontent-%COMP%]:hover{color:#f03}.mapboxgl-popup-close-button[_ngcontent-%COMP%]{color:#a9a9a9;padding:unset;margin-right:5px}.mapboxgl-popup-close-button[_ngcontent-%COMP%]:hover{background-color:transparent!important}.mapboxgl-popup-content[_ngcontent-%COMP%]{padding:5px!important}div[_ngcontent-%COMP%]{padding-top:50px;display:flex;flex-direction:column;align-items:center}div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;margin:auto}div[_ngcontent-%COMP%]   .tab-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px;padding-top:20px}div[_ngcontent-%COMP%]   .tab-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:5px;cursor:pointer}div[_ngcontent-%COMP%]   .tab-buttons[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#003772}div[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:flex-end;margin-right:5%}div[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]   .logout[_ngcontent-%COMP%]{margin:unset}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:10px;color:#d3d3d3;align-items:center}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .selector[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .enabled[_ngcontent-%COMP%]{color:#000}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{flex-direction:row;justify-content:center}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding:19px;width:100%;text-align:center}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]   #text[_ngcontent-%COMP%]{width:80%;height:250px}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:700px;margin:20px auto auto}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{justify-content:center;width:300px}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:red;width:100%;text-align:center}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .showSuccess[_ngcontent-%COMP%]{color:green;width:100%;text-align:center}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{position:relative;width:50px;height:0px;background-color:#007bff;border-radius:25px;cursor:pointer;padding:unset;padding-bottom:25px;align-self:center;margin-right:10px;margin-left:10px}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:1px;left:1px;width:23px;height:23px;background-color:#fff;border-radius:50%;transition:transform .3s ease}div[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{transform:translate(25px)}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{width:100%;height:810px;overflow-y:auto;position:relative;padding-top:20px;padding-bottom:60px}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .search-btn[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:40px;padding-top:unset}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .filter-btn[_ngcontent-%COMP%]{margin:unset}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{padding:unset;flex-direction:row;gap:10px}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{padding:unset;margin-top:5px}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:gray;padding:5px}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:#555}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:90%}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:300px}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   .edit[_ngcontent-%COMP%], div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{cursor:pointer;color:#007bff}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]{justify-content:center;flex-direction:row;gap:10px;position:fixed;bottom:0;left:0;width:100%;background-color:#fff;padding:10px;box-sizing:border-box;border-top:1px solid #ccc}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:unset}div[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:80px;text-align:center}"]})}return n})(),eF=(()=>{class n{get isUserLocationReady(){return!!this.userLocation}constructor(){this.getUserLocation()}getUserLocation(){var e=this;return(0,Jt.Z)(function*(){return new Promise(i=>{e.userLocation=[-6.047249409973052,40.236932582801046],i(e.userLocation)})})()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const ghe=["mapDiv"];let j9=(()=>{class n{constructor(e,i,r){this.placesService=e,this.mapService=i,this.localizationsService=r,this.title="C2O Maps",this.lat=51.678418,this.lng=7.809007,this.unsubscribe$=new Oe}ngOnInit(){this._getLocalizations()}ngAfterViewInit(){if(!this.placesService.userLocation)throw Error("No hay placesService.userLocation");const e=new Iv.Map({container:this.mapDivElement.nativeElement,style:"mapbox://styles/mapbox/satellite-streets-v12",center:this.placesService.userLocation,zoom:14});this.mapService.setMap(e)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}_getLocalizations(){this.localizationsService.getPlaces().pipe(ld(this.unsubscribe$),Ls(1),s6(10),$t(e=>e.filter(i=>"true"===i.visible)),bn(e=>(this.mapService.createMarkersFromPlaces(e,this.placesService.userLocation),Te(e))),Gm(()=>{})).subscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(H(eF),H(gx),H(gE))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-map-view"]],viewQuery:function(i,r){if(1&i&&Jl(ghe,7),2&i){let o;wa(o=Ea())&&(r.mapDivElement=o.first)}},decls:2,vars:0,consts:[[1,"map-container"],["mapDiv",""]],template:function(i,r){1&i&&Ji(0,"div",0,1)},styles:[".map-container[_ngcontent-%COMP%]{position:fixed;top:0;right:0;width:100vw;height:100vh}"]})}return n})();const _he=[{path:"",component:j9},{path:"root-access",component:Sre},{path:"add-locations",component:mhe,canActivate:[(()=>{class n{constructor(e,i){this.afAuth=e,this.router=i}canActivate(){return this.afAuth.authState.pipe(Ls(1),$t(e=>!!e||(this.router.navigate([""]),!1)))}static#e=this.\u0275fac=function(i){return new(i||n)(it(J1),it(ic))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()]}];let yhe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[CT.forRoot(_he),CT]})}return n})(),vhe=(()=>{class n{constructor(){this.title="maps"}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(i,r){1&i&&Ji(0,"router-outlet")},dependencies:[pP]})}return n})();const Go=void 0,bhe=["es",[["a.\xa0m.","p.\xa0m."],Go,Go],Go,[["D","L","M","X","J","V","S"],["dom","lun","mar","mi\xe9","jue","vie","s\xe1b"],["domingo","lunes","martes","mi\xe9rcoles","jueves","viernes","s\xe1bado"],["DO","LU","MA","MI","JU","VI","SA"]],Go,[["E","F","M","A","M","J","J","A","S","O","N","D"],["ene","feb","mar","abr","may","jun","jul","ago","sept","oct","nov","dic"],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]],Go,[["a. C.","d. C."],Go,["antes de Cristo","despu\xe9s de Cristo"]],1,[6,0],["d/M/yy","d MMM y","d 'de' MMMM 'de' y","EEEE, d 'de' MMMM 'de' y"],["H:mm","H:mm:ss","H:mm:ss z","H:mm:ss (zzzz)"],["{1}, {0}",Go,Go,Go],[",",".",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{AUD:[Go,"$"],BRL:[Go,"R$"],BYN:[Go,"\u0440."],CAD:[Go,"$"],CNY:[Go,"\xa5"],EGP:[],ESP:["\u20a7"],GBP:[Go,"\xa3"],HKD:[Go,"$"],ILS:[Go,"\u20aa"],INR:[Go,"\u20b9"],JPY:[Go,"\xa5"],KRW:[Go,"\u20a9"],MXN:[Go,"$"],NZD:[Go,"$"],PHP:[Go,"\u20b1"],RON:[Go,"L"],THB:["\u0e3f"],TWD:[Go,"NT$"],USD:["US$","$"],XAF:[],XCD:[Go,"$"],XOF:[]},"ltr",function xhe(n){const t=n,e=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length,r=parseInt(n.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 1===t?1:0===r&&0!==e&&e%1e6==0&&0===i||!(r>=0&&r<=5)?4:5}];let Ahe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[xu,a1,xu]})}return n})(),Fhe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=On({type:n})}return n})();const $9=new Xt("MatFormField"),Nhe=["mat-calendar-body",""];function Bhe(n,t){if(1&n&&(ht(0,"tr",3)(1,"td",4),on(2),pt()()),2&n){const e=In();X(1),Cp("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),ro("colspan",e.numCols),X(1),ys(" ",e.label," ")}}function Vhe(n,t){if(1&n&&(ht(0,"td",4),on(1),pt()),2&n){const e=In(2);Cp("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),ro("colspan",e._firstRowOffset),X(1),ys(" ",e._firstRowOffset>=e.labelMinRequiredCells?e.label:""," ")}}function zhe(n,t){if(1&n){const e=Qo();ht(0,"td",8)(1,"button",9),Qn("click",function(r){const l=_i(e).$implicit;return Gn(In(2)._cellClicked(l,r))})("focus",function(r){const l=_i(e).$implicit;return Gn(In(2)._emitActiveDateChange(l,r))}),ht(2,"span",10),on(3),pt(),Ji(4,"span",11),pt()()}if(2&n){const e=t.$implicit,i=t.index,r=In().index,o=In();Cp("width",o._cellWidth)("padding-top",o._cellPadding)("padding-bottom",o._cellPadding),ro("data-mat-row",r)("data-mat-col",i),X(1),zo("mat-calendar-body-disabled",!e.enabled)("mat-calendar-body-active",o._isActiveCell(r,i))("mat-calendar-body-range-start",o._isRangeStart(e.compareValue))("mat-calendar-body-range-end",o._isRangeEnd(e.compareValue))("mat-calendar-body-in-range",o._isInRange(e.compareValue))("mat-calendar-body-comparison-bridge-start",o._isComparisonBridgeStart(e.compareValue,r,i))("mat-calendar-body-comparison-bridge-end",o._isComparisonBridgeEnd(e.compareValue,r,i))("mat-calendar-body-comparison-start",o._isComparisonStart(e.compareValue))("mat-calendar-body-comparison-end",o._isComparisonEnd(e.compareValue))("mat-calendar-body-in-comparison-range",o._isInComparisonRange(e.compareValue))("mat-calendar-body-preview-start",o._isPreviewStart(e.compareValue))("mat-calendar-body-preview-end",o._isPreviewEnd(e.compareValue))("mat-calendar-body-in-preview",o._isInPreview(e.compareValue)),un("ngClass",e.cssClasses)("tabindex",o._isActiveCell(r,i)?0:-1),ro("aria-label",e.ariaLabel)("aria-disabled",!e.enabled||null)("aria-pressed",o._isSelected(e.compareValue))("aria-current",o.todayValue===e.compareValue?"date":null)("aria-describedby",o._getDescribedby(e.compareValue)),X(1),zo("mat-calendar-body-selected",o._isSelected(e.compareValue))("mat-calendar-body-comparison-identical",o._isComparisonIdentical(e.compareValue))("mat-calendar-body-today",o.todayValue===e.compareValue),X(1),ys(" ",e.displayValue," ")}}function Uhe(n,t){if(1&n&&(ht(0,"tr",5),Yn(1,Vhe,2,6,"td",6),Yn(2,zhe,5,48,"td",7),pt()),2&n){const e=t.$implicit,i=t.index,r=In();X(1),un("ngIf",0===i&&r._firstRowOffset),X(1),un("ngForOf",e)}}function jhe(n,t){if(1&n&&(ht(0,"th",5)(1,"span",6),on(2),pt(),ht(3,"span",7),on(4),pt()()),2&n){const e=t.$implicit;X(2),Ro(e.long),X(2),Ro(e.narrow)}}const $he=["*"];function Hhe(n,t){}function Ghe(n,t){if(1&n){const e=Qo();ht(0,"mat-month-view",5),Qn("activeDateChange",function(r){return _i(e),Gn(In().activeDate=r)})("_userSelection",function(r){return _i(e),Gn(In()._dateSelected(r))})("dragStarted",function(r){return _i(e),Gn(In()._dragStarted(r))})("dragEnded",function(r){return _i(e),Gn(In()._dragEnded(r))}),pt()}if(2&n){const e=In();un("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)("comparisonStart",e.comparisonStart)("comparisonEnd",e.comparisonEnd)("startDateAccessibleName",e.startDateAccessibleName)("endDateAccessibleName",e.endDateAccessibleName)("activeDrag",e._activeDrag)}}function Whe(n,t){if(1&n){const e=Qo();ht(0,"mat-year-view",6),Qn("activeDateChange",function(r){return _i(e),Gn(In().activeDate=r)})("monthSelected",function(r){return _i(e),Gn(In()._monthSelectedInYearView(r))})("selectedChange",function(r){return _i(e),Gn(In()._goToDateInView(r,"month"))}),pt()}if(2&n){const e=In();un("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function qhe(n,t){if(1&n){const e=Qo();ht(0,"mat-multi-year-view",7),Qn("activeDateChange",function(r){return _i(e),Gn(In().activeDate=r)})("yearSelected",function(r){return _i(e),Gn(In()._yearSelectedInMultiYearView(r))})("selectedChange",function(r){return _i(e),Gn(In()._goToDateInView(r,"year"))}),pt()}if(2&n){const e=In();un("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function Zhe(n,t){}const Khe=["button"];function Yhe(n,t){1&n&&(Ec(),ht(0,"svg",3),Ji(1,"path",4),pt())}const Xhe=[[["","matDatepickerToggleIcon",""]]],Qhe=["[matDatepickerToggleIcon]"],Jhe=[[["input","matStartDate",""]],[["input","matEndDate",""]]],efe=["input[matStartDate]","input[matEndDate]"];let _E=(()=>{class n{constructor(){this.changes=new Oe,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(e,i){return`${e} \u2013 ${i}`}formatYearRangeLabel(e,i){return`${e} to ${i}`}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();class tF{constructor(t,e,i,r,o={},l=t,f){this.value=t,this.displayValue=e,this.ariaLabel=i,this.enabled=r,this.cssClasses=o,this.compareValue=l,this.rawValue=f}}let tfe=1;const H9=B_({passive:!1,capture:!0}),Ag=B_({passive:!0,capture:!0}),aA=B_({passive:!0});let _x=(()=>{class n{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(e,i){this._elementRef=e,this._ngZone=i,this._platform=xn(rl),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new ui,this.previewChange=new ui,this.activeDateChange=new ui,this.dragStarted=new ui,this.dragEnded=new ui,this._didDragSinceMouseDown=!1,this._enterHandler=r=>{if(this._skipNextFocus&&"focus"===r.type)this._skipNextFocus=!1;else if(r.target&&this.isRange){const o=this._getCellFromElement(r.target);o&&this._ngZone.run(()=>this.previewChange.emit({value:o.enabled?o:null,event:r}))}},this._touchmoveHandler=r=>{if(!this.isRange)return;const o=G9(r),l=o?this._getCellFromElement(o):null;o!==r.target&&(this._didDragSinceMouseDown=!0),iF(r.target)&&r.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:l?.enabled?l:null,event:r}))},this._leaveHandler=r=>{null!==this.previewEnd&&this.isRange&&("blur"!==r.type&&(this._didDragSinceMouseDown=!0),r.target&&this._getCellFromElement(r.target)&&(!r.relatedTarget||!this._getCellFromElement(r.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:r})))},this._mousedownHandler=r=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;const o=r.target&&this._getCellFromElement(r.target);!o||!this._isInRange(o.rawValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:o.rawValue,event:r})})},this._mouseupHandler=r=>{if(!this.isRange)return;const o=iF(r.target);o?o.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{const l=this._getCellFromElement(o);this.dragEnded.emit({value:l?.rawValue??null,event:r})}):this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:r})})},this._touchendHandler=r=>{const o=G9(r);o&&this._mouseupHandler({target:o})},this._id="mat-calendar-body-"+tfe++,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,i.runOutsideAngular(()=>{const r=e.nativeElement;r.addEventListener("touchmove",this._touchmoveHandler,H9),r.addEventListener("mouseenter",this._enterHandler,Ag),r.addEventListener("focus",this._enterHandler,Ag),r.addEventListener("mouseleave",this._leaveHandler,Ag),r.addEventListener("blur",this._leaveHandler,Ag),r.addEventListener("mousedown",this._mousedownHandler,aA),r.addEventListener("touchstart",this._mousedownHandler,aA),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(e,i){this._didDragSinceMouseDown||e.enabled&&this.selectedValueChange.emit({value:e.value,event:i})}_emitActiveDateChange(e,i){e.enabled&&this.activeDateChange.emit({value:e.value,event:i})}_isSelected(e){return this.startValue===e||this.endValue===e}ngOnChanges(e){const i=e.numCols,{rows:r,numCols:o}=this;(e.rows||i)&&(this._firstRowOffset=r&&r.length&&r[0].length?o-r[0].length:0),(e.cellAspectRatio||i||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/o+"%"),(i||!this._cellWidth)&&(this._cellWidth=100/o+"%")}ngOnDestroy(){const e=this._elementRef.nativeElement;e.removeEventListener("touchmove",this._touchmoveHandler,H9),e.removeEventListener("mouseenter",this._enterHandler,Ag),e.removeEventListener("focus",this._enterHandler,Ag),e.removeEventListener("mouseleave",this._leaveHandler,Ag),e.removeEventListener("blur",this._leaveHandler,Ag),e.removeEventListener("mousedown",this._mousedownHandler,aA),e.removeEventListener("touchstart",this._mousedownHandler,aA),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(e,i){let r=e*this.numCols+i;return e&&(r-=this._firstRowOffset),r==this.activeCell}_focusActiveCell(e=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(Ls(1)).subscribe(()=>{setTimeout(()=>{const i=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");i&&(e||(this._skipNextFocus=!0),i.focus())})})})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(e){return rF(e,this.startValue,this.endValue)}_isRangeEnd(e){return oF(e,this.startValue,this.endValue)}_isInRange(e){return sF(e,this.startValue,this.endValue,this.isRange)}_isComparisonStart(e){return rF(e,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(e,i,r){if(!this._isComparisonStart(e)||this._isRangeStart(e)||!this._isInRange(e))return!1;let o=this.rows[i][r-1];if(!o){const l=this.rows[i-1];o=l&&l[l.length-1]}return o&&!this._isRangeEnd(o.compareValue)}_isComparisonBridgeEnd(e,i,r){if(!this._isComparisonEnd(e)||this._isRangeEnd(e)||!this._isInRange(e))return!1;let o=this.rows[i][r+1];if(!o){const l=this.rows[i+1];o=l&&l[0]}return o&&!this._isRangeStart(o.compareValue)}_isComparisonEnd(e){return oF(e,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(e){return sF(e,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(e){return this.comparisonStart===this.comparisonEnd&&e===this.comparisonStart}_isPreviewStart(e){return rF(e,this.previewStart,this.previewEnd)}_isPreviewEnd(e){return oF(e,this.previewStart,this.previewEnd)}_isInPreview(e){return sF(e,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(e){return this.isRange?this.startValue===e&&this.endValue===e?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===e?this._startDateLabelId:this.endValue===e?this._endDateLabelId:null:null}_getCellFromElement(e){const i=iF(e);if(i){const r=i.getAttribute("data-mat-row"),o=i.getAttribute("data-mat-col");if(r&&o)return this.rows[parseInt(r)][parseInt(o)]}return null}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(wi))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[P],attrs:Nhe,decls:6,vars:6,consts:[["aria-hidden","true",4,"ngIf"],["role","row",4,"ngFor","ngForOf"],[1,"mat-calendar-body-hidden-label",3,"id"],["aria-hidden","true"],[1,"mat-calendar-body-label"],["role","row"],["class","mat-calendar-body-label",3,"paddingTop","paddingBottom",4,"ngIf"],["role","gridcell","class","mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom",4,"ngFor","ngForOf"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"ngClass","tabindex","click","focus"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(i,r){1&i&&(Yn(0,Bhe,3,6,"tr",0),Yn(1,Uhe,3,2,"tr",1),ht(2,"label",2),on(3),pt(),ht(4,"label",2),on(5),pt()),2&i&&(un("ngIf",r._firstRowOffset<r.labelMinRequiredCells),X(1),un("ngForOf",r.rows),X(1),un("id",r._startDateLabelId),X(1),ys(" ",r.startDateAccessibleName,"\n"),X(1),un("id",r._endDateLabelId),X(1),ys(" ",r.endDateAccessibleName,"\n"))},dependencies:[s1,Ap,Yd],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-outline-color)}.mat-calendar-body-label{height:0;line-height:0;text-align:left;padding-left:4.7142857143%;padding-right:4.7142857143%;font-size:var(--mat-datepicker-calendar-body-label-text-size);font-weight:var(--mat-datepicker-calendar-body-label-text-weight);color:var(--mat-datepicker-calendar-body-label-text-color)}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview{color:var(--mat-datepicker-calendar-date-preview-state-outline-color)}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.mat-calendar-body-disabled>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){color:var(--mat-datepicker-calendar-date-disabled-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-today:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){border-color:var(--mat-datepicker-calendar-date-today-disabled-state-outline-color)}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px;color:var(--mat-datepicker-calendar-date-text-color);border-color:var(--mat-datepicker-calendar-date-outline-color)}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-keyboard-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical),.cdk-program-focused .mat-calendar-body-active>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-focus-state-background-color)}@media(hover: hover){.mat-calendar-body-cell:not(.mat-calendar-body-disabled):hover>.mat-calendar-body-cell-content:not(.mat-calendar-body-selected):not(.mat-calendar-body-comparison-identical){background-color:var(--mat-datepicker-calendar-date-hover-state-background-color)}}.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-state-background-color);color:var(--mat-datepicker-calendar-date-selected-state-text-color)}.mat-calendar-body-disabled>.mat-calendar-body-selected{background-color:var(--mat-datepicker-calendar-date-selected-disabled-state-background-color)}.mat-calendar-body-selected.mat-calendar-body-today{box-shadow:inset 0 0 0 1px var(--mat-datepicker-calendar-date-today-selected-state-outline-color)}.mat-calendar-body-in-range::before{background:var(--mat-datepicker-calendar-date-in-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range::before{background:var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color)}.mat-calendar-body-comparison-bridge-start::before,[dir=rtl] .mat-calendar-body-comparison-bridge-end::before{background:linear-gradient(to right, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-comparison-bridge-end::before,[dir=rtl] .mat-calendar-body-comparison-bridge-start::before{background:linear-gradient(to left, var(--mat-datepicker-calendar-date-in-range-state-background-color) 50%, var(--mat-datepicker-calendar-date-in-comparison-range-state-background-color) 50%)}.mat-calendar-body-in-range>.mat-calendar-body-comparison-identical,.mat-calendar-body-in-comparison-range.mat-calendar-body-in-range::after{background:var(--mat-datepicker-calendar-date-in-overlap-range-state-background-color)}.mat-calendar-body-comparison-identical.mat-calendar-body-selected,.mat-calendar-body-in-comparison-range>.mat-calendar-body-selected{background:var(--mat-datepicker-calendar-date-in-overlap-range-selected-state-background-color)}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}[dir=rtl] .mat-calendar-body-label{text-align:right}'],encapsulation:2,changeDetection:0})}return n})();function nF(n){return"TD"===n?.nodeName}function iF(n){let t;return nF(n)?t=n:nF(n.parentNode)?t=n.parentNode:nF(n.parentNode?.parentNode)&&(t=n.parentNode.parentNode),null!=t?.getAttribute("data-mat-row")?t:null}function rF(n,t,e){return null!==e&&t!==e&&n<e&&n===t}function oF(n,t,e){return null!==t&&t!==e&&n>=t&&n===e}function sF(n,t,e,i){return i&&null!==t&&null!==e&&t!==e&&n>=t&&n<=e}function G9(n){const t=n.changedTouches[0];return document.elementFromPoint(t.clientX,t.clientY)}class ul{constructor(t,e){this.start=t,this.end=e}}let Sg=(()=>{class n{constructor(e,i){this.selection=e,this._adapter=i,this._selectionChanged=new Oe,this.selectionChanged=this._selectionChanged,this.selection=e}updateSelection(e,i){const r=this.selection;this.selection=e,this._selectionChanged.next({selection:e,source:i,oldValue:r})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(e){return this._adapter.isDateInstance(e)&&this._adapter.isValid(e)}static#e=this.\u0275fac=function(i){Fe()};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})(),nfe=(()=>{class n extends Sg{constructor(e){super(null,e)}add(e){super.updateSelection(e,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const e=new n(this._adapter);return e.updateSelection(this.selection,this),e}static#e=this.\u0275fac=function(i){return new(i||n)(it(Ws))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})(),ife=(()=>{class n extends Sg{constructor(e){super(new ul(null,null),e)}add(e){let{start:i,end:r}=this.selection;null==i?i=e:null==r?r=e:(i=e,r=null),super.updateSelection(new ul(i,r),this)}isValid(){const{start:e,end:i}=this.selection;return null==e&&null==i||(null!=e&&null!=i?this._isValidDateInstance(e)&&this._isValidDateInstance(i)&&this._adapter.compareDate(e,i)<=0:(null==e||this._isValidDateInstance(e))&&(null==i||this._isValidDateInstance(i)))}isComplete(){return null!=this.selection.start&&null!=this.selection.end}clone(){const e=new n(this._adapter);return e.updateSelection(this.selection,this),e}static#e=this.\u0275fac=function(i){return new(i||n)(it(Ws))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const ofe={provide:Sg,deps:[[new jr,new Vd,Sg],Ws],useFactory:function rfe(n,t){return n||new nfe(t)}},afe={provide:Sg,deps:[[new jr,new Vd,Sg],Ws],useFactory:function sfe(n,t){return n||new ife(t)}},lA=new Xt("MAT_DATE_RANGE_SELECTION_STRATEGY");let lfe=(()=>{class n{constructor(e){this._dateAdapter=e}selectionFinished(e,i){let{start:r,end:o}=i;return null==r?r=e:null==o&&e&&this._dateAdapter.compareDate(e,r)>=0?o=e:(r=e,o=null),new ul(r,o)}createPreview(e,i){let r=null,o=null;return i.start&&!i.end&&e&&(r=i.start,o=e),new ul(r,o)}createDrag(e,i,r){let o=i.start,l=i.end;if(!o||!l)return null;const f=this._dateAdapter,g=0!==f.compareDate(o,l),b=f.getYear(r)-f.getYear(e),S=f.getMonth(r)-f.getMonth(e),O=f.getDate(r)-f.getDate(e);return g&&f.sameDate(e,i.start)?(o=r,f.compareDate(r,l)>0&&(l=f.addCalendarYears(l,b),l=f.addCalendarMonths(l,S),l=f.addCalendarDays(l,O))):g&&f.sameDate(e,i.end)?(l=r,f.compareDate(r,o)<0&&(o=f.addCalendarYears(o,b),o=f.addCalendarMonths(o,S),o=f.addCalendarDays(o,O))):(o=f.addCalendarYears(o,b),o=f.addCalendarMonths(o,S),o=f.addCalendarDays(o,O),l=f.addCalendarYears(l,b),l=f.addCalendarMonths(l,S),l=f.addCalendarDays(l,O)),new ul(o,l)}static#e=this.\u0275fac=function(i){return new(i||n)(it(Ws))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();const ufe={provide:lA,deps:[[new jr,new Vd,lA],Ws],useFactory:function cfe(n,t){return n||new lfe(t)}};let W9=(()=>{class n{get activeDate(){return this._activeDate}set activeDate(e){const i=this._activeDate,r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),this._hasSameMonthAndYear(i,this._activeDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof ul?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,i,r,o,l){this._changeDetectorRef=e,this._dateFormats=i,this._dateAdapter=r,this._dir=o,this._rangeStrategy=l,this._rerenderSubscription=Me.EMPTY,this.activeDrag=null,this.selectedChange=new ui,this._userSelection=new ui,this.dragStarted=new ui,this.dragEnded=new ui,this.activeDateChange=new ui,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(mf(null)).subscribe(()=>this._init())}ngOnChanges(e){const i=e.comparisonStart||e.comparisonEnd;i&&!i.firstChange&&this._setRanges(this.selected),e.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(e){const i=e.value,r=this._getDateFromDayOfMonth(i);let o,l;this._selected instanceof ul?(o=this._getDateInCurrentMonth(this._selected.start),l=this._getDateInCurrentMonth(this._selected.end)):o=l=this._getDateInCurrentMonth(this._selected),(o!==i||l!==i)&&this.selectedChange.emit(r),this._userSelection.emit({value:r,event:e.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(e){const i=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&e.preventDefault());case 27:return void(null!=this._previewEnd&&!tg(e)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:e}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:e})),e.preventDefault(),e.stopPropagation()));default:return}this._dateAdapter.compareDate(i,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let e=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(e)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(e){this._matCalendarBody._focusActiveCell(e)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:e,value:i}){if(this._rangeStrategy){const r=i?i.rawValue:null,o=this._rangeStrategy.createPreview(r,this.selected,e);if(this._previewStart=this._getCellCompareValue(o.start),this._previewEnd=this._getCellCompareValue(o.end),this.activeDrag&&r){const l=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,r,e);l&&(this._previewStart=this._getCellCompareValue(l.start),this._previewEnd=this._getCellCompareValue(l.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(e){if(this.activeDrag)if(e.value){const i=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,e.value,e.event);this.dragEnded.emit({value:i??null,event:e.event})}else this.dragEnded.emit({value:null,event:e.event})}_getDateFromDayOfMonth(e){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),e)}_initWeekdays(){const e=this._dateAdapter.getFirstDayOfWeek(),i=this._dateAdapter.getDayOfWeekNames("narrow");let o=this._dateAdapter.getDayOfWeekNames("long").map((l,f)=>({long:l,narrow:i[f]}));this._weekdays=o.slice(e).concat(o.slice(0,e))}_createWeekCells(){const e=this._dateAdapter.getNumDaysInMonth(this.activeDate),i=this._dateAdapter.getDateNames();this._weeks=[[]];for(let r=0,o=this._firstWeekOffset;r<e;r++,o++){7==o&&(this._weeks.push([]),o=0);const l=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),r+1),f=this._shouldEnableDate(l),g=this._dateAdapter.format(l,this._dateFormats.display.dateA11yLabel),b=this.dateClass?this.dateClass(l,"month"):void 0;this._weeks[this._weeks.length-1].push(new tF(r+1,i[r],g,f,b,this._getCellCompareValue(l),l))}}_shouldEnableDate(e){return!!e&&(!this.minDate||this._dateAdapter.compareDate(e,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(e,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(e))}_getDateInCurrentMonth(e){return e&&this._hasSameMonthAndYear(e,this.activeDate)?this._dateAdapter.getDate(e):null}_hasSameMonthAndYear(e,i){return!(!e||!i||this._dateAdapter.getMonth(e)!=this._dateAdapter.getMonth(i)||this._dateAdapter.getYear(e)!=this._dateAdapter.getYear(i))}_getCellCompareValue(e){if(e){const i=this._dateAdapter.getYear(e),r=this._dateAdapter.getMonth(e),o=this._dateAdapter.getDate(e);return new Date(i,r,o).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(e){e instanceof ul?(this._rangeStart=this._getCellCompareValue(e.start),this._rangeEnd=this._getCellCompareValue(e.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(e),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(e){return!this.dateFilter||this.dateFilter(e)}_clearPreview(){this._previewStart=this._previewEnd=null}static#e=this.\u0275fac=function(i){return new(i||n)(H(mu),H(gf,8),H(Ws,8),H(ng,8),H(lA,8))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-month-view"]],viewQuery:function(i,r){if(1&i&&Jl(_x,5),2&i){let o;wa(o=Ea())&&(r._matCalendarBody=o.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[P],decls:7,vars:15,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col",4,"ngFor","ngForOf"],["aria-hidden","true","colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName","selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown"],["scope","col"],[1,"cdk-visually-hidden"],["aria-hidden","true"]],template:function(i,r){1&i&&(ht(0,"table",0)(1,"thead",1)(2,"tr"),Yn(3,jhe,5,2,"th",2),pt(),ht(4,"tr"),Ji(5,"th",3),pt()(),ht(6,"tbody",4),Qn("selectedValueChange",function(l){return r._dateSelected(l)})("activeDateChange",function(l){return r._updateActiveDate(l)})("previewChange",function(l){return r._previewChanged(l)})("dragStarted",function(l){return r.dragStarted.emit(l)})("dragEnded",function(l){return r._dragEnded(l)})("keyup",function(l){return r._handleCalendarBodyKeyup(l)})("keydown",function(l){return r._handleCalendarBodyKeydown(l)}),pt()()),2&i&&(X(3),un("ngForOf",r._weekdays),X(3),un("label",r._monthLabel)("rows",r._weeks)("todayValue",r._todayDate)("startValue",r._rangeStart)("endValue",r._rangeEnd)("comparisonStart",r._comparisonRangeStart)("comparisonEnd",r._comparisonRangeEnd)("previewStart",r._previewStart)("previewEnd",r._previewEnd)("isRange",r._isRange)("labelMinRequiredCells",3)("activeCell",r._dateAdapter.getDate(r.activeDate)-1)("startDateAccessibleName",r.startDateAccessibleName)("endDateAccessibleName",r.endDateAccessibleName))},dependencies:[Ap,_x],encapsulation:2,changeDetection:0})}return n})();const Iu=24;let q9=(()=>{class n{get activeDate(){return this._activeDate}set activeDate(e){let i=this._activeDate;const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),Z9(this._dateAdapter,i,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof ul?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedYear(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,i,r){this._changeDetectorRef=e,this._dateAdapter=i,this._dir=r,this._rerenderSubscription=Me.EMPTY,this.selectedChange=new ui,this.yearSelected=new ui,this.activeDateChange=new ui,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(mf(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const i=this._dateAdapter.getYear(this._activeDate)-yE(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let r=0,o=[];r<Iu;r++)o.push(i+r),4==o.length&&(this._years.push(o.map(l=>this._createCellForYear(l))),o=[]);this._changeDetectorRef.markForCheck()}_yearSelected(e){const i=e.value,r=this._dateAdapter.createDate(i,0,1),o=this._getDateFromYear(i);this.yearSelected.emit(r),this.selectedChange.emit(o)}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromYear(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const i=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-yE(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,Iu-yE(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*-Iu:-Iu);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*Iu:Iu);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(i,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_getActiveCell(){return yE(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(e){const i=this._dateAdapter.getMonth(this.activeDate),r=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(e,i,1));return this._dateAdapter.createDate(e,i,Math.min(this._dateAdapter.getDate(this.activeDate),r))}_createCellForYear(e){const i=this._dateAdapter.createDate(e,0,1),r=this._dateAdapter.getYearName(i),o=this.dateClass?this.dateClass(i,"multi-year"):void 0;return new tF(e,r,r,this._shouldEnableYear(e),o)}_shouldEnableYear(e){if(null==e||this.maxDate&&e>this._dateAdapter.getYear(this.maxDate)||this.minDate&&e<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let r=this._dateAdapter.createDate(e,0,1);this._dateAdapter.getYear(r)==e;r=this._dateAdapter.addCalendarDays(r,1))if(this.dateFilter(r))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(e){if(this._selectedYear=null,e instanceof ul){const i=e.start||e.end;i&&(this._selectedYear=this._dateAdapter.getYear(i))}else e&&(this._selectedYear=this._dateAdapter.getYear(e))}static#e=this.\u0275fac=function(i){return new(i||n)(H(mu),H(Ws,8),H(ng,8))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-multi-year-view"]],viewQuery:function(i,r){if(1&i&&Jl(_x,5),2&i){let o;wa(o=Ea())&&(r._matCalendarBody=o.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(i,r){1&i&&(ht(0,"table",0)(1,"thead",1)(2,"tr"),Ji(3,"th",2),pt()(),ht(4,"tbody",3),Qn("selectedValueChange",function(l){return r._yearSelected(l)})("activeDateChange",function(l){return r._updateActiveDate(l)})("keyup",function(l){return r._handleCalendarBodyKeyup(l)})("keydown",function(l){return r._handleCalendarBodyKeydown(l)}),pt()()),2&i&&(X(4),un("rows",r._years)("todayValue",r._todayYear)("startValue",r._selectedYear)("endValue",r._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",r._getActiveCell()))},dependencies:[_x],encapsulation:2,changeDetection:0})}return n})();function Z9(n,t,e,i,r){const o=n.getYear(t),l=n.getYear(e),f=K9(n,i,r);return Math.floor((o-f)/Iu)===Math.floor((l-f)/Iu)}function yE(n,t,e,i){return function dfe(n,t){return(n%t+t)%t}(n.getYear(t)-K9(n,e,i),Iu)}function K9(n,t,e){let i=0;return e?i=n.getYear(e)-Iu+1:t&&(i=n.getYear(t)),i}let Y9=(()=>{class n{get activeDate(){return this._activeDate}set activeDate(e){let i=this._activeDate;const r=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(r,this.minDate,this.maxDate),this._dateAdapter.getYear(i)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof ul?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedMonth(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,i,r,o){this._changeDetectorRef=e,this._dateFormats=i,this._dateAdapter=r,this._dir=o,this._rerenderSubscription=Me.EMPTY,this.selectedChange=new ui,this.monthSelected=new ui,this.activeDateChange=new ui,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(mf(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(e){const i=e.value,r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),i,1);this.monthSelected.emit(r);const o=this._getDateFromMonth(i);this.selectedChange.emit(o)}_updateActiveDate(e){const r=this._activeDate;this.activeDate=this._getDateFromMonth(e.value),this._dateAdapter.compareDate(r,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const i=this._activeDate,r=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,r?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,r?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(i,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let e=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(i=>i.map(r=>this._createCellForMonth(r,e[r]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(e){return e&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(e):null}_getDateFromMonth(e){const i=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),r=this._dateAdapter.getNumDaysInMonth(i);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,Math.min(this._dateAdapter.getDate(this.activeDate),r))}_createCellForMonth(e,i){const r=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),o=this._dateAdapter.format(r,this._dateFormats.display.monthYearA11yLabel),l=this.dateClass?this.dateClass(r,"year"):void 0;return new tF(e,i.toLocaleUpperCase(),o,this._shouldEnableMonth(e),l)}_shouldEnableMonth(e){const i=this._dateAdapter.getYear(this.activeDate);if(null==e||this._isYearAndMonthAfterMaxDate(i,e)||this._isYearAndMonthBeforeMinDate(i,e))return!1;if(!this.dateFilter)return!0;for(let o=this._dateAdapter.createDate(i,e,1);this._dateAdapter.getMonth(o)==e;o=this._dateAdapter.addCalendarDays(o,1))if(this.dateFilter(o))return!0;return!1}_isYearAndMonthAfterMaxDate(e,i){if(this.maxDate){const r=this._dateAdapter.getYear(this.maxDate),o=this._dateAdapter.getMonth(this.maxDate);return e>r||e===r&&i>o}return!1}_isYearAndMonthBeforeMinDate(e,i){if(this.minDate){const r=this._dateAdapter.getYear(this.minDate),o=this._dateAdapter.getMonth(this.minDate);return e<r||e===r&&i<o}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(e){this._selectedMonth=e instanceof ul?this._getMonthInCurrentYear(e.start)||this._getMonthInCurrentYear(e.end):this._getMonthInCurrentYear(e)}static#e=this.\u0275fac=function(i){return new(i||n)(H(mu),H(gf,8),H(Ws,8),H(ng,8))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-year-view"]],viewQuery:function(i,r){if(1&i&&Jl(_x,5),2&i){let o;wa(o=Ea())&&(r._matCalendarBody=o.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(i,r){1&i&&(ht(0,"table",0)(1,"thead",1)(2,"tr"),Ji(3,"th",2),pt()(),ht(4,"tbody",3),Qn("selectedValueChange",function(l){return r._monthSelected(l)})("activeDateChange",function(l){return r._updateActiveDate(l)})("keyup",function(l){return r._handleCalendarBodyKeyup(l)})("keydown",function(l){return r._handleCalendarBodyKeydown(l)}),pt()()),2&i&&(X(4),un("label",r._yearLabel)("rows",r._months)("todayValue",r._todayMonth)("startValue",r._selectedMonth)("endValue",r._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",r._dateAdapter.getMonth(r.activeDate)))},dependencies:[_x],encapsulation:2,changeDetection:0})}return n})(),hfe=1,ffe=(()=>{class n{constructor(e,i,r,o,l){this._intl=e,this.calendar=i,this._dateAdapter=r,this._dateFormats=o,this._id="mat-calendar-header-"+hfe++,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>l.markForCheck())}get periodButtonText(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-Iu)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:Iu)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(e,i){return"month"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(i)&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(i):"year"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(i):Z9(this._dateAdapter,e,i,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){const i=this._dateAdapter.getYear(this.calendar.activeDate)-yE(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),r=i+Iu-1;return[this._dateAdapter.getYearName(this._dateAdapter.createDate(i,0,1)),this._dateAdapter.getYearName(this._dateAdapter.createDate(r,0,1))]}static#e=this.\u0275fac=function(i){return new(i||n)(H(_E),H(Tt(()=>cF)),H(Ws,8),H(gf,8),H(mu))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:$he,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["mat-button","","type","button","aria-live","polite",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"disabled","click"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"disabled","click"],[1,"mat-calendar-hidden-label",3,"id"]],template:function(i,r){1&i&&(uf(),ht(0,"div",0)(1,"div",1)(2,"button",2),Qn("click",function(){return r.currentPeriodClicked()}),ht(3,"span",3),on(4),pt(),Ec(),ht(5,"svg",4),Ji(6,"polygon",5),pt()(),function Wu(){!function vx(){Mt.lFrame.currentNamespace=null}()}(),Ji(7,"div",6),il(8),ht(9,"button",7),Qn("click",function(){return r.previousClicked()}),pt(),ht(10,"button",8),Qn("click",function(){return r.nextClicked()}),pt()()(),ht(11,"label",9),on(12),pt()),2&i&&(X(2),ro("aria-label",r.periodButtonLabel)("aria-describedby",r._periodButtonLabelId),X(2),Ro(r.periodButtonText),X(1),zo("mat-calendar-invert","month"!==r.calendar.currentView),X(4),un("disabled",!r.previousEnabled()),ro("aria-label",r.prevButtonLabel),X(1),un("disabled",!r.nextEnabled()),ro("aria-label",r.nextButtonLabel),X(1),un("id",r._periodButtonLabelId),X(1),Ro(r.periodButtonDescription))},dependencies:[MP,h6],encapsulation:2,changeDetection:0})}return n})(),cF=(()=>{class n{get startAt(){return this._startAt}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get selected(){return this._selected}set selected(e){this._selected=e instanceof ul?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get activeDate(){return this._clampedActiveDate}set activeDate(e){this._clampedActiveDate=this._dateAdapter.clampDate(e,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(e){const i=this._currentView!==e?e:null;this._currentView=e,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),i&&this.viewChanged.emit(i)}constructor(e,i,r,o){this._dateAdapter=i,this._dateFormats=r,this._changeDetectorRef=o,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new ui,this.yearSelected=new ui,this.monthSelected=new ui,this.viewChanged=new ui(!0),this._userSelection=new ui,this._userDragDrop=new ui,this._activeDrag=null,this.stateChanges=new Oe,this._intlChanges=e.changes.subscribe(()=>{o.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new G_(this.headerComponent||ffe),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(e){const i=e.minDate&&!this._dateAdapter.sameDate(e.minDate.previousValue,e.minDate.currentValue)?e.minDate:void 0,r=e.maxDate&&!this._dateAdapter.sameDate(e.maxDate.previousValue,e.maxDate.currentValue)?e.maxDate:void 0,o=i||r||e.dateFilter;if(o&&!o.firstChange){const l=this._getCurrentViewComponent();l&&(this._changeDetectorRef.detectChanges(),l._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(e){const i=e.value;(this.selected instanceof ul||i&&!this._dateAdapter.sameDate(i,this.selected))&&this.selectedChange.emit(i),this._userSelection.emit(e)}_yearSelectedInMultiYearView(e){this.yearSelected.emit(e)}_monthSelectedInYearView(e){this.monthSelected.emit(e)}_goToDateInView(e,i){this.activeDate=e,this.currentView=i}_dragStarted(e){this._activeDrag=e}_dragEnded(e){this._activeDrag&&(e.value&&this._userDragDrop.emit(e),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}static#e=this.\u0275fac=function(i){return new(i||n)(H(_E),H(Ws,8),H(gf,8),H(mu))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-calendar"]],viewQuery:function(i,r){if(1&i&&(Jl(W9,5),Jl(Y9,5),Jl(q9,5)),2&i){let o;wa(o=Ea())&&(r.monthView=o.first),wa(o=Ea())&&(r.yearView=o.first),wa(o=Ea())&&(r.multiYearView=o.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[oo([ofe]),P],decls:5,vars:5,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content",3,"ngSwitch"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange"]],template:function(i,r){1&i&&(Yn(0,Hhe,0,0,"ng-template",0),ht(1,"div",1),Yn(2,Ghe,1,11,"mat-month-view",2),Yn(3,Whe,1,6,"mat-year-view",3),Yn(4,qhe,1,6,"mat-multi-year-view",4),pt()),2&i&&(un("cdkPortalOutlet",r._calendarHeaderPortal),X(1),un("ngSwitch",r.currentView),X(1),un("ngSwitchCase","month"),X(1),un("ngSwitchCase","year"),X(1),un("ngSwitchCase","multi-year"))},dependencies:[rI,p4,pz,W_,W9,Y9,q9],styles:['.mat-calendar{display:block;font-family:var(--mat-datepicker-calendar-text-font);font-size:var(--mat-datepicker-calendar-text-size)}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px;font-size:var(--mat-datepicker-calendar-period-button-text-size);font-weight:var(--mat-datepicker-calendar-period-button-text-weight)}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle;fill:var(--mat-datepicker-calendar-period-button-icon-color)}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-datepicker-content .mat-calendar-previous-button,.mat-datepicker-content .mat-calendar-next-button{color:var(--mat-datepicker-calendar-navigation-button-icon-color)}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0;color:var(--mat-datepicker-calendar-header-text-color);font-size:var(--mat-datepicker-calendar-header-text-size);font-weight:var(--mat-datepicker-calendar-header-text-weight)}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px;background:var(--mat-datepicker-calendar-header-divider-color)}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}.mat-calendar-hidden-label{display:none}'],encapsulation:2,changeDetection:0})}return n})();const X9={transformPanel:p1("transformPanel",[Pp("void => enter-dropdown",Mp("120ms cubic-bezier(0, 0, 0.2, 1)",aB([Na({opacity:0,transform:"scale(1, 0.8)"}),Na({opacity:1,transform:"scale(1, 1)"})]))),Pp("void => enter-dialog",Mp("150ms cubic-bezier(0, 0, 0.2, 1)",aB([Na({opacity:0,transform:"scale(0.7)"}),Na({transform:"none",opacity:1})]))),Pp("* => void",Mp("100ms linear",Na({opacity:0})))]),fadeInCalendar:p1("fadeInCalendar",[P_("void",Na({opacity:0})),P_("enter",Na({opacity:1})),Pp("void => *",Mp("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};let pfe=0;const Q9=new Xt("mat-datepicker-scroll-strategy"),gfe={provide:Q9,deps:[bf],useFactory:function mfe(n){return()=>n.scrollStrategies.reposition()}},_fe=K2(class{constructor(n){this._elementRef=n}});let yfe=(()=>{class n extends _fe{constructor(e,i,r,o,l,f){super(e),this._changeDetectorRef=i,this._globalModel=r,this._dateAdapter=o,this._rangeSelectionStrategy=l,this._subscriptions=new Me,this._animationDone=new Oe,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=f.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(e){const i=this._model.selection,r=e.value,o=i instanceof ul;if(o&&this._rangeSelectionStrategy){const l=this._rangeSelectionStrategy.selectionFinished(r,i,e.event);this._model.updateSelection(l,this)}else r&&(o||!this._dateAdapter.sameDate(r,i))&&this._model.add(r);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(e){this._model.updateSelection(e.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(e){this._isAnimating="start"===e.phaseName,this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(e,i){this._model=e?this._globalModel.clone():this._globalModel,this._actionsPortal=e,i&&this._changeDetectorRef.detectChanges()}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(mu),H(Sg),H(Ws),H(lA,8),H(_E))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-datepicker-content"]],viewQuery:function(i,r){if(1&i&&Jl(cF,5),2&i){let o;wa(o=Ea())&&(r._calendar=o.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:3,hostBindings:function(i,r){1&i&&SC("@transformPanel.start",function(l){return r._handleAnimationEvent(l)})("@transformPanel.done",function(l){return r._handleAnimationEvent(l)}),2&i&&(kC("@transformPanel",r._animationState),zo("mat-datepicker-content-touch",r.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],features:[Qi],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"color","focus","blur","click"]],template:function(i,r){if(1&i&&(ht(0,"div",0)(1,"mat-calendar",1),Qn("yearSelected",function(l){return r.datepicker._selectYear(l)})("monthSelected",function(l){return r.datepicker._selectMonth(l)})("viewChanged",function(l){return r.datepicker._viewChanged(l)})("_userSelection",function(l){return r._handleUserSelection(l)})("_userDragDrop",function(l){return r._handleUserDragDrop(l)}),pt(),Yn(2,Zhe,0,0,"ng-template",2),ht(3,"button",3),Qn("focus",function(){return r._closeButtonFocused=!0})("blur",function(){return r._closeButtonFocused=!1})("click",function(){return r.datepicker.close()}),on(4),pt()()),2&i){let o;zo("mat-datepicker-content-container-with-custom-header",r.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",r._actionsPortal),ro("aria-modal",!0)("aria-labelledby",null!==(o=r._dialogLabelId)&&void 0!==o?o:void 0),X(1),un("id",r.datepicker.id)("ngClass",r.datepicker.panelClass)("startAt",r.datepicker.startAt)("startView",r.datepicker.startView)("minDate",r.datepicker._getMinDate())("maxDate",r.datepicker._getMaxDate())("dateFilter",r.datepicker._getDateFilter())("headerComponent",r.datepicker.calendarHeaderComponent)("selected",r._getSelected())("dateClass",r.datepicker.dateClass)("comparisonStart",r.comparisonStart)("comparisonEnd",r.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",r.startDateAccessibleName)("endDateAccessibleName",r.endDateAccessibleName),X(1),un("cdkPortalOutlet",r._actionsPortal),X(1),zo("cdk-visually-hidden",!r._closeButtonFocused),un("color",r.color||"primary"),X(1),Ro(r._closeButtonText)}},dependencies:[s1,MP,Qee,W_,cF],styles:[".mat-datepicker-content{box-shadow:0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12);display:block;border-radius:4px;background-color:var(--mat-datepicker-calendar-container-background-color);color:var(--mat-datepicker-calendar-container-text-color)}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{box-shadow:0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);display:block;max-height:80vh;position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[X9.transformPanel,X9.fadeInCalendar]},changeDetection:0})}return n})(),J9=(()=>{class n{get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(e){this._color=e}get touchUi(){return this._touchUi}set touchUi(e){this._touchUi=nc(e)}get disabled(){return void 0===this._disabled&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(e){const i=nc(e);i!==this._disabled&&(this._disabled=i,this.stateChanges.next(void 0))}get restoreFocus(){return this._restoreFocus}set restoreFocus(e){this._restoreFocus=nc(e)}get panelClass(){return this._panelClass}set panelClass(e){this._panelClass=function Dee(n,t=/\s+/){const e=[];if(null!=n){const i=Array.isArray(n)?n:`${n}`.split(t);for(const r of i){const o=`${r}`.trim();o&&e.push(o)}}return e}(e)}get opened(){return this._opened}set opened(e){nc(e)?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}constructor(e,i,r,o,l,f,g){this._overlay=e,this._ngZone=i,this._viewContainerRef=r,this._dateAdapter=l,this._dir=f,this._model=g,this._inputStateChanges=Me.EMPTY,this._document=xn(rr),this.startView="month",this._touchUi=!1,this.xPosition="start",this.yPosition="below",this._restoreFocus=!0,this.yearSelected=new ui,this.monthSelected=new ui,this.viewChanged=new ui(!0),this.openedStream=new ui,this.closedStream=new ui,this._opened=!1,this.id="mat-datepicker-"+pfe++,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new Oe,this._scrollStrategy=o}ngOnChanges(e){const i=e.xPosition||e.yPosition;if(i&&!i.firstChange&&this._overlayRef){const r=this._overlayRef.getConfig().positionStrategy;r instanceof C6&&(this._setConnectedPositions(r),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(e){this._model.add(e)}_selectYear(e){this.yearSelected.emit(e)}_selectMonth(e){this.monthSelected.emit(e)}_viewChanged(e){this.viewChanged.emit(e)}registerInput(e){return this._inputStateChanges.unsubscribe(),this.datepickerInput=e,this._inputStateChanges=e.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(e){this._actionsPortal=e,this._componentRef?.instance._assignActions(e,!0)}removeActions(e){e===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this._focusedElementBeforeOpen=S1(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;const e=this._restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus,i=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){const{instance:r,location:o}=this._componentRef;r._startExitAnimation(),r._animationDone.pipe(Ls(1)).subscribe(()=>{const l=this._document.activeElement;e&&(!l||l===this._document.activeElement||o.nativeElement.contains(l))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()})}e?setTimeout(i):i()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(e){e.datepicker=this,e.color=this.color,e._dialogLabelId=this.datepickerInput.getOverlayLabelId(),e._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();const e=this.touchUi,i=new G_(yfe,this._viewContainerRef),r=this._overlayRef=this._overlay.create(new kT({positionStrategy:e?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[e?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:e?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:"mat-datepicker-"+(e?"dialog":"popup")}));this._getCloseStream(r).subscribe(o=>{o&&o.preventDefault(),this.close()}),r.keydownEvents().subscribe(o=>{const l=o.keyCode;(38===l||40===l||37===l||39===l||33===l||34===l)&&o.preventDefault()}),this._componentRef=r.attach(i),this._forwardContentValues(this._componentRef.instance),e||this._ngZone.onStable.pipe(Ls(1)).subscribe(()=>r.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){const e=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(e)}_setConnectedPositions(e){const i="end"===this.xPosition?"end":"start",r="start"===i?"end":"start",o="above"===this.yPosition?"bottom":"top",l="top"===o?"bottom":"top";return e.withPositions([{originX:i,originY:l,overlayX:i,overlayY:o},{originX:i,originY:o,overlayX:i,overlayY:l},{originX:r,originY:l,overlayX:r,overlayY:o},{originX:r,originY:o,overlayX:r,overlayY:l}])}_getCloseStream(e){const i=["ctrlKey","shiftKey","metaKey"];return ue(e.backdropClick(),e.detachments(),e.keydownEvents().pipe(aa(r=>27===r.keyCode&&!tg(r)||this.datepickerInput&&tg(r,"altKey")&&38===r.keyCode&&i.every(o=>!tg(r,o)))))}static#e=this.\u0275fac=function(i){return new(i||n)(H(bf),H(wi),H(pu),H(Q9),H(Ws,8),H(ng,8),H(Sg))};static#t=this.\u0275dir=On({type:n,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:"touchUi",disabled:"disabled",xPosition:"xPosition",yPosition:"yPosition",restoreFocus:"restoreFocus",dateClass:"dateClass",panelClass:"panelClass",opened:"opened"},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[P]})}return n})();class cA{constructor(t,e){this.target=t,this.targetElement=e,this.value=this.target.value}}let e$=(()=>{class n{get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(e){this._assignValueProgrammatically(e)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(e){const i=nc(e),r=this._elementRef.nativeElement;this._disabled!==i&&(this._disabled=i,this.stateChanges.next(void 0)),i&&this._isInitialized&&r.blur&&r.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(e){this._model=e,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(i=>{if(this._shouldHandleChangeEvent(i)){const r=this._getValueFromModel(i.selection);this._lastValueValid=this._isValidValue(r),this._cvaOnChange(r),this._onTouched(),this._formatValue(r),this.dateInput.emit(new cA(this,this._elementRef.nativeElement)),this.dateChange.emit(new cA(this,this._elementRef.nativeElement))}})}constructor(e,i,r){this._elementRef=e,this._dateAdapter=i,this._dateFormats=r,this.dateChange=new ui,this.dateInput=new ui,this.stateChanges=new Oe,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=Me.EMPTY,this._localeSubscription=Me.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=o=>{const l=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(o.value));return!l||this._matchesFilter(l)?null:{matDatepickerFilter:!0}},this._minValidator=o=>{const l=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(o.value)),f=this._getMinDate();return!f||!l||this._dateAdapter.compareDate(f,l)<=0?null:{matDatepickerMin:{min:f,actual:l}}},this._maxValidator=o=>{const l=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(o.value)),f=this._getMaxDate();return!f||!l||this._dateAdapter.compareDate(f,l)>=0?null:{matDatepickerMax:{max:f,actual:l}}},this._lastValueValid=!1,this._localeSubscription=i.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(e){t$(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(e){this._validatorOnChange=e}validate(e){return this._validator?this._validator(e):null}writeValue(e){this._assignValueProgrammatically(e)}registerOnChange(e){this._cvaOnChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_onKeydown(e){tg(e,"altKey")&&40===e.keyCode&&["ctrlKey","shiftKey","metaKey"].every(o=>!tg(e,o))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),e.preventDefault())}_onInput(e){const i=this._lastValueValid;let r=this._dateAdapter.parse(e,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(r),r=this._dateAdapter.getValidDateOrNull(r);const o=!this._dateAdapter.sameDate(r,this.value);!r||o?this._cvaOnChange(r):(e&&!this.value&&this._cvaOnChange(r),i!==this._lastValueValid&&this._validatorOnChange()),o&&(this._assignValue(r),this.dateInput.emit(new cA(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new cA(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(e){this._elementRef.nativeElement.value=null!=e?this._dateAdapter.format(e,this._dateFormats.display.dateInput):""}_assignValue(e){this._model?(this._assignValueToModel(e),this._pendingValue=null):this._pendingValue=e}_isValidValue(e){return!e||this._dateAdapter.isValid(e)}_parentDisabled(){return!1}_assignValueProgrammatically(e){e=this._dateAdapter.deserialize(e),this._lastValueValid=this._isValidValue(e),e=this._dateAdapter.getValidDateOrNull(e),this._assignValue(e),this._formatValue(e)}_matchesFilter(e){const i=this._getDateFilter();return!i||i(e)}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(Ws,8),H(gf,8))};static#t=this.\u0275dir=On({type:n,inputs:{value:"value",disabled:"disabled"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[P]})}return n})();function t$(n,t){const e=Object.keys(n);for(let i of e){const{previousValue:r,currentValue:o}=n[i];if(!t.isDateInstance(r)||!t.isDateInstance(o))return!0;if(!t.sameDate(r,o))return!0}return!1}let bfe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275dir=On({type:n,selectors:[["","matDatepickerToggleIcon",""]]})}return n})(),wfe=(()=>{class n{get disabled(){return void 0===this._disabled&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(e){this._disabled=nc(e)}constructor(e,i,r){this._intl=e,this._changeDetectorRef=i,this._stateChanges=Me.EMPTY;const o=Number(r);this.tabIndex=o||0===o?o:null}ngOnChanges(e){e.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.datepicker&&!this.disabled&&(this.datepicker.open(),e.stopPropagation())}_watchStateChanges(){const e=this.datepicker?this.datepicker.stateChanges:Te(),i=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:Te(),r=this.datepicker?ue(this.datepicker.openedStream,this.datepicker.closedStream):Te();this._stateChanges.unsubscribe(),this._stateChanges=ue(this._intl.changes,e,i,r).subscribe(()=>this._changeDetectorRef.markForCheck())}static#e=this.\u0275fac=function(i){return new(i||n)(H(_E),H(mu),Fh("tabindex"))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-datepicker-toggle"]],contentQueries:function(i,r,o){if(1&i&&Qb(o,bfe,5),2&i){let l;wa(l=Ea())&&(r._customIcon=l.first)}},viewQuery:function(i,r){if(1&i&&Jl(Khe,5),2&i){let o;wa(o=Ea())&&(r._button=o.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(i,r){1&i&&Qn("click",function(l){return r._open(l)}),2&i&&(ro("tabindex",null)("data-mat-calendar",r.datepicker?r.datepicker.id:null),zo("mat-datepicker-toggle-active",r.datepicker&&r.datepicker.opened)("mat-accent",r.datepicker&&"accent"===r.datepicker.color)("mat-warn",r.datepicker&&"warn"===r.datepicker.color))},inputs:{datepicker:["for","datepicker"],tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],disabled:"disabled",disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[P],ngContentSelectors:Qhe,decls:4,vars:6,consts:[["mat-icon-button","","type","button",3,"disabled","disableRipple"],["button",""],["class","mat-datepicker-toggle-default-icon","viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",4,"ngIf"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false","aria-hidden","true",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(i,r){1&i&&(uf(Xhe),ht(0,"button",0,1),Yn(2,Yhe,2,0,"svg",2),il(3),pt()),2&i&&(un("disabled",r.disabled)("disableRipple",r.disableRipple),ro("aria-haspopup",r.datepicker?"dialog":null)("aria-label",r.ariaLabel||r._intl.openCalendarLabel)("tabindex",r.disabled?-1:r.tabIndex),X(2),un("ngIf",!r._customIcon))},dependencies:[Yd,h6],styles:[".mat-datepicker-toggle{pointer-events:auto;color:var(--mat-datepicker-toggle-icon-color)}.mat-datepicker-toggle-active{color:var(--mat-datepicker-toggle-active-state-icon-color)}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0})}return n})();function Efe(n){return uF(n,!0)}function i$(n){return n.nodeType===Node.ELEMENT_NODE}function uF(n,t){if(i$(n)&&t){const i=(n.getAttribute?.("aria-labelledby")?.split(/\s+/g)||[]).reduce((r,o)=>{const l=document.getElementById(o);return l&&r.push(l),r},[]);if(i.length)return i.map(r=>uF(r,!1)).join(" ")}if(i$(n)){const e=n.getAttribute("aria-label")?.trim();if(e)return e}if(function Cfe(n){return"INPUT"===n.nodeName}(n)||function Ife(n){return"TEXTAREA"===n.nodeName}(n)){if(n.labels?.length)return Array.from(n.labels).map(r=>uF(r,!1)).join(" ");const e=n.getAttribute("placeholder")?.trim();if(e)return e;const i=n.getAttribute("title")?.trim();if(i)return i}return(n.textContent||"").replace(/\s+/g," ").trim()}const uA=new Xt("MAT_DATE_RANGE_INPUT_PARENT"),r$=mte((()=>{class n extends e${constructor(e,i,r,o,l,f,g,b){super(i,g,b),this._rangeInput=e,this._elementRef=i,this._defaultErrorStateMatcher=r,this._injector=o,this._parentForm=l,this._parentFormGroup=f,this._dir=xn(ng,{optional:!0})}ngOnInit(){const e=this._injector.get(Rp,null,{optional:!0,self:!0});e&&(this.ngControl=e)}ngDoCheck(){this.ngControl&&this.updateErrorState()}isEmpty(){return 0===this._elementRef.nativeElement.value.length}_getPlaceholder(){return this._elementRef.nativeElement.placeholder}focus(){this._elementRef.nativeElement.focus()}getMirrorValue(){const e=this._elementRef.nativeElement,i=e.value;return i.length>0?i:e.placeholder}_onInput(e){super._onInput(e),this._rangeInput._handleChildValueChange()}_openPopup(){this._rangeInput._openDatepicker()}_getMinDate(){return this._rangeInput.min}_getMaxDate(){return this._rangeInput.max}_getDateFilter(){return this._rangeInput.dateFilter}_parentDisabled(){return this._rangeInput._groupDisabled}_shouldHandleChangeEvent({source:e}){return e!==this._rangeInput._startInput&&e!==this._rangeInput._endInput}_assignValueProgrammatically(e){super._assignValueProgrammatically(e),(this===this._rangeInput._startInput?this._rangeInput._endInput:this._rangeInput._startInput)?._validatorOnChange()}_getAccessibleName(){return Efe(this._elementRef.nativeElement)}static#e=this.\u0275fac=function(i){return new(i||n)(H(uA),H(fr),H(X2),H(Hr),H(iv,8),H(Jm,8),H(Ws,8),H(gf,8))};static#t=this.\u0275dir=On({type:n,features:[Qi]})}return n})());let o$=(()=>{class n extends r${constructor(e,i,r,o,l,f,g,b){super(e,i,r,o,l,f,g,b),this._startValidator=S=>{const O=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(S.value)),$=this._model?this._model.selection.end:null;return!O||!$||this._dateAdapter.compareDate(O,$)<=0?null:{matStartDateInvalid:{end:$,actual:O}}},this._validator=Qm.compose([...super._getValidators(),this._startValidator])}_getValueFromModel(e){return e.start}_shouldHandleChangeEvent(e){return!(!super._shouldHandleChangeEvent(e)||(e.oldValue?.start?e.selection.start&&!this._dateAdapter.compareDate(e.oldValue.start,e.selection.start):!e.selection.start))}_assignValueToModel(e){if(this._model){const i=new ul(e,this._model.selection.end);this._model.updateSelection(i,this)}}_formatValue(e){super._formatValue(e),this._rangeInput._handleChildValueChange()}_onKeydown(e){const i=this._rangeInput._endInput,r=this._elementRef.nativeElement,o="rtl"!==this._dir?.value;(39===e.keyCode&&o||37===e.keyCode&&!o)&&r.selectionStart===r.value.length&&r.selectionEnd===r.value.length?(e.preventDefault(),i._elementRef.nativeElement.setSelectionRange(0,0),i.focus()):super._onKeydown(e)}static#e=this.\u0275fac=function(i){return new(i||n)(H(uA),H(fr),H(X2),H(Hr),H(iv,8),H(Jm,8),H(Ws,8),H(gf,8))};static#t=this.\u0275dir=On({type:n,selectors:[["input","matStartDate",""]],hostAttrs:["type","text",1,"mat-start-date","mat-date-range-input-inner"],hostVars:5,hostBindings:function(i,r){1&i&&Qn("input",function(l){return r._onInput(l.target.value)})("change",function(){return r._onChange()})("keydown",function(l){return r._onKeydown(l)})("blur",function(){return r._onBlur()}),2&i&&(Hy("disabled",r.disabled),ro("aria-haspopup",r._rangeInput.rangePicker?"dialog":null)("aria-owns",(null==r._rangeInput.rangePicker?null:r._rangeInput.rangePicker.opened)&&r._rangeInput.rangePicker.id||null)("min",r._getMinDate()?r._dateAdapter.toIso8601(r._getMinDate()):null)("max",r._getMaxDate()?r._dateAdapter.toIso8601(r._getMaxDate()):null))},inputs:{errorStateMatcher:"errorStateMatcher"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[oo([{provide:vu,useExisting:n,multi:!0},{provide:Ca,useExisting:n,multi:!0}]),Qi]})}return n})(),s$=(()=>{class n extends r${constructor(e,i,r,o,l,f,g,b){super(e,i,r,o,l,f,g,b),this._endValidator=S=>{const O=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(S.value)),$=this._model?this._model.selection.start:null;return!O||!$||this._dateAdapter.compareDate(O,$)>=0?null:{matEndDateInvalid:{start:$,actual:O}}},this._validator=Qm.compose([...super._getValidators(),this._endValidator])}_getValueFromModel(e){return e.end}_shouldHandleChangeEvent(e){return!(!super._shouldHandleChangeEvent(e)||(e.oldValue?.end?e.selection.end&&!this._dateAdapter.compareDate(e.oldValue.end,e.selection.end):!e.selection.end))}_assignValueToModel(e){if(this._model){const i=new ul(this._model.selection.start,e);this._model.updateSelection(i,this)}}_onKeydown(e){const i=this._rangeInput._startInput,r=this._elementRef.nativeElement,o="rtl"!==this._dir?.value;if(8!==e.keyCode||r.value)if((37===e.keyCode&&o||39===e.keyCode&&!o)&&0===r.selectionStart&&0===r.selectionEnd){e.preventDefault();const l=i._elementRef.nativeElement.value.length;i._elementRef.nativeElement.setSelectionRange(l,l),i.focus()}else super._onKeydown(e);else i.focus()}static#e=this.\u0275fac=function(i){return new(i||n)(H(uA),H(fr),H(X2),H(Hr),H(iv,8),H(Jm,8),H(Ws,8),H(gf,8))};static#t=this.\u0275dir=On({type:n,selectors:[["input","matEndDate",""]],hostAttrs:["type","text",1,"mat-end-date","mat-date-range-input-inner"],hostVars:5,hostBindings:function(i,r){1&i&&Qn("input",function(l){return r._onInput(l.target.value)})("change",function(){return r._onChange()})("keydown",function(l){return r._onKeydown(l)})("blur",function(){return r._onBlur()}),2&i&&(Hy("disabled",r.disabled),ro("aria-haspopup",r._rangeInput.rangePicker?"dialog":null)("aria-owns",(null==r._rangeInput.rangePicker?null:r._rangeInput.rangePicker.opened)&&r._rangeInput.rangePicker.id||null)("min",r._getMinDate()?r._dateAdapter.toIso8601(r._getMinDate()):null)("max",r._getMaxDate()?r._dateAdapter.toIso8601(r._getMaxDate()):null))},inputs:{errorStateMatcher:"errorStateMatcher"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[oo([{provide:vu,useExisting:n,multi:!0},{provide:Ca,useExisting:n,multi:!0}]),Qi]})}return n})(),Tfe=0,Dfe=(()=>{class n{get value(){return this._model?this._model.selection:null}get shouldLabelFloat(){return this.focused||!this.empty}get placeholder(){const e=this._startInput?._getPlaceholder()||"",i=this._endInput?._getPlaceholder()||"";return e||i?`${e} ${this.separator} ${i}`:""}get rangePicker(){return this._rangePicker}set rangePicker(e){e&&(this._model=e.registerInput(this),this._rangePicker=e,this._closedSubscription.unsubscribe(),this._closedSubscription=e.closedStream.subscribe(()=>{this._startInput?._onTouched(),this._endInput?._onTouched()}),this._registerModel(this._model))}get required(){return this._required??(this._isTargetRequired(this)||this._isTargetRequired(this._startInput)||this._isTargetRequired(this._endInput))??!1}set required(e){this._required=nc(e)}get dateFilter(){return this._dateFilter}set dateFilter(e){const i=this._startInput,r=this._endInput,o=i&&i._matchesFilter(i.value),l=r&&r._matchesFilter(i.value);this._dateFilter=e,i&&i._matchesFilter(i.value)!==o&&i._validatorOnChange(),r&&r._matchesFilter(r.value)!==l&&r._validatorOnChange()}get min(){return this._min}set min(e){const i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(i,this._min)||(this._min=i,this._revalidate())}get max(){return this._max}set max(e){const i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(i,this._max)||(this._max=i,this._revalidate())}get disabled(){return this._startInput&&this._endInput?this._startInput.disabled&&this._endInput.disabled:this._groupDisabled}set disabled(e){const i=nc(e);i!==this._groupDisabled&&(this._groupDisabled=i,this.stateChanges.next(void 0))}get errorState(){return!(!this._startInput||!this._endInput)&&(this._startInput.errorState||this._endInput.errorState)}get empty(){const e=!!this._startInput&&this._startInput.isEmpty(),i=!!this._endInput&&this._endInput.isEmpty();return e&&i}constructor(e,i,r,o,l){this._changeDetectorRef=e,this._elementRef=i,this._dateAdapter=o,this._formField=l,this._closedSubscription=Me.EMPTY,this.id="mat-date-range-input-"+Tfe++,this.focused=!1,this.controlType="mat-date-range-input",this._groupDisabled=!1,this._ariaDescribedBy=null,this.separator="\u2013",this.comparisonStart=null,this.comparisonEnd=null,this.stateChanges=new Oe,l?._elementRef.nativeElement.classList.contains("mat-mdc-form-field")&&i.nativeElement.classList.add("mat-mdc-input-element","mat-mdc-form-field-input-control","mdc-text-field__input"),this.ngControl=r}setDescribedByIds(e){this._ariaDescribedBy=e.length?e.join(" "):null}onContainerClick(){!this.focused&&!this.disabled&&(this._model&&this._model.selection.start?this._endInput.focus():this._startInput.focus())}ngAfterContentInit(){this._model&&this._registerModel(this._model),ue(this._startInput.stateChanges,this._endInput.stateChanges).subscribe(()=>{this.stateChanges.next(void 0)})}ngOnChanges(e){t$(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._closedSubscription.unsubscribe(),this.stateChanges.complete()}getStartValue(){return this.value?this.value.start:null}getThemePalette(){return this._formField?this._formField.color:void 0}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():null}_getInputMirrorValue(e){const i="start"===e?this._startInput:this._endInput;return i?i.getMirrorValue():""}_shouldHidePlaceholders(){return!!this._startInput&&!this._startInput.isEmpty()}_handleChildValueChange(){this.stateChanges.next(void 0),this._changeDetectorRef.markForCheck()}_openDatepicker(){this._rangePicker&&this._rangePicker.open()}_shouldHideSeparator(){return(!this._formField||this._formField.getLabelId()&&!this._formField._shouldLabelFloat())&&this.empty}_getAriaLabelledby(){const e=this._formField;return e&&e._hasFloatingLabel()?e._labelId:null}_getStartDateAccessibleName(){return this._startInput._getAccessibleName()}_getEndDateAccessibleName(){return this._endInput._getAccessibleName()}_updateFocus(e){this.focused=null!==e,this.stateChanges.next()}_revalidate(){this._startInput&&this._startInput._validatorOnChange(),this._endInput&&this._endInput._validatorOnChange()}_registerModel(e){this._startInput&&this._startInput._registerModel(e),this._endInput&&this._endInput._registerModel(e)}_isTargetRequired(e){return e?.ngControl?.control?.hasValidator(Qm.required)}static#e=this.\u0275fac=function(i){return new(i||n)(H(mu),H(fr),H(El,10),H(Ws,8),H($9,8))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-date-range-input"]],contentQueries:function(i,r,o){if(1&i&&(Qb(o,o$,5),Qb(o,s$,5)),2&i){let l;wa(l=Ea())&&(r._startInput=l.first),wa(l=Ea())&&(r._endInput=l.first)}},hostAttrs:["role","group",1,"mat-date-range-input"],hostVars:8,hostBindings:function(i,r){2&i&&(ro("id",r.id)("aria-labelledby",r._getAriaLabelledby())("aria-describedby",r._ariaDescribedBy)("data-mat-calendar",r.rangePicker?r.rangePicker.id:null),zo("mat-date-range-input-hide-placeholders",r._shouldHidePlaceholders())("mat-date-range-input-required",r.required))},inputs:{rangePicker:"rangePicker",required:"required",dateFilter:"dateFilter",min:"min",max:"max",disabled:"disabled",separator:"separator",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd"},exportAs:["matDateRangeInput"],features:[oo([{provide:Fhe,useExisting:n},{provide:uA,useExisting:n}]),P],ngContentSelectors:efe,decls:11,vars:5,consts:[["cdkMonitorSubtreeFocus","",1,"mat-date-range-input-container",3,"cdkFocusChange"],[1,"mat-date-range-input-wrapper"],["aria-hidden","true",1,"mat-date-range-input-mirror"],[1,"mat-date-range-input-separator"],[1,"mat-date-range-input-wrapper","mat-date-range-input-end-wrapper"]],template:function(i,r){1&i&&(uf(Jhe),ht(0,"div",0),Qn("cdkFocusChange",function(l){return r._updateFocus(l)}),ht(1,"div",1),il(2),ht(3,"span",2),on(4),pt()(),ht(5,"span",3),on(6),pt(),ht(7,"div",4),il(8,1),ht(9,"span",2),on(10),pt()()()),2&i&&(X(4),Ro(r._getInputMirrorValue("start")),X(1),zo("mat-date-range-input-separator-hidden",r._shouldHideSeparator()),X(1),Ro(r.separator),X(4),Ro(r._getInputMirrorValue("end")))},dependencies:[pz],styles:[".mat-date-range-input{display:block;width:100%}.mat-date-range-input-container{display:flex;align-items:center}.mat-date-range-input-separator{transition:opacity 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);margin:0 4px;color:var(--mat-datepicker-range-input-separator-color)}.mat-form-field-disabled .mat-date-range-input-separator{color:var(--mat-datepicker-range-input-disabled-state-separator-color)}._mat-animation-noopable .mat-date-range-input-separator{transition:none}.mat-date-range-input-separator-hidden{-webkit-user-select:none;user-select:none;opacity:0;transition:none}.mat-date-range-input-wrapper{position:relative;overflow:hidden;max-width:calc(50% - 4px)}.mat-date-range-input-end-wrapper{flex-grow:1}.mat-date-range-input-inner{position:absolute;top:0;left:0;font:inherit;background:rgba(0,0,0,0);color:currentColor;border:none;outline:none;padding:0;margin:0;vertical-align:bottom;text-align:inherit;-webkit-appearance:none;width:100%;height:100%}.mat-date-range-input-inner:-moz-ui-invalid{box-shadow:none}.mat-date-range-input-inner::placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-date-range-input-inner::-moz-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-date-range-input-inner::-webkit-input-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-date-range-input-inner:-ms-input-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-date-range-input-inner[disabled]{color:var(--mat-datepicker-range-input-disabled-state-text-color)}.mat-form-field-hide-placeholder .mat-date-range-input-inner::placeholder,.mat-date-range-input-hide-placeholders .mat-date-range-input-inner::placeholder{-webkit-user-select:none;user-select:none;color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-date-range-input-inner::placeholder,.cdk-high-contrast-active .mat-date-range-input-hide-placeholders .mat-date-range-input-inner::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-date-range-input-inner::-moz-placeholder,.mat-date-range-input-hide-placeholders .mat-date-range-input-inner::-moz-placeholder{-webkit-user-select:none;user-select:none;color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-date-range-input-inner::-moz-placeholder,.cdk-high-contrast-active .mat-date-range-input-hide-placeholders .mat-date-range-input-inner::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-date-range-input-inner::-webkit-input-placeholder,.mat-date-range-input-hide-placeholders .mat-date-range-input-inner::-webkit-input-placeholder{-webkit-user-select:none;user-select:none;color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-date-range-input-inner::-webkit-input-placeholder,.cdk-high-contrast-active .mat-date-range-input-hide-placeholders .mat-date-range-input-inner::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-date-range-input-inner:-ms-input-placeholder,.mat-date-range-input-hide-placeholders .mat-date-range-input-inner:-ms-input-placeholder{-webkit-user-select:none;user-select:none;color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-date-range-input-inner:-ms-input-placeholder,.cdk-high-contrast-active .mat-date-range-input-hide-placeholders .mat-date-range-input-inner:-ms-input-placeholder{opacity:0}._mat-animation-noopable .mat-date-range-input-inner::placeholder{transition:none}._mat-animation-noopable .mat-date-range-input-inner::-moz-placeholder{transition:none}._mat-animation-noopable .mat-date-range-input-inner::-webkit-input-placeholder{transition:none}._mat-animation-noopable .mat-date-range-input-inner:-ms-input-placeholder{transition:none}.mat-date-range-input-mirror{-webkit-user-select:none;user-select:none;visibility:hidden;white-space:nowrap;display:inline-block;min-width:2px}.mat-mdc-form-field-type-mat-date-range-input .mat-mdc-form-field-infix{width:200px}"],encapsulation:2,changeDetection:0})}return n})(),Afe=(()=>{class n extends J9{_forwardContentValues(e){super._forwardContentValues(e);const i=this.datepickerInput;i&&(e.comparisonStart=i.comparisonStart,e.comparisonEnd=i.comparisonEnd,e.startDateAccessibleName=i._getStartDateAccessibleName(),e.endDateAccessibleName=i._getEndDateAccessibleName())}static#e=this.\u0275fac=function(){let e;return function(r){return(e||(e=ms(n)))(r||n)}}();static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-date-range-picker"]],exportAs:["matDateRangePicker"],features:[oo([afe,ufe,{provide:J9,useExisting:n}]),Qi],decls:0,vars:0,template:function(i,r){},encapsulation:2,changeDetection:0})}return n})(),Sfe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[_E,gfe],imports:[a1,f6,OT,yz,Tv,xu,FP]})}return n})();function Mfe(n,t){}class dA{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let a$=(()=>{class n extends ST{constructor(e,i,r,o,l,f,g,b){super(),this._elementRef=e,this._focusTrapFactory=i,this._config=o,this._interactivityChecker=l,this._ngZone=f,this._overlayRef=g,this._focusMonitor=b,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this.attachDomPortal=S=>{this._portalOutlet.hasAttached();const O=this._portalOutlet.attachDomPortal(S);return this._contentAttached(),O},this._document=r,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(e){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachComponentPortal(e);return this._contentAttached(),i}attachTemplatePortal(e){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachTemplatePortal(e);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(e,i){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{e.removeEventListener("blur",r),e.removeEventListener("mousedown",r),e.removeAttribute("tabindex")};e.addEventListener("blur",r),e.addEventListener("mousedown",r)})),e.focus(i)}_focusByCssSelector(e,i){let r=this._elementRef.nativeElement.querySelector(e);r&&this._forceFocus(r,i)}_trapFocus(){const e=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||e.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(i=>{i||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const e=this._config.restoreFocus;let i=null;if("string"==typeof e?i=this._document.querySelector(e):"boolean"==typeof e?i=e?this._elementFocusedBeforeDialogWasOpened:null:e&&(i=e),this._config.restoreFocus&&i&&"function"==typeof i.focus){const r=S1(),o=this._elementRef.nativeElement;(!r||r===this._document.body||r===o||o.contains(r))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const e=this._elementRef.nativeElement,i=S1();return e===i||e.contains(i)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=S1())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(YI),H(rr,8),H(dA),H(KI),H(wi),H(tw),H(O1))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(i,r){if(1&i&&Jl(W_,7),2&i){let o;wa(o=Ea())&&(r._portalOutlet=o.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,r){2&i&&ro("id",r._config.id||null)("role",r._config.role)("aria-modal",r._config.ariaModal)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null)},features:[Qi],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,r){1&i&&Yn(0,Mfe,0,0,"ng-template",0)},dependencies:[W_],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2})}return n})();class dF{constructor(t,e){this.overlayRef=t,this.config=e,this.closed=new Oe,this.disableClose=e.disableClose,this.backdropClick=t.backdropClick(),this.keydownEvents=t.keydownEvents(),this.outsidePointerEvents=t.outsidePointerEvents(),this.id=e.id,this.keydownEvents.subscribe(i=>{27===i.keyCode&&!this.disableClose&&!tg(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=t.detachments().subscribe(()=>{!1!==e.closeOnOverlayDetachments&&this.close()})}close(t,e){if(this.containerInstance){const i=this.closed;this.containerInstance._closeInteractionType=e?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(t),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(t="",e=""){return this.overlayRef.updateSize({width:t,height:e}),this}addPanelClass(t){return this.overlayRef.addPanelClass(t),this}removePanelClass(t){return this.overlayRef.removePanelClass(t),this}}const l$=new Xt("DialogScrollStrategy"),Pfe=new Xt("DialogData"),kfe=new Xt("DefaultDialogConfig"),Ofe={provide:l$,deps:[bf],useFactory:function Rfe(n){return()=>n.scrollStrategies.block()}};let Ffe=0,c$=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(e,i,r,o,l,f){this._overlay=e,this._injector=i,this._defaultOptions=r,this._parentDialog=o,this._overlayContainer=l,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Oe,this._afterOpenedAtThisLevel=new Oe,this._ariaHiddenElements=new Map,this.afterAllClosed=oT(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(mf(void 0))),this._scrollStrategy=f}open(e,i){(i={...this._defaultOptions||new dA,...i}).id=i.id||"cdk-dialog-"+Ffe++,i.id&&this.getDialogById(i.id);const o=this._getOverlayConfig(i),l=this._overlay.create(o),f=new dF(l,i),g=this._attachContainer(l,f,i);return f.containerInstance=g,this._attachDialogContent(e,f,g,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(f),f.closed.subscribe(()=>this._removeOpenDialog(f,!0)),this.afterOpened.next(f),f}closeAll(){hF(this.openDialogs,e=>e.close())}getDialogById(e){return this.openDialogs.find(i=>i.id===e)}ngOnDestroy(){hF(this._openDialogsAtThisLevel,e=>{!1===e.config.closeOnDestroy&&this._removeOpenDialog(e,!1)}),hF(this._openDialogsAtThisLevel,e=>e.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(e){const i=new kT({positionStrategy:e.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:e.scrollStrategy||this._scrollStrategy(),panelClass:e.panelClass,hasBackdrop:e.hasBackdrop,direction:e.direction,minWidth:e.minWidth,minHeight:e.minHeight,maxWidth:e.maxWidth,maxHeight:e.maxHeight,width:e.width,height:e.height,disposeOnNavigation:e.closeOnNavigation});return e.backdropClass&&(i.backdropClass=e.backdropClass),i}_attachContainer(e,i,r){const o=r.injector||r.viewContainerRef?.injector,l=[{provide:dA,useValue:r},{provide:dF,useValue:i},{provide:tw,useValue:e}];let f;r.container?"function"==typeof r.container?f=r.container:(f=r.container.type,l.push(...r.container.providers(r))):f=a$;const g=new G_(f,r.viewContainerRef,Hr.create({parent:o||this._injector,providers:l}),r.componentFactoryResolver);return e.attach(g).instance}_attachDialogContent(e,i,r,o){if(e instanceof qd){const l=this._createInjector(o,i,r,void 0);let f={$implicit:o.data,dialogRef:i};o.templateContext&&(f={...f,..."function"==typeof o.templateContext?o.templateContext():o.templateContext}),r.attachTemplatePortal(new kP(e,null,f,l))}else{const l=this._createInjector(o,i,r,this._injector),f=r.attachComponentPortal(new G_(e,o.viewContainerRef,l,o.componentFactoryResolver));i.componentRef=f,i.componentInstance=f.instance}}_createInjector(e,i,r,o){const l=e.injector||e.viewContainerRef?.injector,f=[{provide:Pfe,useValue:e.data},{provide:dF,useValue:i}];return e.providers&&("function"==typeof e.providers?f.push(...e.providers(i,e,r)):f.push(...e.providers)),e.direction&&(!l||!l.get(ng,null,{optional:!0}))&&f.push({provide:ng,useValue:{value:e.direction,change:Te()}}),Hr.create({parent:l||o,providers:f})}_removeOpenDialog(e,i){const r=this.openDialogs.indexOf(e);r>-1&&(this.openDialogs.splice(r,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((o,l)=>{o?l.setAttribute("aria-hidden",o):l.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const e=this._overlayContainer.getContainerElement();if(e.parentElement){const i=e.parentElement.children;for(let r=i.length-1;r>-1;r--){const o=i[r];o!==e&&"SCRIPT"!==o.nodeName&&"STYLE"!==o.nodeName&&!o.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(o,o.getAttribute("aria-hidden")),o.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}static#e=this.\u0275fac=function(i){return new(i||n)(it(bf),it(Hr),it(kfe,8),it(n,12),it(RT),it(l$))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})();function hF(n,t){let e=n.length;for(;e--;)t(n[e])}let Lfe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[c$,Ofe],imports:[OT,Tv,yz,Tv]})}return n})();function Nfe(n,t){}class hA{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const fF="mdc-dialog--open",u$="mdc-dialog--opening",d$="mdc-dialog--closing";let zfe=(()=>{class n extends a${constructor(e,i,r,o,l,f,g,b){super(e,i,r,o,l,f,g,b),this._animationStateChanged=new ui}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(e){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:e})}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(YI),H(rr,8),H(hA),H(KI),H(wi),H(tw),H(O1))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["ng-component"]],features:[Qi],decls:0,vars:0,template:function(i,r){},encapsulation:2})}return n})();const h$="--mat-dialog-transition-duration";function f$(n){return null==n?null:"number"==typeof n?n:n.endsWith("ms")?nz(n.substring(0,n.length-2)):n.endsWith("s")?1e3*nz(n.substring(0,n.length-1)):"0"===n?0:null}let Ufe=(()=>{class n extends zfe{constructor(e,i,r,o,l,f,g,b,S){super(e,i,r,o,l,f,g,S),this._animationMode=b,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?f$(this._config.enterAnimationDuration)??150:0,this._exitAnimationDuration=this._animationsEnabled?f$(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(h$,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(u$,fF)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(fF),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(fF),this._animationsEnabled?(this._hostElement.style.setProperty(h$,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(d$)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_clearAnimationClasses(){this._hostElement.classList.remove(u$,d$)}_waitForAnimationToComplete(e,i){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,e)}_requestAnimationFrame(e){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(e):e()})}static#e=this.\u0275fac=function(i){return new(i||n)(H(fr),H(YI),H(rr,8),H(hA),H(KI),H(wi),H(tw),H(Ju,8),H(O1))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:8,hostBindings:function(i,r){2&i&&(Hy("id",r._config.id),ro("aria-modal",r._config.ariaModal)("role",r._config.role)("aria-labelledby",r._config.ariaLabel?null:r._ariaLabelledByQueue[0])("aria-label",r._config.ariaLabel)("aria-describedby",r._config.ariaDescribedBy||null),zo("_mat-animation-noopable",!r._animationsEnabled))},features:[Qi],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,r){1&i&&(ht(0,"div",0)(1,"div",1),Yn(2,Nfe,0,0,"ng-template",2),pt()())},dependencies:[W_],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;transform:scale(0.8);opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto;outline:0}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{transform:none;opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__container .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{display:block;width:100%;height:100%}.mat-mdc-dialog-container{--mdc-dialog-container-elevation-shadow:0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12);--mdc-dialog-container-shadow-color:#000;--mdc-dialog-container-shape:4px;--mdc-dialog-container-elevation: var(--mdc-dialog-container-elevation-shadow);outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, 4px)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87))}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6))}.mat-mdc-dialog-container .mdc-dialog__container{transition-duration:var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container{transition:none}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-actions{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2})}return n})();class p${constructor(t,e,i){this._ref=t,this._containerInstance=i,this._afterOpened=new Oe,this._beforeClosed=new Oe,this._state=0,this.disableClose=e.disableClose,this.id=t.id,i._animationStateChanged.pipe(aa(r=>"opened"===r.state),Ls(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(aa(r=>"closed"===r.state),Ls(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),ue(this.backdropClick(),this.keydownEvents().pipe(aa(r=>27===r.keyCode&&!this.disableClose&&!tg(r)))).subscribe(r=>{this.disableClose||(r.preventDefault(),function jfe(n,t,e){n._closeInteractionType=t,n.close(e)}(this,"keydown"===r.type?"keyboard":"mouse"))})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(aa(e=>"closing"===e.state),Ls(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(t){let e=this._ref.config.positionStrategy;return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._ref.updatePosition(),this}updateSize(t="",e=""){return this._ref.updateSize(t,e),this}addPanelClass(t){return this._ref.addPanelClass(t),this}removePanelClass(t){return this._ref.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const $fe=new Xt("MatMdcDialogData"),Hfe=new Xt("mat-mdc-dialog-default-options"),m$=new Xt("mat-mdc-dialog-scroll-strategy"),Wfe={provide:m$,deps:[bf],useFactory:function Gfe(n){return()=>n.scrollStrategies.block()}};let qfe=0,Zfe=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const e=this._parentDialog;return e?e._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(e,i,r,o,l,f,g,b,S,O){this._overlay=e,this._defaultOptions=r,this._parentDialog=o,this._dialogRefConstructor=g,this._dialogContainerType=b,this._dialogDataToken=S,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Oe,this._afterOpenedAtThisLevel=new Oe,this._idPrefix="mat-dialog-",this.dialogConfigClass=hA,this.afterAllClosed=oT(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(mf(void 0))),this._scrollStrategy=f,this._dialog=i.get(c$)}open(e,i){let r;(i={...this._defaultOptions||new hA,...i}).id=i.id||`${this._idPrefix}${qfe++}`,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();const o=this._dialog.open(e,{...i,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:dA,useValue:i}]},templateContext:()=>({dialogRef:r}),providers:(l,f,g)=>(r=new this._dialogRefConstructor(l,i,g),r.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:g},{provide:this._dialogDataToken,useValue:f.data},{provide:this._dialogRefConstructor,useValue:r}])});return r.componentRef=o.componentRef,r.componentInstance=o.componentInstance,this.openDialogs.push(r),this.afterOpened.next(r),r.afterClosed().subscribe(()=>{const l=this.openDialogs.indexOf(r);l>-1&&(this.openDialogs.splice(l,1),this.openDialogs.length||this._getAfterAllClosed().next())}),r}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(e){return this.openDialogs.find(i=>i.id===e)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(e){let i=e.length;for(;i--;)e[i].close()}static#e=this.\u0275fac=function(i){Fe()};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})(),g$=(()=>{class n extends Zfe{constructor(e,i,r,o,l,f,g,b){super(e,i,o,f,g,l,p$,Ufe,$fe,b),this._idPrefix="mat-mdc-dialog-"}static#e=this.\u0275fac=function(i){return new(i||n)(it(bf),it(Hr),it(n1,8),it(Hfe,8),it(m$),it(n,12),it(RT),it(Ju,8))};static#t=this.\u0275prov=Wt({token:n,factory:n.\u0275fac})}return n})(),Kfe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[g$,Wfe],imports:[Lfe,OT,Tv,xu,xu]})}return n})();const y$_firebaseConfig={apiKey:"AIzaSyAd8nBkpyGzjJAelUy8uIaDq2GK9R26Q0Q",authDomain:"maps-d3f3d.firebaseapp.com",databaseURL:"https://maps-d3f3d-default-rtdb.europe-west1.firebasedatabase.app",projectId:"maps-d3f3d",storageBucket:"maps-d3f3d.appspot.com",messagingSenderId:"462933089916",appId:"1:462933089916:web:543d367f001f782e5233f9"};function Yfe(n,t){1&n&&(ht(0,"div",6),on(1," No hay destinos en tu lista de deseos "),pt())}function Xfe(n,t){if(1&n&&(ht(0,"span"),on(1),pt()),2&n){const e=In().$implicit;X(1),Ro(e.placeName)}}function Qfe(n,t){if(1&n&&(ht(0,"span"),on(1),pt()),2&n){const e=In().$implicit;X(1),ys("\xa0- ",e.address,"")}}function Jfe(n,t){if(1&n&&(ht(0,"span"),on(1),pt()),2&n){const e=In().$implicit;X(1),ys("\xa0 (",e.location,")")}}function epe(n,t){if(1&n){const e=Qo();ht(0,"button",18),Qn("click",function(){const o=_i(e).$implicit,l=In(2).$implicit;return Gn(In(2).addToRoute(l,o))}),on(1),fu(2,"titlecase"),fu(3,"date"),pt()}if(2&n){const e=t.$implicit;X(1),ys("A\xf1adir a: ",qy(2,1,zm(3,3,e.date,"EEEE, d")),"")}}function tpe(n,t){if(1&n&&(ht(0,"div",16),Yn(1,epe,4,6,"button",17),pt()),2&n){const e=In(3);X(1),un("ngForOf",e.dates)}}function npe(n,t){if(1&n){const e=Qo();ht(0,"div",10)(1,"div",11)(2,"div",12),Qn("click",function(){const o=_i(e).$implicit;return Gn(In(2).showAvailableDates(o))}),ht(3,"span"),Yn(4,Xfe,2,1,"span",13),Yn(5,Qfe,2,1,"span",13),Yn(6,Jfe,2,1,"span",13),pt()(),ht(7,"div",14),Qn("click",function(){const o=_i(e).index;return Gn(In(2).remove(o))}),ht(8,"mat-icon"),on(9,"delete"),pt()()(),Yn(10,tpe,2,1,"div",15),pt()}if(2&n){const e=t.$implicit,i=In(2);X(4),un("ngIf",e.placeName),X(1),un("ngIf",e.address),X(1),un("ngIf",e.location),X(4),un("ngIf",i.showDatesMap[e.placeName])}}function ipe(n,t){if(1&n&&(ht(0,"div",7)(1,"div",8),Yn(2,npe,11,4,"div",9),pt()()),2&n){const e=In();X(2),un("ngForOf",e.whishlist)}}let rpe=(()=>{class n{constructor(e,i){this.dialogRef=e,this._mapService=i,this.whishlist=this._mapService.whishlist,this.dates=this._mapService.dates,this.showDatesMap={},this._shouldSave=!1}addToRoute(e,i){this._mapService.addToRouteFromWhishlist(e,i)}showAvailableDates(e){this.showDatesMap[e.placeName]=!this.showDatesMap[e.placeName]}remove(e){e>=0&&e<this.whishlist.length&&(this.whishlist.splice(e,1),this._shouldSave=!0)}close(){this._shouldSave&&(this._mapService.whishlist=this.whishlist,this._mapService.allowSave=!0,this._mapService.saveSelection()),this.dialogRef.close()}static#e=this.\u0275fac=function(i){return new(i||n)(H(p$),H(gx))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-whishlist"]],features:[oo([oI,{provide:Zd,useValue:"es"}])],decls:9,vars:2,consts:[[1,"whishlist"],[1,"whishlist--header"],[1,"whishlist--header-close-icon",3,"click"],[1,"whishlist--header-title"],["class","whishlist--no-content",4,"ngIf"],["class","whishlist--list-container",4,"ngIf"],[1,"whishlist--no-content"],[1,"whishlist--list-container"],[1,"whishlist--list-container-list"],["class","whishlist--list-container-list--item",4,"ngFor","ngForOf"],[1,"whishlist--list-container-list--item"],[2,"display","flex","flex-direction","row","width","100%","gap","10px"],[1,"whishlist--list-container-list--item-item",3,"click"],[4,"ngIf"],[1,"whishlist--list-container-list--item-remove",3,"click"],["class","whishlist--list-container-list--item-day",4,"ngIf"],[1,"whishlist--list-container-list--item-day"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(i,r){1&i&&(ht(0,"div",0)(1,"div",1)(2,"div",2),Qn("click",function(){return r.close()}),ht(3,"mat-icon"),on(4,"close"),pt()(),ht(5,"h3",3),on(6,"Lista de deseos"),pt()(),Yn(7,Yfe,2,0,"div",4),Yn(8,ipe,3,1,"div",5),pt()),2&i&&(X(7),un("ngIf",!r.whishlist.length),X(1),un("ngIf",r.whishlist.length))},dependencies:[Ap,Yd,iT,PM,oI],styles:[".whishlist[_ngcontent-%COMP%]{margin:unset;position:relative}.whishlist--header[_ngcontent-%COMP%]{display:flex;flex-direction:row}.whishlist--header-title[_ngcontent-%COMP%]{text-align:center;position:sticky;margin:auto;width:100%;text-transform:uppercase;font-weight:bolder;background-color:#fff;z-index:1}.whishlist--header-close-icon[_ngcontent-%COMP%]{position:sticky;margin:auto;cursor:pointer;color:#0000008a;transition:color .3s ease}.whishlist--header-close-icon[_ngcontent-%COMP%]:hover{color:#000000de}.whishlist--no-content[_ngcontent-%COMP%]{width:100%;height:200px;text-align:center;align-content:center}.whishlist--list-container[_ngcontent-%COMP%]{overflow-y:auto;max-height:calc(100vh - 40px)}.whishlist--list-container-list[_ngcontent-%COMP%]{padding:20px;display:flex;flex-direction:column}.whishlist--list-container-list--item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.whishlist--list-container-list--item-remove[_ngcontent-%COMP%]{cursor:pointer;order:1;display:flex;align-items:center;color:#d3d3d3;transition:color .3s ease}.whishlist--list-container-list--item-remove[_ngcontent-%COMP%]:hover{color:#a9a9a9}.whishlist--list-container-list--item-item[_ngcontent-%COMP%]{font-weight:bolder;cursor:pointer;transition:font-weight .3s ease;order:2;display:flex;align-items:center}.whishlist--list-container-list--item-item[_ngcontent-%COMP%]:hover{font-weight:800}.whishlist--list-container-list--item-day[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:8px;margin:5px;width:100%;justify-content:center}.whishlist--list-container-list--item-day[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 0}"]})}return n})();var ope=Ve(3808),spe=Ve.n(ope);let ape=(()=>{class n{transform(e){const i=Math.floor(e/3600),r=Math.floor(e%3600/60),o=Math.floor(e%60),l=this.padZero(i),f=this.padZero(r),g=this.padZero(o);return"00"===l&&"00"===f?`${g} segundos`:"00"===l?`${f}:${g} minutos`:`${l}:${f}:${g} horas`}padZero(e){return e<10?"0"+e:e.toString()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275pipe=ss({name:"secondsToHms",type:n,pure:!0})}return n})();const lpe=["print"];function cpe(n,t){if(1&n&&(ht(0,"button")(1,"mat-icon"),on(2,"arrow_upward"),pt()()),2&n){const e=In(3);X(1),Cp("color",e.selectedColor)}}function upe(n,t){if(1&n&&(ht(0,"button")(1,"mat-icon"),on(2,"arrow_downward"),pt()()),2&n){const e=In(3);X(1),Cp("color",e.selectedColor)}}const dpe=function(n,t,e,i){return{"first-item":n,"middle-item":t,"last-item":e,"unique-item":i}};function hpe(n,t){if(1&n){const e=Qo();ht(0,"span",8)(1,"p")(2,"span",9),on(3),pt(),ht(4,"span",10),Qn("click",function(){const o=_i(e).index;return Gn(In(2).moveLocation(o,"upward"))}),Yn(5,cpe,3,2,"button",11),pt(),ht(6,"span",10),Qn("click",function(){const o=_i(e).index;return Gn(In(2).moveLocation(o,"downward"))}),Yn(7,upe,3,2,"button",11),pt(),ht(8,"span",12),Qn("click",function(){const o=_i(e).index;return Gn(In(2).remove(o))}),ht(9,"mat-icon"),on(10,"delete"),pt()()()()}if(2&n){const e=t.$implicit,i=t.index,r=In(2);un("ngClass",AN(6,dpe,0===i,i>0&&i<r.arrowsLength-1,i===r.arrowsLength-1,0===i&&i===r.arrowsLength-1)),X(3),Ro(e.name),X(2),un("ngIf",r.arrowsLength>0&&i>0),X(2),un("ngIf",r.arrowsLength>0&&i!==r.arrowsLength-1),X(2),Cp("color",r.selectedColor)}}function fpe(n,t){if(1&n&&(ht(0,"span",6),Yn(1,hpe,11,11,"span",7),pt()),2&n){const e=In();X(1),un("ngForOf",e.date.wishlist)}}function ppe(n,t){if(1&n&&(ht(0,"div",20),Ji(1,"img",21),pt()),2&n){const e=In().$implicit,i=In(2);X(1),un("src",i.currentDateImages[e.route],ia)}}function mpe(n,t){1&n&&(ht(0,"div"),Ji(1,"br"),pt())}function gpe(n,t){if(1&n&&(ht(0,"span"),on(1),fu(2,"number"),pt()),2&n){const e=In().$implicit;X(1),ys(" ",zm(2,1,e.totalDistance,"1.0-1")," km")}}function _pe(n,t){if(1&n&&(ht(0,"span"),on(1),fu(2,"number"),pt()),2&n){const e=In().$implicit;X(1),ys(" ",zm(2,1,1e3*e.totalDistance,"1.0-1")," m")}}function ype(n,t){if(1&n&&(ht(0,"div")(1,"span")(2,"p",16),on(3),pt(),on(4),pt(),ht(5,"span")(6,"p",16),on(7),pt(),on(8),pt()()),2&n){const e=In().$implicit,i=In(2);X(3),ys("",null==i.date.wishlist[e.route]?null:i.date.wishlist[e.route].name,":"),X(1),ys(" ",null==i.date.wishlist[e.route]?null:i.date.wishlist[e.route].description,""),X(3),ys("",null==i.date.wishlist[e.route+1]?null:i.date.wishlist[e.route+1].name,":"),X(1),ys(" ",null==i.date.wishlist[e.route+1]?null:i.date.wishlist[e.route+1].description,"")}}function vpe(n,t){if(1&n&&(ht(0,"span"),on(1),fu(2,"number"),pt()),2&n){const e=In(2).$implicit;X(1),ys(" ",zm(2,1,e.distance,"1.0-1")," km")}}function xpe(n,t){if(1&n&&(ht(0,"span"),on(1),fu(2,"number"),pt()),2&n){const e=In(2).$implicit;X(1),ys(" ",zm(2,1,1e3*e.distance,"1.0-1")," m")}}function bpe(n,t){if(1&n&&(ht(0,"span"),on(1," Distancia: "),Yn(2,vpe,3,4,"span",11),Yn(3,xpe,3,4,"span",11),on(4," - Duraci\xf3n aproximada "),ht(5,"span"),on(6),fu(7,"secondsToHms"),pt()()),2&n){const e=In().$implicit;X(2),un("ngIf",e.distance>=1),X(1),un("ngIf",e.distance<1),X(3),Ro(qy(7,3,e.duration))}}function wpe(n,t){if(1&n&&(ht(0,"div")(1,"ul")(2,"li"),on(3),Yn(4,bpe,8,5,"span",11),pt()()()),2&n){const e=t.$implicit;X(3),ys("",e.maneuver," "),X(1),un("ngIf",e.distance>0&&e.duration>0)}}function Epe(n,t){if(1&n&&(ht(0,"div",22),Ji(1,"img",21),pt()),2&n){const e=In().$implicit,i=In(2);X(1),un("src",i.currentDateImages[e.route+1],ia)}}function Cpe(n,t){if(1&n&&(ht(0,"div"),Yn(1,ppe,2,1,"div",15),Yn(2,mpe,2,0,"div",11),ht(3,"div",16),on(4),pt(),ht(5,"div",17),on(6,"Distancia "),Yn(7,gpe,3,4,"span",11),Yn(8,_pe,3,4,"span",11),on(9," - Duraci\xf3n aproximada "),ht(10,"span"),on(11),fu(12,"secondsToHms"),pt(),Ji(13,"div",18),Yn(14,ype,9,4,"div",11),Ji(15,"div",18),Yn(16,wpe,5,2,"div",14),Yn(17,Epe,2,1,"div",19),pt()()),2&n){const e=t.$implicit,i=In(2);X(1),un("ngIf",i.currentDateImages[e.route]),X(1),un("ngIf",!i.currentDateImages[e.route]),X(2),$y("De ",null==i.date.wishlist[e.route]?null:i.date.wishlist[e.route].name," a ",null==i.date.wishlist[e.route+1]?null:i.date.wishlist[e.route+1].name,""),X(3),un("ngIf",e.totalDistance>=1),X(1),un("ngIf",e.totalDistance<1),X(3),Ro(qy(12,10,e.totalDuration)),X(3),un("ngIf",i.date.wishlist[e.route+1]),X(2),un("ngForOf",e.instructions),X(1),un("ngIf",e.route===i.date.wishlist.length-2&&i.currentDateImages[e.route+1])}}function Ipe(n,t){if(1&n&&(ht(0,"div",13)(1,"div")(2,"h2"),on(3),fu(4,"titlecase"),fu(5,"date"),pt(),ht(6,"h3"),on(7),pt(),Yn(8,Cpe,18,12,"div",14),pt()()),2&n){const e=In();un("id",e.printSectionId),X(3),$y("RUTA: ",qy(4,5,e.date.weekDay)," - ",zm(5,7,e.date.date,"dd/MM/YYYY"),""),X(4),ys("Total de ubicaciones: ",e.date.wishlist.length,""),X(1),un("ngForOf",e.report)}}const Tpe=function(n){return{selected:n}};let Dpe=(()=>{class n{constructor(e,i){this.mapService=e,this.sanitizer=i,this.index=0,this.selectedColorIndex=0,this.selectedColor="",this.report=null,this.printSectionId="",this.imgBaseUrl=AT,this.currentDateImages=[]}ngOnInit(){this.isSelected=this.date.isSelected,this._handleArrows(),this._setColor(),this.printSectionId="printSection"+this.index}ngOnChanges(e){const i=e.date.currentValue;i.isSelected&&(this.arrowsLength=i.wishlist?.length)}setSelectedDay(e){this.mapService.selectedDay=e??this.date,this._handleArrows(),this._setColor()}moveLocation(e,i){const r=this.date.wishlist.splice(e,1)[0];this.date.wishlist.splice(i===a6.UPWARD?e-1:e+1,0,r),this._notifyService()}remove(e){if(e>=0&&e<this.date.wishlist.length){const i=this.date.wishlist[e],l=this.sanitizer.bypassSecurityTrustUrl(`${AT}/${SP[i.placeType??i.type]}/${i.placeId??i.id}.jpg`),f=this.currentDateImages.findIndex(g=>g===l);-1!==f&&this.currentDateImages.splice(f,1),this.date.wishlist.splice(e,1),this._notifyService()}}getCurrentDateImages(){var e=this;return(0,Jt.Z)(function*(){e.currentDateImages=[];const i=e.date.wishlist.map(function(){var r=(0,Jt.Z)(function*(o){let l="";if(o.id.length<12&&((o.placeType&&o.placeId)??(o.type&&o.id))&&o.hasImage){const b=`${AT}/${SP[o.placeType??o.type]}/${o.placeId??o.id}.jpg`;l=yield e._loadImage(b).then(S=>e.sanitizer.bypassSecurityTrustUrl(S)).catch(S=>(console.error(`Error al cargar la imagen: ${b}`,S),""))}return l});return function(o){return r.apply(this,arguments)}}());e.currentDateImages=yield Promise.all(i)})()}_loadImage(e){return new Promise((i,r)=>{const o=new Image;o.src=e,o.onload=()=>i(e),o.onerror=l=>r(l)})}_resetCurrentDateImages(){this.currentDateImages=[]}_setColor(){this.selectedColor=AP[((this.selectedColorIndex??0)%6+6)%6]}_handleArrows(){this.mapService.showArrows.pipe(Dr(e=>{this.date.isSelected&&(this.arrowsLength=e)})).subscribe()}_notifyService(){this.mapService.wishlistFromSelectedDay(this.date.wishlist),this.mapService.recalculateDirections(),this.mapService.allowSave=!0}_toTitleCase(e){return e.replace(/\w\S*/g,i=>i.charAt(0).toUpperCase()+i.substring(1).toLowerCase())}exportToPdf(e){if(e.wishlist.length<=1)return void this.mapService._showNotification("A\xf1ada al menos 2 destinos para exportar las indicaciones");this.getCurrentDateImages();const i=this._groupRoute(this.mapService.generateReport());this.report=Object.values(i),this.mapService.wishlistFromSelectedDay(this.date.wishlist);const r=new Date(this.date.date),o=`Indicaciones-${this._toTitleCase(this.date.weekDay)}-${r.getDate()}/${r.getMonth()}/${r.getFullYear()}`;setTimeout(()=>{spe()({printable:this.printSectionId,documentTitle:o,type:"html",css:["assets/print-config.css"],scanStyles:!0})},800)}_formatDate(e){return t4(e,"dd_MM_yyyy","es-ES")}_groupRoute(e){return e.reduce((i,r)=>{const{route:o,instructions:l,totalDistance:f,totalDuration:g}=r;return i[o]||(i[o]={route:o,instructions:[],totalDistance:f,totalDuration:g}),i[o].instructions.push(l),i},{})}static#e=this.\u0275fac=function(i){return new(i||n)(H(gx),H(uI))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-day"]],viewQuery:function(i,r){if(1&i&&Jl(lpe,5),2&i){let o;wa(o=Ea())&&(r.print=o.first)}},inputs:{date:"date",index:"index",isSelected:"isSelected",selectedColorIndex:"selectedColorIndex"},features:[P],decls:15,vars:19,consts:[[3,"click"],[1,"text",3,"ngClass"],["id","localizations-list",4,"ngIf"],[1,"container"],[1,"row"],[3,"id",4,"ngIf"],["id","localizations-list"],["class","localizations",3,"ngClass",4,"ngFor","ngForOf"],[1,"localizations",3,"ngClass"],[1,"locate"],[1,"arrow",3,"click"],[4,"ngIf"],[1,"arrow","remove",3,"click"],[3,"id"],[4,"ngFor","ngForOf"],["id","image",4,"ngIf"],[1,"boldType"],[1,"paddingTop"],[1,"separation"],["class","lastImage",4,"ngIf"],["id","image"],[1,"showImage",3,"src"],[1,"lastImage"]],template:function(i,r){1&i&&(ht(0,"span",0),Qn("click",function(){return r.setSelectedDay()}),ht(1,"div")(2,"span",1)(3,"span"),on(4),pt(),ht(5,"span"),on(6),fu(7,"titlecase"),fu(8,"date"),pt()(),ht(9,"mat-icon",0),Qn("click",function(){return r.exportToPdf(r.date)}),on(10,"save_as"),pt()(),Yn(11,fpe,2,1,"span",2),pt(),ht(12,"div",3)(13,"div",4),Yn(14,Ipe,9,10,"div",5),pt()()),2&i&&(Cp("background-color",r.date.isSelected?r.selectedColor:"#FFFFFF")("transition",r.date.isSelected?"background-color 0.6s ease":""),zo("selected",r.date.isSelected),X(2),un("ngClass",Kb(17,Tpe,r.date.isSelected)),X(2),Ro(r.selectedColorIndex+1),X(2),$y("",qy(7,12,r.date.weekDay)," - ",zm(8,14,r.date.date,"dd/MM/YYYY"),""),X(5),un("ngIf",r.date.isSelected),X(3),un("ngIf",r.report))},dependencies:[s1,Ap,Yd,iT,_4,PM,oI,ape],styles:["span[_ngcontent-%COMP%]{display:flex;flex-direction:column;cursor:pointer;padding:6px}span[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center}span[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:row}span[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px 8px 0 0;font-weight:900}span[_ngcontent-%COMP%]   #localizations-list[_ngcontent-%COMP%]{padding:unset}span[_ngcontent-%COMP%]   #localizations-list[_ngcontent-%COMP%]   .localizations[_ngcontent-%COMP%]{background-color:#fff}span[_ngcontent-%COMP%]   #localizations-list[_ngcontent-%COMP%]   .localizations[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;align-items:center;margin:unset}span[_ngcontent-%COMP%]   #localizations-list[_ngcontent-%COMP%]   .localizations[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .locate[_ngcontent-%COMP%]{flex:1;width:300px}span[_ngcontent-%COMP%]   #localizations-list[_ngcontent-%COMP%]   .localizations[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{width:36px;padding:unset;align-items:center}span[_ngcontent-%COMP%]   #localizations-list[_ngcontent-%COMP%]   .localizations[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   .remove[_ngcontent-%COMP%]{align-items:center}span[_ngcontent-%COMP%]   #localizations-list[_ngcontent-%COMP%]   .localizations[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:unset;background-color:unset;flex:.6;cursor:pointer}span[_ngcontent-%COMP%]   .first-item[_ngcontent-%COMP%]{border-radius:0 8px 0 0}span[_ngcontent-%COMP%]   .middle-item[_ngcontent-%COMP%]{border-radius:0}span[_ngcontent-%COMP%]   .last-item[_ngcontent-%COMP%]{border-radius:0 0 8px 8px}span[_ngcontent-%COMP%]   .unique-item[_ngcontent-%COMP%]{border-radius:0 8px 8px}mat-icon[_ngcontent-%COMP%]{color:#fff;padding:6px}.container[_ngcontent-%COMP%]{display:none;padding:50px;max-height:400px;overflow-y:auto}.container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:block;text-align:center;padding:5%}"]})}return n})();function Ape(n,t){1&n&&(ht(0,"p"),on(1,"Ocultar listado"),pt())}function Spe(n,t){1&n&&(ht(0,"p"),on(1,"Mostrar listado"),pt())}function Mpe(n,t){if(1&n&&(ht(0,"div"),Ji(1,"app-day",8),pt()),2&n){const e=t.$implicit,i=t.index;X(1),un("date",e)("index",i)("selectedColorIndex",i)}}function Ppe(n,t){if(1&n&&(ht(0,"div",6),Yn(1,Mpe,2,3,"div",7),pt()),2&n){const e=In();X(1),un("ngForOf",e.dates)}}const kpe=function(){return{color:"#007bff"}},Rpe=function(){return{color:"gray"}};let Ope=(()=>{class n{constructor(e,i){this._mapService=e,this.dialog=i,this.dates=[],this.colors=AP,this.isUserInfoVisible=!0,this.isWhishlistVisible=!1}ngOnChanges(e){e.dates?.currentValue&&this.dates.length>0&&(this.dates[0].isSelected=!0,this._mapService.dates=this.dates,this._mapService.selectedDay=this.dates[0])}toggleUserInfoVisibility(){this.isUserInfoVisible=!this.isUserInfoVisible}showWhishlistPopup(){this.isWhishlistVisible=!this.isWhishlistVisible,this.dialog.open(rpe,{width:"40%",height:"50%",minWidth:"290px"})}static#e=this.\u0275fac=function(i){return new(i||n)(H(gx),H(g$))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-user-config"]],inputs:{dates:"dates"},features:[P],decls:10,vars:6,consts:[[1,"user-config"],[1,"user-config--hide-and-show",3,"ngStyle"],[1,"user-config--hide-and-show--dates-list",3,"click"],[4,"ngIf"],[1,"user-config--hide-and-show--whishlist",3,"click"],["class","user-config--user-info",4,"ngIf"],[1,"user-config--user-info"],[4,"ngFor","ngForOf"],[3,"date","index","selectedColorIndex"]],template:function(i,r){1&i&&(ht(0,"div",0)(1,"div",1)(2,"span",2),Qn("click",function(){return r.toggleUserInfoVisibility()}),Yn(3,Ape,2,0,"p",3),Yn(4,Spe,2,0,"p",3),ht(5,"mat-icon"),on(6,"visibility"),pt()(),ht(7,"button",4),Qn("click",function(){return r.showWhishlistPopup()}),on(8,"Lista de deseos"),pt()(),Yn(9,Ppe,2,1,"div",5),pt()),2&i&&(X(1),un("ngStyle",r.isUserInfoVisible?jS(4,kpe):jS(5,Rpe)),X(2),un("ngIf",r.isUserInfoVisible),X(1),un("ngIf",!r.isUserInfoVisible),X(5),un("ngIf",r.isUserInfoVisible))},dependencies:[Ap,Yd,MM,iT,Dpe],styles:[".user-config[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:506px;padding:5px 10px;margin:0 5px;border-radius:0 0 8px 8px;background-color:#fff;position:fixed}.user-config--hide-and-show[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:auto;width:100%;padding:5px 0;height:25px;cursor:pointer}.user-config--hide-and-show--dates-list[_ngcontent-%COMP%]{order:1;flex:2;display:flex;flex-direction:row;align-items:center;justify-content:center;gap:10px}.user-config--hide-and-show--dates-list[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:unset}.user-config--hide-and-show--whishlist[_ngcontent-%COMP%]{order:2;flex:1;display:flex;align-items:center;justify-content:center}.user-config--user-info[_ngcontent-%COMP%]{left:2px;top:32px;overflow-y:auto;max-height:95vh}h4[_ngcontent-%COMP%]{margin:unset!important}@media only screen and (max-width: 700px){.user-config[_ngcontent-%COMP%]{width:-webkit-fill-available;min-width:unset;font-size:12px}.user-config--hide-and-show[_ngcontent-%COMP%]{padding:unset}.user-config--hide-and-show--dates-list[_ngcontent-%COMP%], .user-config--hide-and-show--whishlist[_ngcontent-%COMP%]{font-size:12px}.user-config--user-info[_ngcontent-%COMP%]{width:100%;padding-top:5px}}"]})}return n})(),Fpe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-loading"]],decls:6,vars:0,consts:[[1,"loading-map"],[1,"loading-map--text-center"]],template:function(i,r){1&i&&(ht(0,"div",0)(1,"div",1)(2,"h3"),on(3,"Espere por favor"),pt(),ht(4,"span"),on(5,"Localizando..."),pt()()())},styles:[".loading-map[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background-color:#000c;color:#fff;height:100vh;position:fixed;right:0;top:0;width:100vw}.loading-map--text-center[_ngcontent-%COMP%]{text-align:center}"]})}return n})();const Lpe=function(n){return{"background-color":n}};function Npe(n,t){if(1&n){const e=Qo();ht(0,"div",3)(1,"button",4),Qn("click",function(){const o=_i(e).$implicit;return Gn(In().setFilter(o))}),on(2),pt()()}if(2&n){const e=t.$implicit,i=t.index,r=In();X(1),un("ngStyle",Kb(2,Lpe,r.getBackgroundColor(i))),X(1),Ro(e)}}let Bpe=(()=>{class n{constructor(e,i,r){this.placesService=e,this.mapService=i,this.localizationsService=r,this.filter=new ui,this.optionsMapping=u6,this.options=Object.keys(this.optionsMapping),this.optionsKey=Object.values(this.optionsMapping).filter(o=>"restore"!==o)}ngOnInit(){const e=document.getElementById("contenedor"),i=document.getElementById("elemento");e?.addEventListener("click",()=>{i?.classList.contains("mostrar")?i?.classList.remove("mostrar"):i?.classList.add("mostrar")}),document.addEventListener("click",r=>{e&&r.target!==e&&!e.contains(r.target)&&i?.classList.contains("mostrar")&&i?.classList.remove("mostrar")})}getBackgroundColor(e){return 0===e?"#007BFF":l6[e-1]}setFilter(e){this.filter.emit(e),this.mapService.clearRouteIds(),"Restablecer"===e?this._getLocalizations():this._getLocalizationsWithFilter(this.optionsMapping[e])}_getLocalizations(){this.localizationsService.localizations$.pipe(_f(),$t(e=>e.filter(i=>"true"===i.visible)),bn(e=>(this.mapService.createMarkersFromPlaces(e,this.placesService.userLocation),Te(e)))).subscribe()}_getLocalizationsWithFilter(e){this.localizationsService.localizations$.pipe(_f(),bn(i=>((i=i.filter(r=>r.type?.includes(e)))?this.mapService.createMarkersFromPlaces(i,this.placesService.userLocation):this.mapService.resetMarkersFromPlaces(),Te(i)))).subscribe()}static#e=this.\u0275fac=function(i){return new(i||n)(H(eF),H(gx),H(gE))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-filter"]],outputs:{filter:"filter"},decls:5,vars:1,consts:[["id","contenedor",1,"filter-container"],["id","elemento"],["class","buttons",4,"ngFor","ngForOf"],[1,"buttons"],[1,"button",3,"ngStyle","click"]],template:function(i,r){1&i&&(ht(0,"div",0)(1,"p"),on(2," FILTROS "),pt(),ht(3,"div",1),Yn(4,Npe,3,4,"div",2),pt()()),2&i&&(X(4),un("ngForOf",r.options))},dependencies:[Ap,MM],styles:['@charset "UTF-8";.filter-container[_ngcontent-%COMP%]{position:fixed;top:0;right:5px;background-color:#fff;padding:5px;width:200px;box-shadow:0 10px 10px #0000001a;border-radius:0 0 8px 8px;border:1px solid rgba(0,0,0,.1)}.filter-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:700;text-align:center;margin:auto;cursor:pointer}.filter-container[_ngcontent-%COMP%]   #elemento[_ngcontent-%COMP%]{background-color:#f1f1f1;border:1px solid #ccc;border-radius:5px;opacity:0;max-height:0;overflow:hidden;transition:opacity .3s ease,max-height .3s ease}.filter-container[_ngcontent-%COMP%]   #elemento.mostrar[_ngcontent-%COMP%]{opacity:1;max-height:1000px}.filter-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;justify-content:center}.filter-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin:5px;width:100%}@media only screen and (max-width: 1200px){.filter-container[_ngcontent-%COMP%]{width:150px}.filter-container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:16px}}@media only screen and (max-width: 700px){.filter-container[_ngcontent-%COMP%]{width:150px;bottom:0;top:unset;left:8px;border-radius:8px 8px 0 0}.filter-container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:12px}}']})}return n})();const Vpe=["picker"];let zpe=(()=>{class n{constructor(){this.actionCompleted=new ui,this.dates=[],this.disabledButton=!0,this.unsubscribe$=new Oe}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}ngAfterViewInit(){setTimeout(()=>{this.picker&&(this.picker.open(),this.picker.closedStream.pipe(ld(this.unsubscribe$),Dr(()=>this.openCalendar())).subscribe())},0)}openCalendar(){const e=document.querySelector(".mat-datepicker-toggle");setTimeout(()=>{e&&e.click()},120)}onStartDateChange(e){this.startDate=e.value}onEndDateChange(e){this.endDate=e.value,this.getDiferenciaDias()}getDiferenciaDias(){if(this.startDate&&this.endDate){const e=this.endDate.getTime()-this.startDate.getTime(),i=Math.floor(e/864e5);this.dates=[];let r=new Date(this.startDate);for(let o=0;o<=i;o++){const l=new Date(r),f=r.toLocaleString("es-ES",{weekday:"long"});this.dates.push({date:l,weekDay:f,isSelected:!1,wishlist:[],markers:[]}),r.setDate(r.getDate()+1)}return this.actionCompleted.emit(this.dates),`La diferencia de d\xedas es: ${i}`}return this.dates=[],"Ambas fechas deben estar seleccionadas."}preventClose(e){e.stopPropagation()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-date-selector"]],viewQuery:function(i,r){if(1&i&&Jl(Vpe,5),2&i){let o;wa(o=Ea())&&(r.picker=o.first)}},outputs:{actionCompleted:"actionCompleted"},decls:12,vars:2,consts:[[1,"date-selector-overlay"],[1,"date-selector-overlay--date-selector-container"],[1,"date-selector-overlay--date-selector-container--date-selector"],[1,"demo-inline-calendar-card"],[3,"rangePicker"],["matStartDate","","placeholder","",2,"display","none",3,"dateChange"],["matEndDate","","placeholder","","id","endDate",2,"display","none",3,"dateChange"],["id","picker",3,"for"],["picker",""]],template:function(i,r){if(1&i&&(ht(0,"div",0)(1,"div",1)(2,"h2"),on(3,"Seleccione rango de fechas"),pt(),ht(4,"div",2)(5,"div",3)(6,"mat-date-range-input",4)(7,"input",5),Qn("dateChange",function(l){return r.onStartDateChange(l)}),pt(),ht(8,"input",6),Qn("dateChange",function(l){return r.onEndDateChange(l)}),pt()(),Ji(9,"mat-datepicker-toggle",7)(10,"mat-date-range-picker",null,8),pt()()()()),2&i){const o=AC(11);X(6),un("rangePicker",o),X(3),un("for",o)}},dependencies:[wfe,Dfe,o$,s$,Afe],styles:["mat-card[_ngcontent-%COMP%], .demo-inline-calendar-card[_ngcontent-%COMP%]{width:20rem;height:45vh}mat-card[_ngcontent-%COMP%]   .mat-datepicker-toggle[_ngcontent-%COMP%], .demo-inline-calendar-card[_ngcontent-%COMP%]   .mat-datepicker-toggle[_ngcontent-%COMP%]{display:none}mat-card[_ngcontent-%COMP%]   .cdk-overlay-pane[_ngcontent-%COMP%]   mat-datepicker-popup[_ngcontent-%COMP%], .demo-inline-calendar-card[_ngcontent-%COMP%]   .cdk-overlay-pane[_ngcontent-%COMP%]   mat-datepicker-popup[_ngcontent-%COMP%]{width:100%;justify-content:center;margin:auto}  .mat-datepicker-content .mat-calendar{width:20rem!important;height:unset!important}  .mat-datepicker-content{margin-left:unset}  .mat-calendar-body-cell-content.mat-focus-indicator:hover{background-color:#0056b3!important}  .mat-calendar-body-cell-content.mat-calendar-body-selected{background-color:#0056b3!important}  .mat-calendar-body-cell-content.mat-calendar-body-selected:hover{background-color:#0056b3!important}.date-selector-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:1000;display:flex;flex-direction:column}.date-selector-overlay--date-selector-container[_ngcontent-%COMP%]{height:435px;text-align:center;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 4px #0003;display:flex;flex-direction:column}.date-selector-overlay--date-selector-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.date-selector-overlay--date-selector[_ngcontent-%COMP%]{order:1;display:flex}@media only screen and (max-width: 370px){.date-selector-overlay--date-selector-container[_ngcontent-%COMP%]{padding:5px;width:300px;height:415px}  .mat-datepicker-content .mat-calendar{width:18rem!important}  .mat-datepicker-content{margin-left:5px}}"]})}return n})();function Upe(n,t){1&n&&Ji(0,"app-loading")}function jpe(n,t){1&n&&(ht(0,"div",6),Ji(1,"app-loading"),pt())}function $pe(n,t){if(1&n){const e=Qo();ht(0,"app-date-selector",7),Qn("actionCompleted",function(r){return _i(e),Gn(In(2).selectDates(r))}),pt()}}function Hpe(n,t){1&n&&Ji(0,"app-user-config",8),2&n&&un("dates",In(2).datesSelected)}function Gpe(n,t){if(1&n){const e=Qo();ht(0,"div",2),Qn("mouseleave",function(){return _i(e),Gn(In().mouseLeave())}),Yn(1,jpe,2,0,"div",3),Yn(2,$pe,1,0,"app-date-selector",4),Ji(3,"app-map-view"),Yn(4,Hpe,1,1,"app-user-config",5),Ji(5,"app-filter"),pt()}if(2&n){const e=In();X(1),un("ngIf",e.showLoading),X(1),un("ngIf",e.showModal&&!e.showLoading),X(2),un("ngIf",e.datesSelected)}}const Wpe=[{path:"",component:(()=>{class n{constructor(e,i,r){this.placesService=e,this._localizationsService=i,this._mapService=r,this.unsubscribe$=new Oe,this.showLoading=!0,this.showModal=!0,this._localizationsService.checkUserSession().pipe(ld(this.unsubscribe$),Dr(o=>{if(this.showLoading=!1,o?.data&&o?.data?.length>0){const l=this._handleData(o.data);this.datesSelected=l,this._mapService.allowSave=!1,this.showModal=!1}o?.whishlist&&o?.whishlist?.length>0&&o.whishlist.map(f=>({coords:JSON.parse(f.coords),placeName:f.placeName,description:f.description,customId:f.customId,marker:this._mapService.getMarker(JSON.parse(f.coords)[0])}))?.forEach(f=>{this._mapService.whishlist.push(f)})})).subscribe()}get isUserLocationReady(){return this.placesService.isUserLocationReady}selectDates(e){this.showModal=!1,this.datesSelected=e}mouseLeave(){this._mapService.saveSelection()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}_handleData(e){const i=e;return i.map(r=>{r.date instanceof es&&(r.date=new Date(1e3*r.date.seconds)),r.wishlist&&(r.wishlist=JSON.parse(r.wishlist),r.wishlist.map(o=>{o.coords=JSON.parse(o.coords),o.marker=this._mapService.getMarker(o.coords[0])})),r.markers=[]}),i}static#e=this.\u0275fac=function(i){return new(i||n)(H(eF),H(gE),H(gx))};static#t=this.\u0275cmp=Wi({type:n,selectors:[["app-map-screen"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["mapReady",""],[3,"mouseleave"],["style","position: fixed; z-index: 1001;",4,"ngIf"],[3,"actionCompleted",4,"ngIf"],[3,"dates",4,"ngIf"],[2,"position","fixed","z-index","1001"],[3,"actionCompleted"],[3,"dates"]],template:function(i,r){if(1&i&&(Yn(0,Upe,1,0,"app-loading",0),Yn(1,Gpe,6,3,"ng-template",null,1,ZN)),2&i){const o=AC(2);un("ngIf",!r.isUserLocationReady)("ngIfElse",o)}},dependencies:[Yd,Ope,j9,Fpe,Bpe,zpe]})}return n})()}];let qpe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({imports:[CT.forRoot(Wpe),CT]})}return n})();!function vK(n,t,e){(function hG(n,t,e){"string"!=typeof t&&(e=t,t=n[Uo.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),Gy[t]=n,e&&(Gy[t][Uo.ExtraData]=e)})(n,t,e)}(bhe,"es");let Zpe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n});static#n=this.\u0275inj=Ai({providers:[{provide:bz,useValue:"es-ES"}],imports:[qpe,a1,mee,JV,Sfe,Ahe,bte,S6,Lz,Kfe,Wde,wre.initializeApp(y$_firebaseConfig),Woe(()=>qoe(y$_firebaseConfig)),Dde(()=>Sde())]})}return n})(),Kpe=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=qi({type:n,bootstrap:[vhe]});static#n=this.\u0275inj=Ai({imports:[L4,Zpe,Lz,yhe,_J,gX,JV]})}return n})();if(Rre().accessToken="pk.eyJ1IjoiaGFzY2hlbGwiLCJhIjoiY2xvOGRkc2I5MDA1ZTJrcXFvY3Y4czB6eiJ9.SLGgLTFgBhwDoK_eiQBBxw",!navigator.geolocation)throw alert("Navegador no soporta geolocalizaci\xf3n"),new Error("Navegador no soporta geolocalizaci\xf3n");VY().bootstrapModule(Kpe).catch(n=>console.error(n))},8042:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(5506),Ve(2873),Ve(2066),Ve(3270),function(){var ie=W,h=ie.lib.BlockCipher,Me=ie.algo,He=[],rt=[],se=[],ce=[],xe=[],ae=[],he=[],_e=[],ke=[],$e=[];!function(){for(var Ie=[],Le=0;Le<256;Le++)Ie[Le]=Le<128?Le<<1:Le<<1^283;var mt=0,at=0;for(Le=0;Le<256;Le++){var ze=at^at<<1^at<<2^at<<3^at<<4;He[mt]=ze=ze>>>8^255&ze^99,rt[ze]=mt;var lt,kt=Ie[mt],fn=Ie[kt],xt=Ie[fn];se[mt]=(lt=257*Ie[ze]^16843008*ze)<<24|lt>>>8,ce[mt]=lt<<16|lt>>>16,xe[mt]=lt<<8|lt>>>24,ae[mt]=lt,he[ze]=(lt=16843009*xt^65537*fn^257*kt^16843008*mt)<<24|lt>>>8,_e[ze]=lt<<16|lt>>>16,ke[ze]=lt<<8|lt>>>24,$e[ze]=lt,mt?(mt=kt^Ie[Ie[Ie[xt^kt]]],at^=Ie[Ie[at]]):mt=at=1}}();var Je=[0,1,2,4,8,16,32,64,128,27,54],tt=Me.AES=h.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var Le=this._keyPriorReset=this._key,mt=Le.words,at=Le.sigBytes/4,kt=4*((this._nRounds=at+6)+1),fn=this._keySchedule=[],xt=0;xt<kt;xt++)xt<at?fn[xt]=mt[xt]:(Ie=fn[xt-1],xt%at?at>6&&xt%at==4&&(Ie=He[Ie>>>24]<<24|He[Ie>>>16&255]<<16|He[Ie>>>8&255]<<8|He[255&Ie]):(Ie=He[(Ie=Ie<<8|Ie>>>24)>>>24]<<24|He[Ie>>>16&255]<<16|He[Ie>>>8&255]<<8|He[255&Ie],Ie^=Je[xt/at|0]<<24),fn[xt]=fn[xt-at]^Ie);for(var lt=this._invKeySchedule=[],pn=0;pn<kt;pn++){if(xt=kt-pn,pn%4)var Ie=fn[xt];else Ie=fn[xt-4];lt[pn]=pn<4||xt<=4?Ie:he[He[Ie>>>24]]^_e[He[Ie>>>16&255]]^ke[He[Ie>>>8&255]]^$e[He[255&Ie]]}}},encryptBlock:function(Ie,Le){this._doCryptBlock(Ie,Le,this._keySchedule,se,ce,xe,ae,He)},decryptBlock:function(Ie,Le){var mt=Ie[Le+1];Ie[Le+1]=Ie[Le+3],Ie[Le+3]=mt,this._doCryptBlock(Ie,Le,this._invKeySchedule,he,_e,ke,$e,rt),mt=Ie[Le+1],Ie[Le+1]=Ie[Le+3],Ie[Le+3]=mt},_doCryptBlock:function(Ie,Le,mt,at,ze,kt,fn,xt){for(var lt=this._nRounds,pn=Ie[Le]^mt[0],Lt=Ie[Le+1]^mt[1],nn=Ie[Le+2]^mt[2],wn=Ie[Le+3]^mt[3],Rt=4,Jn=1;Jn<lt;Jn++){var Kt=at[pn>>>24]^ze[Lt>>>16&255]^kt[nn>>>8&255]^fn[255&wn]^mt[Rt++],Hn=at[Lt>>>24]^ze[nn>>>16&255]^kt[wn>>>8&255]^fn[255&pn]^mt[Rt++],yi=at[nn>>>24]^ze[wn>>>16&255]^kt[pn>>>8&255]^fn[255&Lt]^mt[Rt++],Pe=at[wn>>>24]^ze[pn>>>16&255]^kt[Lt>>>8&255]^fn[255&nn]^mt[Rt++];pn=Kt,Lt=Hn,nn=yi,wn=Pe}Kt=(xt[pn>>>24]<<24|xt[Lt>>>16&255]<<16|xt[nn>>>8&255]<<8|xt[255&wn])^mt[Rt++],Hn=(xt[Lt>>>24]<<24|xt[nn>>>16&255]<<16|xt[wn>>>8&255]<<8|xt[255&pn])^mt[Rt++],yi=(xt[nn>>>24]<<24|xt[wn>>>16&255]<<16|xt[pn>>>8&255]<<8|xt[255&Lt])^mt[Rt++],Pe=(xt[wn>>>24]<<24|xt[pn>>>16&255]<<16|xt[Lt>>>8&255]<<8|xt[255&nn])^mt[Rt++],Ie[Le]=Kt,Ie[Le+1]=Hn,Ie[Le+2]=yi,Ie[Le+3]=Pe},keySize:8});ie.AES=h._createHelper(tt)}(),W.AES)},9172:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(5506),Ve(2873),Ve(2066),Ve(3270),function(){var ie=W,h=ie.lib.BlockCipher;const He=16,rt=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],se=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var ce={pbox:[],sbox:[]};function xe($e,Je){let at=$e.sbox[0][Je>>24&255]+$e.sbox[1][Je>>16&255];return at^=$e.sbox[2][Je>>8&255],at+=$e.sbox[3][255&Je],at}function ae($e,Je,tt){let mt,Ie=Je,Le=tt;for(let at=0;at<He;++at)Ie^=$e.pbox[at],Le=xe($e,Ie)^Le,mt=Ie,Ie=Le,Le=mt;return mt=Ie,Ie=Le,Le=mt,Le^=$e.pbox[He],Ie^=$e.pbox[He+1],{left:Ie,right:Le}}var ke=ie.algo.Blowfish=h.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var $e=this._keyPriorReset=this._key;!function _e($e,Je,tt){for(let ze=0;ze<4;ze++){$e.sbox[ze]=[];for(let kt=0;kt<256;kt++)$e.sbox[ze][kt]=se[ze][kt]}let Ie=0;for(let ze=0;ze<He+2;ze++)$e.pbox[ze]=rt[ze]^Je[Ie],Ie++,Ie>=tt&&(Ie=0);let Le=0,mt=0,at=0;for(let ze=0;ze<He+2;ze+=2)at=ae($e,Le,mt),Le=at.left,mt=at.right,$e.pbox[ze]=Le,$e.pbox[ze+1]=mt;for(let ze=0;ze<4;ze++)for(let kt=0;kt<256;kt+=2)at=ae($e,Le,mt),Le=at.left,mt=at.right,$e.sbox[ze][kt]=Le,$e.sbox[ze][kt+1]=mt;return!0}(ce,$e.words,$e.sigBytes/4)}},encryptBlock:function($e,Je){var tt=ae(ce,$e[Je],$e[Je+1]);$e[Je]=tt.left,$e[Je+1]=tt.right},decryptBlock:function($e,Je){var tt=function he($e,Je,tt){let mt,Ie=Je,Le=tt;for(let at=He+1;at>1;--at)Ie^=$e.pbox[at],Le=xe($e,Ie)^Le,mt=Ie,Ie=Le,Le=mt;return mt=Ie,Ie=Le,Le=mt,Le^=$e.pbox[1],Ie^=$e.pbox[0],{left:Ie,right:Le}}(ce,$e[Je],$e[Je+1]);$e[Je]=tt.left,$e[Je+1]=tt.right},blockSize:2,keySize:4,ivSize:2});ie.Blowfish=h._createHelper(ke)}(),W.Blowfish)},3270:function(kn,an,Ve){var fe,h,Me,He,rt,se,xe,he,_e,$e,Je,tt,Le,at,kt,fn,lt,pn,W;kn.exports=(W=Ve(12),Ve(2066),void(W.lib.Cipher||(fe=W,h=fe.lib,Me=h.Base,He=h.WordArray,rt=h.BufferedBlockAlgorithm,se=fe.enc,xe=se.Base64,he=fe.algo.EvpKDF,_e=h.Cipher=rt.extend({cfg:Me.extend(),createEncryptor:function(Lt,nn){return this.create(this._ENC_XFORM_MODE,Lt,nn)},createDecryptor:function(Lt,nn){return this.create(this._DEC_XFORM_MODE,Lt,nn)},init:function(Lt,nn,wn){this.cfg=this.cfg.extend(wn),this._xformMode=Lt,this._key=nn,this.reset()},reset:function(){rt.reset.call(this),this._doReset()},process:function(Lt){return this._append(Lt),this._process()},finalize:function(Lt){return Lt&&this._append(Lt),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function Lt(nn){return"string"==typeof nn?pn:fn}return function(nn){return{encrypt:function(wn,Rt,Jn){return Lt(Rt).encrypt(nn,wn,Rt,Jn)},decrypt:function(wn,Rt,Jn){return Lt(Rt).decrypt(nn,wn,Rt,Jn)}}}}()}),h.StreamCipher=_e.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),$e=fe.mode={},Je=h.BlockCipherMode=Me.extend({createEncryptor:function(Lt,nn){return this.Encryptor.create(Lt,nn)},createDecryptor:function(Lt,nn){return this.Decryptor.create(Lt,nn)},init:function(Lt,nn){this._cipher=Lt,this._iv=nn}}),tt=$e.CBC=function(){var Lt=Je.extend();function nn(wn,Rt,Jn){var Kt,Hn=this._iv;Hn?(Kt=Hn,this._iv=undefined):Kt=this._prevBlock;for(var yi=0;yi<Jn;yi++)wn[Rt+yi]^=Kt[yi]}return Lt.Encryptor=Lt.extend({processBlock:function(wn,Rt){var Jn=this._cipher,Kt=Jn.blockSize;nn.call(this,wn,Rt,Kt),Jn.encryptBlock(wn,Rt),this._prevBlock=wn.slice(Rt,Rt+Kt)}}),Lt.Decryptor=Lt.extend({processBlock:function(wn,Rt){var Jn=this._cipher,Kt=Jn.blockSize,Hn=wn.slice(Rt,Rt+Kt);Jn.decryptBlock(wn,Rt),nn.call(this,wn,Rt,Kt),this._prevBlock=Hn}}),Lt}(),Le=(fe.pad={}).Pkcs7={pad:function(Lt,nn){for(var wn=4*nn,Rt=wn-Lt.sigBytes%wn,Jn=Rt<<24|Rt<<16|Rt<<8|Rt,Kt=[],Hn=0;Hn<Rt;Hn+=4)Kt.push(Jn);var yi=He.create(Kt,Rt);Lt.concat(yi)},unpad:function(Lt){Lt.sigBytes-=255&Lt.words[Lt.sigBytes-1>>>2]}},h.BlockCipher=_e.extend({cfg:_e.cfg.extend({mode:tt,padding:Le}),reset:function(){var Lt;_e.reset.call(this);var nn=this.cfg,wn=nn.iv,Rt=nn.mode;this._xformMode==this._ENC_XFORM_MODE?Lt=Rt.createEncryptor:(Lt=Rt.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==Lt?this._mode.init(this,wn&&wn.words):(this._mode=Lt.call(Rt,this,wn&&wn.words),this._mode.__creator=Lt)},_doProcessBlock:function(Lt,nn){this._mode.processBlock(Lt,nn)},_doFinalize:function(){var Lt,nn=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(nn.pad(this._data,this.blockSize),Lt=this._process(!0)):(Lt=this._process(!0),nn.unpad(Lt)),Lt},blockSize:4}),at=h.CipherParams=Me.extend({init:function(Lt){this.mixIn(Lt)},toString:function(Lt){return(Lt||this.formatter).stringify(this)}}),kt=(fe.format={}).OpenSSL={stringify:function(Lt){var wn=Lt.ciphertext,Rt=Lt.salt;return(Rt?He.create([1398893684,1701076831]).concat(Rt).concat(wn):wn).toString(xe)},parse:function(Lt){var nn,wn=xe.parse(Lt),Rt=wn.words;return 1398893684==Rt[0]&&1701076831==Rt[1]&&(nn=He.create(Rt.slice(2,4)),Rt.splice(0,4),wn.sigBytes-=16),at.create({ciphertext:wn,salt:nn})}},fn=h.SerializableCipher=Me.extend({cfg:Me.extend({format:kt}),encrypt:function(Lt,nn,wn,Rt){Rt=this.cfg.extend(Rt);var Jn=Lt.createEncryptor(wn,Rt),Kt=Jn.finalize(nn),Hn=Jn.cfg;return at.create({ciphertext:Kt,key:wn,iv:Hn.iv,algorithm:Lt,mode:Hn.mode,padding:Hn.padding,blockSize:Lt.blockSize,formatter:Rt.format})},decrypt:function(Lt,nn,wn,Rt){return Rt=this.cfg.extend(Rt),nn=this._parse(nn,Rt.format),Lt.createDecryptor(wn,Rt).finalize(nn.ciphertext)},_parse:function(Lt,nn){return"string"==typeof Lt?nn.parse(Lt,this):Lt}}),lt=(fe.kdf={}).OpenSSL={execute:function(Lt,nn,wn,Rt,Jn){if(Rt||(Rt=He.random(8)),Jn)var Kt=he.create({keySize:nn+wn,hasher:Jn}).compute(Lt,Rt);else Kt=he.create({keySize:nn+wn}).compute(Lt,Rt);var Hn=He.create(Kt.words.slice(nn),4*wn);return Kt.sigBytes=4*nn,at.create({key:Kt,iv:Hn,salt:Rt})}},pn=h.PasswordBasedCipher=fn.extend({cfg:fn.cfg.extend({kdf:lt}),encrypt:function(Lt,nn,wn,Rt){var Jn=(Rt=this.cfg.extend(Rt)).kdf.execute(wn,Lt.keySize,Lt.ivSize,Rt.salt,Rt.hasher);Rt.iv=Jn.iv;var Kt=fn.encrypt.call(this,Lt,nn,Jn.key,Rt);return Kt.mixIn(Jn),Kt},decrypt:function(Lt,nn,wn,Rt){Rt=this.cfg.extend(Rt),nn=this._parse(nn,Rt.format);var Jn=Rt.kdf.execute(wn,Lt.keySize,Lt.ivSize,nn.salt,Rt.hasher);return Rt.iv=Jn.iv,fn.decrypt.call(this,Lt,nn,Jn.key,Rt)}}))))},12:function(kn,an,Ve){var W;kn.exports=(W=W||function(ie,fe){var h;if(typeof window<"u"&&window.crypto&&(h=window.crypto),typeof self<"u"&&self.crypto&&(h=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(h=globalThis.crypto),!h&&typeof window<"u"&&window.msCrypto&&(h=window.msCrypto),!h&&typeof global<"u"&&global.crypto&&(h=global.crypto),!h)try{h=Ve(2480)}catch{}var Me=function(){if(h){if("function"==typeof h.getRandomValues)try{return h.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof h.randomBytes)try{return h.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},He=Object.create||function(){function Ie(){}return function(Le){var mt;return Ie.prototype=Le,mt=new Ie,Ie.prototype=null,mt}}(),rt={},se=rt.lib={},ce=se.Base={extend:function(Ie){var Le=He(this);return Ie&&Le.mixIn(Ie),(!Le.hasOwnProperty("init")||this.init===Le.init)&&(Le.init=function(){Le.$super.init.apply(this,arguments)}),Le.init.prototype=Le,Le.$super=this,Le},create:function(){var Ie=this.extend();return Ie.init.apply(Ie,arguments),Ie},init:function(){},mixIn:function(Ie){for(var Le in Ie)Ie.hasOwnProperty(Le)&&(this[Le]=Ie[Le]);Ie.hasOwnProperty("toString")&&(this.toString=Ie.toString)},clone:function(){return this.init.prototype.extend(this)}},xe=se.WordArray=ce.extend({init:function(Ie,Le){Ie=this.words=Ie||[],this.sigBytes=null!=Le?Le:4*Ie.length},toString:function(Ie){return(Ie||he).stringify(this)},concat:function(Ie){var Le=this.words,mt=Ie.words,at=this.sigBytes,ze=Ie.sigBytes;if(this.clamp(),at%4)for(var kt=0;kt<ze;kt++)Le[at+kt>>>2]|=(mt[kt>>>2]>>>24-kt%4*8&255)<<24-(at+kt)%4*8;else for(var xt=0;xt<ze;xt+=4)Le[at+xt>>>2]=mt[xt>>>2];return this.sigBytes+=ze,this},clamp:function(){var Ie=this.words,Le=this.sigBytes;Ie[Le>>>2]&=4294967295<<32-Le%4*8,Ie.length=ie.ceil(Le/4)},clone:function(){var Ie=ce.clone.call(this);return Ie.words=this.words.slice(0),Ie},random:function(Ie){for(var Le=[],mt=0;mt<Ie;mt+=4)Le.push(Me());return new xe.init(Le,Ie)}}),ae=rt.enc={},he=ae.Hex={stringify:function(Ie){for(var Le=Ie.words,mt=Ie.sigBytes,at=[],ze=0;ze<mt;ze++){var kt=Le[ze>>>2]>>>24-ze%4*8&255;at.push((kt>>>4).toString(16)),at.push((15&kt).toString(16))}return at.join("")},parse:function(Ie){for(var Le=Ie.length,mt=[],at=0;at<Le;at+=2)mt[at>>>3]|=parseInt(Ie.substr(at,2),16)<<24-at%8*4;return new xe.init(mt,Le/2)}},_e=ae.Latin1={stringify:function(Ie){for(var Le=Ie.words,mt=Ie.sigBytes,at=[],ze=0;ze<mt;ze++)at.push(String.fromCharCode(Le[ze>>>2]>>>24-ze%4*8&255));return at.join("")},parse:function(Ie){for(var Le=Ie.length,mt=[],at=0;at<Le;at++)mt[at>>>2]|=(255&Ie.charCodeAt(at))<<24-at%4*8;return new xe.init(mt,Le)}},ke=ae.Utf8={stringify:function(Ie){try{return decodeURIComponent(escape(_e.stringify(Ie)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(Ie){return _e.parse(unescape(encodeURIComponent(Ie)))}},$e=se.BufferedBlockAlgorithm=ce.extend({reset:function(){this._data=new xe.init,this._nDataBytes=0},_append:function(Ie){"string"==typeof Ie&&(Ie=ke.parse(Ie)),this._data.concat(Ie),this._nDataBytes+=Ie.sigBytes},_process:function(Ie){var Le,mt=this._data,at=mt.words,ze=mt.sigBytes,kt=this.blockSize,xt=ze/(4*kt),lt=(xt=Ie?ie.ceil(xt):ie.max((0|xt)-this._minBufferSize,0))*kt,pn=ie.min(4*lt,ze);if(lt){for(var Lt=0;Lt<lt;Lt+=kt)this._doProcessBlock(at,Lt);Le=at.splice(0,lt),mt.sigBytes-=pn}return new xe.init(Le,pn)},clone:function(){var Ie=ce.clone.call(this);return Ie._data=this._data.clone(),Ie},_minBufferSize:0}),tt=(se.Hasher=$e.extend({cfg:ce.extend(),init:function(Ie){this.cfg=this.cfg.extend(Ie),this.reset()},reset:function(){$e.reset.call(this),this._doReset()},update:function(Ie){return this._append(Ie),this._process(),this},finalize:function(Ie){return Ie&&this._append(Ie),this._doFinalize()},blockSize:16,_createHelper:function(Ie){return function(Le,mt){return new Ie.init(mt).finalize(Le)}},_createHmacHelper:function(Ie){return function(Le,mt){return new tt.HMAC.init(Ie,mt).finalize(Le)}}}),rt.algo={});return rt}(Math),W)},5506:function(kn,an,Ve){var W,h;kn.exports=(W=Ve(12),h=W.lib.WordArray,W.enc.Base64={stringify:function(se){var ce=se.words,xe=se.sigBytes,ae=this._map;se.clamp();for(var he=[],_e=0;_e<xe;_e+=3)for(var tt=(ce[_e>>>2]>>>24-_e%4*8&255)<<16|(ce[_e+1>>>2]>>>24-(_e+1)%4*8&255)<<8|ce[_e+2>>>2]>>>24-(_e+2)%4*8&255,Ie=0;Ie<4&&_e+.75*Ie<xe;Ie++)he.push(ae.charAt(tt>>>6*(3-Ie)&63));var Le=ae.charAt(64);if(Le)for(;he.length%4;)he.push(Le);return he.join("")},parse:function(se){var ce=se.length,xe=this._map,ae=this._reverseMap;if(!ae){ae=this._reverseMap=[];for(var he=0;he<xe.length;he++)ae[xe.charCodeAt(he)]=he}var _e=xe.charAt(64);if(_e){var ke=se.indexOf(_e);-1!==ke&&(ce=ke)}return function rt(se,ce,xe){for(var ae=[],he=0,_e=0;_e<ce;_e++)if(_e%4){var ke=xe[se.charCodeAt(_e-1)]<<_e%4*2,$e=xe[se.charCodeAt(_e)]>>>6-_e%4*2;ae[he>>>2]|=(ke|$e)<<24-he%4*8,he++}return h.create(ae,he)}(se,ce,ae)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},W.enc.Base64)},7523:function(kn,an,Ve){var W,h;kn.exports=(W=Ve(12),h=W.lib.WordArray,W.enc.Base64url={stringify:function(se,ce){void 0===ce&&(ce=!0);var xe=se.words,ae=se.sigBytes,he=ce?this._safe_map:this._map;se.clamp();for(var _e=[],ke=0;ke<ae;ke+=3)for(var Ie=(xe[ke>>>2]>>>24-ke%4*8&255)<<16|(xe[ke+1>>>2]>>>24-(ke+1)%4*8&255)<<8|xe[ke+2>>>2]>>>24-(ke+2)%4*8&255,Le=0;Le<4&&ke+.75*Le<ae;Le++)_e.push(he.charAt(Ie>>>6*(3-Le)&63));var mt=he.charAt(64);if(mt)for(;_e.length%4;)_e.push(mt);return _e.join("")},parse:function(se,ce){void 0===ce&&(ce=!0);var xe=se.length,ae=ce?this._safe_map:this._map,he=this._reverseMap;if(!he){he=this._reverseMap=[];for(var _e=0;_e<ae.length;_e++)he[ae.charCodeAt(_e)]=_e}var ke=ae.charAt(64);if(ke){var $e=se.indexOf(ke);-1!==$e&&(xe=$e)}return function rt(se,ce,xe){for(var ae=[],he=0,_e=0;_e<ce;_e++)if(_e%4){var ke=xe[se.charCodeAt(_e-1)]<<_e%4*2,$e=xe[se.charCodeAt(_e)]>>>6-_e%4*2;ae[he>>>2]|=(ke|$e)<<24-he%4*8,he++}return h.create(ae,he)}(se,xe,he)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"},W.enc.Base64url)},2454:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),function(){var h=W.lib.WordArray,Me=W.enc;function rt(se){return se<<8&4278255360|se>>>8&16711935}Me.Utf16=Me.Utf16BE={stringify:function(se){for(var ce=se.words,xe=se.sigBytes,ae=[],he=0;he<xe;he+=2)ae.push(String.fromCharCode(ce[he>>>2]>>>16-he%4*8&65535));return ae.join("")},parse:function(se){for(var ce=se.length,xe=[],ae=0;ae<ce;ae++)xe[ae>>>1]|=se.charCodeAt(ae)<<16-ae%2*16;return h.create(xe,2*ce)}},Me.Utf16LE={stringify:function(se){for(var ce=se.words,xe=se.sigBytes,ae=[],he=0;he<xe;he+=2){var _e=rt(ce[he>>>2]>>>16-he%4*8&65535);ae.push(String.fromCharCode(_e))}return ae.join("")},parse:function(se){for(var ce=se.length,xe=[],ae=0;ae<ce;ae++)xe[ae>>>1]|=rt(se.charCodeAt(ae)<<16-ae%2*16);return h.create(xe,2*ce)}}}(),W.enc.Utf16)},2066:function(kn,an,Ve){var ie,fe,h,Me,He,se,W;kn.exports=(W=Ve(12),Ve(4446),Ve(990),Me=(fe=(ie=W).lib).WordArray,se=(He=ie.algo).EvpKDF=(h=fe.Base).extend({cfg:h.extend({keySize:4,hasher:He.MD5,iterations:1}),init:function(ce){this.cfg=this.cfg.extend(ce)},compute:function(ce,xe){for(var ae,he=this.cfg,_e=he.hasher.create(),ke=Me.create(),$e=ke.words,Je=he.keySize,tt=he.iterations;$e.length<Je;){ae&&_e.update(ae),ae=_e.update(ce).finalize(xe),_e.reset();for(var Ie=1;Ie<tt;Ie++)ae=_e.finalize(ae),_e.reset();ke.concat(ae)}return ke.sigBytes=4*Je,ke}}),ie.EvpKDF=function(ce,xe,ae){return se.create(ae).compute(ce,xe)},W.EvpKDF)},2826:function(kn,an,Ve){var W,Me,rt;kn.exports=(W=Ve(12),Ve(3270),Me=W.lib.CipherParams,rt=W.enc.Hex,W.format.Hex={stringify:function(xe){return xe.ciphertext.toString(rt)},parse:function(xe){var ae=rt.parse(xe);return Me.create({ciphertext:ae})}},W.format.Hex)},990:function(kn,an,Ve){var W,He;kn.exports=(W=Ve(12),He=W.enc.Utf8,void(W.algo.HMAC=W.lib.Base.extend({init:function(ce,xe){ce=this._hasher=new ce.init,"string"==typeof xe&&(xe=He.parse(xe));var ae=ce.blockSize,he=4*ae;xe.sigBytes>he&&(xe=ce.finalize(xe)),xe.clamp();for(var _e=this._oKey=xe.clone(),ke=this._iKey=xe.clone(),$e=_e.words,Je=ke.words,tt=0;tt<ae;tt++)$e[tt]^=1549556828,Je[tt]^=909522486;_e.sigBytes=ke.sigBytes=he,this.reset()},reset:function(){var ce=this._hasher;ce.reset(),ce.update(this._iKey)},update:function(ce){return this._hasher.update(ce),this},finalize:function(ce){var xe=this._hasher,ae=xe.finalize(ce);return xe.reset(),xe.finalize(this._oKey.clone().concat(ae))}})))},7874:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(1802),Ve(4037),Ve(2454),Ve(5506),Ve(7523),Ve(2873),Ve(4446),Ve(2078),Ve(9811),Ve(4870),Ve(2913),Ve(6545),Ve(5558),Ve(990),Ve(3538),Ve(2066),Ve(3270),Ve(5228),Ve(3392),Ve(3584),Ve(2015),Ve(5594),Ve(7237),Ve(8501),Ve(4004),Ve(3297),Ve(2738),Ve(2826),Ve(8042),Ve(5769),Ve(1195),Ve(4969),Ve(7848),Ve(9172),W)},4037:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),function(){if("function"==typeof ArrayBuffer){var h=W.lib.WordArray,Me=h.init,He=h.init=function(rt){if(rt instanceof ArrayBuffer&&(rt=new Uint8Array(rt)),(rt instanceof Int8Array||typeof Uint8ClampedArray<"u"&&rt instanceof Uint8ClampedArray||rt instanceof Int16Array||rt instanceof Uint16Array||rt instanceof Int32Array||rt instanceof Uint32Array||rt instanceof Float32Array||rt instanceof Float64Array)&&(rt=new Uint8Array(rt.buffer,rt.byteOffset,rt.byteLength)),rt instanceof Uint8Array){for(var se=rt.byteLength,ce=[],xe=0;xe<se;xe++)ce[xe>>>2]|=rt[xe]<<24-xe%4*8;Me.call(this,ce,se)}else Me.apply(this,arguments)};He.prototype=h}}(),W.lib.WordArray)},2873:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),function(ie){var fe=W,h=fe.lib,Me=h.WordArray,He=h.Hasher,rt=fe.algo,se=[];!function(){for(var ke=0;ke<64;ke++)se[ke]=4294967296*ie.abs(ie.sin(ke+1))|0}();var ce=rt.MD5=He.extend({_doReset:function(){this._hash=new Me.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(ke,$e){for(var Je=0;Je<16;Je++){var tt=$e+Je,Ie=ke[tt];ke[tt]=16711935&(Ie<<8|Ie>>>24)|4278255360&(Ie<<24|Ie>>>8)}var Le=this._hash.words,mt=ke[$e+0],at=ke[$e+1],ze=ke[$e+2],kt=ke[$e+3],fn=ke[$e+4],xt=ke[$e+5],lt=ke[$e+6],pn=ke[$e+7],Lt=ke[$e+8],nn=ke[$e+9],wn=ke[$e+10],Rt=ke[$e+11],Jn=ke[$e+12],Kt=ke[$e+13],Hn=ke[$e+14],yi=ke[$e+15],Pe=Le[0],qe=Le[1],Oe=Le[2],Ue=Le[3];Pe=xe(Pe,qe,Oe,Ue,mt,7,se[0]),Ue=xe(Ue,Pe,qe,Oe,at,12,se[1]),Oe=xe(Oe,Ue,Pe,qe,ze,17,se[2]),qe=xe(qe,Oe,Ue,Pe,kt,22,se[3]),Pe=xe(Pe,qe,Oe,Ue,fn,7,se[4]),Ue=xe(Ue,Pe,qe,Oe,xt,12,se[5]),Oe=xe(Oe,Ue,Pe,qe,lt,17,se[6]),qe=xe(qe,Oe,Ue,Pe,pn,22,se[7]),Pe=xe(Pe,qe,Oe,Ue,Lt,7,se[8]),Ue=xe(Ue,Pe,qe,Oe,nn,12,se[9]),Oe=xe(Oe,Ue,Pe,qe,wn,17,se[10]),qe=xe(qe,Oe,Ue,Pe,Rt,22,se[11]),Pe=xe(Pe,qe,Oe,Ue,Jn,7,se[12]),Ue=xe(Ue,Pe,qe,Oe,Kt,12,se[13]),Oe=xe(Oe,Ue,Pe,qe,Hn,17,se[14]),Pe=ae(Pe,qe=xe(qe,Oe,Ue,Pe,yi,22,se[15]),Oe,Ue,at,5,se[16]),Ue=ae(Ue,Pe,qe,Oe,lt,9,se[17]),Oe=ae(Oe,Ue,Pe,qe,Rt,14,se[18]),qe=ae(qe,Oe,Ue,Pe,mt,20,se[19]),Pe=ae(Pe,qe,Oe,Ue,xt,5,se[20]),Ue=ae(Ue,Pe,qe,Oe,wn,9,se[21]),Oe=ae(Oe,Ue,Pe,qe,yi,14,se[22]),qe=ae(qe,Oe,Ue,Pe,fn,20,se[23]),Pe=ae(Pe,qe,Oe,Ue,nn,5,se[24]),Ue=ae(Ue,Pe,qe,Oe,Hn,9,se[25]),Oe=ae(Oe,Ue,Pe,qe,kt,14,se[26]),qe=ae(qe,Oe,Ue,Pe,Lt,20,se[27]),Pe=ae(Pe,qe,Oe,Ue,Kt,5,se[28]),Ue=ae(Ue,Pe,qe,Oe,ze,9,se[29]),Oe=ae(Oe,Ue,Pe,qe,pn,14,se[30]),Pe=he(Pe,qe=ae(qe,Oe,Ue,Pe,Jn,20,se[31]),Oe,Ue,xt,4,se[32]),Ue=he(Ue,Pe,qe,Oe,Lt,11,se[33]),Oe=he(Oe,Ue,Pe,qe,Rt,16,se[34]),qe=he(qe,Oe,Ue,Pe,Hn,23,se[35]),Pe=he(Pe,qe,Oe,Ue,at,4,se[36]),Ue=he(Ue,Pe,qe,Oe,fn,11,se[37]),Oe=he(Oe,Ue,Pe,qe,pn,16,se[38]),qe=he(qe,Oe,Ue,Pe,wn,23,se[39]),Pe=he(Pe,qe,Oe,Ue,Kt,4,se[40]),Ue=he(Ue,Pe,qe,Oe,mt,11,se[41]),Oe=he(Oe,Ue,Pe,qe,kt,16,se[42]),qe=he(qe,Oe,Ue,Pe,lt,23,se[43]),Pe=he(Pe,qe,Oe,Ue,nn,4,se[44]),Ue=he(Ue,Pe,qe,Oe,Jn,11,se[45]),Oe=he(Oe,Ue,Pe,qe,yi,16,se[46]),Pe=_e(Pe,qe=he(qe,Oe,Ue,Pe,ze,23,se[47]),Oe,Ue,mt,6,se[48]),Ue=_e(Ue,Pe,qe,Oe,pn,10,se[49]),Oe=_e(Oe,Ue,Pe,qe,Hn,15,se[50]),qe=_e(qe,Oe,Ue,Pe,xt,21,se[51]),Pe=_e(Pe,qe,Oe,Ue,Jn,6,se[52]),Ue=_e(Ue,Pe,qe,Oe,kt,10,se[53]),Oe=_e(Oe,Ue,Pe,qe,wn,15,se[54]),qe=_e(qe,Oe,Ue,Pe,at,21,se[55]),Pe=_e(Pe,qe,Oe,Ue,Lt,6,se[56]),Ue=_e(Ue,Pe,qe,Oe,yi,10,se[57]),Oe=_e(Oe,Ue,Pe,qe,lt,15,se[58]),qe=_e(qe,Oe,Ue,Pe,Kt,21,se[59]),Pe=_e(Pe,qe,Oe,Ue,fn,6,se[60]),Ue=_e(Ue,Pe,qe,Oe,Rt,10,se[61]),Oe=_e(Oe,Ue,Pe,qe,ze,15,se[62]),qe=_e(qe,Oe,Ue,Pe,nn,21,se[63]),Le[0]=Le[0]+Pe|0,Le[1]=Le[1]+qe|0,Le[2]=Le[2]+Oe|0,Le[3]=Le[3]+Ue|0},_doFinalize:function(){var ke=this._data,$e=ke.words,Je=8*this._nDataBytes,tt=8*ke.sigBytes;$e[tt>>>5]|=128<<24-tt%32;var Ie=ie.floor(Je/4294967296),Le=Je;$e[15+(tt+64>>>9<<4)]=16711935&(Ie<<8|Ie>>>24)|4278255360&(Ie<<24|Ie>>>8),$e[14+(tt+64>>>9<<4)]=16711935&(Le<<8|Le>>>24)|4278255360&(Le<<24|Le>>>8),ke.sigBytes=4*($e.length+1),this._process();for(var mt=this._hash,at=mt.words,ze=0;ze<4;ze++){var kt=at[ze];at[ze]=16711935&(kt<<8|kt>>>24)|4278255360&(kt<<24|kt>>>8)}return mt},clone:function(){var ke=He.clone.call(this);return ke._hash=this._hash.clone(),ke}});function xe(ke,$e,Je,tt,Ie,Le,mt){var at=ke+($e&Je|~$e&tt)+Ie+mt;return(at<<Le|at>>>32-Le)+$e}function ae(ke,$e,Je,tt,Ie,Le,mt){var at=ke+($e&tt|Je&~tt)+Ie+mt;return(at<<Le|at>>>32-Le)+$e}function he(ke,$e,Je,tt,Ie,Le,mt){var at=ke+($e^Je^tt)+Ie+mt;return(at<<Le|at>>>32-Le)+$e}function _e(ke,$e,Je,tt,Ie,Le,mt){var at=ke+(Je^($e|~tt))+Ie+mt;return(at<<Le|at>>>32-Le)+$e}fe.MD5=He._createHelper(ce),fe.HmacMD5=He._createHmacHelper(ce)}(Math),W.MD5)},5228:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(3270),W.mode.CFB=function(){var ie=W.lib.BlockCipherMode.extend();function fe(h,Me,He,rt){var se,ce=this._iv;ce?(se=ce.slice(0),this._iv=void 0):se=this._prevBlock,rt.encryptBlock(se,0);for(var xe=0;xe<He;xe++)h[Me+xe]^=se[xe]}return ie.Encryptor=ie.extend({processBlock:function(h,Me){var He=this._cipher,rt=He.blockSize;fe.call(this,h,Me,rt,He),this._prevBlock=h.slice(Me,Me+rt)}}),ie.Decryptor=ie.extend({processBlock:function(h,Me){var He=this._cipher,rt=He.blockSize,se=h.slice(Me,Me+rt);fe.call(this,h,Me,rt,He),this._prevBlock=se}}),ie}(),W.mode.CFB)},3584:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(3270),W.mode.CTRGladman=function(){var ie=W.lib.BlockCipherMode.extend();function fe(He){if(255==(He>>24&255)){var rt=He>>16&255,se=He>>8&255,ce=255&He;255===rt?(rt=0,255===se?(se=0,255===ce?ce=0:++ce):++se):++rt,He=0,He+=rt<<16,He+=se<<8,He+=ce}else He+=1<<24;return He}var Me=ie.Encryptor=ie.extend({processBlock:function(He,rt){var se=this._cipher,ce=se.blockSize,xe=this._iv,ae=this._counter;xe&&(ae=this._counter=xe.slice(0),this._iv=void 0),function h(He){return 0===(He[0]=fe(He[0]))&&(He[1]=fe(He[1])),He}(ae);var he=ae.slice(0);se.encryptBlock(he,0);for(var _e=0;_e<ce;_e++)He[rt+_e]^=he[_e]}});return ie.Decryptor=Me,ie}(),W.mode.CTRGladman)},3392:function(kn,an,Ve){var ie,fe,W;kn.exports=(W=Ve(12),Ve(3270),W.mode.CTR=(fe=(ie=W.lib.BlockCipherMode.extend()).Encryptor=ie.extend({processBlock:function(h,Me){var He=this._cipher,rt=He.blockSize,se=this._iv,ce=this._counter;se&&(ce=this._counter=se.slice(0),this._iv=void 0);var xe=ce.slice(0);He.encryptBlock(xe,0),ce[rt-1]=ce[rt-1]+1|0;for(var ae=0;ae<rt;ae++)h[Me+ae]^=xe[ae]}}),ie.Decryptor=fe,ie),W.mode.CTR)},5594:function(kn,an,Ve){var ie,W;kn.exports=(W=Ve(12),Ve(3270),W.mode.ECB=((ie=W.lib.BlockCipherMode.extend()).Encryptor=ie.extend({processBlock:function(fe,h){this._cipher.encryptBlock(fe,h)}}),ie.Decryptor=ie.extend({processBlock:function(fe,h){this._cipher.decryptBlock(fe,h)}}),ie),W.mode.ECB)},2015:function(kn,an,Ve){var ie,fe,W;kn.exports=(W=Ve(12),Ve(3270),W.mode.OFB=(fe=(ie=W.lib.BlockCipherMode.extend()).Encryptor=ie.extend({processBlock:function(h,Me){var He=this._cipher,rt=He.blockSize,se=this._iv,ce=this._keystream;se&&(ce=this._keystream=se.slice(0),this._iv=void 0),He.encryptBlock(ce,0);for(var xe=0;xe<rt;xe++)h[Me+xe]^=ce[xe]}}),ie.Decryptor=fe,ie),W.mode.OFB)},7237:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(3270),W.pad.AnsiX923={pad:function(ie,fe){var h=ie.sigBytes,Me=4*fe,He=Me-h%Me,rt=h+He-1;ie.clamp(),ie.words[rt>>>2]|=He<<24-rt%4*8,ie.sigBytes+=He},unpad:function(ie){ie.sigBytes-=255&ie.words[ie.sigBytes-1>>>2]}},W.pad.Ansix923)},8501:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(3270),W.pad.Iso10126={pad:function(ie,fe){var h=4*fe,Me=h-ie.sigBytes%h;ie.concat(W.lib.WordArray.random(Me-1)).concat(W.lib.WordArray.create([Me<<24],1))},unpad:function(ie){ie.sigBytes-=255&ie.words[ie.sigBytes-1>>>2]}},W.pad.Iso10126)},4004:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(3270),W.pad.Iso97971={pad:function(ie,fe){ie.concat(W.lib.WordArray.create([2147483648],1)),W.pad.ZeroPadding.pad(ie,fe)},unpad:function(ie){W.pad.ZeroPadding.unpad(ie),ie.sigBytes--}},W.pad.Iso97971)},2738:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(3270),W.pad.NoPadding={pad:function(){},unpad:function(){}},W.pad.NoPadding)},3297:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(3270),W.pad.ZeroPadding={pad:function(ie,fe){var h=4*fe;ie.clamp(),ie.sigBytes+=h-(ie.sigBytes%h||h)},unpad:function(ie){var fe=ie.words,h=ie.sigBytes-1;for(h=ie.sigBytes-1;h>=0;h--)if(fe[h>>>2]>>>24-h%4*8&255){ie.sigBytes=h+1;break}}},W.pad.ZeroPadding)},3538:function(kn,an,Ve){var ie,fe,h,Me,He,se,ce,W;kn.exports=(W=Ve(12),Ve(2078),Ve(990),Me=(fe=(ie=W).lib).WordArray,se=(He=ie.algo).HMAC,ce=He.PBKDF2=(h=fe.Base).extend({cfg:h.extend({keySize:4,hasher:He.SHA256,iterations:25e4}),init:function(xe){this.cfg=this.cfg.extend(xe)},compute:function(xe,ae){for(var he=this.cfg,_e=se.create(he.hasher,xe),ke=Me.create(),$e=Me.create([1]),Je=ke.words,tt=$e.words,Ie=he.keySize,Le=he.iterations;Je.length<Ie;){var mt=_e.update(ae).finalize($e);_e.reset();for(var at=mt.words,ze=at.length,kt=mt,fn=1;fn<Le;fn++){kt=_e.finalize(kt),_e.reset();for(var xt=kt.words,lt=0;lt<ze;lt++)at[lt]^=xt[lt]}ke.concat(mt),tt[0]++}return ke.sigBytes=4*Ie,ke}}),ie.PBKDF2=function(xe,ae,he){return ce.create(he).compute(xe,ae)},W.PBKDF2)},7848:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(5506),Ve(2873),Ve(2066),Ve(3270),function(){var ie=W,h=ie.lib.StreamCipher,He=[],rt=[],se=[],ce=ie.algo.RabbitLegacy=h.extend({_doReset:function(){var ae=this._key.words,he=this.cfg.iv,_e=this._X=[ae[0],ae[3]<<16|ae[2]>>>16,ae[1],ae[0]<<16|ae[3]>>>16,ae[2],ae[1]<<16|ae[0]>>>16,ae[3],ae[2]<<16|ae[1]>>>16],ke=this._C=[ae[2]<<16|ae[2]>>>16,4294901760&ae[0]|65535&ae[1],ae[3]<<16|ae[3]>>>16,4294901760&ae[1]|65535&ae[2],ae[0]<<16|ae[0]>>>16,4294901760&ae[2]|65535&ae[3],ae[1]<<16|ae[1]>>>16,4294901760&ae[3]|65535&ae[0]];this._b=0;for(var $e=0;$e<4;$e++)xe.call(this);for($e=0;$e<8;$e++)ke[$e]^=_e[$e+4&7];if(he){var Je=he.words,tt=Je[0],Ie=Je[1],Le=16711935&(tt<<8|tt>>>24)|4278255360&(tt<<24|tt>>>8),mt=16711935&(Ie<<8|Ie>>>24)|4278255360&(Ie<<24|Ie>>>8),at=Le>>>16|4294901760&mt,ze=mt<<16|65535&Le;for(ke[0]^=Le,ke[1]^=at,ke[2]^=mt,ke[3]^=ze,ke[4]^=Le,ke[5]^=at,ke[6]^=mt,ke[7]^=ze,$e=0;$e<4;$e++)xe.call(this)}},_doProcessBlock:function(ae,he){var _e=this._X;xe.call(this),He[0]=_e[0]^_e[5]>>>16^_e[3]<<16,He[1]=_e[2]^_e[7]>>>16^_e[5]<<16,He[2]=_e[4]^_e[1]>>>16^_e[7]<<16,He[3]=_e[6]^_e[3]>>>16^_e[1]<<16;for(var ke=0;ke<4;ke++)He[ke]=16711935&(He[ke]<<8|He[ke]>>>24)|4278255360&(He[ke]<<24|He[ke]>>>8),ae[he+ke]^=He[ke]},blockSize:4,ivSize:2});function xe(){for(var ae=this._X,he=this._C,_e=0;_e<8;_e++)rt[_e]=he[_e];for(he[0]=he[0]+1295307597+this._b|0,he[1]=he[1]+3545052371+(he[0]>>>0<rt[0]>>>0?1:0)|0,he[2]=he[2]+886263092+(he[1]>>>0<rt[1]>>>0?1:0)|0,he[3]=he[3]+1295307597+(he[2]>>>0<rt[2]>>>0?1:0)|0,he[4]=he[4]+3545052371+(he[3]>>>0<rt[3]>>>0?1:0)|0,he[5]=he[5]+886263092+(he[4]>>>0<rt[4]>>>0?1:0)|0,he[6]=he[6]+1295307597+(he[5]>>>0<rt[5]>>>0?1:0)|0,he[7]=he[7]+3545052371+(he[6]>>>0<rt[6]>>>0?1:0)|0,this._b=he[7]>>>0<rt[7]>>>0?1:0,_e=0;_e<8;_e++){var ke=ae[_e]+he[_e],$e=65535&ke,Je=ke>>>16;se[_e]=(($e*$e>>>17)+$e*Je>>>15)+Je*Je^((4294901760&ke)*ke|0)+((65535&ke)*ke|0)}ae[0]=se[0]+(se[7]<<16|se[7]>>>16)+(se[6]<<16|se[6]>>>16)|0,ae[1]=se[1]+(se[0]<<8|se[0]>>>24)+se[7]|0,ae[2]=se[2]+(se[1]<<16|se[1]>>>16)+(se[0]<<16|se[0]>>>16)|0,ae[3]=se[3]+(se[2]<<8|se[2]>>>24)+se[1]|0,ae[4]=se[4]+(se[3]<<16|se[3]>>>16)+(se[2]<<16|se[2]>>>16)|0,ae[5]=se[5]+(se[4]<<8|se[4]>>>24)+se[3]|0,ae[6]=se[6]+(se[5]<<16|se[5]>>>16)+(se[4]<<16|se[4]>>>16)|0,ae[7]=se[7]+(se[6]<<8|se[6]>>>24)+se[5]|0}ie.RabbitLegacy=h._createHelper(ce)}(),W.RabbitLegacy)},4969:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(5506),Ve(2873),Ve(2066),Ve(3270),function(){var ie=W,h=ie.lib.StreamCipher,He=[],rt=[],se=[],ce=ie.algo.Rabbit=h.extend({_doReset:function(){for(var ae=this._key.words,he=this.cfg.iv,_e=0;_e<4;_e++)ae[_e]=16711935&(ae[_e]<<8|ae[_e]>>>24)|4278255360&(ae[_e]<<24|ae[_e]>>>8);var ke=this._X=[ae[0],ae[3]<<16|ae[2]>>>16,ae[1],ae[0]<<16|ae[3]>>>16,ae[2],ae[1]<<16|ae[0]>>>16,ae[3],ae[2]<<16|ae[1]>>>16],$e=this._C=[ae[2]<<16|ae[2]>>>16,4294901760&ae[0]|65535&ae[1],ae[3]<<16|ae[3]>>>16,4294901760&ae[1]|65535&ae[2],ae[0]<<16|ae[0]>>>16,4294901760&ae[2]|65535&ae[3],ae[1]<<16|ae[1]>>>16,4294901760&ae[3]|65535&ae[0]];for(this._b=0,_e=0;_e<4;_e++)xe.call(this);for(_e=0;_e<8;_e++)$e[_e]^=ke[_e+4&7];if(he){var Je=he.words,tt=Je[0],Ie=Je[1],Le=16711935&(tt<<8|tt>>>24)|4278255360&(tt<<24|tt>>>8),mt=16711935&(Ie<<8|Ie>>>24)|4278255360&(Ie<<24|Ie>>>8),at=Le>>>16|4294901760&mt,ze=mt<<16|65535&Le;for($e[0]^=Le,$e[1]^=at,$e[2]^=mt,$e[3]^=ze,$e[4]^=Le,$e[5]^=at,$e[6]^=mt,$e[7]^=ze,_e=0;_e<4;_e++)xe.call(this)}},_doProcessBlock:function(ae,he){var _e=this._X;xe.call(this),He[0]=_e[0]^_e[5]>>>16^_e[3]<<16,He[1]=_e[2]^_e[7]>>>16^_e[5]<<16,He[2]=_e[4]^_e[1]>>>16^_e[7]<<16,He[3]=_e[6]^_e[3]>>>16^_e[1]<<16;for(var ke=0;ke<4;ke++)He[ke]=16711935&(He[ke]<<8|He[ke]>>>24)|4278255360&(He[ke]<<24|He[ke]>>>8),ae[he+ke]^=He[ke]},blockSize:4,ivSize:2});function xe(){for(var ae=this._X,he=this._C,_e=0;_e<8;_e++)rt[_e]=he[_e];for(he[0]=he[0]+1295307597+this._b|0,he[1]=he[1]+3545052371+(he[0]>>>0<rt[0]>>>0?1:0)|0,he[2]=he[2]+886263092+(he[1]>>>0<rt[1]>>>0?1:0)|0,he[3]=he[3]+1295307597+(he[2]>>>0<rt[2]>>>0?1:0)|0,he[4]=he[4]+3545052371+(he[3]>>>0<rt[3]>>>0?1:0)|0,he[5]=he[5]+886263092+(he[4]>>>0<rt[4]>>>0?1:0)|0,he[6]=he[6]+1295307597+(he[5]>>>0<rt[5]>>>0?1:0)|0,he[7]=he[7]+3545052371+(he[6]>>>0<rt[6]>>>0?1:0)|0,this._b=he[7]>>>0<rt[7]>>>0?1:0,_e=0;_e<8;_e++){var ke=ae[_e]+he[_e],$e=65535&ke,Je=ke>>>16;se[_e]=(($e*$e>>>17)+$e*Je>>>15)+Je*Je^((4294901760&ke)*ke|0)+((65535&ke)*ke|0)}ae[0]=se[0]+(se[7]<<16|se[7]>>>16)+(se[6]<<16|se[6]>>>16)|0,ae[1]=se[1]+(se[0]<<8|se[0]>>>24)+se[7]|0,ae[2]=se[2]+(se[1]<<16|se[1]>>>16)+(se[0]<<16|se[0]>>>16)|0,ae[3]=se[3]+(se[2]<<8|se[2]>>>24)+se[1]|0,ae[4]=se[4]+(se[3]<<16|se[3]>>>16)+(se[2]<<16|se[2]>>>16)|0,ae[5]=se[5]+(se[4]<<8|se[4]>>>24)+se[3]|0,ae[6]=se[6]+(se[5]<<16|se[5]>>>16)+(se[4]<<16|se[4]>>>16)|0,ae[7]=se[7]+(se[6]<<8|se[6]>>>24)+se[5]|0}ie.Rabbit=h._createHelper(ce)}(),W.Rabbit)},1195:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(5506),Ve(2873),Ve(2066),Ve(3270),function(){var ie=W,h=ie.lib.StreamCipher,Me=ie.algo,He=Me.RC4=h.extend({_doReset:function(){for(var ce=this._key,xe=ce.words,ae=ce.sigBytes,he=this._S=[],_e=0;_e<256;_e++)he[_e]=_e;_e=0;for(var ke=0;_e<256;_e++){var $e=_e%ae,tt=he[_e];he[_e]=he[ke=(ke+he[_e]+(xe[$e>>>2]>>>24-$e%4*8&255))%256],he[ke]=tt}this._i=this._j=0},_doProcessBlock:function(ce,xe){ce[xe]^=rt.call(this)},keySize:8,ivSize:0});function rt(){for(var ce=this._S,xe=this._i,ae=this._j,he=0,_e=0;_e<4;_e++){var ke=ce[xe=(xe+1)%256];ce[xe]=ce[ae=(ae+ce[xe])%256],ce[ae]=ke,he|=ce[(ce[xe]+ce[ae])%256]<<24-8*_e}return this._i=xe,this._j=ae,he}ie.RC4=h._createHelper(He);var se=Me.RC4Drop=He.extend({cfg:He.cfg.extend({drop:192}),_doReset:function(){He._doReset.call(this);for(var ce=this.cfg.drop;ce>0;ce--)rt.call(this)}});ie.RC4Drop=h._createHelper(se)}(),W.RC4)},5558:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),function(ie){var fe=W,h=fe.lib,Me=h.WordArray,He=h.Hasher,rt=fe.algo,se=Me.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),ce=Me.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),xe=Me.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),ae=Me.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),he=Me.create([0,1518500249,1859775393,2400959708,2840853838]),_e=Me.create([1352829926,1548603684,1836072691,2053994217,0]),ke=rt.RIPEMD160=He.extend({_doReset:function(){this._hash=Me.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(at,ze){for(var kt=0;kt<16;kt++){var fn=ze+kt,xt=at[fn];at[fn]=16711935&(xt<<8|xt>>>24)|4278255360&(xt<<24|xt>>>8)}var Kt,Hn,yi,Pe,qe,Oe,Ue,Ft,Ot,_n,Rn,lt=this._hash.words,pn=he.words,Lt=_e.words,nn=se.words,wn=ce.words,Rt=xe.words,Jn=ae.words;for(Oe=Kt=lt[0],Ue=Hn=lt[1],Ft=yi=lt[2],Ot=Pe=lt[3],_n=qe=lt[4],kt=0;kt<80;kt+=1)Rn=Kt+at[ze+nn[kt]]|0,Rn+=kt<16?$e(Hn,yi,Pe)+pn[0]:kt<32?Je(Hn,yi,Pe)+pn[1]:kt<48?tt(Hn,yi,Pe)+pn[2]:kt<64?Ie(Hn,yi,Pe)+pn[3]:Le(Hn,yi,Pe)+pn[4],Rn=(Rn=mt(Rn|=0,Rt[kt]))+qe|0,Kt=qe,qe=Pe,Pe=mt(yi,10),yi=Hn,Hn=Rn,Rn=Oe+at[ze+wn[kt]]|0,Rn+=kt<16?Le(Ue,Ft,Ot)+Lt[0]:kt<32?Ie(Ue,Ft,Ot)+Lt[1]:kt<48?tt(Ue,Ft,Ot)+Lt[2]:kt<64?Je(Ue,Ft,Ot)+Lt[3]:$e(Ue,Ft,Ot)+Lt[4],Rn=(Rn=mt(Rn|=0,Jn[kt]))+_n|0,Oe=_n,_n=Ot,Ot=mt(Ft,10),Ft=Ue,Ue=Rn;Rn=lt[1]+yi+Ot|0,lt[1]=lt[2]+Pe+_n|0,lt[2]=lt[3]+qe+Oe|0,lt[3]=lt[4]+Kt+Ue|0,lt[4]=lt[0]+Hn+Ft|0,lt[0]=Rn},_doFinalize:function(){var at=this._data,ze=at.words,kt=8*this._nDataBytes,fn=8*at.sigBytes;ze[fn>>>5]|=128<<24-fn%32,ze[14+(fn+64>>>9<<4)]=16711935&(kt<<8|kt>>>24)|4278255360&(kt<<24|kt>>>8),at.sigBytes=4*(ze.length+1),this._process();for(var xt=this._hash,lt=xt.words,pn=0;pn<5;pn++){var Lt=lt[pn];lt[pn]=16711935&(Lt<<8|Lt>>>24)|4278255360&(Lt<<24|Lt>>>8)}return xt},clone:function(){var at=He.clone.call(this);return at._hash=this._hash.clone(),at}});function $e(at,ze,kt){return at^ze^kt}function Je(at,ze,kt){return at&ze|~at&kt}function tt(at,ze,kt){return(at|~ze)^kt}function Ie(at,ze,kt){return at&kt|ze&~kt}function Le(at,ze,kt){return at^(ze|~kt)}function mt(at,ze){return at<<ze|at>>>32-ze}fe.RIPEMD160=He._createHelper(ke),fe.HmacRIPEMD160=He._createHmacHelper(ke)}(Math),W.RIPEMD160)},4446:function(kn,an,Ve){var ie,fe,h,Me,rt,se,W;kn.exports=(W=Ve(12),h=(fe=(ie=W).lib).WordArray,rt=[],se=ie.algo.SHA1=(Me=fe.Hasher).extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(ce,xe){for(var ae=this._hash.words,he=ae[0],_e=ae[1],ke=ae[2],$e=ae[3],Je=ae[4],tt=0;tt<80;tt++){if(tt<16)rt[tt]=0|ce[xe+tt];else{var Ie=rt[tt-3]^rt[tt-8]^rt[tt-14]^rt[tt-16];rt[tt]=Ie<<1|Ie>>>31}var Le=(he<<5|he>>>27)+Je+rt[tt];Le+=tt<20?1518500249+(_e&ke|~_e&$e):tt<40?1859775393+(_e^ke^$e):tt<60?(_e&ke|_e&$e|ke&$e)-1894007588:(_e^ke^$e)-899497514,Je=$e,$e=ke,ke=_e<<30|_e>>>2,_e=he,he=Le}ae[0]=ae[0]+he|0,ae[1]=ae[1]+_e|0,ae[2]=ae[2]+ke|0,ae[3]=ae[3]+$e|0,ae[4]=ae[4]+Je|0},_doFinalize:function(){var ce=this._data,xe=ce.words,ae=8*this._nDataBytes,he=8*ce.sigBytes;return xe[he>>>5]|=128<<24-he%32,xe[14+(he+64>>>9<<4)]=Math.floor(ae/4294967296),xe[15+(he+64>>>9<<4)]=ae,ce.sigBytes=4*xe.length,this._process(),this._hash},clone:function(){var ce=Me.clone.call(this);return ce._hash=this._hash.clone(),ce}}),ie.SHA1=Me._createHelper(se),ie.HmacSHA1=Me._createHmacHelper(se),W.SHA1)},9811:function(kn,an,Ve){var ie,h,Me,He,rt,W;kn.exports=(W=Ve(12),Ve(2078),h=(ie=W).lib.WordArray,rt=(Me=ie.algo).SHA224=(He=Me.SHA256).extend({_doReset:function(){this._hash=new h.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var se=He._doFinalize.call(this);return se.sigBytes-=4,se}}),ie.SHA224=He._createHelper(rt),ie.HmacSHA224=He._createHmacHelper(rt),W.SHA224)},2078:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),function(ie){var fe=W,h=fe.lib,Me=h.WordArray,He=h.Hasher,rt=fe.algo,se=[],ce=[];!function(){function he(Je){for(var tt=ie.sqrt(Je),Ie=2;Ie<=tt;Ie++)if(!(Je%Ie))return!1;return!0}function _e(Je){return 4294967296*(Je-(0|Je))|0}for(var ke=2,$e=0;$e<64;)he(ke)&&($e<8&&(se[$e]=_e(ie.pow(ke,.5))),ce[$e]=_e(ie.pow(ke,1/3)),$e++),ke++}();var xe=[],ae=rt.SHA256=He.extend({_doReset:function(){this._hash=new Me.init(se.slice(0))},_doProcessBlock:function(he,_e){for(var ke=this._hash.words,$e=ke[0],Je=ke[1],tt=ke[2],Ie=ke[3],Le=ke[4],mt=ke[5],at=ke[6],ze=ke[7],kt=0;kt<64;kt++){if(kt<16)xe[kt]=0|he[_e+kt];else{var fn=xe[kt-15],lt=xe[kt-2];xe[kt]=((fn<<25|fn>>>7)^(fn<<14|fn>>>18)^fn>>>3)+xe[kt-7]+((lt<<15|lt>>>17)^(lt<<13|lt>>>19)^lt>>>10)+xe[kt-16]}var nn=$e&Je^$e&tt^Je&tt,Jn=ze+((Le<<26|Le>>>6)^(Le<<21|Le>>>11)^(Le<<7|Le>>>25))+(Le&mt^~Le&at)+ce[kt]+xe[kt];ze=at,at=mt,mt=Le,Le=Ie+Jn|0,Ie=tt,tt=Je,Je=$e,$e=Jn+((($e<<30|$e>>>2)^($e<<19|$e>>>13)^($e<<10|$e>>>22))+nn)|0}ke[0]=ke[0]+$e|0,ke[1]=ke[1]+Je|0,ke[2]=ke[2]+tt|0,ke[3]=ke[3]+Ie|0,ke[4]=ke[4]+Le|0,ke[5]=ke[5]+mt|0,ke[6]=ke[6]+at|0,ke[7]=ke[7]+ze|0},_doFinalize:function(){var he=this._data,_e=he.words,ke=8*this._nDataBytes,$e=8*he.sigBytes;return _e[$e>>>5]|=128<<24-$e%32,_e[14+($e+64>>>9<<4)]=ie.floor(ke/4294967296),_e[15+($e+64>>>9<<4)]=ke,he.sigBytes=4*_e.length,this._process(),this._hash},clone:function(){var he=He.clone.call(this);return he._hash=this._hash.clone(),he}});fe.SHA256=He._createHelper(ae),fe.HmacSHA256=He._createHmacHelper(ae)}(Math),W.SHA256)},6545:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(1802),function(ie){var fe=W,h=fe.lib,Me=h.WordArray,He=h.Hasher,se=fe.x64.Word,ce=fe.algo,xe=[],ae=[],he=[];!function(){for(var $e=1,Je=0,tt=0;tt<24;tt++){xe[$e+5*Je]=(tt+1)*(tt+2)/2%64;var Le=(2*$e+3*Je)%5;$e=Je%5,Je=Le}for($e=0;$e<5;$e++)for(Je=0;Je<5;Je++)ae[$e+5*Je]=Je+(2*$e+3*Je)%5*5;for(var mt=1,at=0;at<24;at++){for(var ze=0,kt=0,fn=0;fn<7;fn++){if(1&mt){var xt=(1<<fn)-1;xt<32?kt^=1<<xt:ze^=1<<xt-32}128&mt?mt=mt<<1^113:mt<<=1}he[at]=se.create(ze,kt)}}();var _e=[];!function(){for(var $e=0;$e<25;$e++)_e[$e]=se.create()}();var ke=ce.SHA3=He.extend({cfg:He.cfg.extend({outputLength:512}),_doReset:function(){for(var $e=this._state=[],Je=0;Je<25;Je++)$e[Je]=new se.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function($e,Je){for(var tt=this._state,Ie=this.blockSize/2,Le=0;Le<Ie;Le++){var mt=$e[Je+2*Le],at=$e[Je+2*Le+1];mt=16711935&(mt<<8|mt>>>24)|4278255360&(mt<<24|mt>>>8),(ze=tt[Le]).high^=at=16711935&(at<<8|at>>>24)|4278255360&(at<<24|at>>>8),ze.low^=mt}for(var kt=0;kt<24;kt++){for(var fn=0;fn<5;fn++){for(var xt=0,lt=0,pn=0;pn<5;pn++)xt^=(ze=tt[fn+5*pn]).high,lt^=ze.low;var Lt=_e[fn];Lt.high=xt,Lt.low=lt}for(fn=0;fn<5;fn++){var nn=_e[(fn+4)%5],wn=_e[(fn+1)%5],Rt=wn.high,Jn=wn.low;for(xt=nn.high^(Rt<<1|Jn>>>31),lt=nn.low^(Jn<<1|Rt>>>31),pn=0;pn<5;pn++)(ze=tt[fn+5*pn]).high^=xt,ze.low^=lt}for(var Kt=1;Kt<25;Kt++){var Hn=(ze=tt[Kt]).high,yi=ze.low,Pe=xe[Kt];Pe<32?(xt=Hn<<Pe|yi>>>32-Pe,lt=yi<<Pe|Hn>>>32-Pe):(xt=yi<<Pe-32|Hn>>>64-Pe,lt=Hn<<Pe-32|yi>>>64-Pe);var qe=_e[ae[Kt]];qe.high=xt,qe.low=lt}var Oe=_e[0],Ue=tt[0];for(Oe.high=Ue.high,Oe.low=Ue.low,fn=0;fn<5;fn++)for(pn=0;pn<5;pn++){var Ft=_e[Kt=fn+5*pn],Ot=_e[(fn+1)%5+5*pn],_n=_e[(fn+2)%5+5*pn];(ze=tt[Kt]).high=Ft.high^~Ot.high&_n.high,ze.low=Ft.low^~Ot.low&_n.low}var ze,Rn=he[kt];(ze=tt[0]).high^=Rn.high,ze.low^=Rn.low}},_doFinalize:function(){var $e=this._data,Je=$e.words,Ie=8*$e.sigBytes,Le=32*this.blockSize;Je[Ie>>>5]|=1<<24-Ie%32,Je[(ie.ceil((Ie+1)/Le)*Le>>>5)-1]|=128,$e.sigBytes=4*Je.length,this._process();for(var mt=this._state,at=this.cfg.outputLength/8,ze=at/8,kt=[],fn=0;fn<ze;fn++){var xt=mt[fn],lt=xt.high,pn=xt.low;lt=16711935&(lt<<8|lt>>>24)|4278255360&(lt<<24|lt>>>8),kt.push(pn=16711935&(pn<<8|pn>>>24)|4278255360&(pn<<24|pn>>>8)),kt.push(lt)}return new Me.init(kt,at)},clone:function(){for(var $e=He.clone.call(this),Je=$e._state=this._state.slice(0),tt=0;tt<25;tt++)Je[tt]=Je[tt].clone();return $e}});fe.SHA3=He._createHelper(ke),fe.HmacSHA3=He._createHmacHelper(ke)}(Math),W.SHA3)},2913:function(kn,an,Ve){var ie,fe,h,Me,He,rt,se,W;kn.exports=(W=Ve(12),Ve(1802),Ve(4870),h=(fe=(ie=W).x64).Word,Me=fe.WordArray,se=(He=ie.algo).SHA384=(rt=He.SHA512).extend({_doReset:function(){this._hash=new Me.init([new h.init(3418070365,3238371032),new h.init(1654270250,914150663),new h.init(2438529370,812702999),new h.init(355462360,4144912697),new h.init(1731405415,4290775857),new h.init(2394180231,1750603025),new h.init(3675008525,1694076839),new h.init(1203062813,3204075428)])},_doFinalize:function(){var ce=rt._doFinalize.call(this);return ce.sigBytes-=16,ce}}),ie.SHA384=rt._createHelper(se),ie.HmacSHA384=rt._createHmacHelper(se),W.SHA384)},4870:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(1802),function(){var ie=W,h=ie.lib.Hasher,Me=ie.x64,He=Me.Word,rt=Me.WordArray,se=ie.algo;function ce(){return He.create.apply(He,arguments)}var xe=[ce(1116352408,3609767458),ce(1899447441,602891725),ce(3049323471,3964484399),ce(3921009573,2173295548),ce(961987163,4081628472),ce(1508970993,3053834265),ce(2453635748,2937671579),ce(2870763221,3664609560),ce(3624381080,2734883394),ce(310598401,1164996542),ce(607225278,1323610764),ce(1426881987,3590304994),ce(1925078388,4068182383),ce(2162078206,991336113),ce(2614888103,633803317),ce(3248222580,3479774868),ce(3835390401,2666613458),ce(4022224774,944711139),ce(264347078,2341262773),ce(604807628,2007800933),ce(770255983,1495990901),ce(1249150122,1856431235),ce(1555081692,3175218132),ce(1996064986,2198950837),ce(2554220882,3999719339),ce(2821834349,766784016),ce(2952996808,2566594879),ce(3210313671,3203337956),ce(3336571891,1034457026),ce(3584528711,2466948901),ce(113926993,3758326383),ce(338241895,168717936),ce(666307205,1188179964),ce(773529912,1546045734),ce(1294757372,1522805485),ce(1396182291,2643833823),ce(1695183700,2343527390),ce(1986661051,1014477480),ce(2177026350,1206759142),ce(2456956037,344077627),ce(2730485921,1290863460),ce(2820302411,3158454273),ce(3259730800,3505952657),ce(3345764771,106217008),ce(3516065817,3606008344),ce(3600352804,1432725776),ce(4094571909,1467031594),ce(275423344,851169720),ce(430227734,3100823752),ce(506948616,1363258195),ce(659060556,3750685593),ce(883997877,3785050280),ce(958139571,3318307427),ce(1322822218,3812723403),ce(1537002063,2003034995),ce(1747873779,3602036899),ce(1955562222,1575990012),ce(2024104815,1125592928),ce(2227730452,2716904306),ce(2361852424,442776044),ce(2428436474,593698344),ce(2756734187,3733110249),ce(3204031479,2999351573),ce(3329325298,3815920427),ce(3391569614,3928383900),ce(3515267271,566280711),ce(3940187606,3454069534),ce(4118630271,4000239992),ce(116418474,1914138554),ce(174292421,2731055270),ce(289380356,3203993006),ce(460393269,320620315),ce(685471733,587496836),ce(852142971,1086792851),ce(1017036298,365543100),ce(1126000580,2618297676),ce(1288033470,3409855158),ce(1501505948,4234509866),ce(1607167915,987167468),ce(1816402316,1246189591)],ae=[];!function(){for(var _e=0;_e<80;_e++)ae[_e]=ce()}();var he=se.SHA512=h.extend({_doReset:function(){this._hash=new rt.init([new He.init(1779033703,4089235720),new He.init(3144134277,2227873595),new He.init(1013904242,4271175723),new He.init(2773480762,1595750129),new He.init(1359893119,2917565137),new He.init(2600822924,725511199),new He.init(528734635,4215389547),new He.init(1541459225,327033209)])},_doProcessBlock:function(_e,ke){for(var $e=this._hash.words,Je=$e[0],tt=$e[1],Ie=$e[2],Le=$e[3],mt=$e[4],at=$e[5],ze=$e[6],kt=$e[7],fn=Je.high,xt=Je.low,lt=tt.high,pn=tt.low,Lt=Ie.high,nn=Ie.low,wn=Le.high,Rt=Le.low,Jn=mt.high,Kt=mt.low,Hn=at.high,yi=at.low,Pe=ze.high,qe=ze.low,Oe=kt.high,Ue=kt.low,Ft=fn,Ot=xt,_n=lt,Rn=pn,$t=Lt,qn=nn,bi=wn,ur=Rt,ti=Jn,Ei=Kt,Vr=Hn,pr=yi,dr=Pe,lo=qe,Fo=Oe,Lo=Ue,hi=0;hi<80;hi++){var Or,bo,Wo=ae[hi];if(hi<16)bo=Wo.high=0|_e[ke+2*hi],Or=Wo.low=0|_e[ke+2*hi+1];else{var Jr=ae[hi-15],Ir=Jr.high,fo=Jr.low,Mo=(fo>>>1|Ir<<31)^(fo>>>8|Ir<<24)^(fo>>>7|Ir<<25),co=ae[hi-2],Bi=co.high,qr=co.low,Ks=(qr>>>19|Bi<<13)^(qr<<3|Bi>>>29)^(qr>>>6|Bi<<26),vr=ae[hi-7],te=ae[hi-16],De=te.low;Wo.high=bo=(bo=(bo=((Ir>>>1|fo<<31)^(Ir>>>8|fo<<24)^Ir>>>7)+vr.high+((Or=Mo+vr.low)>>>0<Mo>>>0?1:0))+((Bi>>>19|qr<<13)^(Bi<<3|qr>>>29)^Bi>>>6)+((Or+=Ks)>>>0<Ks>>>0?1:0))+te.high+((Or+=De)>>>0<De>>>0?1:0),Wo.low=Or}var ee,Be=ti&Vr^~ti&dr,Qe=Ei&pr^~Ei&lo,ut=Ft&_n^Ft&$t^_n&$t,Et=(Ot>>>28|Ft<<4)^(Ot<<30|Ft>>>2)^(Ot<<25|Ft>>>7),pe=xe[hi],ue=pe.low,Te=Fo+((ti>>>14|Ei<<18)^(ti>>>18|Ei<<14)^(ti<<23|Ei>>>9))+((ee=Lo+((Ei>>>14|ti<<18)^(Ei>>>18|ti<<14)^(Ei<<23|ti>>>9)))>>>0<Lo>>>0?1:0),bt=Et+(Ot&Rn^Ot&qn^Rn&qn);Fo=dr,Lo=lo,dr=Vr,lo=pr,Vr=ti,pr=Ei,ti=bi+(Te=(Te=(Te=Te+Be+((ee+=Qe)>>>0<Qe>>>0?1:0))+pe.high+((ee+=ue)>>>0<ue>>>0?1:0))+bo+((ee+=Or)>>>0<Or>>>0?1:0))+((Ei=ur+ee|0)>>>0<ur>>>0?1:0)|0,bi=$t,ur=qn,$t=_n,qn=Rn,_n=Ft,Rn=Ot,Ft=Te+(((Ft>>>28|Ot<<4)^(Ft<<30|Ot>>>2)^(Ft<<25|Ot>>>7))+ut+(bt>>>0<Et>>>0?1:0))+((Ot=ee+bt|0)>>>0<ee>>>0?1:0)|0}xt=Je.low=xt+Ot,Je.high=fn+Ft+(xt>>>0<Ot>>>0?1:0),pn=tt.low=pn+Rn,tt.high=lt+_n+(pn>>>0<Rn>>>0?1:0),nn=Ie.low=nn+qn,Ie.high=Lt+$t+(nn>>>0<qn>>>0?1:0),Rt=Le.low=Rt+ur,Le.high=wn+bi+(Rt>>>0<ur>>>0?1:0),Kt=mt.low=Kt+Ei,mt.high=Jn+ti+(Kt>>>0<Ei>>>0?1:0),yi=at.low=yi+pr,at.high=Hn+Vr+(yi>>>0<pr>>>0?1:0),qe=ze.low=qe+lo,ze.high=Pe+dr+(qe>>>0<lo>>>0?1:0),Ue=kt.low=Ue+Lo,kt.high=Oe+Fo+(Ue>>>0<Lo>>>0?1:0)},_doFinalize:function(){var _e=this._data,ke=_e.words,$e=8*this._nDataBytes,Je=8*_e.sigBytes;return ke[Je>>>5]|=128<<24-Je%32,ke[30+(Je+128>>>10<<5)]=Math.floor($e/4294967296),ke[31+(Je+128>>>10<<5)]=$e,_e.sigBytes=4*ke.length,this._process(),this._hash.toX32()},clone:function(){var _e=h.clone.call(this);return _e._hash=this._hash.clone(),_e},blockSize:32});ie.SHA512=h._createHelper(he),ie.HmacSHA512=h._createHmacHelper(he)}(),W.SHA512)},5769:function(kn,an,Ve){var W;kn.exports=(W=Ve(12),Ve(5506),Ve(2873),Ve(2066),Ve(3270),function(){var ie=W,fe=ie.lib,h=fe.WordArray,Me=fe.BlockCipher,He=ie.algo,rt=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],se=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],ce=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],xe=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],ae=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],he=He.DES=Me.extend({_doReset:function(){for(var tt=this._key.words,Ie=[],Le=0;Le<56;Le++){var mt=rt[Le]-1;Ie[Le]=tt[mt>>>5]>>>31-mt%32&1}for(var at=this._subKeys=[],ze=0;ze<16;ze++){var kt=at[ze]=[],fn=ce[ze];for(Le=0;Le<24;Le++)kt[Le/6|0]|=Ie[(se[Le]-1+fn)%28]<<31-Le%6,kt[4+(Le/6|0)]|=Ie[28+(se[Le+24]-1+fn)%28]<<31-Le%6;for(kt[0]=kt[0]<<1|kt[0]>>>31,Le=1;Le<7;Le++)kt[Le]=kt[Le]>>>4*(Le-1)+3;kt[7]=kt[7]<<5|kt[7]>>>27}var xt=this._invSubKeys=[];for(Le=0;Le<16;Le++)xt[Le]=at[15-Le]},encryptBlock:function(Je,tt){this._doCryptBlock(Je,tt,this._subKeys)},decryptBlock:function(Je,tt){this._doCryptBlock(Je,tt,this._invSubKeys)},_doCryptBlock:function(Je,tt,Ie){this._lBlock=Je[tt],this._rBlock=Je[tt+1],_e.call(this,4,252645135),_e.call(this,16,65535),ke.call(this,2,858993459),ke.call(this,8,16711935),_e.call(this,1,1431655765);for(var Le=0;Le<16;Le++){for(var mt=Ie[Le],at=this._lBlock,ze=this._rBlock,kt=0,fn=0;fn<8;fn++)kt|=xe[fn][((ze^mt[fn])&ae[fn])>>>0];this._lBlock=ze,this._rBlock=at^kt}var xt=this._lBlock;this._lBlock=this._rBlock,this._rBlock=xt,_e.call(this,1,1431655765),ke.call(this,8,16711935),ke.call(this,2,858993459),_e.call(this,16,65535),_e.call(this,4,252645135),Je[tt]=this._lBlock,Je[tt+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function _e(Je,tt){var Ie=(this._lBlock>>>Je^this._rBlock)&tt;this._rBlock^=Ie,this._lBlock^=Ie<<Je}function ke(Je,tt){var Ie=(this._rBlock>>>Je^this._lBlock)&tt;this._lBlock^=Ie,this._rBlock^=Ie<<Je}ie.DES=Me._createHelper(he);var $e=He.TripleDES=Me.extend({_doReset:function(){var tt=this._key.words;if(2!==tt.length&&4!==tt.length&&tt.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var Ie=tt.slice(0,2),Le=tt.length<4?tt.slice(0,2):tt.slice(2,4),mt=tt.length<6?tt.slice(0,2):tt.slice(4,6);this._des1=he.createEncryptor(h.create(Ie)),this._des2=he.createEncryptor(h.create(Le)),this._des3=he.createEncryptor(h.create(mt))},encryptBlock:function(Je,tt){this._des1.encryptBlock(Je,tt),this._des2.decryptBlock(Je,tt),this._des3.encryptBlock(Je,tt)},decryptBlock:function(Je,tt){this._des3.decryptBlock(Je,tt),this._des2.encryptBlock(Je,tt),this._des1.decryptBlock(Je,tt)},keySize:6,ivSize:2,blockSize:2});ie.TripleDES=Me._createHelper($e)}(),W.TripleDES)},1802:function(kn,an,Ve){var h,Me,He,rt,W;kn.exports=(W=Ve(12),Me=(h=W.lib).Base,He=h.WordArray,(rt=W.x64={}).Word=Me.extend({init:function(xe,ae){this.high=xe,this.low=ae}}),rt.WordArray=Me.extend({init:function(xe,ae){xe=this.words=xe||[],this.sigBytes=null!=ae?ae:8*xe.length},toX32:function(){for(var xe=this.words,ae=xe.length,he=[],_e=0;_e<ae;_e++){var ke=xe[_e];he.push(ke.high),he.push(ke.low)}return He.create(he,this.sigBytes)},clone:function(){for(var xe=Me.clone.call(this),ae=xe.words=this.words.slice(0),he=ae.length,_e=0;_e<he;_e++)ae[_e]=ae[_e].clone();return xe}}),W)},2574:function(kn){kn.exports=function(){"use strict";var an,Ve,W;function ie(h,Me){if(an)if(Ve){var He="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+an+")(sharedChunk); ("+Ve+")(sharedChunk); self.onerror = null;",rt={};an(rt),W=Me(rt),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(W.workerUrl=window.URL.createObjectURL(new Blob([He],{type:"text/javascript"})))}else Ve=Me;else an=Me}return ie(0,function(h){var Me=typeof self<"u"?self:{},He="2.15.0";let rt;const se={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==rt){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{rt=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):a}catch{rt=a}}return rt},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!se.API_URL)return null;try{const a=new URL(se.API_URL);return"api.mapbox.cn"===a.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===a.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ce={supported:!1,testSupport:function(a){!he&&ae&&(_e?ke(a):xe=a)}};let xe,ae,he=!1,_e=!1;function ke(a){const s=a.createTexture();a.bindTexture(a.TEXTURE_2D,s);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,ae),a.isContextLost())return;ce.supported=!0}catch{}a.deleteTexture(s),he=!0}Me.document&&(ae=Me.document.createElement("img"),ae.onload=function(){xe&&ke(xe),xe=null,_e=!0},ae.onerror=function(){he=!0,xe=null},ae.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const $e="01";function Je(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var tt=Ie;function Ie(a,s,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(d-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=s,this.p2x=c,this.p2y=d}Ie.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,s){if(void 0===s&&(s=1e-6),a<0)return 0;if(a>1)return 1;for(var c=a,d=0;d<8;d++){var m=this.sampleCurveX(c)-a;if(Math.abs(m)<s)return c;var y=this.sampleCurveDerivativeX(c);if(Math.abs(y)<1e-6)break;c-=m/y}var x=0,E=1;for(c=a,d=0;d<20&&(m=this.sampleCurveX(c),!(Math.abs(m-a)<s));d++)a>m?x=c:E=c,c=.5*(E-x)+x;return c},solve:function(a,s){return this.sampleCurveY(this.solveCurveX(a,s))}};var Le=Je(tt),mt=at;function at(a,s){this.x=a,this.y=s}at.prototype={clone:function(){return new at(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,s){return this.clone()._rotateAround(a,s)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var s=a.x-this.x,c=a.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,s){return Math.atan2(this.x*s-this.y*a,this.x*a+this.y*s)},_matMult:function(a){var s=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=s,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var s=Math.cos(a),c=Math.sin(a),d=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=d,this},_rotateAround:function(a,s){var c=Math.cos(a),d=Math.sin(a),m=s.y+d*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-d*(this.y-s.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},at.convert=function(a){return a instanceof at?a:Array.isArray(a)?new at(a[0],a[1]):a};var ze=Je(mt);const kt=Math.PI/180,fn=180/Math.PI;function xt(a){return a*kt}function lt(a){return a*fn}const pn=[[0,0],[1,0],[1,1],[0,1]];function Lt(a){if(a<=0)return 0;if(a>=1)return 1;const s=a*a,c=s*a;return 4*(a<.5?c:3*(a-s)+c-.75)}function nn(a,s,c,d){const m=new Le(a,s,c,d);return function(y){return m.solve(y)}}const wn=nn(.25,.1,.25,1);function Rt(a,s,c){return Math.min(c,Math.max(s,a))}function Jn(a,s,c){return(c=Rt((c-a)/(s-a),0,1))*c*(3-2*c)}function Kt(a,s,c){const d=c-s,m=((a-s)%d+d)%d+s;return m===s?c:m}function Hn(a,s,c){if(!a.length)return c(null,[]);let d=a.length;const m=new Array(a.length);let y=null;a.forEach((x,E)=>{s(x,(T,M)=>{T&&(y=T),m[E]=M,0==--d&&c(y,m)})})}function yi(a){const s=[];for(const c in a)s.push(a[c]);return s}function Pe(a,...s){for(const c of s)for(const d in c)a[d]=c[d];return a}let qe=1;function Oe(){return qe++}function Ue(){return function a(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function Ft(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function Ot(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function _n(a,s){a.forEach(c=>{s[c]&&(s[c]=s[c].bind(s))})}function Rn(a,s){return-1!==a.indexOf(s,a.length-s.length)}function $t(a,s,c){const d={};for(const m in a)d[m]=s.call(c||this,a[m],m,a);return d}function qn(a,s,c){const d={};for(const m in a)s.call(c||this,a[m],m,a)&&(d[m]=a[m]);return d}function bi(a){return Array.isArray(a)?a.map(bi):"object"==typeof a&&a?$t(a,bi):a}const ur={};function ti(a){ur[a]||(typeof console<"u"&&console.warn(a),ur[a]=!0)}function Ei(a,s,c){return(c.y-a.y)*(s.x-a.x)>(s.y-a.y)*(c.x-a.x)}function Vr(a){let s=0;for(let c,d,m=0,y=a.length,x=y-1;m<y;x=m++)c=a[m],d=a[x],s+=(d.x-c.x)*(c.y+d.y);return s}function pr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function dr(a){const s={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,d,m,y)=>{const x=m||y;return s[d]=!x||x.toLowerCase(),""}),s["max-age"]){const c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s}let lo=null;function Fo(a){if(null==lo){const s=a.navigator?a.navigator.userAgent:null;lo=!!a.safari||!(!s||!(/\b(iPad|iPhone|iPod)\b/.test(s)||s.match("Safari")&&!s.match("Chrome")))}return lo}function Lo(a){try{const s=Me[a];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}}function hi(a,s){return[a[4*s],a[4*s+1],a[4*s+2],a[4*s+3]]}const Or="mapbox-tiles";let Jr,Ir,bo=500,Wo=50;function fo(){try{return Me.caches}catch{}}function So(){fo()&&!Jr&&(Jr=Me.caches.open(Or))}function Mo(a){const s=a.indexOf("?");if(s<0)return a;const d=function(m){const y=m.indexOf("?");return y>0?m.slice(y+1).split("&"):[]}(a).filter(m=>{const y=m.split("=");return"language"===y[0]||"worldview"===y[0]});return d.length?`${a.slice(0,s)}?${d.join("&")}`:a.slice(0,s)}let co=1/0;const Bi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Bi);class qr extends Error{constructor(s,c,d){401===c&&ut(d)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=c,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Sr=pr()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Me.location.protocol?Me.parent:Me).location.href,Ks=function(a,s){if(!(/^file:/.test(c=a.url)||/^file:/.test(Sr())&&!/^\w+:/.test(c))){if(Me.fetch&&Me.Request&&Me.AbortController&&Me.Request.prototype.hasOwnProperty("signal"))return function(d,m){const y=new Me.AbortController,x=new Me.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:Sr(),referrerPolicy:d.referrerPolicy,signal:y.signal});let E=!1,T=!1;const M=(F=x.url).indexOf("sku=")>0&&ut(F);var F;"json"===d.type&&x.headers.set("Accept","application/json");const B=(j,G,Q)=>{if(T)return;if(j&&"SecurityError"!==j.message&&ti(j.toString()),G&&Q)return V(G);const re=Date.now();Me.fetch(x).then(X=>{if(X.ok){const Ne=M?X.clone():null;return V(X,Ne,re)}return m(new qr(X.statusText,X.status,d.url))}).catch(X=>{"AbortError"!==X.name&&m(new Error(`${X.message} ${d.url}`))})},V=(j,G,Q)=>{("arrayBuffer"===d.type?j.arrayBuffer():"json"===d.type?j.json():j.text()).then(re=>{T||(G&&Q&&function(X,Ne,H){if(So(),!Jr)return;const Fe={status:Ne.status,statusText:Ne.statusText,headers:new Me.Headers};Ne.headers.forEach((wt,yt)=>Fe.headers.set(yt,wt));const Ze=dr(Ne.headers.get("Cache-Control")||"");if(Ze["no-store"])return;Ze["max-age"]&&Fe.headers.set("Expires",new Date(H+1e3*Ze["max-age"]).toUTCString());const We=Fe.headers.get("Expires");We&&(new Date(We).getTime()-H<42e4||function(wt,yt){if(void 0===Ir)try{new Response(new ReadableStream),Ir=!0}catch{Ir=!1}Ir?yt(wt.body):wt.blob().then(yt)}(Ne,wt=>{const yt=new Me.Response(wt,Fe);So(),Jr&&Jr.then(Bt=>Bt.put(Mo(X.url),yt)).catch(Bt=>ti(Bt.message))}))}(x,G,Q),E=!0,m(null,re,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(re=>{T||m(new Error(re.message))})};return M?function(j,G){if(So(),!Jr)return G(null);const Q=Mo(j.url);Jr.then(re=>{re.match(Q).then(X=>{const Ne=function(H){if(!H)return!1;const Fe=new Date(H.headers.get("Expires")||0),Ze=dr(H.headers.get("Cache-Control")||"");return Fe>Date.now()&&!Ze["no-cache"]}(X);re.delete(Q),Ne&&re.put(Q,X.clone()),G(null,X,Ne)}).catch(G)}).catch(G)}(x,B):B(null,null),{cancel:()=>{T=!0,E||y.abort()}}}(a,s);if(pr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,s,void 0,!0)}var c;return function(d,m){const y=new Me.XMLHttpRequest;y.open(d.method||"GET",d.url,!0),"arrayBuffer"===d.type&&(y.responseType="arraybuffer");for(const x in d.headers)y.setRequestHeader(x,d.headers[x]);return"json"===d.type&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials="include"===d.credentials,y.onerror=()=>{m(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||0===y.status)&&null!==y.response){let x=y.response;if("json"===d.type)try{x=JSON.parse(y.response)}catch(E){return m(E)}m(null,x,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else m(new qr(y.statusText,y.status,d.url))},y.send(d.body),{cancel:()=>y.abort()}}(a,s)},vr=function(a,s){return Ks(Pe(a,{type:"arrayBuffer"}),s)};function zr(a){const s=Me.document.createElement("a");return s.href=a,s.protocol===Me.document.location.protocol&&s.host===Me.document.location.host}const Re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let te,oe;te=[],oe=0;const De=function(a,s){if(ce.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),oe>=se.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:a,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return te.push(y),y}oe++;let c=!1;const d=()=>{if(!c)for(c=!0,oe--;te.length&&oe<se.MAX_PARALLEL_IMAGE_REQUESTS;){const y=te.shift(),{requestParameters:x,callback:E,cancelled:T}=y;T||(y.cancel=De(x,E).cancel)}},m=vr(a,(y,x,E,T)=>{d(),y?s(y):x&&(Me.createImageBitmap?function(M,F){const B=new Me.Blob([new Uint8Array(M)],{type:"image/png"});Me.createImageBitmap(B).then(V=>{F(null,V)}).catch(V=>{F(new Error(`Could not load image because of ${V.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(M,F)=>s(M,F,E,T)):function(M,F){const B=new Me.Image,V=Me.URL;B.onload=()=>{F(null,B),V.revokeObjectURL(B.src),B.onload=null,Me.requestAnimationFrame(()=>{B.src=Re})},B.onerror=()=>F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const j=new Me.Blob([new Uint8Array(M)],{type:"image/png"});B.src=M.byteLength?V.createObjectURL(j):Re}(x,(M,F)=>s(M,F,E,T)))});return{cancel:()=>{m.cancel(),d()}}},Be="NO_ACCESS_TOKEN";function Qe(a){return 0===a.indexOf("mapbox:")}function ut(a){return se.API_URL_REGEX.test(a)}function dt(a){return se.API_CDN_URL_REGEX.test(a)}function et(a){return se.API_STYLE_REGEX.test(a)&&!Et(a)}function Et(a){return se.API_SPRITE_REGEX.test(a)}const tn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ee(a){const s=a.match(tn);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function pe(a){const s=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${s}`}const ne="mapbox.eventData";function ue(a){if(!a)return null;const s=a.split(".");if(!s||3!==s.length)return null;try{return JSON.parse(decodeURIComponent(Me.atob(s[1]).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class ee{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const c=ue(se.ACCESS_TOKEN);let d="";return d=c&&c.u?Me.btoa(encodeURIComponent(c.u).replace(/%([0-9A-F]{2})/g,(m,y)=>String.fromCharCode(+("0x"+y)))):se.ACCESS_TOKEN||"",s?`${ne}.${s}:${d}`:`${ne}:${d}`}fetchEventData(){const s=Lo("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(s)try{const m=Me.localStorage.getItem(c);m&&(this.eventData=JSON.parse(m));const y=Me.localStorage.getItem(d);y&&(this.anonId=y)}catch{ti("Unable to read from LocalStorage")}}saveEventData(){const s=Lo("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(s)try{Me.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&Me.localStorage.setItem(c,JSON.stringify(this.eventData))}catch{ti("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,c,d,m){if(!se.EVENTS_URL)return;const y=Ee(se.EVENTS_URL);y.params.push(`access_token=${m||se.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(s).toISOString()},E=c?Pe(x,c):x,T={url:pe(y),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};var F;this.pendingRequest=(F=M=>{this.pendingRequest=null,d(M),this.saveEventData(),this.processRequests(m)},Ks(Pe(T,{method:"POST"}),F))}queueRequest(s,c){this.queue.push(s),this.processRequests(c)}}const Te=new class extends ee{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,s){se.EVENTS_URL&&se.ACCESS_TOKEN&&Array.isArray(a)&&a.some(c=>Qe(c)||ut(c))&&this.queueRequest(Date.now(),s)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=ue(se.ACCESS_TOKEN),c=s?s.u:se.ACCESS_TOKEN;let d=c!==this.eventData.tokenU;Ot(this.anonId)||(this.anonId=Ue(),d=!0);const m=this.queue.shift();if(this.eventData.lastSuccess){const y=new Date(this.eventData.lastSuccess),x=new Date(m),E=(m-this.eventData.lastSuccess)/864e5;d=d||E>=1||E<-1||y.getDate()!==x.getDate()}else d=!0;d?this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:He,skuId:$e,"enabled.telemetry":!1,userId:this.anonId},y=>{y||(this.eventData.lastSuccess=m,this.eventData.tokenU=c)},a):this.processRequests()}},bt=Te.postTurnstileEvent.bind(Te),En=new class extends ee{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,s,c,d){this.skuToken=s,this.errorCb=d,se.EVENTS_URL&&(c||se.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},c):this.errorCb(new Error(Be)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),Ot(this.anonId)||(this.anonId=Ue()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:He,skuId:$e,skuToken:this.skuToken,userId:this.anonId},d=>{d?this.errorCb(d):s&&(this.success[s]=!0)},a))}},bn=En.postMapLoadEvent.bind(En),Xn=new class extends ee{constructor(){super("gljs.performance")}postPerformanceEvent(a,s){se.EVENTS_URL&&(a||se.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},a)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:s,performanceData:c}=this.queue.shift(),d=function(m){const y=Me.performance.getEntriesByType("resource"),x=Me.performance.getEntriesByType("mark"),E=function(V){const j={};if(V)for(const G in V)if("other"!==G)for(const Q of V[G]){const re=`${G}ResolveRangeMin`,X=`${G}ResolveRangeMax`,Ne=`${G}RequestCount`,H=`${G}RequestCachedCount`;j[re]=Math.min(j[re]||1/0,Q.startTime),j[X]=Math.max(j[X]||-1/0,Q.responseEnd);const Fe=Ze=>{void 0===j[Ze]&&(j[Ze]=0),++j[Ze]};void 0!==Q.transferSize&&0===Q.transferSize&&Fe(H),Fe(Ne)}return j}(function(V,j){const G={};if(V)for(const Q of V){const re=j(Q);void 0===G[re]&&(G[re]=[]),G[re].push(Q)}return G}(y,Tt)),T=Me.devicePixelRatio,M=Me.navigator.connection||Me.navigator.mozConnection||Me.navigator.webkitConnection,F={counters:[],metadata:[],attributes:[]},B=(V,j,G)=>{null!=G&&V.push({name:j,value:G.toString()})};for(const V in E)B(F.counters,V,E[V]);if(m.interactionRange[0]!==1/0&&m.interactionRange[1]!==-1/0&&(B(F.counters,"interactionRangeMin",m.interactionRange[0]),B(F.counters,"interactionRangeMax",m.interactionRange[1])),x)for(const V of Object.keys(po)){const j=po[V],G=x.find(Q=>Q.name===j);G&&B(F.counters,j,G.startTime)}return B(F.counters,"visibilityHidden",m.visibilityHidden),B(F.attributes,"style",function(V){if(V)for(const j of V){const G=j.name.split("?")[0];if(et(G)){const Q=G.split("/").slice(-2);if(2===Q.length)return`mapbox://styles/${Q[0]}/${Q[1]}`}}}(y)),B(F.attributes,"terrainEnabled",m.terrainEnabled?"true":"false"),B(F.attributes,"fogEnabled",m.fogEnabled?"true":"false"),B(F.attributes,"projection",m.projection),B(F.attributes,"zoom",m.zoom),B(F.metadata,"devicePixelRatio",T),B(F.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),B(F.metadata,"navigatorUserAgent",Me.navigator.userAgent),B(F.metadata,"screenWidth",Me.screen.width),B(F.metadata,"screenHeight",Me.screen.height),B(F.metadata,"windowWidth",Me.innerWidth),B(F.metadata,"windowHeight",Me.innerHeight),B(F.metadata,"mapWidth",m.width/T),B(F.metadata,"mapHeight",m.height/T),B(F.metadata,"webglRenderer",m.renderer),B(F.metadata,"webglVendor",m.vendor),B(F.metadata,"sdkVersion",He),B(F.metadata,"sdkIdentifier","mapbox-gl-js"),F}(c);for(const m of d.metadata);for(const m of d.counters);for(const m of d.attributes);this.postEvent(s,d,()=>{},a)}},vi=Xn.postPerformanceEvent.bind(Xn),Pn=new class extends ee{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,s,c,d){if(!se.API_URL||!se.SESSION_PATH)return;const m=Ee(se.API_URL+se.SESSION_PATH);m.params.push(`sku=${s||""}`),m.params.push(`access_token=${d||se.ACCESS_TOKEN||""}`);const y={url:pe(m),headers:{"Content-Type":"text/plain"}};var E;this.pendingRequest=(E=x=>{this.pendingRequest=null,c(x),this.saveEventData(),this.processRequests(d)},Ks(Pe(y,{method:"GET"}),E))}getSessionAPI(a,s,c,d){this.skuToken=s,this.errorCb=d,se.SESSION_PATH&&se.API_URL&&(c||se.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},c):this.errorCb(new Error(Be)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||this.getSession(c,this.skuToken,d=>{d?this.errorCb(d):s&&(this.success[s]=!0)},a)}},Li=Pn.getSessionAPI.bind(Pn),Un=new Set,po={create:"create",load:"load",fullLoad:"fullLoad"},Vc={mark(a){Me.performance.mark(a)},measure(a,s,c){Me.performance.measure(a,s,c)}};function Tt(a){const s=a.name.split("?")[0];return dt(s)&&s.includes("mapbox-gl.js")?"javascript":dt(s)&&s.includes("mapbox-gl.css")?"css":se.API_FONTS_REGEX.test(s)?"fontRange":Et(s)?"sprite":et(s)?"style":se.API_TILEJSON_REGEX.test(s)?"tilejson":"other"}const Ke=Me.performance;function dn(a){const s=a?a.url.toString():void 0;return Ke.getEntriesByName(s)}let jn,$i,Zi,gt;const xr={now:()=>void 0!==Zi?Zi:Me.performance.now(),setNow(a){Zi=a},restoreNow(){Zi=void 0},frame(a){const s=Me.requestAnimationFrame(a);return{cancel:()=>Me.cancelAnimationFrame(s)}},getImageData(a,s=0){const{width:c,height:d}=a;gt||(gt=Me.document.createElement("canvas"));const m=gt.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(c>gt.width||d>gt.height)&&(gt.width=c,gt.height=d),m.clearRect(-s,-s,c+2*s,d+2*s),m.drawImage(a,0,0,c,d),m.getImageData(-s,-s,c+2*s,d+2*s)},resolveURL:a=>(jn||(jn=Me.document.createElement("a")),jn.href=a,jn.href),get devicePixelRatio(){return Me.devicePixelRatio},get prefersReducedMotion(){return!!Me.matchMedia&&(null==$i&&($i=Me.matchMedia("(prefers-reduced-motion: reduce)")),$i.matches)}};function Zn(a,s,c){c[a]&&-1!==c[a].indexOf(s)||(c[a]=c[a]||[],c[a].push(s))}function Hi(a,s,c){if(c&&c[a]){const d=c[a].indexOf(s);-1!==d&&c[a].splice(d,1)}}class Wa{constructor(s,c={}){Pe(this,c),this.type=s}}class cc extends Wa{constructor(s,c={}){super("error",Pe({error:s},c))}}class zc{on(s,c){return this._listeners=this._listeners||{},Zn(s,c,this._listeners),this}off(s,c){return Hi(s,c,this._listeners),Hi(s,c,this._oneTimeListeners),this}once(s,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Zn(s,c,this._oneTimeListeners),this):new Promise(d=>this.once(s,d))}fire(s,c){"string"==typeof s&&(s=new Wa(s,c||{}));const d=s.type;if(this.listens(d)){s.target=this;const m=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const E of m)E.call(this,s);const y=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const E of y)Hi(d,E,this._oneTimeListeners),E.call(this,s);const x=this._eventedParent;x&&(Pe(s,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),x.fire(s))}else s instanceof cc&&console.error(s.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,c){return this._eventedParent=s,this._eventedParentData=c,this}}var Nt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Po(a,...s){for(const c of s)for(const d in c)a[d]=c[d];return a}function No(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Ki(a){if(Array.isArray(a))return a.map(Ki);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const s={};for(const c in a)s[c]=Ki(a[c]);return s}return No(a)}class Wp extends Error{constructor(s,c){super(c),this.message=c,this.key=s}}var Ts=Wp;class ih{constructor(s,c=[]){this.parent=s,this.bindings={};for(const[d,m]of c)this.bindings[d]=m}concat(s){return new ih(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}var qp=ih;const hd={kind:"null"},Mn={kind:"number"},Gi={kind:"string"},zi={kind:"boolean"},Ys={kind:"color"},Da={kind:"object"},li={kind:"value"},ri={kind:"collator"},rh={kind:"formatted"},uc={kind:"resolvedImage"};function qa(a,s){return{kind:"array",itemType:a,N:s}}function Wt(a){if("array"===a.kind){const s=Wt(a.itemType);return"number"==typeof a.N?`array<${s}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${s}>`}return a.kind}const Zp=[hd,Mn,Gi,zi,Ys,rh,Da,qa(li),uc];function Ai(a,s){if("error"===s.kind)return null;if("array"===a.kind){if("array"===s.kind&&(0===s.N&&"value"===s.itemType.kind||!Ai(a.itemType,s.itemType))&&("number"!=typeof a.N||a.N===s.N))return null}else{if(a.kind===s.kind)return null;if("value"===a.kind)for(const c of Zp)if(!Ai(c,s))return null}return`Expected ${Wt(a)} but found ${Wt(s)} instead.`}function dc(a,s){return s.some(c=>c.kind===a.kind)}function Du(a,s){return s.some(c=>"null"===c?null===a:"array"===c?Array.isArray(a):"object"===c?a&&!Array.isArray(a)&&"object"==typeof a:c===typeof a)}var oh,Uc={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Pl(a){return(a=Math.round(a))<0?0:a>255?255:a}function dl(a){return Pl("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function Au(a){return(s="%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))<0?0:s>1?1:s;var s}function kl(a,s,c){return c<0?c+=1:c>1&&(c-=1),6*c<1?a+(s-a)*c*6:2*c<1?s:3*c<2?a+(s-a)*(2/3-c)*6:a}try{oh={}.parseCSSColor=function(a){var s,c=a.replace(/ /g,"").toLowerCase();if(c in Uc)return Uc[c].slice();if("#"===c[0])return 4===c.length?(s=parseInt(c.substr(1),16))>=0&&s<=4095?[(3840&s)>>4|(3840&s)>>8,240&s|(240&s)>>4,15&s|(15&s)<<4,1]:null:7===c.length&&(s=parseInt(c.substr(1),16))>=0&&s<=16777215?[(16711680&s)>>16,(65280&s)>>8,255&s,1]:null;var d=c.indexOf("("),m=c.indexOf(")");if(-1!==d&&m+1===c.length){var y=c.substr(0,d),x=c.substr(d+1,m-(d+1)).split(","),E=1;switch(y){case"rgba":if(4!==x.length)return null;E=Au(x.pop());case"rgb":return 3!==x.length?null:[dl(x[0]),dl(x[1]),dl(x[2]),E];case"hsla":if(4!==x.length)return null;E=Au(x.pop());case"hsl":if(3!==x.length)return null;var T=(parseFloat(x[0])%360+360)%360/360,M=Au(x[1]),F=Au(x[2]),B=F<=.5?F*(M+1):F+M-F*M,V=2*F-B;return[Pl(255*kl(V,B,T+1/3)),Pl(255*kl(V,B,T)),Pl(255*kl(V,B,T-1/3)),E];default:return null}}return null}}catch{}class Xs{constructor(s,c,d,m=1){this.r=s,this.g=c,this.b=d,this.a=m}static parse(s){if(!s)return;if(s instanceof Xs)return s;if("string"!=typeof s)return;const c=oh(s);return c?new Xs(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toString(){const[s,c,d,m]=this.toArray();return`rgba(${Math.round(s)},${Math.round(c)},${Math.round(d)},${m})`}toArray(){const{r:s,g:c,b:d,a:m}=this;return 0===m?[0,0,0,0]:[255*s/m,255*c/m,255*d/m,m]}toArray01(){const{r:s,g:c,b:d,a:m}=this;return 0===m?[0,0,0,0]:[s/m,c/m,d/m,m]}toArray01PremultipliedAlpha(){const{r:s,g:c,b:d,a:m}=this;return[s,c,d,m]}}Xs.black=new Xs(0,0,0,1),Xs.white=new Xs(1,1,1,1),Xs.transparent=new Xs(0,0,0,0),Xs.red=new Xs(1,0,0,1),Xs.blue=new Xs(0,0,1,1);var si=Xs;class fd{constructor(s,c,d){this.sensitivity=s?c?"variant":"case":c?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,c){return this.collator.compare(s,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Su{constructor(s,c,d,m,y){this.text=s.normalize?s.normalize():s,this.image=c,this.scale=d,this.fontStack=m,this.textColor=y}}class Ur{constructor(s){this.sections=s}static fromString(s){return new Ur([new Su(s,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(s=>0!==s.text.length||s.image&&0!==s.image.name.length)}static factory(s){return s instanceof Ur?s:Ur.fromString(s)}toString(){return 0===this.sections.length?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const c of this.sections){if(c.image){s.push(["image",c.image.name]);continue}s.push(c.text);const d={};c.fontStack&&(d["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(d["font-scale"]=c.scale),c.textColor&&(d["text-color"]=["rgba"].concat(c.textColor.toArray())),s.push(d)}return s}}class zs{constructor(s){this.name=s.name,this.available=s.available}toString(){return this.name}static fromString(s){return s?new zs({name:s,available:!1}):null}serialize(){return["image",this.name]}}function sh(a,s,c,d){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof s&&s>=0&&s<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:`Invalid rgba value [${[a,s,c,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof d?[a,s,c,d]:[a,s,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function yr(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof si||a instanceof fd||a instanceof Ur||a instanceof zs)return!0;if(Array.isArray(a)){for(const s of a)if(!yr(s))return!1;return!0}if("object"==typeof a){for(const s in a)if(!yr(a[s]))return!1;return!0}return!1}function wo(a){if(null===a)return hd;if("string"==typeof a)return Gi;if("boolean"==typeof a)return zi;if("number"==typeof a)return Mn;if(a instanceof si)return Ys;if(a instanceof fd)return ri;if(a instanceof Ur)return rh;if(a instanceof zs)return uc;if(Array.isArray(a)){const s=a.length;let c;for(const d of a){const m=wo(d);if(c){if(c===m)continue;c=li;break}c=m}return qa(c||li,s)}return Da}function Mu(a){const s=typeof a;return null===a?"":"string"===s||"number"===s||"boolean"===s?String(a):a instanceof si||a instanceof Ur||a instanceof zs?a.toString():JSON.stringify(a)}class pd{constructor(s,c){this.type=s,this.value=c}static parse(s,c){if(2!==s.length)return c.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!yr(s[1]))return c.error("invalid value");const d=s[1];let m=wo(d);const y=c.expectedType;return"array"!==m.kind||0!==m.N||!y||"array"!==y.kind||"number"==typeof y.N&&0!==y.N||(m=y),new pd(m,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof si?["rgba"].concat(this.value.toArray()):this.value instanceof Ur?this.value.serialize():this.value}}var Za=pd,rs=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const jc={string:Gi,number:Mn,boolean:zi,object:Da};class kf{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");let d,m=1;const y=s[0];if("array"===y){let E,T;if(s.length>2){const M=s[1];if("string"!=typeof M||!(M in jc)||"object"===M)return c.error('The item type argument of "array" must be one of string, number, boolean',1);E=jc[M],m++}else E=li;if(s.length>3){if(null!==s[2]&&("number"!=typeof s[2]||s[2]<0||s[2]!==Math.floor(s[2])))return c.error('The length argument to "array" must be a positive integer literal',2);T=s[2],m++}d=qa(E,T)}else d=jc[y];const x=[];for(;m<s.length;m++){const E=c.parse(s[m],m,li);if(!E)return null;x.push(E)}return new kf(d,x)}evaluate(s){for(let c=0;c<this.args.length;c++){const d=this.args[c].evaluate(s);if(!Ai(this.type,wo(d)))return d;if(c===this.args.length-1)throw new rs(`Expected value to be of type ${Wt(this.type)}, but found ${Wt(wo(d))} instead.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,c=[s.kind];if("array"===s.kind){const d=s.itemType;if("string"===d.kind||"number"===d.kind||"boolean"===d.kind){c.push(d.kind);const m=s.N;("number"==typeof m||this.args.length>1)&&c.push(m)}}return c.concat(this.args.map(d=>d.serialize()))}}var da=kf;class $c{constructor(s){this.type=rh,this.sections=s}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const d=s[1];if(!Array.isArray(d)&&"object"==typeof d)return c.error("First argument must be an image or text section.");const m=[];let y=!1;for(let x=1;x<=s.length-1;++x){const E=s[x];if(y&&"object"==typeof E&&!Array.isArray(E)){y=!1;let T=null;if(E["font-scale"]&&(T=c.parse(E["font-scale"],1,Mn),!T))return null;let M=null;if(E["text-font"]&&(M=c.parse(E["text-font"],1,qa(Gi)),!M))return null;let F=null;if(E["text-color"]&&(F=c.parse(E["text-color"],1,Ys),!F))return null;const B=m[m.length-1];B.scale=T,B.font=M,B.textColor=F}else{const T=c.parse(s[x],1,li);if(!T)return null;const M=T.type.kind;if("string"!==M&&"value"!==M&&"null"!==M&&"resolvedImage"!==M)return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:T,scale:null,font:null,textColor:null})}}return new $c(m)}evaluate(s){return new Ur(this.sections.map(c=>{const d=c.content.evaluate(s);return wo(d)===uc?new Su("",d,null,null,null):new Su(Mu(d),null,c.scale?c.scale.evaluate(s):null,c.font?c.font.evaluate(s).join(","):null,c.textColor?c.textColor.evaluate(s):null)}))}eachChild(s){for(const c of this.sections)s(c.content),c.scale&&s(c.scale),c.font&&s(c.font),c.textColor&&s(c.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const c of this.sections){s.push(c.content.serialize());const d={};c.scale&&(d["font-scale"]=c.scale.serialize()),c.font&&(d["text-font"]=c.font.serialize()),c.textColor&&(d["text-color"]=c.textColor.serialize()),s.push(d)}return s}}class md{constructor(s){this.type=uc,this.input=s}static parse(s,c){if(2!==s.length)return c.error("Expected two arguments.");const d=c.parse(s[1],1,Gi);return d?new md(d):c.error("No image name provided.")}evaluate(s){const c=this.input.evaluate(s),d=zs.fromString(c);return d&&s.availableImages&&(d.available=s.availableImages.indexOf(c)>-1),d}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const w0={"to-boolean":zi,"to-color":Ys,"to-number":Mn,"to-string":Gi};class ah{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const d=s[0];if(("to-boolean"===d||"to-string"===d)&&2!==s.length)return c.error("Expected one argument.");const m=w0[d],y=[];for(let x=1;x<s.length;x++){const E=c.parse(s[x],x,li);if(!E)return null;y.push(E)}return new ah(m,y)}evaluate(s){if("boolean"===this.type.kind)return!!this.args[0].evaluate(s);if("color"===this.type.kind){let c,d;for(const m of this.args){if(c=m.evaluate(s),d=null,c instanceof si)return c;if("string"==typeof c){const y=s.parseColor(c);if(y)return y}else if(Array.isArray(c)&&(d=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:sh(c[0],c[1],c[2],c[3]),!d))return new si(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new rs(d||`Could not parse color from value '${"string"==typeof c?c:String(JSON.stringify(c))}'`)}if("number"===this.type.kind){let c=null;for(const d of this.args){if(c=d.evaluate(s),null===c)return 0;const m=Number(c);if(!isNaN(m))return m}throw new rs(`Could not convert ${JSON.stringify(c)} to number.`)}return"formatted"===this.type.kind?Ur.fromString(Mu(this.args[0].evaluate(s))):"resolvedImage"===this.type.kind?zs.fromString(Mu(this.args[0].evaluate(s))):Mu(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if("formatted"===this.type.kind)return new $c([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new md(this.args[0]).serialize();const s=[`to-${this.type.kind}`];return this.eachChild(c=>{s.push(c.serialize())}),s}}var Rl=ah;const Eo=["Unknown","Point","LineString","Polygon"];var Hc=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Eo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-a[0])+this.featureDistanceData.bearing[1]*(d*s-a[1])}return 0}parseColor(a){let s=this._parseColorCache[a];return s||(s=this._parseColorCache[a]=si.parse(a)),s}};class hl{constructor(s,c,d,m){this.name=s,this.type=c,this._evaluate=d,this.args=m}evaluate(s){return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,c){const d=s[0],m=hl.definitions[d];if(!m)return c.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,E=x.filter(([M])=>!Array.isArray(M)||M.length===s.length-1);let T=null;for(const[M,F]of E){T=new Ja(c.registry,c.path,null,c.scope);const B=[];let V=!1;for(let j=1;j<s.length;j++){const G=s[j],Q=Array.isArray(M)?M[j-1]:M.type,re=T.parse(G,1+B.length,Q);if(!re){V=!0;break}B.push(re)}if(!V)if(Array.isArray(M)&&M.length!==B.length)T.error(`Expected ${M.length} arguments, but found ${B.length} instead.`);else{for(let j=0;j<B.length;j++){const G=Array.isArray(M)?M[j]:M.type,Q=B[j];T.concat(j+1).checkSubtype(G,Q.type)}if(0===T.errors.length)return new hl(d,y,F,B)}}if(1===E.length)c.errors.push(...T.errors);else{const M=(E.length?E:x).map(([B])=>{return V=B,Array.isArray(V)?`(${V.map(Wt).join(", ")})`:`(${Wt(V.type)}...)`;var V}).join(" | "),F=[];for(let B=1;B<s.length;B++){const V=c.parse(s[B],1+F.length);if(!V)return null;F.push(Wt(V.type))}c.error(`Expected arguments of type ${M}, but found (${F.join(", ")}) instead.`)}return null}static register(s,c){hl.definitions=c;for(const d in c)s[d]=hl}}var os=hl;class gd{constructor(s,c,d){this.type=ri,this.locale=d,this.caseSensitive=s,this.diacriticSensitive=c}static parse(s,c){if(2!==s.length)return c.error("Expected one argument.");const d=s[1];if("object"!=typeof d||Array.isArray(d))return c.error("Collator options argument must be an object.");const m=c.parse(void 0!==d["case-sensitive"]&&d["case-sensitive"],1,zi);if(!m)return null;const y=c.parse(void 0!==d["diacritic-sensitive"]&&d["diacritic-sensitive"],1,zi);if(!y)return null;let x=null;return d.locale&&(x=c.parse(d.locale,1,Gi),!x)?null:new gd(m,y,x)}evaluate(s){return new fd(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}const Ka=8192;function _d(a,s){a[0]=Math.min(a[0],s[0]),a[1]=Math.min(a[1],s[1]),a[2]=Math.max(a[2],s[0]),a[3]=Math.max(a[3],s[1])}function ha(a,s){return!(a[0]<=s[0]||a[2]>=s[2]||a[1]<=s[1]||a[3]>=s[3])}function yd(a,s){const c=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,m=Math.pow(2,s.z);return[Math.round(c*m*Ka),Math.round(d*m*Ka)]}function Ya(a,s,c){const d=a[0]-s[0],m=a[1]-s[1],y=a[0]-c[0],x=a[1]-c[1];return d*x-y*m==0&&d*y<=0&&m*x<=0}function lh(a,s){let c=!1;for(let x=0,E=s.length;x<E;x++){const T=s[x];for(let M=0,F=T.length;M<F-1;M++){if(Ya(a,T[M],T[M+1]))return!1;(m=T[M])[1]>(d=a)[1]!=(y=T[M+1])[1]>d[1]&&d[0]<(y[0]-m[0])*(d[1]-m[1])/(y[1]-m[1])+m[0]&&(c=!c)}}var d,m,y;return c}function it(a,s){for(let c=0;c<s.length;c++)if(lh(a,s[c]))return!0;return!1}function Pu(a,s,c,d){const m=d[0]-c[0],y=d[1]-c[1],x=(a[0]-c[0])*y-m*(a[1]-c[1]),E=(s[0]-c[0])*y-m*(s[1]-c[1]);return x>0&&E<0||x<0&&E>0}function xn(a,s,c){for(const M of c)for(let F=0;F<M.length-1;++F)if((E=[(x=M[F+1])[0]-(y=M[F])[0],x[1]-y[1]])[0]*(T=[(m=s)[0]-(d=a)[0],m[1]-d[1]])[1]-E[1]*T[0]!=0&&Pu(d,m,y,x)&&Pu(y,x,d,m))return!0;var d,m,y,x,E,T;return!1}function or(a,s){for(let c=0;c<a.length;++c)if(!lh(a[c],s))return!1;for(let c=0;c<a.length-1;++c)if(xn(a[c],a[c+1],s))return!1;return!0}function Rf(a,s){for(let c=0;c<s.length;c++)if(or(a,s[c]))return!0;return!1}function Xa(a,s,c){const d=[];for(let m=0;m<a.length;m++){const y=[];for(let x=0;x<a[m].length;x++){const E=yd(a[m][x],c);_d(s,E),y.push(E)}d.push(y)}return d}function Pg(a,s,c){const d=[];for(let m=0;m<a.length;m++){const y=Xa(a[m],s,c);d.push(y)}return d}function vd(a,s,c,d){if(a[0]<c[0]||a[0]>c[2]){const m=.5*d;let y=a[0]-c[0]>m?-d:c[0]-a[0]>m?d:0;0===y&&(y=a[0]-c[2]>m?-d:c[2]-a[0]>m?d:0),a[0]+=y}_d(s,a)}function fl(a,s,c,d){const m=Math.pow(2,d.z)*Ka,y=[d.x*Ka,d.y*Ka],x=[];if(!a)return x;for(const E of a)for(const T of E){const M=[T.x+y[0],T.y+y[1]];vd(M,s,c,m),x.push(M)}return x}function Ds(a,s,c,d){const m=Math.pow(2,d.z)*Ka,y=[d.x*Ka,d.y*Ka],x=[];if(!a)return x;for(const T of a){const M=[];for(const F of T){const B=[F.x+y[0],F.y+y[1]];_d(s,B),M.push(B)}x.push(M)}if(s[2]-s[0]<=m/2){(E=s)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const T of x)for(const M of T)vd(M,s,c,m)}var E;return x}class fa{constructor(s,c){this.type=zi,this.geojson=s,this.geometries=c}static parse(s,c){if(2!==s.length)return c.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(yr(s[1])){const d=s[1];if("FeatureCollection"===d.type)for(let m=0;m<d.features.length;++m){const y=d.features[m].geometry.type;if("Polygon"===y||"MultiPolygon"===y)return new fa(d,d.features[m].geometry)}else if("Feature"===d.type){const m=d.geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new fa(d,d.geometry)}else if("Polygon"===d.type||"MultiPolygon"===d.type)return new fa(d,d)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(null!=s.geometry()&&null!=s.canonicalID()){if("Point"===s.geometryType())return function(c,d){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if("Polygon"===d.type){const E=Xa(d.coordinates,y,x),T=fl(c.geometry(),m,y,x);if(!ha(m,y))return!1;for(const M of T)if(!lh(M,E))return!1}if("MultiPolygon"===d.type){const E=Pg(d.coordinates,y,x),T=fl(c.geometry(),m,y,x);if(!ha(m,y))return!1;for(const M of T)if(!it(M,E))return!1}return!0}(s,this.geometries);if("LineString"===s.geometryType())return function(c,d){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if("Polygon"===d.type){const E=Xa(d.coordinates,y,x),T=Ds(c.geometry(),m,y,x);if(!ha(m,y))return!1;for(const M of T)if(!or(M,E))return!1}if("MultiPolygon"===d.type){const E=Pg(d.coordinates,y,x),T=Ds(c.geometry(),m,y,x);if(!ha(m,y))return!1;for(const M of T)if(!Rf(M,E))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Us=fa;function js(a){if(a instanceof os&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Us)return!1;let s=!0;return a.eachChild(c=>{s&&!js(c)&&(s=!1)}),s}function Yi(a){if(a instanceof os&&"feature-state"===a.name)return!1;let s=!0;return a.eachChild(c=>{s&&!Yi(c)&&(s=!1)}),s}function pl(a,s){if(a instanceof os&&s.indexOf(a.name)>=0)return!1;let c=!0;return a.eachChild(d=>{c&&!pl(d,s)&&(c=!1)}),c}class Qa{constructor(s,c){this.type=c.type,this.name=s,this.boundExpression=c}static parse(s,c){if(2!==s.length||"string"!=typeof s[1])return c.error("'var' expression requires exactly one string literal argument.");const d=s[1];return c.scope.has(d)?new Qa(d,c.scope.get(d)):c.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var ch=Qa;class Ol{constructor(s,c=[],d,m=new qp,y=[]){this.registry=s,this.path=c,this.key=c.map(x=>`[${x}]`).join(""),this.scope=m,this.errors=y,this.expectedType=d}parse(s,c,d,m,y={}){return c?this.concat(c,d,m)._parse(s,y):this._parse(s,y)}_parse(s,c){function d(m,y,x){return"assert"===x?new da(y,[m]):"coerce"===x?new Rl(y,[m]):m}if(null!==s&&"string"!=typeof s&&"boolean"!=typeof s&&"number"!=typeof s||(s=["literal",s]),Array.isArray(s)){if(0===s.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=s[0];if("string"!=typeof m)return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[m];if(y){let x=y.parse(s,this);if(!x)return null;if(this.expectedType){const E=this.expectedType,T=x.type;if("string"!==E.kind&&"number"!==E.kind&&"boolean"!==E.kind&&"object"!==E.kind&&"array"!==E.kind||"value"!==T.kind)if("color"!==E.kind&&"formatted"!==E.kind&&"resolvedImage"!==E.kind||"value"!==T.kind&&"string"!==T.kind){if(this.checkSubtype(E,T))return null}else x=d(x,E,c.typeAnnotation||"coerce");else x=d(x,E,c.typeAnnotation||"assert")}if(!(x instanceof Za)&&"resolvedImage"!==x.type.kind&&hc(x)){const E=new Hc;try{x=new Za(x.type,x.evaluate(E))}catch(T){return this.error(T.message),null}}return x}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===s?"'undefined' value invalid. Use null instead.":"object"==typeof s?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,c,d){const m="number"==typeof s?this.path.concat(s):this.path,y=d?this.scope.concat(d):this.scope;return new Ol(this.registry,m,c||null,y,this.errors)}error(s,...c){const d=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new Ts(d,s))}checkSubtype(s,c){const d=Ai(s,c);return d&&this.error(d),d}}var Ja=Ol;function hc(a){if(a instanceof ch)return hc(a.boundExpression);if(a instanceof os&&"error"===a.name||a instanceof gd||a instanceof Us)return!1;const s=a instanceof Rl||a instanceof da;let c=!0;return a.eachChild(d=>{c=s?c&&hc(d):c&&d instanceof Za}),!!c&&js(a)&&pl(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Gc(a,s){const c=a.length-1;let d,m,y=0,x=c,E=0;for(;y<=x;)if(E=Math.floor((y+x)/2),d=a[E],m=a[E+1],d<=s){if(E===c||s<m)return E;y=E+1}else{if(!(d>s))throw new rs("Input is not a number.");x=E-1}return 0}class As{constructor(s,c,d){this.type=s,this.input=c,this.labels=[],this.outputs=[];for(const[m,y]of d)this.labels.push(m),this.outputs.push(y)}static parse(s,c){if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");const d=c.parse(s[1],1,Mn);if(!d)return null;const m=[];let y=null;c.expectedType&&"value"!==c.expectedType.kind&&(y=c.expectedType);for(let x=1;x<s.length;x+=2){const E=1===x?-1/0:s[x],T=s[x+1],M=x,F=x+1;if("number"!=typeof E)return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(m.length&&m[m.length-1][0]>=E)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const B=c.parse(T,F,y);if(!B)return null;y=y||B.type,m.push([E,B])}return new As(y,d,m)}evaluate(s){const c=this.labels,d=this.outputs;if(1===c.length)return d[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return d[0].evaluate(s);const y=c.length;return m>=c[y-1]?d[y-1].evaluate(s):d[Gc(c,m)].evaluate(s)}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&s.push(this.labels[c]),s.push(this.outputs[c].serialize());return s}}var ku=As;function tr(a,s,c){return a*(1-c)+s*c}var fc=Object.freeze({__proto__:null,array:function(a,s,c){return a.map((d,m)=>tr(d,s[m],c))},color:function(a,s,c){return new si(tr(a.r,s.r,c),tr(a.g,s.g,c),tr(a.b,s.b,c),tr(a.a,s.a,c))},number:tr});const uh=4/29,Wc=6/29,Ru=3*Wc*Wc,Of=Wc*Wc*Wc,Ff=Math.PI/180,Qs=180/Math.PI;function bd(a){return a>Of?Math.pow(a,1/3):a/Ru+uh}function wd(a){return a>Wc?a*a*a:Ru*(a-uh)}function Ed(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Cd(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function dh(a){const s=Cd(a.r),c=Cd(a.g),d=Cd(a.b),m=bd((.4124564*s+.3575761*c+.1804375*d)/.95047),y=bd((.2126729*s+.7151522*c+.072175*d)/1);return{l:116*y-16,a:500*(m-y),b:200*(y-bd((.0193339*s+.119192*c+.9503041*d)/1.08883)),alpha:a.a}}function Id(a){let s=(a.l+16)/116,c=isNaN(a.a)?s:s+a.a/500,d=isNaN(a.b)?s:s-a.b/200;return s=1*wd(s),c=.95047*wd(c),d=1.08883*wd(d),new si(Ed(3.2404542*c-1.5371385*s-.4985314*d),Ed(-.969266*c+1.8760108*s+.041556*d),Ed(.0556434*c-.2040259*s+1.0572252*d),a.alpha)}function hh(a,s,c){const d=s-a;return a+c*(d>180||d<-180?d-360*Math.round(d/360):d)}const Ou={forward:dh,reverse:Id,interpolate:function(a,s,c){return{l:tr(a.l,s.l,c),a:tr(a.a,s.a,c),b:tr(a.b,s.b,c),alpha:tr(a.alpha,s.alpha,c)}}},pc={forward:function(a){const{l:s,a:c,b:d}=dh(a),m=Math.atan2(d,c)*Qs;return{h:m<0?m+360:m,c:Math.sqrt(c*c+d*d),l:s,alpha:a.a}},reverse:function(a){const s=a.h*Ff,c=a.c;return Id({l:a.l,a:Math.cos(s)*c,b:Math.sin(s)*c,alpha:a.alpha})},interpolate:function(a,s,c){return{h:hh(a.h,s.h,c),c:tr(a.c,s.c,c),l:tr(a.l,s.l,c),alpha:tr(a.alpha,s.alpha,c)}}};var fh=Object.freeze({__proto__:null,hcl:pc,lab:Ou});class Wi{constructor(s,c,d,m,y){this.type=s,this.operator=c,this.interpolation=d,this.input=m,this.labels=[],this.outputs=[];for(const[x,E]of y)this.labels.push(x),this.outputs.push(E)}static interpolationFactor(s,c,d,m){let y=0;if("exponential"===s.name)y=Lf(c,s.base,d,m);else if("linear"===s.name)y=Lf(c,1,d,m);else if("cubic-bezier"===s.name){const x=s.controlPoints;y=new Le(x[0],x[1],x[2],x[3]).solve(Lf(c,1,d,m))}return y}static parse(s,c){let[d,m,y,...x]=s;if(!Array.isArray(m)||0===m.length)return c.error("Expected an interpolation type expression.",1);if("linear"===m[0])m={name:"linear"};else if("exponential"===m[0]){const M=m[1];if("number"!=typeof M)return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:M}}else{if("cubic-bezier"!==m[0])return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const M=m.slice(1);if(4!==M.length||M.some(F=>"number"!=typeof F||F<0||F>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:M}}}if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(y=c.parse(y,2,Mn),!y)return null;const E=[];let T=null;"interpolate-hcl"===d||"interpolate-lab"===d?T=Ys:c.expectedType&&"value"!==c.expectedType.kind&&(T=c.expectedType);for(let M=0;M<x.length;M+=2){const F=x[M],B=x[M+1],V=M+3,j=M+4;if("number"!=typeof F)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(E.length&&E[E.length-1][0]>=F)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const G=c.parse(B,j,T);if(!G)return null;T=T||G.type,E.push([F,G])}return"number"===T.kind||"color"===T.kind||"array"===T.kind&&"number"===T.itemType.kind&&"number"==typeof T.N?new Wi(T,d,m,y,E):c.error(`Type ${Wt(T)} is not interpolatable.`)}evaluate(s){const c=this.labels,d=this.outputs;if(1===c.length)return d[0].evaluate(s);const m=this.input.evaluate(s);if(m<=c[0])return d[0].evaluate(s);const y=c.length;if(m>=c[y-1])return d[y-1].evaluate(s);const x=Gc(c,m),E=Wi.interpolationFactor(this.interpolation,m,c[x],c[x+1]),T=d[x].evaluate(s),M=d[x+1].evaluate(s);return"interpolate"===this.operator?fc[this.type.kind.toLowerCase()](T,M,E):"interpolate-hcl"===this.operator?pc.reverse(pc.interpolate(pc.forward(T),pc.forward(M),E)):Ou.reverse(Ou.interpolate(Ou.forward(T),Ou.forward(M),E))}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,s,this.input.serialize()];for(let d=0;d<this.labels.length;d++)c.push(this.labels[d],this.outputs[d].serialize());return c}}function Lf(a,s,c,d){const m=d-c,y=a-c;return 0===m?0:1===s?y/m:(Math.pow(s,y)-1)/(Math.pow(s,m)-1)}var Aa=Wi;class ph{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expectected at least one argument.");let d=null;const m=c.expectedType;m&&"value"!==m.kind&&(d=m);const y=[];for(const E of s.slice(1)){const T=c.parse(E,1+y.length,d,void 0,{typeAnnotation:"omit"});if(!T)return null;d=d||T.type,y.push(T)}const x=m&&y.some(E=>Ai(m,E.type));return new ph(x?li:d,y)}evaluate(s){let c,d=null,m=0;for(const y of this.args){if(m++,d=y.evaluate(s),d&&d instanceof zs&&!d.available&&(c||(c=d),d=null,m===this.args.length))return c;if(null!==d)break}return d}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var qi=ph;class mc{constructor(s,c){this.type=c.type,this.bindings=[].concat(s),this.result=c}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const c of this.bindings)s(c[1]);s(this.result)}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const d=[];for(let y=1;y<s.length-1;y+=2){const x=s[y];if("string"!=typeof x)return c.error(`Expected string, but found ${typeof x} instead.`,y);if(/[^a-zA-Z0-9_]/.test(x))return c.error("Variable names must contain only alphanumeric characters or '_'.",y);const E=c.parse(s[y+1],y+1);if(!E)return null;d.push([x,E])}const m=c.parse(s[s.length-1],s.length-1,c.expectedType,d);return m?new mc(d,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[c,d]of this.bindings)s.push(c,d.serialize());return s.push(this.result.serialize()),s}}var Td=mc;class On{constructor(s,c,d){this.type=s,this.index=c,this.input=d}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,Mn),m=c.parse(s[2],2,qa(c.expectedType||li));return d&&m?new On(m.type.itemType,d,m):null}evaluate(s){const c=this.index.evaluate(s),d=this.input.evaluate(s);if(c<0)throw new rs(`Array index out of bounds: ${c} < 0.`);if(c>=d.length)throw new rs(`Array index out of bounds: ${c} > ${d.length-1}.`);if(c!==Math.floor(c))throw new rs(`Array index must be an integer, but found ${c} instead.`);return d[c]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ss=On;class nr{constructor(s,c){this.type=zi,this.needle=s,this.haystack=c}static parse(s,c){if(3!==s.length)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,li),m=c.parse(s[2],2,li);return d&&m?dc(d.type,[zi,Gi,Mn,hd,li])?new nr(d,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wt(d.type)} instead`):null}evaluate(s){const c=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(null==d)return!1;if(!Du(c,["boolean","string","number","null"]))throw new rs(`Expected first argument to be of type boolean, string, number or null, but found ${Wt(wo(c))} instead.`);if(!Du(d,["string","array"]))throw new rs(`Expected second argument to be of type array or string, but found ${Wt(wo(d))} instead.`);return d.indexOf(c)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Co=nr;class qo{constructor(s,c,d){this.type=Mn,this.needle=s,this.haystack=c,this.fromIndex=d}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,li),m=c.parse(s[2],2,li);if(!d||!m)return null;if(!dc(d.type,[zi,Gi,Mn,hd,li]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wt(d.type)} instead`);if(4===s.length){const y=c.parse(s[3],3,Mn);return y?new qo(d,m,y):null}return new qo(d,m)}evaluate(s){const c=this.needle.evaluate(s),d=this.haystack.evaluate(s);if(!Du(c,["boolean","string","number","null"]))throw new rs(`Expected first argument to be of type boolean, string, number or null, but found ${Wt(wo(c))} instead.`);if(!Du(d,["string","array"]))throw new rs(`Expected second argument to be of type array or string, but found ${Wt(wo(d))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(s);return d.indexOf(c,m)}return d.indexOf(c)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Ll=qo;class $s{constructor(s,c,d,m,y,x){this.inputType=s,this.type=c,this.input=d,this.cases=m,this.outputs=y,this.otherwise=x}static parse(s,c){if(s.length<5)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return c.error("Expected an even number of arguments.");let d,m;c.expectedType&&"value"!==c.expectedType.kind&&(m=c.expectedType);const y={},x=[];for(let M=2;M<s.length-1;M+=2){let F=s[M];const B=s[M+1];Array.isArray(F)||(F=[F]);const V=c.concat(M);if(0===F.length)return V.error("Expected at least one branch label.");for(const G of F){if("number"!=typeof G&&"string"!=typeof G)return V.error("Branch labels must be numbers or strings.");if("number"==typeof G&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof G&&Math.floor(G)!==G)return V.error("Numeric branch labels must be integer values.");if(d){if(V.checkSubtype(d,wo(G)))return null}else d=wo(G);if(void 0!==y[String(G)])return V.error("Branch labels must be unique.");y[String(G)]=x.length}const j=c.parse(B,M,m);if(!j)return null;m=m||j.type,x.push(j)}const E=c.parse(s[1],1,li);if(!E)return null;const T=c.parse(s[s.length-1],s.length-1,m);return T?"value"!==E.type.kind&&c.concat(1).checkSubtype(d,E.type)?null:new $s(d,m,E,y,x,T):null}evaluate(s){const c=this.input.evaluate(s);return(wo(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),d=[],m={};for(const x of c){const E=m[this.cases[x]];void 0===E?(m[this.cases[x]]=d.length,d.push([this.cases[x],[x]])):d[E][1].push(x)}const y=x=>"number"===this.inputType.kind?Number(x):x;for(const[x,E]of d)s.push(1===E.length?y(E[0]):E.map(y)),s.push(this.outputs[x].serialize());return s.push(this.otherwise.serialize()),s}}var mh=$s;class gh{constructor(s,c,d){this.type=s,this.branches=c,this.otherwise=d}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return c.error("Expected an odd number of arguments.");let d;c.expectedType&&"value"!==c.expectedType.kind&&(d=c.expectedType);const m=[];for(let x=1;x<s.length-1;x+=2){const E=c.parse(s[x],x,zi);if(!E)return null;const T=c.parse(s[x+1],x+1,d);if(!T)return null;m.push([E,T]),d=d||T.type}const y=c.parse(s[s.length-1],s.length-1,d);return y?new gh(d,m,y):null}evaluate(s){for(const[c,d]of this.branches)if(c.evaluate(s))return d.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[c,d]of this.branches)s(c),s(d);s(this.otherwise)}outputDefined(){return this.branches.every(([s,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(c=>{s.push(c.serialize())}),s}}var qc=gh;class Fu{constructor(s,c,d,m){this.type=s,this.input=c,this.beginIndex=d,this.endIndex=m}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const d=c.parse(s[1],1,li),m=c.parse(s[2],2,Mn);if(!d||!m)return null;if(!dc(d.type,[qa(li),Gi,li]))return c.error(`Expected first argument to be of type array or string, but found ${Wt(d.type)} instead`);if(4===s.length){const y=c.parse(s[3],3,Mn);return y?new Fu(d.type,d,m,y):null}return new Fu(d.type,d,m)}evaluate(s){const c=this.input.evaluate(s),d=this.beginIndex.evaluate(s);if(!Du(c,["string","array"]))throw new rs(`Expected first argument to be of type array or string, but found ${Wt(wo(c))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(s);return c.slice(d,m)}return c.slice(d)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var _h=Fu;function eo(a,s){return"=="===a||"!="===a?"boolean"===s.kind||"string"===s.kind||"number"===s.kind||"null"===s.kind||"value"===s.kind:"string"===s.kind||"number"===s.kind||"value"===s.kind}function Nn(a,s,c,d){return 0===d.compare(s,c)}function Ci(a,s,c){const d="=="!==a&&"!="!==a;return class w${constructor(y,x,E){this.type=zi,this.lhs=y,this.rhs=x,this.collator=E,this.hasUntypedArgument="value"===y.type.kind||"value"===x.type.kind}static parse(y,x){if(3!==y.length&&4!==y.length)return x.error("Expected two or three arguments.");const E=y[0];let T=x.parse(y[1],1,li);if(!T)return null;if(!eo(E,T.type))return x.concat(1).error(`"${E}" comparisons are not supported for type '${Wt(T.type)}'.`);let M=x.parse(y[2],2,li);if(!M)return null;if(!eo(E,M.type))return x.concat(2).error(`"${E}" comparisons are not supported for type '${Wt(M.type)}'.`);if(T.type.kind!==M.type.kind&&"value"!==T.type.kind&&"value"!==M.type.kind)return x.error(`Cannot compare types '${Wt(T.type)}' and '${Wt(M.type)}'.`);d&&("value"===T.type.kind&&"value"!==M.type.kind?T=new da(M.type,[T]):"value"!==T.type.kind&&"value"===M.type.kind&&(M=new da(T.type,[M])));let F=null;if(4===y.length){if("string"!==T.type.kind&&"string"!==M.type.kind&&"value"!==T.type.kind&&"value"!==M.type.kind)return x.error("Cannot use collator to compare non-string types.");if(F=x.parse(y[3],3,ri),!F)return null}return new w$(T,M,F)}evaluate(y){const x=this.lhs.evaluate(y),E=this.rhs.evaluate(y);if(d&&this.hasUntypedArgument){const T=wo(x),M=wo(E);if(T.kind!==M.kind||"string"!==T.kind&&"number"!==T.kind)throw new rs(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${M.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const T=wo(x),M=wo(E);if("string"!==T.kind||"string"!==M.kind)return s(y,x,E)}return this.collator?c(y,x,E,this.collator.evaluate(y)):s(y,x,E)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[a];return this.eachChild(x=>{y.push(x.serialize())}),y}}}const Zr=Ci("==",function(a,s,c){return s===c},Nn),el=Ci("!=",function(a,s,c){return s!==c},function(a,s,c,d){return!Nn(0,s,c,d)}),Dd=Ci("<",function(a,s,c){return s<c},function(a,s,c,d){return d.compare(s,c)<0}),as=Ci(">",function(a,s,c){return s>c},function(a,s,c,d){return d.compare(s,c)>0}),Lu=Ci("<=",function(a,s,c){return s<=c},function(a,s,c,d){return d.compare(s,c)<=0}),Io=Ci(">=",function(a,s,c){return s>=c},function(a,s,c,d){return d.compare(s,c)>=0});class pa{constructor(s,c,d,m,y,x){this.type=Gi,this.number=s,this.locale=c,this.currency=d,this.unit=m,this.minFractionDigits=y,this.maxFractionDigits=x}static parse(s,c){if(3!==s.length)return c.error("Expected two arguments.");const d=c.parse(s[1],1,Mn);if(!d)return null;const m=s[2];if("object"!=typeof m||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let y=null;if(m.locale&&(y=c.parse(m.locale,1,Gi),!y))return null;let x=null;if(m.currency&&(x=c.parse(m.currency,1,Gi),!x))return null;let E=null;if(m.unit&&(E=c.parse(m.unit,1,Gi),!E))return null;let T=null;if(m["min-fraction-digits"]&&(T=c.parse(m["min-fraction-digits"],1,Mn),!T))return null;let M=null;return m["max-fraction-digits"]&&(M=c.parse(m["max-fraction-digits"],1,Mn),!M)?null:new pa(d,y,x,E,T,M)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class tl{constructor(s){this.type=Mn,this.input=s}static parse(s,c){if(2!==s.length)return c.error(`Expected 1 argument, but found ${s.length-1} instead.`);const d=c.parse(s[1],1);return d?"array"!==d.type.kind&&"string"!==d.type.kind&&"value"!==d.type.kind?c.error(`Expected argument of type string or array, but found ${Wt(d.type)} instead.`):new tl(d):null}evaluate(s){const c=this.input.evaluate(s);if("string"==typeof c||Array.isArray(c))return c.length;throw new rs(`Expected value to be of type string or array, but found ${Wt(wo(c))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(c=>{s.push(c.serialize())}),s}}const Ii={"==":Zr,"!=":el,">":as,"<":Dd,">=":Io,"<=":Lu,array:da,at:ss,boolean:da,case:qc,coalesce:qi,collator:gd,format:$c,image:md,in:Co,"index-of":Ll,interpolate:Aa,"interpolate-hcl":Aa,"interpolate-lab":Aa,length:tl,let:Td,literal:Za,match:mh,number:da,"number-format":pa,object:da,slice:_h,step:ku,string:da,"to-boolean":Rl,"to-color":Rl,"to-number":Rl,"to-string":Rl,var:ch,within:Us};function Nu(a,[s,c,d,m]){s=s.evaluate(a),c=c.evaluate(a),d=d.evaluate(a);const y=m?m.evaluate(a):1,x=sh(s,c,d,y);if(x)throw new rs(x);return new si(s/255*y,c/255*y,d/255*y,y)}function Sa(a,s){return a in s}function Nl(a,s){const c=s[a];return void 0===c?null:c}function hr(a){return{type:a}}os.register(Ii,{error:[{kind:"error"},[Gi],(a,[s])=>{throw new rs(s.evaluate(a))}],typeof:[Gi,[li],(a,[s])=>Wt(wo(s.evaluate(a)))],"to-rgba":[qa(Mn,4),[Ys],(a,[s])=>s.evaluate(a).toArray()],rgb:[Ys,[Mn,Mn,Mn],Nu],rgba:[Ys,[Mn,Mn,Mn,Mn],Nu],has:{type:zi,overloads:[[[Gi],(a,[s])=>Sa(s.evaluate(a),a.properties())],[[Gi,Da],(a,[s,c])=>Sa(s.evaluate(a),c.evaluate(a))]]},get:{type:li,overloads:[[[Gi],(a,[s])=>Nl(s.evaluate(a),a.properties())],[[Gi,Da],(a,[s,c])=>Nl(s.evaluate(a),c.evaluate(a))]]},"feature-state":[li,[Gi],(a,[s])=>Nl(s.evaluate(a),a.featureState||{})],properties:[Da,[],a=>a.properties()],"geometry-type":[Gi,[],a=>a.geometryType()],id:[li,[],a=>a.id()],zoom:[Mn,[],a=>a.globals.zoom],pitch:[Mn,[],a=>a.globals.pitch||0],"distance-from-center":[Mn,[],a=>a.distanceFromCenter()],"heatmap-density":[Mn,[],a=>a.globals.heatmapDensity||0],"line-progress":[Mn,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[Mn,[],a=>a.globals.skyRadialProgress||0],accumulated:[li,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[Mn,hr(Mn),(a,s)=>{let c=0;for(const d of s)c+=d.evaluate(a);return c}],"*":[Mn,hr(Mn),(a,s)=>{let c=1;for(const d of s)c*=d.evaluate(a);return c}],"-":{type:Mn,overloads:[[[Mn,Mn],(a,[s,c])=>s.evaluate(a)-c.evaluate(a)],[[Mn],(a,[s])=>-s.evaluate(a)]]},"/":[Mn,[Mn,Mn],(a,[s,c])=>s.evaluate(a)/c.evaluate(a)],"%":[Mn,[Mn,Mn],(a,[s,c])=>s.evaluate(a)%c.evaluate(a)],ln2:[Mn,[],()=>Math.LN2],pi:[Mn,[],()=>Math.PI],e:[Mn,[],()=>Math.E],"^":[Mn,[Mn,Mn],(a,[s,c])=>Math.pow(s.evaluate(a),c.evaluate(a))],sqrt:[Mn,[Mn],(a,[s])=>Math.sqrt(s.evaluate(a))],log10:[Mn,[Mn],(a,[s])=>Math.log(s.evaluate(a))/Math.LN10],ln:[Mn,[Mn],(a,[s])=>Math.log(s.evaluate(a))],log2:[Mn,[Mn],(a,[s])=>Math.log(s.evaluate(a))/Math.LN2],sin:[Mn,[Mn],(a,[s])=>Math.sin(s.evaluate(a))],cos:[Mn,[Mn],(a,[s])=>Math.cos(s.evaluate(a))],tan:[Mn,[Mn],(a,[s])=>Math.tan(s.evaluate(a))],asin:[Mn,[Mn],(a,[s])=>Math.asin(s.evaluate(a))],acos:[Mn,[Mn],(a,[s])=>Math.acos(s.evaluate(a))],atan:[Mn,[Mn],(a,[s])=>Math.atan(s.evaluate(a))],min:[Mn,hr(Mn),(a,s)=>Math.min(...s.map(c=>c.evaluate(a)))],max:[Mn,hr(Mn),(a,s)=>Math.max(...s.map(c=>c.evaluate(a)))],abs:[Mn,[Mn],(a,[s])=>Math.abs(s.evaluate(a))],round:[Mn,[Mn],(a,[s])=>{const c=s.evaluate(a);return c<0?-Math.round(-c):Math.round(c)}],floor:[Mn,[Mn],(a,[s])=>Math.floor(s.evaluate(a))],ceil:[Mn,[Mn],(a,[s])=>Math.ceil(s.evaluate(a))],"filter-==":[zi,[Gi,li],(a,[s,c])=>a.properties()[s.value]===c.value],"filter-id-==":[zi,[li],(a,[s])=>a.id()===s.value],"filter-type-==":[zi,[Gi],(a,[s])=>a.geometryType()===s.value],"filter-<":[zi,[Gi,li],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d<m}],"filter-id-<":[zi,[li],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c<d}],"filter->":[zi,[Gi,li],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d>m}],"filter-id->":[zi,[li],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c>d}],"filter-<=":[zi,[Gi,li],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d<=m}],"filter-id-<=":[zi,[li],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c<=d}],"filter->=":[zi,[Gi,li],(a,[s,c])=>{const d=a.properties()[s.value],m=c.value;return typeof d==typeof m&&d>=m}],"filter-id->=":[zi,[li],(a,[s])=>{const c=a.id(),d=s.value;return typeof c==typeof d&&c>=d}],"filter-has":[zi,[li],(a,[s])=>s.value in a.properties()],"filter-has-id":[zi,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[zi,[qa(Gi)],(a,[s])=>s.value.indexOf(a.geometryType())>=0],"filter-id-in":[zi,[qa(li)],(a,[s])=>s.value.indexOf(a.id())>=0],"filter-in-small":[zi,[Gi,qa(li)],(a,[s,c])=>c.value.indexOf(a.properties()[s.value])>=0],"filter-in-large":[zi,[Gi,qa(li)],(a,[s,c])=>function(d,m,y,x){for(;y<=x;){const E=y+x>>1;if(m[E]===d)return!0;m[E]>d?x=E-1:y=E+1}return!1}(a.properties()[s.value],c.value,0,c.value.length-1)],all:{type:zi,overloads:[[[zi,zi],(a,[s,c])=>s.evaluate(a)&&c.evaluate(a)],[hr(zi),(a,s)=>{for(const c of s)if(!c.evaluate(a))return!1;return!0}]]},any:{type:zi,overloads:[[[zi,zi],(a,[s,c])=>s.evaluate(a)||c.evaluate(a)],[hr(zi),(a,s)=>{for(const c of s)if(c.evaluate(a))return!0;return!1}]]},"!":[zi,[zi],(a,[s])=>!s.evaluate(a)],"is-supported-script":[zi,[Gi],(a,[s])=>{const c=a.globals&&a.globals.isSupportedScript;return!c||c(s.evaluate(a))}],upcase:[Gi,[Gi],(a,[s])=>s.evaluate(a).toUpperCase()],downcase:[Gi,[Gi],(a,[s])=>s.evaluate(a).toLowerCase()],concat:[Gi,hr(li),(a,s)=>s.map(c=>Mu(c.evaluate(a))).join("")],"resolved-locale":[Gi,[ri],(a,[s])=>s.evaluate(a).resolvedLocale()]});var Bl=Ii;function Vl(a){return{result:"success",value:a}}function Ss(a){return{result:"error",value:a}}function Ma(a){return"data-driven"===a["property-type"]}function Ad(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function ma(a){return!!a.expression&&a.expression.interpolated}function Vi(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function zl(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function Zc(a){return a}function ji(a,s){const c="color"===s.type,d=a.stops&&"object"==typeof a.stops[0][0],m=d||!(d||void 0!==a.property),y=a.type||(ma(s)?"exponential":"interval");if(c&&((a=Po({},a)).stops&&(a.stops=a.stops.map(M=>[M[0],si.parse(M[1])])),a.default=si.parse(a.default?a.default:s.default)),a.colorSpace&&"rgb"!==a.colorSpace&&!fh[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let x,E,T;if("exponential"===y)x=ls;else if("interval"===y)x=Bu;else if("categorical"===y){x=Ul,E=Object.create(null);for(const M of a.stops)E[M[0]]=M[1];T=typeof a.stops[0][0]}else{if("identity"!==y)throw new Error(`Unknown function type "${y}"`);x=Md}if(d){const M={},F=[];for(let j=0;j<a.stops.length;j++){const G=a.stops[j],Q=G[0].zoom;void 0===M[Q]&&(M[Q]={zoom:Q,type:a.type,property:a.property,default:a.default,stops:[]},F.push(Q)),M[Q].stops.push([G[0].value,G[1]])}const B=[];for(const j of F)B.push([M[j].zoom,ji(M[j],s)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:Aa.interpolationFactor.bind(void 0,V),zoomStops:B.map(j=>j[0]),evaluate:({zoom:j},G)=>ls({stops:B,base:a.base},s,j).evaluate(j,G)}}if(m){const M="exponential"===y?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Aa.interpolationFactor.bind(void 0,M),zoomStops:a.stops.map(F=>F[0]),evaluate:({zoom:F})=>x(a,s,F,E,T)}}return{kind:"source",evaluate(M,F){const B=F&&F.properties?F.properties[a.property]:void 0;return void 0===B?Sd(a.default,s.default):x(a,s,B,E,T)}}}function Sd(a,s,c){return void 0!==a?a:void 0!==s?s:void 0!==c?c:void 0}function Ul(a,s,c,d,m){return Sd(typeof c===m?d[c]:void 0,a.default,s.default)}function Bu(a,s,c){if("number"!==Vi(c))return Sd(a.default,s.default);const d=a.stops.length;if(1===d||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[d-1][0])return a.stops[d-1][1];const m=Gc(a.stops.map(y=>y[0]),c);return a.stops[m][1]}function ls(a,s,c){const d=void 0!==a.base?a.base:1;if("number"!==Vi(c))return Sd(a.default,s.default);const m=a.stops.length;if(1===m||c<=a.stops[0][0])return a.stops[0][1];if(c>=a.stops[m-1][0])return a.stops[m-1][1];const y=Gc(a.stops.map(F=>F[0]),c),x=function(F,B,V,j){const G=j-V,Q=F-V;return 0===G?0:1===B?Q/G:(Math.pow(B,Q)-1)/(Math.pow(B,G)-1)}(c,d,a.stops[y][0],a.stops[y+1][0]),E=a.stops[y][1],T=a.stops[y+1][1];let M=fc[s.type]||Zc;if(a.colorSpace&&"rgb"!==a.colorSpace){const F=fh[a.colorSpace];M=(B,V)=>F.reverse(F.interpolate(F.forward(B),F.forward(V),x))}return"function"==typeof E.evaluate?{evaluate(...F){const B=E.evaluate.apply(void 0,F),V=T.evaluate.apply(void 0,F);if(void 0!==B&&void 0!==V)return M(B,V,x)}}:M(E,T,x)}function Md(a,s,c){return"color"===s.type?c=si.parse(c):"formatted"===s.type?c=Ur.fromString(c.toString()):"resolvedImage"===s.type?c=zs.fromString(c.toString()):Vi(c)===s.type||"enum"===s.type&&s.values[c]||(c=void 0),Sd(c,a.default,s.default)}class jl{constructor(s,c){var d;this.expression=s,this._warningHistory={},this._evaluator=new Hc,this._defaultValue=c?"color"===(d=c).type&&(zl(d.default)||Array.isArray(d.default))?new si(0,0,0,0):"color"===d.type?si.parse(d.default)||null:void 0===d.default?null:d.default:null,this._enumValues=c&&"enum"===c.type?c.values:null}evaluateWithoutErrorHandling(s,c,d,m,y,x,E,T){return this._evaluator.globals=s,this._evaluator.feature=c,this._evaluator.featureState=d,this._evaluator.canonical=m||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(s,c,d,m,y,x,E,T){this._evaluator.globals=s,this._evaluator.feature=c||null,this._evaluator.featureState=d||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=T||null;try{const M=this.expression.evaluate(this._evaluator);if(null==M||"number"==typeof M&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new rs(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function ml(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in Bl}function To(a,s){const c=new Ja(Bl,[],s?function(m){const y={color:Ys,string:Gi,number:Mn,enum:Gi,boolean:zi,formatted:rh,resolvedImage:uc};return"array"===m.type?qa(y[m.value]||li,m.length):y[m.type]}(s):void 0),d=c.parse(a,void 0,void 0,void 0,s&&"string"===s.type?{typeAnnotation:"coerce"}:void 0);return d?Vl(new jl(d,s)):Ss(c.errors)}class kg{constructor(s,c){this.kind=s,this._styleExpression=c,this.isStateDependent="constant"!==s&&!Yi(c.expression)}evaluateWithoutErrorHandling(s,c,d,m,y,x){return this._styleExpression.evaluateWithoutErrorHandling(s,c,d,m,y,x)}evaluate(s,c,d,m,y,x){return this._styleExpression.evaluate(s,c,d,m,y,x)}}class xs{constructor(s,c,d,m){this.kind=s,this.zoomStops=d,this._styleExpression=c,this.isStateDependent="camera"!==s&&!Yi(c.expression),this.interpolationType=m}evaluateWithoutErrorHandling(s,c,d,m,y,x){return this._styleExpression.evaluateWithoutErrorHandling(s,c,d,m,y,x)}evaluate(s,c,d,m,y,x){return this._styleExpression.evaluate(s,c,d,m,y,x)}interpolationFactor(s,c,d){return this.interpolationType?Aa.interpolationFactor(this.interpolationType,s,c,d):0}}function cs(a,s){if("error"===(a=To(a,s)).result)return a;const c=a.value.expression,d=js(c);if(!d&&!Ma(s))return Ss([new Ts("","data expressions not supported")]);const m=pl(c,["zoom","pitch","distance-from-center"]);if(!m&&!Ad(s))return Ss([new Ts("","zoom expressions not supported")]);const y=gl(c);return y||m?y instanceof Ts?Ss([y]):y instanceof Aa&&!ma(s)?Ss([new Ts("",'"interpolate" expressions cannot be used with this property')]):Vl(y?new xs(d?"camera":"composite",a.value,y.labels,y instanceof Aa?y.interpolation:void 0):new kg(d?"constant":"source",a.value)):Ss([new Ts("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class gc{constructor(s,c){this._parameters=s,this._specification=c,Po(this,ji(this._parameters,this._specification))}static deserialize(s){return new gc(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function gl(a){let s=null;if(a instanceof Td)s=gl(a.result);else if(a instanceof qi){for(const c of a.args)if(s=gl(c),s)break}else(a instanceof ku||a instanceof Aa)&&a.input instanceof os&&"zoom"===a.input.name&&(s=a);return s instanceof Ts||a.eachChild(c=>{const d=gl(c);d instanceof Ts?s=d:!s&&d?s=new Ts("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):s&&d&&s!==d&&(s=new Ts("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}class Tn{constructor(s,c,d,m){this.message=(s?`${s}: `:"")+d,m&&(this.identifier=m),null!=c&&c.__line__&&(this.line=c.__line__)}}function Bo(a){const s=a.key,c=a.value,d=a.valueSpec||{},m=a.objectElementValidators||{},y=a.style,x=a.styleSpec;let E=[];const T=Vi(c);if("object"!==T)return[new Tn(s,c,`object expected, ${T} found`)];for(const M in c){const F=M.split(".")[0];let B;m[F]?B=m[F]:d[F]?B=bs:m["*"]?B=m["*"]:d["*"]&&(B=bs),B?E=E.concat(B({key:(s&&`${s}.`)+M,value:c[M],valueSpec:d[F]||d["*"],style:y,styleSpec:x,object:c,objectKey:M},c)):E.push(new Tn(s,c[M],`unknown property "${M}"`))}for(const M in d)m[M]||d[M].required&&void 0===d[M].default&&void 0===c[M]&&E.push(new Tn(s,c,`missing required property "${M}"`));return E}function Nf(a){const s=a.value,c=a.valueSpec,d=a.style,m=a.styleSpec,y=a.key,x=a.arrayElementValidator||bs;if("array"!==Vi(s))return[new Tn(y,s,`array expected, ${Vi(s)} found`)];if(c.length&&s.length!==c.length)return[new Tn(y,s,`array length ${c.length} expected, length ${s.length} found`)];if(c["min-length"]&&s.length<c["min-length"])return[new Tn(y,s,`array length at least ${c["min-length"]} expected, length ${s.length} found`)];let E={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};m.$version<7&&(E.function=c.function),"object"===Vi(c.value)&&(E=c.value);let T=[];for(let M=0;M<s.length;M++)T=T.concat(x({array:s,arrayIndex:M,value:s[M],valueSpec:E,style:d,styleSpec:m,key:`${y}[${M}]`}));return T}function yh(a){const s=a.key,c=a.value,d=a.valueSpec;let m=Vi(c);if("number"===m&&c!=c&&(m="NaN"),"number"!==m)return[new Tn(s,c,`number expected, ${m} found`)];if("minimum"in d){let y=d.minimum;if("array"===Vi(d.minimum)&&(y=d.minimum[a.arrayIndex]),c<y)return[new Tn(s,c,`${c} is less than the minimum value ${y}`)]}if("maximum"in d){let y=d.maximum;if("array"===Vi(d.maximum)&&(y=d.maximum[a.arrayIndex]),c>y)return[new Tn(s,c,`${c} is greater than the maximum value ${y}`)]}return[]}function vh(a){const s=a.valueSpec,c=No(a.value.type);let d,m,y,x={};const E="categorical"!==c&&void 0===a.value.property,T=!E,M="array"===Vi(a.value.stops)&&"array"===Vi(a.value.stops[0])&&"object"===Vi(a.value.stops[0][0]),F=Bo({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(j){if("identity"===c)return[new Tn(j.key,j.value,'identity function may not have a "stops" property')];let G=[];const Q=j.value;return G=G.concat(Nf({key:j.key,value:Q,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:B})),"array"===Vi(Q)&&0===Q.length&&G.push(new Tn(j.key,Q,"array must have at least one stop")),G},default:function(j){return bs({key:j.key,value:j.value,valueSpec:s,style:j.style,styleSpec:j.styleSpec})}}});return"identity"===c&&E&&F.push(new Tn(a.key,a.value,'missing required property "property"')),"identity"===c||a.value.stops||F.push(new Tn(a.key,a.value,'missing required property "stops"')),"exponential"===c&&a.valueSpec.expression&&!ma(a.valueSpec)&&F.push(new Tn(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(T&&!Ma(a.valueSpec)?F.push(new Tn(a.key,a.value,"property functions not supported")):E&&!Ad(a.valueSpec)&&F.push(new Tn(a.key,a.value,"zoom functions not supported"))),"categorical"!==c&&!M||void 0!==a.value.property||F.push(new Tn(a.key,a.value,'"property" property is required')),F;function B(j){let G=[];const Q=j.value,re=j.key;if("array"!==Vi(Q))return[new Tn(re,Q,`array expected, ${Vi(Q)} found`)];if(2!==Q.length)return[new Tn(re,Q,`array length 2 expected, length ${Q.length} found`)];if(M){if("object"!==Vi(Q[0]))return[new Tn(re,Q,`object expected, ${Vi(Q[0])} found`)];if(void 0===Q[0].zoom)return[new Tn(re,Q,"object stop key must have zoom")];if(void 0===Q[0].value)return[new Tn(re,Q,"object stop key must have value")];const X=No(Q[0].zoom);if("number"!=typeof X)return[new Tn(re,Q[0].zoom,"stop zoom values must be numbers")];if(y&&y>X)return[new Tn(re,Q[0].zoom,"stop zoom values must appear in ascending order")];X!==y&&(y=X,m=void 0,x={}),G=G.concat(Bo({key:`${re}[0]`,value:Q[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:yh,value:V}}))}else G=G.concat(V({key:`${re}[0]`,value:Q[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},Q));return ml(Ki(Q[1]))?G.concat([new Tn(`${re}[1]`,Q[1],"expressions are not allowed in function stops.")]):G.concat(bs({key:`${re}[1]`,value:Q[1],valueSpec:s,style:j.style,styleSpec:j.styleSpec}))}function V(j,G){const Q=Vi(j.value),re=No(j.value),X=null!==j.value?j.value:G;if(d){if(Q!==d)return[new Tn(j.key,X,`${Q} stop domain type must match previous stop domain type ${d}`)]}else d=Q;if("number"!==Q&&"string"!==Q&&"boolean"!==Q&&"number"!=typeof re&&"string"!=typeof re&&"boolean"!=typeof re)return[new Tn(j.key,X,"stop domain value must be a number, string, or boolean")];if("number"!==Q&&"categorical"!==c){let Ne=`number expected, ${Q} found`;return Ma(s)&&void 0===c&&(Ne+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Tn(j.key,X,Ne)]}return"categorical"!==c||"number"!==Q||"number"==typeof re&&isFinite(re)&&Math.floor(re)===re?"categorical"!==c&&"number"===Q&&"number"==typeof re&&"number"==typeof m&&void 0!==m&&re<m?[new Tn(j.key,X,"stop domain values must appear in ascending order")]:(m=re,"categorical"===c&&re in x?[new Tn(j.key,X,"stop domain values must be unique")]:(x[re]=!0,[])):[new Tn(j.key,X,`integer expected, found ${String(re)}`)]}}function Ms(a){const s=("property"===a.expressionContext?cs:To)(Ki(a.value),a.valueSpec);if("error"===s.result)return s.value.map(d=>new Tn(`${a.key}${d.key}`,a.value,d.message));const c=s.value.expression||s.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!c.outputDefined())return[new Tn(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!Yi(c))return[new Tn(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext)return xh(c,a);if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!pl(c,["zoom","feature-state"]))return[new Tn(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!js(c))return[new Tn(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xh(a,s){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const m of s.valueSpec.expression.parameters)c.delete(m);if(0===c.size)return[];const d=[];return a instanceof os&&c.has(a.name)?[new Tn(s.key,s.value,`["${a.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(a.eachChild(m=>{d.push(...xh(m,s))}),d)}function Vu(a){const s=a.key,c=a.value,d=a.valueSpec,m=[];return Array.isArray(d.values)?-1===d.values.indexOf(No(c))&&m.push(new Tn(s,c,`expected one of [${d.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(d.values).indexOf(No(c))&&m.push(new Tn(s,c,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(c)} found`)),m}function _c(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const s of a.slice(1))if(!_c(s)&&"boolean"!=typeof s)return!1;return!0;default:return!0}}function Pd(a,s="fill"){if(null==a)return{filter:()=>!0,needGeometry:!1,needFeature:!1};_c(a)||(a=Kc(a));const c=a;let d=!0;try{d=function(M){if(!kd(M))return M;let F=Ki(M);return Bf(F),F=Rg(F),F}(c)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(c,null,2)}\n        `)}const m=Nt[`filter_${s}`],y=To(d,m);let x=null;if("error"===y.result)throw new Error(y.value.map(M=>`${M.key}: ${M.message}`).join(", "));x=(M,F,B)=>y.value.evaluate(M,F,{},B);let E=null,T=null;if(d!==c){const M=To(c,m);if("error"===M.result)throw new Error(M.value.map(F=>`${F.key}: ${F.message}`).join(", "));E=(F,B,V,j,G)=>M.value.evaluate(F,B,{},V,void 0,void 0,j,G),T=!js(M.value.expression)}return{filter:x,dynamicFilter:E||void 0,needGeometry:Fg(d),needFeature:!!T}}function Rg(a){if(!Array.isArray(a))return a;const s=function(c){if(Og.has(c[0]))for(let d=1;d<c.length;d++)if(kd(c[d]))return!0;return c}(a);return!0===s?s:s.map(c=>Rg(c))}function Bf(a){let s=!1;const c=[];if("case"===a[0]){for(let d=1;d<a.length-1;d+=2)s=s||kd(a[d]),c.push(a[d+1]);c.push(a[a.length-1])}else if("match"===a[0]){s=s||kd(a[1]);for(let d=2;d<a.length-1;d+=2)c.push(a[d+1]);c.push(a[a.length-1])}else if("step"===a[0]){s=s||kd(a[1]);for(let d=1;d<a.length-1;d+=2)c.push(a[d+1])}s&&(a.length=0,a.push("any",...c));for(let d=1;d<a.length;d++)Bf(a[d])}function kd(a){if(!Array.isArray(a))return!1;if("pitch"===(s=a[0])||"distance-from-center"===s)return!0;var s;for(let c=1;c<a.length;c++)if(kd(a[c]))return!0;return!1}const Og=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function E0(a,s){return a<s?-1:a>s?1:0}function Fg(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let s=1;s<a.length;s++)if(Fg(a[s]))return!0;return!1}function Kc(a){if(!a)return!0;const s=a[0];return a.length<=1?"any"!==s:"=="===s?bh(a[1],a[2],"=="):"!="===s?zu(bh(a[1],a[2],"==")):"<"===s||">"===s||"<="===s||">="===s?bh(a[1],a[2],s):"any"===s?(c=a.slice(1),["any"].concat(c.map(Kc))):"all"===s?["all"].concat(a.slice(1).map(Kc)):"none"===s?["all"].concat(a.slice(1).map(Kc).map(zu)):"in"===s?Kp(a[1],a.slice(2)):"!in"===s?zu(Kp(a[1],a.slice(2))):"has"===s?Rd(a[1]):"!has"===s?zu(Rd(a[1])):"within"!==s||a;var c}function bh(a,s,c){switch(a){case"$type":return[`filter-type-${c}`,s];case"$id":return[`filter-id-${c}`,s];default:return[`filter-${c}`,a,s]}}function Kp(a,s){if(0===s.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(c=>typeof c!=typeof s[0])?["filter-in-large",a,["literal",s.sort(E0)]]:["filter-in-small",a,["literal",s]]}}function Rd(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function zu(a){return["!",a]}function Uu(a){return _c(Ki(a.value))?Ms(Po({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):wh(a)}function wh(a){const s=a.value,c=a.key;if("array"!==Vi(s))return[new Tn(c,s,`array expected, ${Vi(s)} found`)];const d=a.styleSpec;let m,y=[];if(s.length<1)return[new Tn(c,s,"filter array must have at least 1 element")];switch(y=y.concat(Vu({key:`${c}[0]`,value:s[0],valueSpec:d.filter_operator,style:a.style,styleSpec:a.styleSpec})),No(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===No(s[1])&&y.push(new Tn(c,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":3!==s.length&&y.push(new Tn(c,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(m=Vi(s[1]),"string"!==m&&y.push(new Tn(`${c}[1]`,s[1],`string expected, ${m} found`)));for(let x=2;x<s.length;x++)m=Vi(s[x]),"$type"===No(s[1])?y=y.concat(Vu({key:`${c}[${x}]`,value:s[x],valueSpec:d.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==m&&"number"!==m&&"boolean"!==m&&y.push(new Tn(`${c}[${x}]`,s[x],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let x=1;x<s.length;x++)y=y.concat(wh({key:`${c}[${x}]`,value:s[x],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":m=Vi(s[1]),2!==s.length?y.push(new Tn(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"string"!==m&&y.push(new Tn(`${c}[1]`,s[1],`string expected, ${m} found`));break;case"within":m=Vi(s[1]),2!==s.length?y.push(new Tn(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"object"!==m&&y.push(new Tn(`${c}[1]`,s[1],`object expected, ${m} found`))}return y}function Yp(a,s){const c=a.key,d=a.style,m=a.styleSpec,y=a.value,x=a.objectKey,E=m[`${s}_${a.layerType}`];if(!E)return[];const T=x.match(/^(.*)-transition$/);if("paint"===s&&T&&E[T[1]]&&E[T[1]].transition)return bs({key:c,value:y,valueSpec:m.transition,style:d,styleSpec:m});const M=a.valueSpec||E[x];if(!M)return[new Tn(c,y,`unknown property "${x}"`)];let F;if("string"===Vi(y)&&Ma(M)&&!M.tokens&&(F=/^{([^}]+)}$/.exec(y))){const V=`\`{ "type": "identity", "property": ${F?JSON.stringify(F[1]):'"_"'} }\``;return[new Tn(c,y,`"${x}" does not support interpolation syntax\nUse an identity property function instead: ${V}.`)]}const B=[];return"symbol"===a.layerType&&("text-field"===x&&d&&!d.glyphs&&B.push(new Tn(c,y,'use of "text-field" requires a style "glyphs" property')),"text-font"===x&&zl(Ki(y))&&"identity"===No(y.type)&&B.push(new Tn(c,y,'"text-font" does not support identity functions'))),B.concat(bs({key:a.key,value:y,valueSpec:M,style:d,styleSpec:m,expressionContext:"property",propertyType:s,propertyKey:x}))}function C0(a){return Yp(a,"paint")}function _l(a){return Yp(a,"layout")}function yc(a){let s=[];const c=a.value,d=a.key,m=a.style,y=a.styleSpec;c.type||c.ref||s.push(new Tn(d,c,'either "type" or "ref" is required'));let x=No(c.type);const E=No(c.ref);if(c.id){const T=No(c.id);for(let M=0;M<a.arrayIndex;M++){const F=m.layers[M];No(F.id)===T&&s.push(new Tn(d,c.id,`duplicate layer id "${c.id}", previously used at line ${F.id.__line__}`))}}if("ref"in c){let T;["type","source","source-layer","filter","layout"].forEach(M=>{M in c&&s.push(new Tn(d,c[M],`"${M}" is prohibited for ref layers`))}),m.layers.forEach(M=>{No(M.id)===E&&(T=M)}),T?T.ref?s.push(new Tn(d,c.ref,"ref cannot reference another ref layer")):x=No(T.type):"string"==typeof E&&s.push(new Tn(d,c.ref,`ref layer "${E}" not found`))}else if("background"!==x&&"sky"!==x)if(c.source){const T=m.sources&&m.sources[c.source],M=T&&No(T.type);T?"vector"===M&&"raster"===x?s.push(new Tn(d,c.source,`layer "${c.id}" requires a raster source`)):"raster"===M&&"raster"!==x?s.push(new Tn(d,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==M||c["source-layer"]?"raster-dem"===M&&"hillshade"!==x?s.push(new Tn(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==x||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||"geojson"===M&&T.lineMetrics||s.push(new Tn(d,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new Tn(d,c,`layer "${c.id}" must specify a "source-layer"`)):s.push(new Tn(d,c.source,`source "${c.source}" not found`))}else s.push(new Tn(d,c,'missing required property "source"'));return s=s.concat(Bo({key:d,value:c,valueSpec:y.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>bs({key:`${d}.type`,value:c.type,valueSpec:y.layer.type,style:a.style,styleSpec:a.styleSpec,object:c,objectKey:"type"}),filter:T=>Uu(Po({layerType:x},T)),layout:T=>Bo({layer:c,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":M=>_l(Po({layerType:x},M))}}),paint:T=>Bo({layer:c,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":M=>C0(Po({layerType:x},M))}})}})),s}function $l(a){const s=a.value,c=a.key,d=Vi(s);return"string"!==d?[new Tn(c,s,`string expected, ${d} found`)]:[]}const Lg={promoteId:function({key:a,value:s}){if("string"===Vi(s))return $l({key:a,value:s});{const c=[];for(const d in s)c.push(...$l({key:`${a}.${d}`,value:s[d]}));return c}}};function us(a){const s=a.value,c=a.key,d=a.styleSpec,m=a.style;if(!s.type)return[new Tn(c,s,'"type" is required')];const y=No(s.type);let x;switch(y){case"vector":case"raster":case"raster-dem":return x=Bo({key:c,value:s,valueSpec:d[`source_${y.replace("-","_")}`],style:a.style,styleSpec:d,objectElementValidators:Lg}),x;case"geojson":if(x=Bo({key:c,value:s,valueSpec:d.source_geojson,style:m,styleSpec:d,objectElementValidators:Lg}),s.cluster)for(const E in s.clusterProperties){const[T,M]=s.clusterProperties[E],F="string"==typeof T?[T,["accumulated"],["get",E]]:T;x.push(...Ms({key:`${c}.${E}.map`,value:M,expressionContext:"cluster-map"})),x.push(...Ms({key:`${c}.${E}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return x;case"video":return Bo({key:c,value:s,valueSpec:d.source_video,style:m,styleSpec:d});case"image":return Bo({key:c,value:s,valueSpec:d.source_image,style:m,styleSpec:d});case"canvas":return[new Tn(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Vu({key:`${c}.type`,value:s.type,valueSpec:{values:vc(d)},style:m,styleSpec:d})}}function vc(a){return a.source.reduce((s,c)=>{const d=a[c];return"enum"===d.type.type&&(s=s.concat(Object.keys(d.type.values))),s},[])}function ga(a){const s=a.value,c=a.styleSpec,d=c.light,m=a.style;let y=[];const x=Vi(s);if(void 0===s)return y;if("object"!==x)return y=y.concat([new Tn("light",s,`object expected, ${x} found`)]),y;for(const E in s){const T=E.match(/^(.*)-transition$/);y=y.concat(T&&d[T[1]]&&d[T[1]].transition?bs({key:E,value:s[E],valueSpec:c.transition,style:m,styleSpec:c}):d[E]?bs({key:E,value:s[E],valueSpec:d[E],style:m,styleSpec:c}):[new Tn(E,s[E],`unknown property "${E}"`)])}return y}function mo(a){const s=a.value,c=a.key,d=a.style,m=a.styleSpec,y=m.terrain;let x=[];const E=Vi(s);if(void 0===s)return x;if("object"!==E)return x=x.concat([new Tn("terrain",s,`object expected, ${E} found`)]),x;for(const T in s){const M=T.match(/^(.*)-transition$/);x=x.concat(M&&y[M[1]]&&y[M[1]].transition?bs({key:T,value:s[T],valueSpec:m.transition,style:d,styleSpec:m}):y[T]?bs({key:T,value:s[T],valueSpec:y[T],style:d,styleSpec:m}):[new Tn(T,s[T],`unknown property "${T}"`)])}if(s.source){const T=d.sources&&d.sources[s.source],M=T&&No(T.type);T?"raster-dem"!==M&&x.push(new Tn(c,s.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):x.push(new Tn(c,s.source,`source "${s.source}" not found`))}else x.push(new Tn(c,s,'terrain is missing required property "source"'));return x}function Vf(a){const s=a.value,c=a.style,d=a.styleSpec,m=d.fog;let y=[];const x=Vi(s);if(void 0===s)return y;if("object"!==x)return y=y.concat([new Tn("fog",s,`object expected, ${x} found`)]),y;for(const E in s){const T=E.match(/^(.*)-transition$/);y=y.concat(T&&m[T[1]]&&m[T[1]].transition?bs({key:E,value:s[E],valueSpec:d.transition,style:c,styleSpec:d}):m[E]?bs({key:E,value:s[E],valueSpec:m[E],style:c,styleSpec:d}):[new Tn(E,s[E],`unknown property "${E}"`)])}return y}const Od={"*":()=>[],array:Nf,boolean:function(a){const s=a.value,c=a.key,d=Vi(s);return"boolean"!==d?[new Tn(c,s,`boolean expected, ${d} found`)]:[]},number:yh,color:function(a){const s=a.key,c=a.value,d=Vi(c);return"string"!==d?[new Tn(s,c,`color expected, ${d} found`)]:null===oh(c)?[new Tn(s,c,`color expected, "${c}" found`)]:[]},enum:Vu,filter:Uu,function:vh,layer:yc,object:Bo,source:us,light:ga,terrain:mo,fog:Vf,string:$l,formatted:function(a){return 0===$l(a).length?[]:Ms(a)},resolvedImage:function(a){return 0===$l(a).length?[]:Ms(a)},projection:function(a){const s=a.value,c=a.styleSpec,d=c.projection,m=a.style;let y=[];const x=Vi(s);if("object"===x)for(const E in s)y=y.concat(bs({key:E,value:s[E],valueSpec:d[E],style:m,styleSpec:c}));else"string"!==x&&(y=y.concat([new Tn("projection",s,`object or string expected, ${x} found`)]));return y}};function bs(a){const s=a.value,c=a.valueSpec,d=a.styleSpec;return c.expression&&zl(No(s))?vh(a):c.expression&&ml(Ki(s))?Ms(a):c.type&&Od[c.type]?Od[c.type](a):Bo(Po({},a,{valueSpec:c.type?d[c.type]:c}))}function Fd(a){const s=a.value,c=a.key,d=$l(a);return d.length||(-1===s.indexOf("{fontstack}")&&d.push(new Tn(c,s,'"glyphs" url must include a "{fontstack}" token')),-1===s.indexOf("{range}")&&d.push(new Tn(c,s,'"glyphs" url must include a "{range}" token'))),d}function zf(a,s=Nt){return _a(bs({key:"",value:a,valueSpec:s.$root,styleSpec:s,style:a,objectElementValidators:{glyphs:Fd,"*":()=>[]}}))}const Uf=a=>_a(C0(a)),Eh=a=>_a(_l(a));function _a(a){return a.slice().sort((s,c)=>s.line&&c.line?s.line-c.line:0)}function ju(a,s){let c=!1;if(s&&s.length)for(const d of s)a.fire(new cc(new Error(d.message))),c=!0;return c}var jf=ws,ds=3;function ws(a,s,c){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var m=new Int32Array(this.arrayBuffer);a=m[0],this.d=(s=m[1])+2*(c=m[2]);for(var y=0;y<this.d*this.d;y++){var x=m[ds+y],E=m[ds+y+1];d.push(x===E?null:m.subarray(x,E))}var T=m[ds+d.length+1];this.keys=m.subarray(m[ds+d.length],T),this.bboxes=m.subarray(T),this.insert=this._insertReadonly}else{this.d=s+2*c;for(var M=0;M<this.d*this.d;M++)d.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=a,this.padding=c,this.scale=s/a,this.uid=0;var F=c/s*a;this.min=-F,this.max=a+F}ws.prototype.insert=function(a,s,c,d,m){this._forEachCell(s,c,d,m,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(m)},ws.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ws.prototype._insertCell=function(a,s,c,d,m,y){this.cells[m].push(y)},ws.prototype.query=function(a,s,c,d,m){var y=this.min,x=this.max;if(a<=y&&s<=y&&x<=c&&x<=d&&!m)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(a,s,c,d,this._queryCell,E,{},m),E},ws.prototype._queryCell=function(a,s,c,d,m,y,x,E){var T=this.cells[m];if(null!==T)for(var M=this.keys,F=this.bboxes,B=0;B<T.length;B++){var V=T[B];if(void 0===x[V]){var j=4*V;(E?E(F[j+0],F[j+1],F[j+2],F[j+3]):a<=F[j+2]&&s<=F[j+3]&&c>=F[j+0]&&d>=F[j+1])?(x[V]=!0,y.push(M[V])):x[V]=!1}}},ws.prototype._forEachCell=function(a,s,c,d,m,y,x,E){for(var T=this._convertToCellCoord(a),M=this._convertToCellCoord(s),F=this._convertToCellCoord(c),B=this._convertToCellCoord(d),V=T;V<=F;V++)for(var j=M;j<=B;j++){var G=this.d*j+V;if((!E||E(this._convertFromCellCoord(V),this._convertFromCellCoord(j),this._convertFromCellCoord(V+1),this._convertFromCellCoord(j+1)))&&m.call(this,a,s,c,d,G,y,x,E))return}},ws.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},ws.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},ws.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,s=ds+this.cells.length+1+1,c=0,d=0;d<this.cells.length;d++)c+=this.cells[d].length;var m=new Int32Array(s+c+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;for(var y=s,x=0;x<a.length;x++){var E=a[x];m[ds+x]=y,m.set(E,y),y+=E.length}return m[ds+a.length]=y,m.set(this.keys,y),m[ds+a.length+1]=y+=this.keys.length,m.set(this.bboxes,y),y+=this.bboxes.length,m.buffer};var Pa=Je(jf);const Yc={};function Fn(a,s,c={}){Object.defineProperty(a,"_classRegistryKey",{value:s,writeable:!1}),Yc[s]={klass:a,omit:c.omit||[]}}Fn(Object,"Object"),Pa.serialize=function(a,s){const c=a.toArrayBuffer();return s&&s.push(c),{buffer:c}},Pa.deserialize=function(a){return new Pa(a.buffer)},Object.defineProperty(Pa,"name",{value:"Grid"}),Fn(Pa,"Grid"),Fn(si,"Color"),Fn(Error,"Error"),Fn(qr,"AJAXError"),Fn(zs,"ResolvedImage"),Fn(gc,"StylePropertyFunction"),Fn(jl,"StyleExpression",{omit:["_evaluator"]}),Fn(xs,"ZoomDependentExpression"),Fn(kg,"ZoomConstantExpression"),Fn(os,"CompoundExpression",{omit:["_evaluate"]});for(const a in Bl)Yc[Bl[a]._classRegistryKey]||Fn(Bl[a],`Expression${a}`);function Ch(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function Xp(a){return Me.ImageBitmap&&a instanceof Me.ImageBitmap}function xc(a,s){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Ch(a)||Xp(a))return s&&s.push(a),a;if(ArrayBuffer.isView(a)){const c=a;return s&&s.push(c.buffer),c}if(a instanceof Me.ImageData)return s&&s.push(a.data.buffer),a;if(Array.isArray(a)){const c=[];for(const d of a)c.push(xc(d,s));return c}if("object"==typeof a){const c=a.constructor,d=c._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const m=c.serialize?c.serialize(a,s):{};if(!c.serialize){for(const y in a)a.hasOwnProperty(y)&&(Yc[d].omit.indexOf(y)>=0||(m[y]=xc(a[y],s)));a instanceof Error&&(m.message=a.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==d&&(m.$name=d),m}throw new Error("can't serialize object of type "+typeof a)}function bc(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Ch(a)||Xp(a)||ArrayBuffer.isView(a)||a instanceof Me.ImageData)return a;if(Array.isArray(a))return a.map(bc);if("object"==typeof a){const s=a.$name||"Object",{klass:c}=Yc[s];if(!c)throw new Error(`can't deserialize unregistered class ${s}`);if(c.deserialize)return c.deserialize(a);const d=Object.create(c.prototype);for(const m of Object.keys(a))"$name"!==m&&(d[m]=bc(a[m]));return d}throw new Error("can't deserialize object of type "+typeof a)}const Sn={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Ih(a){for(const s of a)if(Ld(s.charCodeAt(0)))return!0;return!1}function Qp(a){for(const s of a)if(!$f(s.charCodeAt(0)))return!1;return!0}function $f(a){return!(Sn.Arabic(a)||Sn["Arabic Supplement"](a)||Sn["Arabic Extended-A"](a)||Sn["Arabic Presentation Forms-A"](a)||Sn["Arabic Presentation Forms-B"](a))}function Ld(a){return!(746!==a&&747!==a&&(a<4352||!(Sn["Bopomofo Extended"](a)||Sn.Bopomofo(a)||Sn["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Sn["CJK Compatibility Ideographs"](a)||Sn["CJK Compatibility"](a)||Sn["CJK Radicals Supplement"](a)||Sn["CJK Strokes"](a)||!(!Sn["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||Sn["CJK Unified Ideographs Extension A"](a)||Sn["CJK Unified Ideographs"](a)||Sn["Enclosed CJK Letters and Months"](a)||Sn["Hangul Compatibility Jamo"](a)||Sn["Hangul Jamo Extended-A"](a)||Sn["Hangul Jamo Extended-B"](a)||Sn["Hangul Jamo"](a)||Sn["Hangul Syllables"](a)||Sn.Hiragana(a)||Sn["Ideographic Description Characters"](a)||Sn.Kanbun(a)||Sn["Kangxi Radicals"](a)||Sn["Katakana Phonetic Extensions"](a)||Sn.Katakana(a)&&12540!==a||!(!Sn["Halfwidth and Fullwidth Forms"](a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!Sn["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Sn["Unified Canadian Aboriginal Syllabics"](a)||Sn["Unified Canadian Aboriginal Syllabics Extended"](a)||Sn["Vertical Forms"](a)||Sn["Yijing Hexagram Symbols"](a)||Sn["Yi Syllables"](a)||Sn["Yi Radicals"](a))))}function Ng(a){return!(Ld(a)||(s=a,Sn["Latin-1 Supplement"](s)&&(167===s||169===s||174===s||177===s||188===s||189===s||190===s||215===s||247===s)||Sn["General Punctuation"](s)&&(8214===s||8224===s||8225===s||8240===s||8241===s||8251===s||8252===s||8258===s||8263===s||8264===s||8265===s||8273===s)||Sn["Letterlike Symbols"](s)||Sn["Number Forms"](s)||Sn["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||9003===s||s>=9085&&s<=9114||s>=9150&&s<=9165||9167===s||s>=9169&&s<=9179||s>=9186&&s<=9215)||Sn["Control Pictures"](s)&&9251!==s||Sn["Optical Character Recognition"](s)||Sn["Enclosed Alphanumerics"](s)||Sn["Geometric Shapes"](s)||Sn["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Sn["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Sn["CJK Symbols and Punctuation"](s)||Sn.Katakana(s)||Sn["Private Use Area"](s)||Sn["CJK Compatibility Forms"](s)||Sn["Small Form Variants"](s)||Sn["Halfwidth and Fullwidth Forms"](s)||8734===s||8756===s||8757===s||s>=9984&&s<=10087||s>=10102&&s<=10131||65532===s||65533===s));var s}function Bg(a){return a>=1424&&a<=2303||Sn["Arabic Presentation Forms-A"](a)||Sn["Arabic Presentation Forms-B"](a)}function Vg(a,s){return!(!s&&Bg(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Sn.Khmer(a))}function Jp(a){for(const s of a)if(Bg(s.charCodeAt(0)))return!0;return!1}const Xc="deferred",Hf="loading",Gf="loaded";let $u=null,_="unavailable",u=null;const p=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(_="error"),$u&&$u(a)};function v(){w.fire(new Wa("pluginStateChange",{pluginStatus:_,pluginURL:u}))}const w=new zc,I=function(){return _},P=function(){if(_!==Xc||!u)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_=Hf,v(),u&&vr({url:u},a=>{a?p(a):(_=Gf,v())})},k={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>_===Gf||null!=k.applyArabicShaping,isLoading:()=>_===Hf,setState(a){_=a.pluginStatus,u=a.pluginURL},isParsed:()=>null!=k.applyArabicShaping&&null!=k.processBidirectionalText&&null!=k.processStyledBidirectionalText,getPluginURL:()=>u};class N{constructor(s,c){this.zoom=s,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(s){return function(c,d){for(const m of c)if(!Vg(m.charCodeAt(0),d))return!1;return!0}(s,k.isLoaded())}}class U{constructor(s,c){this.property=s,this.value=c,this.expression=function(d,m){if(zl(d))return new gc(d,m);if(ml(d)){const y=cs(d,m);if("error"===y.result)throw new Error(y.value.map(x=>`${x.key}: ${x.message}`).join(", "));return y.value}{let y=d;return"string"==typeof d&&"color"===m.type&&(y=si.parse(d)),{kind:"constant",evaluate:()=>y}}}(void 0===c?s.specification.default:c,s.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(s,c,d){return this.property.possiblyEvaluate(this,s,c,d)}}class z{constructor(s){this.property=s,this.value=new U(s,void 0)}transitioned(s,c){return new le(this.property,this.value,c,Pe({},s.transition,this.transition),s.now)}untransitioned(){return new le(this.property,this.value,null,{},0)}}class q{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues)}getValue(s){return bi(this._values[s].value.value)}setValue(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new z(this._values[s].property)),this._values[s].value=new U(this._values[s].property,null===c?void 0:bi(c))}getTransition(s){return bi(this._values[s].transition)}setTransition(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new z(this._values[s].property)),this._values[s].transition=bi(c)||void 0}serialize(){const s={};for(const c of Object.keys(this._values)){const d=this.getValue(c);void 0!==d&&(s[c]=d);const m=this.getTransition(c);void 0!==m&&(s[`${c}-transition`]=m)}return s}transitioned(s,c){const d=new ye(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].transitioned(s,c._values[m]);return d}untransitioned(){const s=new ye(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].untransitioned();return s}}class le{constructor(s,c,d,m,y){const x=m.delay||0,E=m.duration||0;y=y||0,this.property=s,this.value=c,this.begin=y+x,this.end=this.begin+E,s.specification.transition&&(m.delay||m.duration)&&(this.prior=d)}possiblyEvaluate(s,c,d){const m=s.now||0,y=this.value.possiblyEvaluate(s,c,d),x=this.prior;if(x){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return x.possiblyEvaluate(s,c,d);{const E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(s,c,d),y,Lt(E))}}return y}}class ye{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,c,d){const m=new we(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(s,c,d);return m}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class be{constructor(s){this._properties=s,this._values=Object.create(s.defaultPropertyValues)}getValue(s){return bi(this._values[s].value)}setValue(s,c){this._values[s]=new U(this._values[s].property,null===c?void 0:bi(c))}serialize(){const s={};for(const c of Object.keys(this._values)){const d=this.getValue(c);void 0!==d&&(s[c]=d)}return s}possiblyEvaluate(s,c,d){const m=new we(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(s,c,d);return m}}class ve{constructor(s,c,d){this.property=s,this.value=c,this.parameters=d}isConstant(){return"constant"===this.value.kind}constantOr(s){return"constant"===this.value.kind?this.value.value:s}evaluate(s,c,d,m){return this.property.evaluate(this.value,this.parameters,s,c,d,m)}}class we{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class K{constructor(s){this.specification=s}possiblyEvaluate(s,c){return s.expression.evaluate(c)}interpolate(s,c,d){const m=fc[this.specification.type];return m?m(s,c,d):s}}class de{constructor(s,c){this.specification=s,this.overrides=c}possiblyEvaluate(s,c,d,m){return new ve(this,"constant"===s.expression.kind||"camera"===s.expression.kind?{kind:"constant",value:s.expression.evaluate(c,null,{},d,m)}:s.expression,c)}interpolate(s,c,d){if("constant"!==s.value.kind||"constant"!==c.value.kind)return s;if(void 0===s.value.value||void 0===c.value.value)return new ve(this,{kind:"constant",value:void 0},s.parameters);const m=fc[this.specification.type];return m?new ve(this,{kind:"constant",value:m(s.value.value,c.value.value,d)},s.parameters):s}evaluate(s,c,d,m,y,x){return"constant"===s.kind?s.value:s.evaluate(c,d,m,y,x)}}class Ae{constructor(s){this.specification=s}possiblyEvaluate(s,c,d,m){return!!s.expression.evaluate(c,null,{},d,m)}interpolate(){return!1}}class Se{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new N(0,{});for(const d in s){const m=s[d];m.specification.overridable&&this.overridableProperties.push(d);const y=this.defaultPropertyValues[d]=new U(m,void 0),x=this.defaultTransitionablePropertyValues[d]=new z(m);this.defaultTransitioningPropertyValues[d]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=y.possiblyEvaluate(c)}}}function Ge(a,s){return 256*(a=Rt(Math.floor(a),0,255))+Rt(Math.floor(s),0,255)}Fn(de,"DataDrivenProperty"),Fn(K,"DataConstantProperty"),Fn(Ae,"ColorRampProperty");const Ye={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Xe{constructor(s,c){this._structArray=s,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ct{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,c){return s._trim(),c&&(s.isTransferred=!0,c.push(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const c=Object.create(this.prototype);return c.arrayBuffer=s.arrayBuffer,c.length=s.length,c.capacity=s.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function st(a,s=1){let c=0,d=0;return{members:a.map(m=>{const y=Ye[m.type].BYTES_PER_ELEMENT,x=c=Ct(c,Math.max(s,y)),E=m.components||1;return d=Math.max(d,y),c+=y*E,{name:m.name,type:m.type,components:E,offset:x}}),size:Ct(c,Math.max(d,s)),alignment:s}}function Ct(a,s){return Math.ceil(a/s)*s}class rn extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.int16[m+0]=c,this.int16[m+1]=d,s}}rn.prototype.bytesPerElement=4,Fn(rn,"StructArrayLayout2i4");class _t extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const y=3*s;return this.int16[y+0]=c,this.int16[y+1]=d,this.int16[y+2]=m,s}}_t.prototype.bytesPerElement=6,Fn(_t,"StructArrayLayout3i6");class zt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,s,c,d,m)}emplace(s,c,d,m,y){const x=4*s;return this.int16[x+0]=c,this.int16[x+1]=d,this.int16[x+2]=m,this.int16[x+3]=y,s}}zt.prototype.bytesPerElement=8,Fn(zt,"StructArrayLayout4i8");class Dt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,x,E){const T=this.length;return this.resize(T+1),this.emplace(T,s,c,d,m,y,x,E)}emplace(s,c,d,m,y,x,E,T){const M=6*s,F=12*s,B=3*s;return this.int16[M+0]=c,this.int16[M+1]=d,this.uint8[F+4]=m,this.uint8[F+5]=y,this.uint8[F+6]=x,this.uint8[F+7]=E,this.float32[B+2]=T,s}}Dt.prototype.bytesPerElement=12,Fn(Dt,"StructArrayLayout2i4ub1f12");class en extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,s,c,d,m)}emplace(s,c,d,m,y){const x=4*s;return this.float32[x+0]=c,this.float32[x+1]=d,this.float32[x+2]=m,this.float32[x+3]=y,s}}en.prototype.bytesPerElement=16,Fn(en,"StructArrayLayout4f16");class vt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,d,m,y)}emplace(s,c,d,m,y,x){const E=6*s,T=3*s;return this.uint16[E+0]=c,this.uint16[E+1]=d,this.uint16[E+2]=m,this.uint16[E+3]=y,this.float32[T+2]=x,s}}vt.prototype.bytesPerElement=12,Fn(vt,"StructArrayLayout4ui1f12");class Ut extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,s,c,d,m)}emplace(s,c,d,m,y){const x=4*s;return this.uint16[x+0]=c,this.uint16[x+1]=d,this.uint16[x+2]=m,this.uint16[x+3]=y,s}}Ut.prototype.bytesPerElement=8,Fn(Ut,"StructArrayLayout4ui8");class sn extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,x){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,d,m,y,x)}emplace(s,c,d,m,y,x,E){const T=6*s;return this.int16[T+0]=c,this.int16[T+1]=d,this.int16[T+2]=m,this.int16[T+3]=y,this.int16[T+4]=x,this.int16[T+5]=E,s}}sn.prototype.bytesPerElement=12,Fn(sn,"StructArrayLayout6i12");class Zt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,x,E,T,M,F,B,V){const j=this.length;return this.resize(j+1),this.emplace(j,s,c,d,m,y,x,E,T,M,F,B,V)}emplace(s,c,d,m,y,x,E,T,M,F,B,V,j){const G=12*s;return this.int16[G+0]=c,this.int16[G+1]=d,this.int16[G+2]=m,this.int16[G+3]=y,this.uint16[G+4]=x,this.uint16[G+5]=E,this.uint16[G+6]=T,this.uint16[G+7]=M,this.int16[G+8]=F,this.int16[G+9]=B,this.int16[G+10]=V,this.int16[G+11]=j,s}}Zt.prototype.bytesPerElement=24,Fn(Zt,"StructArrayLayout4i4ui4i24");class Mt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,x){const E=this.length;return this.resize(E+1),this.emplace(E,s,c,d,m,y,x)}emplace(s,c,d,m,y,x,E){const T=10*s,M=5*s;return this.int16[T+0]=c,this.int16[T+1]=d,this.int16[T+2]=m,this.float32[M+2]=y,this.float32[M+3]=x,this.float32[M+4]=E,s}}Mt.prototype.bytesPerElement=20,Fn(Mt,"StructArrayLayout3i3f20");class Kn extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint32[1*s+0]=c,s}}Kn.prototype.bytesPerElement=4,Fn(Kn,"StructArrayLayout1ul4");class pi extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,x,E,T,M,F,B,V,j){const G=this.length;return this.resize(G+1),this.emplace(G,s,c,d,m,y,x,E,T,M,F,B,V,j)}emplace(s,c,d,m,y,x,E,T,M,F,B,V,j,G){const Q=20*s,re=10*s;return this.int16[Q+0]=c,this.int16[Q+1]=d,this.int16[Q+2]=m,this.int16[Q+3]=y,this.int16[Q+4]=x,this.float32[re+3]=E,this.float32[re+4]=T,this.float32[re+5]=M,this.float32[re+6]=F,this.int16[Q+14]=B,this.uint32[re+8]=V,this.uint16[Q+18]=j,this.uint16[Q+19]=G,s}}pi.prototype.bytesPerElement=40,Fn(pi,"StructArrayLayout5i4f1i1ul2ui40");class Ln extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,x,E){const T=this.length;return this.resize(T+1),this.emplace(T,s,c,d,m,y,x,E)}emplace(s,c,d,m,y,x,E,T){const M=8*s;return this.int16[M+0]=c,this.int16[M+1]=d,this.int16[M+2]=m,this.int16[M+4]=y,this.int16[M+5]=x,this.int16[M+6]=E,this.int16[M+7]=T,s}}Ln.prototype.bytesPerElement=16,Fn(Ln,"StructArrayLayout3i2i2i16");class oi extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,d,m,y)}emplace(s,c,d,m,y,x){const E=4*s,T=8*s;return this.float32[E+0]=c,this.float32[E+1]=d,this.float32[E+2]=m,this.int16[T+6]=y,this.int16[T+7]=x,s}}oi.prototype.bytesPerElement=16,Fn(oi,"StructArrayLayout2f1f2i16");class Ni extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,s,c,d,m)}emplace(s,c,d,m,y){const x=12*s,E=3*s;return this.uint8[x+0]=c,this.uint8[x+1]=d,this.float32[E+1]=m,this.float32[E+2]=y,s}}Ni.prototype.bytesPerElement=12,Fn(Ni,"StructArrayLayout2ub2f12");class Si extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const y=3*s;return this.float32[y+0]=c,this.float32[y+1]=d,this.float32[y+2]=m,s}}Si.prototype.bytesPerElement=12,Fn(Si,"StructArrayLayout3f12");class Bn extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,d)}emplace(s,c,d,m){const y=3*s;return this.uint16[y+0]=c,this.uint16[y+1]=d,this.uint16[y+2]=m,s}}Bn.prototype.bytesPerElement=6,Fn(Bn,"StructArrayLayout3ui6");class mr extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,x,E,T,M,F,B,V,j,G,Q,re,X,Ne,H,Fe,Ze){const We=this.length;return this.resize(We+1),this.emplace(We,s,c,d,m,y,x,E,T,M,F,B,V,j,G,Q,re,X,Ne,H,Fe,Ze)}emplace(s,c,d,m,y,x,E,T,M,F,B,V,j,G,Q,re,X,Ne,H,Fe,Ze,We){const wt=30*s,yt=15*s,Bt=60*s;return this.int16[wt+0]=c,this.int16[wt+1]=d,this.int16[wt+2]=m,this.float32[yt+2]=y,this.float32[yt+3]=x,this.uint16[wt+8]=E,this.uint16[wt+9]=T,this.uint32[yt+5]=M,this.uint32[yt+6]=F,this.uint32[yt+7]=B,this.uint16[wt+16]=V,this.uint16[wt+17]=j,this.uint16[wt+18]=G,this.float32[yt+10]=Q,this.float32[yt+11]=re,this.uint8[Bt+48]=X,this.uint8[Bt+49]=Ne,this.uint8[Bt+50]=H,this.uint32[yt+13]=Fe,this.int16[wt+28]=Ze,this.uint8[Bt+58]=We,s}}mr.prototype.bytesPerElement=60,Fn(mr,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class br extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y,x,E,T,M,F,B,V,j,G,Q,re,X,Ne,H,Fe,Ze,We,wt,yt,Bt,ln,At,Ht,Gt,Qt){const cn=this.length;return this.resize(cn+1),this.emplace(cn,s,c,d,m,y,x,E,T,M,F,B,V,j,G,Q,re,X,Ne,H,Fe,Ze,We,wt,yt,Bt,ln,At,Ht,Gt,Qt)}emplace(s,c,d,m,y,x,E,T,M,F,B,V,j,G,Q,re,X,Ne,H,Fe,Ze,We,wt,yt,Bt,ln,At,Ht,Gt,Qt,cn){const Vt=38*s,Cn=19*s;return this.int16[Vt+0]=c,this.int16[Vt+1]=d,this.int16[Vt+2]=m,this.float32[Cn+2]=y,this.float32[Cn+3]=x,this.int16[Vt+8]=E,this.int16[Vt+9]=T,this.int16[Vt+10]=M,this.int16[Vt+11]=F,this.int16[Vt+12]=B,this.int16[Vt+13]=V,this.uint16[Vt+14]=j,this.uint16[Vt+15]=G,this.uint16[Vt+16]=Q,this.uint16[Vt+17]=re,this.uint16[Vt+18]=X,this.uint16[Vt+19]=Ne,this.uint16[Vt+20]=H,this.uint16[Vt+21]=Fe,this.uint16[Vt+22]=Ze,this.uint16[Vt+23]=We,this.uint16[Vt+24]=wt,this.uint16[Vt+25]=yt,this.uint16[Vt+26]=Bt,this.uint16[Vt+27]=ln,this.uint16[Vt+28]=At,this.uint32[Cn+15]=Ht,this.float32[Cn+16]=Gt,this.float32[Cn+17]=Qt,this.float32[Cn+18]=cn,s}}br.prototype.bytesPerElement=76,Fn(br,"StructArrayLayout3i2f6i15ui1ul3f76");class wr extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.float32[1*s+0]=c,s}}wr.prototype.bytesPerElement=4,Fn(wr,"StructArrayLayout1f4");class Er extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,d,m,y)}emplace(s,c,d,m,y,x){const E=5*s;return this.float32[E+0]=c,this.float32[E+1]=d,this.float32[E+2]=m,this.float32[E+3]=y,this.float32[E+4]=x,s}}Er.prototype.bytesPerElement=20,Fn(Er,"StructArrayLayout5f20");class Ps extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,s,c,d,m)}emplace(s,c,d,m,y){const x=6*s;return this.uint32[3*s+0]=c,this.uint16[x+2]=d,this.uint16[x+3]=m,this.uint16[x+4]=y,s}}Ps.prototype.bytesPerElement=12,Fn(Ps,"StructArrayLayout1ul3ui12");class qt extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.uint16[m+0]=c,this.uint16[m+1]=d,s}}qt.prototype.bytesPerElement=4,Fn(qt,"StructArrayLayout2ui4");class Mi extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint16[1*s+0]=c,s}}Mi.prototype.bytesPerElement=2,Fn(Mi,"StructArrayLayout1ui2");class _i extends ct{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c){const d=this.length;return this.resize(d+1),this.emplace(d,s,c)}emplace(s,c,d){const m=2*s;return this.float32[m+0]=c,this.float32[m+1]=d,s}}_i.prototype.bytesPerElement=8,Fn(_i,"StructArrayLayout2f8");class Gn extends Xe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Gn.prototype.size=40;class Ti extends pi{get(s){return new Gn(this,s)}}Fn(Ti,"CollisionBoxArray");class sr extends Xe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}sr.prototype.size=60;class to extends mr{get(s){return new sr(this,s)}}Fn(to,"PlacedSymbolArray");class Kr extends Xe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(s){this._structArray.uint32[this._pos4+15]=s}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Kr.prototype.size=76;class Mr extends br{get(s){return new Kr(this,s)}}Fn(Mr,"SymbolInstanceArray");class hs extends wr{getoffsetX(s){return this.float32[1*s+0]}}Fn(hs,"GlyphOffsetArray");class Hu extends rn{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}Fn(Hu,"SymbolLineVertexArray");class wc extends Xe{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}wc.prototype.size=12;class Qc extends Ps{get(s){return new wc(this,s)}}Fn(Qc,"FeatureIndexArray");class no extends qt{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}Fn(no,"FillExtrusionCentroidArray");const ks=st([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Hl=st([{name:"a_dash",components:4,type:"Uint16"}]);var yl={exports:{}},tm=function(a,s){var c,d,m,y,x,E,T,M;for(d=a.length-(c=3&a.length),m=s,x=3432918353,E=461845907,M=0;M<d;)T=255&a.charCodeAt(M)|(255&a.charCodeAt(++M))<<8|(255&a.charCodeAt(++M))<<16|(255&a.charCodeAt(++M))<<24,++M,m=27492+(65535&(y=5*(65535&(m=(m^=T=(65535&(T=(T=(65535&T)*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*E+(((T>>>16)*E&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(T=0,c){case 3:T^=(255&a.charCodeAt(M+2))<<16;case 2:T^=(255&a.charCodeAt(M+1))<<8;case 1:m^=T=(65535&(T=(T=(65535&(T^=255&a.charCodeAt(M)))*x+(((T>>>16)*x&65535)<<16)&4294967295)<<15|T>>>17))*E+(((T>>>16)*E&65535)<<16)&4294967295}return m^=a.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0},yx=function(a,s){for(var c,d=a.length,m=s^d,y=0;d>=4;)c=1540483477*(65535&(c=255&a.charCodeAt(y)|(255&a.charCodeAt(++y))<<8|(255&a.charCodeAt(++y))<<16|(255&a.charCodeAt(++y))<<24))+((1540483477*(c>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++y;switch(d){case 3:m^=(255&a.charCodeAt(y+2))<<16;case 2:m^=(255&a.charCodeAt(y+1))<<8;case 1:m=1540483477*(65535&(m^=255&a.charCodeAt(y)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};yl.exports=tm,yl.exports.murmur3=tm,yl.exports.murmur2=yx;var qf=Je(yl.exports);class Th{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(s,c,d,m){this.ids.push(Zf(s)),this.positions.push(c,d,m)}getPositions(s){const c=Zf(s);let d=0,m=this.ids.length-1;for(;d<m;){const x=d+m>>1;this.ids[x]>=c?m=x:d=x+1}const y=[];for(;this.ids[d]===c;)y.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return y}static serialize(s,c){const d=new Float64Array(s.ids),m=new Uint32Array(s.positions);return Kf(d,m,0,d.length-1),c&&c.push(d.buffer,m.buffer),{ids:d,positions:m}}static deserialize(s){const c=new Th;return c.ids=s.ids,c.positions=s.positions,c.indexed=!0,c}}function Zf(a){const s=+a;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:qf(String(a))}function Kf(a,s,c,d){for(;c<d;){const m=a[c+d>>1];let y=c-1,x=d+1;for(;;){do{y++}while(a[y]<m);do{x--}while(a[x]>m);if(y>=x)break;nm(a,y,x),nm(s,3*y,3*x),nm(s,3*y+1,3*x+1),nm(s,3*y+2,3*x+2)}x-c<d-x?(Kf(a,s,c,x),c=x+1):(Kf(a,s,x+1,d),d=x)}}function nm(a,s,c){const d=a[s];a[s]=a[c],a[c]=d}Fn(Th,"FeaturePositionMap");class Gl{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,c),this.initialized=!0),!!this.location}}class Dh extends Gl{constructor(s){super(s),this.current=0}set(s,c,d){this.fetchUniformLocation(s,c)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class Ah extends Gl{constructor(s){super(s),this.current=[0,0,0,0]}set(s,c,d){this.fetchUniformLocation(s,c)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class zg extends Gl{constructor(s){super(s),this.current=si.transparent}set(s,c,d){this.fetchUniformLocation(s,c)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const I0=new Float32Array(16),T0=new Float32Array(9),Ug=new Float32Array(4);function jg(a){return[Ge(255*a.r,255*a.g),Ge(255*a.b,255*a.a)]}class Yf{constructor(s,c,d){this.value=s,this.uniformNames=c.map(m=>`u_${m}`),this.type=d}setUniform(s,c,d,m,y){c.set(s,y,m.constantOr(this.value))}getBinding(s,c){return"color"===this.type?new zg(s):new Dh(s)}}class fs{constructor(s,c){this.uniformNames=c.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,c,d,m,y){const x="u_pattern"===y||"u_dash"===y?this.pattern:"u_pixel_ratio"===y?this.pixelRatio:null;x&&c.set(s,y,x)}getBinding(s,c){return"u_pattern"===c||"u_dash"===c?new Ah(s):new Dh(s)}}class ya{constructor(s,c,d,m){this.expression=s,this.type=d,this.maxValue=0,this.paintVertexAttributes=c.map(y=>({name:`a_${y}`,type:"Float32",components:"color"===d?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(s,c,d,m,y,x){const E=this.paintVertexArray.length,T=this.expression.evaluate(new N(0),c,{},y,m,x);this.paintVertexArray.resize(s),this._setPaintValue(E,s,T)}updatePaintArray(s,c,d,m,y){const x=this.expression.evaluate({zoom:0},d,m,void 0,y);this._setPaintValue(s,c,x)}_setPaintValue(s,c,d){if("color"===this.type){const m=jg(d);for(let y=s;y<c;y++)this.paintVertexArray.emplace(y,m[0],m[1])}else{for(let m=s;m<c;m++)this.paintVertexArray.emplace(m,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class gr{constructor(s,c,d,m,y,x){this.expression=s,this.uniformNames=c.map(E=>`u_${E}_t`),this.type=d,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=c.map(E=>({name:`a_${E}`,type:"Float32",components:"color"===d?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(s,c,d,m,y,x){const E=this.expression.evaluate(new N(this.zoom),c,{},y,m,x),T=this.expression.evaluate(new N(this.zoom+1),c,{},y,m,x),M=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(M,s,E,T)}updatePaintArray(s,c,d,m,y){const x=this.expression.evaluate({zoom:this.zoom},d,m,void 0,y),E=this.expression.evaluate({zoom:this.zoom+1},d,m,void 0,y);this._setPaintValue(s,c,x,E)}_setPaintValue(s,c,d,m){if("color"===this.type){const y=jg(d),x=jg(m);for(let E=s;E<c;E++)this.paintVertexArray.emplace(E,y[0],y[1],x[0],x[1])}else{for(let y=s;y<c;y++)this.paintVertexArray.emplace(y,d,m);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(m))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,c,d,m,y){const x=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,E=Rt(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);c.set(s,y,E)}getBinding(s,c){return new Dh(s)}}class Ec{constructor(s,c,d,m,y){this.expression=s,this.layerId=y,this.paintVertexAttributes=("array"===d?Hl:ks).members;for(let x=0;x<c.length;++x);this.paintVertexArray=new m}populatePaintArray(s,c,d){const m=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(m,s,c.patterns&&c.patterns[this.layerId],d)}updatePaintArray(s,c,d,m,y,x){this._setPaintValues(s,c,d.patterns&&d.patterns[this.layerId],x)}_setPaintValues(s,c,d,m){if(!m||!d)return;const y=m[d];if(!y)return;const{tl:x,br:E,pixelRatio:T}=y;for(let M=s;M<c;M++)this.paintVertexArray.emplace(M,x[0],x[1],E[0],E[1],T)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gu{constructor(s,c,d=(()=>!0)){this.binders={},this._buffers=[];const m=[];for(const y in s.paint._values){if(!d(y))continue;const x=s.paint.get(y);if(!(x instanceof ve&&Ma(x.property.specification)))continue;const E=D0(y,s.type),T=x.value,M=x.property.specification.type,F=!!x.property.useIntegerZoom,B="line-dasharray"===y||y.endsWith("pattern"),V="line-dasharray"===y&&"constant"!==s.layout.get("line-cap").value.kind;if("constant"!==T.kind||V)if("source"===T.kind||V||B){const j=Jc(y,M,"source");this.binders[y]=B?new Ec(T,E,M,j,s.id):new ya(T,E,M,j),m.push(`/a_${y}`)}else{const j=Jc(y,M,"composite");this.binders[y]=new gr(T,E,M,F,c,j),m.push(`/z_${y}`)}else this.binders[y]=B?new fs(T.value,E):new Yf(T.value,E,M),m.push(`/u_${y}`)}this.cacheKey=m.sort().join("")}getMaxValue(s){const c=this.binders[s];return c instanceof ya||c instanceof gr?c.maxValue:0}populatePaintArrays(s,c,d,m,y,x){for(const E in this.binders){const T=this.binders[E];(T instanceof ya||T instanceof gr||T instanceof Ec)&&T.populatePaintArray(s,c,d,m,y,x)}}setConstantPatternPositions(s){for(const c in this.binders){const d=this.binders[c];d instanceof fs&&d.setConstantPatternPositions(s)}}updatePaintArrays(s,c,d,m,y,x){let E=!1;for(const T in s){const M=c.getPositions(T);for(const F of M){const B=d.feature(F.index);for(const V in this.binders){const j=this.binders[V];if((j instanceof ya||j instanceof gr||j instanceof Ec)&&!0===j.expression.isStateDependent){const G=m.paint.get(V);j.expression=G.value,j.updatePaintArray(F.start,F.end,B,s[T],y,x),E=!0}}}}return E}defines(){const s=[];for(const c in this.binders){const d=this.binders[c];(d instanceof Yf||d instanceof fs)&&s.push(...d.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return s}getBinderAttributes(){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof ya||d instanceof gr||d instanceof Ec)for(let m=0;m<d.paintVertexAttributes.length;m++)s.push(d.paintVertexAttributes[m].name)}return s}getBinderUniforms(){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Yf||d instanceof fs||d instanceof gr)for(const m of d.uniformNames)s.push(m)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const c=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof Yf||m instanceof fs||m instanceof gr)for(const y of m.uniformNames)c.push({name:y,property:d,binding:m.getBinding(s,y)})}return c}setUniforms(s,c,d,m,y){for(const{name:x,property:E,binding:T}of d)this.binders[E].setUniform(s,T,y,m.get(E),x)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const c=this.binders[s];(c instanceof ya||c instanceof gr||c instanceof Ec)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(s){for(const c in this.binders){const d=this.binders[c];(d instanceof ya||d instanceof gr||d instanceof Ec)&&d.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const c=this.binders[s];(c instanceof ya||c instanceof gr||c instanceof Ec)&&c.destroy()}}}class Wu{constructor(s,c,d=(()=>!0)){this.programConfigurations={};for(const m of s)this.programConfigurations[m.id]=new Gu(m,c,d);this.needsUpload=!1,this._featureMap=new Th,this._bufferOffset=0}populatePaintArrays(s,c,d,m,y,x,E){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(s,c,m,y,x,E);void 0!==c.id&&this._featureMap.add(c.id,d,this._bufferOffset,s),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,c,d,m,y){for(const x of d)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(s,this._featureMap,c,x,m,y)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const vx={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function D0(a,s){return vx[a]||[a.replace(`${s}-`,"").replace(/-/g,"_")]}const $g={"line-pattern":{source:vt,composite:vt},"fill-pattern":{source:vt,composite:vt},"fill-extrusion-pattern":{source:vt,composite:vt},"line-dasharray":{source:Ut,composite:Ut}},im={color:{source:_i,composite:en},number:{source:wr,composite:_i}};function Jc(a,s,c){const d=$g[a];return d&&d[c]||im[s][c]}Fn(Yf,"ConstantBinder"),Fn(fs,"PatternConstantBinder"),Fn(ya,"SourceExpressionBinder"),Fn(Ec,"PatternCompositeBinder"),Fn(gr,"CompositeExpressionBinder"),Fn(Gu,"ProgramConfiguration",{omit:["_buffers"]}),Fn(Wu,"ProgramConfigurationSet");const A0="-transition";class ka extends zc{constructor(s,c){if(super(),this.id=s.id,this.type=s.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==s.type&&(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,"background"!==s.type&&"sky"!==s.type&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),c.layout&&(this._unevaluatedLayout=new be(c.layout)),c.paint)){this._transitionablePaint=new q(c.paint);for(const d in s.paint)this.setPaintProperty(d,s.paint[d],{validate:!1});for(const d in s.layout)this.setLayoutProperty(d,s.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new we(c.paint)}}getLayoutProperty(s){return"visibility"===s?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,c,d={}){null!=c&&this._validate(Eh,`layers.${this.id}.layout.${s}`,s,c,d)||("visibility"!==s?this._unevaluatedLayout.setValue(s,c):this.visibility=c)}getPaintProperty(s){return Rn(s,A0)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,c,d={}){if(null!=c&&this._validate(Uf,`layers.${this.id}.paint.${s}`,s,c,d))return!1;if(Rn(s,A0))return this._transitionablePaint.setTransition(s.slice(0,-11),c||void 0),!1;{const m=this._transitionablePaint._values[s],y=m.value.isDataDriven(),x=m.value;this._transitionablePaint.setValue(s,c),this._handleSpecialPaintPropertyUpdate(s);const E=this._transitionablePaint._values[s].value,T=E.isDataDriven(),M=Rn(s,"pattern")||"line-dasharray"===s;return T||y||M||this._handleOverridablePaintPropertyUpdate(s,x,E)}}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getProgramConfiguration(s){return null}_handleOverridablePaintPropertyUpdate(s,c,d){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||"none"===this.visibility}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,c)}serialize(){const s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),qn(s,(c,d)=>!(void 0===c||"layout"===d&&!Object.keys(c).length||"paint"===d&&!Object.keys(c).length))}_validate(s,c,d,m,y={}){return(!y||!1!==y.validate)&&ju(this,s.call(zf,{key:c,layerType:this.type,objectKey:d,value:m,styleSpec:Nt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const s in this.paint._values){const c=this.paint.get(s);if(c instanceof ve&&Ma(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Pd(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const rm=st([{name:"a_pos",components:2,type:"Int16"}],4),Sh=st([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class io{constructor(s=[]){this.segments=s}prepareSegment(s,c,d,m){let y=this.segments[this.segments.length-1];return s>io.MAX_VERTEX_ARRAY_LENGTH&&ti(`Max vertices per segment is ${io.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!y||y.vertexLength+s>io.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m)&&(y={vertexOffset:c.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},void 0!==m&&(y.sortKey=m),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const s of this.segments)for(const c in s.vaos)s.vaos[c].destroy()}static simpleSegment(s,c,d,m){return new io([{vertexOffset:s,primitiveOffset:c,vertexLength:d,primitiveLength:m,vaos:{},sortKey:0}])}}io.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Fn(io,"SegmentVector");var ei=8192;class Wl{constructor(s,c){s&&(c?this.setSouthWest(s).setNorthEast(c):4===s.length?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof Fr?new Fr(s.lng,s.lat):Fr.convert(s),this}setSouthWest(s){return this._sw=s instanceof Fr?new Fr(s.lng,s.lat):Fr.convert(s),this}extend(s){const c=this._sw,d=this._ne;let m,y;if(s instanceof Fr)m=s,y=s;else{if(!(s instanceof Wl))return Array.isArray(s)?4===s.length||s.every(Array.isArray)?this.extend(Wl.convert(s)):this.extend(Fr.convert(s)):"object"==typeof s&&null!==s&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(Fr.convert(s)):this;if(m=s._sw,y=s._ne,!m||!y)return this}return c||d?(c.lng=Math.min(m.lng,c.lng),c.lat=Math.min(m.lat,c.lat),d.lng=Math.max(y.lng,d.lng),d.lat=Math.max(y.lat,d.lat)):(this._sw=new Fr(m.lng,m.lat),this._ne=new Fr(y.lng,y.lat)),this}getCenter(){return new Fr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Fr(this.getWest(),this.getNorth())}getSouthEast(){return new Fr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:c,lat:d}=Fr.convert(s);let m=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&m}static convert(s){return!s||s instanceof Wl?s:new Wl(s)}}var om=1e-6,ps=typeof Float32Array<"u"?Float32Array:Array;function Mh(){var a=new ps(9);return ps!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function sm(a,s,c){var d=s[0],m=s[1],y=s[2],x=s[3],E=s[4],T=s[5],M=s[6],F=s[7],B=s[8],V=c[0],j=c[1],G=c[2],Q=c[3],re=c[4],X=c[5],Ne=c[6],H=c[7],Fe=c[8];return a[0]=V*d+j*x+G*M,a[1]=V*m+j*E+G*F,a[2]=V*y+j*T+G*B,a[3]=Q*d+re*x+X*M,a[4]=Q*m+re*E+X*F,a[5]=Q*y+re*T+X*B,a[6]=Ne*d+H*x+Fe*M,a[7]=Ne*m+H*E+Fe*F,a[8]=Ne*y+H*T+Fe*B,a}function Cc(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function am(a,s){var c=s[0],d=s[1],m=s[2],y=s[3],x=s[4],E=s[5],T=s[6],M=s[7],F=s[8],B=s[9],V=s[10],j=s[11],G=s[12],Q=s[13],re=s[14],X=s[15],Ne=c*E-d*x,H=c*T-m*x,Fe=c*M-y*x,Ze=d*T-m*E,We=d*M-y*E,wt=m*M-y*T,yt=F*Q-B*G,Bt=F*re-V*G,ln=F*X-j*G,At=B*re-V*Q,Ht=B*X-j*Q,Gt=V*X-j*re,Qt=Ne*Gt-H*Ht+Fe*At+Ze*ln-We*Bt+wt*yt;return Qt?(a[0]=(E*Gt-T*Ht+M*At)*(Qt=1/Qt),a[1]=(m*Ht-d*Gt-y*At)*Qt,a[2]=(Q*wt-re*We+X*Ze)*Qt,a[3]=(V*We-B*wt-j*Ze)*Qt,a[4]=(T*ln-x*Gt-M*Bt)*Qt,a[5]=(c*Gt-m*ln+y*Bt)*Qt,a[6]=(re*Fe-G*wt-X*H)*Qt,a[7]=(F*wt-V*Fe+j*H)*Qt,a[8]=(x*Ht-E*ln+M*yt)*Qt,a[9]=(d*ln-c*Ht-y*yt)*Qt,a[10]=(G*We-Q*Fe+X*Ne)*Qt,a[11]=(B*Fe-F*We-j*Ne)*Qt,a[12]=(E*Bt-x*At-T*yt)*Qt,a[13]=(c*At-d*Bt+m*yt)*Qt,a[14]=(Q*H-G*Ze-re*Ne)*Qt,a[15]=(F*Ze-B*H+V*Ne)*Qt,a):null}function qu(a,s,c){var d=s[0],m=s[1],y=s[2],x=s[3],E=s[4],T=s[5],M=s[6],F=s[7],B=s[8],V=s[9],j=s[10],G=s[11],Q=s[12],re=s[13],X=s[14],Ne=s[15],H=c[0],Fe=c[1],Ze=c[2],We=c[3];return a[0]=H*d+Fe*E+Ze*B+We*Q,a[1]=H*m+Fe*T+Ze*V+We*re,a[2]=H*y+Fe*M+Ze*j+We*X,a[3]=H*x+Fe*F+Ze*G+We*Ne,a[4]=(H=c[4])*d+(Fe=c[5])*E+(Ze=c[6])*B+(We=c[7])*Q,a[5]=H*m+Fe*T+Ze*V+We*re,a[6]=H*y+Fe*M+Ze*j+We*X,a[7]=H*x+Fe*F+Ze*G+We*Ne,a[8]=(H=c[8])*d+(Fe=c[9])*E+(Ze=c[10])*B+(We=c[11])*Q,a[9]=H*m+Fe*T+Ze*V+We*re,a[10]=H*y+Fe*M+Ze*j+We*X,a[11]=H*x+Fe*F+Ze*G+We*Ne,a[12]=(H=c[12])*d+(Fe=c[13])*E+(Ze=c[14])*B+(We=c[15])*Q,a[13]=H*m+Fe*T+Ze*V+We*re,a[14]=H*y+Fe*M+Ze*j+We*X,a[15]=H*x+Fe*F+Ze*G+We*Ne,a}function Ph(a,s,c){var d,m,y,x,E,T,M,F,B,V,j,G,Q=c[0],re=c[1],X=c[2];return s===a?(a[12]=s[0]*Q+s[4]*re+s[8]*X+s[12],a[13]=s[1]*Q+s[5]*re+s[9]*X+s[13],a[14]=s[2]*Q+s[6]*re+s[10]*X+s[14],a[15]=s[3]*Q+s[7]*re+s[11]*X+s[15]):(m=s[1],y=s[2],x=s[3],E=s[4],T=s[5],M=s[6],F=s[7],B=s[8],V=s[9],j=s[10],G=s[11],a[0]=d=s[0],a[1]=m,a[2]=y,a[3]=x,a[4]=E,a[5]=T,a[6]=M,a[7]=F,a[8]=B,a[9]=V,a[10]=j,a[11]=G,a[12]=d*Q+E*re+B*X+s[12],a[13]=m*Q+T*re+V*X+s[13],a[14]=y*Q+M*re+j*X+s[14],a[15]=x*Q+F*re+G*X+s[15]),a}function Ic(a,s,c){var d=c[0],m=c[1],y=c[2];return a[0]=s[0]*d,a[1]=s[1]*d,a[2]=s[2]*d,a[3]=s[3]*d,a[4]=s[4]*m,a[5]=s[5]*m,a[6]=s[6]*m,a[7]=s[7]*m,a[8]=s[8]*y,a[9]=s[9]*y,a[10]=s[10]*y,a[11]=s[11]*y,a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15],a}function Hg(a,s,c){var d=Math.sin(c),m=Math.cos(c),y=s[4],x=s[5],E=s[6],T=s[7],M=s[8],F=s[9],B=s[10],V=s[11];return s!==a&&(a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[4]=y*m+M*d,a[5]=x*m+F*d,a[6]=E*m+B*d,a[7]=T*m+V*d,a[8]=M*m-y*d,a[9]=F*m-x*d,a[10]=B*m-E*d,a[11]=V*m-T*d,a}function lm(a,s,c){var d=Math.sin(c),m=Math.cos(c),y=s[0],x=s[1],E=s[2],T=s[3],M=s[8],F=s[9],B=s[10],V=s[11];return s!==a&&(a[4]=s[4],a[5]=s[5],a[6]=s[6],a[7]=s[7],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[0]=y*m-M*d,a[1]=x*m-F*d,a[2]=E*m-B*d,a[3]=T*m-V*d,a[8]=y*d+M*m,a[9]=x*d+F*m,a[10]=E*d+B*m,a[11]=T*d+V*m,a}function cm(a,s){return a[0]=s[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=s[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function kh(a,s,c){var d,m,y,x=c[0],E=c[1],T=c[2],M=Math.hypot(x,E,T);return M<om?null:(x*=M=1/M,E*=M,T*=M,d=Math.sin(s),m=Math.cos(s),a[0]=x*x*(y=1-m)+m,a[1]=E*x*y+T*d,a[2]=T*x*y-E*d,a[3]=0,a[4]=x*E*y-T*d,a[5]=E*E*y+m,a[6]=T*E*y+x*d,a[7]=0,a[8]=x*T*y+E*d,a[9]=E*T*y-x*d,a[10]=T*T*y+m,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,s=arguments.length;s--;)a+=arguments[s]*arguments[s];return Math.sqrt(a)});var xx=qu;function Nd(){var a=new ps(3);return ps!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function um(a){var s=new ps(3);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s}function eu(a){return Math.hypot(a[0],a[1],a[2])}function Xf(a,s,c){var d=new ps(3);return d[0]=a,d[1]=s,d[2]=c,d}function tu(a,s,c){return a[0]=s[0]+c[0],a[1]=s[1]+c[1],a[2]=s[2]+c[2],a}function R(a,s,c){return a[0]=s[0]-c[0],a[1]=s[1]-c[1],a[2]=s[2]-c[2],a}function C(a,s,c){return a[0]=s[0]*c[0],a[1]=s[1]*c[1],a[2]=s[2]*c[2],a}function D(a,s,c){return a[0]=Math.min(s[0],c[0]),a[1]=Math.min(s[1],c[1]),a[2]=Math.min(s[2],c[2]),a}function L(a,s,c){return a[0]=Math.max(s[0],c[0]),a[1]=Math.max(s[1],c[1]),a[2]=Math.max(s[2],c[2]),a}function Y(a,s,c){return a[0]=s[0]*c,a[1]=s[1]*c,a[2]=s[2]*c,a}function me(a,s,c,d){return a[0]=s[0]+c[0]*d,a[1]=s[1]+c[1]*d,a[2]=s[2]+c[2]*d,a}function nt(a,s){var c=s[0],d=s[1],m=s[2],y=c*c+d*d+m*m;return y>0&&(y=1/Math.sqrt(y)),a[0]=s[0]*y,a[1]=s[1]*y,a[2]=s[2]*y,a}function Pt(a,s){return a[0]*s[0]+a[1]*s[1]+a[2]*s[2]}function hn(a,s,c){var d=s[0],m=s[1],y=s[2],x=c[0],E=c[1],T=c[2];return a[0]=m*T-y*E,a[1]=y*x-d*T,a[2]=d*E-m*x,a}function Dn(a,s,c){var d=s[0],m=s[1],y=s[2],x=c[3]*d+c[7]*m+c[11]*y+c[15];return a[0]=(c[0]*d+c[4]*m+c[8]*y+c[12])/(x=x||1),a[1]=(c[1]*d+c[5]*m+c[9]*y+c[13])/x,a[2]=(c[2]*d+c[6]*m+c[10]*y+c[14])/x,a}function mi(a,s,c){var d=c[0],m=c[1],y=c[2],x=s[0],E=s[1],T=s[2],M=m*T-y*E,F=y*x-d*T,B=d*E-m*x,V=m*B-y*F,j=y*M-d*B,G=d*F-m*M,Q=2*c[3];return F*=Q,B*=Q,j*=2,G*=2,a[0]=x+(M*=Q)+(V*=2),a[1]=E+F+j,a[2]=T+B+G,a}var ir,go=R,nu=C,dm=eu;function Rh(a,s,c){return a[0]=s[0]*c,a[1]=s[1]*c,a[2]=s[2]*c,a[3]=s[3]*c,a}function Tc(a,s){var c=s[0],d=s[1],m=s[2],y=s[3],x=c*c+d*d+m*m+y*y;return x>0&&(x=1/Math.sqrt(x)),a[0]=c*x,a[1]=d*x,a[2]=m*x,a[3]=y*x,a}function Zu(a,s,c){var d=s[0],m=s[1],y=s[2],x=s[3];return a[0]=c[0]*d+c[4]*m+c[8]*y+c[12]*x,a[1]=c[1]*d+c[5]*m+c[9]*y+c[13]*x,a[2]=c[2]*d+c[6]*m+c[10]*y+c[14]*x,a[3]=c[3]*d+c[7]*m+c[11]*y+c[15]*x,a}function hm(){var a=new ps(4);return ps!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Qf(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function Bd(a,s,c){c*=.5;var d=s[0],m=s[1],y=s[2],x=s[3],E=Math.sin(c),T=Math.cos(c);return a[0]=d*T+x*E,a[1]=m*T+y*E,a[2]=y*T-m*E,a[3]=x*T-d*E,a}function Gg(a,s,c){c*=.5;var d=s[0],m=s[1],y=s[2],x=s[3],E=Math.sin(c),T=Math.cos(c);return a[0]=d*T-y*E,a[1]=m*T+x*E,a[2]=y*T+d*E,a[3]=x*T-m*E,a}Nd(),ir=new ps(4),ps!=Float32Array&&(ir[0]=0,ir[1]=0,ir[2]=0,ir[3]=0);var Hs=Tc;Nd(),Xf(1,0,0),Xf(0,1,0),hm(),hm(),Mh();const S0=st([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ms}=S0,Oh=st([{name:"a_pos_3",components:3,type:"Int16"}]);var Jf=st([{name:"a_pos",type:"Int16",components:2}]);class M0{constructor(s,c){this.pos=s,this.dir=c}intersectsPlane(s,c,d){const m=Pt(c,this.dir);if(Math.abs(m)<1e-6)return!1;const y=((s[0]-this.pos[0])*c[0]+(s[1]-this.pos[1])*c[1]+(s[2]-this.pos[2])*c[2])/m;return d[0]=this.pos[0]+this.dir[0]*y,d[1]=this.pos[1]+this.dir[1]*y,d[2]=this.pos[2]+this.dir[2]*y,!0}closestPointOnSphere(s,c,d){if(Q=(j=this.pos)[0],re=j[1],X=j[2],Ne=(G=s)[0],H=G[1],Fe=G[2],Math.abs(Q-Ne)<=om*Math.max(1,Math.abs(Q),Math.abs(Ne))&&Math.abs(re-H)<=om*Math.max(1,Math.abs(re),Math.abs(H))&&Math.abs(X-Fe)<=om*Math.max(1,Math.abs(X),Math.abs(Fe))||0===c)return d[0]=d[1]=d[2]=0,!1;var j,G,Q,re,X,Ne,H,Fe;const[m,y,x]=this.dir,E=this.pos[0]-s[0],T=this.pos[1]-s[1],M=this.pos[2]-s[2],F=m*m+y*y+x*x,B=2*(E*m+T*y+M*x),V=B*B-4*F*(E*E+T*T+M*M-c*c);if(V<0){const j=Math.max(-B/2,0),G=E+m*j,Q=T+y*j,re=M+x*j,X=Math.hypot(G,Q,re);return d[0]=G*c/X,d[1]=Q*c/X,d[2]=re*c/X,!1}{const j=(-B-Math.sqrt(V))/(2*F);if(j<0){const G=Math.hypot(E,T,M);return d[0]=E*c/G,d[1]=T*c/G,d[2]=M*c/G,!1}return d[0]=E+m*j,d[1]=T+y*j,d[2]=M+x*j,!0}}}class Fh{constructor(s,c,d,m,y){this.TL=s,this.TR=c,this.BR=d,this.BL=m,this.horizon=y}static fromInvProjectionMatrix(s,c,d){const m=[-1,1,1],y=[1,1,1],x=[1,-1,1],E=[-1,-1,1],T=Dn(m,m,s),M=Dn(y,y,s),F=Dn(x,x,s),B=Dn(E,E,s);return new Fh(T,M,F,B,c/d)}}class Lh{constructor(s,c){this.points=s,this.planes=c}static fromInvProjectionMatrix(s,c,d,m){const y=Math.pow(2,d),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const M=Zu([],T,s),F=1/M[3]/c*y;return(B=M)[0]=(V=M)[0]*(j=[F,F,m?1/M[3]:F,F])[0],B[1]=V[1]*j[1],B[2]=V[2]*j[2],B[3]=V[3]*j[3],B;var B,V,j}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const M=nt([],hn([],go([],x[T[0]],x[T[1]]),go([],x[T[2]],x[T[1]]))),F=-Pt(M,x[T[1]]);return M.concat(F)});return new Lh(x,E)}}class Es{static fromPoints(s){const c=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const m of s)D(c,c,m),L(d,d,m);return new Es(c,d)}static applyTransform(s,c){const d=s.getCorners();for(let m=0;m<d.length;++m)Dn(d[m],d[m],c);return Es.fromPoints(d)}constructor(s,c){this.min=s,this.max=c,this.center=Y([],tu([],this.min,this.max),.5)}quadrant(s){const c=[s%2==0,s<2],d=um(this.min),m=um(this.max);for(let y=0;y<c.length;y++)d[y]=c[y]?this.min[y]:this.center[y],m[y]=c[y]?this.center[y]:this.max[y];return m[2]=this.max[2],new Es(d,m)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,c=this.max;return[[s[0],s[1],s[2]],[c[0],s[1],s[2]],[c[0],c[1],s[2]],[s[0],c[1],s[2]],[s[0],s[1],c[2]],[c[0],s[1],c[2]],[c[0],c[1],c[2]],[s[0],c[1],c[2]]]}intersects(s){const c=this.getCorners();let d=!0;for(let m=0;m<s.planes.length;m++){const y=s.planes[m];let x=0;for(let E=0;E<c.length;E++)x+=Pt(y,c[E])+y[3]>=0;if(0===x)return 0;x!==c.length&&(d=!1)}if(d)return 2;for(let m=0;m<3;m++){let y=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let E=0;E<s.points.length;E++){const T=s.points[E][m]-this.min[m];y=Math.min(y,T),x=Math.max(x,T)}if(x<0||y>this.max[m]-this.min[m])return 0}return 1}}const Nh=5,bx=6,Dc=ei/Math.PI/2,fm=16383,Wg=[64,32,16],iu=-Dc,ru=Dc,mF=[new Es([iu,iu,iu],[ru,ru,ru]),new Es([iu,iu,iu],[0,0,ru]),new Es([0,iu,iu],[ru,0,ru]),new Es([iu,0,iu],[0,ru,ru]),new Es([0,0,iu],[ru,ru,ru])];function wx(a){return a*Dc/Zg}function mA(a,s,c,d=!0){const m=Y([],a._camera.position,a.worldSize),y=[s,c,1,1];Zu(y,y,a.pixelMatrixInverse),Rh(y,y,1/y[3]);const x=nt([],go([],y,m)),E=a.globeMatrix,T=[E[12],E[13],E[14]],M=go([],T,m),F=eu(M),B=nt([],M),V=a.worldSize/(2*Math.PI),j=Pt(B,x),G=Math.asin(V/F);if(G<Math.acos(j)){if(!d)return null;const ln=[],At=[];Y(ln,x,F/j),nt(At,go(At,ln,M)),nt(x,tu(x,M,Y(x,At,Math.tan(G)*F)))}const Q=[];new M0(m,x).closestPointOnSphere(T,V,Q);const re=nt([],hi(E,0)),X=nt([],hi(E,1)),Ne=nt([],hi(E,2)),H=Pt(re,Q),Fe=Pt(X,Q),Ze=Pt(Ne,Q),We=lt(Math.asin(-Fe/V));let wt=lt(Math.atan2(H,Ze));wt=a.center.lng+function(ln,At){const Ht=(At-ln+180)%360-180;return Ht<-180?Ht+360:Ht}(a.center.lng,wt);const yt=Ac(wt),Bt=Rt(ql(We),0,1);return new $h(yt,Bt)}class gF{constructor(s,c,d){this.a=go([],s,d),this.b=go([],c,d),this.center=d;const m=nt([],this.a),y=nt([],this.b);this.angle=Math.acos(Pt(m,y))}}function Bh(a,s){if(0===a.angle)return null;let c;return c=0===a.a[s]?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[s]/a.a[s]/Math.sin(a.angle)-1/Math.tan(a.angle)),c<0||c>1?null:function(d,m,y,x){const E=Math.sin(y);return d*(Math.sin((1-x)*y)/E)+m*(Math.sin(x*y)/E)}(a.a[s],a.b[s],a.angle,Rt(c,0,1))+a.center[s]}function Ku(a){if(a.z<=1)return mF[a.z+2*a.y+a.x];const s=vl(P0(a));return Es.fromPoints(s)}function ep(a,s,c){return Y(a,a,1-c),me(a,a,s,c)}function Rs(a,s){const c=ea(s.zoom);if(0===c)return Ku(a);const d=P0(a),m=vl(d),y=Ac(d.getWest())*s.worldSize,x=Ac(d.getEast())*s.worldSize,E=ql(d.getNorth())*s.worldSize,T=ql(d.getSouth())*s.worldSize,M=[y,E,0],F=[x,E,0],B=[y,T,0],V=[x,T,0],j=am([],s.globeMatrix);return Dn(M,M,j),Dn(F,F,j),Dn(B,B,j),Dn(V,V,j),m[0]=ep(m[0],B,c),m[1]=ep(m[1],V,c),m[2]=ep(m[2],F,c),m[3]=ep(m[3],M,c),Es.fromPoints(m)}function xE(a,s,c){for(const d of a)Dn(d,d,s),Y(d,d,c)}function P0({x:a,y:s,z:c}){const d=1/(1<<c),m=new Fr(jr(a*d),ta((s+1)*d)),y=new Fr(jr((a+1)*d),ta(s*d));return new Wl(m,y)}function vl(a){const s=xt(a.getNorth()),c=xt(a.getSouth()),d=Math.cos(s),m=Math.cos(c),y=Math.sin(s),x=Math.sin(c),E=a.getWest(),T=a.getEast();return[ou(m,x,E),ou(m,x,T),ou(d,y,T),ou(d,y,E)]}function ou(a,s,c,d=Dc){return c=xt(c),[a*Math.sin(c)*d,-s*d,a*Math.cos(c)*d]}function tp(a,s,c){return ou(Math.cos(xt(a)),Math.sin(xt(a)),s,c)}function Vh(a,s,c,d){const m=1<<c.z,y=(a/ei+c.x)/m;return tp(ta((s/ei+c.y)/m),jr(y),d)}function zh({min:a,max:s}){return fm/Math.max(s[0]-a[0],s[1]-a[1],s[2]-a[2])}const bE=new Float64Array(16);function k0(a){const s=zh(a),c=cm(bE,[s,s,s]);return Ph(c,c,((d=[])[0]=-(m=a.min)[0],d[1]=-m[1],d[2]=-m[2],d));var d,m}function Ex(a){const s=(d=a.min,(c=bE)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=1,c);var c,d;const m=1/zh(a);return Ic(s,s,[m,m,m])}function gA(a,s,c,d,m){const y=function(T){const M=ei/(2*Math.PI);return T/(2*Math.PI)/M}(c),x=[a,s,-c/(2*Math.PI)],E=Cc(new Float64Array(16));return Ph(E,E,x),Ic(E,E,[y,y,y]),Hg(E,E,xt(-m)),lm(E,E,xt(-d)),E}function ea(a){return Jn(Nh,bx,a)}function R0(a,s){const c=tp(s.lat,s.lng);return x=(m=R([],function(G){const Q=tp(G._center.lat,G._center.lng);let re=hn([],Xf(0,1,0),Q);const X=kh([],-G.angle,Q);re=Dn(re,re,X),kh(X,-G._pitch,re);const Ne=nt([],Q);return Y(Ne,Ne,wx(G.cameraToCenterDistance/G.pixelsPerMeter)),Dn(Ne,Ne,X),tu([],Q,Ne)}(a),c))[0],E=m[1],T=m[2],M=(y=c)[0],F=y[1],B=y[2],j=(V=Math.sqrt(x*x+E*E+T*T)*Math.sqrt(M*M+F*F+B*B))&&Pt(m,y)/V,Math.acos(Math.min(Math.max(j,-1),1));var m,y,x,E,T,M,F,B,V,j}function Uh(a,s){return R0(a,s)>Math.PI/2*1.01}const _A=xt(85),wE=Math.cos(_A),yA=Math.sin(_A),Zg=6371008.8,EE=2*Math.PI*Zg;class jh{constructor(s,c){if(isNaN(s)||isNaN(c))throw new Error(`Invalid LngLat object: (${s}, ${c})`);if(this.lng=+s,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new jh(Kt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const c=Math.PI/180,d=this.lat*c,m=s.lat*c,y=Math.sin(d)*Math.sin(m)+Math.cos(d)*Math.cos(m)*Math.cos((s.lng-this.lng)*c);return Zg*Math.acos(Math.min(y,1))}toBounds(s=0){const c=360*s/40075017,d=c/Math.cos(Math.PI/180*this.lat);return new Wl(new jh(this.lng-d,this.lat-c),new jh(this.lng+d,this.lat+c))}toEcef(s){const c=wx(s);return tp(this.lat,this.lng,Dc+c)}static convert(s){if(s instanceof jh)return s;if(Array.isArray(s)&&(2===s.length||3===s.length))return new jh(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&"object"==typeof s&&null!==s)return new jh(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Fr=jh;function Cx(a){return EE*Math.cos(a*Math.PI/180)}function Ac(a){return(180+a)/360}function ql(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function su(a,s){return a/Cx(s)}function jr(a){return 360*a-180}function ta(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Vd(a,s){return a*Cx(ta(s))}const na=85.051129;function Ix(a){return 1/Math.cos(a*Math.PI/180)}class $h{constructor(s,c,d=0){this.x=+s,this.y=+c,this.z=+d}static fromLngLat(s,c=0){const d=Fr.convert(s);return new $h(Ac(d.lng),ql(d.lat),su(c,d.lat))}toLngLat(){return new Fr(jr(this.x),ta(this.y))}toAltitude(){return Vd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/EE*Ix(ta(this.y))}}function mm(a,s,c,d,m,y,x,E,T){const M=(s+d)/2,F=(c+m)/2,B=new ze(M,F);E(B),function(V,j,G,Q,re,X){const Ne=G-re,H=Q-X;return Math.abs((Q-j)*Ne-(G-V)*H)/Math.hypot(Ne,H)}(B.x,B.y,y.x,y.y,x.x,x.y)>=T?(mm(a,s,c,M,F,y,B,E,T),mm(a,M,F,d,m,B,x,E,T)):a.push(x)}function Tx(a,s,c){let d=a[0],m=d.x,y=d.y;s(d);const x=[d];for(let E=1;E<a.length;E++){const T=a[E],{x:M,y:F}=T;s(T),mm(x,m,y,M,F,d,T,s,c),m=M,y=F,d=T}return x}function Dx(a,s,c,d){if(d(s,c)){const m=s.add(c)._mult(.5);Dx(a,s,m,d),Dx(a,m,c,d)}else a.push(c)}function vA(a,s){let c=a[0];const d=[c];for(let m=1;m<a.length;m++){const y=a[m];Dx(d,c,y,s),c=y}return d}const Hh=Math.pow(2,14)-1,gm=-Hh-1;function xA(a,s){const c=Math.round(a.x*s),d=Math.round(a.y*s);return a.x=Rt(c,gm,Hh),a.y=Rt(d,gm,Hh),(c<a.x||c>a.x+1||d<a.y||d>a.y+1)&&ti("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function Gh(a,s,c){const d=a.loadGeometry(),m=a.extent,y=ei/m;if(s&&c&&c.projection.isReprojectedInTileSpace){const x=1<<s.z,{scale:E,x:T,y:M,projection:F}=c,B=V=>{const j=jr((s.x+V.x/m)/x),G=ta((s.y+V.y/m)/x),Q=F.project(j,G);V.x=(Q.x*E-T)*m,V.y=(Q.y*E-M)*m};for(let V=0;V<d.length;V++)if(1!==a.type)d[V]=Tx(d[V],B,1);else{const j=[];for(const G of d[V])G.x<0||G.x>=m||G.y<0||G.y>=m||(B(G),j.push(G));d[V]=j}}for(const x of d)for(const E of x)xA(E,y);return d}function Wh(a,s){return{type:a.type,id:a.id,properties:a.properties,geometry:s?Gh(a):[]}}function O0(a,s,c,d,m){a.emplaceBack(2*s+(d+1)/2,2*c+(m+1)/2)}function Ax(a,s,c){a.emplaceBack(s.x,s.y,s.z,16384*c[0],16384*c[1],16384*c[2])}class Sx{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new rn,this.indexArray=new Bn,this.segments=new io,this.programConfigurations=new Wu(s.layers,s.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d,m){const y=this.layers[0],x=[];let E=null;"circle"===y.type&&(E=y.layout.get("circle-sort-key"));for(const{feature:M,id:F,index:B,sourceLayerIndex:V}of s){const j=this.layers[0]._featureFilter.needGeometry,G=Wh(M,j);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),G,d))continue;const Q=E?E.evaluate(G,{},d):void 0,re={id:F,properties:M.properties,type:M.type,sourceLayerIndex:V,index:B,geometry:j?G.geometry:Gh(M,d,m),patterns:{},sortKey:Q};x.push(re)}E&&x.sort((M,F)=>M.sortKey-F.sortKey);let T=null;"globe"===m.projection.name&&(this.globeExtVertexArray=new sn,T=m.projection);for(const M of x){const{geometry:F,index:B,sourceLayerIndex:V}=M,j=s[B].feature;this.addFeature(M,F,B,c.availableImages,d,T),c.featureIndex.insert(j,F,B,V,this.index)}}update(s,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,rm.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,Sh.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,c,d,m,y,x){for(const E of c)for(const T of E){const M=T.x,F=T.y;if(M<0||M>=ei||F<0||F>=ei)continue;if(x){const j=x.projectTilePoint(M,F,y),G=x.upVector(y,M,F),Q=this.globeExtVertexArray;Ax(Q,j,G),Ax(Q,j,G),Ax(Q,j,G),Ax(Q,j,G)}const B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),V=B.vertexLength;O0(this.layoutVertexArray,M,F,-1,-1),O0(this.layoutVertexArray,M,F,1,-1),O0(this.layoutVertexArray,M,F,1,1),O0(this.layoutVertexArray,M,F,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+2,V+3),B.vertexLength+=4,B.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,{},m,y)}}function CE(a,s){for(let c=0;c<a.length;c++)if(np(s,a[c]))return!0;for(let c=0;c<s.length;c++)if(np(a,s[c]))return!0;return!!Mx(a,s)}function bA(a,s,c){return!!np(a,s)||!!DE(s,a,c)}function Kg(a,s){if(1===a.length)return wA(s,a[0]);for(let c=0;c<s.length;c++){const d=s[c];for(let m=0;m<d.length;m++)if(np(a,d[m]))return!0}for(let c=0;c<a.length;c++)if(wA(s,a[c]))return!0;for(let c=0;c<s.length;c++)if(Mx(a,s[c]))return!0;return!1}function IE(a,s,c){if(a.length>1){if(Mx(a,s))return!0;for(let d=0;d<s.length;d++)if(DE(s[d],a,c))return!0}for(let d=0;d<a.length;d++)if(DE(a[d],s,c))return!0;return!1}function Mx(a,s){if(0===a.length||0===s.length)return!1;for(let c=0;c<a.length-1;c++){const d=a[c],m=a[c+1];for(let y=0;y<s.length-1;y++)if(TE(d,m,s[y],s[y+1]))return!0}return!1}function TE(a,s,c,d){return Ei(a,c,d)!==Ei(s,c,d)&&Ei(a,s,c)!==Ei(a,s,d)}function DE(a,s,c){const d=c*c;if(1===s.length)return a.distSqr(s[0])<d;for(let m=1;m<s.length;m++)if(Px(a,s[m-1],s[m])<d)return!0;return!1}function Px(a,s,c){const d=s.distSqr(c);if(0===d)return a.distSqr(s);const m=((a.x-s.x)*(c.x-s.x)+(a.y-s.y)*(c.y-s.y))/d;return a.distSqr(m<0?s:m>1?c:c.sub(s)._mult(m)._add(s))}function wA(a,s){let c,d,m,y=!1;for(let x=0;x<a.length;x++){c=a[x];for(let E=0,T=c.length-1;E<c.length;T=E++)d=c[E],m=c[T],d.y>s.y!=m.y>s.y&&s.x<(m.x-d.x)*(s.y-d.y)/(m.y-d.y)+d.x&&(y=!y)}return y}function np(a,s){let c=!1;for(let d=0,m=a.length-1;d<a.length;m=d++){const y=a[d],x=a[m];y.y>s.y!=x.y>s.y&&s.x<(x.x-y.x)*(s.y-y.y)/(x.y-y.y)+y.x&&(c=!c)}return c}function AE(a,s,c,d,m){for(const x of a)if(s<=x.x&&c<=x.y&&d>=x.x&&m>=x.y)return!0;const y=[new ze(s,c),new ze(s,m),new ze(d,m),new ze(d,c)];if(a.length>2)for(const x of y)if(np(a,x))return!0;for(let x=0;x<a.length-1;x++)if(kx(a[x],a[x+1],y))return!0;return!1}function kx(a,s,c){const d=c[0],m=c[2];if(a.x<d.x&&s.x<d.x||a.x>m.x&&s.x>m.x||a.y<d.y&&s.y<d.y||a.y>m.y&&s.y>m.y)return!1;const y=Ei(a,s,c[0]);return y!==Ei(a,s,c[1])||y!==Ei(a,s,c[2])||y!==Ei(a,s,c[3])}function Yg(a,s,c){const d=s.paint.get(a).value;return"constant"===d.kind?d.value:c.programConfigurations.get(s.id).getMaxValue(a)}function Rx(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function F0(a,s,c,d,m){if(!s[0]&&!s[1])return a;const y=ze.convert(s)._mult(m);"viewport"===c&&y._rotate(-d);const x=[];for(let E=0;E<a.length;E++)x.push(a[E].sub(y));return x}function EA(a,s,c,d){const m=ze.convert(a)._mult(d);return"viewport"===s&&m._rotate(-c),m}Fn(Sx,"CircleBucket",{omit:["layers"]});const _F=new Se({"circle-sort-key":new de(Nt.layout_circle["circle-sort-key"])});var yF={paint:new Se({"circle-radius":new de(Nt.paint_circle["circle-radius"]),"circle-color":new de(Nt.paint_circle["circle-color"]),"circle-blur":new de(Nt.paint_circle["circle-blur"]),"circle-opacity":new de(Nt.paint_circle["circle-opacity"]),"circle-translate":new K(Nt.paint_circle["circle-translate"]),"circle-translate-anchor":new K(Nt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new K(Nt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new K(Nt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new de(Nt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new de(Nt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new de(Nt.paint_circle["circle-stroke-opacity"])}),layout:_F};function CA(a,s,c,d,m,y,x,E,T){if(y&&a.queryGeometry.isAboveHorizon)return!1;y&&(T*=a.pixelToTileUnitsFactor);const M=a.tileID.canonical,F=c.projection.upVectorScale(M,c.center.lat,c.worldSize).metersToTile;for(const B of s)for(const V of B){const j=V.add(E),G=m&&c.elevation?c.elevation.exaggeration()*m.getElevationAt(j.x,j.y,!0):0,Q=c.projection.projectTilePoint(j.x,j.y,M);if(G>0){const H=c.projection.upVector(M,j.x,j.y);Q.x+=H[0]*F*G,Q.y+=H[1]*F*G,Q.z+=H[2]*F*G}const re=y?j:vF(Q.x,Q.y,Q.z,d),X=y?a.tilespaceRays.map(H=>N0(H,G)):a.queryGeometry.screenGeometry,Ne=Zu([],[Q.x,Q.y,Q.z,1],d);if(!x&&y?T*=Ne[3]/c.cameraToCenterDistance:x&&!y&&(T*=c.cameraToCenterDistance/Ne[3]),y){const H=ta((V.y/ei+M.y)/(1<<M.z));T/=c.projection.pixelsPerMeter(H,1)/su(1,H)}if(bA(X,re,T))return!0}return!1}function vF(a,s,c,d){const m=Zu([],[a,s,c,1],d);return new ze(m[0]/m[3],m[1]/m[3])}const SE=Xf(0,0,0),L0=Xf(0,0,1);function N0(a,s){const c=Nd();return SE[2]=s,a.intersectsPlane(SE,L0,c),new ze(c[0],c[1])}class Ox extends Sx{}function Fx(a,{width:s,height:c},d,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==s*c*d)throw new RangeError("mismatched image size")}else m=new Uint8Array(s*c*d);return a.width=s,a.height=c,a.data=m,a}function Lx(a,s,c){const{width:d,height:m}=s;d===a.width&&m===a.height||(qh(a,s,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,d),height:Math.min(a.height,m)},c),a.width=d,a.height=m,a.data=s.data)}function qh(a,s,c,d,m,y){if(0===m.width||0===m.height)return s;if(m.width>a.width||m.height>a.height||c.x>a.width-m.width||c.y>a.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>s.width||m.height>s.height||d.x>s.width-m.width||d.y>s.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const x=a.data,E=s.data;for(let T=0;T<m.height;T++){const M=((c.y+T)*a.width+c.x)*y,F=((d.y+T)*s.width+d.x)*y;for(let B=0;B<m.width*y;B++)E[F+B]=x[M+B]}return s}Fn(Ox,"HeatmapBucket",{omit:["layers"]});class Yu{constructor(s,c){Fx(this,s,1,c)}resize(s){Lx(this,new Yu(s),1)}clone(){return new Yu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,d,m,y){qh(s,c,d,m,y,1)}}class nl{constructor(s,c){Fx(this,s,4,c)}resize(s){Lx(this,new nl(s),4)}replace(s,c){c?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new nl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,d,m,y){qh(s,c,d,m,y,4)}}Fn(Yu,"AlphaImage"),Fn(nl,"RGBAImage");var B0={paint:new Se({"heatmap-radius":new de(Nt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new de(Nt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new K(Nt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ae(Nt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new K(Nt.paint_heatmap["heatmap-opacity"])})};function _m(a){const s={},c=a.resolution||256,d=a.clips?a.clips.length:1,m=a.image||new nl({width:c,height:d}),y=(x,E,T)=>{s[a.evaluationKey]=T;const M=a.expression.evaluate(s);m.data[x+E+0]=Math.floor(255*M.r/M.a),m.data[x+E+1]=Math.floor(255*M.g/M.a),m.data[x+E+2]=Math.floor(255*M.b/M.a),m.data[x+E+3]=Math.floor(255*M.a)};if(a.clips)for(let x=0,E=0;x<d;++x,E+=4*c)for(let T=0,M=0;T<c;T++,M+=4){const F=T/(c-1),{start:B,end:V}=a.clips[x];y(E,M,B*(1-F)+V*F)}else for(let x=0,E=0;x<c;x++,E+=4)y(0,E,x/(c-1));return m}var Zh={paint:new Se({"hillshade-illumination-direction":new K(Nt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new K(Nt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new K(Nt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new K(Nt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new K(Nt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new K(Nt.paint_hillshade["hillshade-accent-color"])})};const IA=st([{name:"a_pos",components:2,type:"Int16"}],4),{members:TA}=IA;var Nx={exports:{}};function Xg(a,s,c){c=c||2;var d,m,y,x,E,T,M,F=s&&s.length,B=F?s[0]*c:a.length,V=V0(a,0,B,c,!0),j=[];if(!V||V.next===V.prev)return j;if(F&&(V=function(Q,re,X,Ne){var H,Fe,Ze,We=[];for(H=0,Fe=re.length;H<Fe;H++)(Ze=V0(Q,re[H]*Ne,H<Fe-1?re[H+1]*Ne:Q.length,Ne,!1))===Ze.next&&(Ze.steiner=!0),We.push(Ra(Ze));for(We.sort(xl),H=0;H<We.length;H++)X=Bx(We[H],X);return X}(a,s,V,c)),a.length>80*c){d=y=a[0],m=x=a[1];for(var G=c;G<B;G+=c)(E=a[G])<d&&(d=E),(T=a[G+1])<m&&(m=T),E>y&&(y=E),T>x&&(x=T);M=0!==(M=Math.max(y-d,x-m))?32767/M:0}return Qg(V,j,c,d,m,M,0),j}function V0(a,s,c,d,m){var y,x;if(m===r_(a,s,c,d)>0)for(y=s;y<c;y+=d)x=RE(y,a[y],a[y+1],x);else for(y=c-d;y>=s;y-=d)x=RE(y,a[y],a[y+1],x);return x&&z0(x,x.next)&&(n_(x),x=x.next),x}function ip(a,s){if(!a)return a;s||(s=a);var c,d=a;do{if(c=!1,d.steiner||!z0(d,d.next)&&0!==Vo(d.prev,d,d.next))d=d.next;else{if(n_(d),(d=s=d.prev)===d.next)break;c=!0}}while(c||d!==s);return s}function Qg(a,s,c,d,m,y,x){if(a){!x&&y&&function(F,B,V,j){var G=F;do{0===G.z&&(G.z=Jg(G.x,G.y,B,V,j)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next}while(G!==F);G.prevZ.nextZ=null,G.prevZ=null,function(Q){var re,X,Ne,H,Fe,Ze,We,wt,yt=1;do{for(X=Q,Q=null,Fe=null,Ze=0;X;){for(Ze++,Ne=X,We=0,re=0;re<yt&&(We++,Ne=Ne.nextZ);re++);for(wt=yt;We>0||wt>0&&Ne;)0!==We&&(0===wt||!Ne||X.z<=Ne.z)?(H=X,X=X.nextZ,We--):(H=Ne,Ne=Ne.nextZ,wt--),Fe?Fe.nextZ=H:Q=H,H.prevZ=Fe,Fe=H;X=Ne}Fe.nextZ=null,yt*=2}while(Ze>1)}(G)}(a,d,m,y);for(var E,T,M=a;a.prev!==a.next;)if(E=a.prev,T=a.next,y?ME(a,d,m,y):DA(a))s.push(E.i/c|0),s.push(a.i/c|0),s.push(T.i/c|0),n_(a),a=T.next,M=T.next;else if((a=T)===M){x?1===x?Qg(a=AA(ip(a),s,c),s,c,d,m,y,2):2===x&&SA(a,s,c,d,m,y):Qg(ip(a),s,c,d,m,y,1);break}}}function DA(a){var s=a.prev,c=a,d=a.next;if(Vo(s,c,d)>=0)return!1;for(var m=s.x,y=c.x,x=d.x,E=s.y,T=c.y,M=d.y,F=m<y?m<x?m:x:y<x?y:x,B=E<T?E<M?E:M:T<M?T:M,V=m>y?m>x?m:x:y>x?y:x,j=E>T?E>M?E:M:T>M?T:M,G=d.next;G!==s;){if(G.x>=F&&G.x<=V&&G.y>=B&&G.y<=j&&Xu(m,E,y,T,x,M,G.x,G.y)&&Vo(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function ME(a,s,c,d){var m=a.prev,y=a,x=a.next;if(Vo(m,y,x)>=0)return!1;for(var E=m.x,T=y.x,M=x.x,F=m.y,B=y.y,V=x.y,j=E<T?E<M?E:M:T<M?T:M,G=F<B?F<V?F:V:B<V?B:V,Q=E>T?E>M?E:M:T>M?T:M,re=F>B?F>V?F:V:B>V?B:V,X=Jg(j,G,s,c,d),Ne=Jg(Q,re,s,c,d),H=a.prevZ,Fe=a.nextZ;H&&H.z>=X&&Fe&&Fe.z<=Ne;){if(H.x>=j&&H.x<=Q&&H.y>=G&&H.y<=re&&H!==m&&H!==x&&Xu(E,F,T,B,M,V,H.x,H.y)&&Vo(H.prev,H,H.next)>=0||(H=H.prevZ,Fe.x>=j&&Fe.x<=Q&&Fe.y>=G&&Fe.y<=re&&Fe!==m&&Fe!==x&&Xu(E,F,T,B,M,V,Fe.x,Fe.y)&&Vo(Fe.prev,Fe,Fe.next)>=0))return!1;Fe=Fe.nextZ}for(;H&&H.z>=X;){if(H.x>=j&&H.x<=Q&&H.y>=G&&H.y<=re&&H!==m&&H!==x&&Xu(E,F,T,B,M,V,H.x,H.y)&&Vo(H.prev,H,H.next)>=0)return!1;H=H.prevZ}for(;Fe&&Fe.z<=Ne;){if(Fe.x>=j&&Fe.x<=Q&&Fe.y>=G&&Fe.y<=re&&Fe!==m&&Fe!==x&&Xu(E,F,T,B,M,V,Fe.x,Fe.y)&&Vo(Fe.prev,Fe,Fe.next)>=0)return!1;Fe=Fe.nextZ}return!0}function AA(a,s,c){var d=a;do{var m=d.prev,y=d.next.next;!z0(m,y)&&Vx(m,d,d.next,y)&&t_(m,y)&&t_(y,m)&&(s.push(m.i/c|0),s.push(d.i/c|0),s.push(y.i/c|0),n_(d),n_(d.next),d=a=y),d=d.next}while(d!==a);return ip(d)}function SA(a,s,c,d,m,y){var x=a;do{for(var E=x.next.next;E!==x.prev;){if(x.i!==E.i&&kE(x,E)){var T=zx(x,E);return x=ip(x,x.next),T=ip(T,T.next),Qg(x,s,c,d,m,y,0),void Qg(T,s,c,d,m,y,0)}E=E.next}x=x.next}while(x!==a)}function xl(a,s){return a.x-s.x}function Bx(a,s){var c=function(m,y){var x,E=y,T=m.x,M=m.y,F=-1/0;do{if(M<=E.y&&M>=E.next.y&&E.next.y!==E.y){var B=E.x+(M-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(B<=T&&B>F&&(F=B,x=E.x<E.next.x?E:E.next,B===T))return x}E=E.next}while(E!==y);if(!x)return null;var V,j=x,G=x.x,Q=x.y,re=1/0;E=x;do{T>=E.x&&E.x>=G&&T!==E.x&&Xu(M<Q?T:F,M,G,Q,M<Q?F:T,M,E.x,E.y)&&(V=Math.abs(M-E.y)/(T-E.x),t_(E,m)&&(V<re||V===re&&(E.x>x.x||E.x===x.x&&PE(x,E)))&&(x=E,re=V)),E=E.next}while(E!==j);return x}(a,s);if(!c)return s;var d=zx(c,a);return ip(d,d.next),ip(c,c.next)}function PE(a,s){return Vo(a.prev,a,s.prev)<0&&Vo(s.next,a,a.next)<0}function Jg(a,s,c,d,m){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-c)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-d)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function Ra(a){var s=a,c=a;do{(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next}while(s!==a);return c}function Xu(a,s,c,d,m,y,x,E){return(m-x)*(s-E)>=(a-x)*(y-E)&&(a-x)*(d-E)>=(c-x)*(s-E)&&(c-x)*(y-E)>=(m-x)*(d-E)}function kE(a,s){return a.next.i!==s.i&&a.prev.i!==s.i&&!function(c,d){var m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==d.i&&m.next.i!==d.i&&Vx(m,m.next,c,d))return!0;m=m.next}while(m!==c);return!1}(a,s)&&(t_(a,s)&&t_(s,a)&&function(c,d){var m=c,y=!1,x=(c.x+d.x)/2,E=(c.y+d.y)/2;do{m.y>E!=m.next.y>E&&m.next.y!==m.y&&x<(m.next.x-m.x)*(E-m.y)/(m.next.y-m.y)+m.x&&(y=!y),m=m.next}while(m!==c);return y}(a,s)&&(Vo(a.prev,a,s.prev)||Vo(a,s.prev,s))||z0(a,s)&&Vo(a.prev,a,a.next)>0&&Vo(s.prev,s,s.next)>0)}function Vo(a,s,c){return(s.y-a.y)*(c.x-s.x)-(s.x-a.x)*(c.y-s.y)}function z0(a,s){return a.x===s.x&&a.y===s.y}function Vx(a,s,c,d){var m=e_(Vo(a,s,c)),y=e_(Vo(a,s,d)),x=e_(Vo(c,d,a)),E=e_(Vo(c,d,s));return m!==y&&x!==E||!(0!==m||!U0(a,c,s))||!(0!==y||!U0(a,d,s))||!(0!==x||!U0(c,a,d))||!(0!==E||!U0(c,s,d))}function U0(a,s,c){return s.x<=Math.max(a.x,c.x)&&s.x>=Math.min(a.x,c.x)&&s.y<=Math.max(a.y,c.y)&&s.y>=Math.min(a.y,c.y)}function e_(a){return a>0?1:a<0?-1:0}function t_(a,s){return Vo(a.prev,a,a.next)<0?Vo(a,s,a.next)>=0&&Vo(a,a.prev,s)>=0:Vo(a,s,a.prev)<0||Vo(a,a.next,s)<0}function zx(a,s){var c=new i_(a.i,a.x,a.y),d=new i_(s.i,s.x,s.y),m=a.next,y=s.prev;return a.next=s,s.prev=a,c.next=m,m.prev=c,d.next=c,c.prev=d,y.next=d,d.prev=y,d}function RE(a,s,c,d){var m=new i_(a,s,c);return d?(m.next=d.next,m.prev=d,d.next.prev=m,d.next=m):(m.prev=m,m.next=m),m}function n_(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function i_(a,s,c){this.i=a,this.x=s,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function r_(a,s,c,d){for(var m=0,y=s,x=c-d;y<c;y+=d)m+=(a[x]-a[y])*(a[y+1]+a[x+1]),x=y;return m}Nx.exports=Xg,Nx.exports.default=Xg,Xg.deviation=function(a,s,c,d){var m=s&&s.length,y=Math.abs(r_(a,0,m?s[0]*c:a.length,c));if(m)for(var x=0,E=s.length;x<E;x++)y-=Math.abs(r_(a,s[x]*c,x<E-1?s[x+1]*c:a.length,c));var T=0;for(x=0;x<d.length;x+=3){var M=d[x]*c,F=d[x+1]*c,B=d[x+2]*c;T+=Math.abs((a[M]-a[B])*(a[F+1]-a[M+1])-(a[M]-a[F])*(a[B+1]-a[M+1]))}return 0===y&&0===T?0:Math.abs((T-y)/y)},Xg.flatten=function(a){for(var s=a[0][0].length,c={vertices:[],holes:[],dimensions:s},d=0,m=0;m<a.length;m++){for(var y=0;y<a[m].length;y++)for(var x=0;x<s;x++)c.vertices.push(a[m][y][x]);m>0&&c.holes.push(d+=a[m-1].length)}return c};var Ux=Je(Nx.exports);function o_(a,s,c,d,m){OE(a,s,c||0,d||a.length-1,m||FE)}function OE(a,s,c,d,m){for(;d>c;){if(d-c>600){var y=d-c+1,x=s-c+1,E=Math.log(y),T=.5*Math.exp(2*E/3),M=.5*Math.sqrt(E*T*(y-T)/y)*(x-y/2<0?-1:1);OE(a,s,Math.max(c,Math.floor(s-x*T/y+M)),Math.min(d,Math.floor(s+(y-x)*T/y+M)),m)}var F=a[s],B=c,V=d;for(s_(a,c,s),m(a[d],F)>0&&s_(a,c,d);B<V;){for(s_(a,B,V),B++,V--;m(a[B],F)<0;)B++;for(;m(a[V],F)>0;)V--}0===m(a[c],F)?s_(a,c,V):s_(a,++V,d),V<=s&&(c=V+1),s<=V&&(d=V-1)}}function s_(a,s,c){var d=a[s];a[s]=a[c],a[c]=d}function FE(a,s){return a<s?-1:a>s?1:0}function j0(a,s){const c=a.length;if(c<=1)return[a];const d=[];let m,y;for(let x=0;x<c;x++){const E=Vr(a[x]);0!==E&&(a[x].area=Math.abs(E),void 0===y&&(y=E<0),y===E<0?(m&&d.push(m),m=[a[x]]):m.push(a[x]))}if(m&&d.push(m),s>1)for(let x=0;x<d.length;x++)d[x].length<=s||(o_(d[x],s,1,d[x].length-1,LE),d[x]=d[x].slice(0,s));return d}function LE(a,s){return s.area-a.area}function Kh(a,s,c){const d=c.patternDependencies;let m=!1;for(const y of s){const x=y.paint.get(`${a}-pattern`);x.isConstant()||(m=!0);const E=x.constantOr(null);E&&(m=!0,d[E]=!0)}return m}function ym(a,s,c,d,m){const y=m.patternDependencies;for(const x of s){const E=x.paint.get(`${a}-pattern`).value;if("constant"!==E.kind){let T=E.evaluate({zoom:d},c,{},m.availableImages);T=T&&T.name?T.name:T,y[T]=!0,c.patterns[x.id]=T}}return c}class a_{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new rn,this.indexArray=new Bn,this.indexArray2=new qt,this.programConfigurations=new Wu(s.layers,s.zoom),this.segments=new io,this.segments2=new io,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=s.projection}populate(s,c,d,m){this.hasPattern=Kh("fill",this.layers,c);const y=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:E,id:T,index:M,sourceLayerIndex:F}of s){const B=this.layers[0]._featureFilter.needGeometry,V=Wh(E,B);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),V,d))continue;const j=y?y.evaluate(V,{},d,c.availableImages):void 0,G={id:T,properties:E.properties,type:E.type,sourceLayerIndex:F,index:M,geometry:B?V.geometry:Gh(E,d,m),patterns:{},sortKey:j};x.push(G)}y&&x.sort((E,T)=>E.sortKey-T.sortKey);for(const E of x){const{geometry:T,index:M,sourceLayerIndex:F}=E;if(this.hasPattern){const B=ym("fill",this.layers,E,this.zoom,c);this.patternFeatures.push(B)}else this.addFeature(E,T,M,d,{},c.availableImages);c.featureIndex.insert(s[M].feature,T,M,F,this.index)}}update(s,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d,m)}addFeatures(s,c,d,m,y){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,d,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,TA),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,c,d,m,y,x=[]){for(const E of j0(c,500)){let T=0;for(const G of E)T+=G.length;const M=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),F=M.vertexLength,B=[],V=[];for(const G of E){if(0===G.length)continue;G!==E[0]&&V.push(B.length/2);const Q=this.segments2.prepareSegment(G.length,this.layoutVertexArray,this.indexArray2),re=Q.vertexLength;this.layoutVertexArray.emplaceBack(G[0].x,G[0].y),this.indexArray2.emplaceBack(re+G.length-1,re),B.push(G[0].x),B.push(G[0].y);for(let X=1;X<G.length;X++)this.layoutVertexArray.emplaceBack(G[X].x,G[X].y),this.indexArray2.emplaceBack(re+X-1,re+X),B.push(G[X].x),B.push(G[X].y);Q.vertexLength+=G.length,Q.primitiveLength+=G.length}const j=Ux(B,V);for(let G=0;G<j.length;G+=3)this.indexArray.emplaceBack(F+j[G],F+j[G+1],F+j[G+2]);M.vertexLength+=T,M.primitiveLength+=j.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,y,x,m)}}Fn(a_,"FillBucket",{omit:["layers","patternFeatures"]});const jx=new Se({"fill-sort-key":new de(Nt.layout_fill["fill-sort-key"])});var $0={paint:new Se({"fill-antialias":new K(Nt.paint_fill["fill-antialias"]),"fill-opacity":new de(Nt.paint_fill["fill-opacity"]),"fill-color":new de(Nt.paint_fill["fill-color"]),"fill-outline-color":new de(Nt.paint_fill["fill-outline-color"]),"fill-translate":new K(Nt.paint_fill["fill-translate"]),"fill-translate-anchor":new K(Nt.paint_fill["fill-translate-anchor"]),"fill-pattern":new de(Nt.paint_fill["fill-pattern"])}),layout:jx};const MA=st([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),PA=st([{name:"a_centroid_pos",components:2,type:"Uint16"}]),kA=st([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:RA}=MA;var H0={},OA=mt,$x=zd;function zd(a,s,c,d,m){this.properties={},this.extent=c,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=m,a.readFields(Hx,this,s)}function Hx(a,s,c){1==a?s.id=c.readVarint():2==a?function(d,m){for(var y=d.readVarint()+d.pos;d.pos<y;){var x=m._keys[d.readVarint()],E=m._values[d.readVarint()];m.properties[x]=E}}(c,s):3==a?s.type=c.readVarint():4==a&&(s._geometry=c.pos)}function Gx(a){for(var s,c,d=0,m=0,y=a.length,x=y-1;m<y;x=m++)d+=((c=a[x]).x-(s=a[m]).x)*(s.y+c.y);return d}zd.types=["Unknown","Point","LineString","Polygon"],zd.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var s,c=a.readVarint()+a.pos,d=1,m=0,y=0,x=0,E=[];a.pos<c;){if(m<=0){var T=a.readVarint();d=7&T,m=T>>3}if(m--,1===d||2===d)y+=a.readSVarint(),x+=a.readSVarint(),1===d&&(s&&E.push(s),s=[]),s.push(new OA(y,x));else{if(7!==d)throw new Error("unknown command "+d);s&&s.push(s[0].clone())}}return s&&E.push(s),E},zd.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var s=a.readVarint()+a.pos,c=1,d=0,m=0,y=0,x=1/0,E=-1/0,T=1/0,M=-1/0;a.pos<s;){if(d<=0){var F=a.readVarint();c=7&F,d=F>>3}if(d--,1===c||2===c)(m+=a.readSVarint())<x&&(x=m),m>E&&(E=m),(y+=a.readSVarint())<T&&(T=y),y>M&&(M=y);else if(7!==c)throw new Error("unknown command "+c)}return[x,T,E,M]},zd.prototype.toGeoJSON=function(a,s,c){var d,m,y=this.extent*Math.pow(2,c),x=this.extent*a,E=this.extent*s,T=this.loadGeometry(),M=zd.types[this.type];function F(j){for(var G=0;G<j.length;G++){var Q=j[G];j[G]=[360*(Q.x+x)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(Q.y+E)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(d=0;d<T.length;d++)B[d]=T[d][0];F(T=B);break;case 2:for(d=0;d<T.length;d++)F(T[d]);break;case 3:for(T=function(j){var G=j.length;if(G<=1)return[j];for(var Q,re,X=[],Ne=0;Ne<G;Ne++){var H=Gx(j[Ne]);0!==H&&(void 0===re&&(re=H<0),re===H<0?(Q&&X.push(Q),Q=[j[Ne]]):Q.push(j[Ne]))}return Q&&X.push(Q),X}(T),d=0;d<T.length;d++)for(m=0;m<T[d].length;m++)F(T[d][m])}1===T.length?T=T[0]:M="Multi"+M;var V={type:"Feature",geometry:{type:M,coordinates:T},properties:this.properties};return"id"in this&&(V.id=this.id),V};var FA=$x,NE=G0;function G0(a,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(BE,this,s),this.length=this._features.length}function BE(a,s,c){15===a?s.version=c.readVarint():1===a?s.name=c.readString():5===a?s.extent=c.readVarint():2===a?s._features.push(c.pos):3===a?s._keys.push(c.readString()):4===a&&s._values.push(function(d){for(var m=null,y=d.readVarint()+d.pos;d.pos<y;){var x=d.readVarint()>>3;m=1===x?d.readString():2===x?d.readFloat():3===x?d.readDouble():4===x?d.readVarint64():5===x?d.readVarint():6===x?d.readSVarint():7===x?d.readBoolean():null}return m}(c))}G0.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var s=this._pbf.readVarint()+this._pbf.pos;return new FA(this._pbf,s,this.extent,this._keys,this._values)};var rp=NE;function VE(a,s,c){if(3===a){var d=new rp(c,c.readVarint()+c.pos);d.length&&(s[d.name]=d)}}var W0=H0.VectorTile=function(a,s){this.layers=a.readFields(VE,{},s)},q0=H0.VectorTileFeature=$x;function Wx(a,s,c,d){const m=[],y=0===d?(x,E,T,M,F,B)=>{x.push(new ze(B,T+(B-E)/(M-E)*(F-T)))}:(x,E,T,M,F,B)=>{x.push(new ze(E+(B-T)/(F-T)*(M-E),B))};for(const x of a){const E=[];for(const T of x){if(T.length<=2)continue;const M=[];for(let V=0;V<T.length-1;V++){const j=T[V].x,G=T[V].y,Q=T[V+1].x,re=T[V+1].y,X=0===d?j:G,Ne=0===d?Q:re;X<s?Ne>s&&y(M,j,G,Q,re,s):X>c?Ne<c&&y(M,j,G,Q,re,c):M.push(T[V]),Ne<s&&X>=s&&y(M,j,G,Q,re,s),Ne>c&&X<=c&&y(M,j,G,Q,re,c)}let F=T[T.length-1];const B=0===d?F.x:F.y;B>=s&&B<=c&&M.push(F),M.length&&(F=M[M.length-1],M[0].x===F.x&&M[0].y===F.y||M.push(M[0]),E.push(M))}E.length&&m.push(E)}return m}H0.VectorTileLayer=NE;const Z0=q0.types,LA=Math.pow(2,13);function vm(a,s,c,d,m,y,x,E){a.emplaceBack((s<<1)+x,(c<<1)+y,(Math.floor(d*LA)<<1)+m,Math.round(E))}function xm(a,s,c){a.emplaceBack(s.x,s.y,s.z,16384*c[0],16384*c[1],16384*c[2])}class qx{constructor(){this.acc=new ze(0,0),this.polyCount=[]}startRing(s){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ze(s.x,s.y),this.max=new ze(s.x,s.y))}append(s,c){this.currentPolyCount.edges++,this.acc._add(s);const d=this.min,m=this.max;s.x<d.x?d.x=s.x:s.x>m.x&&(m.x=s.x),s.y<d.y?d.y=s.y:s.y>m.y&&(m.y=s.y),((0===s.x||s.x===ei)&&s.x===c.x)!=((0===s.y||s.y===ei)&&s.y===c.y)&&this.processBorderOverlap(s,c),c.x<0!=s.x<0&&this.addBorderIntersection(0,tr(c.y,s.y,(0-c.x)/(s.x-c.x))),c.x>ei!=s.x>ei&&this.addBorderIntersection(1,tr(c.y,s.y,(ei-c.x)/(s.x-c.x))),c.y<0!=s.y<0&&this.addBorderIntersection(2,tr(c.x,s.x,(0-c.y)/(s.y-c.y))),c.y>ei!=s.y>ei&&this.addBorderIntersection(3,tr(c.x,s.x,(ei-c.y)/(s.y-c.y)))}addBorderIntersection(s,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[s];c<d[0]&&(d[0]=c),c>d[1]&&(d[1]=c)}processBorderOverlap(s,c){if(s.x===c.x){if(s.y===c.y)return;const d=0===s.x?0:1;this.addBorderIntersection(d,c.y),this.addBorderIntersection(d,s.y)}else{const d=0===s.y?2:3;this.addBorderIntersection(d,c.x),this.addBorderIntersection(d,s.x)}}centroid(){const s=this.polyCount.reduce((c,d)=>c+d.edges,0);return 0!==s?this.acc.div(s)._round():new ze(0,0)}span(){return new ze(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((s,c)=>s+ +(c[0]!==Number.MAX_VALUE),0)}}class op{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.layoutVertexArray=new zt,this.centroidVertexArray=new no,this.indexArray=new Bn,this.programConfigurations=new Wu(s.layers,s.zoom),this.segments=new io,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.enableTerrain=s.enableTerrain}populate(s,c,d,m){this.features=[],this.hasPattern=Kh("fill-extrusion",this.layers,c),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(y){const x=Math.exp(Math.PI*(1-y.y/(1<<y.z)*2));return 80150034*x/(x*x+1)/ei/(1<<y.z)}(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:y,id:x,index:E,sourceLayerIndex:T}of s){const M=this.layers[0]._featureFilter.needGeometry,F=Wh(y,M);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),F,d))continue;const B={id:x,sourceLayerIndex:T,index:E,geometry:M?F.geometry:Gh(y,d,m),properties:y.properties,type:y.type,patterns:{}},V=this.layoutVertexArray.length;this.hasPattern?this.features.push(ym("fill-extrusion",this.layers,B,this.zoom,c)):this.addFeature(B,B.geometry,E,d,{},c.availableImages,m),c.featureIndex.insert(y,B.geometry,E,T,this.index,V)}this.sortBorders()}addFeatures(s,c,d,m,y){for(const x of this.features){const{geometry:E}=x;this.addFeature(x,E,x.index,c,d,m,y)}this.sortBorders()}update(s,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,RA),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,kA.members,!0))),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,PA.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,c,d,m,y,x,E){const T=[new ze(0,0),new ze(ei,ei)],M=E.projection,F="globe"===M.name,B=this.enableTerrain&&!F?new qx:null,V="Polygon"===Z0[s.type];F&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new sn);const j=j0(c,500);for(let X=j.length-1;X>=0;X--){const Ne=j[X];(0===Ne.length||(G=Ne[0]).every(H=>H.x<=0)||G.every(H=>H.x>=ei)||G.every(H=>H.y<=0)||G.every(H=>H.y>=ei))&&j.splice(X,1)}var G;let Q;if(F)Q=X0(j,T,m);else{Q=[];for(const X of j)Q.push({polygon:X,bounds:T})}const re=V?this.edgeRadius:0;for(const{polygon:X,bounds:Ne}of Q){let H=0,Fe=0;for(const We of X)V&&!We[0].equals(We[We.length-1])&&We.push(We[0]),Fe+=V?We.length-1:We.length;const Ze=this.segments.prepareSegment((V?5:4)*Fe,this.layoutVertexArray,this.indexArray);if(V){const We=[],wt=[];H=Ze.vertexLength;for(const Bt of X){let ln,At;Bt.length&&Bt!==X[0]&&wt.push(We.length/2),ln=Bt[1].sub(Bt[0])._perp()._unit();for(let Ht=1;Ht<Bt.length;Ht++){const Gt=Bt[Ht],Qt=Bt[Ht===Bt.length-1?1:Ht+1];let{x:cn,y:Vt}=Gt;if(re){At=Qt.sub(Gt)._perp()._unit();const Cn=ln.add(At)._unit(),Vn=re*Math.min(4,1/(ln.x*Cn.x+ln.y*Cn.y));cn+=Vn*Cn.x,Vt+=Vn*Cn.y,ln=At}vm(this.layoutVertexArray,cn,Vt,0,0,1,1,0),Ze.vertexLength++,We.push(Gt.x,Gt.y),F&&xm(this.layoutVertexExtArray,M.projectTilePoint(cn,Vt,m),M.upVector(m,cn,Vt))}}const yt=Ux(We,wt);for(let Bt=0;Bt<yt.length;Bt+=3)this.indexArray.emplaceBack(H+yt[Bt],H+yt[Bt+2],H+yt[Bt+1]),Ze.primitiveLength++}for(const We of X){B&&We.length&&B.startRing(We[0]);let wt,yt,Bt,ln=We.length>4&&Y0(We[We.length-2],We[0],We[1]),At=re?K0(We[We.length-2],We[0],We[1],re):0;yt=We[1].sub(We[0])._perp()._unit();let Ht=!0;for(let Gt=1,Qt=0;Gt<We.length;Gt++){let cn=We[Gt-1],Vt=We[Gt];const Cn=We[Gt===We.length-1?1:Gt+1];if(B&&V&&B.currentPolyCount.top++,Kx(Vt,cn,Ne)){re&&(yt=Cn.sub(Vt)._perp()._unit(),Ht=!Ht);continue}B&&B.append(Vt,cn);const Vn=Vt.sub(cn)._perp(),An=Vn.x/(Math.abs(Vn.x)+Math.abs(Vn.y)),Pi=Vn.y>0?1:0,mn=cn.dist(Vt);if(Qt+mn>32768&&(Qt=0),re){Bt=Cn.sub(Vt)._perp()._unit();let Di=bm(cn,Vt,Cn,Zx(yt,Bt),re);isNaN(Di)&&(Di=0);const di=Vt.sub(cn)._unit();cn=cn.add(di.mult(At))._round(),Vt=Vt.add(di.mult(-Di))._round(),At=Di,yt=Bt}const ni=Ze.vertexLength,ki=We.length>4&&Y0(cn,Vt,Cn);let cr=l_(Qt,ln,Ht);if(vm(this.layoutVertexArray,cn.x,cn.y,An,Pi,0,0,cr),vm(this.layoutVertexArray,cn.x,cn.y,An,Pi,0,1,cr),Qt+=mn,cr=l_(Qt,ki,!Ht),ln=ki,vm(this.layoutVertexArray,Vt.x,Vt.y,An,Pi,0,0,cr),vm(this.layoutVertexArray,Vt.x,Vt.y,An,Pi,0,1,cr),Ze.vertexLength+=4,this.indexArray.emplaceBack(ni+0,ni+1,ni+2),this.indexArray.emplaceBack(ni+1,ni+3,ni+2),Ze.primitiveLength+=2,re){const Di=H+(1===Gt?We.length-2:Gt-2),di=1===Gt?H:Di+1;if(this.indexArray.emplaceBack(ni+1,Di,ni+3),this.indexArray.emplaceBack(Di,di,ni+3),Ze.primitiveLength+=2,void 0===wt&&(wt=ni),!Kx(Cn,We[Gt],Ne)){const Yr=Gt===We.length-1?wt:Ze.vertexLength;this.indexArray.emplaceBack(ni+2,ni+3,Yr),this.indexArray.emplaceBack(ni+3,Yr+1,Yr),this.indexArray.emplaceBack(ni+3,di,Yr+1),Ze.primitiveLength+=3}Ht=!Ht}if(F){const Di=this.layoutVertexExtArray,di=M.projectTilePoint(cn.x,cn.y,m),Yr=M.projectTilePoint(Vt.x,Vt.y,m),ci=M.upVector(m,cn.x,cn.y),Fi=M.upVector(m,Vt.x,Vt.y);xm(Di,di,ci),xm(Di,di,ci),xm(Di,Yr,Fi),xm(Di,Yr,Fi)}}V&&(H+=We.length-1)}}if(B&&B.polyCount.length>0){if(B.borders){B.vertexArrayOffset=this.centroidVertexArray.length;const X=B.borders,Ne=this.featuresOnBorder.push(B)-1;for(let H=0;H<4;H++)X[H][0]!==Number.MAX_VALUE&&this.borders[H].push(Ne)}this.encodeCentroid(B.borders?void 0:B.centroid(),B)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,y,x,m)}sortBorders(){for(let s=0;s<4;s++)this.borders[s].sort((c,d)=>this.featuresOnBorder[c].borders[s][0]-this.featuresOnBorder[d].borders[s][0])}encodeCentroid(s,c,d=!0){let m,y;if(s)if(0!==s.y){const E=c.span()._mult(this.tileToMeter);m=(Math.max(s.x,1)<<3)+Math.min(7,Math.round(E.x/10)),y=(Math.max(s.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else m=Math.ceil(7*(s.x+450)),y=0;else m=0,y=+d;let x=d?this.centroidVertexArray.length:c.vertexArrayOffset;for(const E of c.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let T=0;T<E.top;T++)this.centroidVertexArray.emplace(x++,m,y);for(let T=0;T<2*E.edges;T++)this.centroidVertexArray.emplace(x++,0,y),this.centroidVertexArray.emplace(x++,m,y)}}}function Zx(a,s){const c=a.add(s)._unit();return a.x*c.x+a.y*c.y}function K0(a,s,c,d){const m=s.sub(a)._perp()._unit(),y=c.sub(s)._perp()._unit();return bm(a,s,c,Zx(m,y),d)}function bm(a,s,c,d,m){const y=Math.sqrt(1-d*d);return Math.min(a.dist(s)/3,s.dist(c)/3,m*y/d)}function Kx(a,s,c){return a.x<c[0].x&&s.x<c[0].x||a.x>c[1].x&&s.x>c[1].x||a.y<c[0].y&&s.y<c[0].y||a.y>c[1].y&&s.y>c[1].y}function Y0(a,s,c){if(a.x<0||a.x>=ei||s.x<0||s.x>=ei||c.x<0||c.x>=ei)return!1;const d=c.sub(s),m=d.perp(),y=a.sub(s);return(d.x*y.x+d.y*y.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(y.x*y.x+y.y*y.y))>-.866&&m.x*y.x+m.y*y.y<0}function l_(a,s,c){const d=s?2|a:-3&a;return c?1|d:-2&d}function Yx(){const a=Math.PI/32,s=Math.tan(a),c=Zg;return c*Math.sqrt(1+2*s*s)-c}function X0(a,s,c){const d=1<<c.z,m=jr(c.x/d),y=jr((c.x+1)/d),x=ta(c.y/d),E=ta((c.y+1)/d);return function(T,M,F,B,V=0,j){const G=[];if(!T.length||!F||!B)return G;const Q=(We,wt)=>{for(const yt of We)G.push({polygon:yt,bounds:wt})},re=Math.ceil(Math.log2(F)),X=Math.ceil(Math.log2(B)),Ne=re-X,H=[];for(let We=0;We<Math.abs(Ne);We++)H.push(Ne>0?0:1);for(let We=0;We<Math.min(re,X);We++)H.push(0),H.push(1);let Fe=T;if(Fe=Wx(Fe,M[0].y-V,M[1].y+V,1),Fe=Wx(Fe,M[0].x-V,M[1].x+V,0),!Fe.length)return G;const Ze=[];for(H.length?Ze.push({polygons:Fe,bounds:M,depth:0}):Q(Fe,M);Ze.length;){const We=Ze.pop(),wt=We.depth,yt=H[wt],Bt=We.bounds[0],ln=We.bounds[1],At=0===yt?Bt.x:Bt.y,Ht=0===yt?ln.x:ln.y,Gt=j?j(yt,At,Ht):.5*(At+Ht),Qt=Wx(We.polygons,At-V,Gt+V,yt),cn=Wx(We.polygons,Gt-V,Ht+V,yt);if(Qt.length){const Vt=[Bt,new ze(0===yt?Gt:ln.x,1===yt?Gt:ln.y)];H.length>wt+1?Ze.push({polygons:Qt,bounds:Vt,depth:wt+1}):Q(Qt,Vt)}if(cn.length){const Vt=[new ze(0===yt?Gt:Bt.x,1===yt?Gt:Bt.y),ln];H.length>wt+1?Ze.push({polygons:cn,bounds:Vt,depth:wt+1}):Q(cn,Vt)}}return G}(a,s,Math.ceil((y-m)/11.25),Math.ceil((x-E)/11.25),1,(T,M,F)=>{if(0===T)return.5*(M+F);{const B=ta((c.y+M/ei)/d);return(ql(.5*(ta((c.y+F/ei)/d)+B))*d-c.y)*ei}})}Fn(op,"FillExtrusionBucket",{omit:["layers","features"]}),Fn(qx,"PartMetadata");const c_=new Se({"fill-extrusion-edge-radius":new K(Nt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var NA={paint:new Se({"fill-extrusion-opacity":new K(Nt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new de(Nt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new K(Nt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new K(Nt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new de(Nt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new de(Nt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new de(Nt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new K(Nt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new K(Nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new K(Nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new K(Nt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:c_};function Xx(a,s,c){var d=2*Math.PI*6378137/256/Math.pow(2,c);return[a*d-2*Math.PI*6378137/2,s*d-2*Math.PI*6378137/2]}class Q0{constructor(s,c,d){this.z=s,this.x=c,this.y=d,this.key=wm(0,s,s,c,d)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,c){const d=(x=this.y,E=this.z,T=Xx(256*(y=this.x),256*(x=Math.pow(2,E)-x-1),E),M=Xx(256*(y+1),256*(x+1),E),T[0]+","+T[1]+","+M[0]+","+M[1]),m=function(y,x,E){let T,M="";for(let F=y;F>0;F--)T=1<<F-1,M+=(x&T?1:0)+(E&T?2:0);return M}(this.z,this.x,this.y);var y,x,E,T,M;return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===c?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zE{constructor(s,c){this.wrap=s,this.canonical=c,this.key=wm(s,c.z,c.z,c.x,c.y)}}class Oa{constructor(s,c,d,m,y){this.overscaledZ=s,this.wrap=c,this.canonical=new Q0(d,+m,+y),this.key=0===c&&s===d?this.canonical.key:wm(c,s,d,m,y)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const c=this.canonical.z-s;return s>this.canonical.z?new Oa(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Oa(s,this.wrap,s,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(s,c=!0){if(this.overscaledZ===s&&c)return this.key;if(s>this.canonical.z)return wm(this.wrap*+c,s,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-s;return wm(this.wrap*+c,s,s,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const c=this.canonical.z-s.canonical.z;return 0===s.overscaledZ||s.overscaledZ<this.overscaledZ&&s.canonical.x===this.canonical.x>>c&&s.canonical.y===this.canonical.y>>c}children(s){if(this.overscaledZ>=s)return[new Oa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,d=2*this.canonical.x,m=2*this.canonical.y;return[new Oa(c,this.wrap,c,d,m),new Oa(c,this.wrap,c,d+1,m),new Oa(c,this.wrap,c,d,m+1),new Oa(c,this.wrap,c,d+1,m+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Oa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Oa(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zE(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function wm(a,s,c,d,m){const y=1<<Math.min(c,22);let x=y*(m%y)+d%y;return a&&c<22&&(x+=y*y*((a<0?-2*a-1:2*a)%(1<<2*(22-c)))),16*(32*x+c)+(s-c)}Fn(Q0,"CanonicalTileID"),Fn(Oa,"OverscaledTileID",{omit:["projMatrix"]});class sp extends ze{constructor(s,c,d){super(s,c),this.z=d}}function Yh(a,s){return a.x*s.x+a.y*s.y}function J0(a,s){if(1===a.length){let c=0;const d=s[c++];let m;for(;!m||d.equals(m);)if(m=s[c++],!m)return 1/0;for(;c<s.length;c++){const y=s[c],x=a[0],E=m.sub(d),T=y.sub(d),M=x.sub(d),F=Yh(E,E),B=Yh(E,T),V=Yh(T,T),j=Yh(M,E),G=Yh(M,T),Q=F*V-B*B,re=(V*j-B*G)/Q,X=(F*G-B*j)/Q,Ne=d.z*(1-re-X)+m.z*re+y.z*X;if(isFinite(Ne))return Ne}return 1/0}{let c=1/0;for(const d of s)c=Math.min(c,d.z);return c}}function ap(a,s,c,d,m,y,x,E){const T=x*m.getElevationAt(a,s,!0,!0),M=0!==y[0],F=M?0===y[1]?x*(y[0]/7-450):x*function(B,V,j){const G=Math.floor(V[0]/8),Q=Math.floor(V[1]/8),re=10*(V[0]-8*G),X=10*(V[1]-8*Q),Ne=B.getElevationAt(G,Q,!0,!0),H=B.getMeterToDEM(j),Fe=Math.floor(.5*(re*H-1)),Ze=Math.floor(.5*(X*H-1)),We=B.tileCoordToPixel(G,Q),wt=2*Fe+1,yt=2*Ze+1,Bt=(Vn=wt,An=yt,[(cn=B).getElevationAtPixel(Vt=We.x-Fe,Cn=We.y-Ze,!0),cn.getElevationAtPixel(Vt+An,Cn,!0),cn.getElevationAtPixel(Vt,Cn+An,!0),cn.getElevationAtPixel(Vt+Vn,Cn+An,!0)]),ln=Math.abs(Bt[0]-Bt[1]),At=Math.abs(Bt[2]-Bt[3]),Ht=Math.abs(Bt[0]-Bt[2])+Math.abs(Bt[1]-Bt[3]),Gt=Math.min(.25,.5*H*(ln+At)/wt),Qt=Math.min(.25,.5*H*Ht/yt);var cn,Vt,Cn,Vn,An;return Ne+Math.max(Gt*re,Qt*X)}(m,y,E):T;return{base:T+(0===c)?-1:c,top:M?Math.max(F+d,T+c+2):T+d}}const BA=st([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:VA}=BA,xF=st([{name:"a_packed",components:4,type:"Float32"}]),{members:zA}=xF,Qx=q0.types,UA=Math.cos(Math.PI/180*37.5);class Ud{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.id),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Dt,this.layoutVertexArray2=new en,this.indexArray=new Bn,this.programConfigurations=new Wu(s.layers,s.zoom),this.segments=new io,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(s,c,d,m){this.hasPattern=Kh("line",this.layers,c);const y=this.layers[0].layout.get("line-sort-key"),x=[];for(const{feature:F,id:B,index:V,sourceLayerIndex:j}of s){const G=this.layers[0]._featureFilter.needGeometry,Q=Wh(F,G);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),Q,d))continue;const re=y?y.evaluate(Q,{},d):void 0,X={id:B,properties:F.properties,type:F.type,sourceLayerIndex:j,index:V,geometry:G?Q.geometry:Gh(F,d,m),patterns:{},sortKey:re};x.push(X)}y&&x.sort((F,B)=>F.sortKey-B.sortKey);const{lineAtlas:E,featureIndex:T}=c,M=this.addConstantDashes(E);for(const F of x){const{geometry:B,index:V,sourceLayerIndex:j}=F;if(M&&this.addFeatureDashes(F,E),this.hasPattern){const G=ym("line",this.layers,F,this.zoom,c);this.patternFeatures.push(G)}else this.addFeature(F,B,V,d,E.positions,c.availableImages);T.insert(s[V].feature,B,V,j,this.index)}}addConstantDashes(s){let c=!1;for(const d of this.layers){const m=d.paint.get("line-dasharray").value,y=d.layout.get("line-cap").value;if("constant"!==m.kind||"constant"!==y.kind)c=!0;else{const x=y.value,E=m.value;if(!E)continue;s.addDash(E,x)}}return c}addFeatureDashes(s,c){const d=this.zoom;for(const m of this.layers){const y=m.paint.get("line-dasharray").value,x=m.layout.get("line-cap").value;if("constant"===y.kind&&"constant"===x.kind)continue;let E,T;if("constant"===y.kind){if(E=y.value,!E)continue}else E=y.evaluate({zoom:d},s);T="constant"===x.kind?x.value:x.evaluate({zoom:d},s),c.addDash(E,T),s.patterns[m.id]=c.getKey(E,T)}}update(s,c,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(s,c,this.stateDependentLayers,d,m)}addFeatures(s,c,d,m,y){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,c,d,m)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,zA)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,VA),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,c,d,m,y,x){const E=this.layers[0].layout,T=E.get("line-join").evaluate(s,{}),M=E.get("line-cap").evaluate(s,{}),F=E.get("line-miter-limit"),B=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(s);for(const V of c)this.addLine(V,s,T,M,F,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,d,y,x,m)}addLine(s,c,d,m,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let X=0;X<s.length-1;X++)this.totalDistance+=s[X].dist(s[X+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E="Polygon"===Qx[c.type];let T=s.length;for(;T>=2&&s[T-1].equals(s[T-2]);)T--;let M=0;for(;M<T-1&&s[M].equals(s[M+1]);)M++;if(T<(E?3:2))return;"bevel"===d&&(y=1.05);const F=this.overscaling<=16?15*ei/(512*this.overscaling):0,B=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let V,j,G,Q,re;this.e1=this.e2=-1,E&&(V=s[T-2],re=s[M].sub(V)._unit()._perp());for(let X=M;X<T;X++){if(G=X===T-1?E?s[M+1]:void 0:s[X+1],G&&s[X].equals(G))continue;re&&(Q=re),V&&(j=V),V=s[X],re=G?G.sub(V)._unit()._perp():Q,Q=Q||re;let Ne=Q.add(re);0===Ne.x&&0===Ne.y||Ne._unit();const H=Q.x*re.x+Q.y*re.y,Fe=Ne.x*re.x+Ne.y*re.y,Ze=0!==Fe?1/Fe:1/0,We=2*Math.sqrt(2-2*Fe),wt=Fe<UA&&j&&G,yt=Q.x*re.y-Q.y*re.x>0;if(wt&&X>M){const At=V.dist(j);if(At>2*F){const Ht=V.sub(V.sub(j)._mult(F/At)._round());this.updateDistance(j,Ht),this.addCurrentVertex(Ht,Q,0,0,B),j=Ht}}const Bt=j&&G;let ln=Bt?d:E?"butt":m;if(Bt&&"round"===ln&&(Ze<x?ln="miter":Ze<=2&&(ln="fakeround")),"miter"===ln&&Ze>y&&(ln="bevel"),"bevel"===ln&&(Ze>2&&(ln="flipbevel"),Ze<y&&(ln="miter")),j&&this.updateDistance(j,V),"miter"===ln)Ne._mult(Ze),this.addCurrentVertex(V,Ne,0,0,B);else if("flipbevel"===ln){if(Ze>100)Ne=re.mult(-1);else{const At=Ze*Q.add(re).mag()/Q.sub(re).mag();Ne._perp()._mult(At*(yt?-1:1))}this.addCurrentVertex(V,Ne,0,0,B),this.addCurrentVertex(V,Ne.mult(-1),0,0,B)}else if("bevel"===ln||"fakeround"===ln){const At=-Math.sqrt(Ze*Ze-1),Ht=yt?At:0,Gt=yt?0:At;if(j&&this.addCurrentVertex(V,Q,Ht,Gt,B),"fakeround"===ln){const Qt=Math.round(180*We/Math.PI/20);for(let cn=1;cn<Qt;cn++){let Vt=cn/Qt;if(.5!==Vt){const Vn=Vt-.5;Vt+=Vt*Vn*(Vt-1)*((1.0904+H*(H*(3.55645-1.43519*H)-3.2452))*Vn*Vn+(.848013+H*(.215638*H-1.06021)))}const Cn=re.sub(Q)._mult(Vt)._add(Q)._unit()._mult(yt?-1:1);this.addHalfVertex(V,Cn.x,Cn.y,!1,yt,0,B)}}G&&this.addCurrentVertex(V,re,-Ht,-Gt,B)}else if("butt"===ln)this.addCurrentVertex(V,Ne,0,0,B);else if("square"===ln){const At=j?1:-1;j||this.addCurrentVertex(V,Ne,At,At,B),this.addCurrentVertex(V,Ne,0,0,B),j&&this.addCurrentVertex(V,Ne,At,At,B)}else"round"===ln&&(j&&(this.addCurrentVertex(V,Q,0,0,B),this.addCurrentVertex(V,Q,1,1,B,!0)),G&&(this.addCurrentVertex(V,re,-1,-1,B,!0),this.addCurrentVertex(V,re,0,0,B)));if(wt&&X<T-1){const At=V.dist(G);if(At>2*F){const Ht=V.add(G.sub(V)._mult(F/At)._round());this.updateDistance(V,Ht),this.addCurrentVertex(Ht,re,0,0,B),V=Ht}}}}addCurrentVertex(s,c,d,m,y,x=!1){const E=c.y*m-c.x,T=-c.y-c.x*m;this.addHalfVertex(s,c.x+c.y*d,c.y-c.x*d,x,!1,d,y),this.addHalfVertex(s,E,T,x,!0,-m,y)}addHalfVertex({x:s,y:c},d,m,y,x,E,T){this.layoutVertexArray.emplaceBack((s<<1)+(y?1:0),(c<<1)+(x?1:0),Math.round(63*d)+128,Math.round(63*m)+128,1+(0===E?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),T.primitiveLength++),x?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const s=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=s*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(s,c){this.distance+=s.dist(c),this.updateScaledDistance()}}Fn(Ud,"LineBucket",{omit:["layers","patternFeatures"]});const ey=new Se({"line-cap":new de(Nt.layout_line["line-cap"]),"line-join":new de(Nt.layout_line["line-join"]),"line-miter-limit":new K(Nt.layout_line["line-miter-limit"]),"line-round-limit":new K(Nt.layout_line["line-round-limit"]),"line-sort-key":new de(Nt.layout_line["line-sort-key"])});var ty={paint:new Se({"line-opacity":new de(Nt.paint_line["line-opacity"]),"line-color":new de(Nt.paint_line["line-color"]),"line-translate":new K(Nt.paint_line["line-translate"]),"line-translate-anchor":new K(Nt.paint_line["line-translate-anchor"]),"line-width":new de(Nt.paint_line["line-width"]),"line-gap-width":new de(Nt.paint_line["line-gap-width"]),"line-offset":new de(Nt.paint_line["line-offset"]),"line-blur":new de(Nt.paint_line["line-blur"]),"line-dasharray":new de(Nt.paint_line["line-dasharray"]),"line-pattern":new de(Nt.paint_line["line-pattern"]),"line-gradient":new Ae(Nt.paint_line["line-gradient"]),"line-trim-offset":new K(Nt.paint_line["line-trim-offset"])}),layout:ey};const Jx=new class extends de{possiblyEvaluate(a,s){return s=new N(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(a,s)}evaluate(a,s,c,d){return s=Pe({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(a,s,c,d)}}(ty.paint.properties["line-width"].specification);function eb(a,s){return s>0?s+2*a:a}Jx.useIntegerZoom=!0;const UE=st([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),lp=st([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),jA=st([{name:"a_projected_pos",components:4,type:"Float32"}],4);st([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const $A=st([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),HA=st([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);st([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const jE=st([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),GA=st([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);st([{name:"triangle",components:3,type:"Uint16"}]),st([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),st([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),st([{type:"Float32",name:"offsetX"}]),st([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var $r=24;const Os=128;function tb(a,s){const{expression:c}=s;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new N(a+1))};if("source"===c.kind)return{kind:"source"};{const{zoomStops:d,interpolationType:m}=c;let y=0;for(;y<d.length&&d[y]<=a;)y++;y=Math.max(0,y-1);let x=y;for(;x<d.length&&d[x]<a+1;)x++;x=Math.min(d.length-1,x);const E=d[y],T=d[x];return"composite"===c.kind?{kind:"composite",minZoom:E,maxZoom:T,interpolationType:m}:{kind:"camera",minZoom:E,maxZoom:T,minSize:c.evaluate(new N(E)),maxSize:c.evaluate(new N(T)),interpolationType:m}}}function ny(a,{uSize:s,uSizeT:c},{lowerSize:d,upperSize:m}){return"source"===a.kind?d/Os:"composite"===a.kind?tr(d/Os,m/Os,c):s}function Em(a,s){let c=0,d=0;if("constant"===a.kind)d=a.layoutSize;else if("source"!==a.kind){const{interpolationType:m,minZoom:y,maxZoom:x}=a,E=m?Rt(Aa.interpolationFactor(m,s,y,x),0,1):0;"camera"===a.kind?d=tr(a.minSize,a.maxSize,E):c=E}return{uSizeT:c,uSize:d}}var WA=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Os,evaluateSizeForFeature:ny,evaluateSizeForZoom:Em,getSizeData:tb});function qA(a,s,c){return a.sections.forEach(d=>{d.text=function(m,y,x){const E=y.layout.get("text-transform").evaluate(x,{});return"uppercase"===E?m=m.toLocaleUpperCase():"lowercase"===E&&(m=m.toLocaleLowerCase()),k.applyArabicShaping&&(m=k.applyArabicShaping(m)),m}(d.text,s,c)}),a}const u_={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function $E(a){return"\ufe36"===a||"\ufe48"===a||"\ufe38"===a||"\ufe44"===a||"\ufe42"===a||"\ufe3e"===a||"\ufe3c"===a||"\ufe3a"===a||"\ufe18"===a||"\ufe40"===a||"\ufe10"===a||"\ufe13"===a||"\ufe14"===a||"\uff40"===a||"\uffe3"===a||"\ufe11"===a||"\ufe12"===a}function ZA(a){return"\ufe35"===a||"\ufe47"===a||"\ufe37"===a||"\ufe43"===a||"\ufe41"===a||"\ufe3d"===a||"\ufe3b"===a||"\ufe39"===a||"\ufe17"===a||"\ufe3f"===a}var HE=Tr,GE=function(a,s,c,d,m){var y,x,E=8*m-d-1,T=(1<<E)-1,M=T>>1,F=-7,B=c?m-1:0,V=c?-1:1,j=a[s+B];for(B+=V,y=j&(1<<-F)-1,j>>=-F,F+=E;F>0;y=256*y+a[s+B],B+=V,F-=8);for(x=y&(1<<-F)-1,y>>=-F,F+=d;F>0;x=256*x+a[s+B],B+=V,F-=8);if(0===y)y=1-M;else{if(y===T)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,d),y-=M}return(j?-1:1)*x*Math.pow(2,y-d)},WE=function(a,s,c,d,m,y){var x,E,T,M=8*y-m-1,F=(1<<M)-1,B=F>>1,V=23===m?Math.pow(2,-24)-Math.pow(2,-77):0,j=d?0:y-1,G=d?1:-1,Q=s<0||0===s&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(E=isNaN(s)?1:0,x=F):(x=Math.floor(Math.log(s)/Math.LN2),s*(T=Math.pow(2,-x))<1&&(x--,T*=2),(s+=x+B>=1?V/T:V*Math.pow(2,1-B))*T>=2&&(x++,T/=2),x+B>=F?(E=0,x=F):x+B>=1?(E=(s*T-1)*Math.pow(2,m),x+=B):(E=s*Math.pow(2,B-1)*Math.pow(2,m),x=0));m>=8;a[c+j]=255&E,j+=G,E/=256,m-=8);for(x=x<<m|E,M+=m;M>0;a[c+j]=255&x,j+=G,x/=256,M-=8);a[c+j-G]|=128*Q};function Tr(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Tr.Varint=0,Tr.Fixed64=1,Tr.Bytes=2,Tr.Fixed32=5;var au=4294967296,Cm=1/au,nb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Qu(a){return a.type===Tr.Bytes?a.readVarint()+a.pos:a.pos+1}function KA(a,s,c){var d=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));c.realloc(d);for(var m=c.pos-1;m>=a;m--)c.buf[m+d]=c.buf[m]}function bF(a,s){for(var c=0;c<a.length;c++)s.writeVarint(a[c])}function wF(a,s){for(var c=0;c<a.length;c++)s.writeSVarint(a[c])}function ib(a,s){for(var c=0;c<a.length;c++)s.writeFloat(a[c])}function rb(a,s){for(var c=0;c<a.length;c++)s.writeDouble(a[c])}function EF(a,s){for(var c=0;c<a.length;c++)s.writeBoolean(a[c])}function CF(a,s){for(var c=0;c<a.length;c++)s.writeFixed32(a[c])}function qE(a,s){for(var c=0;c<a.length;c++)s.writeSFixed32(a[c])}function YA(a,s){for(var c=0;c<a.length;c++)s.writeFixed64(a[c])}function XA(a,s){for(var c=0;c<a.length;c++)s.writeSFixed64(a[c])}function iy(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+16777216*a[s+3]}function Im(a,s,c){a[c]=s,a[c+1]=s>>>8,a[c+2]=s>>>16,a[c+3]=s>>>24}function ob(a,s){return(a[s]|a[s+1]<<8|a[s+2]<<16)+(a[s+3]<<24)}Tr.prototype={destroy:function(){this.buf=null},readFields:function(a,s,c){for(c=c||this.length;this.pos<c;){var d=this.readVarint(),m=d>>3,y=this.pos;this.type=7&d,a(m,s,this),this.pos===y&&this.skip(d)}return s},readMessage:function(a,s){return this.readFields(a,s,this.readVarint()+this.pos)},readFixed32:function(){var a=iy(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=ob(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=iy(this.buf,this.pos)+iy(this.buf,this.pos+4)*au;return this.pos+=8,a},readSFixed64:function(){var a=iy(this.buf,this.pos)+ob(this.buf,this.pos+4)*au;return this.pos+=8,a},readFloat:function(){var a=GE(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=GE(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var s,c,d=this.buf;return s=127&(c=d[this.pos++]),c<128?s:(s|=(127&(c=d[this.pos++]))<<7,c<128?s:(s|=(127&(c=d[this.pos++]))<<14,c<128?s:(s|=(127&(c=d[this.pos++]))<<21,c<128?s:function(m,y,x){var E,T,M=x.buf;if(E=(112&(T=M[x.pos++]))>>4,T<128||(E|=(127&(T=M[x.pos++]))<<3,T<128)||(E|=(127&(T=M[x.pos++]))<<10,T<128)||(E|=(127&(T=M[x.pos++]))<<17,T<128)||(E|=(127&(T=M[x.pos++]))<<24,T<128)||(E|=(1&(T=M[x.pos++]))<<31,T<128))return function cp(a,s,c){return c?4294967296*s+(a>>>0):4294967296*(s>>>0)+(a>>>0)}(m,E,y);throw new Error("Expected varint not more than 10 bytes")}(s|=(15&(c=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,s=this.pos;return this.pos=a,a-s>=12&&nb?nb.decode(this.buf.subarray(s,a)):function(c,d,m){for(var y="",x=d;x<m;){var E,T,M,F=c[x],B=null,V=F>239?4:F>223?3:F>191?2:1;if(x+V>m)break;1===V?F<128&&(B=F):2===V?128==(192&(E=c[x+1]))&&(B=(31&F)<<6|63&E)<=127&&(B=null):3===V?(T=c[x+2],128==(192&(E=c[x+1]))&&128==(192&T)&&((B=(15&F)<<12|(63&E)<<6|63&T)<=2047||B>=55296&&B<=57343)&&(B=null)):4===V&&(T=c[x+2],M=c[x+3],128==(192&(E=c[x+1]))&&128==(192&T)&&128==(192&M)&&((B=(15&F)<<18|(63&E)<<12|(63&T)<<6|63&M)<=65535||B>=1114112)&&(B=null)),null===B?(B=65533,V=1):B>65535&&(B-=65536,y+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),y+=String.fromCharCode(B),x+=V}return y}(this.buf,s,a)},readBytes:function(){var a=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,a);return this.pos=a,s},readPackedVarint:function(a,s){if(this.type!==Tr.Bytes)return a.push(this.readVarint(s));var c=Qu(this);for(a=a||[];this.pos<c;)a.push(this.readVarint(s));return a},readPackedSVarint:function(a){if(this.type!==Tr.Bytes)return a.push(this.readSVarint());var s=Qu(this);for(a=a||[];this.pos<s;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Tr.Bytes)return a.push(this.readBoolean());var s=Qu(this);for(a=a||[];this.pos<s;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Tr.Bytes)return a.push(this.readFloat());var s=Qu(this);for(a=a||[];this.pos<s;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Tr.Bytes)return a.push(this.readDouble());var s=Qu(this);for(a=a||[];this.pos<s;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Tr.Bytes)return a.push(this.readFixed32());var s=Qu(this);for(a=a||[];this.pos<s;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Tr.Bytes)return a.push(this.readSFixed32());var s=Qu(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Tr.Bytes)return a.push(this.readFixed64());var s=Qu(this);for(a=a||[];this.pos<s;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Tr.Bytes)return a.push(this.readSFixed64());var s=Qu(this);for(a=a||[];this.pos<s;)a.push(this.readSFixed64());return a},skip:function(a){var s=7&a;if(s===Tr.Varint)for(;this.buf[this.pos++]>127;);else if(s===Tr.Bytes)this.pos=this.readVarint()+this.pos;else if(s===Tr.Fixed32)this.pos+=4;else{if(s!==Tr.Fixed64)throw new Error("Unimplemented type: "+s);this.pos+=8}},writeTag:function(a,s){this.writeVarint(a<<3|s)},realloc:function(a){for(var s=this.length||16;s<this.pos+a;)s*=2;if(s!==this.length){var c=new Uint8Array(s);c.set(this.buf),this.buf=c,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Im(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Im(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Im(this.buf,-1&a,this.pos),Im(this.buf,Math.floor(a*Cm),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Im(this.buf,-1&a,this.pos),Im(this.buf,Math.floor(a*Cm),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(s,c){var d,m,y,E;if(s>=0?(d=s%4294967296|0,m=s/4294967296|0):(m=~(-s/4294967296),4294967295^(d=~(-s%4294967296))?d=d+1|0:(d=0,m=m+1|0)),s>=0x10000000000000000||s<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),y=d,(E=c).buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,E.buf[E.pos]=127&(y>>>=7),function(y,x){var E=(7&y)<<4;x.buf[x.pos++]|=E|((y>>>=3)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y)))))}(m,c)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var s=this.pos;this.pos=function(d,m,y){for(var x,E,T=0;T<m.length;T++){if((x=m.charCodeAt(T))>55295&&x<57344){if(!E){x>56319||T+1===m.length?(d[y++]=239,d[y++]=191,d[y++]=189):E=x;continue}if(x<56320){d[y++]=239,d[y++]=191,d[y++]=189,E=x;continue}x=E-55296<<10|x-56320|65536,E=null}else E&&(d[y++]=239,d[y++]=191,d[y++]=189,E=null);x<128?d[y++]=x:(x<2048?d[y++]=x>>6|192:(x<65536?d[y++]=x>>12|224:(d[y++]=x>>18|240,d[y++]=x>>12&63|128),d[y++]=x>>6&63|128),d[y++]=63&x|128)}return y}(this.buf,a,this.pos);var c=this.pos-s;c>=128&&KA(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeFloat:function(a){this.realloc(4),WE(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),WE(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var s=a.length;this.writeVarint(s),this.realloc(s);for(var c=0;c<s;c++)this.buf[this.pos++]=a[c]},writeRawMessage:function(a,s){this.pos++;var c=this.pos;a(s,this);var d=this.pos-c;d>=128&&KA(c,d,this),this.pos=c-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,s,c){this.writeTag(a,Tr.Bytes),this.writeRawMessage(s,c)},writePackedVarint:function(a,s){s.length&&this.writeMessage(a,bF,s)},writePackedSVarint:function(a,s){s.length&&this.writeMessage(a,wF,s)},writePackedBoolean:function(a,s){s.length&&this.writeMessage(a,EF,s)},writePackedFloat:function(a,s){s.length&&this.writeMessage(a,ib,s)},writePackedDouble:function(a,s){s.length&&this.writeMessage(a,rb,s)},writePackedFixed32:function(a,s){s.length&&this.writeMessage(a,CF,s)},writePackedSFixed32:function(a,s){s.length&&this.writeMessage(a,qE,s)},writePackedFixed64:function(a,s){s.length&&this.writeMessage(a,YA,s)},writePackedSFixed64:function(a,s){s.length&&this.writeMessage(a,XA,s)},writeBytesField:function(a,s){this.writeTag(a,Tr.Bytes),this.writeBytes(s)},writeFixed32Field:function(a,s){this.writeTag(a,Tr.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(a,s){this.writeTag(a,Tr.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(a,s){this.writeTag(a,Tr.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(a,s){this.writeTag(a,Tr.Fixed64),this.writeSFixed64(s)},writeVarintField:function(a,s){this.writeTag(a,Tr.Varint),this.writeVarint(s)},writeSVarintField:function(a,s){this.writeTag(a,Tr.Varint),this.writeSVarint(s)},writeStringField:function(a,s){this.writeTag(a,Tr.Bytes),this.writeString(s)},writeFloatField:function(a,s){this.writeTag(a,Tr.Fixed32),this.writeFloat(s)},writeDoubleField:function(a,s){this.writeTag(a,Tr.Fixed64),this.writeDouble(s)},writeBooleanField:function(a,s){this.writeVarintField(a,!!s)}};var up=Je(HE);const ry=3;function sb(a,s,c){s.glyphs=[],1===a&&c.readMessage(QA,s)}function QA(a,s,c){if(3===a){const{id:d,bitmap:m,width:y,height:x,left:E,top:T,advance:M}=c.readMessage(va,{});s.glyphs.push({id:d,bitmap:new Yu({width:y+2*ry,height:x+2*ry},m),metrics:{width:y,height:x,left:E,top:T,advance:M}})}else 4===a?s.ascender=c.readSVarint():5===a&&(s.descender=c.readSVarint())}function va(a,s,c){1===a?s.id=c.readVarint():2===a?s.bitmap=c.readBytes():3===a?s.width=c.readVarint():4===a?s.height=c.readVarint():5===a?s.left=c.readSVarint():6===a?s.top=c.readSVarint():7===a&&(s.advance=c.readVarint())}const ZE=ry;function ab(a){let s=0,c=0;for(const x of a)s+=x.w*x.h,c=Math.max(c,x.w);a.sort((x,E)=>E.h-x.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}];let m=0,y=0;for(const x of a)for(let E=d.length-1;E>=0;E--){const T=d[E];if(!(x.w>T.w||x.h>T.h)){if(x.x=T.x,x.y=T.y,y=Math.max(y,x.y+x.h),m=Math.max(m,x.x+x.w),x.w===T.w&&x.h===T.h){const M=d.pop();E<d.length&&(d[E]=M)}else x.h===T.h?(T.x+=x.w,T.w-=x.w):x.w===T.w?(T.y+=x.h,T.h-=x.h):(d.push({x:T.x+x.w,y:T.y,w:T.w-x.w,h:x.h}),T.y+=x.h,T.h-=x.h);break}}return{w:m,h:y,fill:s/(m*y)||0}}const ia=1;class oy{constructor(s,{pixelRatio:c,version:d,stretchX:m,stretchY:y,content:x}){this.paddedRect=s,this.pixelRatio=c,this.stretchX=m,this.stretchY=y,this.content=x,this.version=d}get tl(){return[this.paddedRect.x+ia,this.paddedRect.y+ia]}get br(){return[this.paddedRect.x+this.paddedRect.w-ia,this.paddedRect.y+this.paddedRect.h-ia]}get displaySize(){return[(this.paddedRect.w-2*ia)/this.pixelRatio,(this.paddedRect.h-2*ia)/this.pixelRatio]}}class KE{constructor(s,c){const d={},m={};this.haveRenderCallbacks=[];const y=[];this.addImages(s,d,y),this.addImages(c,m,y);const{w:x,h:E}=ab(y),T=new nl({width:x||1,height:E||1});for(const M in s){const F=s[M],B=d[M].paddedRect;nl.copy(F.data,T,{x:0,y:0},{x:B.x+ia,y:B.y+ia},F.data)}for(const M in c){const F=c[M],B=m[M].paddedRect,V=B.x+ia,j=B.y+ia,G=F.data.width,Q=F.data.height;nl.copy(F.data,T,{x:0,y:0},{x:V,y:j},F.data),nl.copy(F.data,T,{x:0,y:Q-1},{x:V,y:j-1},{width:G,height:1}),nl.copy(F.data,T,{x:0,y:0},{x:V,y:j+Q},{width:G,height:1}),nl.copy(F.data,T,{x:G-1,y:0},{x:V-1,y:j},{width:1,height:Q}),nl.copy(F.data,T,{x:0,y:0},{x:V+G,y:j},{width:1,height:Q})}this.image=T,this.iconPositions=d,this.patternPositions=m}addImages(s,c,d){for(const m in s){const y=s[m],x={x:0,y:0,w:y.data.width+2*ia,h:y.data.height+2*ia};d.push(x),c[m]=new oy(x,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(s,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>s.hasImage(d)),s.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in s.updatedImages)this.patchUpdatedImage(this.iconPositions[d],s.getImage(d),c),this.patchUpdatedImage(this.patternPositions[d],s.getImage(d),c)}patchUpdatedImage(s,c,d){if(!s||!c||s.version===c.version)return;s.version=c.version;const[m,y]=s.tl;d.update(c.data,void 0,{x:m,y})}}Fn(oy,"ImagePosition"),Fn(KE,"ImageAtlas");const Zl={horizontal:1,vertical:2,horizontalOnly:3},YE=-17;class d_{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(s,c){const d=new d_;return d.scale=s||1,d.fontStack=c,d}static forImage(s){const c=new d_;return c.imageName=s,c}}class dp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,c){const d=new dp;for(let m=0;m<s.sections.length;m++){const y=s.sections[m];y.image?d.addImageSection(y):d.addTextSection(y,c)}return d}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCharCode(s){return this.text.charCodeAt(s)}verticalizePunctuation(s){this.text=function(c,d){let m="";for(let y=0;y<c.length;y++){const x=c.charCodeAt(y+1)||null,E=c.charCodeAt(y-1)||null;m+=!d&&(x&&Ng(x)&&!u_[c[y+1]]||E&&Ng(E)&&!u_[c[y-1]])||!u_[c[y]]?c[y]:u_[c[y]]}return m}(this.text,s)}trim(){let s=0;for(let d=0;d<this.text.length&&lb[this.text.charCodeAt(d)];d++)s++;let c=this.text.length;for(let d=this.text.length-1;d>=0&&d>=s&&lb[this.text.charCodeAt(d)];d--)c--;this.text=this.text.substring(s,c),this.sectionIndex=this.sectionIndex.slice(s,c)}substring(s,c){const d=new dp;return d.text=this.text.substring(s,c),d.sectionIndex=this.sectionIndex.slice(s,c),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,c)=>Math.max(s,this.sections[c].scale),0)}addTextSection(s,c){this.text+=s.text,this.sections.push(d_.forText(s.scale,s.fontStack||c));const d=this.sections.length-1;for(let m=0;m<s.text.length;++m)this.sectionIndex.push(d)}addImageSection(s){const c=s.image?s.image.name:"";if(0===c.length)return void ti("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(d_.forImage(c)),this.sectionIndex.push(this.sections.length-1)):ti("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function XE(a,s,c,d,m,y,x,E,T,M,F,B,V,j,G){const Q=dp.fromFeature(a,m);B===Zl.vertical&&Q.verticalizePunctuation(V);let re=[];const X=function(We,wt,yt,Bt,ln,At){if(!We)return[];const Ht=[],Gt=function(Cn,Vn,An,Pi,mn,ni){let ki=0;for(let cr=0;cr<Cn.length();cr++){const Di=Cn.getSection(cr);ki+=Xt(Cn.getCharCode(cr),Di,Pi,mn,Vn,ni)}return ki/Math.max(1,Math.ceil(ki/An))}(We,wt,yt,Bt,ln,At),Qt=We.text.indexOf("\u200b")>=0;let cn=0;for(let Cn=0;Cn<We.length();Cn++){const Vn=We.getSection(Cn),An=We.getCharCode(Cn);if(lb[An]||(cn+=Xt(An,Vn,Bt,ln,wt,At)),Cn<We.length()-1){const Pi=!((Vt=An)<11904||!(Sn["Bopomofo Extended"](Vt)||Sn.Bopomofo(Vt)||Sn["CJK Compatibility Forms"](Vt)||Sn["CJK Compatibility Ideographs"](Vt)||Sn["CJK Compatibility"](Vt)||Sn["CJK Radicals Supplement"](Vt)||Sn["CJK Strokes"](Vt)||Sn["CJK Symbols and Punctuation"](Vt)||Sn["CJK Unified Ideographs Extension A"](Vt)||Sn["CJK Unified Ideographs"](Vt)||Sn["Enclosed CJK Letters and Months"](Vt)||Sn["Halfwidth and Fullwidth Forms"](Vt)||Sn.Hiragana(Vt)||Sn["Ideographic Description Characters"](Vt)||Sn["Kangxi Radicals"](Vt)||Sn["Katakana Phonetic Extensions"](Vt)||Sn.Katakana(Vt)||Sn["Vertical Forms"](Vt)||Sn["Yi Radicals"](Vt)||Sn["Yi Syllables"](Vt)));(h_[An]||Pi||Vn.imageName)&&Ht.push(cb(Cn+1,cn,Gt,Ht,QE(An,We.getCharCode(Cn+1),Pi&&Qt),!1))}}var Vt;return sy(cb(We.length(),cn,Gt,Ht,0,!0))}(Q,M,y,s,d,j),{processBidirectionalText:Ne,processStyledBidirectionalText:H}=k;if(Ne&&1===Q.sections.length){const We=Ne(Q.toString(),X);for(const wt of We){const yt=new dp;yt.text=wt,yt.sections=Q.sections;for(let Bt=0;Bt<wt.length;Bt++)yt.sectionIndex.push(0);re.push(yt)}}else if(H){const We=H(Q.text,Q.sectionIndex,X);for(const wt of We){const yt=new dp;yt.text=wt[0],yt.sectionIndex=wt[1],yt.sections=Q.sections,re.push(yt)}}else re=function(We,wt){const yt=[],Bt=We.text;let ln=0;for(const At of wt)yt.push(We.substring(ln,At)),ln=At;return ln<Bt.length&&yt.push(We.substring(ln,Bt.length)),yt}(Q,X);const Fe=[],Ze={positionedLines:Fe,text:Q.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:B,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(We,wt,yt,Bt,ln,At,Ht,Gt,Qt,cn,Vt,Cn){let Vn=0,An=0,Pi=0;const mn="right"===Gt?1:"left"===Gt?0:.5;let ni=!1;for(const ci of ln){const Fi=ci.getSections();for(const Lr of Fi){if(Lr.imageName)continue;const Xr=wt[Lr.fontStack];if(Xr&&(ni=void 0!==Xr.ascender&&void 0!==Xr.descender,!ni))break}if(!ni)break}let ki=0;for(const ci of ln){ci.trim();const Fi=ci.getMaxScale(),Lr=(Fi-1)*$r,Xr={positionedGlyphs:[],lineOffset:0};We.positionedLines[ki]=Xr;const Pr=Xr.positionedGlyphs;let kr=0;if(!ci.length()){An+=At,++ki;continue}let _o=0,ko=0;for(let Rr=0;Rr<ci.length();Rr++){const gs=ci.getSection(Rr),Ko=ci.getSectionIndex(Rr),uo=ci.getCharCode(Rr);let _r=gs.scale,Yo=null,Gr=null,Fa=null,Xo=$r,ho=0;const _s=!(Qt===Zl.horizontal||!Vt&&!Ld(uo)||Vt&&(lb[uo]||(cr=uo,Sn.Arabic(cr)||Sn["Arabic Supplement"](cr)||Sn["Arabic Extended-A"](cr)||Sn["Arabic Presentation Forms-A"](cr)||Sn["Arabic Presentation Forms-B"](cr))));if(gs.imageName){const La=Bt[gs.imageName];if(!La)continue;Fa=gs.imageName,We.iconsInText=We.iconsInText||!0,Gr=La.paddedRect;const Cs=La.displaySize;_r=_r*$r/Cn,Yo={width:Cs[0],height:Cs[1],left:ia,top:-ZE,advance:_s?Cs[1]:Cs[0],localGlyph:!1},ho=ni?-Yo.height*_r:YE+Fi*$r-Cs[1]*_r,Xo=Yo.advance;const hu=(_s?Cs[0]:Cs[1])*_r-$r*Fi;hu>0&&hu>kr&&(kr=hu)}else{const La=yt[gs.fontStack];if(!La)continue;La[uo]&&(Gr=La[uo]);const Cs=wt[gs.fontStack];if(!Cs)continue;const hu=Cs.glyphs[uo];if(!hu)continue;if(Yo=hu.metrics,Xo=8203!==uo?$r:0,ni){const bp=void 0!==Cs.ascender?Math.abs(Cs.ascender):0,Lm=void 0!==Cs.descender?Math.abs(Cs.descender):0,af=(bp+Lm)*_r;_o<af&&(_o=af,ko=(bp-Lm)/2*_r),ho=-bp*_r}else ho=YE+(Fi-_r)*$r}_s?(We.verticalizable=!0,Pr.push({glyph:uo,imageName:Fa,x:Vn,y:An+ho,vertical:_s,scale:_r,localGlyph:Yo.localGlyph,fontStack:gs.fontStack,sectionIndex:Ko,metrics:Yo,rect:Gr}),Vn+=Xo*_r+cn):(Pr.push({glyph:uo,imageName:Fa,x:Vn,y:An+ho,vertical:_s,scale:_r,localGlyph:Yo.localGlyph,fontStack:gs.fontStack,sectionIndex:Ko,metrics:Yo,rect:Gr}),Vn+=Yo.advance*_r+cn)}0!==Pr.length&&(Pi=Math.max(Vn-cn,Pi),ni?JE(Pr,mn,kr,ko,At*Fi/2):JE(Pr,mn,kr,0,At/2)),Vn=0;const Zo=At*Fi+kr;Xr.lineOffset=Math.max(kr,Lr),An+=Zo,++ki}var cr;const Di=An,{horizontalAlign:di,verticalAlign:Yr}=f_(Ht);(function(ci,Fi,Lr,Xr,Pr,kr){const _o=(Fi-Lr)*Pr,ko=-kr*Xr;for(const Zo of ci)for(const Rr of Zo.positionedGlyphs)Rr.x+=_o,Rr.y+=ko})(We.positionedLines,mn,di,Yr,Pi,Di),We.top+=-Yr*Di,We.bottom=We.top+Di,We.left+=-di*Pi,We.right=We.left+Pi,We.hasBaseline=ni}(Ze,s,c,d,re,x,E,T,B,M,V,G),!function(We){for(const wt of We)if(0!==wt.positionedGlyphs.length)return!1;return!0}(Fe)&&Ze}const lb={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},h_={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Xt(a,s,c,d,m,y){if(s.imageName){const x=d[s.imageName];return x?x.displaySize[0]*s.scale*$r/y+m:0}{const x=c[s.fontStack],E=x&&x.glyphs[a];return E?E.metrics.advance*s.scale+m:0}}function Tm(a,s,c,d){const m=Math.pow(a-s,2);return d?a<s?m/2:2*m:m+Math.abs(c)*c}function QE(a,s,c){let d=0;return 10===a&&(d-=1e4),c&&(d+=150),40!==a&&65288!==a||(d+=50),41!==s&&65289!==s||(d+=50),d}function cb(a,s,c,d,m,y){let x=null,E=Tm(s,c,m,y);for(const T of d){const M=Tm(s-T.x,c,m,y)+T.badness;M<=E&&(x=T,E=M)}return{index:a,x:s,priorBreak:x,badness:E}}function sy(a){return a?sy(a.priorBreak).concat(a.index):[]}function f_(a){let s=.5,c=.5;switch(a){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function JE(a,s,c,d,m){if(!(s||c||d||m))return;const y=a.length-1,x=a[y],E=(x.x+x.metrics.advance*x.scale)*s;for(let T=0;T<=y;T++)a[T].x-=E,a[T].y+=c+d+m}function eC(a,s,c){const{horizontalAlign:d,verticalAlign:m}=f_(c),y=s[0]-a.displaySize[0]*d,x=s[1]-a.displaySize[1]*m;return{image:a,top:x,bottom:x+a.displaySize[1],left:y,right:y+a.displaySize[0]}}function ub(a,s,c,d,m,y){const x=a.image;let E;if(x.content){const re=x.content,X=x.pixelRatio||1;E=[re[0]/X,re[1]/X,x.displaySize[0]-re[2]/X,x.displaySize[1]-re[3]/X]}const T=s.left*y,M=s.right*y;let F,B,V,j;"width"===c||"both"===c?(j=m[0]+T-d[3],B=m[0]+M+d[1]):(j=m[0]+(T+M-x.displaySize[0])/2,B=j+x.displaySize[0]);const G=s.top*y,Q=s.bottom*y;return"height"===c||"both"===c?(F=m[1]+G-d[0],V=m[1]+Q+d[2]):(F=m[1]+(G+Q-x.displaySize[1])/2,V=F+x.displaySize[1]),{image:x,top:F,right:B,bottom:V,left:j,collisionPadding:E}}class Sc extends ze{constructor(s,c,d,m,y){super(s,c),this.angle=m,this.z=d,void 0!==y&&(this.segment=y)}clone(){return new Sc(this.x,this.y,this.z,this.angle,this.segment)}}function JA(a,s,c,d,m){if(void 0===s.segment)return!0;let y=s,x=s.segment+1,E=0;for(;E>-c/2;){if(x--,x<0)return!1;E-=a[x].dist(y),y=a[x]}E+=a[x].dist(a[x+1]),x++;const T=[];let M=0;for(;E<c/2;){const F=a[x],B=a[x+1];if(!B)return!1;let V=a[x-1].angleTo(F)-F.angleTo(B);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:E,angleDelta:V}),M+=V;E-T[0].distance>d;)M-=T.shift().angleDelta;if(M>m)return!1;x++,E+=F.dist(B)}return!0}function ay(a){let s=0;for(let c=0;c<a.length-1;c++)s+=a[c].dist(a[c+1]);return s}function tC(a,s,c){return a?.6*s*c:0}function ly(a,s){return Math.max(a?a.right-a.left:0,s?s.right-s.left:0)}function nC(a,s,c,d,m,y){const x=tC(c,m,y),E=ly(c,d)*y;let T=0;const M=ay(a)/2;for(let F=0;F<a.length-1;F++){const B=a[F],V=a[F+1],j=B.dist(V);if(T+j>M){const G=(M-T)/j,Q=tr(B.x,V.x,G),re=tr(B.y,V.y,G),X=new Sc(Q,re,0,V.angleTo(B),F);return!x||JA(a,X,E,x,s)?X:void 0}T+=j}}function iC(a,s,c,d,m,y,x,E,T){const M=tC(d,y,x),F=ly(d,m),B=F*x,V=0===a[0].x||a[0].x===T||0===a[0].y||a[0].y===T;return s-B<s/4&&(s=B+s/4),Xh(a,V?s/2*E%s:(F/2+2*y)*x*E%s,s,M,c,B,V,!1,T)}function Xh(a,s,c,d,m,y,x,E,T){const M=y/2,F=ay(a);let B=0,V=s-c,j=[];for(let G=0;G<a.length-1;G++){const Q=a[G],re=a[G+1],X=Q.dist(re),Ne=re.angleTo(Q);for(;V+c<B+X;){V+=c;const H=(V-B)/X,Fe=tr(Q.x,re.x,H),Ze=tr(Q.y,re.y,H);if(Fe>=0&&Fe<T&&Ze>=0&&Ze<T&&V-M>=0&&V+M<=F){const We=new Sc(Fe,Ze,0,Ne,G);We._round(),d&&!JA(a,We,y,d,m)||j.push(We)}}B+=X}return E||j.length||x||(j=Xh(a,B/2,c,d,m,y,x,!0,T)),j}function rC(a,s,c,d,m){const y=[];for(let x=0;x<a.length;x++){const E=a[x];let T;for(let M=0;M<E.length-1;M++){let F=E[M],B=E[M+1];F.x<s&&B.x<s||(F.x<s?F=new ze(s,F.y+(s-F.x)/(B.x-F.x)*(B.y-F.y))._round():B.x<s&&(B=new ze(s,F.y+(s-F.x)/(B.x-F.x)*(B.y-F.y))._round()),F.y<c&&B.y<c||(F.y<c?F=new ze(F.x+(c-F.y)/(B.y-F.y)*(B.x-F.x),c)._round():B.y<c&&(B=new ze(F.x+(c-F.y)/(B.y-F.y)*(B.x-F.x),c)._round()),F.x>=d&&B.x>=d||(F.x>=d?F=new ze(d,F.y+(d-F.x)/(B.x-F.x)*(B.y-F.y))._round():B.x>=d&&(B=new ze(d,F.y+(d-F.x)/(B.x-F.x)*(B.y-F.y))._round()),F.y>=m&&B.y>=m||(F.y>=m?F=new ze(F.x+(m-F.y)/(B.y-F.y)*(B.x-F.x),m)._round():B.y>=m&&(B=new ze(F.x+(m-F.y)/(B.y-F.y)*(B.x-F.x),m)._round()),T&&F.equals(T[T.length-1])||(T=[F],y.push(T)),T.push(B)))))}}return y}Fn(Sc,"Anchor");const hp=1e20;function p_(a,s,c,d,m,y,x,E,T){for(let M=s;M<s+d;M++)oC(a,c*y+M,y,m,x,E,T);for(let M=c;M<c+m;M++)oC(a,M*y+s,1,d,x,E,T)}function oC(a,s,c,d,m,y,x){y[0]=0,x[0]=-hp,x[1]=hp,m[0]=a[s];for(let E=1,T=0,M=0;E<d;E++){m[E]=a[s+E*c];const F=E*E;do{const B=y[T];M=(m[E]-m[B]+F-B*B)/(E-B)/2}while(M<=x[T]&&--T>-1);T++,y[T]=E,x[T]=M,x[T+1]=hp}for(let E=0,T=0;E<d;E++){for(;x[T+1]<E;)T++;const M=y[T],F=E-M;a[s+E*c]=m[M]+F*F}}const Kl=2,Dm={none:0,ideographs:1,all:2};class ra{constructor(s,c,d){this.requestManager=s,this.localGlyphMode=c,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s){this.url=s}getGlyphs(s,c){const d=[];for(const m in s)for(const y of s[m])d.push({stack:m,id:y});Hn(d,({stack:m,id:y},x)=>{let E=this.entries[m];E||(E=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let T=E.glyphs[y];if(void 0!==T)return void x(null,{stack:m,id:y,glyph:T});if(T=this._tinySDF(E,m,y),T)return E.glyphs[y]=T,void x(null,{stack:m,id:y,glyph:T});const M=Math.floor(y/256);if(256*M>65535)return void x(new Error("glyphs > 65535 not supported"));if(E.ranges[M])return void x(null,{stack:m,id:y,glyph:T});let F=E.requests[M];F||(F=E.requests[M]=[],ra.loadGlyphRange(m,M,this.url,this.requestManager,(B,V)=>{if(V){E.ascender=V.ascender,E.descender=V.descender;for(const j in V.glyphs)this._doesCharSupportLocalGlyph(+j)||(E.glyphs[+j]=V.glyphs[+j]);E.ranges[M]=!0}for(const j of F)j(B,V);delete E.requests[M]})),F.push((B,V)=>{B?x(B):V&&x(null,{stack:m,id:y,glyph:V.glyphs[y]||null})})},(m,y)=>{if(m)c(m);else if(y){const x={};for(const{stack:E,id:T,glyph:M}of y)void 0===x[E]&&(x[E]={}),void 0===x[E].glyphs&&(x[E].glyphs={}),x[E].glyphs[T]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},x[E].ascender=this.entries[E].ascender,x[E].descender=this.entries[E].descender;c(null,x)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==Dm.none&&(this.localGlyphMode===Dm.all?!!this.localFontFamily:!!this.localFontFamily&&(Sn["CJK Unified Ideographs"](s)||Sn["Hangul Syllables"](s)||Sn.Hiragana(s)||Sn.Katakana(s)||Sn["CJK Symbols and Punctuation"](s)))}_tinySDF(s,c,d){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(d))return;let y=s.tinySDF;if(!y){let Q="400";/bold/i.test(c)?Q="900":/medium/i.test(c)?Q="500":/light/i.test(c)&&(Q="200"),y=s.tinySDF=new ra.TinySDF({fontFamily:m,fontWeight:Q,fontSize:24*Kl,buffer:3*Kl,radius:8*Kl}),y.fontWeight=Q}if(this.localGlyphs[y.fontWeight][d])return this.localGlyphs[y.fontWeight][d];const x=String.fromCharCode(d),{data:E,width:T,height:M,glyphWidth:F,glyphHeight:B,glyphLeft:V,glyphTop:j,glyphAdvance:G}=y.draw(x);return this.localGlyphs[y.fontWeight][d]={id:d,bitmap:new Yu({width:T,height:M},E),metrics:{width:F/Kl,height:B/Kl,left:V/Kl,top:j/Kl-27,advance:G/Kl,localGlyph:!0}}}}ra.loadGlyphRange=function(a,s,c,d,m){const y=256*s,x=y+255,E=d.transformRequest(d.normalizeGlyphsURL(c).replace("{fontstack}",a).replace("{range}",`${y}-${x}`),Bi.Glyphs);vr(E,(T,M)=>{if(T)m(T);else if(M){const F={},B=new up(M).readFields(sb,{});for(const V of B.glyphs)F[V.id]=V;m(null,{glyphs:F,ascender:B.ascender,descender:B.descender})}})},ra.TinySDF=class{constructor({fontSize:a=24,buffer:s=3,radius:c=8,cutoff:d=.25,fontFamily:m="sans-serif",fontWeight:y="normal",fontStyle:x="normal"}={}){this.buffer=s,this.cutoff=d,this.radius=c;const E=this.size=a+4*s,T=this._createCanvas(E),M=this.ctx=T.getContext("2d",{willReadFrequently:!0});M.font=`${x} ${y} ${a}px ${m}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(a){const s=document.createElement("canvas");return s.width=s.height=a,s}draw(a){const{width:s,actualBoundingBoxAscent:c,actualBoundingBoxDescent:d,actualBoundingBoxLeft:m,actualBoundingBoxRight:y}=this.ctx.measureText(a),x=Math.ceil(c),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-m))),T=Math.min(this.size-this.buffer,x+Math.ceil(d)),M=E+2*this.buffer,F=T+2*this.buffer,B=Math.max(M*F,0),V=new Uint8ClampedArray(B),j={data:V,width:M,height:F,glyphWidth:E,glyphHeight:T,glyphTop:x,glyphLeft:0,glyphAdvance:s};if(0===E||0===T)return j;const{ctx:G,buffer:Q,gridInner:re,gridOuter:X}=this;G.clearRect(Q,Q,E,T),G.fillText(a,Q,Q+x);const Ne=G.getImageData(Q,Q,E,T);X.fill(hp,0,B),re.fill(0,0,B);for(let H=0;H<T;H++)for(let Fe=0;Fe<E;Fe++){const Ze=Ne.data[4*(H*E+Fe)+3]/255;if(0===Ze)continue;const We=(H+Q)*M+Fe+Q;if(1===Ze)X[We]=0,re[We]=hp;else{const wt=.5-Ze;X[We]=wt>0?wt*wt:0,re[We]=wt<0?wt*wt:0}}p_(X,0,0,M,F,M,this.f,this.v,this.z),p_(re,Q,Q,E,T,M,this.f,this.v,this.z);for(let H=0;H<B;H++){const Fe=Math.sqrt(X[H])-Math.sqrt(re[H]);V[H]=Math.round(255-255*(Fe/this.radius+this.cutoff))}return j}};const jd=ia;function cy(a,s,c,d){const m=[],y=a.image,x=y.pixelRatio,E=y.paddedRect.w-2*jd,T=y.paddedRect.h-2*jd,M=a.right-a.left,F=a.bottom-a.top,B=y.stretchX||[[0,E]],V=y.stretchY||[[0,T]],j=(At,Ht)=>At+Ht[1]-Ht[0],G=B.reduce(j,0),Q=V.reduce(j,0),re=E-G,X=T-Q;let Ne=0,H=G,Fe=0,Ze=Q,We=0,wt=re,yt=0,Bt=X;if(y.content&&d){const At=y.content;Ne=uy(B,0,At[0]),Fe=uy(V,0,At[1]),H=uy(B,At[0],At[2]),Ze=uy(V,At[1],At[3]),We=At[0]-Ne,yt=At[1]-Fe,wt=At[2]-At[0]-H,Bt=At[3]-At[1]-Ze}const ln=(At,Ht,Gt,Qt)=>{const cn=m_(At.stretch-Ne,H,M,a.left),Vt=$d(At.fixed-We,wt,At.stretch,G),Cn=m_(Ht.stretch-Fe,Ze,F,a.top),Vn=$d(Ht.fixed-yt,Bt,Ht.stretch,Q),An=m_(Gt.stretch-Ne,H,M,a.left),Pi=$d(Gt.fixed-We,wt,Gt.stretch,G),mn=m_(Qt.stretch-Fe,Ze,F,a.top),ni=$d(Qt.fixed-yt,Bt,Qt.stretch,Q),ki=new ze(cn,Cn),cr=new ze(An,Cn),Di=new ze(An,mn),di=new ze(cn,mn),Yr=new ze(Vt/x,Vn/x),ci=new ze(Pi/x,ni/x),Fi=s*Math.PI/180;if(Fi){const Pr=Math.sin(Fi),kr=Math.cos(Fi),_o=[kr,-Pr,Pr,kr];ki._matMult(_o),cr._matMult(_o),di._matMult(_o),Di._matMult(_o)}const Lr=At.stretch+At.fixed,Xr=Ht.stretch+Ht.fixed;return{tl:ki,tr:cr,bl:di,br:Di,tex:{x:y.paddedRect.x+jd+Lr,y:y.paddedRect.y+jd+Xr,w:Gt.stretch+Gt.fixed-Lr,h:Qt.stretch+Qt.fixed-Xr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yr,pixelOffsetBR:ci,minFontScaleX:wt/x/M,minFontScaleY:Bt/x/F,isSDF:c}};if(d&&(y.stretchX||y.stretchY)){const At=sC(B,re,G),Ht=sC(V,X,Q);for(let Gt=0;Gt<At.length-1;Gt++){const Qt=At[Gt],cn=At[Gt+1];for(let Vt=0;Vt<Ht.length-1;Vt++)m.push(ln(Qt,Ht[Vt],cn,Ht[Vt+1]))}}else m.push(ln({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:T+1}));return m}function uy(a,s,c){let d=0;for(const m of a)d+=Math.max(s,Math.min(c,m[1]))-Math.max(s,Math.min(c,m[0]));return d}function sC(a,s,c){const d=[{fixed:-jd,stretch:0}];for(const[m,y]of a){const x=d[d.length-1];d.push({fixed:m-x.stretch,stretch:x.stretch}),d.push({fixed:m-x.stretch,stretch:x.stretch+(y-m)})}return d.push({fixed:s+jd,stretch:c}),d}function m_(a,s,c,d){return a/s*c+d}function $d(a,s,c,d){return a-s*c/d}function eS(a,s,c,d){const m=s+a.positionedLines[d].lineOffset;return 0===d?c+m/2:c+(m+(s+a.positionedLines[d-1].lineOffset))/2}class tS{constructor(s=[],c=nS){if(this.data=s,this.length=this.data.length,this.compare=c,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const s=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:c,compare:d}=this,m=c[s];for(;s>0;){const y=s-1>>1,x=c[y];if(d(m,x)>=0)break;c[s]=x,s=y}c[s]=m}_down(s){const{data:c,compare:d}=this,m=this.length>>1,y=c[s];for(;s<m;){let x=1+(s<<1),E=c[x];const T=x+1;if(T<this.length&&d(c[T],E)<0&&(x=T,E=c[T]),d(E,y)>=0)break;c[s]=E,s=x}c[s]=y}}function nS(a,s){return a<s?-1:a>s?1:0}function db(a,s=1,c=!1){let d=1/0,m=1/0,y=-1/0,x=-1/0;const E=a[0];for(let j=0;j<E.length;j++){const G=E[j];(!j||G.x<d)&&(d=G.x),(!j||G.y<m)&&(m=G.y),(!j||G.x>y)&&(y=G.x),(!j||G.y>x)&&(x=G.y)}const T=Math.min(y-d,x-m);let M=T/2;const F=new tS([],dy);if(0===T)return new ze(d,m);for(let j=d;j<y;j+=T)for(let G=m;G<x;G+=T)F.push(new Am(j+M,G+M,M,a));let B=function(j){let G=0,Q=0,re=0;const X=j[0];for(let Ne=0,H=X.length,Fe=H-1;Ne<H;Fe=Ne++){const Ze=X[Ne],We=X[Fe],wt=Ze.x*We.y-We.x*Ze.y;Q+=(Ze.x+We.x)*wt,re+=(Ze.y+We.y)*wt,G+=3*wt}return new Am(Q/G,re/G,0,j)}(a),V=F.length;for(;F.length;){const j=F.pop();(j.d>B.d||!B.d)&&(B=j,c&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,V)),j.max-B.d<=s||(M=j.h/2,F.push(new Am(j.p.x-M,j.p.y-M,M,a)),F.push(new Am(j.p.x+M,j.p.y-M,M,a)),F.push(new Am(j.p.x-M,j.p.y+M,M,a)),F.push(new Am(j.p.x+M,j.p.y+M,M,a)),V+=4)}return c&&(console.log(`num probes: ${V}`),console.log(`best distance: ${B.d}`)),B.p}function dy(a,s){return s.max-a.max}class Am{constructor(s,c,d,m){this.p=new ze(s,c),this.h=d,this.d=function(y,x){let E=!1,T=1/0;for(let M=0;M<x.length;M++){const F=x[M];for(let B=0,V=F.length,j=V-1;B<V;j=B++){const G=F[B],Q=F[j];G.y>y.y!=Q.y>y.y&&y.x<(Q.x-G.x)*(y.y-G.y)/(Q.y-G.y)+G.x&&(E=!E),T=Math.min(T,Px(y,G,Q))}}return(E?1:-1)*Math.sqrt(T)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const fp=7,bl=Number.POSITIVE_INFINITY,IF=Math.sqrt(2);function Ju(a,[s,c]){let d=0,m=0;if(c===bl){s<0&&(s=0);const y=s/IF;switch(a){case"top-right":case"top-left":m=y-fp;break;case"bottom-right":case"bottom-left":m=-y+fp;break;case"bottom":m=-s+fp;break;case"top":m=s-fp}switch(a){case"top-right":case"bottom-right":d=-y;break;case"top-left":case"bottom-left":d=y;break;case"left":d=s;break;case"right":d=-s}}else{switch(s=Math.abs(s),c=Math.abs(c),a){case"top-right":case"top-left":case"top":m=c-fp;break;case"bottom-right":case"bottom-left":case"bottom":m=-c+fp}switch(a){case"top-right":case"bottom-right":case"right":d=-s;break;case"top-left":case"bottom-left":case"left":d=s}}return[d,m]}function hb(a,s,c,d,m,y,x,E,T,M){a.createArrays(),a.tilePixelRatio=ei/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const F=a.layers[0].layout,B=a.layers[0]._unevaluatedLayout._values,V={};if("composite"===a.textSizeData.kind){const{minZoom:Q,maxZoom:re}=a.textSizeData;V.compositeTextSizes=[B["text-size"].possiblyEvaluate(new N(Q),E),B["text-size"].possiblyEvaluate(new N(re),E)]}if("composite"===a.iconSizeData.kind){const{minZoom:Q,maxZoom:re}=a.iconSizeData;V.compositeIconSizes=[B["icon-size"].possiblyEvaluate(new N(Q),E),B["icon-size"].possiblyEvaluate(new N(re),E)]}V.layoutTextSize=B["text-size"].possiblyEvaluate(new N(T+1),E),V.layoutIconSize=B["icon-size"].possiblyEvaluate(new N(T+1),E),V.textMaxSize=B["text-size"].possiblyEvaluate(new N(18),E);const j="map"===F.get("text-rotation-alignment")&&"point"!==F.get("symbol-placement"),G=F.get("text-size");for(const Q of a.features){const re=F.get("text-font").evaluate(Q,{},E).join(","),X=G.evaluate(Q,{},E),Ne=V.layoutTextSize.evaluate(Q,{},E),H=(V.layoutIconSize.evaluate(Q,{},E),{horizontal:{},vertical:void 0}),Fe=Q.text;let Ze,We=[0,0];if(Fe){const Bt=Fe.toString(),ln=F.get("text-letter-spacing").evaluate(Q,{},E)*$r,At=F.get("text-line-height").evaluate(Q,{},E)*$r,Ht=Qp(Bt)?ln:0,Gt=F.get("text-anchor").evaluate(Q,{},E),Qt=F.get("text-variable-anchor");if(!Qt){const An=F.get("text-radial-offset").evaluate(Q,{},E);We=An?Ju(Gt,[An*$r,bl]):F.get("text-offset").evaluate(Q,{},E).map(Pi=>Pi*$r)}let cn=j?"center":F.get("text-justify").evaluate(Q,{},E);const Vt="point"===F.get("symbol-placement"),Cn=Vt?F.get("text-max-width").evaluate(Q,{},E)*$r:1/0,Vn=An=>{a.allowVerticalPlacement&&Ih(Bt)&&(H.vertical=XE(Fe,s,c,m,re,Cn,At,Gt,An,Ht,We,Zl.vertical,!0,Ne,X))};if(!j&&Qt){const An="auto"===cn?Qt.map(mn=>fb(mn)):[cn];let Pi=!1;for(let mn=0;mn<An.length;mn++){const ni=An[mn];if(!H.horizontal[ni])if(Pi)H.horizontal[ni]=H.horizontal[0];else{const ki=XE(Fe,s,c,m,re,Cn,At,"center",ni,Ht,We,Zl.horizontal,!1,Ne,X);ki&&(H.horizontal[ni]=ki,Pi=1===ki.positionedLines.length)}}Vn("left")}else{if("auto"===cn&&(cn=fb(Gt)),Vt||F.get("text-writing-mode").indexOf("horizontal")>=0||!Ih(Bt)){const An=XE(Fe,s,c,m,re,Cn,At,Gt,cn,Ht,We,Zl.horizontal,!1,Ne,X);An&&(H.horizontal[cn]=An)}Vn(Vt?"left":cn)}}let wt=!1;if(Q.icon&&Q.icon.name){const Bt=d[Q.icon.name];Bt&&(Ze=eC(m[Q.icon.name],F.get("icon-offset").evaluate(Q,{},E),F.get("icon-anchor").evaluate(Q,{},E)),wt=Bt.sdf,void 0===a.sdfIcons?a.sdfIcons=Bt.sdf:a.sdfIcons!==Bt.sdf&&ti("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Bt.pixelRatio!==a.pixelRatio||0!==F.get("icon-rotate").constantOr(1))&&(a.iconsNeedLinear=!0))}const yt=fy(H.horizontal)||H.vertical;a.iconsInText||(a.iconsInText=!!yt&&yt.iconsInText),(yt||Ze)&&TF(a,Q,H,Ze,d,V,Ne,0,We,wt,x,E,M)}y&&a.generateCollisionDebugBuffers(T,a.collisionBoxArray)}function fb(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function TF(a,s,c,d,m,y,x,E,T,M,F,B,V){let j=y.textMaxSize.evaluate(s,{},B);void 0===j&&(j=x);const G=a.layers[0].layout,Q=G.get("icon-offset").evaluate(s,{},B),re=fy(c.horizontal)||c.vertical,X="globe"===V.name,Ne=$r,H=x/Ne,Fe=a.tilePixelRatio*j/Ne,Ze=(Gt=a.overscaling,a.zoom>18&&Gt>2&&(Gt>>=1),Math.max(ei/(512*Gt),1)*G.get("symbol-spacing")),We=G.get("text-padding")*a.tilePixelRatio,wt=G.get("icon-padding")*a.tilePixelRatio,yt=xt(G.get("text-max-angle")),Bt="map"===G.get("text-rotation-alignment")&&"point"!==G.get("symbol-placement"),ln="map"===G.get("icon-rotation-alignment")&&"point"!==G.get("symbol-placement"),At=G.get("symbol-placement"),Ht=Ze/2;var Gt;const Qt=G.get("icon-text-fit");let cn;d&&"none"!==Qt&&(a.allowVerticalPlacement&&c.vertical&&(cn=ub(d,c.vertical,Qt,G.get("icon-text-fit-padding"),Q,H)),re&&(d=ub(d,re,Qt,G.get("icon-text-fit-padding"),Q,H)));const Vt=(Cn,Vn,An)=>{if(Vn.x<0||Vn.x>=ei||Vn.y<0||Vn.y>=ei)return;let Pi=null;if(X){const{x:mn,y:ni,z:ki}=V.projectTilePoint(Vn.x,Vn.y,An);Pi={anchor:new Sc(mn,ni,ki,0,void 0),up:V.upVector(An,Vn.x,Vn.y)}}!function(mn,ni,ki,cr,Di,di,Yr,ci,Fi,Lr,Xr,Pr,kr,_o,ko,Zo,Rr,gs,Ko,uo,_r,Yo,Gr,Fa,Xo){const ho=mn.addToLineVertexArray(ni,cr);let _s,La,Cs,hu,bp,Lm,af,Sy=0,mS=0,Rb=0,Ob=0,My=-1,Py=-1;const kc={};let id=qf("");const wp=ki?ki.anchor:ni;let Fb=0,E_=0;if(void 0===Fi._unevaluatedLayout.getValue("text-radial-offset")?[Fb,E_]=Fi.layout.get("text-offset").evaluate(_r,{},Xo).map(xa=>xa*$r):(Fb=Fi.layout.get("text-radial-offset").evaluate(_r,{},Xo)*$r,E_=bl),mn.allowVerticalPlacement&&Di.vertical){const xa=Di.vertical;if(ko)Lm=Qh(xa),ci&&(af=Qh(ci));else{const oa=Fi.layout.get("text-rotate").evaluate(_r,{},Xo)+90;Cs=Sm(Lr,wp,ni,Xr,Pr,kr,xa,_o,oa,Zo),ci&&(hu=Sm(Lr,wp,ni,Xr,Pr,kr,ci,gs,oa))}}if(di){const xa=Fi.layout.get("icon-rotate").evaluate(_r,{},Xo),oa="none"!==Fi.layout.get("icon-text-fit"),Nm=cy(di,xa,Gr,oa),Bm=ci?cy(ci,xa,Gr,oa):void 0;La=Sm(Lr,wp,ni,Xr,Pr,kr,di,gs,xa),Sy=4*Nm.length;const _S=mn.iconSizeData;let Ep=null;"source"===_S.kind?(Ep=[Os*Fi.layout.get("icon-size").evaluate(_r,{},Xo)],Ep[0]>lu&&ti(`${mn.layerIds[0]}: Value for "icon-size" is >= ${hy}. Reduce your "icon-size".`)):"composite"===_S.kind&&(Ep=[Os*Yo.compositeIconSizes[0].evaluate(_r,{},Xo),Os*Yo.compositeIconSizes[1].evaluate(_r,{},Xo)],(Ep[0]>lu||Ep[1]>lu)&&ti(`${mn.layerIds[0]}: Value for "icon-size" is >= ${hy}. Reduce your "icon-size".`)),mn.addSymbols(mn.icon,Nm,Ep,uo,Ko,_r,!1,ki,ni,ho.lineStartIndex,ho.lineLength,-1,Fa,Xo),My=mn.icon.placedSymbolArray.length-1,Bm&&(mS=4*Bm.length,mn.addSymbols(mn.icon,Bm,Ep,uo,Ko,_r,Zl.vertical,ki,ni,ho.lineStartIndex,ho.lineLength,-1,Fa,Xo),Py=mn.icon.placedSymbolArray.length-1)}for(const xa in Di.horizontal){const oa=Di.horizontal[xa];_s||(id=qf(oa.text),ko?bp=Qh(oa):_s=Sm(Lr,wp,ni,Xr,Pr,kr,oa,_o,Fi.layout.get("text-rotate").evaluate(_r,{},Xo),Zo));const Nm=1===oa.positionedLines.length;if(Rb+=aC(mn,ki,ni,oa,Yr,Fi,ko,_r,Zo,ho,Di.vertical?Zl.horizontal:Zl.horizontalOnly,Nm?Object.keys(Di.horizontal):[xa],kc,My,Yo,Fa,Xo),Nm)break}Di.vertical&&(Ob+=aC(mn,ki,ni,Di.vertical,Yr,Fi,ko,_r,Zo,ho,Zl.vertical,["vertical"],kc,Py,Yo,Fa,Xo));let lf=-1;const ky=(xa,oa)=>xa?Math.max(xa,oa):oa;lf=ky(bp,lf),lf=ky(Lm,lf),lf=ky(af,lf);const gS=lf>-1?1:0;mn.glyphOffsetArray.length>=tf.MAX_GLYPHS&&ti("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==_r.sortKey&&mn.addToSortKeyRanges(mn.symbolInstances.length,_r.sortKey),mn.symbolInstances.emplaceBack(wp.x,wp.y,wp.z,ni.x,ni.y,kc.right>=0?kc.right:-1,kc.center>=0?kc.center:-1,kc.left>=0?kc.left:-1,kc.vertical>=0?kc.vertical:-1,My,Py,id,void 0!==_s?_s:mn.collisionBoxArray.length,void 0!==_s?_s+1:mn.collisionBoxArray.length,void 0!==Cs?Cs:mn.collisionBoxArray.length,void 0!==Cs?Cs+1:mn.collisionBoxArray.length,void 0!==La?La:mn.collisionBoxArray.length,void 0!==La?La+1:mn.collisionBoxArray.length,hu||mn.collisionBoxArray.length,hu?hu+1:mn.collisionBoxArray.length,Xr,Rb,Ob,Sy,mS,gS,0,Fb,E_,lf)}(a,Vn,Pi,Cn,c,d,m,cn,a.layers[0],a.collisionBoxArray,s.index,s.sourceLayerIndex,a.index,We,Bt,T,0,wt,ln,Q,s,y,M,F,B)};if("line"===At)for(const Cn of rC(s.geometry,0,0,ei,ei)){const Vn=iC(Cn,Ze,yt,c.vertical||re,d,Ne,Fe,a.overscaling,ei);for(const An of Vn)re&&pb(a,re.text,Ht,An)||Vt(Cn,An,B)}else if("line-center"===At){for(const Cn of s.geometry)if(Cn.length>1){const Vn=nC(Cn,yt,c.vertical||re,d,Ne,Fe);Vn&&Vt(Cn,Vn,B)}}else if("Polygon"===s.type)for(const Cn of j0(s.geometry,0)){const Vn=db(Cn,16);Vt(Cn[0],new Sc(Vn.x,Vn.y,0,0,void 0),B)}else if("LineString"===s.type)for(const Cn of s.geometry)Vt(Cn,new Sc(Cn[0].x,Cn[0].y,0,0,void 0),B);else if("Point"===s.type)for(const Cn of s.geometry)for(const Vn of Cn)Vt([Vn],new Sc(Vn.x,Vn.y,0,0,void 0),B)}const hy=255,lu=hy*Os;function aC(a,s,c,d,m,y,x,E,T,M,F,B,V,j,G,Q,re){const X=function(Fe,Ze,We,wt,yt,Bt,ln,At){const Ht=[];if(0===Ze.positionedLines.length)return Ht;const Gt=wt.layout.get("text-rotate").evaluate(Bt,{})*Math.PI/180,Qt=function(An){const Pi=An[0],mn=An[1],ni=Pi*mn;return ni>0?[Pi,-mn]:ni<0?[-Pi,mn]:0===Pi?[mn,Pi]:[mn,-Pi]}(We);let cn=Math.abs(Ze.top-Ze.bottom);for(const An of Ze.positionedLines)cn-=An.lineOffset;const Vt=Ze.positionedLines.length,Cn=cn/Vt;let Vn=Ze.top-We[1];for(let An=0;An<Vt;++An){const Pi=Ze.positionedLines[An];Vn=eS(Ze,Cn,Vn,An);for(const mn of Pi.positionedGlyphs){if(!mn.rect)continue;const ni=mn.rect||{};let ki=ZE+1,cr=!0,Di=1,di=0;if(mn.imageName){const Gr=ln[mn.imageName];if(!Gr)continue;if(Gr.sdf){ti("SDF images are not supported in formatted text and will be ignored.");continue}cr=!1,Di=Gr.pixelRatio,ki=ia/Di}const Yr=(yt||At)&&mn.vertical,ci=mn.metrics.advance*mn.scale/2,Fi=mn.metrics,Lr=mn.rect;if(null===Lr)continue;At&&Ze.verticalizable&&(di=mn.imageName?ci-mn.metrics.width*mn.scale/2:0);const Xr=yt?[mn.x+ci,mn.y]:[0,0];let Pr=[0,0],kr=[0,0],_o=!1;yt||(Yr?(kr=[mn.x+ci+Qt[0],mn.y+Qt[1]-di],_o=!0):Pr=[mn.x+ci+We[0],mn.y+We[1]-di]);const ko=Lr.w*mn.scale/(Di*(mn.localGlyph?Kl:1)),Zo=Lr.h*mn.scale/(Di*(mn.localGlyph?Kl:1));let Rr,gs,Ko,uo;if(Yr){const Gr=mn.y-Vn,Fa=new ze(-ci,ci-Gr),Xo=-Math.PI/2,ho=new ze(...kr);Rr=new ze(-ci+Pr[0],Pr[1]),Rr._rotateAround(Xo,Fa)._add(ho),Rr.x+=-Gr+ci,Rr.y-=(Fi.left-ki)*mn.scale;const _s=mn.imageName?Fi.advance*mn.scale:$r*mn.scale,La=String.fromCharCode(mn.glyph);$E(La)?Rr.x+=(1-ki)*mn.scale:ZA(La)?Rr.x+=_s-Fi.height*mn.scale+(-ki-1)*mn.scale:Rr.x+=mn.imageName||Fi.width+2*ki===Lr.w&&Fi.height+2*ki===Lr.h?(_s-Zo)/2:(_s-(Fi.height+2*ki)*mn.scale)/2,gs=new ze(Rr.x,Rr.y-ko),Ko=new ze(Rr.x+Zo,Rr.y),uo=new ze(Rr.x+Zo,Rr.y-ko)}else{const Gr=(Fi.left-ki)*mn.scale-ci+Pr[0],Fa=(-Fi.top-ki)*mn.scale+Pr[1],Xo=Gr+ko,ho=Fa+Zo;Rr=new ze(Gr,Fa),gs=new ze(Xo,Fa),Ko=new ze(Gr,ho),uo=new ze(Xo,ho)}if(Gt){let Gr;Gr=yt?new ze(0,0):_o?new ze(Qt[0],Qt[1]):new ze(We[0],We[1]),Rr._rotateAround(Gt,Gr),gs._rotateAround(Gt,Gr),Ko._rotateAround(Gt,Gr),uo._rotateAround(Gt,Gr)}const _r=new ze(0,0),Yo=new ze(0,0);Ht.push({tl:Rr,tr:gs,bl:Ko,br:uo,tex:ni,writingMode:Ze.writingMode,glyphOffset:Xr,sectionIndex:mn.sectionIndex,isSDF:cr,pixelOffsetTL:_r,pixelOffsetBR:Yo,minFontScaleX:0,minFontScaleY:0})}}return Ht}(0,d,T,y,x,E,m,a.allowVerticalPlacement),Ne=a.textSizeData;let H=null;"source"===Ne.kind?(H=[Os*y.layout.get("text-size").evaluate(E,{},re)],H[0]>lu&&ti(`${a.layerIds[0]}: Value for "text-size" is >= ${hy}. Reduce your "text-size".`)):"composite"===Ne.kind&&(H=[Os*G.compositeTextSizes[0].evaluate(E,{},re),Os*G.compositeTextSizes[1].evaluate(E,{},re)],(H[0]>lu||H[1]>lu)&&ti(`${a.layerIds[0]}: Value for "text-size" is >= ${hy}. Reduce your "text-size".`)),a.addSymbols(a.text,X,H,T,x,E,F,s,c,M.lineStartIndex,M.lineLength,j,Q,re);for(const Fe of B)V[Fe]=a.text.placedSymbolArray.length-1;return 4*X.length}function fy(a){for(const s in a)return a[s];return null}function Sm(a,s,c,d,m,y,x,E,T,M){let F=x.top,B=x.bottom,V=x.left,j=x.right;const G=x.collisionPadding;if(G&&(V-=G[0],F-=G[1],j+=G[2],B+=G[3]),T){const Q=new ze(V,F),re=new ze(j,F),X=new ze(V,B),Ne=new ze(j,B),H=xt(T);let Fe=new ze(0,0);M&&(Fe=new ze(M[0],M[1])),Q._rotateAround(H,Fe),re._rotateAround(H,Fe),X._rotateAround(H,Fe),Ne._rotateAround(H,Fe),V=Math.min(Q.x,re.x,X.x,Ne.x),j=Math.max(Q.x,re.x,X.x,Ne.x),F=Math.min(Q.y,re.y,X.y,Ne.y),B=Math.max(Q.y,re.y,X.y,Ne.y)}return a.emplaceBack(s.x,s.y,s.z,c.x,c.y,V,F,j,B,E,d,m,y),a.length-1}function Qh(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const s=a.bottom-a.top;return s>0?Math.max(10,s):null}function pb(a,s,c,d){const m=a.compareText;if(s in m){const y=m[s];for(let x=y.length-1;x>=0;x--)if(d.dist(y[x])<c)return!0}else m[s]=[];return m[s].push(d),!1}function py(a,s){const c=a.fovAboveCenter,d=a.elevation?a.elevation.getMinElevationBelowMSL()*s:0,m=(a._camera.position[2]*a.worldSize-d)/Math.cos(a._pitch),y=Math.sin(c)*m/Math.sin(Math.max(Math.PI/2-a._pitch-c,.01)),x=Math.sin(a._pitch)*y+m;return Math.min(1.01*x,m*(1/a._horizonShift))}function cu(a,s){if(!s.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:s};const c=Math.pow(2,-a.z),d=a.x*c,m=(a.x+1)*c,y=a.y*c,x=(a.y+1)*c,E=jr(d),T=jr(m),M=ta(y),F=ta(x),B=s.project(E,M),V=s.project(T,M),j=s.project(T,F),G=s.project(E,F);let Q=Math.min(B.x,V.x,j.x,G.x),re=Math.min(B.y,V.y,j.y,G.y),X=Math.max(B.x,V.x,j.x,G.x),Ne=Math.max(B.y,V.y,j.y,G.y);const H=c/16;function Fe(We,wt,yt,Bt,ln,At){const Ht=(yt+ln)/2,Gt=(Bt+At)/2,Qt=s.project(jr(Ht),ta(Gt)),cn=Math.max(0,Q-Qt.x,re-Qt.y,Qt.x-X,Qt.y-Ne);Q=Math.min(Q,Qt.x),X=Math.max(X,Qt.x),re=Math.min(re,Qt.y),Ne=Math.max(Ne,Qt.y),cn>H&&(Fe(We,Qt,yt,Bt,Ht,Gt),Fe(Qt,wt,Ht,Gt,ln,At))}Fe(B,V,d,y,m,y),Fe(V,j,m,y,m,x),Fe(j,G,m,x,d,x),Fe(G,B,d,x,d,y),Q-=H,re-=H,X+=H,Ne+=H;const Ze=1/Math.max(X-Q,Ne-re);return{scale:Ze,x:Q*Ze,y:re*Ze,x2:X*Ze,y2:Ne*Ze,projection:s}}const my=Cc(new Float32Array(16));class Yl{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,c){return{x:0,y:0,z:0}}unproject(s,c){return new Fr(0,0)}projectTilePoint(s,c,d){return{x:s,y:c,z:0}}locationPoint(s,c,d=!0){return s._coordinatePoint(s.locationCoordinate(c),d)}pixelsPerMeter(s,c){return su(1,s)*c}pixelSpaceConversion(s,c,d){return 1}farthestPixelDistance(s){return py(s,s.pixelsPerMeter)}pointCoordinate(s,c,d,m){const y=s.horizonLineFromTop(!1),x=new ze(c,Math.max(y,d));return s.rayIntersectionCoordinate(s.pointRayIntersection(x,m))}pointCoordinate3D(s,c,d){const m=new ze(c,d);if(s.elevation)return s.elevation.pointCoordinate(m);{const y=this.pointCoordinate(s,m.x,m.y,0);return[y.x,y.y,y.z]}}isPointAboveHorizon(s,c){if(s.elevation)return!this.pointCoordinate3D(s,c.x,c.y);const d=s.horizonLineFromTop();return c.y<d}createInversionMatrix(s,c){return my}createTileMatrix(s,c,d){let m,y,x;const E=d.canonical,T=Cc(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=cu(E,this);m=1,y=M.x+d.wrap*M.scale,x=M.y,Ic(T,T,[m/M.scale,m/M.scale,s.pixelsPerMeter/c])}else m=c/s.zoomScale(E.z),y=(E.x+Math.pow(2,E.z)*d.wrap)*m,x=E.y*m;return Ph(T,T,[y,x,0]),Ic(T,T,[m/ei,m/ei,1]),T}upVector(s,c,d){return[0,0,1]}upVectorScale(s,c,d){return{metersToTile:1}}}class mb extends Yl{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[c,d]=this.parallels=s.parallels||[29.5,45.5],m=Math.sin(xt(c));this.n=(m+Math.sin(xt(d)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(s,c){const{n:d,c:m,r0:y}=this,x=xt(s-this.center[0]),E=xt(c),T=Math.sqrt(m-2*d*Math.sin(E))/d;return{x:T*Math.sin(x*d),y:T*Math.cos(x*d)-y,z:0}}unproject(s,c){const{n:d,c:m,r0:y}=this,x=y+c;let E=Math.atan2(s,Math.abs(x))*Math.sign(x);x*d<0&&(E-=Math.PI*Math.sign(s)*Math.sign(x));const T=xt(this.center[0])*d;E=Kt(E,-Math.PI-T,Math.PI-T);const M=Rt(lt(E/d)+this.center[0],-180,180),F=Math.asin(Rt((m-(s*s+x*x)*d*d)/(2*d),-1,1)),B=Rt(lt(F),-na,na);return new Fr(M,B)}}const pp=1.340264,Jh=-.081106,gy=893e-6,mp=.003796,ef=Math.sqrt(3)/2;class iS extends Yl{project(s,c){c=c/180*Math.PI,s=s/180*Math.PI;const d=Math.asin(ef*Math.sin(c)),m=d*d,y=m*m*m;return{x:.5*(s*Math.cos(d)/(ef*(pp+3*Jh*m+y*(7*gy+9*mp*m)))/Math.PI+.5),y:1-.5*(d*(pp+Jh*m+y*(gy+mp*m))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,m=d*d,y=m*m*m;for(let F,B,V,j=0;j<12&&(B=d*(pp+Jh*m+y*(gy+mp*m))-c,V=pp+3*Jh*m+y*(7*gy+9*mp*m),F=B/V,d=Rt(d-F,-Math.PI/3,Math.PI/3),m=d*d,y=m*m*m,!(Math.abs(F)<1e-12));++j);const x=ef*s*(pp+3*Jh*m+y*(7*gy+9*mp*m))/Math.cos(d),E=Math.asin(Math.sin(d)/ef),T=Rt(180*x/Math.PI,-180,180),M=Rt(180*E/Math.PI,-na,na);return new Fr(T,M)}}class lC extends Yl{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){return{x:.5+s/360,y:.5-c/360,z:0}}unproject(s,c){const d=360*(s-.5),m=Rt(360*(.5-c),-na,na);return new Fr(d,m)}}const Mm=Math.PI/2;function _y(a){return Math.tan((Mm+a)/2)}class gb extends Yl{constructor(s){super(s),this.center=s.center||[0,30];const[c,d]=this.parallels=s.parallels||[30,30];let m=xt(c),y=xt(d);this.southernCenter=m+y<0,this.southernCenter&&(m=-m,y=-y);const x=Math.cos(m),E=_y(m);this.n=m===y?Math.sin(m):Math.log(x/Math.cos(y))/Math.log(_y(y)/E),this.f=x*Math.pow(_y(m),this.n)/this.n}project(s,c){c=xt(c),this.southernCenter&&(c=-c),s=xt(s-this.center[0]);const d=1e-6,{n:m,f:y}=this;y>0?c<-Mm+d&&(c=-Mm+d):c>Mm-d&&(c=Mm-d);const x=y/Math.pow(_y(c),m);let E=x*Math.sin(m*s),T=y-x*Math.cos(m*s);return E=.5*(E/Math.PI+.5),T=.5*(T/Math.PI+.5),{x:E,y:this.southernCenter?T:1-T,z:0}}unproject(s,c){s=(2*s-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:d,f:m}=this,y=m-c,x=Math.sign(y),E=Math.sign(d)*Math.sqrt(s*s+y*y);let T=Math.atan2(s,Math.abs(y))*x;y*d<0&&(T-=Math.PI*Math.sign(s)*x);const M=Rt(lt(T/d)+this.center[0],-180,180),F=Rt(lt(2*Math.atan(Math.pow(m/E,1/d))-Mm),-na,na);return new Fr(M,this.southernCenter?-F:F)}}class _b extends Yl{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,c){return{x:Ac(s),y:ql(c),z:0}}unproject(s,c){const d=jr(s),m=ta(c);return new Fr(d,m)}}const cC=xt(na);class rS extends Yl{project(s,c){const d=(c=xt(c))*c,m=d*d;return{x:.5*((s=xt(s))*(.8707-.131979*d+m*(m*(.003971*d-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+d*(.015085+m*(.028874*d-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let d=c=(2*(1-c)-1)*Math.PI,m=25,y=0,x=d*d;do{x=d*d;const M=x*x;y=(d*(1.007226+x*(.015085+M*(.028874*x-.044475-.005916*M)))-c)/(1.007226+x*(.045255+M*(.259866*x-.311325-.005916*11*M))),d=Rt(d-y,-cC,cC)}while(Math.abs(y)>1e-6&&--m>0);x=d*d;const E=Rt(lt(s/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),T=lt(d);return new Fr(E,T)}}const oS=xt(na);class sS extends Yl{project(s,c){c=xt(c),s=xt(s);const d=Math.cos(c),m=2/Math.PI,y=Math.acos(d*Math.cos(s/2)),x=Math.sin(y)/y,E=.5*(s*m+2*d*Math.sin(s/2)/x)||0,T=.5*(c+Math.sin(c)/x)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(s,c){let d=s=(2*s-.5)*Math.PI,m=c=(2*(1-c)-1)*Math.PI,y=25;const x=1e-6;let E=0,T=0;do{const M=Math.cos(m),F=Math.sin(m),B=2*F*M,V=F*F,j=M*M,G=Math.cos(d/2),Q=Math.sin(d/2),re=2*G*Q,X=Q*Q,Ne=1-j*G*G,H=Ne?1/Ne:0,Fe=Ne?Math.acos(M*G)*Math.sqrt(1/Ne):0,Ze=.5*(2*Fe*M*Q+2*d/Math.PI)-s,We=.5*(Fe*F+m)-c,wt=.5*H*(j*X+Fe*M*G*V)+1/Math.PI,yt=H*(re*B/4-Fe*F*Q),Bt=.125*H*(B*Q-Fe*F*j*re),ln=.5*H*(V*G+Fe*X*M)+.5,At=yt*Bt-ln*wt;E=(We*yt-Ze*ln)/At,T=(Ze*Bt-We*wt)/At,d=Rt(d-E,-Math.PI,Math.PI),m=Rt(m-T,-oS,oS)}while((Math.abs(E)>x||Math.abs(T)>x)&&--y>0);return new Fr(lt(d),lt(m))}}class g_ extends Yl{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(xt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){const{scale:d,cosPhi:m}=this;return{x:xt(s)*m*d+.5,y:-Math.sin(xt(c))/m*d+.5,z:0}}unproject(s,c){const{scale:d,cosPhi:m}=this,y=-(c-.5)/d,x=Rt(lt((s-.5)/d)/m,-180,180),E=Math.asin(Rt(y*m,-1,1)),T=Rt(lt(E),-na,na);return new Fr(x,T)}}class yb extends _b{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,c,d){const m=Vh(s,c,d);return Dn(m,m,k0(Ku(d))),{x:m[0],y:m[1],z:m[2]}}locationPoint(s,c){const d=tp(c.lat,c.lng),m=nt([],d),y=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(c),s._centerAltitude):s._centerAltitude;me(d,d,m,su(1,0)*ei*y);const x=Cc(new Float64Array(16));return qu(x,s.pixelMatrix,s.globeMatrix),Dn(d,d,x),new ze(d[0],d[1])}pixelsPerMeter(s,c){return su(1,0)*c}pixelSpaceConversion(s,c,d){const m=su(1,s)*c,y=tr(su(1,45)*c,m,d);return this.pixelsPerMeter(s,c)/y}createTileMatrix(s,c,d){const m=Ex(Ku(d.canonical));return qu(new Float64Array(16),s.globeMatrix,m)}createInversionMatrix(s,c){const{center:d}=s,m=k0(Ku(c));return lm(m,m,xt(d.lng)),Hg(m,m,xt(d.lat)),Ic(m,m,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(s,c,d,m){return mA(s,c,d,!0)||new $h(0,0)}pointCoordinate3D(s,c,d){const m=this.pointCoordinate(s,c,d,0);return[m.x,m.y,m.z]}isPointAboveHorizon(s,c){return!mA(s,c.x,c.y,!1)}farthestPixelDistance(s){const c=function(m,y){const x=m.cameraToCenterDistance,E=m._centerAltitude*y,T=m._camera,M=m._camera.forward(),F=tu([],Y([],M,-x),[0,0,E]),B=m.worldSize/(2*Math.PI),V=[0,0,-B],j=m.width/m.height,G=Math.tan(m.fovAboveCenter),Q=Y([],T.up(),G),re=Y([],T.right(),G*j),X=nt([],tu([],tu([],M,Q),re)),Ne=[];let H;if(new M0(F,X).closestPointOnSphere(V,B,Ne)){const Fe=tu([],Ne,V),Ze=go([],Fe,F);H=Math.cos(m.fovAboveCenter)*eu(Ze)}else{const Fe=go([],F,V),Ze=go([],V,F);nt(Ze,Ze);const We=eu(Fe)-B;H=Math.sqrt(We*(We+2*B));const wt=Math.acos(H/(B+We))-Math.acos(Pt(M,Ze));H*=Math.cos(wt)}return 1.01*H}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),d=ea(s.zoom);if(d>0){const m=py(s,su(1,s.center.lat)*s.worldSize),y=s.worldSize/(2*Math.PI),x=Math.max(s.width,s.height)/s.worldSize*Math.PI;return tr(c,m+y*(1-Math.cos(x)),Math.pow(d,10))}return c}upVector(s,c,d){return Vh(c,d,s,1)}upVectorScale(s){return{metersToTile:wx(zh(Ku(s)))}}}function uC(a){const s=a.parallels,c=!!s&&Math.abs(s[0]+s[1])<.01;switch(a.name){case"mercator":return new _b(a);case"equirectangular":return new lC(a);case"naturalEarth":return new rS(a);case"equalEarth":return new iS(a);case"winkelTripel":return new sS(a);case"albers":return c?new g_(a):new mb(a);case"lambertConformalConic":return c?new g_(a):new gb(a);case"globe":return new yb(a)}throw new Error(`Invalid projection name: ${a.name}`)}const dC=q0.types,vb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gp(a,s,c,d,m,y,x,E,T,M,F,B,V){const j=E?Math.min(lu,Math.round(E[0])):0,G=E?Math.min(lu,Math.round(E[1])):0;a.emplaceBack(s,c,Math.round(32*d),Math.round(32*m),y,x,(j<<1)+(T?1:0),G,16*M,16*F,256*B,256*V)}function yy(a,s,c,d,m,y,x){a.emplaceBack(s,c,d,m,y,x)}function __(a,s,c,d,m){a.emplaceBack(s,c,d,m),a.emplaceBack(s,c,d,m),a.emplaceBack(s,c,d,m),a.emplaceBack(s,c,d,m)}function aS(a){for(const s of a.sections)if(Jp(s.text))return!0;return!1}class vy{constructor(s){this.layoutVertexArray=new Zt,this.indexArray=new Bn,this.programConfigurations=s,this.segments=new io,this.dynamicLayoutVertexArray=new en,this.opacityVertexArray=new Kn,this.placedSymbolArray=new to,this.globeExtVertexArray=new Mt}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(s,c,d,m){this.isEmpty()||(d&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,UE.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,jA.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,vb,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,lp.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||m)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Fn(vy,"SymbolBuffers");class hC{constructor(s,c,d){this.layoutVertexArray=new s,this.layoutAttributes=c,this.indexArray=new d,this.segments=new io,this.collisionVertexArray=new Ni,this.collisionVertexArrayExt=new Si}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,$A.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,HA.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Fn(hC,"CollisionBuffers");class tf{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(x=>x.id),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Cc([]),this.placementViewportMatrix=Cc([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tb(this.zoom,c["text-size"]),this.iconSizeData=tb(this.zoom,c["icon-size"]);const d=this.layers[0].layout,m=d.get("symbol-sort-key"),y=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==y&&void 0!==m.constantOr(1),this.sortFeaturesByY=("viewport-y"===y||"auto"===y&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(x=>Zl[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=s.sourceID,this.projection=s.projection}createArrays(){this.text=new vy(new Wu(this.layers,this.zoom,s=>/^text/.test(s))),this.icon=new vy(new Wu(this.layers,this.zoom,s=>/^icon/.test(s))),this.glyphOffsetArray=new hs,this.lineVertexArray=new Hu,this.symbolInstances=new Mr}calculateGlyphDependencies(s,c,d,m,y){for(let x=0;x<s.length;x++)if(c[s.charCodeAt(x)]=!0,m&&y){const E=u_[s.charAt(x)];E&&(c[E.charCodeAt(0)]=!0)}}populate(s,c,d,m){const y=this.layers[0],x=y.layout,E="globe"===this.projection.name,T=x.get("text-font"),M=x.get("text-field"),F=x.get("icon-image"),B=("constant"!==M.value.kind||M.value.value instanceof Ur&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&("constant"!==T.value.kind||T.value.value.length>0),V="constant"!==F.value.kind||!!F.value.value||Object.keys(F.parameters).length>0,j=x.get("symbol-sort-key");if(this.features=[],!B&&!V)return;const G=c.iconDependencies,Q=c.glyphDependencies,re=c.availableImages,X=new N(this.zoom);for(const{feature:Ne,id:H,index:Fe,sourceLayerIndex:Ze}of s){const We=y._featureFilter.needGeometry,wt=Wh(Ne,We);if(!y._featureFilter.filter(X,wt,d))continue;if(We||(wt.geometry=Gh(Ne,d,m)),E&&1!==Ne.type&&d.z<=5){const At=wt.geometry,Ht=.98078528056,Gt=(Qt,cn)=>Pt(Vh(Qt.x,Qt.y,d,1),Vh(cn.x,cn.y,d,1))<Ht;for(let Qt=0;Qt<At.length;Qt++)At[Qt]=vA(At[Qt],Gt)}let yt,Bt;if(B){const At=y.getValueAndResolveTokens("text-field",wt,d,re),Ht=Ur.factory(At);aS(Ht)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===I()||this.hasRTLText&&k.isParsed())&&(yt=qA(Ht,y,wt))}if(V){const At=y.getValueAndResolveTokens("icon-image",wt,d,re);Bt=At instanceof zs?At:zs.fromString(At)}if(!yt&&!Bt)continue;const ln=this.sortFeaturesByKey?j.evaluate(wt,{},d):void 0;if(this.features.push({id:H,text:yt,icon:Bt,index:Fe,sourceLayerIndex:Ze,geometry:wt.geometry,properties:Ne.properties,type:dC[Ne.type],sortKey:ln}),Bt&&(G[Bt.name]=!0),yt){const At=T.evaluate(wt,{},d).join(","),Ht="map"===x.get("text-rotation-alignment")&&"point"!==x.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Zl.vertical)>=0;for(const Gt of yt.sections)if(Gt.image)G[Gt.image.name]=!0;else{const Qt=Ih(yt.toString()),cn=Gt.fontStack||At,Vt=Q[cn]=Q[cn]||{};this.calculateGlyphDependencies(Gt.text,Vt,Ht,this.allowVerticalPlacement,Qt)}}}"line"===x.get("symbol-placement")&&(this.features=function(Ne){const H={},Fe={},Ze=[];let We=0;function wt(At){Ze.push(Ne[At]),We++}function yt(At,Ht,Gt){const Qt=Fe[At];return delete Fe[At],Fe[Ht]=Qt,Ze[Qt].geometry[0].pop(),Ze[Qt].geometry[0]=Ze[Qt].geometry[0].concat(Gt[0]),Qt}function Bt(At,Ht,Gt){const Qt=H[Ht];return delete H[Ht],H[At]=Qt,Ze[Qt].geometry[0].shift(),Ze[Qt].geometry[0]=Gt[0].concat(Ze[Qt].geometry[0]),Qt}function ln(At,Ht,Gt){const Qt=Gt?Ht[0][Ht[0].length-1]:Ht[0][0];return`${At}:${Qt.x}:${Qt.y}`}for(let At=0;At<Ne.length;At++){const Ht=Ne[At],Gt=Ht.geometry,Qt=Ht.text?Ht.text.toString():null;if(!Qt){wt(At);continue}const cn=ln(Qt,Gt),Vt=ln(Qt,Gt,!0);if(cn in Fe&&Vt in H&&Fe[cn]!==H[Vt]){const Cn=Bt(cn,Vt,Gt),Vn=yt(cn,Vt,Ze[Cn].geometry);delete H[cn],delete Fe[Vt],Fe[ln(Qt,Ze[Vn].geometry,!0)]=Vn,Ze[Cn].geometry=null}else cn in Fe?yt(cn,Vt,Gt):Vt in H?Bt(cn,Vt,Gt):(wt(At),H[cn]=We-1,Fe[Vt]=We-1)}return Ze.filter(At=>At.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ne,H)=>Ne.sortKey-H.sortKey)}update(s,c,d,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(s,c,this.layers,d,m),this.icon.programConfigurations.updatePaintArrays(s,c,this.layers,d,m))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=uC(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,c){const d=this.lineVertexArray.length;if(void 0!==s.segment)for(const{x:m,y}of c)this.lineVertexArray.emplaceBack(m,y);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(s,c,d,m,y,x,E,T,M,F,B,V,j,G){const Q=s.indexArray,re=s.layoutVertexArray,X=s.globeExtVertexArray,Ne=s.segments.prepareSegment(4*c.length,re,Q,this.canOverlap?x.sortKey:void 0),H=this.glyphOffsetArray.length,Fe=Ne.vertexLength,Ze=this.allowVerticalPlacement&&E===Zl.vertical?Math.PI/2:0,We=x.text&&x.text.sections;for(let yt=0;yt<c.length;yt++){const{tl:Bt,tr:ln,bl:At,br:Ht,tex:Gt,pixelOffsetTL:Qt,pixelOffsetBR:cn,minFontScaleX:Vt,minFontScaleY:Cn,glyphOffset:Vn,isSDF:An,sectionIndex:Pi}=c[yt],mn=Ne.vertexLength,ni=Vn[1];if(gp(re,M.x,M.y,Bt.x,ni+Bt.y,Gt.x,Gt.y,d,An,Qt.x,Qt.y,Vt,Cn),gp(re,M.x,M.y,ln.x,ni+ln.y,Gt.x+Gt.w,Gt.y,d,An,cn.x,Qt.y,Vt,Cn),gp(re,M.x,M.y,At.x,ni+At.y,Gt.x,Gt.y+Gt.h,d,An,Qt.x,cn.y,Vt,Cn),gp(re,M.x,M.y,Ht.x,ni+Ht.y,Gt.x+Gt.w,Gt.y+Gt.h,d,An,cn.x,cn.y,Vt,Cn),T){const{x:ki,y:cr,z:Di}=T.anchor,[di,Yr,ci]=T.up;yy(X,ki,cr,Di,di,Yr,ci),yy(X,ki,cr,Di,di,Yr,ci),yy(X,ki,cr,Di,di,Yr,ci),yy(X,ki,cr,Di,di,Yr,ci),__(s.dynamicLayoutVertexArray,ki,cr,Di,Ze)}else __(s.dynamicLayoutVertexArray,M.x,M.y,M.z,Ze);Q.emplaceBack(mn,mn+1,mn+2),Q.emplaceBack(mn+1,mn+2,mn+3),Ne.vertexLength+=4,Ne.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Vn[0]),yt!==c.length-1&&Pi===c[yt+1].sectionIndex||s.programConfigurations.populatePaintArrays(re.length,x,x.index,{},j,G,We&&We[Pi])}const wt=T?T.anchor:M;s.placedSymbolArray.emplaceBack(wt.x,wt.y,wt.z,M.x,M.y,H,this.glyphOffsetArray.length-H,Fe,F,B,M.segment,d?d[0]:0,d?d[1]:0,m[0],m[1],E,0,!1,0,V,0)}_commitLayoutVertex(s,c,d,m,y,x,E){s.emplaceBack(c,d,m,y,x,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(s,c,d,m,y,x,E){const T=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),M=T.vertexLength,F=E.tileAnchorX,B=E.tileAnchorY;for(let j=0;j<4;j++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(c,-s.padding,-s.padding),d.collisionVertexArrayExt.emplaceBack(c,s.padding,-s.padding),d.collisionVertexArrayExt.emplaceBack(c,s.padding,s.padding),d.collisionVertexArrayExt.emplaceBack(c,-s.padding,s.padding),this._commitLayoutVertex(d.layoutVertexArray,m,y,x,F,B,new ze(s.x1,s.y1)),this._commitLayoutVertex(d.layoutVertexArray,m,y,x,F,B,new ze(s.x2,s.y1)),this._commitLayoutVertex(d.layoutVertexArray,m,y,x,F,B,new ze(s.x2,s.y2)),this._commitLayoutVertex(d.layoutVertexArray,m,y,x,F,B,new ze(s.x1,s.y2)),T.vertexLength+=4;const V=d.indexArray;V.emplaceBack(M,M+1),V.emplaceBack(M+1,M+2),V.emplaceBack(M+2,M+3),V.emplaceBack(M+3,M),T.primitiveLength+=4}_addTextDebugCollisionBoxes(s,c,d,m,y,x){for(let E=m;E<y;E++){const T=d.get(E),M=this.getSymbolInstanceTextSize(s,x,c,E);this._addCollisionDebugVertices(T,M,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(s,c,d,m,y,x){for(let E=m;E<y;E++){const T=d.get(E),M=this.getSymbolInstanceIconSize(s,c,x.placedIconSymbolIndex);this._addCollisionDebugVertices(T,M,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,x)}}generateCollisionDebugBuffers(s,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new hC(Ln,jE.members,qt),this.iconCollisionBox=new hC(Ln,jE.members,qt);const d=Em(this.iconSizeData,s),m=Em(this.textSizeData,s);for(let y=0;y<this.symbolInstances.length;y++){const x=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(m,s,c,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(m,s,c,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(d,s,c,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(d,s,c,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(s,c,d,m){const y=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:m),x=ny(this.textSizeData,s,y)/$r;return this.tilePixelRatio*x}getSymbolInstanceIconSize(s,c,d){const m=this.icon.placedSymbolArray.get(d),y=ny(this.iconSizeData,s,m);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(s,c,d){s.emplaceBack(c,-d,-d),s.emplaceBack(c,d,-d),s.emplaceBack(c,d,d),s.emplaceBack(c,-d,d)}_updateTextDebugCollisionBoxes(s,c,d,m,y,x){for(let E=m;E<y;E++){const T=d.get(E),M=this.getSymbolInstanceTextSize(s,x,c,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,T.padding)}}_updateIconDebugCollisionBoxes(s,c,d,m,y,x){for(let E=m;E<y;E++){const T=d.get(E),M=this.getSymbolInstanceIconSize(s,c,x);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,T.padding)}}updateCollisionDebugBuffers(s,c){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=Em(this.iconSizeData,s),m=Em(this.textSizeData,s);for(let y=0;y<this.symbolInstances.length;y++){const x=this.symbolInstances.get(y);this._updateTextDebugCollisionBoxes(m,s,c,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(m,s,c,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(d,s,c,x.iconBoxStartIndex,x.iconBoxEndIndex,x.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,s,c,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,c,d,m,y,x,E,T,M){const F={};if(c<d){const{x1:B,y1:V,x2:j,y2:G,padding:Q,projectedAnchorX:re,projectedAnchorY:X,projectedAnchorZ:Ne,tileAnchorX:H,tileAnchorY:Fe,featureIndex:Ze}=s.get(c);F.textBox={x1:B,y1:V,x2:j,y2:G,padding:Q,projectedAnchorX:re,projectedAnchorY:X,projectedAnchorZ:Ne,tileAnchorX:H,tileAnchorY:Fe},F.textFeatureIndex=Ze}if(m<y){const{x1:B,y1:V,x2:j,y2:G,padding:Q,projectedAnchorX:re,projectedAnchorY:X,projectedAnchorZ:Ne,tileAnchorX:H,tileAnchorY:Fe,featureIndex:Ze}=s.get(m);F.verticalTextBox={x1:B,y1:V,x2:j,y2:G,padding:Q,projectedAnchorX:re,projectedAnchorY:X,projectedAnchorZ:Ne,tileAnchorX:H,tileAnchorY:Fe},F.verticalTextFeatureIndex=Ze}if(x<E){const{x1:B,y1:V,x2:j,y2:G,padding:Q,projectedAnchorX:re,projectedAnchorY:X,projectedAnchorZ:Ne,tileAnchorX:H,tileAnchorY:Fe,featureIndex:Ze}=s.get(x);F.iconBox={x1:B,y1:V,x2:j,y2:G,padding:Q,projectedAnchorX:re,projectedAnchorY:X,projectedAnchorZ:Ne,tileAnchorX:H,tileAnchorY:Fe},F.iconFeatureIndex=Ze}if(T<M){const{x1:B,y1:V,x2:j,y2:G,padding:Q,projectedAnchorX:re,projectedAnchorY:X,projectedAnchorZ:Ne,tileAnchorX:H,tileAnchorY:Fe,featureIndex:Ze}=s.get(T);F.verticalIconBox={x1:B,y1:V,x2:j,y2:G,padding:Q,projectedAnchorX:re,projectedAnchorY:X,projectedAnchorZ:Ne,tileAnchorX:H,tileAnchorY:Fe},F.verticalIconFeatureIndex=Ze}return F}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const d=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(s,c){const d=s.placedSymbolArray.get(c),m=d.vertexStartIndex+4*d.numGlyphs;for(let y=d.vertexStartIndex;y<m;y+=4)s.indexArray.emplaceBack(y,y+1,y+2),s.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const c=Math.sin(s),d=Math.cos(s),m=[],y=[],x=[];for(let E=0;E<this.symbolInstances.length;++E){x.push(E);const T=this.symbolInstances.get(E);m.push(0|Math.round(c*T.tileAnchorX+d*T.tileAnchorY)),y.push(T.featureIndex)}return x.sort((E,T)=>m[E]-m[T]||y[T]-y[E]),x}addToSortKeyRanges(s,c){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===c?d.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const d=this.symbolInstances.get(c);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:y,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:M}=d;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),y>=0&&y!==m&&this.addIndicesForPlacedSymbol(this.text,y),x>=0&&x!==y&&x!==m&&this.addIndicesForPlacedSymbol(this.text,x),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Fn(tf,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),tf.MAX_GLYPHS=65535,tf.addDynamicAttributes=__;const Pm=new Se({"symbol-placement":new K(Nt.layout_symbol["symbol-placement"]),"symbol-spacing":new K(Nt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new K(Nt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new de(Nt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new K(Nt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new K(Nt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new K(Nt.layout_symbol["icon-ignore-placement"]),"icon-optional":new K(Nt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new K(Nt.layout_symbol["icon-rotation-alignment"]),"icon-size":new de(Nt.layout_symbol["icon-size"]),"icon-text-fit":new K(Nt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new K(Nt.layout_symbol["icon-text-fit-padding"]),"icon-image":new de(Nt.layout_symbol["icon-image"]),"icon-rotate":new de(Nt.layout_symbol["icon-rotate"]),"icon-padding":new K(Nt.layout_symbol["icon-padding"]),"icon-keep-upright":new K(Nt.layout_symbol["icon-keep-upright"]),"icon-offset":new de(Nt.layout_symbol["icon-offset"]),"icon-anchor":new de(Nt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new K(Nt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new K(Nt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new K(Nt.layout_symbol["text-rotation-alignment"]),"text-field":new de(Nt.layout_symbol["text-field"]),"text-font":new de(Nt.layout_symbol["text-font"]),"text-size":new de(Nt.layout_symbol["text-size"]),"text-max-width":new de(Nt.layout_symbol["text-max-width"]),"text-line-height":new de(Nt.layout_symbol["text-line-height"]),"text-letter-spacing":new de(Nt.layout_symbol["text-letter-spacing"]),"text-justify":new de(Nt.layout_symbol["text-justify"]),"text-radial-offset":new de(Nt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new K(Nt.layout_symbol["text-variable-anchor"]),"text-anchor":new de(Nt.layout_symbol["text-anchor"]),"text-max-angle":new K(Nt.layout_symbol["text-max-angle"]),"text-writing-mode":new K(Nt.layout_symbol["text-writing-mode"]),"text-rotate":new de(Nt.layout_symbol["text-rotate"]),"text-padding":new K(Nt.layout_symbol["text-padding"]),"text-keep-upright":new K(Nt.layout_symbol["text-keep-upright"]),"text-transform":new de(Nt.layout_symbol["text-transform"]),"text-offset":new de(Nt.layout_symbol["text-offset"]),"text-allow-overlap":new K(Nt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new K(Nt.layout_symbol["text-ignore-placement"]),"text-optional":new K(Nt.layout_symbol["text-optional"])});var xb={paint:new Se({"icon-opacity":new de(Nt.paint_symbol["icon-opacity"]),"icon-color":new de(Nt.paint_symbol["icon-color"]),"icon-halo-color":new de(Nt.paint_symbol["icon-halo-color"]),"icon-halo-width":new de(Nt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new de(Nt.paint_symbol["icon-halo-blur"]),"icon-translate":new K(Nt.paint_symbol["icon-translate"]),"icon-translate-anchor":new K(Nt.paint_symbol["icon-translate-anchor"]),"text-opacity":new de(Nt.paint_symbol["text-opacity"]),"text-color":new de(Nt.paint_symbol["text-color"],{runtimeType:Ys,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new de(Nt.paint_symbol["text-halo-color"]),"text-halo-width":new de(Nt.paint_symbol["text-halo-width"]),"text-halo-blur":new de(Nt.paint_symbol["text-halo-blur"]),"text-translate":new K(Nt.paint_symbol["text-translate"]),"text-translate-anchor":new K(Nt.paint_symbol["text-translate-anchor"])}),layout:Pm};class _p{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:hd,this.defaultValue=s}evaluate(s){if(s.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(s.formattedSection))return c.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Fn(_p,"FormatSectionOverride",{omit:["defaultValue"]});class fr extends ka{constructor(s){super(s,xb)}recalculate(s,c){super.recalculate(s,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const m=[];for(const y of d)m.indexOf(y)<0&&m.push(y);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(s,c,d,m){const y=this.layout.get(s).evaluate(c,{},d,m),x=this._unevaluatedLayout._values[s];return x.isDataDriven()||ml(x.value)||!y?y:(E=c.properties,y.replace(/{([^{}]+)}/g,(M,F)=>F in E?String(E[F]):""));var E}createBucket(s){return new tf(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of xb.paint.overridableProperties){if(!fr.hasPaintOverride(this.layout,s))continue;const c=this.paint.get(s),d=new _p(c),m=new jl(d,c.property.specification);let y=null;y="constant"===c.value.kind||"source"===c.value.kind?new kg("source",m):new xs("composite",m,c.value.zoomStops,c.value._interpolationType),this.paint._values[s]=new ve(c.property,y,c.parameters)}}_handleOverridablePaintPropertyUpdate(s,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&fr.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,c){const d=s.get("text-field"),m=xb.paint.properties[c];let y=!1;const x=E=>{for(const T of E)if(m.overrides&&m.overrides.hasOverride(T))return void(y=!0)};if("constant"===d.value.kind&&d.value.value instanceof Ur)x(d.value.value.sections);else if("source"===d.value.kind){const E=M=>{y||(M instanceof Za&&wo(M.value)===rh?x(M.value.sections):M instanceof $c?x(M.sections):M.eachChild(E))},T=d.value;T._styleExpression&&E(T._styleExpression.expression)}return y}getProgramConfiguration(s){return new Gu(this,s)}}var lS={paint:new Se({"background-color":new K(Nt.paint_background["background-color"]),"background-pattern":new K(Nt.paint_background["background-pattern"]),"background-opacity":new K(Nt.paint_background["background-opacity"])})},y_={paint:new Se({"raster-opacity":new K(Nt.paint_raster["raster-opacity"]),"raster-hue-rotate":new K(Nt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new K(Nt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new K(Nt.paint_raster["raster-brightness-max"]),"raster-saturation":new K(Nt.paint_raster["raster-saturation"]),"raster-contrast":new K(Nt.paint_raster["raster-contrast"]),"raster-resampling":new K(Nt.paint_raster["raster-resampling"]),"raster-fade-duration":new K(Nt.paint_raster["raster-fade-duration"])})};class Hd extends ka{constructor(s){super(s,{}),this.implementation=s}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}var cS={paint:new Se({"sky-type":new K(Nt.paint_sky["sky-type"]),"sky-atmosphere-sun":new K(Nt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new K(Nt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new K(Nt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new K(Nt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ae(Nt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new K(Nt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new K(Nt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new K(Nt.paint_sky["sky-opacity"])})};function bb(a,s,c){const d=[0,0,1],m=Qf([]);return Gg(m,m,c?-xt(a)+Math.PI:xt(a)),Bd(m,m,-xt(s)),mi(d,d,m),nt(d,d)}const nf={circle:class extends ka{constructor(a){super(a,yF)}createBucket(a){return new Sx(a)}queryRadius(a){const s=a;return Yg("circle-radius",this,s)+Yg("circle-stroke-width",this,s)+Rx(this.paint.get("circle-translate"))}queryIntersectsFeature(a,s,c,d,m,y,x,E){const T=EA(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,a.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(s,c)+this.paint.get("circle-stroke-width").evaluate(s,c);return CA(a,d,y,x,E,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),T,M)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new Gu(this,a)}},heatmap:class extends ka{createBucket(a){return new Ox(a)}constructor(a){super(a,B0),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"heatmap-color"===a&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_m({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return Yg("heatmap-radius",this,a)}queryIntersectsFeature(a,s,c,d,m,y,x,E){const T=this.paint.get("heatmap-radius").evaluate(s,c);return CA(a,d,y,x,E,!0,!0,new ze(0,0),T)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new Gu(this,a)}},hillshade:class extends ka{constructor(a){super(a,Zh)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends ka{constructor(a){super(a,$0)}getProgramIds(){const a=this.paint.get("fill-pattern"),s=a&&a.constantOr(1),c=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getProgramConfiguration(a){return new Gu(this,a)}recalculate(a,s){super.recalculate(a,s);const c=this.paint._values["fill-outline-color"];"constant"===c.value.kind&&void 0===c.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new a_(a)}queryRadius(){return Rx(this.paint.get("fill-translate"))}queryIntersectsFeature(a,s,c,d,m,y){return!a.queryGeometry.isAboveHorizon&&Kg(F0(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,a.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends ka{constructor(a){super(a,NA)}createBucket(a){return new op(a)}queryRadius(){return Rx(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new Gu(this,a)}queryIntersectsFeature(a,s,c,d,m,y,x,E,T){const M=EA(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,a.pixelToTileUnitsFactor),F=this.paint.get("fill-extrusion-height").evaluate(s,c),B=this.paint.get("fill-extrusion-base").evaluate(s,c),V=[0,0],j=E&&y.elevation,G=y.elevation?y.elevation.exaggeration():1,Q=a.tile.getBucket(this);if(j&&Q instanceof op){const Fe=Q.centroidVertexArray,Ze=T+1;Ze<Fe.length&&(V[0]=Fe.geta_centroid_pos0(Ze),V[1]=Fe.geta_centroid_pos1(Ze))}if(0===V[0]&&1===V[1])return!1;"globe"===y.projection.name&&(d=X0([d],[new ze(0,0),new ze(ei,ei)],a.tileID.canonical).map(Fe=>Fe.polygon).flat());const re=j?E:null,[X,Ne]=(Ze=d,We=B,wt=F,yt=M,Bt=x,ln=re,At=V,Ht=G,Gt=y.center.lat,"globe"===(Fe=y).projection.name?function(cn,Vt,Cn,Vn,An,Pi,mn,ni,ki,cr,Di){const di=[],Yr=[],ci=cn.projection.upVectorScale(Di,cn.center.lat,cn.worldSize).metersToTile,Fi=[0,0,0,1],Lr=[0,0,0,1],Xr=(kr,_o,ko,Zo)=>{kr[0]=_o,kr[1]=ko,kr[2]=Zo,kr[3]=1},Pr=Yx();Cn>0&&(Cn+=Pr),Vn+=Pr;for(const kr of Vt){const _o=[],ko=[];for(const Zo of kr){const Rr=Zo.x+An.x,gs=Zo.y+An.y,Ko=cn.projection.projectTilePoint(Rr,gs,Di),uo=cn.projection.upVector(Di,Zo.x,Zo.y);let _r=Cn,Yo=Vn;if(mn){const Gr=ap(Rr,gs,Cn,Vn,mn,ni,ki,cr);_r+=Gr.base,Yo+=Gr.top}0!==Cn?Xr(Fi,Ko.x+uo[0]*ci*_r,Ko.y+uo[1]*ci*_r,Ko.z+uo[2]*ci*_r):Xr(Fi,Ko.x,Ko.y,Ko.z),Xr(Lr,Ko.x+uo[0]*ci*Yo,Ko.y+uo[1]*ci*Yo,Ko.z+uo[2]*ci*Yo),Dn(Fi,Fi,Pi),Dn(Lr,Lr,Pi),_o.push(new sp(Fi[0],Fi[1],Fi[2])),ko.push(new sp(Lr[0],Lr[1],Lr[2]))}di.push(_o),Yr.push(ko)}return[di,Yr]}(Fe,Ze,We,wt,yt,Bt,ln,At,Ht,Gt,a.tileID.canonical):ln?function(cn,Vt,Cn,Vn,An,Pi,mn,ni,ki){const cr=[],Di=[],di=[0,0,0,1];for(const Yr of cn){const ci=[],Fi=[];for(const Lr of Yr){const Xr=Lr.x+Vn.x,Pr=Lr.y+Vn.y,kr=ap(Xr,Pr,Vt,Cn,Pi,mn,ni,ki);di[0]=Xr,di[1]=Pr,di[2]=kr.base,di[3]=1,Zu(di,di,An),di[3]=Math.max(di[3],1e-5);const _o=new sp(di[0]/di[3],di[1]/di[3],di[2]/di[3]);di[0]=Xr,di[1]=Pr,di[2]=kr.top,di[3]=1,Zu(di,di,An),di[3]=Math.max(di[3],1e-5);const ko=new sp(di[0]/di[3],di[1]/di[3],di[2]/di[3]);ci.push(_o),Fi.push(ko)}cr.push(ci),Di.push(Fi)}return[cr,Di]}(Ze,We,wt,yt,Bt,ln,At,Ht,Gt):function(cn,Vt,Cn,Vn,An){const Pi=[],mn=[],ni=An[8]*Vt,ki=An[9]*Vt,cr=An[10]*Vt,Di=An[11]*Vt,di=An[8]*Cn,Yr=An[9]*Cn,ci=An[10]*Cn,Fi=An[11]*Cn;for(const Lr of cn){const Xr=[],Pr=[];for(const kr of Lr){const _o=kr.x+Vn.x,ko=kr.y+Vn.y,Zo=An[0]*_o+An[4]*ko+An[12],Rr=An[1]*_o+An[5]*ko+An[13],gs=An[2]*_o+An[6]*ko+An[14],Ko=An[3]*_o+An[7]*ko+An[15],uo=Zo+ni,_r=Rr+ki,Yo=gs+cr,Gr=Math.max(Ko+Di,1e-5),Fa=Zo+di,Xo=Rr+Yr,ho=gs+ci,_s=Math.max(Ko+Fi,1e-5);Xr.push(new sp(uo/Gr,_r/Gr,Yo/Gr)),Pr.push(new sp(Fa/_s,Xo/_s,ho/_s))}Pi.push(Xr),mn.push(Pr)}return[Pi,mn]}(Ze,We,wt,yt,Bt)),H=a.queryGeometry;var Fe,Ze,We,wt,yt,Bt,ln,At,Ht,Gt;return function(Fe,Ze,We){let wt=1/0;Kg(We,Ze)&&(wt=J0(We,Ze[0]));for(let yt=0;yt<Ze.length;yt++){const Bt=Ze[yt],ln=Fe[yt];for(let At=0;At<Bt.length-1;At++){const Ht=Bt[At],Gt=[Ht,Bt[At+1],ln[At+1],ln[At],Ht];CE(We,Gt)&&(wt=Math.min(wt,J0(We,Gt)))}}return wt!==1/0&&wt}(X,Ne,H.isPointQuery()?H.screenBounds:H.screenGeometry)}},line:class extends ka{constructor(a){super(a,ty),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if("line-gradient"===a){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof ku,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,s){super.recalculate(a,s),this.paint._values["line-floorwidth"]=Jx.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Ud(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new Gu(this,a)}queryRadius(a){const s=a,c=eb(Yg("line-width",this,s),Yg("line-gap-width",this,s)),d=Yg("line-offset",this,s);return c/2+Math.abs(d)+Rx(this.paint.get("line-translate"))}queryIntersectsFeature(a,s,c,d,m,y){if(a.queryGeometry.isAboveHorizon)return!1;const x=F0(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,a.pixelToTileUnitsFactor),E=a.pixelToTileUnitsFactor/2*eb(this.paint.get("line-width").evaluate(s,c),this.paint.get("line-gap-width").evaluate(s,c)),T=this.paint.get("line-offset").evaluate(s,c);return T&&(d=function(M,F){const B=[],V=new ze(0,0);for(let j=0;j<M.length;j++){const G=M[j],Q=[];for(let re=0;re<G.length;re++){const X=G[re],Ne=G[re+1],H=0===re?V:X.sub(G[re-1])._unit()._perp(),Fe=re===G.length-1?V:Ne.sub(X)._unit()._perp(),Ze=H._add(Fe)._unit();Ze._mult(1/(Ze.x*Fe.x+Ze.y*Fe.y)),Q.push(Ze._mult(F)._add(X))}B.push(Q)}return B}(d,T*a.pixelToTileUnitsFactor)),function(M,F,B){for(let V=0;V<F.length;V++){const j=F[V];if(M.length>=3)for(let G=0;G<j.length;G++)if(np(M,j[G]))return!0;if(IE(M,j,B))return!0}return!1}(x,d,E)}isTileClipped(){return!0}},symbol:fr,background:class extends ka{constructor(a){super(a,lS)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends ka{constructor(a){super(a,y_)}getProgramIds(){return["raster"]}},sky:class extends ka{constructor(a){super(a,cS),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"sky-gradient"===a?this._updateColorRamp():"sky-atmosphere-sun"!==a&&"sky-atmosphere-halo-color"!==a&&"sky-atmosphere-color"!==a&&"sky-atmosphere-sun-intensity"!==a||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=_m({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(a,s){if("atmosphere"===this.paint.get("sky-type")){const d=this.paint.get("sky-atmosphere-sun"),m=!d,y=a.style.light,x=y.properties.get("position");return m&&"viewport"===y.properties.get("anchor")&&ti("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?bb(x.azimuthal,90-x.polar,s):bb(d[0],90-d[1],s)}const c=this.paint.get("sky-gradient-center");return bb(c[0],90-c[1],s)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return"atmosphere"===a?["skyboxCapture","skybox"]:"gradient"===a?["skyboxGradient"]:null}}};class yp{constructor(s,c,d,m){this.context=s,this.format=d,this.texture=s.gl.createTexture(),this.update(c,m)}update(s,c,d){const{width:m,height:y}=s,{context:x}=this,{gl:E}=x,{HTMLImageElement:T,HTMLCanvasElement:M,HTMLVideoElement:F,ImageData:B,ImageBitmap:V}=Me;if(E.bindTexture(E.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!c||!1!==c.premultiply)),d||this.size&&this.size[0]===m&&this.size[1]===y){const{x:j,y:G}=d||{x:0,y:0};s instanceof T||s instanceof M||s instanceof F||s instanceof B||V&&s instanceof V?E.texSubImage2D(E.TEXTURE_2D,0,j,G,E.RGBA,E.UNSIGNED_BYTE,s):E.texSubImage2D(E.TEXTURE_2D,0,j,G,m,y,E.RGBA,E.UNSIGNED_BYTE,s.data)}else this.size=[m,y],s instanceof T||s instanceof M||s instanceof F||s instanceof B||V&&s instanceof V?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,s):E.texImage2D(E.TEXTURE_2D,0,this.format,m,y,0,this.format,E.UNSIGNED_BYTE,s.data);this.useMipmap=!!(c&&c.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&E.generateMipmap(E.TEXTURE_2D)}bind(s,c){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),s!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?s===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:s),this.filter=s),c!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class wb{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class DF{constructor(){this.tasks={},this.taskQueue=[],_n(["process"],this),this.invoker=new wb(this.process),this.nextId=0}add(s,c){const d=this.nextId++,m=function({type:y,isSymbolTile:x,zoom:E}){return E=E||0,"message"===y?0:"maybePrepare"!==y||x?"parseTile"!==y||x?"parseTile"===y&&x?300-E:"maybePrepare"===y&&x?400-E:500:200-E:100-E}(c);if(0===m){pr();try{s()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:s,metadata:c,priority:m,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){pr();try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const s=this.pick();if(null===s)return;const c=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let s=null,c=1/0;for(let m=0;m<this.taskQueue.length;m++){const y=this.tasks[this.taskQueue[m]];y.priority<c&&(c=y.priority,s=m)}if(null===s)return null;const d=this.taskQueue[s];return this.taskQueue.splice(s,1),d}remove(){this.invoker.remove()}}class xy{constructor(s){this._stringToNumber={},this._numberToString=[];for(let c=0;c<s.length;c++){const d=s[c];this._stringToNumber[d]=c,this._numberToString[c]=d}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const fC=["tile","layer","source","sourceLayer","state"];class pC{constructor(s,c,d,m,y){this.type="Feature",this._vectorTileFeature=s,this._z=c,this._x=d,this._y=m,this.properties=s.properties,this.id=y}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(s.id=this.id);for(const c of fC)void 0!==this[c]&&(s[c]=this[c]);return s}}const rf=new Uint16Array(8184);for(let a=0;a<2046;a++){let s=a+2,c=0,d=0,m=0,y=0,x=0,E=0;for(1&s?m=y=x=32:c=d=E=32;(s>>=1)>1;){const M=c+m>>1,F=d+y>>1;1&s?(m=c,y=d,c=x,d=E):(c=m,d=y,m=x,y=E),x=M,E=F}const T=4*a;rf[T+0]=c,rf[T+1]=d,rf[T+2]=m,rf[T+3]=y}const du=new Uint16Array(2178),sf=new Uint8Array(1089),by=new Uint16Array(1089);function uS(a){return 0===a?-.03125:32===a?.03125:0}var Eb=st([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Cb={type:2,extent:ei,loadGeometry:()=>[[new ze(0,0),new ze(ei+1,0),new ze(ei+1,ei+1),new ze(0,ei+1),new ze(0,0)]]};class Hr{constructor(s,c,d,m,y){this.tileID=s,this.uid=Oe(),this.uses=0,this.tileSize=c,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=y,this.expiredRequestCount=0,this.state="loading",m&&m.transform&&(this.projection=m.transform.projection)}registerFadeDuration(s){const c=s+this.timeAdded;c<xr.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=cu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,c,d){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=function(m,y){const x={};if(!y)return x;for(const E of m){const T=E.layerIds.map(M=>y.getLayer(M)).filter(Boolean);if(0!==T.length){E.layers=T,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(M=>T.filter(F=>F.id===M)[0]));for(const M of T)x[M.id]=E}}return x}(s.buckets,c.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const y=this.buckets[m];if(y instanceof tf){if(this.hasSymbolBuckets=!0,!d)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const y=this.buckets[m];if(y instanceof tf&&y.hasRTLText){this.hasRTLText=!0,k.isLoading()||k.isLoaded()||"deferred"!==I()||P();break}}this.queryPadding=0;for(const m in this.buckets){const y=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(m).queryRadius(y))}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas)}else this.collisionBoxArray=new Ti}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(s){return this.buckets[s.id]}upload(s){for(const d in this.buckets){const m=this.buckets[d];m.uploadPending()&&m.upload(s)}const c=s.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new yp(s,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new yp(s,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new yp(s,this.lineAtlas.image,c.ALPHA),this.lineAtlas.uploaded=!0)}prepare(s){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture)}queryRenderedFeatures(s,c,d,m,y,x,E,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:m,pixelPosMatrix:E,transform:x,params:y,tileTransform:this.tileTransform},s,c,d):{}}querySourceFeatures(s,c){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const m=d.loadVTLayers(),y=c?c.sourceLayer:"",x=m._geojsonTileLayer||m[y];if(!x)return;const E=Pd(c&&c.filter),{z:T,x:M,y:F}=this.tileID.canonical,B={z:T,x:M,y:F};for(let V=0;V<x.length;V++){const j=x.feature(V);if(E.needGeometry){const re=Wh(j,!0);if(!E.filter(new N(this.tileID.overscaledZ),re,this.tileID.canonical))continue}else if(!E.filter(new N(this.tileID.overscaledZ),j))continue;const G=d.getId(j,y),Q=new pC(j,T,M,F,G);Q.tile=B,s.push(Q)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const c=this.expirationTime;if(s.cacheControl){const d=dr(s.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const d=Date.now();let m=!1;if(this.expirationTime>d)m=!1;else if(c)if(this.expirationTime<c)m=!0;else{const y=this.expirationTime-c;y?this.expirationTime=d+Math.max(y,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(s,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(s).length||!c)return;const d=this.latestFeatureIndex.loadVTLayers(),m=c.style.listImages();for(const y in this.buckets){if(!c.style.hasLayer(y))continue;const x=this.buckets[y],E=x.layers[0].sourceLayer||"_geojsonTileLayer",T=d[E],M=s[E];if(!T||!M||0===Object.keys(M).length)continue;if(x.update(M,T,m,this.imageAtlas&&this.imageAtlas.patternPositions||{}),x instanceof Ud||x instanceof a_){const B=c.style._getSourceCache(x.layers[0].source);c._terrain&&c._terrain.enabled&&B&&x.programConfigurations.needsUpload&&c._terrain._clearRenderCacheForTile(B.id,this.tileID)}const F=c&&c.style&&c.style.getLayer(y);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(x)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<xr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=xr.now()+s}setTexture(s,c){const d=c.context,m=d.gl;this.texture=this.texture||c.getTileTexture(s.width),this.texture?this.texture.update(s,{useMipmap:!0}):(this.texture=new yp(d,s,m.RGBA,{useMipmap:!0}),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE))}setDependencies(s,c){const d={};for(const m of c)d[m]=!0;this.dependencies[s]=d}hasDependency(s,c){for(const d of s){const m=this.dependencies[d];if(m)for(const y of c)if(m[y])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,c){if(!c||"mercator"===c.name||this._tileDebugBuffer)return;const d=Gh(Cb,this.tileID.canonical,this.tileTransform)[0],m=new rn,y=new Mi;for(let x=0;x<d.length;x++){const{x:E,y:T}=d[x];m.emplaceBack(E,T),y.emplaceBack(x)}y.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(y),this._tileDebugBuffer=s.createVertexBuffer(m,Jf.members),this._tileDebugSegments=io.simpleSegment(0,0,m.length,y.length)}_makeTileBoundsBuffers(s,c){if(this._tileBoundsBuffer||!c||"mercator"===c.name)return;const d=Gh(Cb,this.tileID.canonical,this.tileTransform)[0];let m,y;if(this.isRaster){const x=function(E,T){const M=cu(E,T),F=Math.pow(2,E.z);for(let re=0;re<33;re++)for(let X=0;X<33;X++){const Ne=jr((E.x+(X+uS(X))/32)/F),H=ta((E.y+(re+uS(re))/32)/F),Fe=T.project(Ne,H),Ze=33*re+X;du[2*Ze+0]=Math.round((Fe.x*M.scale-M.x)*ei),du[2*Ze+1]=Math.round((Fe.y*M.scale-M.y)*ei)}sf.fill(0),by.fill(0);for(let re=2045;re>=0;re--){const X=4*re,Ne=rf[X+0],H=rf[X+1],Fe=rf[X+2],Ze=rf[X+3],We=Ne+Fe>>1,wt=H+Ze>>1,yt=We+wt-H,Bt=wt+Ne-We,ln=33*H+Ne,At=33*Ze+Fe,Ht=33*wt+We,Gt=Math.hypot((du[2*ln+0]+du[2*At+0])/2-du[2*Ht+0],(du[2*ln+1]+du[2*At+1])/2-du[2*Ht+1])>=16;sf[Ht]=sf[Ht]||(Gt?1:0),re<1022&&(sf[Ht]=sf[Ht]||sf[33*(H+Bt>>1)+(Ne+yt>>1)]||sf[33*(Ze+Bt>>1)+(Fe+yt>>1)])}const B=new zt,V=new Bn;let j=0;function G(re,X){const Ne=33*X+re;return 0===by[Ne]&&(B.emplaceBack(du[2*Ne+0],du[2*Ne+1],re*ei/32,X*ei/32),by[Ne]=++j),by[Ne]-1}function Q(re,X,Ne,H,Fe,Ze){const We=re+Ne>>1,wt=X+H>>1;if(Math.abs(re-Fe)+Math.abs(X-Ze)>1&&sf[33*wt+We])Q(Fe,Ze,re,X,We,wt),Q(Ne,H,Fe,Ze,We,wt);else{const yt=G(re,X),Bt=G(Ne,H),ln=G(Fe,Ze);V.emplaceBack(yt,Bt,ln)}}return Q(0,0,32,32,32,0),Q(32,32,0,0,0,32),{vertices:B,indices:V}}(this.tileID.canonical,c);m=x.vertices,y=x.indices}else{m=new zt,y=new Bn;for(const{x:E,y:T}of d)m.emplaceBack(E,T,0,0);const x=Ux(m.int16,void 0,4);for(let E=0;E<x.length;E+=3)y.emplaceBack(x[E],x[E+1],x[E+2])}this._tileBoundsBuffer=s.createVertexBuffer(m,Eb.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(y),this._tileBoundsSegments=io.simpleSegment(0,0,m.length,y.length)}_makeGlobeTileDebugBuffers(s,c){const d=c.projection;if(!d||"globe"!==d.name||c.freezeTileCoverage)return;const m=this.tileID.canonical,y=k0(Rs(m,c)),x=ea(c.zoom);let E;x>0&&(E=am(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,m,c,y,E,x),this._makeGlobeTileDebugTextBuffer(s,m,c,y,E,x)}_globePoint(s,c,d,m,y,x,E){let T=Vh(s,c,d);if(x){const M=1<<d.z,F=Ac(m.center.lng),B=ql(m.center.lat),V=(d.x+.5)/M-F;let j=0;V>.5?j=-1:V<-.5&&(j=1);let G=(s/ei+d.x)/M+j,Q=(c/ei+d.y)/M;G=(G-F)*m._pixelsPerMercatorPixel+F,Q=(Q-B)*m._pixelsPerMercatorPixel+B;const re=[G*m.worldSize,Q*m.worldSize,0];Dn(re,re,x),T=ep(T,re,E)}return Dn(T,T,y)}_makeGlobeTileDebugBorderBuffer(s,c,d,m,y,x){const E=new rn,T=new Mi,M=new _t,F=(V,j,G,Q,re)=>{const X=(G-V)/(re-1),Ne=(Q-j)/(re-1),H=E.length;for(let Fe=0;Fe<re;Fe++){const Ze=V+Fe*X,We=j+Fe*Ne;E.emplaceBack(Ze,We);const wt=this._globePoint(Ze,We,c,d,m,y,x);M.emplaceBack(wt[0],wt[1],wt[2]),T.emplaceBack(H+Fe)}},B=ei;F(0,0,B,0,16),F(B,0,B,B,16),F(B,B,0,B,16),F(0,B,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(T),this._tileDebugBuffer=s.createVertexBuffer(E,Jf.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(M,Oh.members),this._tileDebugSegments=io.simpleSegment(0,0,E.length,T.length)}_makeGlobeTileDebugTextBuffer(s,c,d,m,y,x){const E=ei/4,T=new rn,M=new Bn,F=new _t,B=25;M.reserve(32),T.reserve(B),F.reserve(B);const V=(j,G)=>B*j+G;for(let j=0;j<B;j++){const G=j*E;for(let Q=0;Q<B;Q++){const re=Q*E;T.emplaceBack(re,G);const X=this._globePoint(re,G,c,d,m,y,x);F.emplaceBack(X[0],X[1],X[2])}}for(let j=0;j<4;j++)for(let G=0;G<4;G++){const Q=V(j,G),re=V(j,G+1),X=V(j+1,G),Ne=V(j+1,G+1);M.emplaceBack(Q,re,X),M.emplaceBack(X,re,Ne)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(M),this._tileDebugTextBuffer=s.createVertexBuffer(T,Jf.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(F,Oh.members),this._tileDebugTextSegments=io.simpleSegment(0,0,B,32)}}class mC{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,c,d){const m=String(c);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][m]=this.stateChanges[s][m]||{},Pe(this.stateChanges[s][m],d),null===this.deletedStates[s]){this.deletedStates[s]={};for(const y in this.state[s])y!==m&&(this.deletedStates[s][y]=null)}else if(this.deletedStates[s]&&null===this.deletedStates[s][m]){this.deletedStates[s][m]={};for(const y in this.state[s][m])d[y]||(this.deletedStates[s][m][y]=null)}else for(const y in d)this.deletedStates[s]&&this.deletedStates[s][m]&&null===this.deletedStates[s][m][y]&&delete this.deletedStates[s][m][y]}removeFeatureState(s,c,d){if(null===this.deletedStates[s])return;const m=String(c);if(this.deletedStates[s]=this.deletedStates[s]||{},d&&void 0!==c)null!==this.deletedStates[s][m]&&(this.deletedStates[s][m]=this.deletedStates[s][m]||{},this.deletedStates[s][m][d]=null);else if(void 0!==c)if(this.stateChanges[s]&&this.stateChanges[s][m])for(d in this.deletedStates[s][m]={},this.stateChanges[s][m])this.deletedStates[s][m][d]=null;else this.deletedStates[s][m]=null;else this.deletedStates[s]=null}getState(s,c){const d=String(c),m=Pe({},(this.state[s]||{})[d],(this.stateChanges[s]||{})[d]);if(null===this.deletedStates[s])return{};if(this.deletedStates[s]){const y=this.deletedStates[s][c];if(null===y)return{};for(const x in y)delete m[x]}return m}initializeTileState(s,c){s.setFeatureState(this.state,c)}coalesceChanges(s,c){const d={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const y={};for(const x in this.stateChanges[m])this.state[m][x]||(this.state[m][x]={}),Pe(this.state[m][x],this.stateChanges[m][x]),y[x]=this.state[m][x];d[m]=y}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const y={};if(null===this.deletedStates[m])for(const x in this.state[m])y[x]={},this.state[m][x]={};else for(const x in this.deletedStates[m]){if(null===this.deletedStates[m][x])this.state[m][x]={};else if(this.state[m][x])for(const E of Object.keys(this.deletedStates[m][x]))delete this.state[m][x][E];y[x]=this.state[m][x]}d[m]=d[m]||{},Pe(d[m],y)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(d).length)for(const m in s)s[m].setFeatureState(d,c)}}class dS{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,c){const d=this.toIdx(s,c);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(s,c){return this.leaves[this.toIdx(s,c)]}toIdx(s,c){return c*this.size+s}}function wy(a,s,c,d){let m=0,y=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(d[x])<1e-15){if(c[x]<a[x]||c[x]>s[x])return null}else{const E=1/d[x];let T=(a[x]-c[x])*E,M=(s[x]-c[x])*E;if(T>M){const F=T;T=M,M=F}if(T>m&&(m=T),M<y&&(y=M),m>y)return null}return m}function Xl(a,s,c,d,m,y,x,E,T,M,F){const B=d-a,V=m-s,j=y-c,G=x-a,Q=E-s,re=T-c,X=F[1]*re-F[2]*Q,Ne=F[2]*G-F[0]*re,H=F[0]*Q-F[1]*G,Fe=B*X+V*Ne+j*H;if(Math.abs(Fe)<1e-15)return null;const Ze=1/Fe,We=M[0]-a,wt=M[1]-s,yt=M[2]-c,Bt=(We*X+wt*Ne+yt*H)*Ze;if(Bt<0||Bt>1)return null;const ln=wt*j-yt*V,At=yt*B-We*j,Ht=We*V-wt*B,Gt=(F[0]*ln+F[1]*At+F[2]*Ht)*Ze;return Gt<0||Bt+Gt>1?null:(G*ln+Q*At+re*Ht)*Ze}function Ey(a,s,c){return(a-s)/(c-s)}function gC(a,s,c,d,m,y,x,E,T){const M=1<<c,F=y-d,B=x-m,V=(a+1)/M*F+d,j=(s+0)/M*B+m,G=(s+1)/M*B+m;E[0]=(a+0)/M*F+d,E[1]=j,T[0]=V,T[1]=G}class hS{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(y){const x=Math.ceil(Math.log2(y.dim/8)),E=[];let T=Math.ceil(Math.pow(2,x));const M=1/T,F=(j,G,Q,re,X)=>{const Ne=re?1:0,H=(j+1)*Q-Ne,Fe=G*Q,Ze=(G+1)*Q-Ne;X[0]=j*Q,X[1]=Fe,X[2]=H,X[3]=Ze};let B=new dS(T);const V=[];for(let j=0;j<T*T;j++){F(j%T,Math.floor(j/T),M,!1,V);const G=ed(V[0],V[1],y),Q=ed(V[2],V[1],y),re=ed(V[2],V[3],y),X=ed(V[0],V[3],y);B.minimums.push(Math.min(G,Q,re,X)),B.maximums.push(Math.max(G,Q,re,X)),B.leaves.push(1)}for(E.push(B),T/=2;T>=1;T/=2){const j=E[E.length-1];B=new dS(T);for(let G=0;G<T*T;G++){F(G%T,Math.floor(G/T),2,!0,V);const Q=j.getElevation(V[0],V[1]),re=j.getElevation(V[2],V[1]),X=j.getElevation(V[2],V[3]),Ne=j.getElevation(V[0],V[3]),H=j.isLeaf(V[0],V[1]),Fe=j.isLeaf(V[2],V[1]),Ze=j.isLeaf(V[2],V[3]),We=j.isLeaf(V[0],V[3]),wt=Math.min(Q.min,re.min,X.min,Ne.min),yt=Math.max(Q.max,re.max,X.max,Ne.max),Bt=H&&Fe&&Ze&&We;B.maximums.push(yt),B.minimums.push(wt),B.leaves.push(yt-wt<=5&&Bt?1:0)}E.push(B)}return E}(this.dem),d=c.length-1,m=c[d];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(c,0,0,d,0)}raycastRoot(s,c,d,m,y,x,E=1){return wy([s,c,-100],[d,m,this.maximums[0]*E],y,x)}raycast(s,c,d,m,y,x,E=1){if(!this.nodeCount)return null;const T=this.raycastRoot(s,c,d,m,y,x,E);if(null==T)return null;const M=[],F=[],B=[],V=[],j=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;j.length>0;){const{idx:G,t:Q,nodex:re,nodey:X,depth:Ne}=j.pop();if(this.leaves[G]){gC(re,X,Ne,s,c,d,m,B,V);const Fe=1<<Ne,Ze=(re+0)/Fe,We=(re+1)/Fe,wt=(X+0)/Fe,yt=(X+1)/Fe,Bt=ed(Ze,wt,this.dem)*E,ln=ed(We,wt,this.dem)*E,At=ed(We,yt,this.dem)*E,Ht=ed(Ze,yt,this.dem)*E,Gt=Xl(B[0],B[1],Bt,V[0],B[1],ln,V[0],V[1],At,y,x),Qt=Xl(V[0],V[1],At,B[0],V[1],Ht,B[0],B[1],Bt,y,x),cn=Math.min(null!==Gt?Gt:Number.MAX_VALUE,null!==Qt?Qt:Number.MAX_VALUE);if(cn!==Number.MAX_VALUE)return cn;{const Vt=me([],y,x,Q);if(_C(Bt,ln,Ht,At,Ey(Vt[0],B[0],V[0]),Ey(Vt[1],B[1],V[1]))>=Vt[2])return Q}continue}let H=0;for(let Fe=0;Fe<this._siblingOffset.length;Fe++){gC((re<<1)+this._siblingOffset[Fe][0],(X<<1)+this._siblingOffset[Fe][1],Ne+1,s,c,d,m,B,V),B[2]=-100,V[2]=this.maximums[this.childOffsets[G]+Fe]*E;const Ze=wy(B,V,y,x);if(null!=Ze){const We=Ze;M[Fe]=We;let wt=!1;for(let yt=0;yt<H&&!wt;yt++)We>=M[F[yt]]&&(F.splice(yt,0,Fe),wt=!0);wt||(F[H]=Fe),H++}}for(let Fe=0;Fe<H;Fe++){const Ze=F[Fe];j.push({idx:this.childOffsets[G]+Ze,t:M[Ze],nodex:(re<<1)+this._siblingOffset[Ze][0],nodey:(X<<1)+this._siblingOffset[Ze][1],depth:Ne+1})}}return null}_addNode(s,c,d){return this.minimums.push(s),this.maximums.push(c),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(s,c,d,m,y){if(1===s[m].isLeaf(c,d))return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const x=m-1,E=s[x];let T=0,M=0;for(let F=0;F<this._siblingOffset.length;F++){const B=2*c+this._siblingOffset[F][0],V=2*d+this._siblingOffset[F][1],j=E.getElevation(B,V),G=E.isLeaf(B,V),Q=this._addNode(j.min,j.max,G);G&&(T|=1<<F),M||(M=Q)}for(let F=0;F<this._siblingOffset.length;F++)T&1<<F||this._construct(s,2*c+this._siblingOffset[F][0],2*d+this._siblingOffset[F][1],x,M+F)}}function _C(a,s,c,d,m,y){return tr(tr(a,c,y),tr(s,d,y),m)}function ed(a,s,c){const d=c.dim,m=Rt(a*d-.5,0,d-1),y=Rt(s*d-.5,0,d-1),x=Math.floor(m),E=Math.floor(y),T=Math.min(x+1,d-1),M=Math.min(E+1,d-1);return _C(c.get(x,E),c.get(T,E),c.get(x,M),c.get(T,M),m-x,y-E)}const ui={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function yC(a,s,c){return(256*a*256+256*s+c)/10-1e4}function fS(a,s,c){return 256*a+s+c/256-32768}class Ib{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,c,d,m=!1,y=!1){if(this.uid=s,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(d&&"mapbox"!==d&&"terrarium"!==d)return ti(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const x=this.dim=c.height-2,E=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.encoding=d||"mapbox",this.borderReady=m,!m){for(let T=0;T<x;T++)E[this._idx(-1,T)]=E[this._idx(0,T)],E[this._idx(x,T)]=E[this._idx(x-1,T)],E[this._idx(T,-1)]=E[this._idx(T,0)],E[this._idx(T,x)]=E[this._idx(T,x-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(x,-1)]=E[this._idx(x-1,0)],E[this._idx(-1,x)]=E[this._idx(0,x-1)],E[this._idx(x,x)]=E[this._idx(x-1,x-1)],y&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new hS(this)}get(s,c,d=!1){d&&(s=Rt(s,-1,this.dim),c=Rt(c,-1,this.dim));const m=4*this._idx(s,c);return("terrarium"===this.encoding?fS:yC)(this.pixels[m],this.pixels[m+1],this.pixels[m+2])}static getUnpackVector(s){return ui[s]}get unpackVector(){return ui[this.encoding]}_idx(s,c){if(s<-1||s>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(s+1)}static pack(s,c){const d=[0,0,0,0],m=Ib.getUnpackVector(c);let y=Math.floor((s+m[3])/m[2]);return d[2]=y%256,y=Math.floor(y/256),d[1]=y%256,y=Math.floor(y/256),d[0]=y,d}getPixels(){return new nl({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,c,d){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,y=c*this.dim+this.dim,x=d*this.dim,E=d*this.dim+this.dim;switch(c){case-1:m=y-1;break;case 1:y=m+1}switch(d){case-1:x=E-1;break;case 1:E=x+1}const T=-c*this.dim,M=-d*this.dim;for(let F=x;F<E;F++)for(let B=m;B<y;B++){const V=4*this._idx(B,F),j=4*this._idx(B+T,F+M);this.pixels[V+0]=s.pixels[j+0],this.pixels[V+1]=s.pixels[j+1],this.pixels[V+2]=s.pixels[j+2],this.pixels[V+3]=s.pixels[j+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Fn(Ib,"DEMData"),Fn(hS,"DemMinMaxQuadTree",{omit:["dem"]});class wi{constructor(s,c){this.max=s,this.onRemove=c,this.reset()}reset(){for(const s in this.data)for(const c of this.data[s])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(s,c,d){const m=s.wrapped().key;void 0===this.data[m]&&(this.data[m]=[]);const y={value:c,timeout:void 0};if(void 0!==d&&(y.timeout=setTimeout(()=>{this.remove(s,y)},d)),this.data[m].push(y),this.order.push(m),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),0===this.data[s].length&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value}getByKey(s){const c=this.data[s];return c?c[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,c){if(!this.has(s))return this;const d=s.wrapped().key,m=void 0===c?0:this.data[d].indexOf(c),y=this.data[d][m];return this.data[d].splice(m,1),y.timeout&&clearTimeout(y.timeout),0===this.data[d].length&&delete this.data[d],this.onRemove(y.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(s){const c=[];for(const d in this.data)for(const m of this.data[d])s(m.value)||c.push(m);for(const d of c)this.remove(d.value.tileID,d)}}class km{constructor(s,c,d){this.func=s,this.mask=c,this.range=d}}km.ReadOnly=!1,km.ReadWrite=!0,km.disabled=new km(519,km.ReadOnly,[0,1]);class Tb{constructor(s,c,d,m,y,x){this.test=s,this.ref=c,this.mask=d,this.fail=m,this.depthFail=y,this.pass=x}}Tb.disabled=new Tb({func:519,mask:0},0,0,7680,7680,7680);class td{constructor(s,c,d){this.blendFunction=s,this.blendColor=c,this.mask=d}}td.Replace=[1,0],td.disabled=new td(td.Replace,si.transparent,[!1,!1,!1,!1]),td.unblended=new td(td.Replace,si.transparent,[!0,!0,!0,!0]),td.alphaBlended=new td([1,771],si.transparent,[!0,!0,!0,!0]);class Pc{constructor(s,c,d){this.enable=s,this.mode=c,this.frontFace=d}}Pc.disabled=new Pc(!1,1029,2305),Pc.backCCW=new Pc(!0,1029,2305),Pc.backCW=new Pc(!0,1029,2304),Pc.frontCW=new Pc(!0,1028,2304),Pc.frontCCW=new Pc(!0,1028,2305);class vp extends zc{constructor(s,c,d){super(),this.id=s,this._onlySymbols=d,c.on("data",m=>{"source"===m.dataType&&"metadata"===m.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===m.dataType&&"content"===m.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new wi(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new mC,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(s){this.map=s,this._minTileCacheSize=void 0===this._minTileCacheSize&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const c=this._tiles[s];if("loaded"!==c.state&&"errored"!==c.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,c){return s.isSymbolTile=this._onlySymbols,this._source.loadTile(s,c)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s,()=>{})}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s,()=>{})}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const d=this._tiles[c];d.upload(s),d.prepare(this.map.style.imageManager)}}getIds(){return yi(this._tiles).map(s=>s.tileID).sort(Db).map(s=>s.key)}getRenderableIds(s){const c=[];for(const d in this._tiles)this._isIdRenderable(+d,s)&&c.push(this._tiles[d]);return s?c.sort((d,m)=>{const y=d.tileID,x=m.tileID,E=new ze(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),T=new ze(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-x.overscaledZ||T.y-E.y||T.x-E.x}).map(d=>d.tileID.key):c.map(d=>d.tileID).sort(Db).map(d=>d.key)}hasRenderableParent(s){const c=this.findLoadedParent(s,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(s,c){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(c||!this._tiles[s].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)"errored"!==this._tiles[s].state&&this._reloadTile(+s,"reloading")}}_reloadTile(s,c){const d=this._tiles[s];d&&("loading"!==d.state&&(d.state=c),this._loadTile(d,this._tileLoaded.bind(this,d,s,c)))}_tileLoaded(s,c,d,m){if(m)if(s.state="errored",404!==m.status)this._source.fire(new cc(m,{tile:s}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const y=this.map.painter.terrain;this.update(this.transform,y.getScaledDemTileSize(),!0),y.resetTileLookupCache(this.id)}else this.update(this.transform);else s.timeAdded=xr.now(),"expired"===d&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(c,s),"raster-dem"===this._source.type&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new Wa("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const c=this.getRenderableIds();for(let m=0;m<c.length;m++){const y=c[m];if(s.neighboringTiles&&s.neighboringTiles[y]){const x=this.getTileByID(y);d(s,x),d(x,s)}}function d(m,y){if(!m.dem||m.dem.borderReady)return;m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0;let x=y.tileID.canonical.x-m.tileID.canonical.x;const E=y.tileID.canonical.y-m.tileID.canonical.y,T=Math.pow(2,m.tileID.canonical.z),M=y.tileID.key;0===x&&0===E||Math.abs(E)>1||(Math.abs(x)>1&&(1===Math.abs(x+T)?x+=T:1===Math.abs(x-T)&&(x-=T)),y.dem&&m.dem&&(m.dem.backfillBorder(y.dem,x,E),m.neighboringTiles&&m.neighboringTiles[M]&&(m.neighboringTiles[M].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,c,d,m){for(const y in this._tiles){let x=this._tiles[y];if(m[y]||!x.hasData()||x.tileID.overscaledZ<=c||x.tileID.overscaledZ>d)continue;let E=x.tileID;for(;x&&x.tileID.overscaledZ>c+1;){const M=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[M.key],x&&x.hasData()&&(E=M)}let T=E;for(;T.overscaledZ>c;)if(T=T.scaledTo(T.overscaledZ-1),s[T.key]){m[E.key]=E;break}}}findLoadedParent(s,c){if(s.key in this._loadedParentTiles){const d=this._loadedParentTiles[s.key];return d&&d.tileID.overscaledZ>=c?d:null}for(let d=s.overscaledZ-1;d>=c;d--){const m=s.scaledTo(d),y=this._getLoadedTile(m);if(y)return y}}_getLoadedTile(s){const c=this._tiles[s.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,c){c=c||this._source.tileSize;const d=Math.ceil(s.width/c)+1,m=Math.ceil(s.height/c)+1,y=Math.floor(d*m*5),x="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,y):y,E="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(E)}handleWrapJump(s){const c=Math.round((s-(void 0===this._prevLng?s:this._prevLng))/360);if(this._prevLng=s,c){const d={};for(const m in this._tiles){const y=this._tiles[m];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+c),d[y.tileID.key]=y}this._tiles=d;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(+m,this._tiles[m])}}update(s,c,d){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let m;this.updateCacheSize(s,c),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(E=>new Oa(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y)):(m=s.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(m=m.filter(E=>this._source.hasTile(E)))):m=[];const y=this._updateRetainedTiles(m);if(Ab(this._source.type)&&0!==m.length){const E={},T={},M=Object.keys(y);for(const B of M){const V=y[B],j=this._tiles[B];if(!j||j.fadeEndTime&&j.fadeEndTime<=xr.now())continue;const G=this.findLoadedParent(V,Math.max(V.overscaledZ-vp.maxOverzooming,this._source.minzoom));G&&(this._addTile(G.tileID),E[G.tileID.key]=G.tileID),T[B]=V}const F=m[m.length-1].overscaledZ;for(const B in this._tiles){const V=this._tiles[B];if(y[B]||!V.hasData())continue;let j=V.tileID;for(;j.overscaledZ>F;){j=j.scaledTo(j.overscaledZ-1);const G=this._tiles[j.key];if(G&&G.hasData()&&T[j.key]){y[B]=V.tileID;break}}}for(const B in E)y[B]||(this._coveredTiles[B]=!0,y[B]=E[B])}for(const E in y)this._tiles[E].clearFadeHold();const x=function(E,T){const M=[];for(const F in E)F in T||M.push(F);return M}(this._tiles,y);for(const E of x){const T=this._tiles[E];T.hasSymbolBuckets&&!T.holdingForFade()?T.setHoldDuration(this.map._fadeDuration):T.hasSymbolBuckets&&!T.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const c={};if(0===s.length)return c;const d={},m=s.reduce((M,F)=>Math.min(M,F.overscaledZ),1/0),y=s[0].overscaledZ,x=Math.max(y-vp.maxOverzooming,this._source.minzoom),E=Math.max(y+vp.maxUnderzooming,this._source.minzoom),T={};for(const M of s){const F=this._addTile(M);c[M.key]=M,F.hasData()||m<this._source.maxzoom&&(T[M.key]=M)}this._retainLoadedChildren(T,m,E,c);for(const M of s){let F=this._tiles[M.key];if(F.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const V=M.children(this._source.maxzoom)[0],j=this.getTile(V);if(j&&j.hasData()){c[V.key]=V;continue}}else{const V=M.children(this._source.maxzoom);if(c[V[0].key]&&c[V[1].key]&&c[V[2].key]&&c[V[3].key])continue}let B=F.wasRequested();for(let V=M.overscaledZ-1;V>=x;--V){const j=M.scaledTo(V);if(d[j.key]||(d[j.key]=!0,F=this.getTile(j),!F&&B&&(F=this._addTile(j)),F&&(c[j.key]=j,B=F.wasRequested(),F.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const c=[];let d,m=this._tiles[s].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){d=this._loadedParentTiles[m.key];break}c.push(m.key);const y=m.scaledTo(m.overscaledZ-1);if(d=this._getLoadedTile(y),d)break;m=y}for(const y of c)this._loadedParentTiles[y]=d}}_addTile(s){let c=this._tiles[s.key];if(c)return c;c=this._cache.getAndRemove(s),c&&(this._setTileReloadTimer(s.key,c),c.tileID=s,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,c)));const d=!!c;if(!d){const m=this.map?this.map.painter:null;c=new Hr(s,this._source.tileSize*s.overscaleFactor(),this.transform.tileZoom,m,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,s.key,c.state))}return c?(c.uses++,this._tiles[s.key]=c,d||this._source.fire(new Wa("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(s,c){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const d=c.getExpiryTimeout();d&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},d))}_removeTile(s){const c=this._tiles[s];c&&(c.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),c.uses>0||(c.hasData()&&"reloading"!==c.state?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,c,d){const m=[],y=this.transform;if(!y)return m;const x="globe"===y.projection.name,E=Ac(y.center.lng);for(const T in this._tiles){const M=this._tiles[T];if(d&&M.clearQueryDebugViz(),M.holdingForFade())continue;let F;if(x){const B=M.tileID.canonical;if(0===B.z){const V=[Math.abs(Rt(E,...b_(B,-1))-E),Math.abs(Rt(E,...b_(B,1))-E)];F=[0,2*V.indexOf(Math.min(...V))-1]}else{const V=[Math.abs(Rt(E,...b_(B,-1))-E),Math.abs(Rt(E,...b_(B,0))-E),Math.abs(Rt(E,...b_(B,1))-E)];F=[V.indexOf(Math.min(...V))-1]}}else F=[0];for(const B of F){const V=s.containsTile(M,y,c,B);V&&m.push(V)}}return m}getVisibleCoordinates(s){const c=this.getRenderableIds(s).map(d=>this._tiles[d].tileID);for(const d of c)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(Ab(this._source.type))for(const s in this._tiles){const c=this._tiles[s];if(void 0!==c.fadeEndTime&&c.fadeEndTime>=xr.now())return!0}return!1}setFeatureState(s,c,d){this._state.updateState(s=s||"_geojsonTileLayer",c,d)}removeFeatureState(s,c,d){this._state.removeFeatureState(s=s||"_geojsonTileLayer",c,d)}getFeatureState(s,c){return this._state.getState(s=s||"_geojsonTileLayer",c)}setDependencies(s,c,d){const m=this._tiles[s];m&&m.setDependencies(c,d)}reloadTilesForDependencies(s,c){for(const d in this._tiles)this._tiles[d].hasDependency(s,c)&&this._reloadTile(+d,"reloading");this._cache.filter(d=>!d.hasDependency(s,c))}_preloadTiles(s,c){if(!this._sourceLoaded){const E=()=>{this._sourceLoaded&&(this._source.off("data",E),this._preloadTiles(s,c))};return void this._source.on("data",E)}const d=new Map,m=Array.isArray(s)?s:[s],y=this.map.painter.terrain,x=this.usedForTerrain&&y?y.getScaledDemTileSize():this._source.tileSize;for(const E of m){const T=E.coveringTiles({tileSize:x,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of T)d.set(M.key,M);this.usedForTerrain&&E.updateElevation(!1)}Hn(Array.from(d.values()),(E,T)=>{const M=new Hr(E,this._source.tileSize*E.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,F=>{"raster-dem"===this._source.type&&M.dem&&this._backfillDEM(M),T(F,M)})},c)}}function Db(a,s){const c=Math.abs(2*a.wrap)-+(a.wrap<0),d=Math.abs(2*s.wrap)-+(s.wrap<0);return a.overscaledZ-s.overscaledZ||d-c||s.canonical.y-a.canonical.y||s.canonical.x-a.canonical.x}function Ab(a){return"raster"===a||"image"===a||"video"===a||"custom"===a}function b_(a,s){const c=1<<a.z;return[a.x/c+s,(a.x+1)/c+s]}vp.maxOverzooming=10,vp.maxUnderzooming=3;class Iy{constructor(s,c,d){this._demTile=s,this._dem=this._demTile.dem,this._scale=c,this._offset=d}static create(s,c,d){const m=d||s.findDEMTileFor(c);if(!m||!m.dem)return;const y=m.dem,x=m.tileID,E=1<<c.canonical.z-x.canonical.z;return new Iy(m,m.tileSize/ei/E,[(c.canonical.x/E-x.canonical.x)*y.dim,(c.canonical.y/E-x.canonical.y)*y.dim])}tileCoordToPixel(s,c){const d=c*this._scale+this._offset[1],m=Math.floor(s*this._scale+this._offset[0]),y=Math.floor(d);return new ze(m,y)}getElevationAt(s,c,d,m){const y=s*this._scale+this._offset[0],x=c*this._scale+this._offset[1],E=Math.floor(y),T=Math.floor(x),M=this._dem;return m=!!m,d?tr(tr(M.get(E,T,m),M.get(E,T+1,m),x-T),tr(M.get(E+1,T,m),M.get(E+1,T+1,m),x-T),y-E):M.get(E,T,m)}getElevationAtPixel(s,c,d){return this._dem.get(s,c,!!d)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*su(1,s)*this._dem.stride}}class vC{constructor(s,c){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Pa(ei,16,0),this.featureIndexArray=new Qc,this.promoteId=c}insert(s,c,d,m,y,x=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,m,y,x);const T=this.grid;for(let M=0;M<c.length;M++){const F=c[M],B=[1/0,1/0,-1/0,-1/0];for(let V=0;V<F.length;V++){const j=F[V];B[0]=Math.min(B[0],j.x),B[1]=Math.min(B[1],j.y),B[2]=Math.max(B[2],j.x),B[3]=Math.max(B[3],j.y)}B[0]<ei&&B[1]<ei&&B[2]>=0&&B[3]>=0&&T.insert(E,B[0],B[1],B[2],B[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new W0(new up(this.rawTileData)).layers,this.sourceLayerCoder=new xy(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,c,d,m){this.loadVTLayers();const y=s.params||{},x=Pd(y.filter),E=s.tileResult,T=s.transform,M=E.bufferedTilespaceBounds,F=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(G,Q,re,X)=>AE(E.bufferedTilespaceGeometry,G,Q,re,X));F.sort(Rm);let B=null;T.elevation&&F.length>0&&(B=Iy.create(T.elevation,this.tileID));const V={};let j;for(let G=0;G<F.length;G++){const Q=F[G];if(Q===j)continue;j=Q;const re=this.featureIndexArray.get(Q);let X=null;this.loadMatchingFeature(V,re,x,y.layers,y.availableImages,c,d,m,(Ne,H,Fe,Ze=0)=>(X||(X=Gh(Ne,this.tileID.canonical,s.tileTransform)),H.queryIntersectsFeature(E,Ne,Fe,X,this.z,s.transform,s.pixelPosMatrix,B,Ze)))}return V}loadMatchingFeature(s,c,d,m,y,x,E,T,M){const{featureIndex:F,bucketIndex:B,sourceLayerIndex:V,layoutVertexArrayOffset:j}=c,G=this.bucketLayerIDs[B];if(m&&!function(Ne,H){for(let Fe=0;Fe<Ne.length;Fe++)if(H.indexOf(Ne[Fe])>=0)return!0;return!1}(m,G))return;const Q=this.sourceLayerCoder.decode(V),re=this.vtLayers[Q].feature(F);if(d.needGeometry){const Ne=Wh(re,!0);if(!d.filter(new N(this.tileID.overscaledZ),Ne,this.tileID.canonical))return}else if(!d.filter(new N(this.tileID.overscaledZ),re))return;const X=this.getId(re,Q);for(let Ne=0;Ne<G.length;Ne++){const H=G[Ne];if(m&&m.indexOf(H)<0)continue;const Fe=x[H];if(!Fe)continue;let Ze={};void 0!==X&&T&&(Ze=T.getState(Fe.sourceLayer||"_geojsonTileLayer",X));const We=Pe({},E[H]);We.paint=Sb(We.paint,Fe.paint,re,Ze,y),We.layout=Sb(We.layout,Fe.layout,re,Ze,y);const wt=!M||M(re,Fe,Ze,j);if(!wt)continue;const yt=new pC(re,this.z,this.x,this.y,X);yt.layer=We;let Bt=s[H];void 0===Bt&&(Bt=s[H]=[]),Bt.push({featureIndex:F,feature:yt,intersectionZ:wt})}}lookupSymbolFeatures(s,c,d,m,y,x,E,T){const M={};this.loadVTLayers();const F=Pd(y);for(const B of s)this.loadMatchingFeature(M,{bucketIndex:d,sourceLayerIndex:m,featureIndex:B,layoutVertexArrayOffset:0},F,x,E,T,c);return M}loadFeature(s){const{featureIndex:c,sourceLayerIndex:d}=s;this.loadVTLayers();const m=this.sourceLayerCoder.decode(d),y=this.vtFeatures[m];if(y[c])return y[c];const x=this.vtLayers[m].feature(c);return y[c]=x,x}hasLayer(s){for(const c of this.bucketLayerIDs)for(const d of c)if(s===d)return!0;return!1}getId(s,c){let d=s.id;if(this.promoteId){const m="string"==typeof this.promoteId?this.promoteId:this.promoteId[c];null!=m&&(d=s.properties[m]),"boolean"==typeof d&&(d=Number(d))}return d}}function Sb(a,s,c,d,m){return $t(a,(y,x)=>{const E=s instanceof we?s.get(x):null;return E&&E.evaluate?E.evaluate(c,d,m):E})}function Rm(a,s){return s-a}Fn(vC,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class nd{constructor(s,c){this.width=s,this.height=c,this.nextRow=0,this.image=new Yu({width:s,height:c}),this.positions={},this.uploaded=!1}getDash(s,c){const d=this.getKey(s,c);return this.positions[d]}trim(){const s=this.width,c=this.height=Ft(this.nextRow);this.image.resize({width:s,height:c})}getKey(s,c){return s.join(",")+c}getDashRanges(s,c,d){const m=[];let y=s.length%2==1?-s[s.length-1]*d:0,x=s[0]*d,E=!0;m.push({left:y,right:x,isDash:E,zeroLength:0===s[0]});let T=s[0];for(let M=1;M<s.length;M++){E=!E;const F=s[M];y=T*d,T+=F,x=T*d,m.push({left:y,right:x,isDash:E,zeroLength:0===F})}return m}addRoundDash(s,c,d){const m=c/2;for(let y=-d;y<=d;y++){const x=this.width*(this.nextRow+d+y);let E=0,T=s[E];for(let M=0;M<this.width;M++){M/T.right>1&&(T=s[++E]);const F=Math.abs(M-T.left),B=Math.abs(M-T.right),V=Math.min(F,B);let j;const G=y/d*(m+1);if(T.isDash){const Q=m-Math.abs(G);j=Math.sqrt(V*V+Q*Q)}else j=m-Math.sqrt(V*V+G*G);this.image.data[x+M]=Math.max(0,Math.min(255,j+128))}}}addRegularDash(s,c){for(let T=s.length-1;T>=0;--T){const M=s[T],F=s[T+1];M.zeroLength?s.splice(T,1):F&&F.isDash===M.isDash&&(F.left=M.left,s.splice(T,1))}const d=s[0],m=s[s.length-1];d.isDash===m.isDash&&(d.left=m.left-this.width,m.right=d.right+this.width);const y=this.width*this.nextRow;let x=0,E=s[x];for(let T=0;T<this.width;T++){T/E.right>1&&(E=s[++x]);const M=Math.abs(T-E.left),F=Math.abs(T-E.right),B=Math.min(M,F);this.image.data[y+T]=Math.max(0,Math.min(255,(E.isDash?B:-B)+c+128))}}addDash(s,c){const d=this.getKey(s,c);if(this.positions[d])return this.positions[d];const m="round"===c,y=m?7:0,x=2*y+1;if(this.nextRow+x>this.height)return ti("LineAtlas out of space"),null;0===s.length&&s.push(1);let E=0;for(let F=0;F<s.length;F++)s[F]<0&&(ti("Negative value is found in line dasharray, replacing values with 0"),s[F]=0),E+=s[F];if(0!==E){const F=this.width/E,B=this.getDashRanges(s,this.width,F);m?this.addRoundDash(B,F,y):this.addRegularDash(B,"square"===c?.5*F:0)}const T=this.nextRow+y;this.nextRow+=x;const M={tl:[T,y],br:[E,0]};return this.positions[d]=M,M}}Fn(nd,"LineAtlas");const xp=1*Kl;class xC{constructor(s){const c={},d=[];for(const E in s){const T=s[E],M=c[E]={};for(const F in T.glyphs){const B=T.glyphs[+F];if(!B||0===B.bitmap.width||0===B.bitmap.height)continue;const V=B.metrics.localGlyph?xp:1,j={x:0,y:0,w:B.bitmap.width+2*V,h:B.bitmap.height+2*V};d.push(j),M[F]=j}}const{w:m,h:y}=ab(d),x=new Yu({width:m||1,height:y||1});for(const E in s){const T=s[E];for(const M in T.glyphs){const F=T.glyphs[+M];if(!F||0===F.bitmap.width||0===F.bitmap.height)continue;const B=c[E][M],V=F.metrics.localGlyph?xp:1;Yu.copy(F.bitmap,x,{x:0,y:0},{x:B.x+V,y:B.y+V},F.bitmap)}}this.image=x,this.positions=c}}Fn(xC,"GlyphAtlas");class pS{constructor(s){this.tileID=new Oa(s.tileID.overscaledZ,s.tileID.wrap,s.tileID.canonical.z,s.tileID.canonical.x,s.tileID.canonical.y),this.tileZoom=s.tileZoom,this.uid=s.uid,this.zoom=s.zoom,this.canonical=s.tileID.canonical,this.pixelRatio=s.pixelRatio,this.tileSize=s.tileSize,this.source=s.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=s.showCollisionBoxes,this.collectResourceTiming=!!s.collectResourceTiming,this.returnDependencies=!!s.returnDependencies,this.promoteId=s.promoteId,this.enableTerrain=!!s.enableTerrain,this.isSymbolTile=s.isSymbolTile,this.tileTransform=cu(s.tileID.canonical,s.projection),this.projection=s.projection}parse(s,c,d,m,y){this.status="parsing",this.data=s,this.collisionBoxArray=new Ti;const x=new xy(Object.keys(s.layers).sort()),E=new vC(this.tileID,this.promoteId);E.bucketLayerIDs=[];const T={},M=new nd(256,256),F={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:d},B=c.familiesBySource[this.source];for(const Ze in B){const We=s.layers[Ze];if(!We)continue;let wt=!1,yt=!1;for(const At of B[Ze])"symbol"===At[0].type?wt=!0:yt=!0;if(!0===this.isSymbolTile&&!wt||!1===this.isSymbolTile&&!yt)continue;1===We.version&&ti(`Vector tile source "${this.source}" layer "${Ze}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Bt=x.encode(Ze),ln=[];for(let At=0;At<We.length;At++){const Ht=We.feature(At),Gt=E.getId(Ht,Ze);ln.push({feature:Ht,id:Gt,index:At,sourceLayerIndex:Bt})}for(const At of B[Ze]){const Ht=At[0];void 0!==this.isSymbolTile&&"symbol"===Ht.type!==this.isSymbolTile||Ht.minzoom&&this.zoom<Math.floor(Ht.minzoom)||Ht.maxzoom&&this.zoom>=Ht.maxzoom||"none"!==Ht.visibility&&(Ty(At,this.zoom,d),(T[Ht.id]=Ht.createBucket({index:E.bucketLayerIDs.length,layers:At,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Bt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate(ln,F,this.tileID.canonical,this.tileTransform),E.bucketLayerIDs.push(At.map(Gt=>Gt.id)))}}let V,j,G,Q;M.trim();const re={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},X=()=>{if(V)return y(V);if(j&&G&&Q){const Ze=new xC(j),We=new KE(G,Q);for(const wt in T){const yt=T[wt];yt instanceof tf?(Ty(yt.layers,this.zoom,d),hb(yt,j,Ze.positions,G,We.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):yt.hasPattern&&(yt instanceof Ud||yt instanceof a_||yt instanceof op)&&(Ty(yt.layers,this.zoom,d),yt.addFeatures(F,this.tileID.canonical,We.patternPositions,d,this.tileTransform))}this.status="done",y(null,{buckets:yi(T).filter(wt=>!wt.isEmpty()),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ze.image,lineAtlas:M,imageAtlas:We,glyphMap:this.returnDependencies?j:null,iconMap:this.returnDependencies?G:null,glyphPositions:this.returnDependencies?Ze.positions:null})}},Ne=$t(F.glyphDependencies,Ze=>Object.keys(Ze).map(Number));Object.keys(Ne).length?m.send("getGlyphs",{uid:this.uid,stacks:Ne},(Ze,We)=>{V||(V=Ze,j=We,X())},void 0,!1,re):j={};const H=Object.keys(F.iconDependencies);H.length?m.send("getImages",{icons:H,source:this.source,tileID:this.tileID,type:"icons"},(Ze,We)=>{V||(V=Ze,G=We,X())},void 0,!1,re):G={};const Fe=Object.keys(F.patternDependencies);Fe.length?m.send("getImages",{icons:Fe,source:this.source,tileID:this.tileID,type:"patterns"},(Ze,We)=>{V||(V=Ze,Q=We,X())},void 0,!1,re):Q={},X()}}function Ty(a,s,c){const d=new N(s);for(const m of a)m.recalculate(d,c)}class Mb{constructor(s){this.entries={},this.scheduler=s}request(s,c,d,m){const y=this.entries[s]=this.entries[s]||{callbacks:[]};if(y.result){const[x,E]=y.result;return this.scheduler?this.scheduler.add(()=>{m(x,E)},c):m(x,E),()=>{}}return y.callbacks.push(m),y.cancel||(y.cancel=d((x,E)=>{y.result=[x,E];for(const T of y.callbacks)this.scheduler?this.scheduler.add(()=>{T(x,E)},c):T(x,E);setTimeout(()=>delete this.entries[s],3e3)})),()=>{y.result||(y.callbacks=y.callbacks.filter(x=>x!==m),y.callbacks.length||(y.cancel(),delete this.entries[s]))}}}function Dy(a,s,c){const d=JSON.stringify(a.request);return a.data&&(this.deduped.entries[d]={result:[null,a.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},m=>{const y=vr(a.request,(x,E,T,M)=>{x?m(x):E&&m(null,{vectorTile:c?void 0:new W0(new up(E)),rawData:E,cacheControl:T,expires:M})});return()=>{y.cancel(),m()}},s)}const Om=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Fm{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,d]=new Uint8Array(s,0,2);if(219!==c)throw new Error("Data does not appear to be in a KDBush format.");const m=d>>4;if(1!==m)throw new Error(`Got v${m} data when expected v1.`);const y=Om[15&d];if(!y)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(s,2,1),[E]=new Uint32Array(s,4,1);return new Fm(E,x,y,s)}constructor(s,c=64,d=Float64Array,m){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=d,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const y=Om.indexOf(this.ArrayType),x=2*s*this.ArrayType.BYTES_PER_ELEMENT,E=s*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-E%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${d}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+E+T,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+x+E+T),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+E+T,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=s)}add(s,c){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=s,this.coords[this._pos++]=c,d}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return Ay(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,c,d,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:x,nodeSize:E}=this,T=[0,y.length-1,0],M=[];for(;T.length;){const F=T.pop()||0,B=T.pop()||0,V=T.pop()||0;if(B-V<=E){for(let re=V;re<=B;re++){const X=x[2*re],Ne=x[2*re+1];X>=s&&X<=d&&Ne>=c&&Ne<=m&&M.push(y[re])}continue}const j=V+B>>1,G=x[2*j],Q=x[2*j+1];G>=s&&G<=d&&Q>=c&&Q<=m&&M.push(y[j]),(0===F?s<=G:c<=Q)&&(T.push(V),T.push(j-1),T.push(1-F)),(0===F?d>=G:m>=Q)&&(T.push(j+1),T.push(B),T.push(1-F))}return M}within(s,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:x}=this,E=[0,m.length-1,0],T=[],M=d*d;for(;E.length;){const F=E.pop()||0,B=E.pop()||0,V=E.pop()||0;if(B-V<=x){for(let re=V;re<=B;re++)bC(y[2*re],y[2*re+1],s,c)<=M&&T.push(m[re]);continue}const j=V+B>>1,G=y[2*j],Q=y[2*j+1];bC(G,Q,s,c)<=M&&T.push(m[j]),(0===F?s-d<=G:c-d<=Q)&&(E.push(V),E.push(j-1),E.push(1-F)),(0===F?s+d>=G:c+d>=Q)&&(E.push(j+1),E.push(B),E.push(1-F))}return T}}function Ay(a,s,c,d,m,y){if(m-d<=c)return;const x=d+m>>1;Pb(a,s,x,d,m,y),Ay(a,s,c,d,x-1,1-y),Ay(a,s,c,x+1,m,1-y)}function Pb(a,s,c,d,m,y){for(;m>d;){if(m-d>600){const M=m-d+1,F=c-d+1,B=Math.log(M),V=.5*Math.exp(2*B/3),j=.5*Math.sqrt(B*V*(M-V)/M)*(F-M/2<0?-1:1);Pb(a,s,c,Math.max(d,Math.floor(c-F*V/M+j)),Math.min(m,Math.floor(c+(M-F)*V/M+j)),y)}const x=s[2*c+y];let E=d,T=m;for(w_(a,s,d,c),s[2*m+y]>x&&w_(a,s,d,m);E<T;){for(w_(a,s,E,T),E++,T--;s[2*E+y]<x;)E++;for(;s[2*T+y]>x;)T--}s[2*d+y]===x?w_(a,s,d,T):(T++,w_(a,s,T,m)),T<=c&&(d=T+1),c<=T&&(m=T-1)}}function w_(a,s,c,d){kb(a,c,d),kb(s,2*c,2*d),kb(s,2*c+1,2*d+1)}function kb(a,s,c){const d=a[s];a[s]=a[c],a[c]=d}function bC(a,s,c,d){const m=a-c,y=s-d;return m*m+y*y}h.ARRAY_TYPE=ps,h.AUTH_ERR_MSG=Be,h.Aabb=Es,h.Actor=class{constructor(a,s,c){this.target=a,this.parent=s,this.mapId=c,this.callbacks={},this.cancelCallbacks={},_n(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=pr()?a:Me,this.scheduler=new DF}send(a,s,c,d,m=!1,y){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=y,this.callbacks[x]=c);const E=Fo(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:a,hasCallback:!!c,targetMapId:d,mustQueue:m,sourceMapId:this.mapId,data:xc(s,E)},E),{cancel:()=>{c&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(a){const s=a.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if("<cancel>"===s.type){const d=this.cancelCallbacks[c];delete this.cancelCallbacks[c],d&&d.cancel()}else if(s.mustQueue||pr()){const d=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,s),d&&d.metadata||{type:"message"})}else this.processTask(c,s)}processTask(a,s){if("<response>"===s.type){const c=this.callbacks[a];delete this.callbacks[a],c&&(s.error?c(bc(s.error)):c(null,bc(s.data)))}else{const c=Fo(this.globalScope)?void 0:[],d=s.hasCallback?(y,x)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:y?xc(y):null,data:xc(x,c)},c)}:y=>{},m=bc(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,m,d);else if(this.parent.getWorkerSource){const y=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,y[0],m.source)[y[1]](m,d)}else d(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},h.CanonicalTileID=Q0,h.Color=si,h.ColorMode=td,h.CullFaceMode=Pc,h.DEMData=Ib,h.DataConstantProperty=K,h.DedupedRequest=Mb,h.DepthMode=km,h.EXTENT=ei,h.Elevation=class{isDataAvailableAtPoint(a){const s=this._source();if(this.isUsingMockSource()||!s||a.y<0||a.y>1)return!1;const c=s.getSource().maxzoom,d=1<<c,m=Math.floor(a.x),y=Math.floor((a.x-m)*d),x=Math.floor(a.y*d),E=this.findDEMTileFor(new Oa(c,m,c,y,x));return!(!E||!E.dem)}getAtPointOrZero(a,s=0){return this.getAtPoint(a,s)||0}getAtPoint(a,s,c=!0){if(this.isUsingMockSource())return null;null==s&&(s=null);const d=this._source();if(!d||a.y<0||a.y>1)return s;const m=d.getSource().maxzoom,y=1<<m,x=Math.floor(a.x),E=a.x-x,T=new Oa(m,x,m,Math.floor(E*y),Math.floor(a.y*y)),M=this.findDEMTileFor(T);if(!M||!M.dem)return s;const F=M.dem,B=1<<M.tileID.canonical.z,V=(E*B-M.tileID.canonical.x)*F.dim,j=(a.y*B-M.tileID.canonical.y)*F.dim,G=Math.floor(V),Q=Math.floor(j);return(c?this.exaggeration():1)*tr(tr(F.get(G,Q),F.get(G,Q+1),j-Q),tr(F.get(G+1,Q),F.get(G+1,Q+1),j-Q),V-G)}getAtTileOffset(a,s,c){const d=1<<a.canonical.z;return this.getAtPointOrZero(new $h(a.wrap+(a.canonical.x+s/ei)/d,(a.canonical.y+c/ei)/d))}getAtTileOffsetFunc(a,s,c,d){return m=>{const y=this.getAtTileOffset(a,m.x,m.y),x=d.upVector(a.canonical,m.x,m.y);return Y(x,x,y*d.upVectorScale(a.canonical,s,c).metersToTile),x}}getForTilePoints(a,s,c,d){if(this.isUsingMockSource())return!1;const m=Iy.create(this,a,d);return!!m&&(s.forEach(y=>{y[2]=this.exaggeration()*m.getElevationAt(y[0],y[1],c)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(a);if(!s||!s.dem)return null;const c=s.dem.tree,d=s.tileID,m=1<<a.canonical.z-d.canonical.z;let y=a.canonical.x/m-d.canonical.x,x=a.canonical.y/m-d.canonical.y,E=0;for(let T=0;T<a.canonical.z-d.canonical.z&&!c.leaves[E];T++){y*=2,x*=2;const M=2*Math.floor(x)+Math.floor(y);E=c.childOffsets[E]+M,y%=1,x%=1}return{min:this.exaggeration()*c.minimums[E],max:this.exaggeration()*c.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,s,c){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},h.ErrorEvent=cc,h.EvaluationParameters=N,h.Event=Wa,h.Evented=zc,h.FillExtrusionBucket=op,h.Frustum=Lh,h.FrustumCorners=Fh,h.GLOBE_RADIUS=Dc,h.GLOBE_SCALE_MATCH_LATITUDE=45,h.GLOBE_ZOOM_THRESHOLD_MAX=bx,h.GLOBE_ZOOM_THRESHOLD_MIN=Nh,h.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,s){const c=new rn,d=new Bn,m=[],y=a+1+2,x=s[0]+1,E=s[0]+1+(1+s.length),T=(M,F,B)=>{let V=M===y-1?M-2:0===M?M:M-1;return V+=B?24575:0,[V,F]};for(let M=0;M<y;++M)c.emplaceBack(...T(M,0,!0));for(let M=0;M<x;++M)for(let F=0;F<y;++F)c.emplaceBack(...T(F,M,(0===F||F===y-1)&&!0));for(let M=0;M<s.length;++M){const F=s[M];for(let B=0;B<y;++B)c.emplaceBack(...T(B,F,!0))}for(let M=0;M<s.length;++M){const F=d.length,B=s[M]+1+2,V=new Bn;for(let Q=0;Q<B-1;Q++){const re=Q===B-2,X=re?y*(E-s.length+M-Q):y;for(let Ne=0;Ne<y-1;Ne++){const H=Q*y+Ne;0===Q||re||0===Ne||Ne===y-2?(V.emplaceBack(H+1,H,H+X),V.emplaceBack(H+X,H+X+1,H+1)):(d.emplaceBack(H+1,H,H+X),d.emplaceBack(H+X,H+X+1,H+1))}}const j=io.simpleSegment(0,F,c.length,d.length-F);for(let Q=0;Q<V.uint16.length;Q+=3)d.emplaceBack(V.uint16[Q],V.uint16[Q+1],V.uint16[Q+2]);const G=io.simpleSegment(0,F,c.length,d.length-F);m.push({withoutSkirts:j,withSkirts:G})}return{vertices:c,indices:d,segments:m}}_createGrid(a){const s=this._fillGridMeshWithLods(64,Wg);this._gridSegments=s.segments,this._gridBuffer=a.createVertexBuffer(s.vertices,Jf.members),this._gridIndexBuffer=a.createIndexBuffer(s.indices,!0)}_createPoles(a){const s=new Bn;for(let m=0;m<=64;m++)s.emplaceBack(0,m+1,m+2);this._poleIndexBuffer=a.createIndexBuffer(s,!0);const c=new Er,d=new Er;this._poleSegments=[];for(let m=0,y=0;m<Nh;m++){const x=360/(1<<m);c.emplaceBack(0,-Dc,0,.5,0),d.emplaceBack(0,-Dc,0,.5,1);for(let E=0;E<=64;E++){const T=E/64,M=tr(0,x,T),[F,B,V]=ou(wE,yA,M,Dc);c.emplaceBack(F,B,V,T,0),d.emplaceBack(F,B,V,T,1)}this._poleSegments.push(io.simpleSegment(y,0,66,64)),y+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(c,ms,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(d,ms,!1)}getGridBuffers(a,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,s){if(!this._wireframeSegments){const c=new qt,d=64,m=d+1+2,y=1;this._wireframeSegments=[];for(let x=0,E=0;x<Wg.length;x++){const T=Wg[x];for(let F=y;F<T+y;F++)for(let B=y;B<d+y;B++){const V=F*m+B;c.emplaceBack(V,V+1),c.emplaceBack(V,V+m),c.emplaceBack(V,V+m+1)}const M=T*d*3;this._wireframeSegments.push(io.simpleSegment(0,E,(T+1)*m,M)),E+=M}this._wireframeIndexBuffer=a.createIndexBuffer(c)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[s]]}},h.GlyphManager=ra,h.ImagePosition=oy,h.KDBush=Fm,h.LivePerformanceUtils=Vc,h.LngLat=Fr,h.LngLatBounds=Wl,h.LocalGlyphMode=Dm,h.MAX_MERCATOR_LATITUDE=na,h.MercatorCoordinate=$h,h.ONE_EM=$r,h.OverscaledTileID=Oa,h.PerformanceMarkers=po,h.Point=ze,h.Properties=Se,h.RGBAImage=nl,h.Ray=M0,h.RequestManager=class{constructor(a,s,c){this._transformRequestFn=a,this._customAccessToken=s,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const a=function(){let s="";for(let c=0;c<10;c++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",$e,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,s){return this._transformRequestFn&&this._transformRequestFn(a,s)||{url:a}}normalizeStyleURL(a,s){if(!Qe(a))return a;const c=Ee(a);return c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeGlyphsURL(a,s){if(!Qe(a))return a;const c=Ee(a);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||s)}normalizeSourceURL(a,s,c,d){if(!Qe(a))return a;const m=Ee(a);return m.path=`/v4/${m.authority}.json`,m.params.push("secure"),c&&m.params.push(`language=${c}`),d&&m.params.push(`worldview=${d}`),this._makeAPIURL(m,this._customAccessToken||s)}normalizeSpriteURL(a,s,c,d){const m=Ee(a);return Qe(a)?(m.path=`/styles/v1${m.path}/sprite${s}${c}`,this._makeAPIURL(m,this._customAccessToken||d)):(m.path+=`${s}${c}`,pe(m))}normalizeTileURL(a,s,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!Qe(a))return a;const d=Ee(a);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||c&&"raster"!==d.authority&&512===c?"@2x":""}${ce.supported?".webp":"$1"}`),"raster"===d.authority?d.path=`/${se.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${se.TILE_URL_VERSION}${d.path}`);const m=this._customAccessToken||function(y){for(const x of y){const E=x.match(/^access_token=(.*)$/);if(E)return E[1]}return null}(d.params)||se.ACCESS_TOKEN;return se.REQUIRE_ACCESS_TOKEN&&m&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,m)}canonicalizeTileURL(a,s){const c=Ee(a);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return a;let d="mapbox://";c.path.match(/^\/raster\/v1\//)?d+=`raster/${c.path.replace(`/${se.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${c.path.replace(`/${se.TILE_URL_VERSION}/`,"")}`;let m=c.params;return s&&(m=m.filter(y=>!y.match(/^access_token=/))),m.length&&(d+=`?${m.join("&")}`),d}canonicalizeTileset(a,s){const c=!!s&&Qe(s),d=[];for(const m of a.tiles||[])ut(m)?d.push(this.canonicalizeTileURL(m,c)):d.push(m);return d}_makeAPIURL(a,s){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=Ee(se.API_URL);if(a.protocol=d.protocol,a.authority=d.authority,"http"===a.protocol){const m=a.params.indexOf("secure");m>=0&&a.params.splice(m,1)}if("/"!==d.path&&(a.path=`${d.path}${a.path}`),!se.REQUIRE_ACCESS_TOKEN)return pe(a);if(s=s||se.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if("s"===s[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return a.params=a.params.filter(m=>-1===m.indexOf("access_token")),a.params.push(`access_token=${s||""}`),pe(a)}},h.ResourceType=Bi,h.SegmentVector=io,h.SourceCache=vp,h.StencilMode=Tb,h.StructArrayLayout1ui2=Mi,h.StructArrayLayout2f1f2i16=oi,h.StructArrayLayout2i4=rn,h.StructArrayLayout2ui4=qt,h.StructArrayLayout3f12=Si,h.StructArrayLayout3ui6=Bn,h.StructArrayLayout4i8=zt,h.StructArrayLayout5f20=Er,h.Texture=yp,h.Tile=Hr,h.Transitionable=q,h.Uniform1f=Dh,h.Uniform1i=class extends Gl{constructor(a){super(a),this.current=0}set(a,s,c){this.fetchUniformLocation(a,s)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},h.Uniform2f=class extends Gl{constructor(a){super(a),this.current=[0,0]}set(a,s,c){this.fetchUniformLocation(a,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}},h.Uniform3f=class extends Gl{constructor(a){super(a),this.current=[0,0,0]}set(a,s,c){this.fetchUniformLocation(a,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}},h.Uniform4f=Ah,h.UniformColor=zg,h.UniformMatrix2f=class extends Gl{constructor(a){super(a),this.current=Ug}set(a,s,c){if(this.fetchUniformLocation(a,s))for(let d=0;d<4;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}},h.UniformMatrix3f=class extends Gl{constructor(a){super(a),this.current=T0}set(a,s,c){if(this.fetchUniformLocation(a,s))for(let d=0;d<9;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}},h.UniformMatrix4f=class extends Gl{constructor(a){super(a),this.current=I0}set(a,s,c){if(this.fetchUniformLocation(a,s)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let d=1;d<16;d++)if(c[d]!==this.current[d]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}},h.UnwrappedTileID=zE,h.ValidationError=Tn,h.VectorTileFeature=q0,h.VectorTileWorkerSource=class extends zc{constructor(a,s,c,d,m){super(),this.actor=a,this.layerIndex=s,this.availableImages=c,this.loadVectorData=m||Dy,this.loading={},this.loaded={},this.deduped=new Mb(a.scheduler),this.isSpriteLoaded=d,this.scheduler=a.scheduler}loadTile(a,s){const c=a.uid,d=a&&a.request,m=d&&d.collectResourceTiming,y=this.loading[c]=new pS(a);y.abort=this.loadVectorData(a,(x,E)=>{const T=!this.loading[c];if(delete this.loading[c],T||x||!E)return y.status="done",T||(this.loaded[c]=y),s(x);const M=E.rawData,F={};E.expires&&(F.expires=E.expires),E.cacheControl&&(F.cacheControl=E.cacheControl),y.vectorTile=E.vectorTile||new W0(new up(M));const B=()=>{y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,(V,j)=>{if(V||!j)return s(V);const G={};if(m){const Q=dn(d);Q.length>0&&(G.resourceTiming=JSON.parse(JSON.stringify(Q)))}s(null,Pe({rawTileData:M.slice(0)},j,F,G))})};this.isSpriteLoaded?B():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(B,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):B()}),this.loaded=this.loaded||{},this.loaded[c]=y})}reloadTile(a,s){const c=this.loaded,d=a.uid,m=this;if(c&&c[d]){const y=c[d];y.showCollisionBoxes=a.showCollisionBoxes,y.enableTerrain=!!a.enableTerrain,y.projection=a.projection,y.tileTransform=cu(a.tileID.canonical,a.projection);const x=(E,T)=>{const M=y.reloadCallback;M&&(delete y.reloadCallback,y.parse(y.vectorTile,m.layerIndex,this.availableImages,m.actor,M)),s(E,T)};"parsing"===y.status?y.reloadCallback=x:"done"===y.status&&(y.vectorTile?y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,x):x())}}abortTile(a,s){const c=a.uid,d=this.loading[c];d&&(d.abort&&d.abort(),delete this.loading[c]),s()}removeTile(a,s){const c=this.loaded,d=a.uid;c&&c[d]&&delete c[d],s()}},h.WritingMode=Zl,h.ZoomDependentExpression=xs,h.add=tu,h.addDynamicAttributes=__,h.adjoint=function(a,s){var c=s[0],d=s[1],m=s[2],y=s[3],x=s[4],E=s[5],T=s[6],M=s[7],F=s[8];return a[0]=x*F-E*M,a[1]=m*M-d*F,a[2]=d*E-m*x,a[3]=E*T-y*F,a[4]=c*F-m*T,a[5]=m*y-c*E,a[6]=y*M-x*T,a[7]=d*T-c*M,a[8]=c*x-d*y,a},h.asyncAll=Hn,h.bezier=nn,h.bindAll=_n,h.boundsAttributes=Eb,h.bufferConvexPolygon=function(a,s){const c=[];for(let d=0;d<a.length;d++){const m=Kt(d-1,-1,a.length-1),y=Kt(d+1,-1,a.length-1),x=a[d],E=a[y],T=a[m].sub(x).unit(),M=E.sub(x).unit(),F=M.angleWithSep(T.x,T.y),B=T.add(M).unit().mult(-1*s/Math.sin(F/2));c.push(x.add(B))}return c},h.cacheEntryPossiblyAdded=function(a){co++,co>Wo&&(a.getActor().send("enforceCacheSizeLimit",bo),co=0)},h.calculateGlobeLabelMatrix=function(a,s){const{x:c,y:d}=a.point,m=gA(c,d,a.worldSize/a._pixelsPerMercatorPixel,0,0);return qu(m,m,Ex(Ku(s)))},h.calculateGlobeMatrix=function(a){const{x:s,y:c}=a.point,{lng:d,lat:m}=a._center;return gA(s,c,a.worldSize,d,m)},h.calculateGlobeMercatorMatrix=function(a){const s=a.pixelsPerMeter,c=s/su(1,a.center.lat),d=Cc(new Float64Array(16));return Ph(d,d,[a.point.x,a.point.y,0]),Ic(d,d,[c,c,s]),Float32Array.from(d)},h.circumferenceAtLatitude=Cx,h.clamp=Rt,h.clearTileCache=function(a){if(!fo())return;const s=Me.caches.delete(Or);a&&s.catch(a).then(()=>a())},h.clipLine=rC,h.clone=function(a){var s=new ps(16);return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],s[9]=a[9],s[10]=a[10],s[11]=a[11],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15],s},h.clone$1=bi,h.collisionCircleLayout=GA,h.config=se,h.conjugate=function(a,s){return a[0]=-s[0],a[1]=-s[1],a[2]=-s[2],a[3]=s[3],a},h.create=function(){var a=new ps(16);return ps!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},h.create$1=Mh,h.createExpression=To,h.createLayout=st,h.createStyleLayer=function(a){return"custom"===a.type?new Hd(a):new nf[a.type](a)},h.cross=hn,h.degToRad=xt,h.distance=function(a,s){return Math.hypot(s[0]-a[0],s[1]-a[1],s[2]-a[2])},h.div=function(a,s,c){return a[0]=s[0]/c[0],a[1]=s[1]/c[1],a[2]=s[2]/c[2],a},h.dot=Pt,h.earthRadius=Zg,h.ease=wn,h.easeCubicInOut=Lt,h.ecefToLatLng=function([a,s,c]){const d=Math.hypot(a,s,c),m=Math.atan2(a,c),y=.5*Math.PI-Math.acos(-s/d);return new Fr(lt(m),lt(y))},h.emitValidationErrors=ju,h.endsWith=Rn,h.enforceCacheSizeLimit=function(a){So(),Jr&&Jr.then(s=>{s.keys().then(c=>{for(let d=0;d<c.length-a;d++)s.delete(c[d])})})},h.evaluateSizeForFeature=ny,h.evaluateSizeForZoom=Em,h.evaluateVariableOffset=Ju,h.evented=w,h.exactEquals=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]&&a[3]===s[3]},h.exactEquals$1=function(a,s){return a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2]},h.exported=xr,h.exported$1=ce,h.extend=Pe,h.extend$1=Po,h.fillExtrusionHeightLift=Yx,h.filterObject=qn,h.fromMat4=function(a,s){return a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[4],a[4]=s[5],a[5]=s[6],a[6]=s[8],a[7]=s[9],a[8]=s[10],a},h.fromQuat=function(a,s){var c=s[0],d=s[1],m=s[2],y=s[3],x=c+c,E=d+d,T=m+m,M=c*x,F=d*x,B=d*E,V=m*x,j=m*E,G=m*T,Q=y*x,re=y*E,X=y*T;return a[0]=1-B-G,a[1]=F+X,a[2]=V-re,a[3]=0,a[4]=F-X,a[5]=1-M-G,a[6]=j+Q,a[7]=0,a[8]=V+re,a[9]=j-Q,a[10]=1-M-B,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},h.fromRotation=function(a,s){var c=Math.sin(s),d=Math.cos(s);return a[0]=d,a[1]=c,a[2]=0,a[3]=-c,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},h.fromScaling=cm,h.furthestTileCorner=function(a){const s=Math.round((a+45+360)%360/90)%4;return pn[s]},h.getAABBPointSquareDist=function(a,s,c){let d=0;for(let m=0;m<2;++m){const y=c?c[m]:0;a[m]>y&&(d+=(a[m]-y)*(a[m]-y)),s[m]<y&&(d+=(y-s[m])*(y-s[m]))}return d},h.getAnchorAlignment=f_,h.getAnchorJustification=fb,h.getBounds=function(a){let s=1/0,c=1/0,d=-1/0,m=-1/0;for(const y of a)s=Math.min(s,y.x),c=Math.min(c,y.y),d=Math.max(d,y.x),m=Math.max(m,y.y);return{min:new ze(s,c),max:new ze(d,m)}},h.getColumn=hi,h.getDefaultExportFromCjs=Je,h.getGridMatrix=function(a,s,c,d){const m=s.getNorth(),y=s.getSouth(),x=s.getWest(),E=s.getEast(),T=1<<a.z,M=E-x,F=m-y,B=M/64,V=-F/Wg[c],j=[0,B,0,V,0,0,m,x,0];if(a.z>0){const G=180/d;sm(j,j,[G/M+1,0,0,0,G/F+1,0,-.5*G/B,.5*G/V,1])}return j[2]=T,j[5]=a.x,j[8]=a.y,j},h.getImage=De,h.getJSON=function(a,s){return Ks(Pe(a,{type:"json"}),s)},h.getLatitudinalLod=function(a){const s=na-5;a=Rt(a,-s,s)/s*90;const c=Math.pow(Math.abs(Math.sin(xt(a))),3);return Math.round(c*(Wg.length-1))},h.getMapSessionAPI=Li,h.getPerformanceMeasurement=dn,h.getProjection=uC,h.getRTLTextPluginStatus=I,h.getReferrer=Sr,h.getTilePoint=function(a,{x:s,y:c},d=0){return new ze(((s-d)*a.scale-a.x)*ei,(c*a.scale-a.y)*ei)},h.getTileVec3=function(a,s,c=0){return Xf(((s.x-c)*a.scale-a.x)*ei,(s.y*a.scale-a.y)*ei,Vd(s.z,s.y))},h.getVideo=function(a,s){const c=Me.document.createElement("video");c.muted=!0,c.onloadstart=function(){s(null,c)};for(let d=0;d<a.length;d++){const m=Me.document.createElement("source");zr(a[d])||(c.crossOrigin="Anonymous"),m.src=a[d],c.appendChild(m)}return{cancel:()=>{}}},h.globeCenterToScreenPoint=function(a){const s=[0,0,0],c=Cc(new Float64Array(16));return qu(c,a.pixelMatrix,a.globeMatrix),Dn(s,s,c),new ze(s[0],s[1])},h.globeDenormalizeECEF=Ex,h.globeECEFOrigin=function(a,s){const c=[0,0,0];return Dn(c,c,k0(Ku(s.canonical))),Dn(c,c,a),c},h.globeMetersToEcef=wx,h.globeNormalizeECEF=k0,h.globePixelsToTileUnits=function(a,s){return ei/(512*Math.pow(2,a))*zh(Ku(s))},h.globePoleMatrixForTile=function(a,s,c){const d=Cc(new Float64Array(16)),m=(s/(1<<a)-.5)*Math.PI*2;return lm(d,c.globeMatrix,m),Float32Array.from(d)},h.globeTileBounds=Ku,h.globeTiltAtLngLat=R0,h.globeToMercatorTransition=ea,h.globeUseCustomAntiAliasing=function(a,s,c){const d=ea(c.zoom),m=a.style.map._antialias,y=!!s.extStandardDerivatives,x=s.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return 0===d&&!m&&!x&&y},h.identity=Cc,h.identity$1=Qf,h.invert=am,h.isFullscreen=function(){return!!Me.document.fullscreenElement||!!Me.document.webkitFullscreenElement},h.isLngLatBehindGlobe=Uh,h.isMapAuthenticated=function(a){return Un.has(a)},h.isMapboxURL=Qe,h.isSafariWithAntialiasingBug=function(a){const s=a.navigator?a.navigator.userAgent:null;return!!Fo(a)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},h.latFromMercatorY=ta,h.latLngToECEF=tp,h.len=dm,h.length=eu,h.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},h.lngFromMercatorX=jr,h.loadVectorTile=Dy,h.makeRequest=Ks,h.mapValue=function(a,s,c,d,m){return Rt((a-s)/(c-s)*(m-d)+d,d,m)},h.mercatorScale=Ix,h.mercatorXfromLng=Ac,h.mercatorYfromLat=ql,h.mercatorZfromAltitude=su,h.mul=xx,h.mul$1=nu,h.multiply=qu,h.multiply$1=sm,h.multiply$2=C,h.nextPowerOfTwo=Ft,h.normalize=nt,h.normalize$1=Hs,h.normalize$2=Tc,h.number=tr,h.ortho=function(a,s,c,d,m,y,x){var E=1/(s-c),T=1/(d-m),M=1/(y-x);return a[0]=-2*E,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*M,a[11]=0,a[12]=(s+c)*E,a[13]=(m+d)*T,a[14]=(x+y)*M,a[15]=1,a},h.pbf=HE,h.perspective=function(a,s,c,d,m){var y,x=1/Math.tan(s/2);return a[0]=x/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=x,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=m&&m!==1/0?(a[10]=(m+d)*(y=1/(d-m)),a[14]=2*m*d*y):(a[10]=-1,a[14]=-2*d),a},h.pick=function(a,s){const c={};for(let d=0;d<s.length;d++){const m=s[d];m in a&&(c[m]=a[m])}return c},h.plugin=k,h.pointGeometry=mt,h.polesInViewport=function(a){const s=Cc(new Float64Array(16));qu(s,a.pixelMatrix,a.globeMatrix);const c=[0,iu,0],d=[0,ru,0];return Dn(c,c,s),Dn(d,d,s),[c[0]>0&&c[0]<=a.width&&c[1]>0&&c[1]<=a.height&&!Uh(a,new Fr(a.center.lat,90)),d[0]>0&&d[0]<=a.width&&d[1]>0&&d[1]<=a.height&&!Uh(a,new Fr(a.center.lat,-90))]},h.polygonContainsPoint=np,h.polygonIntersectsBox=AE,h.polygonIntersectsPolygon=CE,h.polygonizeBounds=function(a,s,c=0,d=!0){const m=new ze(c,c),y=a.sub(m),x=s.add(m),E=[y,new ze(x.x,y.y),x,new ze(y.x,x.y)];return d&&E.push(y.clone()),E},h.posAttributes=Jf,h.postMapLoadEvent=bn,h.postPerformanceEvent=vi,h.postTurnstileEvent=bt,h.potpack=ab,h.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},h.radToDeg=lt,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.registerForPluginStateChange=function(a){return a({pluginStatus:_,pluginURL:u}),w.on("pluginStateChange",a),a},h.removeAuthState=function(a){Un.delete(a)},h.renderColorRamp=_m,h.resample=Tx,h.rotateX=Hg,h.rotateX$1=Bd,h.rotateY=lm,h.rotateY$1=Gg,h.rotateZ=function(a,s,c){var d=Math.sin(c),m=Math.cos(c),y=s[0],x=s[1],E=s[2],T=s[3],M=s[4],F=s[5],B=s[6],V=s[7];return s!==a&&(a[8]=s[8],a[9]=s[9],a[10]=s[10],a[11]=s[11],a[12]=s[12],a[13]=s[13],a[14]=s[14],a[15]=s[15]),a[0]=y*m+M*d,a[1]=x*m+F*d,a[2]=E*m+B*d,a[3]=T*m+V*d,a[4]=M*m-y*d,a[5]=F*m-x*d,a[6]=B*m-E*d,a[7]=V*m-T*d,a},h.rotateZ$1=function(a,s,c){c*=.5;var d=s[0],m=s[1],y=s[2],x=s[3],E=Math.sin(c),T=Math.cos(c);return a[0]=d*T+m*E,a[1]=m*T-d*E,a[2]=y*T+x*E,a[3]=x*T-y*E,a},h.scale=Ic,h.scale$1=Rh,h.scale$2=Y,h.scaleAndAdd=me,h.set=function(a,s,c,d){return a[0]=s,a[1]=c,a[2]=d,a},h.setCacheLimits=function(a,s){bo=a,Wo=s},h.setColumn=function(a,s,c){a[4*s+0]=c[0],a[4*s+1]=c[1],a[4*s+2]=c[2],a[4*s+3]=c[3]},h.setRTLTextPlugin=function(a,s,c=!1){if(_===Xc||_===Hf||_===Gf)throw new Error("setRTLTextPlugin cannot be called multiple times.");u=xr.resolveURL(a),_=Xc,$u=s,v(),c||P()},h.smoothstep=Jn,h.spec=Nt,h.squaredLength=function(a){var s=a[0],c=a[1],d=a[2];return s*s+c*c+d*d},h.storeAuthState=function(a,s){s?Un.add(a):Un.delete(a)},h.sub=go,h.subtract=R,h.symbolSize=WA,h.tileAABB=function(a,s,c,d,m,y,x,E,T){if("globe"===T.name)return function qg(a,s,c){const d=s/a.worldSize,m=a.globeMatrix;if(c.z<=1){const yt=Ku(c).getCorners();return xE(yt,m,d),Es.fromPoints(yt)}const y=P0(c),x=vl(y);xE(x,m,d);const E=Number.MAX_VALUE,T=[-E,-E,-E],M=[E,E,E];if(y.contains(a.center)){for(const ln of x)D(M,M,ln),L(T,T,ln);T[2]=0;const yt=a.point,Bt=[yt.x*d,yt.y*d,0];return D(M,M,Bt),L(T,T,Bt),new Es(M,T)}const F=[m[12]*d,m[13]*d,m[14]*d],B=y.getCenter(),V=Rt(a.center.lat,-na,na),j=Rt(B.lat,-na,na),G=Ac(a.center.lng),Q=ql(V);let re=G-Ac(B.lng);const X=Q-ql(j);re>.5?re-=1:re<-.5&&(re+=1);let Ne=0;Math.abs(re)>Math.abs(X)?Ne=re>=0?1:3:(Ne=X>=0?0:2,me(F,F,[m[4]*d,m[5]*d,m[6]*d],-Math.sin(xt(X>=0?y.getSouth():y.getNorth()))*Dc));const H=x[Ne],Fe=x[(Ne+1)%4],Ze=new gF(H,Fe,F),We=[Bh(Ze,0)||H[0],Bh(Ze,1)||H[1],Bh(Ze,2)||H[2]],wt=ea(a.zoom);if(wt>0){const yt=function({x:ln,y:At,z:Ht},Gt,Qt,cn,Vt){const Cn=1/(1<<Ht);let Vn=ln*Cn,An=Vn+Cn,Pi=At*Cn,mn=Pi+Cn,ni=0;const ki=(Vn+An)/2-cn;return ki>.5?ni=-1:ki<-.5&&(ni=1),Vn=((Vn+ni)*Gt-(cn*=Gt))*Qt+cn,An=((An+ni)*Gt-cn)*Qt+cn,Pi=(Pi*Gt-(Vt*=Gt))*Qt+Vt,mn=(mn*Gt-Vt)*Qt+Vt,[[Vn,mn,0],[An,mn,0],[An,Pi,0],[Vn,Pi,0]]}(c,s,a._pixelsPerMercatorPixel,G,Q);for(let ln=0;ln<x.length;ln++)ep(x[ln],yt[ln],wt);const Bt=tu([],yt[Ne],yt[(Ne+1)%4]);Y(Bt,Bt,.5),ep(We,Bt,wt)}for(const yt of x)D(M,M,yt),L(T,T,yt);return M[2]=Math.min(H[2],Fe[2]),D(M,M,We),L(T,T,We),new Es(M,T)}(a,s,new Q0(c,d,m));const M=cu({z:c,x:d,y:m},T);return new Es([(y+M.x/M.scale)*s,s*(M.y/M.scale),x],[(y+M.x2/M.scale)*s,s*(M.y2/M.scale),E])},h.tileCornersToBounds=P0,h.tileTransform=cu,h.transformMat3=function(a,s,c){var d=s[0],m=s[1],y=s[2];return a[0]=d*c[0]+m*c[3]+y*c[6],a[1]=d*c[1]+m*c[4]+y*c[7],a[2]=d*c[2]+m*c[5]+y*c[8],a},h.transformMat4=Dn,h.transformMat4$1=Zu,h.transformQuat=mi,h.transitionTileAABBinECEF=Rs,h.translate=Ph,h.transpose=function(a,s){if(a===s){var c=s[1],d=s[2],m=s[5];a[1]=s[3],a[2]=s[6],a[3]=c,a[5]=s[7],a[6]=d,a[7]=m}else a[0]=s[0],a[1]=s[3],a[2]=s[6],a[3]=s[1],a[4]=s[4],a[5]=s[7],a[6]=s[2],a[7]=s[5],a[8]=s[8];return a},h.triggerPluginCompletionEvent=p,h.uniqueId=Oe,h.updateGlobeVertexNormal=function(a,s,c,d,m){const y=5*s+2;a.float32[y+0]=c,a.float32[y+1]=d,a.float32[y+2]=m},h.validateCustomStyleLayer=function(a){const s=[],c=a.id;return void 0===c&&s.push({message:`layers.${c}: missing required property "id"`}),void 0===a.render&&s.push({message:`layers.${c}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&s.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),s},h.validateFilter=a=>_a(Uu(a)),h.validateFog=a=>_a(Vf(a)),h.validateLayer=a=>_a(yc(a)),h.validateLight=a=>_a(ga(a)),h.validateSource=a=>_a(us(a)),h.validateStyle=zf,h.validateTerrain=a=>_a(mo(a)),h.values=yi,h.vectorTile=H0,h.version=He,h.warnOnce=ti,h.window=Me,h.wrap=Kt}),ie(0,function(h){function Me(Re){if("number"==typeof Re||"boolean"==typeof Re||"string"==typeof Re||null==Re)return JSON.stringify(Re);if(Array.isArray(Re)){let oe="[";for(const De of Re)oe+=`${Me(De)},`;return`${oe}]`}let te="{";for(const oe of Object.keys(Re).sort())te+=`${oe}:${Me(Re[oe])},`;return`${te}}`}function He(Re){let te="";for(const oe of h.refProperties)te+=`/${Me(Re[oe])}`;return te}class rt{constructor(te){this.keyCache={},te&&this.replace(te)}replace(te){this._layerConfigs={},this._layers={},this.update(te,[])}update(te,oe){for(const Be of te)this._layerConfigs[Be.id]=Be,(this._layers[Be.id]=h.createStyleLayer(Be)).compileFilter(),this.keyCache[Be.id]&&delete this.keyCache[Be.id];for(const Be of oe)delete this.keyCache[Be],delete this._layerConfigs[Be],delete this._layers[Be];this.familiesBySource={};const De=function(Be,Qe){const ut={};for(let et=0;et<Be.length;et++){const Et=Qe&&Qe[Be[et].id]||He(Be[et]);Qe&&(Qe[Be[et].id]=Et);let tn=ut[Et];tn||(tn=ut[Et]=[]),tn.push(Be[et])}const dt=[];for(const et in ut)dt.push(ut[et]);return dt}(h.values(this._layerConfigs),this.keyCache);for(const Be of De){const Qe=Be.map(Ee=>this._layers[Ee.id]),ut=Qe[0];if("none"===ut.visibility)continue;const dt=ut.source||"";let et=this.familiesBySource[dt];et||(et=this.familiesBySource[dt]={});const Et=ut.sourceLayer||"_geojsonTileLayer";let tn=et[Et];tn||(tn=et[Et]=[]),tn.push(Qe)}}}class se{loadTile(te,oe){const{uid:De,encoding:Be,rawImageData:Qe,padding:ut,buildQuadTree:dt}=te,et=h.window.ImageBitmap&&Qe instanceof h.window.ImageBitmap?this.getImageData(Qe,ut):Qe;oe(null,new h.DEMData(De,et,Be,ut<1,dt))}getImageData(te,oe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);const De=this.offscreenCanvasContext.getImageData(-oe,-oe,te.width+2*oe,te.height+2*oe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),De}}function ce(Re,te){if(0!==Re.length){xe(Re[0],te);for(var oe=1;oe<Re.length;oe++)xe(Re[oe],!te)}}function xe(Re,te){for(var oe=0,De=0,Be=0,Qe=Re.length,ut=Qe-1;Be<Qe;ut=Be++){var dt=(Re[Be][0]-Re[ut][0])*(Re[ut][1]+Re[Be][1]),et=oe+dt;De+=Math.abs(oe)>=Math.abs(dt)?oe-et+dt:dt-et+oe,oe=et}oe+De>=0!=!!te&&Re.reverse()}var ae=h.getDefaultExportFromCjs(function Re(te,oe){var De,Be=te&&te.type;if("FeatureCollection"===Be)for(De=0;De<te.features.length;De++)Re(te.features[De],oe);else if("GeometryCollection"===Be)for(De=0;De<te.geometries.length;De++)Re(te.geometries[De],oe);else if("Feature"===Be)Re(te.geometry,oe);else if("Polygon"===Be)ce(te.coordinates,oe);else if("MultiPolygon"===Be)for(De=0;De<te.coordinates.length;De++)ce(te.coordinates[De],oe);return te});const he=h.VectorTileFeature.prototype.toGeoJSON;var _e={exports:{}},ke=h.pointGeometry,$e=h.vectorTile.VectorTileFeature,Je=tt;function tt(Re,te){this.options=te||{},this.features=Re,this.length=Re.length}function Ie(Re,te){this.id="number"==typeof Re.id?Re.id:void 0,this.type=Re.type,this.rawGeometry=1===Re.type?[Re.geometry]:Re.geometry,this.properties=Re.tags,this.extent=te||4096}tt.prototype.feature=function(Re){return new Ie(this.features[Re],this.options.extent)},Ie.prototype.loadGeometry=function(){var Re=this.rawGeometry;this.geometry=[];for(var te=0;te<Re.length;te++){for(var oe=Re[te],De=[],Be=0;Be<oe.length;Be++)De.push(new ke(oe[Be][0],oe[Be][1]));this.geometry.push(De)}return this.geometry},Ie.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Re=this.geometry,te=1/0,oe=-1/0,De=1/0,Be=-1/0,Qe=0;Qe<Re.length;Qe++)for(var ut=Re[Qe],dt=0;dt<ut.length;dt++){var et=ut[dt];te=Math.min(te,et.x),oe=Math.max(oe,et.x),De=Math.min(De,et.y),Be=Math.max(Be,et.y)}return[te,De,oe,Be]},Ie.prototype.toGeoJSON=$e.prototype.toGeoJSON;var Le=h.pbf,mt=Je;function at(Re){var te=new Le;return function(oe,De){for(var Be in oe.layers)De.writeMessage(3,ze,oe.layers[Be])}(Re,te),te.finish()}function ze(Re,te){var oe;te.writeVarintField(15,Re.version||1),te.writeStringField(1,Re.name||""),te.writeVarintField(5,Re.extent||4096);var De={keys:[],values:[],keycache:{},valuecache:{}};for(oe=0;oe<Re.length;oe++)De.feature=Re.feature(oe),te.writeMessage(2,kt,De);var Be=De.keys;for(oe=0;oe<Be.length;oe++)te.writeStringField(3,Be[oe]);var Qe=De.values;for(oe=0;oe<Qe.length;oe++)te.writeMessage(4,Lt,Qe[oe])}function kt(Re,te){var oe=Re.feature;void 0!==oe.id&&te.writeVarintField(1,oe.id),te.writeMessage(2,fn,Re),te.writeVarintField(3,oe.type),te.writeMessage(4,pn,oe)}function fn(Re,te){var oe=Re.feature,De=Re.keys,Be=Re.values,Qe=Re.keycache,ut=Re.valuecache;for(var dt in oe.properties){var et=oe.properties[dt],Et=Qe[dt];if(null!==et){void 0===Et&&(De.push(dt),Qe[dt]=Et=De.length-1),te.writeVarint(Et);var tn=typeof et;"string"!==tn&&"boolean"!==tn&&"number"!==tn&&(et=JSON.stringify(et));var Ee=tn+":"+et,pe=ut[Ee];void 0===pe&&(Be.push(et),ut[Ee]=pe=Be.length-1),te.writeVarint(pe)}}}function xt(Re,te){return(te<<3)+(7&Re)}function lt(Re){return Re<<1^Re>>31}function pn(Re,te){for(var oe=Re.loadGeometry(),De=Re.type,Be=0,Qe=0,ut=oe.length,dt=0;dt<ut;dt++){var et=oe[dt],Et=1;1===De&&(Et=et.length),te.writeVarint(xt(1,Et));for(var tn=3===De?et.length-1:et.length,Ee=0;Ee<tn;Ee++){1===Ee&&1!==De&&te.writeVarint(xt(2,tn-1));var pe=et[Ee].x-Be,ne=et[Ee].y-Qe;te.writeVarint(lt(pe)),te.writeVarint(lt(ne)),Be+=pe,Qe+=ne}3===De&&te.writeVarint(xt(7,1))}}function Lt(Re,te){var oe=typeof Re;"string"===oe?te.writeStringField(1,Re):"boolean"===oe?te.writeBooleanField(7,Re):"number"===oe&&(Re%1!=0?te.writeDoubleField(3,Re):Re<0?te.writeSVarintField(6,Re):te.writeVarintField(5,Re))}_e.exports=at,_e.exports.fromVectorTileJs=at,_e.exports.fromGeojsonVt=function(Re,te){te=te||{};var oe={};for(var De in Re)oe[De]=new mt(Re[De].features,te),oe[De].name=De,oe[De].version=te.version,oe[De].extent=te.extent;return at({layers:oe})},_e.exports.GeoJSONWrapper=mt;var nn=h.getDefaultExportFromCjs(_e.exports);const wn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Re=>Re},Rt=Math.fround||(Jn=new Float32Array(1),Re=>(Jn[0]=+Re,Jn[0]));var Jn;const Kt=3,Hn=5,yi=6;class Pe{constructor(te){this.options=Object.assign(Object.create(wn),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:oe,minZoom:De,maxZoom:Be}=this.options;oe&&console.time("total time");const Qe=`prepare ${te.length} points`;oe&&console.time(Qe),this.points=te;const ut=[];for(let et=0;et<te.length;et++){const Et=te[et];if(!Et.geometry)continue;const[tn,Ee]=Et.geometry.coordinates,pe=Rt(Ue(tn)),ne=Rt(Ft(Ee));ut.push(pe,ne,1/0,et,-1,1),this.options.reduce&&ut.push(0)}let dt=this.trees[Be+1]=this._createTree(ut);oe&&console.timeEnd(Qe);for(let et=Be;et>=De;et--){const Et=+Date.now();dt=this.trees[et]=this._createTree(this._cluster(dt,et)),oe&&console.log("z%d: %d clusters in %dms",et,dt.numItems,+Date.now()-Et)}return oe&&console.timeEnd("total time"),this}getClusters(te,oe){let De=((te[0]+180)%360+360)%360-180;const Be=Math.max(-90,Math.min(90,te[1]));let Qe=180===te[2]?180:((te[2]+180)%360+360)%360-180;const ut=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)De=-180,Qe=180;else if(De>Qe){const Ee=this.getClusters([De,Be,180,ut],oe),pe=this.getClusters([-180,Be,Qe,ut],oe);return Ee.concat(pe)}const dt=this.trees[this._limitZoom(oe)],et=dt.range(Ue(De),Ft(ut),Ue(Qe),Ft(Be)),Et=dt.data,tn=[];for(const Ee of et){const pe=this.stride*Ee;tn.push(Et[pe+Hn]>1?qe(Et,pe,this.clusterProps):this.points[Et[pe+Kt]])}return tn}getChildren(te){const oe=this._getOriginId(te),De=this._getOriginZoom(te),Be="No cluster with the specified id.",Qe=this.trees[De];if(!Qe)throw new Error(Be);const ut=Qe.data;if(oe*this.stride>=ut.length)throw new Error(Be);const dt=this.options.radius/(this.options.extent*Math.pow(2,De-1)),et=Qe.within(ut[oe*this.stride],ut[oe*this.stride+1],dt),Et=[];for(const tn of et){const Ee=tn*this.stride;ut[Ee+4]===te&&Et.push(ut[Ee+Hn]>1?qe(ut,Ee,this.clusterProps):this.points[ut[Ee+Kt]])}if(0===Et.length)throw new Error(Be);return Et}getLeaves(te,oe,De){const Be=[];return this._appendLeaves(Be,te,oe=oe||10,De=De||0,0),Be}getTile(te,oe,De){const Be=this.trees[this._limitZoom(te)],Qe=Math.pow(2,te),{extent:ut,radius:dt}=this.options,et=dt/ut,Et=(De-et)/Qe,tn=(De+1+et)/Qe,Ee={features:[]};return this._addTileFeatures(Be.range((oe-et)/Qe,Et,(oe+1+et)/Qe,tn),Be.data,oe,De,Qe,Ee),0===oe&&this._addTileFeatures(Be.range(1-et/Qe,Et,1,tn),Be.data,Qe,De,Qe,Ee),oe===Qe-1&&this._addTileFeatures(Be.range(0,Et,et/Qe,tn),Be.data,-1,De,Qe,Ee),Ee.features.length?Ee:null}getClusterExpansionZoom(te){let oe=this._getOriginZoom(te)-1;for(;oe<=this.options.maxZoom;){const De=this.getChildren(te);if(oe++,1!==De.length)break;te=De[0].properties.cluster_id}return oe}_appendLeaves(te,oe,De,Be,Qe){const ut=this.getChildren(oe);for(const dt of ut){const et=dt.properties;if(et&&et.cluster?Qe+et.point_count<=Be?Qe+=et.point_count:Qe=this._appendLeaves(te,et.cluster_id,De,Be,Qe):Qe<Be?Qe++:te.push(dt),te.length===De)break}return Qe}_createTree(te){const oe=new h.KDBush(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let De=0;De<te.length;De+=this.stride)oe.add(te[De],te[De+1]);return oe.finish(),oe.data=te,oe}_addTileFeatures(te,oe,De,Be,Qe,ut){for(const dt of te){const et=dt*this.stride,Et=oe[et+Hn]>1;let tn,Ee,pe;if(Et)tn=Oe(oe,et,this.clusterProps),Ee=oe[et],pe=oe[et+1];else{const ee=this.points[oe[et+Kt]];tn=ee.properties;const[Te,bt]=ee.geometry.coordinates;Ee=Ue(Te),pe=Ft(bt)}const ne={type:1,geometry:[[Math.round(this.options.extent*(Ee*Qe-De)),Math.round(this.options.extent*(pe*Qe-Be))]],tags:tn};let ue;ue=Et||this.options.generateId?oe[et+Kt]:this.points[oe[et+Kt]].id,void 0!==ue&&(ne.id=ue),ut.features.push(ne)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,oe){const{radius:De,extent:Be,reduce:Qe,minPoints:ut}=this.options,dt=De/(Be*Math.pow(2,oe)),et=te.data,Et=[],tn=this.stride;for(let Ee=0;Ee<et.length;Ee+=tn){if(et[Ee+2]<=oe)continue;et[Ee+2]=oe;const pe=et[Ee],ne=et[Ee+1],ue=te.within(et[Ee],et[Ee+1],dt),ee=et[Ee+Hn];let Te=ee;for(const bt of ue){const En=bt*tn;et[En+2]>oe&&(Te+=et[En+Hn])}if(Te>ee&&Te>=ut){let bt,En=pe*ee,bn=ne*ee,Xn=-1;const vi=((Ee/tn|0)<<5)+(oe+1)+this.points.length;for(const Pn of ue){const Li=Pn*tn;if(et[Li+2]<=oe)continue;et[Li+2]=oe;const Un=et[Li+Hn];En+=et[Li]*Un,bn+=et[Li+1]*Un,et[Li+4]=vi,Qe&&(bt||(bt=this._map(et,Ee,!0),Xn=this.clusterProps.length,this.clusterProps.push(bt)),Qe(bt,this._map(et,Li)))}et[Ee+4]=vi,Et.push(En/Te,bn/Te,1/0,vi,-1,Te),Qe&&Et.push(Xn)}else{for(let bt=0;bt<tn;bt++)Et.push(et[Ee+bt]);if(Te>1)for(const bt of ue){const En=bt*tn;if(!(et[En+2]<=oe)){et[En+2]=oe;for(let bn=0;bn<tn;bn++)Et.push(et[En+bn])}}}}return Et}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,oe,De){if(te[oe+Hn]>1){const ut=this.clusterProps[te[oe+yi]];return De?Object.assign({},ut):ut}const Be=this.points[te[oe+Kt]].properties,Qe=this.options.map(Be);return De&&Qe===Be?Object.assign({},Qe):Qe}}function qe(Re,te,oe){return{type:"Feature",id:Re[te+Kt],properties:Oe(Re,te,oe),geometry:{type:"Point",coordinates:[(De=Re[te],360*(De-.5)),Ot(Re[te+1])]}};var De}function Oe(Re,te,oe){const De=Re[te+Hn],Be=De>=1e4?`${Math.round(De/1e3)}k`:De>=1e3?Math.round(De/100)/10+"k":De,Qe=Re[te+yi],ut=-1===Qe?{}:Object.assign({},oe[Qe]);return Object.assign(ut,{cluster:!0,cluster_id:Re[te+Kt],point_count:De,point_count_abbreviated:Be})}function Ue(Re){return Re/360+.5}function Ft(Re){const te=Math.sin(Re*Math.PI/180),oe=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return oe<0?0:oe>1?1:oe}function Ot(Re){const te=(180-360*Re)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function _n(Re,te,oe,De){for(var Be,Qe=De,ut=oe-te>>1,dt=oe-te,et=Re[te],Et=Re[te+1],tn=Re[oe],Ee=Re[oe+1],pe=te+3;pe<oe;pe+=3){var ne=Rn(Re[pe],Re[pe+1],et,Et,tn,Ee);if(ne>Qe)Be=pe,Qe=ne;else if(ne===Qe){var ue=Math.abs(pe-ut);ue<dt&&(Be=pe,dt=ue)}}Qe>De&&(Be-te>3&&_n(Re,te,Be,De),Re[Be+2]=Qe,oe-Be>3&&_n(Re,Be,oe,De))}function Rn(Re,te,oe,De,Be,Qe){var ut=Be-oe,dt=Qe-De;if(0!==ut||0!==dt){var et=((Re-oe)*ut+(te-De)*dt)/(ut*ut+dt*dt);et>1?(oe=Be,De=Qe):et>0&&(oe+=ut*et,De+=dt*et)}return(ut=Re-oe)*ut+(dt=te-De)*dt}function $t(Re,te,oe,De){var Be={id:void 0===Re?null:Re,type:te,geometry:oe,tags:De,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Qe){var ut=Qe.geometry,dt=Qe.type;if("Point"===dt||"MultiPoint"===dt||"LineString"===dt)qn(Qe,ut);else if("Polygon"===dt||"MultiLineString"===dt)for(var et=0;et<ut.length;et++)qn(Qe,ut[et]);else if("MultiPolygon"===dt)for(et=0;et<ut.length;et++)for(var Et=0;Et<ut[et].length;Et++)qn(Qe,ut[et][Et])}(Be),Be}function qn(Re,te){for(var oe=0;oe<te.length;oe+=3)Re.minX=Math.min(Re.minX,te[oe]),Re.minY=Math.min(Re.minY,te[oe+1]),Re.maxX=Math.max(Re.maxX,te[oe]),Re.maxY=Math.max(Re.maxY,te[oe+1])}function bi(Re,te,oe,De){if(te.geometry){var Be=te.geometry.coordinates,Qe=te.geometry.type,ut=Math.pow(oe.tolerance/((1<<oe.maxZoom)*oe.extent),2),dt=[],et=te.id;if(oe.promoteId?et=te.properties[oe.promoteId]:oe.generateId&&(et=De||0),"Point"===Qe)ur(Be,dt);else if("MultiPoint"===Qe)for(var Et=0;Et<Be.length;Et++)ur(Be[Et],dt);else if("LineString"===Qe)ti(Be,dt,ut,!1);else if("MultiLineString"===Qe){if(oe.lineMetrics){for(Et=0;Et<Be.length;Et++)ti(Be[Et],dt=[],ut,!1),Re.push($t(et,"LineString",dt,te.properties));return}Ei(Be,dt,ut,!1)}else if("Polygon"===Qe)Ei(Be,dt,ut,!0);else{if("MultiPolygon"!==Qe){if("GeometryCollection"===Qe){for(Et=0;Et<te.geometry.geometries.length;Et++)bi(Re,{id:et,geometry:te.geometry.geometries[Et],properties:te.properties},oe,De);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Et=0;Et<Be.length;Et++){var tn=[];Ei(Be[Et],tn,ut,!0),dt.push(tn)}}Re.push($t(et,Qe,dt,te.properties))}}function ur(Re,te){te.push(Vr(Re[0])),te.push(pr(Re[1])),te.push(0)}function ti(Re,te,oe,De){for(var Be,Qe,ut=0,dt=0;dt<Re.length;dt++){var et=Vr(Re[dt][0]),Et=pr(Re[dt][1]);te.push(et),te.push(Et),te.push(0),dt>0&&(ut+=De?(Be*Et-et*Qe)/2:Math.sqrt(Math.pow(et-Be,2)+Math.pow(Et-Qe,2))),Be=et,Qe=Et}var tn=te.length-3;te[2]=1,_n(te,0,tn,oe),te[tn+2]=1,te.size=Math.abs(ut),te.start=0,te.end=te.size}function Ei(Re,te,oe,De){for(var Be=0;Be<Re.length;Be++){var Qe=[];ti(Re[Be],Qe,oe,De),te.push(Qe)}}function Vr(Re){return Re/360+.5}function pr(Re){var te=Math.sin(Re*Math.PI/180),oe=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return oe<0?0:oe>1?1:oe}function dr(Re,te,oe,De,Be,Qe,ut,dt){if(De/=te,Qe>=(oe/=te)&&ut<De)return Re;if(ut<oe||Qe>=De)return null;for(var et=[],Et=0;Et<Re.length;Et++){var tn=Re[Et],Ee=tn.geometry,pe=tn.type,ne=0===Be?tn.minX:tn.minY,ue=0===Be?tn.maxX:tn.maxY;if(ne>=oe&&ue<De)et.push(tn);else if(!(ue<oe||ne>=De)){var ee=[];if("Point"===pe||"MultiPoint"===pe)lo(Ee,ee,oe,De,Be);else if("LineString"===pe)Fo(Ee,ee,oe,De,Be,!1,dt.lineMetrics);else if("MultiLineString"===pe)hi(Ee,ee,oe,De,Be,!1);else if("Polygon"===pe)hi(Ee,ee,oe,De,Be,!0);else if("MultiPolygon"===pe)for(var Te=0;Te<Ee.length;Te++){var bt=[];hi(Ee[Te],bt,oe,De,Be,!0),bt.length&&ee.push(bt)}if(ee.length){if(dt.lineMetrics&&"LineString"===pe){for(Te=0;Te<ee.length;Te++)et.push($t(tn.id,pe,ee[Te],tn.tags));continue}"LineString"!==pe&&"MultiLineString"!==pe||(1===ee.length?(pe="LineString",ee=ee[0]):pe="MultiLineString"),"Point"!==pe&&"MultiPoint"!==pe||(pe=3===ee.length?"Point":"MultiPoint"),et.push($t(tn.id,pe,ee,tn.tags))}}}return et.length?et:null}function lo(Re,te,oe,De,Be){for(var Qe=0;Qe<Re.length;Qe+=3){var ut=Re[Qe+Be];ut>=oe&&ut<=De&&(te.push(Re[Qe]),te.push(Re[Qe+1]),te.push(Re[Qe+2]))}}function Fo(Re,te,oe,De,Be,Qe,ut){for(var dt,et,Et=Lo(Re),tn=0===Be?bo:Wo,Ee=Re.start,pe=0;pe<Re.length-3;pe+=3){var ne=Re[pe],ue=Re[pe+1],ee=Re[pe+2],Te=Re[pe+3],bt=Re[pe+4],En=0===Be?ne:ue,bn=0===Be?Te:bt,Xn=!1;ut&&(dt=Math.sqrt(Math.pow(ne-Te,2)+Math.pow(ue-bt,2))),En<oe?bn>oe&&(et=tn(Et,ne,ue,Te,bt,oe),ut&&(Et.start=Ee+dt*et)):En>De?bn<De&&(et=tn(Et,ne,ue,Te,bt,De),ut&&(Et.start=Ee+dt*et)):Or(Et,ne,ue,ee),bn<oe&&En>=oe&&(et=tn(Et,ne,ue,Te,bt,oe),Xn=!0),bn>De&&En<=De&&(et=tn(Et,ne,ue,Te,bt,De),Xn=!0),!Qe&&Xn&&(ut&&(Et.end=Ee+dt*et),te.push(Et),Et=Lo(Re)),ut&&(Ee+=dt)}var vi=Re.length-3;ne=Re[vi],ue=Re[vi+1],ee=Re[vi+2],(En=0===Be?ne:ue)>=oe&&En<=De&&Or(Et,ne,ue,ee),vi=Et.length-3,Qe&&vi>=3&&(Et[vi]!==Et[0]||Et[vi+1]!==Et[1])&&Or(Et,Et[0],Et[1],Et[2]),Et.length&&te.push(Et)}function Lo(Re){var te=[];return te.size=Re.size,te.start=Re.start,te.end=Re.end,te}function hi(Re,te,oe,De,Be,Qe){for(var ut=0;ut<Re.length;ut++)Fo(Re[ut],te,oe,De,Be,Qe,!1)}function Or(Re,te,oe,De){Re.push(te),Re.push(oe),Re.push(De)}function bo(Re,te,oe,De,Be,Qe){var ut=(Qe-te)/(De-te);return Re.push(Qe),Re.push(oe+(Be-oe)*ut),Re.push(1),ut}function Wo(Re,te,oe,De,Be,Qe){var ut=(Qe-oe)/(Be-oe);return Re.push(te+(De-te)*ut),Re.push(Qe),Re.push(1),ut}function Jr(Re,te){for(var oe=[],De=0;De<Re.length;De++){var Be,Qe=Re[De],ut=Qe.type;if("Point"===ut||"MultiPoint"===ut||"LineString"===ut)Be=Ir(Qe.geometry,te);else if("MultiLineString"===ut||"Polygon"===ut){Be=[];for(var dt=0;dt<Qe.geometry.length;dt++)Be.push(Ir(Qe.geometry[dt],te))}else if("MultiPolygon"===ut)for(Be=[],dt=0;dt<Qe.geometry.length;dt++){for(var et=[],Et=0;Et<Qe.geometry[dt].length;Et++)et.push(Ir(Qe.geometry[dt][Et],te));Be.push(et)}oe.push($t(Qe.id,ut,Be,Qe.tags))}return oe}function Ir(Re,te){var oe=[];oe.size=Re.size,void 0!==Re.start&&(oe.start=Re.start,oe.end=Re.end);for(var De=0;De<Re.length;De+=3)oe.push(Re[De]+te,Re[De+1],Re[De+2]);return oe}function fo(Re,te){if(Re.transformed)return Re;var oe,De,Be,Qe=1<<Re.z,ut=Re.x,dt=Re.y;for(oe=0;oe<Re.features.length;oe++){var et=Re.features[oe],Et=et.geometry,tn=et.type;if(et.geometry=[],1===tn)for(De=0;De<Et.length;De+=2)et.geometry.push(So(Et[De],Et[De+1],te,Qe,ut,dt));else for(De=0;De<Et.length;De++){var Ee=[];for(Be=0;Be<Et[De].length;Be+=2)Ee.push(So(Et[De][Be],Et[De][Be+1],te,Qe,ut,dt));et.geometry.push(Ee)}}return Re.transformed=!0,Re}function So(Re,te,oe,De,Be,Qe){return[Math.round(oe*(Re*De-Be)),Math.round(oe*(te*De-Qe))]}function Mo(Re,te,oe,De,Be){for(var Qe=te===Be.maxZoom?0:Be.tolerance/((1<<te)*Be.extent),ut={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:oe,y:De,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},dt=0;dt<Re.length;dt++){ut.numFeatures++,co(ut,Re[dt],Qe,Be);var et=Re[dt].minX,Et=Re[dt].minY,tn=Re[dt].maxX,Ee=Re[dt].maxY;et<ut.minX&&(ut.minX=et),Et<ut.minY&&(ut.minY=Et),tn>ut.maxX&&(ut.maxX=tn),Ee>ut.maxY&&(ut.maxY=Ee)}return ut}function co(Re,te,oe,De){var Be=te.geometry,Qe=te.type,ut=[];if("Point"===Qe||"MultiPoint"===Qe)for(var dt=0;dt<Be.length;dt+=3)ut.push(Be[dt]),ut.push(Be[dt+1]),Re.numPoints++,Re.numSimplified++;else if("LineString"===Qe)Bi(ut,Be,Re,oe,!1,!1);else if("MultiLineString"===Qe||"Polygon"===Qe)for(dt=0;dt<Be.length;dt++)Bi(ut,Be[dt],Re,oe,"Polygon"===Qe,0===dt);else if("MultiPolygon"===Qe)for(var et=0;et<Be.length;et++){var Et=Be[et];for(dt=0;dt<Et.length;dt++)Bi(ut,Et[dt],Re,oe,!0,0===dt)}if(ut.length){var tn=te.tags||null;if("LineString"===Qe&&De.lineMetrics){for(var Ee in tn={},te.tags)tn[Ee]=te.tags[Ee];tn.mapbox_clip_start=Be.start/Be.size,tn.mapbox_clip_end=Be.end/Be.size}var pe={geometry:ut,type:"Polygon"===Qe||"MultiPolygon"===Qe?3:"LineString"===Qe||"MultiLineString"===Qe?2:1,tags:tn};null!==te.id&&(pe.id=te.id),Re.features.push(pe)}}function Bi(Re,te,oe,De,Be,Qe){var ut=De*De;if(De>0&&te.size<(Be?ut:De))oe.numPoints+=te.length/3;else{for(var dt=[],et=0;et<te.length;et+=3)(0===De||te[et+2]>ut)&&(oe.numSimplified++,dt.push(te[et]),dt.push(te[et+1])),oe.numPoints++;Be&&function(Et,tn){for(var Ee=0,pe=0,ne=Et.length,ue=ne-2;pe<ne;ue=pe,pe+=2)Ee+=(Et[pe]-Et[ue])*(Et[pe+1]+Et[ue+1]);if(Ee>0===tn)for(pe=0,ne=Et.length;pe<ne/2;pe+=2){var ee=Et[pe],Te=Et[pe+1];Et[pe]=Et[ne-2-pe],Et[pe+1]=Et[ne-1-pe],Et[ne-2-pe]=ee,Et[ne-1-pe]=Te}}(dt,Qe),Re.push(dt)}}function qr(Re,te){var oe=(te=this.options=function(Be,Qe){for(var ut in Qe)Be[ut]=Qe[ut];return Be}(Object.create(this.options),te)).debug;if(oe&&console.time("preprocess data"),te.maxZoom<0||te.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(te.promoteId&&te.generateId)throw new Error("promoteId and generateId cannot be used together.");var Be,Qe,ut,dt,et,Et,De=function(Be,Qe){var ut=[];if("FeatureCollection"===Be.type)for(var dt=0;dt<Be.features.length;dt++)bi(ut,Be.features[dt],Qe,dt);else bi(ut,"Feature"===Be.type?Be:{geometry:Be},Qe);return ut}(Re,te);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",te.indexMaxZoom,te.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),dt=Be=De,et=dr(Be,1,-1-(ut=(Qe=te).buffer/Qe.extent),ut,0,-1,2,Qe),Et=dr(Be,1,1-ut,2+ut,0,-1,2,Qe),(et||Et)&&(dt=dr(Be,1,-ut,1+ut,0,-1,2,Qe)||[],et&&(dt=Jr(et,1).concat(dt)),Et&&(dt=dt.concat(Jr(Et,-1)))),(De=dt).length&&this.splitTile(De,0,0,0),oe&&(De.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Sr(Re,te,oe){return 32*((1<<Re)*oe+te)+Re}function Ks(Re,te){const oe=Re.tileID.canonical;if(!this._geoJSONIndex)return te(null,null);const De=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!De)return te(null,null);const Be=new class{constructor(ut){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=ut.length,this._features=ut}feature(ut){return new class{constructor(dt){this._feature=dt,this.extent=h.EXTENT,this.type=dt.type,this.properties=dt.tags,"id"in dt&&!isNaN(dt.id)&&(this.id=parseInt(dt.id,10))}loadGeometry(){if(1===this._feature.type){const dt=[];for(const et of this._feature.geometry)dt.push([new h.Point(et[0],et[1])]);return dt}{const dt=[];for(const et of this._feature.geometry){const Et=[];for(const tn of et)Et.push(new h.Point(tn[0],tn[1]));dt.push(Et)}return dt}}toGeoJSON(dt,et,Et){return he.call(this,dt,et,Et)}}(this._features[ut])}}(De.features);let Qe=nn(Be);0===Qe.byteOffset&&Qe.byteLength===Qe.buffer.byteLength||(Qe=new Uint8Array(Qe)),te(null,{vectorTile:Be,rawData:Qe.buffer})}qr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},qr.prototype.splitTile=function(Re,te,oe,De,Be,Qe,ut){for(var dt=[Re,te,oe,De],et=this.options,Et=et.debug;dt.length;){De=dt.pop(),oe=dt.pop(),te=dt.pop(),Re=dt.pop();var tn=1<<te,Ee=Sr(te,oe,De),pe=this.tiles[Ee];if(!pe&&(Et>1&&console.time("creation"),pe=this.tiles[Ee]=Mo(Re,te,oe,De,et),this.tileCoords.push({z:te,x:oe,y:De}),Et)){Et>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",te,oe,De,pe.numFeatures,pe.numPoints,pe.numSimplified),console.timeEnd("creation"));var ne="z"+te;this.stats[ne]=(this.stats[ne]||0)+1,this.total++}if(pe.source=Re,Be){if(te===et.maxZoom||te===Be)continue;var ue=1<<Be-te;if(oe!==Math.floor(Qe/ue)||De!==Math.floor(ut/ue))continue}else if(te===et.indexMaxZoom||pe.numPoints<=et.indexMaxPoints)continue;if(pe.source=null,0!==Re.length){Et>1&&console.time("clipping");var ee,Te,bt,En,bn,Xn,vi=.5*et.buffer/et.extent,Pn=.5-vi,Li=.5+vi,Un=1+vi;ee=Te=bt=En=null,bn=dr(Re,tn,oe-vi,oe+Li,0,pe.minX,pe.maxX,et),Xn=dr(Re,tn,oe+Pn,oe+Un,0,pe.minX,pe.maxX,et),Re=null,bn&&(ee=dr(bn,tn,De-vi,De+Li,1,pe.minY,pe.maxY,et),Te=dr(bn,tn,De+Pn,De+Un,1,pe.minY,pe.maxY,et),bn=null),Xn&&(bt=dr(Xn,tn,De-vi,De+Li,1,pe.minY,pe.maxY,et),En=dr(Xn,tn,De+Pn,De+Un,1,pe.minY,pe.maxY,et),Xn=null),Et>1&&console.timeEnd("clipping"),dt.push(ee||[],te+1,2*oe,2*De),dt.push(Te||[],te+1,2*oe,2*De+1),dt.push(bt||[],te+1,2*oe+1,2*De),dt.push(En||[],te+1,2*oe+1,2*De+1)}}},qr.prototype.getTile=function(Re,te,oe){var De=this.options,Be=De.extent,Qe=De.debug;if(Re<0||Re>24)return null;var ut=1<<Re,dt=Sr(Re,te=(te%ut+ut)%ut,oe);if(this.tiles[dt])return fo(this.tiles[dt],Be);Qe>1&&console.log("drilling down to z%d-%d-%d",Re,te,oe);for(var et,Et=Re,tn=te,Ee=oe;!et&&Et>0;)Et--,tn=Math.floor(tn/2),Ee=Math.floor(Ee/2),et=this.tiles[Sr(Et,tn,Ee)];return et&&et.source?(Qe>1&&console.log("found parent tile z%d-%d-%d",Et,tn,Ee),Qe>1&&console.time("drilling down"),this.splitTile(et.source,Et,tn,Ee,Re,te,oe),Qe>1&&console.timeEnd("drilling down"),this.tiles[dt]?fo(this.tiles[dt],Be):null):null};class vr extends h.VectorTileWorkerSource{constructor(te,oe,De,Be,Qe){super(te,oe,De,Be,Ks),Qe&&(this.loadGeoJSON=Qe)}loadData(te,oe){const De=te&&te.request,Be=De&&De.collectResourceTiming;this.loadGeoJSON(te,(Qe,ut)=>{if(Qe||!ut)return oe(Qe);if("object"!=typeof ut)return oe(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));{ae(ut,!0);try{if(te.filter){const et=h.createExpression(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===et.result)throw new Error(et.value.map(tn=>`${tn.key}: ${tn.message}`).join(", "));ut={type:"FeatureCollection",features:ut.features.filter(tn=>et.value.evaluate({zoom:0},tn))}}this._geoJSONIndex=te.cluster?new Pe(function({superclusterOptions:et,clusterProperties:Et}){if(!Et||!et)return et;const tn={},Ee={},pe={accumulated:null,zoom:0},ne={properties:null},ue=Object.keys(Et);for(const ee of ue){const[Te,bt]=Et[ee],En=h.createExpression(bt),bn=h.createExpression("string"==typeof Te?[Te,["accumulated"],["get",ee]]:Te);tn[ee]=En.value,Ee[ee]=bn.value}return et.map=ee=>{ne.properties=ee;const Te={};for(const bt of ue)Te[bt]=tn[bt].evaluate(pe,ne);return Te},et.reduce=(ee,Te)=>{ne.properties=Te;for(const bt of ue)pe.accumulated=ee[bt],ee[bt]=Ee[bt].evaluate(pe,ne)},et}(te)).load(ut.features):new qr(et=ut,te.geojsonVtOptions)}catch(et){return oe(et)}this.loaded={};const dt={};if(Be){const et=h.getPerformanceMeasurement(De);et&&(dt.resourceTiming={},dt.resourceTiming[te.source]=JSON.parse(JSON.stringify(et)))}oe(null,dt)}var et})}reloadTile(te,oe){const De=this.loaded;return De&&De[te.uid]?super.reloadTile(te,oe):this.loadTile(te,oe)}loadGeoJSON(te,oe){if(te.request)h.getJSON(te.request,oe);else{if("string"!=typeof te.data)return oe(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));try{return oe(null,JSON.parse(te.data))}catch{return oe(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(te,oe){try{oe(null,this._geoJSONIndex.getClusterExpansionZoom(te.clusterId))}catch(De){oe(De)}}getClusterChildren(te,oe){try{oe(null,this._geoJSONIndex.getChildren(te.clusterId))}catch(De){oe(De)}}getClusterLeaves(te,oe){try{oe(null,this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset))}catch(De){oe(De)}}}class zr{constructor(te){this.self=te,this.actor=new h.Actor(te,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=h.getProjection({name:"mercator"}),this.workerSourceTypes={vector:h.VectorTileWorkerSource,geojson:vr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(oe,De)=>{if(this.workerSourceTypes[oe])throw new Error(`Worker source with name "${oe}" already registered.`);this.workerSourceTypes[oe]=De},this.self.registerRTLTextPlugin=oe=>{if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=oe.applyArabicShaping,h.plugin.processBidirectionalText=oe.processBidirectionalText,h.plugin.processStyledBidirectionalText=oe.processStyledBidirectionalText}}clearCaches(te,oe,De){delete this.layerIndexes[te],delete this.availableImages[te],delete this.workerSources[te],delete this.demWorkerSources[te],De()}checkIfReady(te,oe,De){De()}setReferrer(te,oe){this.referrer=oe}spriteLoaded(te,oe){this.isSpriteLoaded[te]=oe;for(const De in this.workerSources[te]){const Be=this.workerSources[te][De];for(const Qe in Be)Be[Qe]instanceof h.VectorTileWorkerSource&&(Be[Qe].isSpriteLoaded=oe,Be[Qe].fire(new h.Event("isSpriteLoaded")))}}setImages(te,oe,De){this.availableImages[te]=oe;for(const Be in this.workerSources[te]){const Qe=this.workerSources[te][Be];for(const ut in Qe)Qe[ut].availableImages=oe}De()}enableTerrain(te,oe,De){this.terrain=oe,De()}setProjection(te,oe){this.projections[te]=h.getProjection(oe)}setLayers(te,oe,De){this.getLayerIndex(te).replace(oe),De()}updateLayers(te,oe,De){this.getLayerIndex(te).update(oe.layers,oe.removedIds),De()}loadTile(te,oe,De){const Be=this.enableTerrain?h.extend({enableTerrain:this.terrain},oe):oe;Be.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,oe.type,oe.source).loadTile(Be,De)}loadDEMTile(te,oe,De){const Be=this.enableTerrain?h.extend({buildQuadTree:this.terrain},oe):oe;this.getDEMWorkerSource(te,oe.source).loadTile(Be,De)}reloadTile(te,oe,De){const Be=this.enableTerrain?h.extend({enableTerrain:this.terrain},oe):oe;Be.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,oe.type,oe.source).reloadTile(Be,De)}abortTile(te,oe,De){this.getWorkerSource(te,oe.type,oe.source).abortTile(oe,De)}removeTile(te,oe,De){this.getWorkerSource(te,oe.type,oe.source).removeTile(oe,De)}removeSource(te,oe,De){if(!this.workerSources[te]||!this.workerSources[te][oe.type]||!this.workerSources[te][oe.type][oe.source])return;const Be=this.workerSources[te][oe.type][oe.source];delete this.workerSources[te][oe.type][oe.source],void 0!==Be.removeSource?Be.removeSource(oe,De):De()}loadWorkerSource(te,oe,De){try{this.self.importScripts(oe.url),De()}catch(Be){De(Be.toString())}}syncRTLPluginState(te,oe,De){try{h.plugin.setState(oe);const Be=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&null!=Be){this.self.importScripts(Be);const Qe=h.plugin.isParsed();De(Qe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Be}`),Qe)}}catch(Be){De(Be.toString())}}getAvailableImages(te){let oe=this.availableImages[te];return oe||(oe=[]),oe}getLayerIndex(te){let oe=this.layerIndexes[te];return oe||(oe=this.layerIndexes[te]=new rt),oe}getWorkerSource(te,oe,De){return this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][oe]||(this.workerSources[te][oe]={}),this.workerSources[te][oe][De]||(this.workerSources[te][oe][De]=new this.workerSourceTypes[oe]({send:(Qe,ut,dt,et,Et,tn)=>{this.actor.send(Qe,ut,dt,te,Et,tn)},scheduler:this.actor.scheduler},this.getLayerIndex(te),this.getAvailableImages(te),this.isSpriteLoaded[te])),this.workerSources[te][oe][De]}getDEMWorkerSource(te,oe){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][oe]||(this.demWorkerSources[te][oe]=new se),this.demWorkerSources[te][oe]}enforceCacheSizeLimit(te,oe){h.enforceCacheSizeLimit(oe)}getWorkerPerformanceMetrics(te,oe,De){De(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new zr(self)),zr}),ie(0,function(h){function Me(_,u){if(Array.isArray(_)){if(!Array.isArray(u)||_.length!==u.length)return!1;for(let p=0;p<_.length;p++)if(!Me(_[p],u[p]))return!1;return!0}if("object"==typeof _&&null!==_&&null!==u){if("object"!=typeof u||Object.keys(_).length!==Object.keys(u).length)return!1;for(const p in _)if(!Me(_[p],u[p]))return!1;return!0}return _===u}var He=rt;function rt(_){return u=_,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,w,I=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(I);try{w=new Worker(P),v=!0}catch{v=!1}return w&&w.terminate(),URL.revokeObjectURL(P),v}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var v=document.createElement("canvas");v.width=v.height=1;var w=v.getContext("2d");if(!w)return!1;var I=w.getImageData(0,0,1,1);return I&&I.width===v.width}()||(void 0===se[p=u&&u.failIfMajorPerformanceCaveat]&&(se[p]=function(v){var w,P,k,N,I=(P=v,k=document.createElement("canvas"),(N=Object.create(rt.webGLContextAttributes)).failIfMajorPerformanceCaveat=P,k.getContext("webgl",N)||k.getContext("experimental-webgl",N));if(!I)return!1;try{w=I.createShader(I.VERTEX_SHADER)}catch{return!1}return!(!w||I.isContextLost())&&(I.shaderSource(w,"void main() {}"),I.compileShader(w),!0===I.getShaderParameter(w,I.COMPILE_STATUS))}(p)),!se[p]||document.documentMode));var u,p}var se={};function ce(_,u,p){const v=h.window.document.createElement(_);return void 0!==u&&(v.className=u),p&&p.appendChild(v),v}function xe(_,u,p){const v=h.window.document.createElementNS("http://www.w3.org/2000/svg",_);for(const w of Object.keys(u))v.setAttributeNS(null,w,u[w]);return p&&p.appendChild(v),v}rt.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ae=h.window.document&&h.window.document.documentElement.style,he=ae&&void 0!==ae.userSelect?"userSelect":"WebkitUserSelect";let _e;function ke(){ae&&he&&(_e=ae[he],ae[he]="none")}function $e(){ae&&he&&(ae[he]=_e)}function Je(_){_.preventDefault(),_.stopPropagation(),h.window.removeEventListener("click",Je,!0)}function tt(){h.window.addEventListener("click",Je,!0),h.window.setTimeout(()=>{h.window.removeEventListener("click",Je,!0)},0)}function Ie(_,u){const p=_.getBoundingClientRect();return at(_,p,u)}function Le(_,u){const p=_.getBoundingClientRect(),v=[];for(let w=0;w<u.length;w++)v.push(at(_,p,u[w]));return v}function mt(_){return void 0!==h.window.InstallTrigger&&2===_.button&&_.ctrlKey&&h.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:_.button}function at(_,u,p){const v=_.offsetWidth===u.width?1:_.offsetWidth/u.width;return new h.Point((p.clientX-u.left)*v,(p.clientY-u.top)*v)}function ze(_,u){var p=u[0],v=u[1],w=u[2],I=u[3],P=p*I-w*v;return P?(_[0]=I*(P=1/P),_[1]=-v*P,_[2]=-w*P,_[3]=p*P,_):null}function kt(_){const{userImage:u}=_;return!!(u&&u.render&&u.render())&&(_.data.replace(new Uint8Array(u.data.buffer)),!0)}class fn extends h.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(u){if(this.loaded!==u&&(this.loaded=u,u)){for(const{ids:p,callback:v}of this.requestors)this._notify(p,v);this.requestors=[]}}hasImage(u){return!!this.getImage(u)}getImage(u){return this.images[u]}addImage(u,p){this._validate(u,p)&&(this.images[u]=p)}_validate(u,p){let v=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new h.ErrorEvent(new Error(`Image "${u}" has invalid "stretchX" value`))),v=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new h.ErrorEvent(new Error(`Image "${u}" has invalid "stretchY" value`))),v=!1),this._validateContent(p.content,p)||(this.fire(new h.ErrorEvent(new Error(`Image "${u}" has invalid "content" value`))),v=!1),v}_validateStretch(u,p){if(!u)return!0;let v=0;for(const w of u){if(w[0]<v||w[1]<w[0]||p<w[1])return!1;v=w[1]}return!0}_validateContent(u,p){return!(u&&(4!==u.length||u[0]<0||p.data.width<u[0]||u[1]<0||p.data.height<u[1]||u[2]<0||p.data.width<u[2]||u[3]<0||p.data.height<u[3]||u[2]<u[0]||u[3]<u[1]))}updateImage(u,p){p.version=this.images[u].version+1,this.images[u]=p,this.updatedImages[u]=!0}removeImage(u){const p=this.images[u];delete this.images[u],delete this.patterns[u],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(u,p){let v=!0;if(!this.isLoaded())for(const w of u)this.images[w]||(v=!1);this.isLoaded()||v?this._notify(u,p):this.requestors.push({ids:u,callback:p})}_notify(u,p){const v={};for(const w of u){this.images[w]||this.fire(new h.Event("styleimagemissing",{id:w}));const I=this.images[w];I?v[w]={data:I.data.clone(),pixelRatio:I.pixelRatio,sdf:I.sdf,version:I.version,stretchX:I.stretchX,stretchY:I.stretchY,content:I.content,hasRenderCallback:!(!I.userImage||!I.userImage.render)}:h.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,v)}getPixelSize(){const{width:u,height:p}=this.atlasImage;return{width:u,height:p}}getPattern(u){const p=this.patterns[u],v=this.getImage(u);if(!v)return null;if(p&&p.position.version===v.version)return p.position;if(p)p.position.version=v.version;else{const w={w:v.data.width+2,h:v.data.height+2,x:0,y:0},I=new h.ImagePosition(w,v);this.patterns[u]={bin:w,position:I}}return this._updatePatternAtlas(),this.patterns[u].position}bind(u){const p=u.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.Texture(u,this.atlasImage,p.RGBA),this.atlasTexture&&this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(){const u=[];for(const I in this.patterns)u.push(this.patterns[I].bin);const{w:p,h:v}=h.potpack(u),w=this.atlasImage;w.resize({width:p||1,height:v||1});for(const I in this.patterns){const{bin:P}=this.patterns[I],k=P.x+1,N=P.y+1,U=this.images[I].data,z=U.width,q=U.height;h.RGBAImage.copy(U,w,{x:0,y:0},{x:k,y:N},{width:z,height:q}),h.RGBAImage.copy(U,w,{x:0,y:q-1},{x:k,y:N-1},{width:z,height:1}),h.RGBAImage.copy(U,w,{x:0,y:0},{x:k,y:N+q},{width:z,height:1}),h.RGBAImage.copy(U,w,{x:z-1,y:0},{x:k-1,y:N},{width:1,height:q}),h.RGBAImage.copy(U,w,{x:0,y:0},{x:k+z,y:N},{width:1,height:q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(u){for(const p of u){if(this.callbackDispatchedThisFrame[p])continue;this.callbackDispatchedThisFrame[p]=!0;const v=this.images[p];kt(v)&&this.updateImage(p,v)}}}const xt=new h.Properties({anchor:new h.DataConstantProperty(h.spec.light.anchor),position:new class{constructor(){this.specification=h.spec.light.position}possiblyEvaluate(_,u){return function([p,v,w]){const I=h.degToRad(v+90),P=h.degToRad(w);return{x:p*Math.cos(I)*Math.sin(P),y:p*Math.sin(I)*Math.sin(P),z:p*Math.cos(P),azimuthal:v,polar:w}}(_.expression.evaluate(u))}interpolate(_,u,p){return{x:h.number(_.x,u.x,p),y:h.number(_.y,u.y,p),z:h.number(_.z,u.z,p),azimuthal:h.number(_.azimuthal,u.azimuthal,p),polar:h.number(_.polar,u.polar,p)}}},color:new h.DataConstantProperty(h.spec.light.color),intensity:new h.DataConstantProperty(h.spec.light.intensity)});class lt extends h.Evented{constructor(u){super(),this._transitionable=new h.Transitionable(xt),this.setLight(u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,p={}){if(!this._validate(h.validateLight,u,p))for(const v in u){const w=u[v];h.endsWith(v,"-transition")?this._transitionable.setTransition(v.slice(0,-11),w):this._transitionable.setValue(v,w)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,p,v){return(!v||!1!==v.validate)&&h.emitValidationErrors(this,u.call(h.validateStyle,h.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:h.spec})))}}const pn=new h.Properties({source:new h.DataConstantProperty(h.spec.terrain.source),exaggeration:new h.DataConstantProperty(h.spec.terrain.exaggeration)});let Lt=class extends h.Evented{constructor(_,u){super(),this._transitionable=new h.Transitionable(pn),this.set(_),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(_){for(const u in _){const p=_[u];h.endsWith(u,"-transition")?this._transitionable.setTransition(u.slice(0,-11),p):this._transitionable.setValue(u,p)}}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}};function nn(_,u,p,v){const w=h.smoothstep(45,65,p),[I,P]=wn(_,v),k=h.length(u);let N=1-Math.min(1,Math.exp((k-I)/(P-I)*-6));return N*=N*N,N=Math.min(1,1.00747*N),N*w*_.alpha}function wn(_,u){const p=.5/Math.tan(.5*u);return[_.range[0]+p,_.range[1]+p]}const Rt=new h.Properties({range:new h.DataConstantProperty(h.spec.fog.range),color:new h.DataConstantProperty(h.spec.fog.color),"high-color":new h.DataConstantProperty(h.spec.fog["high-color"]),"space-color":new h.DataConstantProperty(h.spec.fog["space-color"]),"horizon-blend":new h.DataConstantProperty(h.spec.fog["horizon-blend"]),"star-intensity":new h.DataConstantProperty(h.spec.fog["star-intensity"])});class Jn extends h.Evented{constructor(u,p){super(),this._transitionable=new h.Transitionable(Rt),this.set(u),this._transitioning=this._transitionable.untransitioned(),this._transform=p}get state(){const u=this._transform,p="globe"===u.projection.name,v=h.globeToMercatorTransition(u.zoom),w=this.properties.get("range"),I=[.5,3];return{range:p?[h.number(I[0],w[0],v),h.number(I[1],w[1],v)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(u,p={}){if(!this._validate(h.validateFog,u,p)){for(const v of Object.keys(h.spec.fog))u&&void 0===u[v]&&(u[v]=h.spec.fog[v].default);for(const v in u){const w=u[v];h.endsWith(v,"-transition")?this._transitionable.setTransition(v.slice(0,-11),w):this._transitionable.setValue(v,w)}}}getOpacity(u){if(!this._transform.projection.supportsFog)return 0;const p=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:h.smoothstep(45,65,u))*p.a}getOpacityAtLatLng(u,p){return this._transform.projection.supportsFog?function(v,w,I){const P=h.MercatorCoordinate.fromLngLat(w),k=I.elevation?I.elevation.getAtPointOrZero(P):0,N=[P.x,P.y,k];return h.transformMat4(N,N,I.mercatorFogMatrix),nn(v,N,I.pitch,I._fov)}(this.state,u,p):0}getFovAdjustedRange(u){return this._transform.projection.supportsFog?wn(this.state,u):[0,1]}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,p,v){return(!v||!1!==v.validate)&&h.emitValidationErrors(this,u.call(h.validateStyle,h.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:h.spec})))}}class Kt{constructor(u,p){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=h.uniqueId();const v=this.workerPool.acquire(this.id);for(let w=0;w<v.length;w++){const I=new Kt.Actor(v[w],p,this.id);I.name=`Worker ${w}`,this.actors.push(I)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(u,p,v){h.asyncAll(this.actors,(w,I)=>{w.send(u,p,I)},v=v||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(u=>{u.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Hn(_,u,p){return u*(h.EXTENT/(_.tileSize*Math.pow(2,p-_.tileID.overscaledZ)))}Kt.Actor=h.Actor;class yi{constructor(u,p,v,w){this.screenBounds=u,this.cameraPoint=p,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=v,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(u,p){let v,w;if(u instanceof h.Point||"number"==typeof u[0]){const I=h.Point.convert(u);v=[I],w=p.isPointAboveHorizon(I)}else{const I=h.Point.convert(u[0]),P=h.Point.convert(u[1]);v=[I,P],w=h.polygonizeBounds(I,P).every(k=>p.isPointAboveHorizon(k))}return new yi(v,p.getCameraPoint(),w,p)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(u){return h.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],u)}bufferedCameraGeometry(u){const p=this.screenBounds[0],v=1===this.screenBounds.length?this.screenBounds[0].add(new h.Point(1,1)):this.screenBounds[1],w=h.polygonizeBounds(p,v,0,!1);return this.cameraPoint.y>v.y&&(this.cameraPoint.x>p.x&&this.cameraPoint.x<v.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=v.x?w[2]=this.cameraPoint:this.cameraPoint.x<=p.x&&(w[3]=this.cameraPoint)),h.bufferConvexPolygon(w,u)}bufferedCameraGeometryGlobe(u){const p=this.screenBounds[0],v=1===this.screenBounds.length?this.screenBounds[0].add(new h.Point(1,1)):this.screenBounds[1],w=h.polygonizeBounds(p,v,u),I=this.cameraPoint.clone();switch(3*((I.y>p.y)+(I.y>v.y))+((I.x>p.x)+(I.x>v.x))){case 0:w[0]=I,w[4]=I.clone();break;case 1:w.splice(1,0,I);break;case 2:w[1]=I;break;case 3:w.splice(4,0,I);break;case 5:w.splice(2,0,I);break;case 6:w[3]=I;break;case 7:w.splice(3,0,I);break;case 8:w[2]=I}return w}containsTile(u,p,v,w=0){const I=u.queryPadding/p._pixelsPerMercatorPixel+1,P=v?this._bufferedCameraMercator(I,p):this._bufferedScreenMercator(I,p);let k=u.tileID.wrap+(P.unwrapped?w:0);const N=P.polygon.map(we=>h.getTilePoint(u.tileTransform,we,k));if(!h.polygonIntersectsBox(N,0,0,h.EXTENT,h.EXTENT))return;k=u.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const U=this.screenGeometryMercator.polygon.map(we=>h.getTileVec3(u.tileTransform,we,k)),z=U.map(we=>new h.Point(we[0],we[1])),q=p.getFreeCameraOptions().position||new h.MercatorCoordinate(0,0,0),le=h.getTileVec3(u.tileTransform,q,k),ye=U.map(we=>{const K=h.sub(we,we,le);return h.normalize(K,K),new h.Ray(le,K)}),be=Hn(u,1,p.zoom)*p._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:z,tilespaceRays:ye,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(ve=h.getBounds(N),ve.min.x=h.clamp(ve.min.x,0,h.EXTENT),ve.min.y=h.clamp(ve.min.y,0,h.EXTENT),ve.max.x=h.clamp(ve.max.x,0,h.EXTENT),ve.max.y=h.clamp(ve.max.y,0,h.EXTENT),ve),tile:u,tileID:u.tileID,pixelToTileUnitsFactor:be};var ve}_bufferedScreenMercator(u,p){const v=Oe(u);if(this._screenRaycastCache[v])return this._screenRaycastCache[v];{let w;return w="globe"===p.projection.name?this._projectAndResample(this.bufferedScreenGeometry(u),p):{polygon:this.bufferedScreenGeometry(u).map(I=>p.pointCoordinate3D(I)),unwrapped:!0},this._screenRaycastCache[v]=w,w}}_bufferedCameraMercator(u,p){const v=Oe(u);if(this._cameraRaycastCache[v])return this._cameraRaycastCache[v];{let w;return w="globe"===p.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(u),p):{polygon:this.bufferedCameraGeometry(u).map(I=>p.pointCoordinate3D(I)),unwrapped:!0},this._cameraRaycastCache[v]=w,w}}_projectAndResample(u,p){const v=function(I,P){const k=h.multiply([],P.pixelMatrix,P.globeMatrix),N=[0,-h.GLOBE_RADIUS,0,1],U=[0,h.GLOBE_RADIUS,0,1],z=[0,0,0,1];h.transformMat4$1(N,N,k),h.transformMat4$1(U,U,k),h.transformMat4$1(z,z,k);const q=new h.Point(N[0]/N[3],N[1]/N[3]),le=new h.Point(U[0]/U[3],U[1]/U[3]),ye=h.polygonContainsPoint(I,q)&&N[3]<z[3],be=h.polygonContainsPoint(I,le)&&U[3]<z[3];if(!ye&&!be)return null;const ve=function(Xe,ct,st){for(let Ct=1;Ct<Xe.length;Ct++){const rn=qe(ct.pointCoordinate3D(Xe[Ct-1]).x),_t=qe(ct.pointCoordinate3D(Xe[Ct]).x);if(st<0){if(rn<_t)return{idx:Ct,t:-rn/(_t-1-rn)}}else if(_t<rn)return{idx:Ct,t:(1-rn)/(_t+1-rn)}}return null}(I,P,ye?-1:1);if(!ve)return null;const{idx:we,t:K}=ve;let de=we>1?Pe(I.slice(0,we),P):[],Ae=we<I.length?Pe(I.slice(we),P):[];de=de.map(Xe=>new h.Point(qe(Xe.x),Xe.y)),Ae=Ae.map(Xe=>new h.Point(qe(Xe.x),Xe.y));const Se=[...de];0===Se.length&&Se.push(Ae[Ae.length-1]);const Ge=h.number(Se[Se.length-1].y,(0===Ae.length?de[0]:Ae[0]).y,K);let Ye;return Ye=ye?[new h.Point(0,Ge),new h.Point(0,0),new h.Point(1,0),new h.Point(1,Ge)]:[new h.Point(1,Ge),new h.Point(1,1),new h.Point(0,1),new h.Point(0,Ge)],Se.push(...Ye),0===Ae.length?Se.push(de[0]):Se.push(...Ae),{polygon:Se.map(Xe=>new h.MercatorCoordinate(Xe.x,Xe.y)),unwrapped:!1}}(u,p);if(v)return v;const w=function(I,P){let k=!1,N=-1/0,U=0;for(let q=0;q<I.length-1;q++)I[q].x>N&&(N=I[q].x,U=q);for(let q=0;q<I.length-1;q++){const le=(U+q)%(I.length-1),ye=I[le],be=I[le+1];Math.abs(ye.x-be.x)>.5&&(ye.x<be.x?(ye.x+=1,0===le&&(I[I.length-1].x+=1)):(be.x+=1,le+1===I.length-1&&(I[0].x+=1)),k=!0)}const z=h.mercatorXfromLng(P.center.lng);return k&&z<Math.abs(z-1)&&I.forEach(q=>{q.x-=1}),{polygon:I,unwrapped:k}}(Pe(u,p).map(I=>new h.Point(qe(I.x),I.y)),p);return{polygon:w.polygon.map(I=>new h.MercatorCoordinate(I.x,I.y)),unwrapped:w.unwrapped}}}function Pe(_,u){return h.resample(_,p=>{const v=u.pointCoordinate3D(p);p.x=v.x,p.y=v.y},1/256)}function qe(_){return _<0?1+_%1:_%1}function Oe(_){return 100*_|0}function Ue(_,u,p,v,w){const I=function(P,k){if(P)return w(P);if(k){_.url&&k.tiles&&_.tiles&&delete _.tiles;const N=h.pick(h.extend(k,_),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);k.vector_layers&&(N.vectorLayers=k.vector_layers,N.vectorLayerIds=N.vectorLayers.map(U=>U.id)),N.tiles=u.canonicalizeTileset(N,_.url),w(null,N)}};return _.url?h.getJSON(u.transformRequest(u.normalizeSourceURL(_.url,null,p,v),h.ResourceType.Source),I):h.exported.frame(()=>I(null,_))}class Ft{constructor(u,p,v){this.bounds=h.LngLatBounds.convert(this.validateBounds(u)),this.minzoom=p||0,this.maxzoom=v||24}validateBounds(u){return Array.isArray(u)&&4===u.length?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const p=Math.pow(2,u.z),v=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*p),w=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*p),I=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*p),P=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*p);return u.x>=v&&u.x<I&&u.y>=w&&u.y<P}}class Ot{constructor(u,p,v){this.context=u;const w=u.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){const p=this.context.gl;this.context.unbindVAO(),this.bind(),p.bufferSubData(p.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const _n={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Rn{constructor(u,p,v,w){this.length=p.length,this.attributes=v,this.itemSize=p.bytesPerElement,this.dynamicDraw=w,this.context=u;const I=u.gl;this.buffer=I.createBuffer(),u.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,p.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||p.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){const p=this.context.gl;this.bind(),p.bufferSubData(p.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,p){for(let v=0;v<this.attributes.length;v++){const w=p.attributes[this.attributes[v].name];void 0!==w&&u.enableVertexAttribArray(w)}}setVertexAttribPointers(u,p,v){for(let w=0;w<this.attributes.length;w++){const I=this.attributes[w],P=p.attributes[I.name];void 0!==P&&u.vertexAttribPointer(P,I.components,u[_n[I.type]],!1,this.itemSize,I.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class $t{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qn extends $t{getDefault(){return h.Color.transparent}set(u){const p=this.current;(u.r!==p.r||u.g!==p.g||u.b!==p.b||u.a!==p.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class bi extends $t{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class ur extends $t{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class ti extends $t{getDefault(){return[!0,!0,!0,!0]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||u[3]!==p[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Ei extends $t{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class Vr extends $t{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class pr extends $t{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const p=this.current;(u.func!==p.func||u.ref!==p.ref||u.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class dr extends $t{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class lo extends $t{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=u,this.dirty=!1}}class Fo extends $t{getDefault(){return[0,1]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class Lo extends $t{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=u,this.dirty=!1}}class hi extends $t{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class Or extends $t{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.BLEND):p.disable(p.BLEND),this.current=u,this.dirty=!1}}class bo extends $t{getDefault(){const u=this.gl;return[u.ONE,u.ZERO]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(u[0],u[1]),this.current=u,this.dirty=!1)}}class Wo extends $t{getDefault(){return h.Color.transparent}set(u){const p=this.current;(u.r!==p.r||u.g!==p.g||u.b!==p.b||u.a!==p.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class Jr extends $t{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquation(u),this.current=u,this.dirty=!1)}}class Ir extends $t{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;u?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=u,this.dirty=!1}}class fo extends $t{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class So extends $t{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}let Mo,co=class extends $t{getDefault(){return null}set(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)}};class Bi extends $t{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class qr extends $t{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const p=this.current;(u[0]!==p[0]||u[1]!==p[1]||u[2]!==p[2]||u[3]!==p[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class Sr extends $t{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class Ks extends $t{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class vr extends $t{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindTexture(p.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class zr extends $t{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Re extends $t{getDefault(){return null}set(u){const p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class te extends $t{constructor(u){super(u),this.vao=u.extVertexArrayObject}getDefault(){return null}set(u){this.vao&&(u!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(u),this.current=u,this.dirty=!1)}}class oe extends $t{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class De extends $t{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class Be extends $t{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class Qe extends $t{constructor(u,p){super(u),this.context=u,this.parent=p}getDefault(){return null}}class ut extends Qe{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class dt extends Qe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,this.attachment(),p.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class et extends dt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Et{constructor(u,p,v,w){this.context=u,this.width=p,this.height=v;const I=this.framebuffer=u.gl.createFramebuffer();this.colorAttachment=new ut(u,I),w&&(this.depthAttachment=new dt(u,I))}destroy(){const u=this.context.gl,p=this.colorAttachment.get();if(p&&u.deleteTexture(p),this.depthAttachment){const v=this.depthAttachment.get();v&&u.deleteRenderbuffer(v)}u.deleteFramebuffer(this.framebuffer)}}class tn{constructor(u,p=!1){if(this.gl=u,this.isWebGL2=p,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),p){const v=u;this.extVertexArrayObject={createVertexArrayOES:v.createVertexArray.bind(u),deleteVertexArrayOES:v.deleteVertexArray.bind(u),bindVertexArrayOES:v.bindVertexArray.bind(u)}}this.clearColor=new qn(this),this.clearDepth=new bi(this),this.clearStencil=new ur(this),this.colorMask=new ti(this),this.depthMask=new Ei(this),this.stencilMask=new Vr(this),this.stencilFunc=new pr(this),this.stencilOp=new dr(this),this.stencilTest=new lo(this),this.depthRange=new Fo(this),this.depthTest=new Lo(this),this.depthFunc=new hi(this),this.blend=new Or(this),this.blendFunc=new bo(this),this.blendColor=new Wo(this),this.blendEquation=new Jr(this),this.cullFace=new Ir(this),this.cullFaceSide=new fo(this),this.frontFace=new So(this),this.program=new co(this),this.activeTexture=new Bi(this),this.viewport=new qr(this),this.bindFramebuffer=new Sr(this),this.bindRenderbuffer=new Ks(this),this.bindTexture=new vr(this),this.bindVertexBuffer=new zr(this),this.bindElementBuffer=new Re(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new te(this),this.pixelStoreUnpack=new oe(this),this.pixelStoreUnpackPremultiplyAlpha=new De(this),this.pixelStoreUnpackFlipY=new Be(this),this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=u.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=u.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=u.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),p||(this.extTextureHalfFloat=u.getExtension("OES_texture_half_float")),(p||this.extTextureHalfFloat&&u.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=p||u.getExtension("OES_standard_derivatives"),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,p){return new Ot(this,u,p)}createVertexBuffer(u,p,v){return new Rn(this,u,p,v)}createRenderbuffer(u,p,v){const w=this.gl,I=w.createRenderbuffer();return this.bindRenderbuffer.set(I),w.renderbufferStorage(w.RENDERBUFFER,u,p,v),this.bindRenderbuffer.set(null),I}createFramebuffer(u,p,v){return new Et(this,u,p,v)}clear({color:u,depth:p,stencil:v}){const w=this.gl;let I=0;u&&(I|=w.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),void 0!==p&&(I|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(p),this.depthMask.set(!0)),void 0!==v&&(I|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),w.clear(I)}setCullFace(u){!1===u.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){Me(u.blendFunction,h.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor)),this.colorMask.set(u.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Ee extends h.Evented{constructor(u,p,v,w){if(super(),this.id=u,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(p,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new h.DedupedRequest}load(u){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"}));const p=Array.isArray(this.map._language)?this.map._language.join():this.map._language,v=this.map._worldview;this._tileJSONRequest=Ue(this._options,this.map._requestManager,p,v,(w,I)=>{this._tileJSONRequest=null,this._loaded=!0,w?(p&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${p}`),v&&2!==v.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${v}`),this.fire(new h.ErrorEvent(w))):I&&(h.extend(this,I),I.bounds&&(this.tileBounds=new Ft(I.bounds,this.minzoom,this.maxzoom)),h.postTurnstileEvent(I.tiles,this.map._requestManager._customAccessToken),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))),u&&u(w)})}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return h.extend({},this._options)}loadTile(u,p){const v=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(v,h.ResourceType.Tile),data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:h.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:u.isSymbolTile};if(w.request.collectResourceTiming=this._collectResourceTiming,u.actor&&"expired"!==u.state)"loading"===u.state?u.reloadCallback=p:u.request=u.actor.send("reloadTile",w,I.bind(this));else if(u.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)u.request=u.actor.send("loadTile",w,I.bind(this),void 0,!0);else{const P=h.loadVectorTile.call({deduped:this._deduped},w,(k,N)=>{k||!N?I.call(this,k):(w.data={cacheControl:N.cacheControl,expires:N.expires,rawData:N.rawData.slice(0)},u.actor&&u.actor.send("loadTile",w,I.bind(this),void 0,!0))},!0);u.request={cancel:P}}function I(P,k){return delete u.request,u.aborted?p(null):P&&404!==P.status?p(P):(k&&k.resourceTiming&&(u.resourceTiming=k.resourceTiming),this.map._refreshExpiredTiles&&k&&u.setExpiryData(k),u.loadVectorData(k,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(u.reloadCallback&&(this.loadTile(u,u.reloadCallback),u.reloadCallback=null)))}}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.actor&&u.actor.send("abortTile",{uid:u.uid,type:this.type,source:this.id})}unloadTile(u){u.unloadVectorData(),u.actor&&u.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class pe extends h.Evented{constructor(u,p,v,w){super(),this.id=u,this.dispatcher=v,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},p),h.extend(this,h.pick(p,["url","scheme","tileSize"]))}load(u){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ue(this._options,this.map._requestManager,null,null,(p,v)=>{this._tileJSONRequest=null,this._loaded=!0,p?this.fire(new h.ErrorEvent(p)):v&&(h.extend(this,v),v.bounds&&(this.tileBounds=new Ft(v.bounds,this.minzoom,this.maxzoom)),h.postTurnstileEvent(v.tiles),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))),u&&u(p)})}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return h.extend({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,p){const v=h.exported.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),v,this.tileSize);u.request=h.getImage(this.map._requestManager.transformRequest(w,h.ResourceType.Tile),(I,P,k,N)=>(delete u.request,u.aborted?(u.state="unloaded",p(null)):I?(u.state="errored",p(I)):P?(this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:k,expires:N}),u.setTexture(P,this.map.painter),u.state="loaded",h.cacheEntryPossiblyAdded(this.dispatcher),void p(null)):p(null)))}static loadTileData(u,p,v){u.setTexture(p,v)}static unloadTileData(u,p){u.texture&&p.saveTileTexture(u.texture)}abortTile(u,p){u.request&&(u.request.cancel(),delete u.request),p()}unloadTile(u,p){u.texture&&this.map.painter.saveTileTexture(u.texture),p()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function ne(_,u,p,v,w,I,P,k){const N=[_,p,w,u,v,I,1,1,1],U=[P,k,1],z=h.adjoint([],N),[q,le,ye]=h.transformMat3(U,U,h.transpose(z,z));return h.multiply$1(N,[q,0,0,0,le,0,0,0,ye],N)}class ue extends h.Evented{constructor(u,p,v,w){super(),this.id=u,this.dispatcher=v,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=p,this._dirty=!1}load(u,p){this._loaded=p||!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),(v,w)=>{if(this._imageRequest=null,this._loaded=!0,v)this.fire(new h.ErrorEvent(v));else if(w){const{HTMLImageElement:I}=h.window;this.image=w instanceof I?h.exported.getImageData(w):w,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,u&&(this.coordinates=u),this._finishLoading()}})}loaded(){return this._loaded}updateImage(u){return this.image&&u.url?(this._imageRequest&&u.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=u.url,this.load(u.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(u){this.map=u,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(u){this.coordinates=u,this._boundsArray=void 0;const p=u.map(h.MercatorCoordinate.fromLngLat);return this.tileID=function(v){let w=1/0,I=1/0,P=-1/0,k=-1/0;for(const q of v)w=Math.min(w,q.x),I=Math.min(I,q.y),P=Math.max(P,q.x),k=Math.max(k,q.y);const N=Math.max(P-w,k-I),U=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),z=Math.pow(2,U);return new h.CanonicalTileID(U,Math.floor((w+P)/2*z),Math.floor((I+k)/2*z))}(p),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(u){for(const N in this.tiles){const U=this.tiles[N];"loaded"!==U.state&&(U.state="loaded",U.texture=this.texture)}if(this._boundsArray)return;const p=h.tileTransform(this.tileID,this.map.transform.projection),[v,w,I,P]=this.coordinates.map(N=>{const U=p.projection.project(N[0],N[1]);return h.getTilePoint(p,U)._round()});this.perspectiveTransform=function(N,U,z,q,le,ye,be,ve,we,K){const de=ne(0,0,N,0,0,U,N,U),Ae=ne(z,q,le,ye,be,ve,we,K);return h.multiply$1(Ae,h.adjoint(de,de),Ae),[Ae[6]/Ae[8]*N/h.EXTENT,Ae[7]/Ae[8]*U/h.EXTENT]}(this.width,this.height,v.x,v.y,w.x,w.y,P.x,P.y,I.x,I.y);const k=this._boundsArray=new h.StructArrayLayout4i8;k.emplaceBack(v.x,v.y,0,0),k.emplaceBack(w.x,w.y,h.EXTENT,0),k.emplaceBack(P.x,P.y,0,h.EXTENT),k.emplaceBack(I.x,I.y,h.EXTENT,h.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=u.createVertexBuffer(k,h.boundsAttributes.members),this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const u=this.map.painter.context,p=u.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new h.Texture(u,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(u)}loadTile(u,p){this.tileID&&this.tileID.equals(u.tileID.canonical)?(this.tiles[String(u.tileID.wrap)]=u,u.buckets={},p(null)):(u.state="errored",p(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ee={vector:Ee,raster:pe,"raster-dem":class extends pe{constructor(_,u,p,v){super(_,u,p,v),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(_,u){const p=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function v(w,I){w&&(_.state="errored",u(w)),I&&(_.dem=I,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",u(null))}_.request=h.getImage(this.map._requestManager.transformRequest(p,h.ResourceType.Tile),function(w,I,P,k){if(delete _.request,_.aborted)_.state="unloaded",u(null);else if(w)_.state="errored",u(w);else if(I){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:P,expires:k});const N=h.window.ImageBitmap&&I instanceof h.window.ImageBitmap&&(null==Mo&&(Mo=h.window.OffscreenCanvas&&new h.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof h.window.createImageBitmap),Mo),U=1-(I.width-h.prevPowerOfTwo(I.width))/2;U<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const z=N?I:h.exported.getImageData(I,U),q={uid:_.uid,coord:_.tileID,source:this.id,rawImageData:z,encoding:this.encoding,padding:U};_.actor&&"expired"!==_.state||(_.actor=this.dispatcher.getActor(),_.actor.send("loadDEMTile",q,v.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(_){const u=_.canonical,p=Math.pow(2,u.z),v=(u.x-1+p)%p,w=0===u.x?_.wrap-1:_.wrap,I=(u.x+1+p)%p,P=u.x+1===p?_.wrap+1:_.wrap,k={};return k[new h.OverscaledTileID(_.overscaledZ,w,u.z,v,u.y).key]={backfilled:!1},k[new h.OverscaledTileID(_.overscaledZ,P,u.z,I,u.y).key]={backfilled:!1},u.y>0&&(k[new h.OverscaledTileID(_.overscaledZ,w,u.z,v,u.y-1).key]={backfilled:!1},k[new h.OverscaledTileID(_.overscaledZ,_.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},k[new h.OverscaledTileID(_.overscaledZ,P,u.z,I,u.y-1).key]={backfilled:!1}),u.y+1<p&&(k[new h.OverscaledTileID(_.overscaledZ,w,u.z,v,u.y+1).key]={backfilled:!1},k[new h.OverscaledTileID(_.overscaledZ,_.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},k[new h.OverscaledTileID(_.overscaledZ,P,u.z,I,u.y+1).key]={backfilled:!1}),k}unloadTile(_){_.demTexture&&this.map.painter.saveTileTexture(_.demTexture),_.fbo&&(_.fbo.destroy(),delete _.fbo),_.dem&&delete _.dem,delete _.neighboringTiles,_.state="unloaded"}},geojson:class extends h.Evented{constructor(_,u,p,v){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=p.getActor(),this.setEventedParent(v),this._data=u.data,this._options=h.extend({},u),this._collectResourceTiming=u.collectResourceTiming,void 0!==u.maxzoom&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const w=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(void 0!==u.buffer?u.buffer:128)*w,tolerance:(void 0!==u.tolerance?u.tolerance:.375)*w,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:void 0!==u.clusterMaxZoom?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:h.EXTENT,radius:(void 0!==u.clusterRadius?u.clusterRadius:50)*w,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}getClusterExpansionZoom(_,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id},u),this}getClusterChildren(_,u){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id},u),this}getClusterLeaves(_,u,p,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:_,limit:u,offset:p},v),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new h.Event("dataloading",{dataType:"source"})),this._loaded=!1;const _=h.extend({},this.workerOptions),u=this._data;"string"==typeof u?(_.request=this.map._requestManager.transformRequest(h.exported.resolveURL(u),h.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,_,(p,v)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new h.ErrorEvent(p));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(w.resourceTiming=v.resourceTiming[this.id]),this.fire(new h.Event("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(_,u){const p=_.actor?"reloadTile":"loadTile";_.actor=this.actor,_.request=this.actor.send(p,{type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:h.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(v,w)=>(delete _.request,_.unloadVectorData(),_.aborted?u(null):v?u(v):(_.loadVectorData(w,this.map.painter,"reloadTile"===p),u(null))),void 0,"loadTile"===p)}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_){_.unloadVectorData(),this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return h.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ue{constructor(_,u,p,v){super(_,u,p,v),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const u of _.urls)this.urls.push(this.map._requestManager.transformRequest(u,h.ResourceType.Source).url);h.getVideo(this.urls,(u,p)=>{this._loaded=!0,u?this.fire(new h.ErrorEvent(u)):p&&(this.video=p,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const u=this.video.seekable;_<u.start(0)||_>u.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const _=this.map.painter.context,u=_.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new h.Texture(_,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:ue,canvas:class extends ue{constructor(_,u,p,v){super(_,u,p,v),u.coordinates?Array.isArray(u.coordinates)&&4===u.coordinates.length&&!u.coordinates.some(w=>!Array.isArray(w)||2!==w.length||w.some(I=>"number"!=typeof I))||this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${_}`,null,'missing required property "coordinates"'))),u.animate&&"boolean"!=typeof u.animate&&this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),u.canvas?"string"==typeof u.canvas||u.canvas instanceof h.window.HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${_}`,null,'missing required property "canvas"'))),this.options=u,this.animate=void 0===u.animate||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof h.window.HTMLCanvasElement?this.options.canvas:h.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const u=this.map.painter.context;this.texture?(_||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.Texture(u,this.canvas,u.gl.RGBA,{premultiply:!0}),this._prepareData(u)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends h.Evented{constructor(_,u,p,v){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=p,this._implementation=u,this.setEventedParent(v),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new h.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new h.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ft(this._implementation.bounds,this.minzoom,this.maxzoom)),u.update=this._update.bind(this),u.clearTiles=this._clearTiles.bind(this),u.coveringTiles=this._coveringTiles.bind(this),h.extend(this,h.pick(u,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return h.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this._map=_,this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:u,y:p,z:v}=_.canonical;return this._implementation.hasTile({x:u,y:p,z:v})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,u){const{x:p,y:v,z:w}=_.tileID.canonical,I=new h.window.AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:p,y:v,z:w},{signal:I.signal})).then(function(P){return delete _.request,_.aborted?(_.state="unloaded",u(null)):void 0===P?(_.state="errored",u(null)):null===P?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",u(null)):(k=P)instanceof h.window.ImageData||k instanceof h.window.HTMLCanvasElement||k instanceof h.window.ImageBitmap||k instanceof h.window.HTMLImageElement?(this.loadTileData(_,P),_.state="loaded",void u(null)):(_.state="errored",u(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var k}.bind(this)).catch(P=>{20!==P.code&&(_.state="errored",u(P))}),_.request.cancel=()=>I.abort()}loadTileData(_,u){pe.loadTileData(_,u,this._map.painter)}unloadTileData(_){pe.unloadTileData(_,this._map.painter)}unloadTile(_,u){if(this.unloadTileData(_),this._implementation.unloadTile){const{x:p,y:v,z:w}=_.tileID.canonical;this._implementation.unloadTile({x:p,y:v,z:w})}u()}abortTile(_,u){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),u()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Te=function(_,u,p,v){const w=new ee[u.type](_,u,p,v);if(w.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${w.id}`);return h.bindAll(["load","abort","unload","serialize","prepare"],w),w};function bt(_,u){const p=h.identity([]);return h.scale(p,p,[.5*_.width,.5*-_.height,1]),h.translate(p,p,[1,-1,0]),h.multiply(p,p,_.calculateProjMatrix(u.toUnwrapped())),Float32Array.from(p)}function En(_,u,p,v,w,I,P,k=!1){const N=_.tilesIn(v,P,k);N.sort(Xn);const U=[];for(const q of N)U.push({wrappedTileID:q.tile.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(u,p,_._state,q,w,I,bt(_.transform,q.tile.tileID),k)});const z=function(q){const le={},ye={};for(const be of q){const ve=be.queryResults,we=be.wrappedTileID,K=ye[we]=ye[we]||{};for(const de in ve){const Ae=ve[de],Se=K[de]=K[de]||{},Ge=le[de]=le[de]||[];for(const Ye of Ae)Se[Ye.featureIndex]||(Se[Ye.featureIndex]=!0,Ge.push(Ye))}}return le}(U);for(const q in z)z[q].forEach(le=>{const ye=le.feature,be=ye.layer;be&&"background"!==be.type&&"sky"!==be.type&&(ye.source=be.source,be["source-layer"]&&(ye.sourceLayer=be["source-layer"]),ye.state=void 0!==ye.id?_.getFeatureState(be["source-layer"],ye.id):{})});return z}function bn(_,u){const p=_.getRenderableIds().map(I=>_.getTileByID(I)),v=[],w={};for(let I=0;I<p.length;I++){const P=p[I],k=P.tileID.canonical.key;w[k]||(w[k]=!0,P.querySourceFeatures(v,u))}return v}function Xn(_,u){const p=_.tileID,v=u.tileID;return p.overscaledZ-v.overscaledZ||p.canonical.y-v.canonical.y||p.wrap-v.wrap||p.canonical.x-v.canonical.x}function vi(){return null!=$u.workerClass?new $u.workerClass:new h.window.Worker($u.workerUrl)}const Pn="mapboxgl_preloaded_worker_pool";class Li{constructor(){this.active={}}acquire(u){if(!this.workers)for(this.workers=[];this.workers.length<Li.workerCount;)this.workers.push(new vi);return this.active[u]=!0,this.workers.slice()}release(u){delete this.active[u],0===this.numActive()&&(this.workers.forEach(p=>{p.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Pn]}numActive(){return Object.keys(this.active).length}}let Un;function po(){return Un||(Un=new Li),Un}function Vc(_,u){const p={};for(const v in _)"ref"!==v&&(p[v]=_[v]);return h.refProperties.forEach(v=>{v in u&&(p[v]=u[v])}),p}function Tt(_){_=_.slice();const u=Object.create(null);for(let p=0;p<_.length;p++)u[_[p].id]=_[p];for(let p=0;p<_.length;p++)"ref"in _[p]&&(_[p]=Vc(_[p],u[_[p].ref]));return _}Li.workerCount=2;const Ke={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function dn(_,u,p){p.push({command:Ke.addSource,args:[_,u[_]]})}function jn(_,u,p){u.push({command:Ke.removeSource,args:[_]}),p[_]=!0}function $i(_,u,p,v){jn(_,p,v),dn(_,u,p)}function Zi(_,u,p){let v;for(v in _[p])if(_[p].hasOwnProperty(v)&&"data"!==v&&!Me(_[p][v],u[p][v]))return!1;for(v in u[p])if(u[p].hasOwnProperty(v)&&"data"!==v&&!Me(_[p][v],u[p][v]))return!1;return!0}function gt(_,u,p,v,w,I){let P;for(P in u=u||{},_=_||{})_.hasOwnProperty(P)&&(Me(_[P],u[P])||p.push({command:I,args:[v,P,u[P],w]}));for(P in u)u.hasOwnProperty(P)&&!_.hasOwnProperty(P)&&(Me(_[P],u[P])||p.push({command:I,args:[v,P,u[P],w]}))}function xr(_){return _.id}function Zn(_,u){return _[u.id]=u,_}class Hi{constructor(u,p){this.reset(u,p)}reset(u,p){this.points=u||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(p||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(1===this.points.length)return this.points[0];u=h.clamp(u,0,1);let p=1,v=this._distances[p];const w=u*this.paddedLength+this.padding;for(;v<w&&p<this._distances.length;)v=this._distances[++p];const I=p-1,P=this._distances[I],k=v-P,N=k>0?(w-P)/k:0;return this.points[I].mult(1-N).add(this.points[p].mult(N))}}class Wa{constructor(u,p,v){const w=this.boxCells=[],I=this.circleCells=[];this.xCellCount=Math.ceil(u/v),this.yCellCount=Math.ceil(p/v);for(let P=0;P<this.xCellCount*this.yCellCount;P++)w.push([]),I.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=p,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/p,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,p,v,w,I){this._forEachCell(p,v,w,I,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(w),this.bboxes.push(I)}insertCircle(u,p,v,w){this._forEachCell(p-w,v-w,p+w,v+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(p),this.circles.push(v),this.circles.push(w)}_insertBoxCell(u,p,v,w,I,P){this.boxCells[I].push(P)}_insertCircleCell(u,p,v,w,I,P){this.circleCells[I].push(P)}_query(u,p,v,w,I,P){if(v<0||u>this.width||w<0||p>this.height)return!I&&[];const k=[];if(u<=0&&p<=0&&this.width<=v&&this.height<=w){if(I)return!0;for(let N=0;N<this.boxKeys.length;N++)k.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const U=this.circles[3*N],z=this.circles[3*N+1],q=this.circles[3*N+2];k.push({key:this.circleKeys[N],x1:U-q,y1:z-q,x2:U+q,y2:z+q})}return P?k.filter(P):k}return this._forEachCell(u,p,v,w,this._queryCell,k,{hitTest:I,seenUids:{box:{},circle:{}}},P),I?k.length>0:k}_queryCircle(u,p,v,w,I){const P=u-v,k=u+v,N=p-v,U=p+v;if(k<0||P>this.width||U<0||N>this.height)return!w&&[];const z=[];return this._forEachCell(P,N,k,U,this._queryCellCircle,z,{hitTest:w,circle:{x:u,y:p,radius:v},seenUids:{box:{},circle:{}}},I),w?z.length>0:z}query(u,p,v,w,I){return this._query(u,p,v,w,!1,I)}hitTest(u,p,v,w,I){return this._query(u,p,v,w,!0,I)}hitTestCircle(u,p,v,w){return this._queryCircle(u,p,v,!0,w)}_queryCell(u,p,v,w,I,P,k,N){const U=k.seenUids,z=this.boxCells[I];if(null!==z){const le=this.bboxes;for(const ye of z)if(!U.box[ye]){U.box[ye]=!0;const be=4*ye;if(u<=le[be+2]&&p<=le[be+3]&&v>=le[be+0]&&w>=le[be+1]&&(!N||N(this.boxKeys[ye]))){if(k.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[ye],x1:le[be],y1:le[be+1],x2:le[be+2],y2:le[be+3]})}}}const q=this.circleCells[I];if(null!==q){const le=this.circles;for(const ye of q)if(!U.circle[ye]){U.circle[ye]=!0;const be=3*ye;if(this._circleAndRectCollide(le[be],le[be+1],le[be+2],u,p,v,w)&&(!N||N(this.circleKeys[ye]))){if(k.hitTest)return P.push(!0),!0;{const ve=le[be],we=le[be+1],K=le[be+2];P.push({key:this.circleKeys[ye],x1:ve-K,y1:we-K,x2:ve+K,y2:we+K})}}}}}_queryCellCircle(u,p,v,w,I,P,k,N){const U=k.circle,z=k.seenUids,q=this.boxCells[I];if(null!==q){const ye=this.bboxes;for(const be of q)if(!z.box[be]){z.box[be]=!0;const ve=4*be;if(this._circleAndRectCollide(U.x,U.y,U.radius,ye[ve+0],ye[ve+1],ye[ve+2],ye[ve+3])&&(!N||N(this.boxKeys[be])))return P.push(!0),!0}}const le=this.circleCells[I];if(null!==le){const ye=this.circles;for(const be of le)if(!z.circle[be]){z.circle[be]=!0;const ve=3*be;if(this._circlesCollide(ye[ve],ye[ve+1],ye[ve+2],U.x,U.y,U.radius)&&(!N||N(this.circleKeys[be])))return P.push(!0),!0}}}_forEachCell(u,p,v,w,I,P,k,N){const U=this._convertToXCellCoord(u),z=this._convertToYCellCoord(p),q=this._convertToXCellCoord(v),le=this._convertToYCellCoord(w);for(let ye=U;ye<=q;ye++)for(let be=z;be<=le;be++)if(I.call(this,u,p,v,w,this.xCellCount*be+ye,P,k,N))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,p,v,w,I,P){const k=w-u,N=I-p,U=v+P;return U*U>k*k+N*N}_circleAndRectCollide(u,p,v,w,I,P,k){const N=(P-w)/2,U=Math.abs(u-(w+N));if(U>N+v)return!1;const z=(k-I)/2,q=Math.abs(p-(I+z));if(q>z+v)return!1;if(U<=N||q<=z)return!0;const le=U-N,ye=q-z;return le*le+ye*ye<=v*v}}const cc={unknown:0,flipRequired:1,flipNotRequired:2},zc=Math.tan(85*Math.PI/180);function Nt(_,u,p,v,w,I,P){const k=h.create();if(p)if("globe"===I.name){const N=h.calculateGlobeLabelMatrix(w,u);h.multiply(k,k,N)}else{const N=ze([],P);k[0]=N[0],k[1]=N[1],k[4]=N[2],k[5]=N[3],v||h.rotateZ(k,k,w.angle)}else h.multiply(k,w.labelPlaneMatrix,_);return k}function Po(_,u,p,v,w,I,P){const k=Nt(_,u,p,v,w,I,P);return"globe"===I.name&&p||(k[2]=k[6]=k[10]=k[14]=0),k}function No(_,u,p,v,w,I,P){if(p){if("globe"===I.name){const k=Nt(_,u,p,v,w,I,P);return h.invert(k,k),h.multiply(k,_,k),k}{const k=h.clone(_),N=h.identity([]);return N[0]=P[0],N[1]=P[1],N[4]=P[2],N[5]=P[3],h.multiply(k,k,N),v||h.rotateZ(k,k,-w.angle),k}}return w.glCoordMatrix}function Ki(_,u,p,v){const w=[_,u,p,1];p?h.transformMat4$1(w,w,v):li(w,w,v);const I=w[3];return w[0]/=I,w[1]/=I,w[2]/=I,w}function Wp(_,u){return Math.min(.5+_/u*.5,1.5)}function Ts(_,u){const p=_[0]/_[3],v=_[1]/_[3];return p>=-u[0]&&p<=u[0]&&v>=-u[1]&&v<=u[1]}function ih(_,u,p,v,w,I,P,k,N,U){const z=p.transform,q=v?_.textSizeData:_.iconSizeData,le=h.evaluateSizeForZoom(q,p.transform.zoom),ye="globe"===z.projection.name,be=[256/p.width*2+1,256/p.height*2+1],ve=v?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;ve.clear();let we=null;ye&&(we=v?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const K=_.lineVertexArray,de=v?_.text.placedSymbolArray:_.icon.placedSymbolArray,Ae=p.transform.width/p.transform.height;let Se,Ge=!1;for(let Ye=0;Ye<de.length;Ye++){const Xe=de.get(Ye),{numGlyphs:ct,writingMode:st}=Xe;if(st!==h.WritingMode.vertical||Ge||Se===h.WritingMode.horizontal||(Ge=!0),Se=st,(Xe.hidden||st===h.WritingMode.vertical)&&!Ge){Da(ct,ve);continue}Ge=!1;const Ct=new h.Point(Xe.tileAnchorX,Xe.tileAnchorY);let{x:rn,y:_t,z:zt}=z.projection.projectTilePoint(Ct.x,Ct.y,U.canonical);if(N){const[pi,Ln,oi]=N(Ct);rn+=pi,_t+=Ln,zt+=oi}const Dt=[rn,_t,zt,1];if(h.transformMat4$1(Dt,Dt,u),!Ts(Dt,be)){Da(ct,ve);continue}const en=Wp(p.transform.cameraToCenterDistance,Dt[3]),vt=h.evaluateSizeForFeature(q,le,Xe),Ut=P?vt/en:vt*en,sn=Ki(rn,_t,zt,w);if(sn[3]<=0){Da(ct,ve);continue}let Zt={};const Mt=P?null:N,Kn=Mn(Xe,Ut,!1,k,u,w,I,_.glyphOffsetArray,K,ve,we,sn,Ct,Zt,Ae,Mt,z.projection,U,P);Ge=Kn.useVertical,Mt&&Kn.needsFlipping&&(Zt={}),(Kn.notEnoughRoom||Ge||Kn.needsFlipping&&Mn(Xe,Ut,!0,k,u,w,I,_.glyphOffsetArray,K,ve,we,sn,Ct,Zt,Ae,Mt,z.projection,U,P).notEnoughRoom)&&Da(ct,ve)}v?(_.text.dynamicLayoutVertexBuffer.updateData(ve),we&&_.text.globeExtVertexBuffer.updateData(we)):(_.icon.dynamicLayoutVertexBuffer.updateData(ve),we&&_.icon.globeExtVertexBuffer.updateData(we))}function qp(_,u,p,v,w,I,P,k,N,U,z,q,le,ye,be,ve){const{lineStartIndex:we,glyphStartIndex:K,segment:de}=k,Ae=K+k.numGlyphs,Se=we+k.lineLength,Ge=u.getoffsetX(K),Ye=u.getoffsetX(Ae-1),Xe=Ys(_*Ge,p,v,w,I,P,de,we,Se,N,U,z,q,le,!0,ye,be,ve);if(!Xe)return null;const ct=Ys(_*Ye,p,v,w,I,P,de,we,Se,N,U,z,q,le,!0,ye,be,ve);return ct?{first:Xe,last:ct}:null}function hd(_,u,p,v){return _===h.WritingMode.horizontal&&Math.abs(v)>Math.abs(p)?{useVertical:!0}:_===h.WritingMode.vertical?v>0?{needsFlipping:!0}:null:u!==cc.unknown&&(0===(w=p)||Math.abs(v/w)>zc)?u===cc.flipRequired?{needsFlipping:!0}:null:p<0?{needsFlipping:!0}:null;var w}function Mn(_,u,p,v,w,I,P,k,N,U,z,q,le,ye,be,ve,we,K,de){const Ae=u/24,Se=_.lineOffsetX*Ae,Ge=_.lineOffsetY*Ae,{lineStartIndex:Ye,glyphStartIndex:Xe,numGlyphs:ct,segment:st,writingMode:Ct,flipState:rn}=_,_t=Ye+_.lineLength,zt=Dt=>{if(z){const[sn,Zt,Mt]=Dt.up,Kn=U.length;h.updateGlobeVertexNormal(z,Kn+0,sn,Zt,Mt),h.updateGlobeVertexNormal(z,Kn+1,sn,Zt,Mt),h.updateGlobeVertexNormal(z,Kn+2,sn,Zt,Mt),h.updateGlobeVertexNormal(z,Kn+3,sn,Zt,Mt)}const[en,vt,Ut]=Dt.point;h.addDynamicAttributes(U,en,vt,Ut,Dt.angle)};if(ct>1){const Dt=qp(Ae,k,Se,Ge,p,q,le,_,N,I,ye,ve,!1,we,K,de);if(!Dt)return{notEnoughRoom:!0};if(v&&!p){let[en,vt,Ut]=Dt.first.point,[sn,Zt,Mt]=Dt.last.point;[en,vt]=Ki(en,vt,Ut,P),[sn,Zt]=Ki(sn,Zt,Mt,P);const Kn=hd(Ct,rn,(sn-en)*be,Zt-vt);if(_.flipState=Kn&&Kn.needsFlipping?cc.flipRequired:cc.flipNotRequired,Kn)return Kn}zt(Dt.first);for(let en=Xe+1;en<Xe+ct-1;en++){const vt=Ys(Ae*k.getoffsetX(en),Se,Ge,p,q,le,st,Ye,_t,N,I,ye,ve,!1,!1,we,K,de);if(!vt)return U.length-=4*(en-Xe),{notEnoughRoom:!0};zt(vt)}zt(Dt.last)}else{if(v&&!p){const en=Ki(le.x,le.y,0,w),vt=Ye+st+1,Ut=new h.Point(N.getx(vt),N.gety(vt)),sn=Ki(Ut.x,Ut.y,0,w),Zt=sn[3]>0?sn:zi(le,Ut,en,1,w,void 0,we,K.canonical),Mt=hd(Ct,rn,(Zt[0]-en[0])*be,Zt[1]-en[1]);if(_.flipState=Mt&&Mt.needsFlipping?cc.flipRequired:cc.flipNotRequired,Mt)return Mt}const Dt=Ys(Ae*k.getoffsetX(Xe),Se,Ge,p,q,le,st,Ye,_t,N,I,ye,ve,!1,!1,we,K,de);if(!Dt)return{notEnoughRoom:!0};zt(Dt)}return{}}function Gi(_,u,p,v,w){const{x:I,y:P,z:k}=v.projectTilePoint(_.x,_.y,u);if(!w)return Ki(I,P,k,p);const[N,U,z]=w(_);return Ki(I+N,P+U,k+z,p)}function zi(_,u,p,v,w,I,P,k){const N=Gi(_.sub(u)._unit()._add(_),k,w,P,I);return h.sub(N,p,N),h.normalize(N,N),h.scaleAndAdd(N,p,N,v)}function Ys(_,u,p,v,w,I,P,k,N,U,z,q,le,ye,be,ve,we,K){const de=v?_-u:_+u;let Ae=de>0?1:-1,Se=0;v&&(Ae*=-1,Se=Math.PI),Ae<0&&(Se+=Math.PI);let Ge=k+P+(Ae>0?0:1)|0,Ye=w,Xe=w,ct=0,st=0;const Ct=Math.abs(de),rn=[],_t=[];let zt=I,Dt=zt;const en=()=>zi(Dt,zt,Xe,Ct-ct+1,z,le,ve,we.canonical);for(;ct+st<=Ct;){if(Ge+=Ae,Ge<k||Ge>=N)return null;if(Xe=Ye,Dt=zt,rn.push(Xe),ye&&_t.push(Dt),zt=new h.Point(U.getx(Ge),U.gety(Ge)),Ye=q[Ge],!Ye){const oi=Gi(zt,we.canonical,z,ve,le);Ye=oi[3]>0?q[Ge]=oi:en()}ct+=st,st=h.distance(Xe,Ye)}be&&le&&(q[Ge]&&(Ye=en(),st=h.distance(Xe,Ye)),q[Ge]=Ye);const vt=(Ct-ct)/st,Ut=zt.sub(Dt)._mult(vt)._add(Dt),sn=h.sub([],Ye,Xe),Zt=h.scaleAndAdd([],Xe,sn,vt);let Mt=[0,0,1],Kn=sn[0],pi=sn[1];if(K&&(Mt=ve.upVector(we.canonical,Ut.x,Ut.y),0!==Mt[0]||0!==Mt[1]||1!==Mt[2])){const oi=[Mt[2],0,-Mt[0]],Ni=h.cross([],Mt,oi);h.normalize(oi,oi),h.normalize(Ni,Ni),Kn=h.dot(sn,oi),pi=h.dot(sn,Ni)}if(p){const oi=h.cross([],Mt,sn);h.normalize(oi,oi),h.scaleAndAdd(Zt,Zt,oi,p*Ae)}const Ln=Se+Math.atan2(pi,Kn);return rn.push(Zt),ye&&_t.push(Ut),{point:Zt,angle:Ln,path:rn,tilePath:_t,up:Mt}}function Da(_,u){const p=u.length,v=p+4*_;u.resize(v),u.float32.fill(-1/0,4*p,4*v)}function li(_,u,p){const v=u[0],w=u[1];return _[0]=p[0]*v+p[4]*w+p[12],_[1]=p[1]*v+p[5]*w+p[13],_[3]=p[3]*v+p[7]*w+p[15],_}const ri=100;class rh{constructor(u,p,v=new Wa(u.width+200,u.height+200,25),w=new Wa(u.width+200,u.height+200,25)){this.transform=u,this.grid=v,this.ignoredGrid=w,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+ri,this.screenBottomBoundary=u.height+ri,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.fogState=p}placeCollisionBox(u,p,v,w,I,P,k,N){let U=v.projectedAnchorX,z=v.projectedAnchorY,q=v.projectedAnchorZ;const le=v.elevation,ye=v.tileID,be=u.getProjection();if(le&&ye){const[Ye,Xe,ct]=be.upVector(ye.canonical,v.tileAnchorX,v.tileAnchorY),st=be.upVectorScale(ye.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;U+=Ye*le*st,z+=Xe*le*st,q+=ct*le*st}const ve=this.projectAndGetPerspectiveRatio(k,U,z,q,v.tileID,"globe"===be.name||!!le||this.transform.pitch>0,be),we=P*ve.perspectiveRatio,K=(v.x1*p+w.x-v.padding)*we+ve.point.x,de=(v.y1*p+w.y-v.padding)*we+ve.point.y,Ae=(v.x2*p+w.x+v.padding)*we+ve.point.x,Se=(v.y2*p+w.y+v.padding)*we+ve.point.y,Ge=ve.perspectiveRatio<=.55||ve.occluded;return!this.isInsideGrid(K,de,Ae,Se)||!I&&this.grid.hitTest(K,de,Ae,Se,N)||Ge?{box:[],offscreen:!1,occluded:ve.occluded}:{box:[K,de,Ae,Se],offscreen:this.isOffscreen(K,de,Ae,Se),occluded:!1}}placeCollisionCircles(u,p,v,w,I,P,k,N,U,z,q,le,ye,be,ve){const we=[],K=this.transform.elevation,de=u.getProjection(),Ae=K?K.getAtTileOffsetFunc(ve,this.transform.center.lat,this.transform.worldSize,de):null,Se=new h.Point(v.tileAnchorX,v.tileAnchorY);let{x:Ge,y:Ye,z:Xe}=de.projectTilePoint(Se.x,Se.y,ve.canonical);if(Ae){const[Ut,sn,Zt]=Ae(Se);Ge+=Ut,Ye+=sn,Xe+=Zt}const ct="globe"===de.name,st=this.projectAndGetPerspectiveRatio(k,Ge,Ye,Xe,ve,ct||!!K||this.transform.pitch>0,de),{perspectiveRatio:Ct}=st,rn=(q?P/Ct:P*Ct)/h.ONE_EM,_t=Ki(Ge,Ye,Xe,N),zt=st.signedDistanceFromCamera>0?qp(rn,I,v.lineOffsetX*rn,v.lineOffsetY*rn,!1,_t,Se,v,w,N,{},K&&!q?Ae:null,q&&!!K,de,ve,q):null;let Dt=!1,en=!1,vt=!0;if(zt&&!st.occluded){const Ut=.5*ye*Ct+be,sn=new h.Point(-100,-100),Zt=new h.Point(this.screenRightBoundary,this.screenBottomBoundary),Mt=new Hi,{first:Kn,last:pi}=zt,Ln=Kn.path.length;let oi=[];for(let Bn=Ln-1;Bn>=1;Bn--)oi.push(Kn.path[Bn]);for(let Bn=1;Bn<pi.path.length;Bn++)oi.push(pi.path[Bn]);const Ni=2.5*Ut;U&&(oi=oi.map(([Bn,mr,br],wr)=>(Ae&&!ct&&(br=Ae(wr<Ln-1?Kn.tilePath[Ln-1-wr]:pi.tilePath[wr-Ln+2])[2]),Ki(Bn,mr,br,U))),oi.some(Bn=>Bn[3]<=0)&&(oi=[]));let Si=[];if(oi.length>0){let Bn=1/0,mr=-1/0,br=1/0,wr=-1/0;for(const Er of oi)Bn=Math.min(Bn,Er[0]),br=Math.min(br,Er[1]),mr=Math.max(mr,Er[0]),wr=Math.max(wr,Er[1]);mr>=sn.x&&Bn<=Zt.x&&wr>=sn.y&&br<=Zt.y&&(Si=[oi.map(Er=>new h.Point(Er[0],Er[1]))],(Bn<sn.x||mr>Zt.x||br<sn.y||wr>Zt.y)&&(Si=h.clipLine(Si,sn.x,sn.y,Zt.x,Zt.y)))}for(const Bn of Si){Mt.reset(Bn,.25*Ut);let mr=0;mr=Mt.length<=.5*Ut?1:Math.ceil(Mt.paddedLength/Ni)+1;for(let br=0;br<mr;br++){const wr=br/Math.max(mr-1,1),Er=Mt.lerp(wr),Ps=Er.x+ri,qt=Er.y+ri;we.push(Ps,qt,Ut,0);const Mi=Ps-Ut,_i=qt-Ut,Gn=Ps+Ut,Ti=qt+Ut;if(vt=vt&&this.isOffscreen(Mi,_i,Gn,Ti),en=en||this.isInsideGrid(Mi,_i,Gn,Ti),!p&&this.grid.hitTestCircle(Ps,qt,Ut,le)&&(Dt=!0,!z))return{circles:[],offscreen:!1,collisionDetected:Dt,occluded:!1}}}}return{circles:!z&&Dt||!en?[]:we,offscreen:vt,collisionDetected:Dt,occluded:st.occluded}}queryRenderedSymbols(u){if(0===u.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const p=[];let v=1/0,w=1/0,I=-1/0,P=-1/0;for(const z of u){const q=new h.Point(z.x+ri,z.y+ri);v=Math.min(v,q.x),w=Math.min(w,q.y),I=Math.max(I,q.x),P=Math.max(P,q.y),p.push(q)}const k=this.grid.query(v,w,I,P).concat(this.ignoredGrid.query(v,w,I,P)),N={},U={};for(const z of k){const q=z.key;if(void 0===N[q.bucketInstanceId]&&(N[q.bucketInstanceId]={}),N[q.bucketInstanceId][q.featureIndex])continue;const le=[new h.Point(z.x1,z.y1),new h.Point(z.x2,z.y1),new h.Point(z.x2,z.y2),new h.Point(z.x1,z.y2)];h.polygonIntersectsPolygon(p,le)&&(N[q.bucketInstanceId][q.featureIndex]=!0,void 0===U[q.bucketInstanceId]&&(U[q.bucketInstanceId]=[]),U[q.bucketInstanceId].push(q.featureIndex))}return U}insertCollisionBox(u,p,v,w,I){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:w,collisionGroupID:I},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,p,v,w,I){const P=p?this.ignoredGrid:this.grid,k={bucketInstanceId:v,featureIndex:w,collisionGroupID:I};for(let N=0;N<u.length;N+=4)P.insertCircle(k,u[N],u[N+1],u[N+2])}projectAndGetPerspectiveRatio(u,p,v,w,I,P,k){const N=[p,v,w,1];let U=!1;w||this.transform.pitch>0?(h.transformMat4$1(N,N,u),this.fogState&&I&&"globe"!==k.name&&(U=function(le,ye,be,ve,we,K){const de=K.calculateFogTileMatrix(we),Ae=[ye,be,ve];return h.transformMat4(Ae,Ae,de),nn(le,Ae,K.pitch,K._fov)}(this.fogState,p,v,w,I.toUnwrapped(),this.transform)>.9)):li(N,N,u);const z=N[3];return{point:new h.Point((N[0]/z+1)/2*this.transform.width+ri,(-N[1]/z+1)/2*this.transform.height+ri),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(k)/z*.5,1.5),signedDistanceFromCamera:z,occluded:P&&N[2]>z||U}}isOffscreen(u,p,v,w){return v<ri||u>=this.screenRightBoundary||w<ri||p>this.screenBottomBoundary}isInsideGrid(u,p,v,w){return v>=0&&u<this.gridRightBoundary&&w>=0&&p<this.gridBottomBoundary}getViewportMatrix(){const u=h.identity([]);return h.translate(u,u,[-100,-100,0]),u}}function uc(_,u,p){const v=u.createTileMatrix(_,_.worldSize,p.toUnwrapped());return h.multiply(new Float32Array(16),_.projMatrix,v)}function qa(_,u,p){if(u.projection.name===p.projection.name)return _.projMatrix;const v=p.clone();return v.setProjection(u.projection),uc(v,u.getProjection(),_)}function Wt(_,u,p){return u.name===p.projection.name?_.projMatrix:uc(p,u,_)}class Zp{constructor(u,p,v,w){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?p:-p))):w&&v?1:0,this.placed=v}isHidden(){return 0===this.opacity&&!this.placed}}class Ai{constructor(u,p,v,w,I,P=!1){this.text=new Zp(u?u.text:null,p,v,I),this.icon=new Zp(u?u.icon:null,p,w,I),this.clipped=P}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class dc{constructor(u,p,v,w=!1){this.text=u,this.icon=p,this.skipFade=v,this.clipped=w}}class Du{constructor(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]}}class oh{constructor(u,p,v,w,I){this.bucketInstanceId=u,this.featureIndex=p,this.sourceLayerIndex=v,this.bucketIndex=w,this.tileID=I}}class Uc{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const p=++this.maxGroupID;this.collisionGroups[u]={ID:p,predicate:v=>v.collisionGroupID===p}}return this.collisionGroups[u]}}function Pl(_,u,p,v,w){const{horizontalAlign:I,verticalAlign:P}=h.getAnchorAlignment(_),k=-(I-.5)*u,N=-(P-.5)*p,U=h.evaluateVariableOffset(_,v);return new h.Point(k+U[0]*w,N+U[1]*w)}function dl(_,u,p,v,w){const I=new h.Point(_,u);return p&&I._rotate(v?w:-w),I}class Au{constructor(u,p,v,w,I){this.transform=u.clone(),this.projection=u.projection.name,this.collisionIndex=new rh(this.transform,I),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Uc(v),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(u,p,v,w){const I=v.getBucket(p),P=v.latestFeatureIndex;if(!I||!P||p.id!==I.layerIds[0])return;const k=I.layers[0].layout,N=v.collisionBoxArray,U=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),z=v.tileSize/h.EXTENT,q=v.tileID.toUnwrapped();this.transform.setProjection(I.projection);const le=(ye=v.tileID,be=I.getProjection(),ve=this.transform,be.name===this.projection?ve.calculateProjMatrix(ye.toUnwrapped()):uc(ve,be,ye));var ye,be,ve;const we="map"===k.get("text-pitch-alignment"),K="map"===k.get("text-rotation-alignment");p.compileFilter();const de=p.dynamicFilter(),Ae=p.dynamicFilterNeedsFeature(),Se=this.transform.calculatePixelsToTileUnitsMatrix(v),Ge=Po(le,v.tileID.canonical,we,K,this.transform,I.getProjection(),Se);let Ye=null;if(we){const st=No(le,v.tileID.canonical,we,K,this.transform,I.getProjection(),Se);Ye=h.multiply([],this.transform.labelPlaneMatrix,st)}let Xe=null;de&&v.latestFeatureIndex&&(Xe={unwrappedTileID:q,dynamicFilter:de,dynamicFilterNeedsFeature:Ae,featureIndex:v.latestFeatureIndex}),this.retainedQueryData[I.bucketInstanceId]=new oh(I.bucketInstanceId,P,I.sourceLayerIndex,I.index,v.tileID);const ct={bucket:I,layout:k,posMatrix:le,textLabelPlaneMatrix:Ge,labelToScreenMatrix:Ye,clippingData:Xe,scale:U,textPixelRatio:z,holdingForFade:v.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(I.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:h.evaluateSizeForZoom(I.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(I.sourceID)};if(w)for(const st of I.sortKeyRanges){const{sortKey:Ct,symbolInstanceStart:rn,symbolInstanceEnd:_t}=st;u.push({sortKey:Ct,symbolInstanceStart:rn,symbolInstanceEnd:_t,parameters:ct})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:I.symbolInstances.length,parameters:ct})}attemptAnchorPlacement(u,p,v,w,I,P,k,N,U,z,q,le,ye,be,ve,we,K,de){const{textOffset0:Ae,textOffset1:Se,crossTileID:Ge}=le,Ye=[Ae,Se],Xe=Pl(u,v,w,Ye,I),ct=this.collisionIndex.placeCollisionBox(be,I,p,dl(Xe.x,Xe.y,P,k,this.transform.angle),q,N,U,z.predicate);if(we){const st=be.getSymbolInstanceIconSize(de,this.transform.zoom,le.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(be,st,we,dl(Xe.x,Xe.y,P,k,this.transform.angle),q,N,U,z.predicate).box.length)return}if(ct.box.length>0){let st;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ge]&&this.prevPlacement.placements[Ge]&&this.prevPlacement.placements[Ge].text&&(st=this.prevPlacement.variableOffsets[Ge].anchor),this.variableOffsets[Ge]={textOffset:Ye,width:v,height:w,anchor:u,textScale:I,prevAnchor:st},this.markUsedJustification(be,u,le,ve),be.allowVerticalPlacement&&(this.markUsedOrientation(be,ve,le),this.placedOrientations[Ge]=ve),{shift:Xe,placedGlyphBoxes:ct}}}placeLayerBucketPart(u,p,v,w){const{bucket:I,layout:P,posMatrix:k,textLabelPlaneMatrix:N,labelToScreenMatrix:U,clippingData:z,textPixelRatio:q,holdingForFade:le,collisionBoxArray:ye,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:ve,collisionGroup:we}=u.parameters,K=P.get("text-optional"),de=P.get("icon-optional"),Ae=P.get("text-allow-overlap"),Se=P.get("icon-allow-overlap"),Ge="map"===P.get("text-rotation-alignment"),Ye="map"===P.get("text-pitch-alignment"),Xe="none"!==P.get("icon-text-fit"),ct="viewport-y"===P.get("symbol-z-order");this.transform.setProjection(I.projection);let st=Ae&&(Se||!I.hasIconData()||de),Ct=Se&&(Ae||!I.hasTextData()||K);!I.collisionArrays&&ye&&I.deserializeCollisionBoxes(ye),v&&w&&I.updateCollisionDebugBuffers(this.transform.zoom,ye);const rn=(_t,zt,Dt)=>{const{crossTileID:en,numVerticalGlyphVertices:vt}=_t;if(z){const Gn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ti=null;if(z.dynamicFilterNeedsFeature){const sr=this.retainedQueryData[I.bucketInstanceId];Ti=z.featureIndex.loadFeature({featureIndex:_t.featureIndex,bucketIndex:sr.bucketIndex,sourceLayerIndex:sr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,z.dynamicFilter)(Gn,Ti,this.retainedQueryData[I.bucketInstanceId].tileID.canonical,new h.Point(_t.tileAnchorX,_t.tileAnchorY),this.transform.calculateDistanceTileData(z.unwrappedTileID)))return this.placements[en]=new dc(!1,!1,!1,!0),void p.add(en)}if(p.has(en))return;if(le)return void(this.placements[en]=new dc(!1,!1,!1));let Ut=!1,sn=!1,Zt=!0,Mt=!1,Kn=!1,pi=null,Ln={box:null,offscreen:null,occluded:null},oi={box:null,offscreen:null,occluded:null},Ni=null,Si=null,Bn=null,mr=0,br=0,wr=0;Dt.textFeatureIndex?mr=Dt.textFeatureIndex:_t.useRuntimeCollisionCircles&&(mr=_t.featureIndex),Dt.verticalTextFeatureIndex&&(br=Dt.verticalTextFeatureIndex);const Er=Gn=>{Gn.tileID=this.retainedQueryData[I.bucketInstanceId].tileID;const Ti=this.transform.elevation;(Ti||Gn.elevation)&&(Gn.elevation=Ti?Ti.getAtTileOffset(Gn.tileID,Gn.tileAnchorX,Gn.tileAnchorY):0)},Ps=Dt.textBox;if(Ps){Er(Ps);const Gn=sr=>{let to=h.WritingMode.horizontal;if(I.allowVerticalPlacement&&!sr&&this.prevPlacement){const Kr=this.prevPlacement.placedOrientations[en];Kr&&(this.placedOrientations[en]=Kr,to=Kr,this.markUsedOrientation(I,to,_t))}return to},Ti=(sr,to)=>{if(I.allowVerticalPlacement&&vt>0&&Dt.verticalTextBox){for(const Kr of I.writingModes)if(Kr===h.WritingMode.vertical?(Ln=to(),oi=Ln):Ln=sr(),Ln&&Ln.box&&Ln.box.length)break}else Ln=sr()};if(P.get("text-variable-anchor")){let sr=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[en]){const Mr=this.prevPlacement.variableOffsets[en];sr.indexOf(Mr.anchor)>0&&(sr=sr.filter(hs=>hs!==Mr.anchor),sr.unshift(Mr.anchor))}const to=(Mr,hs,Hu)=>{const wc=I.getSymbolInstanceTextSize(be,_t,this.transform.zoom,zt),Qc=(Mr.x2-Mr.x1)*wc+2*Mr.padding,no=(Mr.y2-Mr.y1)*wc+2*Mr.padding,ks=Xe&&!Se?hs:null;ks&&Er(ks);let Hl={box:[],offscreen:!1,occluded:!1};const yl=Ae?2*sr.length:sr.length;for(let Js=0;Js<yl;++Js){const Wf=this.attemptAnchorPlacement(sr[Js%sr.length],Mr,Qc,no,wc,Ge,Ye,q,k,we,Js>=sr.length,_t,zt,I,Hu,ks,be,ve);if(Wf&&(Hl=Wf.placedGlyphBoxes,Hl&&Hl.box&&Hl.box.length)){Ut=!0,pi=Wf.shift;break}}return Hl};Ti(()=>to(Ps,Dt.iconBox,h.WritingMode.horizontal),()=>{const Mr=Dt.verticalTextBox;return Mr&&Er(Mr),I.allowVerticalPlacement&&!(Ln&&Ln.box&&Ln.box.length)&&vt>0&&Mr?to(Mr,Dt.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ln&&(Ut=Ln.box,Zt=Ln.offscreen,Mt=Ln.occluded);const Kr=Gn(!(!Ln||!Ln.box));if(!Ut&&this.prevPlacement){const Mr=this.prevPlacement.variableOffsets[en];Mr&&(this.variableOffsets[en]=Mr,this.markUsedJustification(I,Mr.anchor,_t,Kr))}}else{const sr=(to,Kr)=>{const Mr=I.getSymbolInstanceTextSize(be,_t,this.transform.zoom,zt),hs=this.collisionIndex.placeCollisionBox(I,Mr,to,new h.Point(0,0),Ae,q,k,we.predicate);return hs&&hs.box&&hs.box.length&&(this.markUsedOrientation(I,Kr,_t),this.placedOrientations[en]=Kr),hs};Ti(()=>sr(Ps,h.WritingMode.horizontal),()=>{const to=Dt.verticalTextBox;return I.allowVerticalPlacement&&vt>0&&to?(Er(to),sr(to,h.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Gn(!!(Ln&&Ln.box&&Ln.box.length))}}if(Ni=Ln,Ut=Ni&&Ni.box&&Ni.box.length>0,Zt=Ni&&Ni.offscreen,Mt=Ni&&Ni.occluded,_t.useRuntimeCollisionCircles){const Gn=I.text.placedSymbolArray.get(_t.centerJustifiedTextSymbolIndex>=0?_t.centerJustifiedTextSymbolIndex:_t.verticalPlacedTextSymbolIndex),Ti=h.evaluateSizeForFeature(I.textSizeData,be,Gn),sr=P.get("text-padding");Si=this.collisionIndex.placeCollisionCircles(I,Ae,Gn,I.lineVertexArray,I.glyphOffsetArray,Ti,k,N,U,v,Ye,we.predicate,_t.collisionCircleDiameter*Ti/h.ONE_EM,sr,this.retainedQueryData[I.bucketInstanceId].tileID),Ut=Ae||Si.circles.length>0&&!Si.collisionDetected,Zt=Zt&&Si.offscreen,Mt=Si.occluded}if(Dt.iconFeatureIndex&&(wr=Dt.iconFeatureIndex),Dt.iconBox){const Gn=Ti=>{Er(Ti);const sr=Xe&&pi?dl(pi.x,pi.y,Ge,Ye,this.transform.angle):new h.Point(0,0),to=I.getSymbolInstanceIconSize(ve,this.transform.zoom,_t.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(I,to,Ti,sr,Se,q,k,we.predicate)};oi&&oi.box&&oi.box.length&&Dt.verticalIconBox?(Bn=Gn(Dt.verticalIconBox),sn=Bn.box.length>0):(Bn=Gn(Dt.iconBox),sn=Bn.box.length>0),Zt=Zt&&Bn.offscreen,Kn=Bn.occluded}const qt=K||0===_t.numHorizontalGlyphVertices&&0===vt,Mi=de||0===_t.numIconVertices;if(qt||Mi?Mi?qt||(sn=sn&&Ut):Ut=sn&&Ut:sn=Ut=sn&&Ut,Ut&&Ni&&Ni.box&&this.collisionIndex.insertCollisionBox(Ni.box,P.get("text-ignore-placement"),I.bucketInstanceId,oi&&oi.box&&br?br:mr,we.ID),sn&&Bn&&this.collisionIndex.insertCollisionBox(Bn.box,P.get("icon-ignore-placement"),I.bucketInstanceId,wr,we.ID),Si&&(Ut&&this.collisionIndex.insertCollisionCircles(Si.circles,P.get("text-ignore-placement"),I.bucketInstanceId,mr,we.ID),v)){const Gn=I.bucketInstanceId;let Ti=this.collisionCircleArrays[Gn];void 0===Ti&&(Ti=this.collisionCircleArrays[Gn]=new Du);for(let sr=0;sr<Si.circles.length;sr+=4)Ti.circles.push(Si.circles[sr+0]),Ti.circles.push(Si.circles[sr+1]),Ti.circles.push(Si.circles[sr+2]),Ti.circles.push(Si.collisionDetected?1:0)}const _i="globe"!==I.projection.name;st=st&&(_i||!Mt),Ct=Ct&&(_i||!Kn),this.placements[en]=new dc(Ut||st,sn||Ct,Zt||I.justReloaded),p.add(en)};if(ct){const _t=I.getSortedSymbolIndexes(this.transform.angle);for(let zt=_t.length-1;zt>=0;--zt){const Dt=_t[zt];rn(I.symbolInstances.get(Dt),Dt,I.collisionArrays[Dt])}}else for(let _t=u.symbolInstanceStart;_t<u.symbolInstanceEnd;_t++)rn(I.symbolInstances.get(_t),_t,I.collisionArrays[_t]);if(v&&I.bucketInstanceId in this.collisionCircleArrays){const _t=this.collisionCircleArrays[I.bucketInstanceId];h.invert(_t.invProjMatrix,k),_t.viewportMatrix=this.collisionIndex.getViewportMatrix()}I.justReloaded=!1}markUsedJustification(u,p,v,w){const{leftJustifiedTextSymbolIndex:I,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:N,crossTileID:U}=v,z=h.getAnchorJustification(p),q=w===h.WritingMode.vertical?N:"left"===z?I:"center"===z?P:"right"===z?k:-1;I>=0&&(u.text.placedSymbolArray.get(I).crossTileID=q>=0&&I!==q?0:U),P>=0&&(u.text.placedSymbolArray.get(P).crossTileID=q>=0&&P!==q?0:U),k>=0&&(u.text.placedSymbolArray.get(k).crossTileID=q>=0&&k!==q?0:U),N>=0&&(u.text.placedSymbolArray.get(N).crossTileID=q>=0&&N!==q?0:U)}markUsedOrientation(u,p,v){const w=p===h.WritingMode.horizontal||p===h.WritingMode.horizontalOnly?p:0,I=p===h.WritingMode.vertical?p:0,{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:U}=v,z=u.text.placedSymbolArray;P>=0&&(z.get(P).placedOrientation=w),k>=0&&(z.get(k).placedOrientation=w),N>=0&&(z.get(N).placedOrientation=w),U>=0&&(z.get(U).placedOrientation=I)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const p=this.prevPlacement;let v=!1;this.prevZoomAdjustment=p?p.zoomAdjustment(this.transform.zoom):0;const w=p?p.symbolFadeChange(u):1,I=p?p.opacities:{},P=p?p.variableOffsets:{},k=p?p.placedOrientations:{};for(const N in this.placements){const U=this.placements[N],z=I[N];z?(this.opacities[N]=new Ai(z,w,U.text,U.icon,null,U.clipped),v=v||U.text!==z.text.placed||U.icon!==z.icon.placed):(this.opacities[N]=new Ai(null,w,U.text,U.icon,U.skipFade,U.clipped),v=v||U.text||U.icon)}for(const N in I){const U=I[N];if(!this.opacities[N]){const z=new Ai(U,w,!1,!1);z.isHidden()||(this.opacities[N]=z,v=v||U.text.placed||U.icon.placed)}}for(const N in P)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=P[N]);for(const N in k)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=k[N]);v?this.lastPlacementChangeTime=u:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=p?p.lastPlacementChangeTime:u)}updateLayerOpacities(u,p){const v=new Set;for(const w of p){const I=w.getBucket(u);I&&w.latestFeatureIndex&&u.id===I.layerIds[0]&&this.updateBucketOpacities(I,v,w.collisionBoxArray)}}updateBucketOpacities(u,p,v){u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const w=u.layers[0].layout,I=!!u.layers[0].dynamicFilter(),P=new Ai(null,0,!1,!1,!0),k=w.get("text-allow-overlap"),N=w.get("icon-allow-overlap"),U=w.get("text-variable-anchor"),z="map"===w.get("text-rotation-alignment"),q="map"===w.get("text-pitch-alignment"),le="none"!==w.get("icon-text-fit"),ye=new Ai(null,0,k&&(N||!u.hasIconData()||w.get("icon-optional")),N&&(k||!u.hasTextData()||w.get("text-optional")),!0);!u.collisionArrays&&v&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(v);const be=(we,K,de)=>{for(let Ae=0;Ae<K/4;Ae++)we.opacityVertexArray.emplaceBack(de)};let ve=0;for(let we=0;we<u.symbolInstances.length;we++){const K=u.symbolInstances.get(we),{numHorizontalGlyphVertices:de,numVerticalGlyphVertices:Ae,crossTileID:Se,numIconVertices:Ge}=K,Ye=p.has(Se);let Xe=this.opacities[Se];Ye?Xe=P:Xe||(Xe=ye,this.opacities[Se]=Xe),p.add(Se);const ct=de>0||Ae>0,st=Ge>0,Ct=this.placedOrientations[Se],rn=Ct===h.WritingMode.vertical,_t=Ct===h.WritingMode.horizontal||Ct===h.WritingMode.horizontalOnly;if(!ct&&!st||Xe.isHidden()||ve++,ct){const zt=yr(Xe.text);be(u.text,de,rn?wo:zt),be(u.text,Ae,_t?wo:zt);const Dt=Xe.text.isHidden(),{leftJustifiedTextSymbolIndex:en,centerJustifiedTextSymbolIndex:vt,rightJustifiedTextSymbolIndex:Ut,verticalPlacedTextSymbolIndex:sn}=K,Zt=u.text.placedSymbolArray,Mt=Dt||rn?1:0;en>=0&&(Zt.get(en).hidden=Mt),vt>=0&&(Zt.get(vt).hidden=Mt),Ut>=0&&(Zt.get(Ut).hidden=Mt),sn>=0&&(Zt.get(sn).hidden=Dt||_t?1:0);const Kn=this.variableOffsets[Se];Kn&&this.markUsedJustification(u,Kn.anchor,K,Ct);const pi=this.placedOrientations[Se];pi&&(this.markUsedJustification(u,"left",K,pi),this.markUsedOrientation(u,pi,K))}if(st){const zt=yr(Xe.icon),{placedIconSymbolIndex:Dt,verticalPlacedIconSymbolIndex:en}=K,vt=u.icon.placedSymbolArray,Ut=Xe.icon.isHidden()?1:0;Dt>=0&&(be(u.icon,Ge,rn?wo:zt),vt.get(Dt).hidden=Ut),en>=0&&(be(u.icon,K.numVerticalIconVertices,_t?wo:zt),vt.get(en).hidden=Ut)}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const zt=u.collisionArrays[we];if(zt){let Dt=new h.Point(0,0),en=!0;if(zt.textBox||zt.verticalTextBox){if(U){const Ut=this.variableOffsets[Se];Ut?(Dt=Pl(Ut.anchor,Ut.width,Ut.height,Ut.textOffset,Ut.textScale),z&&Dt._rotate(q?this.transform.angle:-this.transform.angle)):en=!1}I&&(en=!Xe.clipped),zt.textBox&&kl(u.textCollisionBox.collisionVertexArray,Xe.text.placed,!en||rn,Dt.x,Dt.y),zt.verticalTextBox&&kl(u.textCollisionBox.collisionVertexArray,Xe.text.placed,!en||_t,Dt.x,Dt.y)}const vt=en&&!(_t||!zt.verticalIconBox);zt.iconBox&&kl(u.iconCollisionBox.collisionVertexArray,Xe.icon.placed,vt,le?Dt.x:0,le?Dt.y:0),zt.verticalIconBox&&kl(u.iconCollisionBox.collisionVertexArray,Xe.icon.placed,!vt,le?Dt.x:0,le?Dt.y:0)}}}if(u.fullyClipped=0===ve,u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){const we=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=we.invProjMatrix,u.placementViewportMatrix=we.viewportMatrix,u.collisionCircleArray=we.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}}symbolFadeChange(u){return 0===this.fadeDuration?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,p){const v=this.zoomAtLastRecencyCheck===p?1-this.zoomAdjustment(p):1;return this.zoomAtLastRecencyCheck=p,this.commitTime+this.fadeDuration*v>u}setStale(){this.stale=!0}}function kl(_,u,p,v,w){_.emplaceBack(u?1:0,p?1:0,v||0,w||0),_.emplaceBack(u?1:0,p?1:0,v||0,w||0),_.emplaceBack(u?1:0,p?1:0,v||0,w||0),_.emplaceBack(u?1:0,p?1:0,v||0,w||0)}const Xs=Math.pow(2,25),si=Math.pow(2,24),fd=Math.pow(2,17),Su=Math.pow(2,16),Ur=Math.pow(2,9),zs=Math.pow(2,8),sh=Math.pow(2,1);function yr(_){if(0===_.opacity&&!_.placed)return 0;if(1===_.opacity&&_.placed)return 4294967295;const u=_.placed?1:0,p=Math.floor(127*_.opacity);return p*Xs+u*si+p*fd+u*Su+p*Ur+u*zs+p*sh+u}const wo=0;class Mu{constructor(u){this._sortAcrossTiles="viewport-y"!==u.layout.get("symbol-z-order")&&void 0!==u.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(u,p,v,w,I){const P=this._bucketParts;for(;this._currentTileIndex<u.length;)if(p.getBucketParts(P,w,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,I())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((k,N)=>k.sortKey-N.sortKey));this._currentPartIndex<P.length;){const k=P[this._currentPartIndex];if(p.placeLayerBucketPart(k,this._seenCrossTileIDs,v,0===k.symbolInstanceStart),this._currentPartIndex++,I())return!0}return!1}}class pd{constructor(u,p,v,w,I,P,k,N){this.placement=new Au(u,I,P,k,N),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(u,p,v){const w=h.exported.now(),I=()=>{const P=h.exported.now()-w;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=p[u[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if("symbol"===P.type&&(!P.minzoom||P.minzoom<=k)&&(!P.maxzoom||P.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Mu(P)),this._inProgressLayer.continuePlacement(v[P.source],this.placement,this._showCollisionBoxes,P,I))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const Za=512/h.EXTENT/2;class rs{constructor(u,p,v){this.tileID=u,this.bucketInstanceId=v,this.index=new h.KDBush(p.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=u.canonical.x*h.EXTENT,I=u.canonical.y*h.EXTENT;for(let P=0;P<p.length;P++){const{key:k,crossTileID:N,tileAnchorX:U,tileAnchorY:z}=p.get(P),q=Math.floor((w+U)*Za),le=Math.floor((I+z)*Za);this.index.add(q,le),this.keys.push(k),this.crossTileIDs.push(N)}this.index.finish()}findMatches(u,p,v){const w=this.tileID.canonical.z<p.canonical.z?1:Math.pow(2,this.tileID.canonical.z-p.canonical.z),I=Za/Math.pow(2,p.canonical.z-this.tileID.canonical.z),P=p.canonical.x*h.EXTENT,k=p.canonical.y*h.EXTENT;for(let N=0;N<u.length;N++){const U=u.get(N);if(U.crossTileID)continue;const{key:z,tileAnchorX:q,tileAnchorY:le}=U,ye=Math.floor((P+q)*I),be=Math.floor((k+le)*I),ve=this.index.range(ye-w,be-w,ye+w,be+w);for(const we of ve){const K=this.crossTileIDs[we];if(this.keys[we]===z&&!v.has(K)){v.add(K),U.crossTileID=K;break}}}}}class jc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class kf{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const p=Math.round((u-this.lng)/360);if(0!==p)for(const v in this.indexes){const w=this.indexes[v],I={};for(const P in w){const k=w[P];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+p),I[k.tileID.key]=k}this.indexes[v]=I}this.lng=u}addBucket(u,p,v){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===p.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let I=0;I<p.symbolInstances.length;I++)p.symbolInstances.get(I).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]=new Set);const w=this.usedCrossTileIDs[u.overscaledZ];for(const I in this.indexes){const P=this.indexes[I];if(Number(I)>u.overscaledZ)for(const k in P){const N=P[k];N.tileID.isChildOf(u)&&N.findMatches(p.symbolInstances,u,w)}else{const k=P[u.scaledTo(Number(I)).key];k&&k.findMatches(p.symbolInstances,u,w)}}for(let I=0;I<p.symbolInstances.length;I++){const P=p.symbolInstances.get(I);P.crossTileID||(P.crossTileID=v.generate(),w.add(P.crossTileID))}return void 0===this.indexes[u.overscaledZ]&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new rs(u,p.symbolInstances,p.bucketInstanceId),!0}removeBucketCrossTileIDs(u,p){for(const v of p.crossTileIDs)this.usedCrossTileIDs[u].delete(v)}removeStaleBuckets(u){let p=!1;for(const v in this.indexes){const w=this.indexes[v];for(const I in w)u[w[I].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,w[I]),delete w[I],p=!0)}return p}}class da{constructor(){this.layerIndexes={},this.crossTileIDs=new jc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,p,v,w){let I=this.layerIndexes[u.id];void 0===I&&(I=this.layerIndexes[u.id]=new kf);let P=!1;const k={};"globe"!==w.name&&I.handleWrapJump(v);for(const N of p){const U=N.getBucket(u);U&&u.id===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),I.addBucket(N.tileID,U,this.crossTileIDs)&&(P=!0),k[U.bucketInstanceId]=!0)}return I.removeStaleBuckets(k)&&(P=!0),P}pruneUnusedLayers(u){const p={};u.forEach(v=>{p[v]=!0});for(const v in this.layerIndexes)p[v]||delete this.layerIndexes[v]}}const $c=(_,u)=>h.emitValidationErrors(_,u&&u.filter(p=>"source.canvas"!==p.identifier)),md=h.pick(Ke,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),w0=h.pick(Ke,["setCenter","setZoom","setBearing","setPitch"]),ah={version:8,layers:[],sources:{}},Rl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Eo extends h.Evented{constructor(u,p={}){super(),this.map=u,this.dispatcher=new Kt(po(),this),this.imageManager=new fn,this.imageManager.setEventedParent(this),this.glyphManager=new h.GlyphManager(u._requestManager,p.localFontFamily?h.LocalGlyphMode.all:p.localIdeographFontFamily?h.LocalGlyphMode.ideographs:h.LocalGlyphMode.none,p.localFontFamily||p.localIdeographFontFamily),this.crossTileSymbolIndex=new da,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());const v=this;this._rtlTextPluginCallback=Eo.registerForPluginStateChange(w=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(I,P)=>{if(h.triggerPluginCompletionEvent(I),P&&P.every(k=>k))for(const k in v._sourceCaches){const N=v._sourceCaches[k],U=N.getSource().type;"vector"!==U&&"geojson"!==U||N.reload()}})}),this.on("data",w=>{if("source"!==w.dataType||"metadata"!==w.sourceDataType)return;const I=this.getSource(w.sourceId);if(I&&I.vectorLayerIds)for(const P in this._layers){const k=this._layers[P];k.source===I.id&&this._validateLayer(k)}})}loadURL(u,p={}){this.fire(new h.Event("dataloading",{dataType:"style"}));const v="boolean"==typeof p.validate?p.validate:!h.isMapboxURL(u);u=this.map._requestManager.normalizeStyleURL(u,p.accessToken);const w=this.map._requestManager.transformRequest(u,h.ResourceType.Style);this._request=h.getJSON(w,(I,P)=>{this._request=null,I?this.fire(new h.ErrorEvent(I)):P&&this._load(P,v)})}loadJSON(u,p={}){this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.exported.frame(()=>{this._request=null,this._load(u,!1!==p.validate)})}loadEmpty(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(ah,!1)}_updateLayerCount(u,p){const v=p?1:-1;u.is3D()&&(this._num3DLayers+=v),"circle"===u.type&&(this._numCircleLayers+=v),"symbol"===u.type&&(this._numSymbolLayers+=v)}_load(u,p){if(p&&$c(this,h.validateStyle(u)))return;this._loaded=!0,this.stylesheet=h.clone$1(u),this._updateMapProjection();for(const w in u.sources)this.addSource(w,u.sources[w],{validate:!1});this._changed=!1,u.sprite?this._loadSprite(u.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(u.glyphs);const v=Tt(this.stylesheet.layers);this._order=v.map(w=>w.id),this._layers={},this._serializedLayers={};for(const w of v){const I=h.createStyleLayer(w);I.setEventedParent(this,{layer:{id:I.id}}),this._layers[I.id]=I,this._serializedLayers[I.id]=I.serialize(),this._updateLayerCount(I,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new lt(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(u){u?this.stylesheet.projection=u:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(u){this._spriteRequest=function(p,v,w){let I,P,k;const N=h.exported.devicePixelRatio>1?"@2x":"";let U=h.getJSON(v.transformRequest(v.normalizeSpriteURL(p,N,".json"),h.ResourceType.SpriteJSON),(le,ye)=>{U=null,k||(k=le,I=ye,q())}),z=h.getImage(v.transformRequest(v.normalizeSpriteURL(p,N,".png"),h.ResourceType.SpriteImage),(le,ye)=>{z=null,k||(k=le,P=ye,q())});function q(){if(k)w(k);else if(I&&P){const le=h.exported.getImageData(P),ye={};for(const be in I){const{width:ve,height:we,x:K,y:de,sdf:Ae,pixelRatio:Se,stretchX:Ge,stretchY:Ye,content:Xe}=I[be],ct=new h.RGBAImage({width:ve,height:we});h.RGBAImage.copy(le,ct,{x:K,y:de},{x:0,y:0},{width:ve,height:we}),ye[be]={data:ct,pixelRatio:Se,sdf:Ae,stretchX:Ge,stretchY:Ye,content:Xe}}w(null,ye)}}return{cancel(){U&&(U.cancel(),U=null),z&&(z.cancel(),z=null)}}}(u,this.map._requestManager,(p,v)=>{if(this._spriteRequest=null,p)this.fire(new h.ErrorEvent(p));else if(v)for(const w in v)this.imageManager.addImage(w,v[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new h.Event("data",{dataType:"style"}))})}_validateLayer(u){const p=this.getSource(u.source);if(!p)return;const v=u.sourceLayer;v&&("geojson"===p.type||p.vectorLayerIds&&-1===p.vectorLayerIds.indexOf(v))&&this.fire(new h.ErrorEvent(new Error(`Source layer "${v}" does not exist on source "${p.id}" as specified by style layer "${u.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const u in this._sourceCaches)if(!this._sourceCaches[u].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(u){const p=[];for(const v of u){const w=this._layers[v];"custom"!==w.type&&p.push(w.serialize())}return p}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const u in this._sourceCaches)if(this._sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(u){return!!this.terrain&&("function"==typeof u.isLayerDraped?u.isLayerDraped():Rl[u.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(u){if(!this._loaded)return;const p=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),I=Object.keys(this._removedLayers);(w.length||I.length)&&this._updateWorkerLayers(w,I);for(const P in this._updatedSources){const k=this._updatedSources[P];"reload"===k?this._reloadSource(P):"clear"===k&&this._clearSource(P)}this._updateTilesForChangedImages();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(u);this.light.updateTransitions(u),this.fog&&this.fog.updateTransitions(u),this._resetUpdates()}const v={};for(const w in this._sourceCaches){const I=this._sourceCaches[w];v[w]=I.used,I.used=!1}for(const w of this._order){const I=this._layers[w];if(I.recalculate(u,this._availableImages),!I.isHidden(u.zoom)){const k=this._getLayerSourceCache(I);k&&(k.used=!0)}const P=this.map.painter;if(P){const k=I.getProgramIds();if(!k)continue;const N=I.getProgramConfiguration(u.zoom);for(const U of k)P.useProgram(U,N)}}for(const w in v){const I=this._sourceCaches[w];v[w]!==I.used&&I.getSource().fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:I.getSource().id}))}this.light.recalculate(u),this.terrain&&this.terrain.recalculate(u),this.fog&&this.fog.recalculate(u),this.z=u.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new h.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=Object.keys(this._changedImages);if(u.length){for(const p in this._sourceCaches)this._sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],u);this._changedImages={}}}_updateWorkerLayers(u,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(u),removedIds:p})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(u){if(this._checkLoaded(),$c(this,h.validateStyle(u)))return!1;(u=h.clone$1(u)).layers=Tt(u.layers);const p=function(w,I){if(!w)return[{command:Ke.setStyle,args:[I]}];let P=[];try{if(!Me(w.version,I.version))return[{command:Ke.setStyle,args:[I]}];Me(w.center,I.center)||P.push({command:Ke.setCenter,args:[I.center]}),Me(w.zoom,I.zoom)||P.push({command:Ke.setZoom,args:[I.zoom]}),Me(w.bearing,I.bearing)||P.push({command:Ke.setBearing,args:[I.bearing]}),Me(w.pitch,I.pitch)||P.push({command:Ke.setPitch,args:[I.pitch]}),Me(w.sprite,I.sprite)||P.push({command:Ke.setSprite,args:[I.sprite]}),Me(w.glyphs,I.glyphs)||P.push({command:Ke.setGlyphs,args:[I.glyphs]}),Me(w.transition,I.transition)||P.push({command:Ke.setTransition,args:[I.transition]}),Me(w.light,I.light)||P.push({command:Ke.setLight,args:[I.light]}),Me(w.fog,I.fog)||P.push({command:Ke.setFog,args:[I.fog]}),Me(w.projection,I.projection)||P.push({command:Ke.setProjection,args:[I.projection]});const k={},N=[];!function(q,le,ye,be){let ve;for(ve in le=le||{},q=q||{})q.hasOwnProperty(ve)&&(le.hasOwnProperty(ve)||jn(ve,ye,be));for(ve in le){if(!le.hasOwnProperty(ve))continue;const we=le[ve];q.hasOwnProperty(ve)?Me(q[ve],we)||("geojson"===q[ve].type&&"geojson"===we.type&&Zi(q,le,ve)?ye.push({command:Ke.setGeoJSONSourceData,args:[ve,we.data]}):$i(ve,le,ye,be)):dn(ve,le,ye)}}(w.sources,I.sources,N,k);const U=[];w.layers&&w.layers.forEach(q=>{q.source&&k[q.source]?P.push({command:Ke.removeLayer,args:[q.id]}):U.push(q)});let z=w.terrain;z&&k[z.source]&&(P.push({command:Ke.setTerrain,args:[void 0]}),z=void 0),P=P.concat(N),Me(z,I.terrain)||P.push({command:Ke.setTerrain,args:[I.terrain]}),function(q,le,ye){le=le||[];const be=(q=q||[]).map(xr),ve=le.map(xr),we=q.reduce(Zn,{}),K=le.reduce(Zn,{}),de=be.slice(),Ae=Object.create(null);let Se,Ge,Ye,Xe,ct,st,Ct;for(Se=0,Ge=0;Se<be.length;Se++)Ye=be[Se],K.hasOwnProperty(Ye)?Ge++:(ye.push({command:Ke.removeLayer,args:[Ye]}),de.splice(de.indexOf(Ye,Ge),1));for(Se=0,Ge=0;Se<ve.length;Se++)Ye=ve[ve.length-1-Se],de[de.length-1-Se]!==Ye&&(we.hasOwnProperty(Ye)?(ye.push({command:Ke.removeLayer,args:[Ye]}),de.splice(de.lastIndexOf(Ye,de.length-Ge),1)):Ge++,st=de[de.length-Se],ye.push({command:Ke.addLayer,args:[K[Ye],st]}),de.splice(de.length-Se,0,Ye),Ae[Ye]=!0);for(Se=0;Se<ve.length;Se++)if(Ye=ve[Se],Xe=we[Ye],ct=K[Ye],!Ae[Ye]&&!Me(Xe,ct))if(Me(Xe.source,ct.source)&&Me(Xe["source-layer"],ct["source-layer"])&&Me(Xe.type,ct.type)){for(Ct in gt(Xe.layout,ct.layout,ye,Ye,null,Ke.setLayoutProperty),gt(Xe.paint,ct.paint,ye,Ye,null,Ke.setPaintProperty),Me(Xe.filter,ct.filter)||ye.push({command:Ke.setFilter,args:[Ye,ct.filter]}),Me(Xe.minzoom,ct.minzoom)&&Me(Xe.maxzoom,ct.maxzoom)||ye.push({command:Ke.setLayerZoomRange,args:[Ye,ct.minzoom,ct.maxzoom]}),Xe)Xe.hasOwnProperty(Ct)&&"layout"!==Ct&&"paint"!==Ct&&"filter"!==Ct&&"metadata"!==Ct&&"minzoom"!==Ct&&"maxzoom"!==Ct&&(0===Ct.indexOf("paint.")?gt(Xe[Ct],ct[Ct],ye,Ye,Ct.slice(6),Ke.setPaintProperty):Me(Xe[Ct],ct[Ct])||ye.push({command:Ke.setLayerProperty,args:[Ye,Ct,ct[Ct]]}));for(Ct in ct)ct.hasOwnProperty(Ct)&&!Xe.hasOwnProperty(Ct)&&"layout"!==Ct&&"paint"!==Ct&&"filter"!==Ct&&"metadata"!==Ct&&"minzoom"!==Ct&&"maxzoom"!==Ct&&(0===Ct.indexOf("paint.")?gt(Xe[Ct],ct[Ct],ye,Ye,Ct.slice(6),Ke.setPaintProperty):Me(Xe[Ct],ct[Ct])||ye.push({command:Ke.setLayerProperty,args:[Ye,Ct,ct[Ct]]}))}else ye.push({command:Ke.removeLayer,args:[Ye]}),st=de[de.lastIndexOf(Ye)+1],ye.push({command:Ke.addLayer,args:[ct,st]})}(U,I.layers,P)}catch(k){console.warn("Unable to compute style diff:",k),P=[{command:Ke.setStyle,args:[I]}]}return P}(this.serialize(),u).filter(w=>!(w.command in w0));if(0===p.length)return!1;const v=p.filter(w=>!(w.command in md));if(v.length>0)throw new Error(`Unimplemented: ${v.map(w=>w.command).join(", ")}.`);return p.forEach(w=>{"setTransition"!==w.command&&"setProjection"!==w.command&&this[w.command].apply(this,w.args)}),this.stylesheet=u,this._updateMapProjection(),!0}addImage(u,p){return this.getImage(u)?this.fire(new h.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(u,p),this._afterImageUpdated(u),this)}updateImage(u,p){this.imageManager.updateImage(u,p)}getImage(u){return this.imageManager.getImage(u)}removeImage(u){return this.getImage(u)?(this.imageManager.removeImage(u),this._afterImageUpdated(u),this):this.fire(new h.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(),this._changedImages[u]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(u,p,v={}){if(this._checkLoaded(),void 0!==this.getSource(u))throw new Error("There is already a source with this ID");if(!p.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(p).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(h.validateSource,`sources.${u}`,p,null,v))return;this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);const w=Te(u,p,this.dispatcher,this);w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(u),source:w.serialize(),sourceId:u}));const I=P=>{const k=(P?"symbol:":"other:")+u,N=this._sourceCaches[k]=new h.SourceCache(k,w,P);(P?this._symbolSourceCaches:this._otherSourceCaches)[u]=N,N.style=this,N.onAdd(this.map)};I(!1),"vector"!==p.type&&"geojson"!==p.type||I(!0),w.onAdd&&w.onAdd(this.map),this._changed=!0}removeSource(u){this._checkLoaded();const p=this.getSource(u);if(!p)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===u)return this.fire(new h.ErrorEvent(new Error(`Source "${u}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.get().source===u)return this.fire(new h.ErrorEvent(new Error(`Source "${u}" cannot be removed while terrain is using it.`)));const v=this._getSourceCaches(u);for(const w of v)delete this._sourceCaches[w.id],delete this._updatedSources[w.id],w.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles();return delete this._otherSourceCaches[u],delete this._symbolSourceCaches[u],p.setEventedParent(null),p.onRemove&&p.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(u,p){this._checkLoaded(),this.getSource(u).setData(p),this._changed=!0}getSource(u){const p=this._getSourceCache(u);return p&&p.getSource()}_getSources(){const u=[];for(const p in this._otherSourceCaches){const v=this._getSourceCache(p);v&&u.push(v.getSource())}return u}addLayer(u,p,v={}){this._checkLoaded();const w=u.id;if(this.getLayer(w))return void this.fire(new h.ErrorEvent(new Error(`Layer with id "${w}" already exists on this map`)));let I;if("custom"===u.type){if($c(this,h.validateCustomStyleLayer(u)))return;I=h.createStyleLayer(u)}else{if("object"==typeof u.source&&(this.addSource(w,u.source),u=h.clone$1(u),u=h.extend(u,{source:w})),this._validate(h.validateLayer,`layers.${w}`,u,{arrayIndex:-1},v))return;I=h.createStyleLayer(u),this._validateLayer(I),I.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[I.id]=I.serialize(),this._updateLayerCount(I,!0)}const P=p?this._order.indexOf(p):this._order.length;if(p&&-1===P)return void this.fire(new h.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`)));this._order.splice(P,0,w),this._layerOrderChanged=!0,this._layers[w]=I;const k=this._getLayerSourceCache(I);if(this._removedLayers[w]&&I.source&&k&&"custom"!==I.type){const N=this._removedLayers[w];delete this._removedLayers[w],N.type!==I.type?this._updatedSources[I.source]="clear":(this._updatedSources[I.source]="reload",k.pause())}this._updateLayer(I),I.onAdd&&I.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(u,p){if(this._checkLoaded(),this._changed=!0,!this._layers[u])return void this.fire(new h.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be moved.`)));if(u===p)return;const v=this._order.indexOf(u);this._order.splice(v,1);const w=p?this._order.indexOf(p):this._order.length;p&&-1===w?this.fire(new h.ErrorEvent(new Error(`Layer with id "${p}" does not exist on this map.`))):(this._order.splice(w,0,u),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(u){this._checkLoaded();const p=this._layers[u];if(!p)return void this.fire(new h.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be removed.`)));p.setEventedParent(null),this._updateLayerCount(p,!1);const v=this._order.indexOf(u);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[u]=p,delete this._layers[u],delete this._serializedLayers[u],delete this._updatedLayers[u],delete this._updatedPaintProps[u],p.onRemove&&p.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(u){return this._layers[u]}hasLayer(u){return u in this._layers}hasLayerType(u){for(const p in this._layers)if(this._layers[p].type===u)return!0;return!1}setLayerZoomRange(u,p,v){this._checkLoaded();const w=this.getLayer(u);w?w.minzoom===p&&w.maxzoom===v||(null!=p&&(w.minzoom=p),null!=v&&(w.maxzoom=v),this._updateLayer(w)):this.fire(new h.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(u,p,v={}){this._checkLoaded();const w=this.getLayer(u);if(w){if(!Me(w.filter,p))return null==p?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(h.validateFilter,`layers.${w.id}.filter`,p,{layerType:w.type},v)||(w.filter=h.clone$1(p),this._updateLayer(w)))}else this.fire(new h.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be filtered.`)))}getFilter(u){const p=this.getLayer(u);return p&&h.clone$1(p.filter)}setLayoutProperty(u,p,v,w={}){this._checkLoaded();const I=this.getLayer(u);I?Me(I.getLayoutProperty(p),v)||(I.setLayoutProperty(p,v,w),this._updateLayer(I)):this.fire(new h.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(u,p){const v=this.getLayer(u);if(v)return v.getLayoutProperty(p);this.fire(new h.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style.`)))}setPaintProperty(u,p,v,w={}){this._checkLoaded();const I=this.getLayer(u);I?Me(I.getPaintProperty(p),v)||(I.setPaintProperty(p,v,w)&&this._updateLayer(I),this._changed=!0,this._updatedPaintProps[u]=!0):this.fire(new h.ErrorEvent(new Error(`The layer '${u}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(u,p){const v=this.getLayer(u);return v&&v.getPaintProperty(p)}setFeatureState(u,p){this._checkLoaded();const v=u.source,w=u.sourceLayer,I=this.getSource(v);if(!I)return void this.fire(new h.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const P=I.type;if("geojson"===P&&w)return void this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===P&&!w)return void this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===u.id&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided.")));const k=this._getSourceCaches(v);for(const N of k)N.setFeatureState(w,u.id,p)}removeFeatureState(u,p){this._checkLoaded();const v=u.source,w=this.getSource(v);if(!w)return void this.fire(new h.ErrorEvent(new Error(`The source '${v}' does not exist in the map's style.`)));const I=w.type,P="vector"===I?u.sourceLayer:void 0;if("vector"===I&&!P)return void this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(p&&"string"!=typeof u.id&&"number"!=typeof u.id)return void this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const k=this._getSourceCaches(v);for(const N of k)N.removeFeatureState(P,u.id,p)}getFeatureState(u){this._checkLoaded();const p=u.source,v=u.sourceLayer,w=this.getSource(p);if(w){if("vector"!==w.type||v)return void 0===u.id&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(p)[0].getFeatureState(v,u.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)))}getTransition(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const u={};for(const p in this._sourceCaches){const v=this._sourceCaches[p].getSource();u[v.id]||(u[v.id]=v.serialize())}return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:u,layers:this._serializeLayers(this._order)},p=>void 0!==p)}_updateLayer(u){this._updatedLayers[u.id]=!0;const p=this._getLayerSourceCache(u);u.source&&!this._updatedSources[u.source]&&p&&"raster"!==p.getSource().type&&(this._updatedSources[u.source]="reload",p.pause()),this._changed=!0,u.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(u){const p=P=>"fill-extrusion"===this._layers[P].type,v={},w=[];for(let P=this._order.length-1;P>=0;P--){const k=this._order[P];if(p(k)){v[k]=P;for(const N of u){const U=N[k];if(U)for(const z of U)w.push(z)}}}w.sort((P,k)=>k.intersectionZ-P.intersectionZ);const I=[];for(let P=this._order.length-1;P>=0;P--){const k=this._order[P];if(p(k))for(let N=w.length-1;N>=0;N--){const U=w[N].feature;if(v[U.layer.id]<P)break;I.push(U),w.pop()}else for(const N of u){const U=N[k];if(U)for(const z of U)I.push(z.feature)}}return I}queryRenderedFeatures(u,p,v){p&&p.filter&&this._validate(h.validateFilter,"queryRenderedFeatures.filter",p.filter,null,p);const w={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const N of p.layers){const U=this._layers[N];if(!U)return this.fire(new h.ErrorEvent(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];w[U.source]=!0}}const I=[];p.availableImages=this._availableImages;const P=p&&p.layers?p.layers.some(N=>{const U=this.getLayer(N);return U&&U.is3D()}):this.has3DLayers(),k=yi.createFromScreenPoints(u,v);for(const N in this._sourceCaches){const U=this._sourceCaches[N].getSource().id;p.layers&&!w[U]||I.push(En(this._sourceCaches[N],this._layers,this._serializedLayers,k,p,v,P,!!this.map._showQueryGeometry))}return this.placement&&I.push(function(N,U,z,q,le,ye,be){const ve={},we=ye.queryRenderedSymbols(q),K=[];for(const de of Object.keys(we).map(Number))K.push(be[de]);K.sort(Xn);for(const de of K){const Ae=de.featureIndex.lookupSymbolFeatures(we[de.bucketInstanceId],U,de.bucketIndex,de.sourceLayerIndex,le.filter,le.layers,le.availableImages,N);for(const Se in Ae){const Ge=ve[Se]=ve[Se]||[],Ye=Ae[Se];Ye.sort((Xe,ct)=>{const st=de.featureSortOrder;if(st){const Ct=st.indexOf(Xe.featureIndex);return st.indexOf(ct.featureIndex)-Ct}return ct.featureIndex-Xe.featureIndex});for(const Xe of Ye)Ge.push(Xe)}}for(const de in ve)ve[de].forEach(Ae=>{const Se=Ae.feature,Ge=z(N[de]);if(!Ge)return;const Ye=Ge.getFeatureState(Se.layer["source-layer"],Se.id);Se.source=Se.layer.source,Se.layer["source-layer"]&&(Se.sourceLayer=Se.layer["source-layer"]),Se.state=Ye});return ve}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),k.screenGeometry,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(I)}querySourceFeatures(u,p){p&&p.filter&&this._validate(h.validateFilter,"querySourceFeatures.filter",p.filter,null,p);const v=this._getSourceCaches(u);let w=[];for(const I of v)w=w.concat(bn(I,p));return w}addSourceType(u,p,v){return Eo.getSourceType(u)?v(new Error(`A source type called "${u}" already exists.`)):(Eo.setSourceType(u,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:u,url:p.workerSourceURL},v):v(null,null))}getLight(){return this.light.getLight()}setLight(u,p={}){this._checkLoaded();const v=this.light.getLight();let w=!1;for(const P in u)if(!Me(u[P],v[P])){w=!0;break}if(!w)return;const I=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(u,p),this.light.updateTransitions(I)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(u,p=1){if(this._checkLoaded(),!u)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let v=u;if(1===p){if("object"==typeof v.source){const w="terrain-dem-src";this.addSource(w,v.source),v=h.clone$1(v),v=h.extend(v,{source:w})}if(this._validate(h.validateTerrain,"terrain",v))return}if(!this.terrain||this.terrain&&p!==this.terrain.drapeRenderMode){if(!v)return;this._createTerrain(v,p)}else{const w=this.terrain,I=w.get();for(const P of Object.keys(h.spec.terrain))!v.hasOwnProperty(P)&&h.spec.terrain[P].default&&(v[P]=h.spec.terrain[P].default);for(const P in v)if(!Me(v[P],I[P])){w.set(v),this.stylesheet.terrain=v;const k=this._setTransitionParameters({duration:0});w.updateTransitions(k);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(u){const p=this.fog=new Jn(u,this.map.transform);this.stylesheet.fog=u;const v=this._setTransitionParameters({duration:0});p.updateTransitions(v)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const u of this.map._markers)u._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(u){if(this._checkLoaded(),!u)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const p=this.fog,v=p.get();0===Object.keys(u).length&&p.set(u);for(const w in u)if(!Me(u[w],v[w])){p.set(u),this.stylesheet.fog=u;const I=this._setTransitionParameters({duration:0});p.updateTransitions(I);break}}else this._createFog(u);this._markersNeedUpdate=!0}_setTransitionParameters(u){return{now:h.exported.now(),transition:h.extend(u,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const u=this._order.filter(v=>this.isLayerDraped(this._layers[v])),p=this._order.filter(v=>!this.isLayerDraped(this._layers[v]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...u),this._drapedFirstOrder.push(...p)}_createTerrain(u,p){const v=this.terrain=new Lt(u,p);this.stylesheet.terrain=u,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const w=this._setTransitionParameters({duration:0});v.updateTransitions(w)}_force3DLayerUpdate(){for(const u in this._layers){const p=this._layers[u];"fill-extrusion"===p.type&&this._updateLayer(p)}}_forceSymbolLayerUpdate(){for(const u in this._layers){const p=this._layers[u];"symbol"===p.type&&this._updateLayer(p)}}_validate(u,p,v,w,I={}){return(!I||!1!==I.validate)&&$c(this,u.call(h.validateStyle,h.extend({key:p,style:this.serialize(),value:v,styleSpec:h.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this._sourceCaches)this._sourceCaches[u].clearTiles(),this._sourceCaches[u].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(u){const p=this._getSourceCaches(u);for(const v of p)v.clearTiles()}_reloadSource(u){const p=this._getSourceCaches(u);for(const v of p)v.resume(),v.reload()}_reloadSources(){for(const u of this._getSources())u.reload&&u.reload()}_updateSources(u){for(const p in this._sourceCaches)this._sourceCaches[p].update(u)}_generateCollisionBoxes(){for(const u in this._sourceCaches){const p=this._sourceCaches[u];p.resume(),p.reload()}}_updatePlacement(u,p,v,w,I=!1){let P=!1,k=!1;const N={};for(const U of this._order){const z=this._layers[U];if("symbol"!==z.type)continue;if(!N[z.source]){const le=this._getLayerSourceCache(z);if(!le)continue;N[z.source]=le.getRenderableIds(!0).map(ye=>le.getTileByID(ye)).sort((ye,be)=>be.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(be.tileID)?-1:1))}const q=this.crossTileSymbolIndex.addLayer(z,N[z.source],u.center.lng,u.projection);P=P||q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),I=I||this._layerOrderChanged||0===v,this._layerOrderChanged&&this.fire(new h.Event("neworder")),(I||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.exported.now(),u.zoom))&&(this.pauseablePlacement=new pd(u,this._order,I,p,v,w,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,N),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.exported.now()),k=!0),P&&this.pauseablePlacement.placement.setStale()),k||P)for(const U of this._order){const z=this._layers[U];"symbol"===z.type&&this.placement.updateLayerOpacities(z,N[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.exported.now())}_releaseSymbolFadeTiles(){for(const u in this._sourceCaches)this._sourceCaches[u].releaseSymbolFadeTiles()}getImages(u,p,v){this.imageManager.getImages(p.icons,v),this._updateTilesForChangedImages();const w=I=>{I&&I.setDependencies(p.tileID.key,p.type,p.icons)};w(this._otherSourceCaches[p.source]),w(this._symbolSourceCaches[p.source])}getGlyphs(u,p,v){this.glyphManager.getGlyphs(p.stacks,v)}getResource(u,p,v){return h.makeRequest(p,v)}_getSourceCache(u){return this._otherSourceCaches[u]}_getLayerSourceCache(u){return"symbol"===u.type?this._symbolSourceCaches[u.source]:this._otherSourceCaches[u.source]}_getSourceCaches(u){const p=[];return this._otherSourceCaches[u]&&p.push(this._otherSourceCaches[u]),this._symbolSourceCaches[u]&&p.push(this._symbolSourceCaches[u]),p}_isSourceCacheLoaded(u){const p=this._getSourceCaches(u);return 0===p.length?(this.fire(new h.ErrorEvent(new Error(`There is no source with ID '${u}'`))),!1):p.every(v=>v.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Eo.getSourceType=function(_){return ee[_]},Eo.setSourceType=function(_,u){ee[_]=u},Eo.registerForPluginStateChange=h.registerForPluginStateChange;var Hc="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",hl="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",os="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",gd="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Ka="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let _d={},ha={};const yd=[];xn(Hc,yd),xn(os,yd),xn(gd,yd),xn(Ka,yd),_d=or("",os),ha=or(Ka,gd);const Ya=or("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),lh=Hc,it="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Pu={background:or("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:or("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:or("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:or("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:or("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:or("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:or("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:or("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:or("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:or("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:or("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:or("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:or("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:or("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:or("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:or("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:or("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:or("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:or("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:or("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:or("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:or("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:or("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:or("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:or("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:or("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",hl),skyboxGradient:or("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",hl),skyboxCapture:or("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:or("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:or("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function xn(_,u){const p=_.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let v of p)if(v=v.trim(),"#"===v[0]&&v.includes("if")&&!v.includes("endif")){v=v.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=v.split(" ");for(const I of w)u.includes(I)||u.push(I)}}function or(_,u){const p=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=u.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w={},I=[...yd];return xn(_,I),xn(u,I),{fragmentSource:_=_.replace(p,(P,k,N,U,z)=>(w[z]=!0,"define"===k?`\n#ifndef HAS_UNIFORM_u_${z}\nvarying ${N} ${U} ${z};\n#else\nuniform ${N} ${U} u_${z};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${z}\n    ${N} ${U} ${z} = u_${z};\n#endif\n`)),vertexSource:u=u.replace(p,(P,k,N,U,z)=>{const q="float"===U?"vec2":"vec4",le=z.match(/color/)?"color":q;return w[z]?"define"===k?`\n#ifndef HAS_UNIFORM_u_${z}\nuniform lowp float u_${z}_t;\nattribute ${N} ${q} a_${z};\nvarying ${N} ${U} ${z};\n#else\nuniform ${N} ${U} u_${z};\n#endif\n`:"vec4"===le?`\n#ifndef HAS_UNIFORM_u_${z}\n    ${z} = a_${z};\n#else\n    ${N} ${U} ${z} = u_${z};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${z}\n    ${z} = unpack_mix_${le}(a_${z}, u_${z}_t);\n#else\n    ${N} ${U} ${z} = u_${z};\n#endif\n`:"define"===k?`\n#ifndef HAS_UNIFORM_u_${z}\nuniform lowp float u_${z}_t;\nattribute ${N} ${q} a_${z};\n#else\nuniform ${N} ${U} u_${z};\n#endif\n`:"vec4"===le?`\n#ifndef HAS_UNIFORM_u_${z}\n    ${N} ${U} ${z} = a_${z};\n#else\n    ${N} ${U} ${z} = u_${z};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${z}\n    ${N} ${U} ${z} = unpack_mix_${le}(a_${z}, u_${z}_t);\n#else\n    ${N} ${U} ${z} = u_${z};\n#endif\n`}),staticAttributes:v,usedDefines:I}}class Rf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(u,p,v,w,I,P,k){this.context=u;let N=this.boundPaintVertexBuffers.length!==w.length;for(let z=0;!N&&z<w.length;z++)this.boundPaintVertexBuffers[z]!==w[z]&&(N=!0);let U=this.boundDynamicVertexBuffers.length!==k.length;for(let z=0;!U&&z<k.length;z++)this.boundDynamicVertexBuffers[z]!==k[z]&&(U=!0);if(!u.extVertexArrayObject||!this.vao||this.boundProgram!==p||this.boundLayoutVertexBuffer!==v||N||U||this.boundIndexBuffer!==I||this.boundVertexOffset!==P)this.freshBind(p,v,w,I,P,k);else{u.bindVertexArrayOES.set(this.vao);for(const z of k)z&&z.bind();I&&I.dynamicDraw&&I.bind()}}freshBind(u,p,v,w,I,P){let k;const N=u.numAttributes,U=this.context,z=U.gl;if(U.extVertexArrayObject)this.vao&&this.destroy(),this.vao=U.extVertexArrayObject.createVertexArrayOES(),U.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=u,this.boundLayoutVertexBuffer=p,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=w,this.boundVertexOffset=I,this.boundDynamicVertexBuffers=P;else{k=U.currentNumAttributes||0;for(let q=N;q<k;q++)z.disableVertexAttribArray(q)}p.enableAttributes(z,u),p.bind(),p.setVertexAttribPointers(z,u,I);for(const q of v)q.enableAttributes(z,u),q.bind(),q.setVertexAttribPointers(z,u,I);for(const q of P)q&&(q.enableAttributes(z,u),q.bind(),q.setVertexAttribPointers(z,u,I));w&&w.bind(),U.currentNumAttributes=N}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Xa(_,u){const p=Math.pow(2,u.canonical.z),v=u.canonical.y;return[new h.MercatorCoordinate(0,v/p).toLngLat().lat,new h.MercatorCoordinate(0,(v+1)/p).toLngLat().lat]}function Pg(_,u,p,v,w,I,P){const k=_.context,N=k.gl,U=p.fbo;if(!U)return;_.prepareDrawTile();const z=_.useProgram("hillshade");k.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,U.colorAttachment.get());const q=((ve,we,K,de)=>{const Ae=K.paint.get("hillshade-shadow-color"),Se=K.paint.get("hillshade-highlight-color"),Ge=K.paint.get("hillshade-accent-color");let Ye=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===K.paint.get("hillshade-illumination-anchor")&&(Ye-=ve.transform.angle);const Xe=!ve.options.moving;return{u_matrix:de||ve.transform.calculateProjMatrix(we.tileID.toUnwrapped(),Xe),u_image:0,u_latrange:Xa(0,we.tileID),u_light:[K.paint.get("hillshade-exaggeration"),Ye],u_shadow:Ae,u_highlight:Se,u_accent:Ge}})(_,p,v,_.terrain?u.projMatrix:null);_.prepareDrawProgram(k,z,u.toUnwrapped());const{tileBoundsBuffer:le,tileBoundsIndexBuffer:ye,tileBoundsSegments:be}=_.getTileBoundsBuffers(p);z.draw(k,N.TRIANGLES,w,I,P,h.CullFaceMode.disabled,q,v.id,le,ye,be)}function vd(_,u,p){if(!u.needsDEMTextureUpload)return;const v=_.context,w=v.gl;v.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||_.getTileTexture(p.stride);const I=p.getPixels();u.demTexture?u.demTexture.update(I,{premultiply:!1}):u.demTexture=new h.Texture(v,I,w.RGBA,{premultiply:!1}),u.needsDEMTextureUpload=!1}function fl(_,u,p,v,w,I){const P=_.context,k=P.gl;if(!u.dem)return;const N=u.dem;if(P.activeTexture.set(k.TEXTURE1),vd(_,u,N),!u.demTexture)return;u.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);const U=N.dim;P.activeTexture.set(k.TEXTURE0);let z=u.fbo;if(!z){const be=new h.Texture(P,{width:U,height:U,data:null},k.RGBA);be.bind(k.LINEAR,k.CLAMP_TO_EDGE),z=u.fbo=P.createFramebuffer(U,U,!0),z.colorAttachment.set(be.texture)}P.bindFramebuffer.set(z.framebuffer),P.viewport.set([0,0,U,U]);const{tileBoundsBuffer:q,tileBoundsIndexBuffer:le,tileBoundsSegments:ye}=_.getMercatorTileBoundsBuffers();_.useProgram("hillshadePrepare").draw(P,k.TRIANGLES,v,w,I,h.CullFaceMode.disabled,((be,ve)=>{const we=ve.stride,K=h.create();return h.ortho(K,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(K,K,[0,-h.EXTENT,0]),{u_matrix:K,u_image:1,u_dimension:[we,we],u_zoom:be.overscaledZ,u_unpack:ve.unpackVector}})(u.tileID,N),p.id,q,le,ye),u.needsHillshadePrepare=!1}const Ds=_=>({u_matrix:new h.UniformMatrix4f(_),u_image0:new h.Uniform1i(_),u_skirt_height:new h.Uniform1f(_)}),fa=(_,u)=>({u_matrix:_,u_image0:0,u_skirt_height:u}),Us=(_,u,p,v,w,I,P,k,N,U,z,q,le,ye,be)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:u,u_normalize_matrix:Float32Array.from(v),u_merc_matrix:p,u_zoom_transition:w,u_merc_center:I,u_image0:0,u_frustum_tl:P,u_frustum_tr:k,u_frustum_br:N,u_frustum_bl:U,u_globe_pos:z,u_globe_radius:q,u_viewport:le,u_grid_matrix:be?Float32Array.from(be):new Float32Array(9),u_skirt_height:ye});function js(_,u){return null!=_&&null!=u&&!(!_.hasData()||!u.hasData())&&null!=_.demTexture&&null!=u.demTexture&&_.tileID.key!==u.tileID.key}const Yi=new class{constructor(){this.operations={}}newMorphing(_,u,p,v,w){if(_ in this.operations){const I=this.operations[_];I.to.tileID.key!==p.tileID.key&&(I.queued=p)}else this.operations[_]={startTime:v,phase:0,duration:w,from:u,to:p,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const u=this.operations[_];return{from:u.from,to:u.to,phase:u.phase}}update(_){for(const u in this.operations){const p=this.operations[u];for(p.phase=(_-p.startTime)/p.duration;p.phase>=1||!this._validOp(p);)if(!this._nextOp(p,_)){delete this.operations[u];break}}}_nextOp(_,u){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=u,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},pl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Qa(_){return 6*Math.pow(1.5,22-_)}function ch(_,u){const p=1<<_.z;return!u&&(0===_.x||_.x===p-1)||0===_.y||_.y===p-1}const Ol=_=>({u_matrix:_});function Ja(_,u,p,v,w){if(w>0){const I=h.exported.now(),P=(I-_.timeAdded)/w,k=u?(I-u.timeAdded)/w:-1,N=p.getSource(),U=v.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),z=!u||Math.abs(u.tileID.overscaledZ-U)>Math.abs(_.tileID.overscaledZ-U),q=z&&_.refreshedUponExpiration?1:h.clamp(z?P:1-k,0,1);return _.refreshedUponExpiration&&P>=1&&(_.refreshedUponExpiration=!1),u?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}class hc extends h.SourceCache{constructor(u){const p={type:"raster-dem",maxzoom:u.transform.maxZoom},v=new Kt(po(),null),w=Te("mock-dem",p,v,u.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(u,p){u.state="loaded",p(null)}}class Gc extends h.SourceCache{constructor(u){const p=Te("proxy",{type:"geojson",maxzoom:u.transform.maxZoom},new Kt(po(),null),u.style);super("proxy",p,!1),p.setEventedParent(this),this.map=this.getSource().map=u,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(u,p,v){if(u.freezeTileCoverage)return;this.transform=u;const w=u.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((I,P)=>{if(I[P.key]="",!this._tiles[P.key]){const k=new h.Tile(P,this._source.tileSize*P.overscaleFactor(),u.tileZoom);k.state="loaded",this._tiles[P.key]=k}return I},{});for(const I in this._tiles)I in w||(this.freeFBO(I),this._tiles[I].unloadVectorData(),delete this._tiles[I])}freeFBO(u){const p=this.proxyCachedFBO[u];if(void 0!==p){const v=Object.values(p);this.renderCachePool.push(...v),delete this.proxyCachedFBO[u]}}deallocRenderCache(){this.renderCache.forEach(u=>u.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class As extends h.OverscaledTileID{constructor(u,p,v){super(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y),this.proxyTileKey=p,this.projMatrix=v}}class ku extends h.Elevation{constructor(u,p){super(),this.painter=u,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[v,w,I]=function(N){const U=new h.StructArrayLayout2i4,z=new h.StructArrayLayout3ui6,q=131;U.reserve(17161),z.reserve(33800);const le=h.EXTENT/128,ye=h.EXTENT+le/2,be=ye+le;for(let we=-le;we<be;we+=le)for(let K=-le;K<be;K+=le){const de=K<0||K>ye||we<0||we>ye?24575:0,Ae=h.clamp(Math.round(K),0,h.EXTENT),Se=h.clamp(Math.round(we),0,h.EXTENT);U.emplaceBack(Ae+de,Se)}const ve=(we,K)=>{const de=K*q+we;z.emplaceBack(de+1,de,de+q),z.emplaceBack(de+q,de+q+1,de+1)};for(let we=1;we<129;we++)for(let K=1;K<129;K++)ve(K,we);return[0,129].forEach(we=>{for(let K=0;K<130;K++)ve(K,we),ve(we,K)}),[U,z,32768]}(),P=u.context;this.gridBuffer=P.createVertexBuffer(v,h.posAttributes.members),this.gridIndexBuffer=P.createIndexBuffer(w),this.gridSegments=h.SegmentVector.simpleSegment(0,0,v.length,w.length),this.gridNoSkirtSegments=h.SegmentVector.simpleSegment(0,0,v.length,I),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Gc(p.map),this.orthoMatrix=h.create(),h.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,h.EXTENT,0,h.EXTENT,0,1);const k=P.gl;this._overlapStencilMode=new h.StencilMode({func:k.GEQUAL,mask:255},0,255,k.KEEP,k.KEEP,k.REPLACE),this._previousZoom=u.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=p,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new hc(p.map)}set style(u){u.on("data",this._onStyleDataEvent.bind(this)),u.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=u,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(u,p,v){if(u&&u.terrain){this._style!==u&&(this.style=u),this.enabled=!0;const w=u.terrain.properties;this.sourceCache=0===u.terrain.drapeRenderMode?this._mockSourceCache:u._getSourceCache(w.get("source")),this._exaggeration=w.get("exaggeration");const I=()=>{this.sourceCache.used&&h.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const P=this.getScaledDemTileSize();this.sourceCache.update(p,P,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,I(),this._initializing=!0),I(),p.updateElevation(!0,v),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(p),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(u){this._findCoveringTileCache[u]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const u=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==u.efficiency&&h.warnOnce(`Terrain render cache efficiency is not optimal (${u.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${u.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(u){u.coord&&"source"===u.dataType?this._clearRenderCacheForTile(u.sourceCacheId,u.coord):"style"===u.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const u in this._style._sourceCaches)this._style._sourceCaches[u].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(u=>u.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const u=2*this.proxySourceCache.getSource().tileSize;return[u,u]}set useVertexMorphing(u){this._useVertexMorphing=u}updateTileBinding(u){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const p=this.proxySourceCache,v=this.painter.transform;this._initializing&&(this._initializing=0===v._centerAltitude&&-1===this.getAtPointOrZero(h.MercatorCoordinate.fromLngLat(v.center),-1),this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=p.getIds().map(N=>{const U=p.getTileByID(N).tileID;return U.projMatrix=v.calculateProjMatrix(U.toUnwrapped()),U});(function(N,U){const z=U.transform.pointCoordinate(U.transform.getCameraPoint()),q=new h.Point(z.x,z.y);N.sort((le,ye)=>{if(ye.overscaledZ-le.overscaledZ)return ye.overscaledZ-le.overscaledZ;const be=new h.Point(le.canonical.x+(1<<le.canonical.z)*le.wrap,le.canonical.y),ve=new h.Point(ye.canonical.x+(1<<ye.canonical.z)*ye.wrap,ye.canonical.y),we=q.mult(1<<le.canonical.z);return we.x-=.5,we.y-=.5,we.distSqr(be)-we.distSqr(ve)})})(w,this.painter),this._previousZoom=v.zoom;const I=this.proxyToSource||{};this.proxyToSource={},w.forEach(N=>{this.proxyToSource[N.key]={}}),this.terrainTileForTile={};const P=this._style._sourceCaches;for(const N in P){const U=P[N];if(!U.used||(U!==this.sourceCache&&this.resetTileLookupCache(U.id),this._setupProxiedCoordsForOrtho(U,u[N],I),U.usedForTerrain))continue;const z=u[N];U.getSource().reparseOverscaled&&this._assignTerrainTiles(z)}this.proxiedCoords[p.id]=w.map(N=>new As(N,N.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(I),this.renderingToTexture=!1,this._updateTimestamp=h.exported.now();const k={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const U=this.terrainTileForTile[N.key];if(!U)continue;const z=U.tileID.key;z in k||(this._visibleDemTiles.push(U),k[z]=z)}}_assignTerrainTiles(u){this._initializing||u.forEach(p=>{if(this.terrainTileForTile[p.key])return;const v=this._findTileCoveringTileID(p,this.sourceCache);v&&(this.terrainTileForTile[p.key]=v)})}_prepareDEMTextures(){const u=this.painter.context,p=u.gl;for(const v in this.terrainTileForTile){const w=this.terrainTileForTile[v],I=w.dem;!I||w.demTexture&&!w.needsDEMTextureUpload||(u.activeTexture.set(p.TEXTURE1),vd(this.painter,w,I))}}_prepareDemTileUniforms(u,p,v,w){if(!p||null==p.demTexture)return!1;const I=u.tileID.canonical,P=Math.pow(2,p.tileID.canonical.z-I.z),k=w||"";return v[`u_dem_tl${k}`]=[I.x*P%1,I.y*P%1],v[`u_dem_scale${k}`]=P,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const u=this.painter.context,p=u.gl;if(!this._emptyDepthBufferTexture){const v=new h.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new h.Texture(u,v,p.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let u=0;const p=this._visibleDemTiles.reduce((v,w)=>{if(!w.dem)return v;const I=w.dem.tree.minimums[0];return I>0&&u++,v+I},0);return u?p/u:0}_updateEmptyDEMTexture(){const u=this.painter.context,p=u.gl;u.activeTexture.set(p.TEXTURE2);const v=this._getLoadedAreaMinimum(),w=new h.RGBAImage({width:1,height:1},new Uint8Array(h.DEMData.pack(v,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let I=this._emptyDEMTexture;return I?I.update(w,{premultiply:!1}):I=this._emptyDEMTexture=new h.Texture(u,w,p.RGBA,{premultiply:!1}),I}setupElevationDraw(u,p,v){const w=this.painter.context,I=w.gl,P=(k=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:h.DEMData.getUnpackVector(k),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var k;P.u_dem_size=this.sourceCache.getSource().tileSize,P.u_exaggeration=this.exaggeration();let N=null,U=null,z=1;if(v&&v.morphing&&this._useVertexMorphing){const q=v.morphing.srcDemTile,le=v.morphing.dstDemTile;z=v.morphing.phase,q&&le&&(this._prepareDemTileUniforms(u,q,P,"_prev")&&(U=q),this._prepareDemTileUniforms(u,le,P)&&(N=le))}if(U&&N?(w.activeTexture.set(I.TEXTURE2),N.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE,I.NEAREST),w.activeTexture.set(I.TEXTURE4),U.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE,I.NEAREST),P.u_dem_lerp=z):(N=this.terrainTileForTile[u.tileID.key],w.activeTexture.set(I.TEXTURE2),(this._prepareDemTileUniforms(u,N,P)?N.demTexture:this.emptyDEMTexture).bind(I.NEAREST,I.CLAMP_TO_EDGE)),w.activeTexture.set(I.TEXTURE3),v&&v.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE),this._depthFBO&&(P.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE),P.u_depth_size_inv=[1,1]),v&&v.useMeterToDem&&N){const q=(1<<N.tileID.canonical.z)*h.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;P.u_meter_to_dem=q}if(v&&v.labelPlaneMatrixInv&&(P.u_label_plane_matrix_inv=v.labelPlaneMatrixInv),p.setTerrainUniformValues(w,P),"globe"===this.painter.transform.projection.name){const q=this.globeUniformValues(this.painter.transform,u.tileID.canonical,v&&v.useDenormalizedUpVectorScale);p.setGlobeUniformValues(w,q)}}globeUniformValues(u,p,v){const w=u.projection;return{u_tile_tl_up:w.upVector(p,0,0),u_tile_tr_up:w.upVector(p,h.EXTENT,0),u_tile_br_up:w.upVector(p,h.EXTENT,h.EXTENT),u_tile_bl_up:w.upVector(p,0,h.EXTENT),u_tile_up_scale:v?h.globeMetersToEcef(1):w.upVectorScale(p,u.center.lat,u.worldSize).metersToTile}}renderToBackBuffer(u){const p=this.painter,v=this.painter.context;0!==u.length&&(v.bindFramebuffer.set(null),v.viewport.set([0,0,p.width,p.height]),p.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,I,P,k,N){if("globe"===w.transform.projection.name)!function(U,z,q,le,ye){const be=U.context,ve=be.gl;let we,K;const de=U.options.showTerrainWireframe?2:0,Ae=U.transform,Se=h.globeUseCustomAntiAliasing(U,be,Ae),Ge=(en,vt)=>{if(K===en)return;const Ut=[pl[en],"PROJECTION_GLOBE_VIEW"];Se&&Ut.push("CUSTOM_ANTIALIASING"),vt&&Ut.push(pl[de]),we=U.useProgram("globeRaster",null,Ut),K=en},Ye=U.colorModeForRenderPass(),Xe=new h.DepthMode(ve.LEQUAL,h.DepthMode.ReadWrite,U.depthRangeFor3D);Yi.update(ye);const ct=h.calculateGlobeMercatorMatrix(Ae),st=[h.mercatorXfromLng(Ae.center.lng),h.mercatorYfromLat(Ae.center.lat)],Ct=de?[!1,!0]:[!1],rn=U.globeSharedBuffers,_t=[Ae.width*h.exported.devicePixelRatio,Ae.height*h.exported.devicePixelRatio],zt=Float32Array.from(Ae.globeMatrix),Dt={useDenormalizedUpVectorScale:!0};if(Ct.forEach(en=>{const vt=U.transform,Ut=Qa(vt.zoom)*z.exaggeration();K=-1;const sn=en?ve.LINES:ve.TRIANGLES;for(const Zt of le){const Mt=q.getTile(Zt),Kn=h.StencilMode.disabled,pi=z.prevTerrainTileForTile[Zt.key],Ln=z.terrainTileForTile[Zt.key];js(pi,Ln)&&Yi.newMorphing(Zt.key,pi,Ln,ye,250),be.activeTexture.set(ve.TEXTURE0),Mt.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);const oi=Yi.getMorphValuesForProxy(Zt.key),Ni=oi?1:0;oi&&h.extend$1(Dt,{morphing:{srcDemTile:oi.from,dstDemTile:oi.to,phase:h.easeCubicInOut(oi.phase)}});const Si=h.tileCornersToBounds(Zt.canonical),Bn=h.getLatitudinalLod(Si.getCenter().lat),mr=h.getGridMatrix(Zt.canonical,Si,Bn,vt.worldSize/vt._pixelsPerMercatorPixel),br=h.globeNormalizeECEF(h.globeTileBounds(Zt.canonical)),wr=Us(vt.projMatrix,zt,ct,br,h.globeToMercatorTransition(vt.zoom),st,vt.frustumCorners.TL,vt.frustumCorners.TR,vt.frustumCorners.BR,vt.frustumCorners.BL,vt.globeCenterInViewSpace,vt.globeRadius,_t,Ut,mr);if(Ge(Ni,en),z.setupElevationDraw(Mt,we,Dt),U.prepareDrawProgram(be,we,Zt.toUnwrapped()),rn){const[Er,Ps,qt]=en?rn.getWirefameBuffers(U.context,Bn):rn.getGridBuffers(Bn,0!==Ut);we.draw(be,sn,Xe,Kn,Ye,h.CullFaceMode.backCCW,wr,"globe_raster",Er,Ps,qt)}}}),rn){const en=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Se&&en.push("CUSTOM_ANTIALIASING"),we=U.useProgram("globeRaster",null,en);for(const vt of le){const{x:Ut,y:sn,z:Zt}=vt.canonical,Mt=0===sn,Kn=sn===(1<<Zt)-1,[pi,Ln,oi,Ni]=rn.getPoleBuffers(Zt);if(Ni&&(Mt||Kn)){const Si=q.getTile(vt);be.activeTexture.set(ve.TEXTURE0),Si.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);let Bn=h.globePoleMatrixForTile(Zt,Ut,Ae);const mr=h.globeNormalizeECEF(h.globeTileBounds(vt.canonical)),br=(wr,Er)=>wr.draw(be,ve.TRIANGLES,Xe,h.StencilMode.disabled,Ye,h.CullFaceMode.disabled,Us(Ae.projMatrix,Bn,Bn,mr,0,st,Ae.frustumCorners.TL,Ae.frustumCorners.TR,Ae.frustumCorners.BR,Ae.frustumCorners.BL,Ae.globeCenterInViewSpace,Ae.globeRadius,_t,0),"globe_pole_raster",Er,oi,Ni);z.setupElevationDraw(Si,we,Dt),U.prepareDrawProgram(be,we,vt.toUnwrapped()),Mt&&br(we,pi),Kn&&(Bn=h.scale(h.create(),Bn,[1,-1,1]),br(we,Ln))}}}}(w,I,P,k,N);else{const U=w.context,z=U.gl;let q,le;const ye=w.options.showTerrainWireframe?2:0,be=(Ae,Se)=>{if(le===Ae)return;const Ge=[pl[Ae]];Se&&Ge.push(pl[ye]),q=w.useProgram("terrainRaster",null,Ge),le=Ae},ve=w.colorModeForRenderPass(),we=new h.DepthMode(z.LEQUAL,h.DepthMode.ReadWrite,w.depthRangeFor3D);Yi.update(N);const K=w.transform,de=Qa(K.zoom)*I.exaggeration();(ye?[!1,!0]:[!1]).forEach(Ae=>{le=-1;const Se=Ae?z.LINES:z.TRIANGLES,[Ge,Ye]=Ae?I.getWirefameBuffer():[I.gridIndexBuffer,I.gridSegments];for(const Xe of k){const ct=P.getTile(Xe),st=h.StencilMode.disabled,Ct=I.prevTerrainTileForTile[Xe.key],rn=I.terrainTileForTile[Xe.key];js(Ct,rn)&&Yi.newMorphing(Xe.key,Ct,rn,N,250),U.activeTexture.set(z.TEXTURE0),ct.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST);const _t=Yi.getMorphValuesForProxy(Xe.key),zt=_t?1:0;let Dt;_t&&(Dt={morphing:{srcDemTile:_t.from,dstDemTile:_t.to,phase:h.easeCubicInOut(_t.phase)}});const en=fa(Xe.projMatrix,ch(Xe.canonical,K.renderWorldCopies)?de/10:de);be(zt,Ae),I.setupElevationDraw(ct,q,Dt),w.prepareDrawProgram(U,q,Xe.toUnwrapped()),q.draw(U,Se,we,st,ve,h.CullFaceMode.backCCW,en,"terrain_raster",I.gridBuffer,Ge,Ye)}})}}(p,this,this.proxySourceCache,u,this._updateTimestamp),this.renderingToTexture=!0,p.gpuTimingDeferredRenderEnd(),u.splice(0,u.length))}renderBatch(u){if(0===this._drapedRenderBatches.length)return u+1;this.renderingToTexture=!0;const p=this.painter,v=this.painter.context,w=this.proxySourceCache,I=this.proxiedCoords[w.id],P=this._drapedRenderBatches.shift(),k=[],N=p.style.order;let U=0;for(const z of I){const q=w.getTileByID(z.proxyTileKey),le=w.proxyCachedFBO[z.key]?w.proxyCachedFBO[z.key][u]:void 0,ye=void 0!==le?w.renderCache[le]:this.pool[U++],be=void 0!==le;if(q.texture=ye.tex,be&&!ye.dirty){k.push(q.tileID);continue}let ve;v.bindFramebuffer.set(ye.fb.framebuffer),this.renderedToTile=!1,ye.dirty&&(v.clear({color:h.Color.transparent,stencil:0}),ye.dirty=!1);for(let we=P.start;we<=P.end;++we){const K=p.style._layers[N[we]];if(K.isHidden(p.transform.zoom))continue;const de=p.style._getLayerSourceCache(K),Ae=de?this.proxyToSource[z.key][de.id]:[z];if(!Ae)continue;const Se=Ae;v.viewport.set([0,0,ye.fb.width,ye.fb.height]),ve!==(de?de.id:null)&&(this._setupStencil(ye,Ae,K,de),ve=de?de.id:null),p.renderLayer(p,de,K,Se)}this.renderedToTile?(ye.dirty=!0,k.push(q.tileID)):be||--U,5===U&&(U=0,this.renderToBackBuffer(k))}return this.renderToBackBuffer(k),this.renderingToTexture=!1,v.bindFramebuffer.set(null),v.viewport.set([0,0,p.width,p.height]),P.end+1}postRender(){}renderCacheEfficiency(u){const p=u.order.length;if(0===p)return{efficiency:100};let v,w=0,I=0,P=!1;for(let k=0;k<p;++k){const N=u._layers[u.order[k]];this._style.isLayerDraped(N)?(P&&++w,++I):P||(P=!0,v=N.id)}return 0===I?{efficiency:100}:{efficiency:100*(1-w/I),firstUndrapedLayer:v}}getMinElevationBelowMSL(){let u=0;return this._visibleDemTiles.filter(p=>p.dem).forEach(p=>{u=Math.min(u,p.dem.tree.minimums[0])}),0===u?u:(u-30)*this._exaggeration}raycast(u,p,v){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(I=>I.dem).map(I=>{const P=I.tileID,k=1<<P.overscaledZ,{x:N,y:U}=P.canonical,z=N/k,q=(N+1)/k,le=U/k,ye=(U+1)/k;return{minx:z,miny:le,maxx:q,maxy:ye,t:I.dem.tree.raycastRoot(z,le,q,ye,u,p,v),tile:I}});w.sort((I,P)=>(null!==I.t?I.t:Number.MAX_VALUE)-(null!==P.t?P.t:Number.MAX_VALUE));for(const I of w){if(null==I.t)return null;const P=I.tile.dem.tree.raycast(I.minx,I.miny,I.maxx,I.maxy,u,p,v);if(null!=P)return P}return null}_createFBO(){const u=this.painter.context,p=u.gl,v=this.drapeBufferSize;u.activeTexture.set(p.TEXTURE0);const w=new h.Texture(u,{width:v[0],height:v[1],data:null},p.RGBA);w.bind(p.LINEAR,p.CLAMP_TO_EDGE);const I=u.createFramebuffer(v[0],v[1],!1);return I.colorAttachment.set(w.texture),I.depthAttachment=new et(u,I.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=u.createRenderbuffer(u.gl.DEPTH_STENCIL,v[0],v[1]),this._stencilRef=0,I.depthAttachment.set(this._sharedDepthStencil),u.clear({stencil:0})):I.depthAttachment.set(this._sharedDepthStencil),u.extTextureFilterAnisotropic&&!u.extTextureFilterAnisotropicForceOff&&p.texParameterf(p.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax),{fb:I,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u].hasTransition())return!0;return this._style.order.some(u=>{const p=this._style._layers[u],v=p.isHidden(this.painter.transform.zoom);return"custom"===p.type?!v&&p.shouldRedrape():!v&&p.hasTransition()})}_clearLineLayersFromRenderCache(){let u=!1;for(const v of this._style._getSources())if(v instanceof Ee){u=!0;break}if(!u)return;const p={};for(let v=0;v<this._style.order.length;++v){const w=this._style._layers[this._style.order[v]],I=this._style._getLayerSourceCache(w);if(I&&!p[I.id]&&!w.isHidden(this.painter.transform.zoom)&&"line"===w.type&&w.widthExpression()instanceof h.ZoomDependentExpression){p[I.id]=!0;for(const P of this.proxyCoords){const k=this.proxyToSource[P.key][I.id];if(k)for(const N of k)this._clearRenderCacheForTile(I.id,N)}}}}_clearRasterLayersFromRenderCache(){let u=!1;for(const v in this._style._sourceCaches)if(this._style._sourceCaches[v]._source instanceof pe){u=!0;break}if(!u)return;const p={};for(let v=0;v<this._style.order.length;++v){const w=this._style._layers[this._style.order[v]],I=this._style._getLayerSourceCache(w);if(!I||p[I.id]||w.isHidden(this.painter.transform.zoom)||"raster"!==w.type)continue;const P=w.paint.get("raster-fade-duration");for(const k of this.proxyCoords){const N=this.proxyToSource[k.key][I.id];if(N)for(const U of N){const z=Ja(I.getTile(U),I.findLoadedParent(U,0),I,this.painter.transform,P);(1!==z.opacity||0!==z.mix)&&this._clearRenderCacheForTile(I.id,U)}}}}_setupDrapedRenderBatches(){const u=this._style.order,p=u.length;if(0===p)return;const v=[];let w,I=0,P=this._style._layers[u[I]];for(;!this._style.isLayerDraped(P)&&P.isHidden(this.painter.transform.zoom)&&++I<p;)P=this._style._layers[u[I]];for(;I<p;++I){const k=this._style._layers[u[I]];k.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(k)?void 0===w&&(w=I):void 0!==w&&(v.push({start:w,end:I-1}),w=void 0))}void 0!==w&&v.push({start:w,end:I-1}),this._drapedRenderBatches=v}_setupRenderCache(u){const p=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,p.renderCache.length>p.renderCachePool.length){const P=Object.values(p.proxyCachedFBO);p.proxyCachedFBO={};for(let k=0;k<P.length;++k){const N=Object.values(P[k]);p.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const v=this.proxyCoords,w=this._tilesDirty;for(let P=v.length-1;P>=0;P--){const k=v[P];if(p.getTileByID(k.key),void 0!==p.proxyCachedFBO[k.key]){const N=u[k.key],U=this.proxyToSource[k.key];let z=0;for(const q in U){const le=U[q],ye=N[q];if(!ye||ye.length!==le.length||le.some((be,ve)=>be!==ye[ve]||w[q]&&w[q].hasOwnProperty(be.key))){z=-1;break}++z}for(const q in p.proxyCachedFBO[k.key])p.renderCache[p.proxyCachedFBO[k.key][q]].dirty=z<0||z!==Object.values(N).length}}const I=[...this._drapedRenderBatches];I.sort((P,k)=>k.end-k.start-(P.end-P.start));for(const P of I)for(const k of v){if(p.proxyCachedFBO[k.key])continue;let N=p.renderCachePool.pop();void 0===N&&p.renderCache.length<50&&(N=p.renderCache.length,p.renderCache.push(this._createFBO())),void 0!==N&&(p.proxyCachedFBO[k.key]={},p.proxyCachedFBO[k.key][P.start]=N,p.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(u,p,v,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const I=this.painter.context,P=I.gl;if(p.length<=1)return void(this._overlapStencilType=!1);let k;if(v.isTileClipped())k=p.length,this._overlapStencilMode.test={func:P.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(p[0].overscaledZ>p[p.length-1].overscaledZ))return void(this._overlapStencilType=!1);k=1,this._overlapStencilMode.test={func:P.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+k>255&&(I.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=k,this._overlapStencilMode.ref=this._stencilRef,v.isTileClipped()&&this._renderTileClippingMasks(p,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(u){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[u.key]),this._overlapStencilMode):h.StencilMode.disabled}_renderTileClippingMasks(u,p){const v=this.painter,w=this.painter.context,I=w.gl;v._tileClippingMaskIDs={},w.setColorMode(h.ColorMode.disabled),w.setDepthMode(h.DepthMode.disabled);const P=v.useProgram("clippingMask");for(const k of u){const N=v._tileClippingMaskIDs[k.key]=--p;P.draw(w,I.TRIANGLES,h.DepthMode.disabled,new h.StencilMode({func:I.ALWAYS,mask:0},N,255,I.KEEP,I.KEEP,I.REPLACE),h.ColorMode.disabled,h.CullFaceMode.disabled,Ol(k.projMatrix),"$clipping",v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}}pointCoordinate(u){const p=this.painter.transform;if(u.x<0||u.x>p.width||u.y<0||u.y>p.height)return null;const v=[u.x,u.y,1,1];h.transformMat4$1(v,v,p.pixelMatrixInverse),h.scale$1(v,v,1/v[3]),v[0]/=p.worldSize,v[1]/=p.worldSize;const w=p._camera.position,I=h.mercatorZfromAltitude(1,p.center.lat),P=[w[0],w[1],w[2]/I,0],k=h.subtract([],v.slice(0,3),P);h.normalize(k,k);const N=this.raycast(P,k,this._exaggeration);return null!==N&&N?(h.scaleAndAdd(P,P,k,N),P[3]=P[2],P[2]*=I,P):null}drawDepth(){const u=this.painter,p=u.context,v=this.proxySourceCache,w=Math.ceil(u.width),I=Math.ceil(u.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===I||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const P=p.gl,k=p.createFramebuffer(w,I,!0);p.activeTexture.set(P.TEXTURE0);const N=new h.Texture(p,{width:w,height:I,data:null},P.RGBA);N.bind(P.NEAREST,P.CLAMP_TO_EDGE),k.colorAttachment.set(N.texture);const U=p.createRenderbuffer(p.gl.DEPTH_COMPONENT16,w,I);k.depthAttachment.set(U),this._depthFBO=k,this._depthTexture=N}p.bindFramebuffer.set(this._depthFBO.framebuffer),p.viewport.set([0,0,w,I]),function(P,k,N,U){if("globe"===P.transform.projection.name)return;const z=P.context,q=z.gl;z.clear({depth:1});const le=P.useProgram("terrainDepth"),ye=new h.DepthMode(q.LESS,h.DepthMode.ReadWrite,P.depthRangeFor3D);for(const be of U){const ve=N.getTile(be),we=fa(be.projMatrix,0);k.setupElevationDraw(ve,le),le.draw(z,q.TRIANGLES,ye,h.StencilMode.disabled,h.ColorMode.unblended,h.CullFaceMode.backCCW,we,"terrain_depth",k.gridBuffer,k.gridIndexBuffer,k.gridNoSkirtSegments)}}(u,this,v,this.proxyCoords)}_setupProxiedCoordsForOrtho(u,p,v){if(u.getSource()instanceof ue)return this._setupProxiedCoordsForImageSource(u,p,v);this._findCoveringTileCache[u.id]=this._findCoveringTileCache[u.id]||{};const w=this.proxiedCoords[u.id]=[],I=this.proxyCoords;for(let k=0;k<I.length;k++){const N=I[k],U=this._findTileCoveringTileID(N,u);if(U){const z=this._createProxiedId(N,U,v[N.key]&&v[N.key][u.id]);w.push(z),this.proxyToSource[N.key][u.id]=[z]}}let P=!1;for(let k=0;k<p.length;k++){const N=u.getTile(p[k]);if(!N||!N.hasData())continue;const U=this._findTileCoveringTileID(N.tileID,this.proxySourceCache);if(U&&U.tileID.canonical.z!==N.tileID.canonical.z){const z=this.proxyToSource[U.tileID.key][u.id],q=this._createProxiedId(U.tileID,N,v[U.tileID.key]&&v[U.tileID.key][u.id]);z?z.splice(z.length-1,0,q):this.proxyToSource[U.tileID.key][u.id]=[q],w.push(q),P=!0}}this._sourceTilesOverlap[u.id]=P}_setupProxiedCoordsForImageSource(u,p,v){if(!u.getSource().loaded())return;const w=this.proxiedCoords[u.id]=[],I=this.proxyCoords,P=u.getSource(),k=new h.Point(P.tileID.x,P.tileID.y)._div(1<<P.tileID.z),N=P.coordinates.map(h.MercatorCoordinate.fromLngLat).reduce((z,q)=>(z.min.x=Math.min(z.min.x,q.x-k.x),z.min.y=Math.min(z.min.y,q.y-k.y),z.max.x=Math.max(z.max.x,q.x-k.x),z.max.y=Math.max(z.max.y,q.y-k.y),z),{min:new h.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new h.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),U=(z,q)=>{const le=z.wrap+z.canonical.x/(1<<z.canonical.z),ye=z.canonical.y/(1<<z.canonical.z),be=h.EXTENT/(1<<z.canonical.z),ve=q.wrap+q.canonical.x/(1<<q.canonical.z),we=q.canonical.y/(1<<q.canonical.z);return le+be<ve+N.min.x||le>ve+N.max.x||ye+be<we+N.min.y||ye>we+N.max.y};for(let z=0;z<I.length;z++){const q=I[z];for(let le=0;le<p.length;le++){const ye=u.getTile(p[le]);if(!ye||!ye.hasData()||U(q,ye.tileID))continue;const be=this._createProxiedId(q,ye,v[q.key]&&v[q.key][u.id]),ve=this.proxyToSource[q.key][u.id];ve?ve.push(be):this.proxyToSource[q.key][u.id]=[be],w.push(be)}}}_createProxiedId(u,p,v){let w=this.orthoMatrix;if(v){const I=v.find(P=>P.key===p.tileID.key);if(I)return I}if(p.tileID.key!==u.key){const I=u.canonical.z-p.tileID.canonical.z;let P,k,N;w=h.create();const U=p.tileID.wrap-u.wrap<<u.overscaledZ;I>0?(P=h.EXTENT>>I,k=P*((p.tileID.canonical.x<<I)-u.canonical.x+U),N=P*((p.tileID.canonical.y<<I)-u.canonical.y)):(P=h.EXTENT<<-I,k=h.EXTENT*(p.tileID.canonical.x-(u.canonical.x+U<<-I)),N=h.EXTENT*(p.tileID.canonical.y-(u.canonical.y<<-I))),h.ortho(w,0,P,0,P,0,1),h.translate(w,w,[k,N,0])}return new As(p.tileID,u.key,w)}_findTileCoveringTileID(u,p){let v=p.getTile(u);if(v&&v.hasData())return v;const w=this._findCoveringTileCache[p.id],I=w[u.key];if(v=I?p.getTileByID(I):null,v&&v.hasData()||null===I)return v;let P=v?v.tileID:u,k=P.overscaledZ;const N=p.getSource().minzoom,U=[];if(!I){const q=p.getSource().maxzoom;if(u.canonical.z>=q){const le=u.canonical.z-q;p.getSource().reparseOverscaled?(k=Math.max(u.canonical.z+2,p.transform.tileZoom),P=new h.OverscaledTileID(k,u.wrap,q,u.canonical.x>>le,u.canonical.y>>le)):0!==le&&(k=q,P=new h.OverscaledTileID(k,u.wrap,q,u.canonical.x>>le,u.canonical.y>>le))}P.key!==u.key&&(U.push(P.key),v=p.getTile(P))}const z=q=>{U.forEach(le=>{w[le]=q}),U.length=0};for(k-=1;k>=N&&(!v||!v.hasData());k--){v&&z(v.tileID.key);const q=P.calculateScaledKey(k);if(v=p.getTileByID(q),v&&v.hasData())break;const le=w[q];if(null===le)break;void 0===le?U.push(q):v=p.getTileByID(le)}return z(v?v.tileID.key:null),v&&v.hasData()?v:null}findDEMTileFor(u){return this.enabled?this._findTileCoveringTileID(u,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(u,p){let v=this._tilesDirty[u];v||(v=this._tilesDirty[u]={}),v[p.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const u=function(p){let v=0;const w=new h.StructArrayLayout2ui4,I=131;for(let P=1;P<129;P++){for(let k=1;k<129;k++)v=P*I+k,w.emplaceBack(v,v+1),w.emplaceBack(v,v+I),w.emplaceBack(v+1,v+I),128===P&&w.emplaceBack(v+I,v+I+1);w.emplaceBack(v+1,v+1+I)}return w}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(u),this.wireframeSegments=h.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,u.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class tr{static cacheKey(u,p,v,w){let I=`${p}${w?w.cacheKey:""}`;for(const P of v)u.usedDefines.includes(P)&&(I+=`/${P}`);return I}constructor(u,p,v,w,I,P){const k=u.gl;this.program=k.createProgram();const N=function(K){const de=[];for(let Ae=0;Ae<K.length;Ae++){if(null===K[Ae])continue;const Se=K[Ae].split(" ");de.push(Se.pop())}return de}(v.staticAttributes),U=w?w.getBinderAttributes():[],z=N.concat(U);let q=w?w.defines():[];q=q.concat(P.map(K=>`#define ${K}`));const le=u.isWebGL2?"#version 300 es\n":"",ye=le+q.concat(u.extStandardDerivatives&&0===le.length?"#extension GL_OES_standard_derivatives : enable\n".concat(it):it,it,lh,Ya.fragmentSource,ha.fragmentSource,v.fragmentSource).join("\n"),be=le+q.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",lh,Ya.vertexSource,ha.vertexSource,_d.vertexSource,v.vertexSource).join("\n"),ve=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(ve,ye),k.compileShader(ve),k.attachShader(this.program,ve);const we=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())this.failedToCreate=!0;else{k.shaderSource(we,be),k.compileShader(we),k.attachShader(this.program,we),this.attributes={},this.numAttributes=z.length;for(let K=0;K<this.numAttributes;K++)z[K]&&(k.bindAttribLocation(this.program,K,z[K]),this.attributes[z[K]]=K);k.linkProgram(this.program),k.deleteShader(we),k.deleteShader(ve),this.fixedUniforms=I(u),this.binderUniforms=w?w.getUniforms(u):[],P.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new h.Uniform1i(K=u),u_dem_prev:new h.Uniform1i(K),u_dem_unpack:new h.Uniform4f(K),u_dem_tl:new h.Uniform2f(K),u_dem_scale:new h.Uniform1f(K),u_dem_tl_prev:new h.Uniform2f(K),u_dem_scale_prev:new h.Uniform1f(K),u_dem_size:new h.Uniform1f(K),u_dem_lerp:new h.Uniform1f(K),u_exaggeration:new h.Uniform1f(K),u_depth:new h.Uniform1i(K),u_depth_size_inv:new h.Uniform2f(K),u_meter_to_dem:new h.Uniform1f(K),u_label_plane_matrix_inv:new h.UniformMatrix4f(K)}),P.includes("GLOBE")&&(this.globeUniforms=(K=>({u_tile_tl_up:new h.Uniform3f(K),u_tile_tr_up:new h.Uniform3f(K),u_tile_br_up:new h.Uniform3f(K),u_tile_bl_up:new h.Uniform3f(K),u_tile_up_scale:new h.Uniform1f(K)}))(u)),P.includes("FOG")&&(this.fogUniforms=(K=>({u_fog_matrix:new h.UniformMatrix4f(K),u_fog_range:new h.Uniform2f(K),u_fog_color:new h.Uniform4f(K),u_fog_horizon_blend:new h.Uniform1f(K),u_fog_temporal_offset:new h.Uniform1f(K),u_frustum_tl:new h.Uniform3f(K),u_frustum_tr:new h.Uniform3f(K),u_frustum_br:new h.Uniform3f(K),u_frustum_bl:new h.Uniform3f(K),u_globe_pos:new h.Uniform3f(K),u_globe_radius:new h.Uniform1f(K),u_globe_transition:new h.Uniform1f(K),u_is_globe:new h.Uniform1i(K),u_viewport:new h.Uniform2f(K)}))(u))}var K}setTerrainUniformValues(u,p){if(!this.terrainUniforms)return;const v=this.terrainUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const w in p)v[w]&&v[w].set(this.program,w,p[w])}}setGlobeUniformValues(u,p){if(!this.globeUniforms)return;const v=this.globeUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const w in p)v[w]&&v[w].set(this.program,w,p[w])}}setFogUniformValues(u,p){if(!this.fogUniforms)return;const v=this.fogUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const w in p)v[w].set(this.program,w,p[w])}}draw(u,p,v,w,I,P,k,N,U,z,q,le,ye,be,ve){const we=u.gl;if(this.failedToCreate)return;u.program.set(this.program),u.setDepthMode(v),u.setStencilMode(w),u.setColorMode(I),u.setCullFace(P);for(const de of Object.keys(this.fixedUniforms))this.fixedUniforms[de].set(this.program,de,k[de]);be&&be.setUniforms(this.program,u,this.binderUniforms,le,{zoom:ye});const K={[we.LINES]:2,[we.TRIANGLES]:3,[we.LINE_STRIP]:1}[p];for(const de of q.get()){const Ae=de.vaos||(de.vaos={});(Ae[N]||(Ae[N]=new Rf)).bind(u,this,U,be?be.getPaintVertexBuffers():[],z,de.vertexOffset,ve||[]),we.drawElements(p,de.primitiveLength*K,we.UNSIGNED_SHORT,de.primitiveOffset*K*2)}}}function fc(_,u){const p=Math.pow(2,u.tileID.overscaledZ),v=u.tileSize*Math.pow(2,_.transform.tileZoom)/p,w=v*(u.tileID.canonical.x+u.tileID.wrap*p),I=v*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_tile_units_to_pixels:1/Hn(u,1,_.transform.tileZoom),u_pixel_coord_upper:[w>>16,I>>16],u_pixel_coord_lower:[65535&w,65535&I]}}const Fl=h.create(),xd=(_,u,p,v,w,I,P,k,N,U,z)=>{const q=u.style.light,le=q.properties.get("position"),ye=[le.x,le.y,le.z],be=h.create$1();"viewport"===q.properties.get("anchor")&&(h.fromRotation(be,-u.transform.angle),h.transformMat3(ye,ye,be));const ve=q.properties.get("color"),we=u.transform,K={u_matrix:_,u_lightpos:ye,u_lightintensity:q.properties.get("intensity"),u_lightcolor:[ve.r,ve.g,ve.b],u_vertical_gradient:+p,u_opacity:v,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Fl,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:I};return"globe"===we.projection.name&&(K.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],K.u_zoom_transition=N,K.u_inv_rot_matrix=z,K.u_merc_center=U,K.u_up_dir=we.projection.upVector(new h.CanonicalTileID(0,0,0),U[0]*h.EXTENT,U[1]*h.EXTENT),K.u_height_lift=k),K},uh=(_,u,p,v,w,I,P,k,N,U,z,q)=>{const le=xd(_,u,p,v,w,I,P,N,U,z,q),ye={u_height_factor:-Math.pow(2,P.overscaledZ)/k.tileSize/8};return h.extend(le,fc(u,k),ye)},Wc=_=>({u_matrix:_}),Ru=(_,u,p)=>h.extend(Wc(_),fc(u,p)),Of=(_,u)=>({u_matrix:_,u_world:u}),Ff=(_,u,p,v)=>h.extend(Ru(_,u,p),{u_world:v}),Qs=h.create(),bd=(_,u,p,v,w,I)=>{const P=_.transform,k="globe"===P.projection.name;let N;if("map"===I.paint.get("circle-pitch-alignment"))if(k){const z=h.globePixelsToTileUnits(P.zoom,u.canonical)*P._pixelsPerMercatorPixel;N=Float32Array.from([z,0,0,z])}else N=P.calculatePixelsToTileUnitsMatrix(p);else N=new Float32Array([P.pixelsToGLUnits[0],0,0,P.pixelsToGLUnits[1]]);const U={u_camera_to_center_distance:P.cameraToCenterDistance,u_matrix:_.translatePosMatrix(u.projMatrix,p,I.paint.get("circle-translate"),I.paint.get("circle-translate-anchor")),u_device_pixel_ratio:h.exported.devicePixelRatio,u_extrude_scale:N,u_inv_rot_matrix:Qs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){U.u_inv_rot_matrix=v,U.u_merc_center=w,U.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],U.u_zoom_transition=h.globeToMercatorTransition(P.zoom);const z=w[0]*h.EXTENT,q=w[1]*h.EXTENT;U.u_up_dir=P.projection.upVector(new h.CanonicalTileID(0,0,0),z,q)}return U},wd=_=>{const u=[];return"map"===_.paint.get("circle-pitch-alignment")&&u.push("PITCH_WITH_MAP"),"map"===_.paint.get("circle-pitch-scale")&&u.push("SCALE_WITH_MAP"),u},Ed=(_,u,p,v)=>{const w=h.EXTENT/p.tileSize;return{u_matrix:_,u_camera_to_center_distance:u.getCameraToCenterDistance(v),u_extrude_scale:[u.pixelsToGLUnits[0]/w,u.pixelsToGLUnits[1]/w]}},Cd=(_,u,p=1)=>({u_matrix:_,u_color:u,u_overlay:0,u_overlay_scale:p}),dh=h.create(),Id=(_,u,p,v,w,I,P)=>{const k=_.transform,N="globe"===k.projection.name,U=N?h.globePixelsToTileUnits(k.zoom,u.canonical)*k._pixelsPerMercatorPixel:Hn(p,1,I),z={u_matrix:u.projMatrix,u_extrude_scale:U,u_intensity:P,u_inv_rot_matrix:dh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){z.u_inv_rot_matrix=v,z.u_merc_center=w,z.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],z.u_zoom_transition=h.globeToMercatorTransition(k.zoom);const q=w[0]*h.EXTENT,le=w[1]*h.EXTENT;z.u_up_dir=k.projection.upVector(new h.CanonicalTileID(0,0,0),q,le)}return z},hh=(_,u,p,v,w,I,P)=>{const k=_.transform,N=k.calculatePixelsToTileUnitsMatrix(u);return{u_matrix:fh(_,u,p,v),u_pixels_to_tile_units:N,u_device_pixel_ratio:I,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:w,u_texsize:Wi(p)?u.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:pc(u,_.transform),u_alpha_discard_threshold:0,u_trim_offset:P}},Ou=(_,u,p,v,w)=>{const I=_.transform;return{u_matrix:fh(_,u,p,v),u_texsize:u.imageAtlasTexture.size,u_pixels_to_tile_units:I.calculatePixelsToTileUnitsMatrix(u),u_device_pixel_ratio:w,u_image:0,u_tile_units_to_pixels:pc(u,I),u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function pc(_,u){return 1/Hn(_,1,u.tileZoom)}function fh(_,u,p,v){return _.translatePosMatrix(v||u.tileID.projMatrix,u,p.paint.get("line-translate"),p.paint.get("line-translate-anchor"))}function Wi(_){const u=_.paint.get("line-dasharray").value;return u.value||"constant"!==u.kind}const Lf=(_,u,p,v,w,I)=>{return{u_matrix:_,u_tl_parent:u,u_scale_parent:p,u_fade_t:v.mix,u_opacity:v.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(k=w.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(P=w.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:Aa(w.paint.get("raster-hue-rotate")),u_perspective_transform:I};var P,k};function Aa(_){_*=Math.PI/180;const u=Math.sin(_),p=Math.cos(_);return[(2*p+1)/3,(-Math.sqrt(3)*u-p+1)/3,(Math.sqrt(3)*u-p+1)/3]}const ph=h.create(),qi=(_,u,p,v,w,I,P,k,N,U,z,q,le,ye,be,ve)=>{const we=w.transform,K={u_is_size_zoom_constant:+("constant"===_||"source"===_),u_is_size_feature_constant:+("constant"===_||"camera"===_),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:we.cameraToCenterDistance,u_rotate_symbol:+p,u_aspect_ratio:we.width/we.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:I,u_label_plane_matrix:P,u_coord_matrix:k,u_is_text:+N,u_pitch_with_map:+v,u_texsize:U,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ph,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:ph,u_up_vector:[0,-1,0]};return"globe"===ve.name&&(K.u_tile_id=[z.canonical.x,z.canonical.y,1<<z.canonical.z],K.u_zoom_transition=q,K.u_inv_rot_matrix=ye,K.u_merc_center=le,K.u_camera_forward=we._camera.forward(),K.u_ecef_origin=h.globeECEFOrigin(we.globeMatrix,z.toUnwrapped()),K.u_tile_matrix=Float32Array.from(we.globeMatrix),K.u_up_vector=be),K},mc=(_,u,p,v,w,I,P,k,N,U,z,q,le,ye,be,ve,we)=>h.extend(qi(_,u,p,v,w,I,P,k,N,U,q,le,ye,be,ve,we),{u_gamma_scale:v?w.transform.cameraToCenterDistance*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:h.exported.devicePixelRatio,u_is_halo:+z}),Td=(_,u,p,v,w,I,P,k,N,U,z,q,le,ye,be,ve)=>h.extend(mc(_,u,p,v,w,I,P,k,!0,N,!0,z,q,le,ye,be,ve),{u_texsize_icon:U,u_texture_icon:1}),On=(_,u,p)=>({u_matrix:_,u_opacity:u,u_color:p}),ss=(_,u,p,v,w)=>h.extend(function(I,P,k){const N=P.imageManager.getPattern(I.toString()),{width:U,height:z}=P.imageManager.getPixelSize(),q=Math.pow(2,k.tileID.overscaledZ),le=k.tileSize*Math.pow(2,P.transform.tileZoom)/q,ye=le*(k.tileID.canonical.x+k.tileID.wrap*q),be=le*k.tileID.canonical.y;return{u_image:0,u_pattern_tl:N.tl,u_pattern_br:N.br,u_texsize:[U,z],u_pattern_size:N.displaySize,u_tile_units_to_pixels:1/Hn(k,1,P.transform.tileZoom),u_pixel_coord_upper:[ye>>16,be>>16],u_pixel_coord_lower:[65535&ye,65535&be]}}(v,p,w),{u_matrix:_,u_opacity:u}),nr={fillExtrusion:_=>({u_matrix:new h.UniformMatrix4f(_),u_lightpos:new h.Uniform3f(_),u_lightintensity:new h.Uniform1f(_),u_lightcolor:new h.Uniform3f(_),u_vertical_gradient:new h.Uniform1f(_),u_opacity:new h.Uniform1f(_),u_edge_radius:new h.Uniform1f(_),u_ao:new h.Uniform2f(_),u_tile_id:new h.Uniform3f(_),u_zoom_transition:new h.Uniform1f(_),u_inv_rot_matrix:new h.UniformMatrix4f(_),u_merc_center:new h.Uniform2f(_),u_up_dir:new h.Uniform3f(_),u_height_lift:new h.Uniform1f(_)}),fillExtrusionPattern:_=>({u_matrix:new h.UniformMatrix4f(_),u_lightpos:new h.Uniform3f(_),u_lightintensity:new h.Uniform1f(_),u_lightcolor:new h.Uniform3f(_),u_vertical_gradient:new h.Uniform1f(_),u_height_factor:new h.Uniform1f(_),u_edge_radius:new h.Uniform1f(_),u_ao:new h.Uniform2f(_),u_tile_id:new h.Uniform3f(_),u_zoom_transition:new h.Uniform1f(_),u_inv_rot_matrix:new h.UniformMatrix4f(_),u_merc_center:new h.Uniform2f(_),u_up_dir:new h.Uniform3f(_),u_height_lift:new h.Uniform1f(_),u_image:new h.Uniform1i(_),u_texsize:new h.Uniform2f(_),u_pixel_coord_upper:new h.Uniform2f(_),u_pixel_coord_lower:new h.Uniform2f(_),u_tile_units_to_pixels:new h.Uniform1f(_),u_opacity:new h.Uniform1f(_)}),fill:_=>({u_matrix:new h.UniformMatrix4f(_)}),fillPattern:_=>({u_matrix:new h.UniformMatrix4f(_),u_image:new h.Uniform1i(_),u_texsize:new h.Uniform2f(_),u_pixel_coord_upper:new h.Uniform2f(_),u_pixel_coord_lower:new h.Uniform2f(_),u_tile_units_to_pixels:new h.Uniform1f(_)}),fillOutline:_=>({u_matrix:new h.UniformMatrix4f(_),u_world:new h.Uniform2f(_)}),fillOutlinePattern:_=>({u_matrix:new h.UniformMatrix4f(_),u_world:new h.Uniform2f(_),u_image:new h.Uniform1i(_),u_texsize:new h.Uniform2f(_),u_pixel_coord_upper:new h.Uniform2f(_),u_pixel_coord_lower:new h.Uniform2f(_),u_tile_units_to_pixels:new h.Uniform1f(_)}),circle:_=>({u_camera_to_center_distance:new h.Uniform1f(_),u_extrude_scale:new h.UniformMatrix2f(_),u_device_pixel_ratio:new h.Uniform1f(_),u_matrix:new h.UniformMatrix4f(_),u_inv_rot_matrix:new h.UniformMatrix4f(_),u_merc_center:new h.Uniform2f(_),u_tile_id:new h.Uniform3f(_),u_zoom_transition:new h.Uniform1f(_),u_up_dir:new h.Uniform3f(_)}),collisionBox:_=>({u_matrix:new h.UniformMatrix4f(_),u_camera_to_center_distance:new h.Uniform1f(_),u_extrude_scale:new h.Uniform2f(_)}),collisionCircle:_=>({u_matrix:new h.UniformMatrix4f(_),u_inv_matrix:new h.UniformMatrix4f(_),u_camera_to_center_distance:new h.Uniform1f(_),u_viewport_size:new h.Uniform2f(_)}),debug:_=>({u_color:new h.UniformColor(_),u_matrix:new h.UniformMatrix4f(_),u_overlay:new h.Uniform1i(_),u_overlay_scale:new h.Uniform1f(_)}),clippingMask:_=>({u_matrix:new h.UniformMatrix4f(_)}),heatmap:_=>({u_extrude_scale:new h.Uniform1f(_),u_intensity:new h.Uniform1f(_),u_matrix:new h.UniformMatrix4f(_),u_inv_rot_matrix:new h.UniformMatrix4f(_),u_merc_center:new h.Uniform2f(_),u_tile_id:new h.Uniform3f(_),u_zoom_transition:new h.Uniform1f(_),u_up_dir:new h.Uniform3f(_)}),heatmapTexture:_=>({u_image:new h.Uniform1i(_),u_color_ramp:new h.Uniform1i(_),u_opacity:new h.Uniform1f(_)}),hillshade:_=>({u_matrix:new h.UniformMatrix4f(_),u_image:new h.Uniform1i(_),u_latrange:new h.Uniform2f(_),u_light:new h.Uniform2f(_),u_shadow:new h.UniformColor(_),u_highlight:new h.UniformColor(_),u_accent:new h.UniformColor(_)}),hillshadePrepare:_=>({u_matrix:new h.UniformMatrix4f(_),u_image:new h.Uniform1i(_),u_dimension:new h.Uniform2f(_),u_zoom:new h.Uniform1f(_),u_unpack:new h.Uniform4f(_)}),line:_=>({u_matrix:new h.UniformMatrix4f(_),u_pixels_to_tile_units:new h.UniformMatrix2f(_),u_device_pixel_ratio:new h.Uniform1f(_),u_units_to_pixels:new h.Uniform2f(_),u_dash_image:new h.Uniform1i(_),u_gradient_image:new h.Uniform1i(_),u_image_height:new h.Uniform1f(_),u_texsize:new h.Uniform2f(_),u_tile_units_to_pixels:new h.Uniform1f(_),u_alpha_discard_threshold:new h.Uniform1f(_),u_trim_offset:new h.Uniform2f(_)}),linePattern:_=>({u_matrix:new h.UniformMatrix4f(_),u_texsize:new h.Uniform2f(_),u_pixels_to_tile_units:new h.UniformMatrix2f(_),u_device_pixel_ratio:new h.Uniform1f(_),u_image:new h.Uniform1i(_),u_units_to_pixels:new h.Uniform2f(_),u_tile_units_to_pixels:new h.Uniform1f(_),u_alpha_discard_threshold:new h.Uniform1f(_)}),raster:_=>({u_matrix:new h.UniformMatrix4f(_),u_tl_parent:new h.Uniform2f(_),u_scale_parent:new h.Uniform1f(_),u_fade_t:new h.Uniform1f(_),u_opacity:new h.Uniform1f(_),u_image0:new h.Uniform1i(_),u_image1:new h.Uniform1i(_),u_brightness_low:new h.Uniform1f(_),u_brightness_high:new h.Uniform1f(_),u_saturation_factor:new h.Uniform1f(_),u_contrast_factor:new h.Uniform1f(_),u_spin_weights:new h.Uniform3f(_),u_perspective_transform:new h.Uniform2f(_)}),symbolIcon:_=>({u_is_size_zoom_constant:new h.Uniform1i(_),u_is_size_feature_constant:new h.Uniform1i(_),u_size_t:new h.Uniform1f(_),u_size:new h.Uniform1f(_),u_camera_to_center_distance:new h.Uniform1f(_),u_rotate_symbol:new h.Uniform1i(_),u_aspect_ratio:new h.Uniform1f(_),u_fade_change:new h.Uniform1f(_),u_matrix:new h.UniformMatrix4f(_),u_label_plane_matrix:new h.UniformMatrix4f(_),u_coord_matrix:new h.UniformMatrix4f(_),u_is_text:new h.Uniform1i(_),u_pitch_with_map:new h.Uniform1i(_),u_texsize:new h.Uniform2f(_),u_tile_id:new h.Uniform3f(_),u_zoom_transition:new h.Uniform1f(_),u_inv_rot_matrix:new h.UniformMatrix4f(_),u_merc_center:new h.Uniform2f(_),u_camera_forward:new h.Uniform3f(_),u_tile_matrix:new h.UniformMatrix4f(_),u_up_vector:new h.Uniform3f(_),u_ecef_origin:new h.Uniform3f(_),u_texture:new h.Uniform1i(_)}),symbolSDF:_=>({u_is_size_zoom_constant:new h.Uniform1i(_),u_is_size_feature_constant:new h.Uniform1i(_),u_size_t:new h.Uniform1f(_),u_size:new h.Uniform1f(_),u_camera_to_center_distance:new h.Uniform1f(_),u_rotate_symbol:new h.Uniform1i(_),u_aspect_ratio:new h.Uniform1f(_),u_fade_change:new h.Uniform1f(_),u_matrix:new h.UniformMatrix4f(_),u_label_plane_matrix:new h.UniformMatrix4f(_),u_coord_matrix:new h.UniformMatrix4f(_),u_is_text:new h.Uniform1i(_),u_pitch_with_map:new h.Uniform1i(_),u_texsize:new h.Uniform2f(_),u_texture:new h.Uniform1i(_),u_gamma_scale:new h.Uniform1f(_),u_device_pixel_ratio:new h.Uniform1f(_),u_tile_id:new h.Uniform3f(_),u_zoom_transition:new h.Uniform1f(_),u_inv_rot_matrix:new h.UniformMatrix4f(_),u_merc_center:new h.Uniform2f(_),u_camera_forward:new h.Uniform3f(_),u_tile_matrix:new h.UniformMatrix4f(_),u_up_vector:new h.Uniform3f(_),u_ecef_origin:new h.Uniform3f(_),u_is_halo:new h.Uniform1i(_)}),symbolTextAndIcon:_=>({u_is_size_zoom_constant:new h.Uniform1i(_),u_is_size_feature_constant:new h.Uniform1i(_),u_size_t:new h.Uniform1f(_),u_size:new h.Uniform1f(_),u_camera_to_center_distance:new h.Uniform1f(_),u_rotate_symbol:new h.Uniform1i(_),u_aspect_ratio:new h.Uniform1f(_),u_fade_change:new h.Uniform1f(_),u_matrix:new h.UniformMatrix4f(_),u_label_plane_matrix:new h.UniformMatrix4f(_),u_coord_matrix:new h.UniformMatrix4f(_),u_is_text:new h.Uniform1i(_),u_pitch_with_map:new h.Uniform1i(_),u_texsize:new h.Uniform2f(_),u_texsize_icon:new h.Uniform2f(_),u_texture:new h.Uniform1i(_),u_texture_icon:new h.Uniform1i(_),u_gamma_scale:new h.Uniform1f(_),u_device_pixel_ratio:new h.Uniform1f(_),u_is_halo:new h.Uniform1i(_)}),background:_=>({u_matrix:new h.UniformMatrix4f(_),u_opacity:new h.Uniform1f(_),u_color:new h.UniformColor(_)}),backgroundPattern:_=>({u_matrix:new h.UniformMatrix4f(_),u_opacity:new h.Uniform1f(_),u_image:new h.Uniform1i(_),u_pattern_tl:new h.Uniform2f(_),u_pattern_br:new h.Uniform2f(_),u_texsize:new h.Uniform2f(_),u_pattern_size:new h.Uniform2f(_),u_pixel_coord_upper:new h.Uniform2f(_),u_pixel_coord_lower:new h.Uniform2f(_),u_tile_units_to_pixels:new h.Uniform1f(_)}),terrainRaster:Ds,terrainDepth:Ds,skybox:_=>({u_matrix:new h.UniformMatrix4f(_),u_sun_direction:new h.Uniform3f(_),u_cubemap:new h.Uniform1i(_),u_opacity:new h.Uniform1f(_),u_temporal_offset:new h.Uniform1f(_)}),skyboxGradient:_=>({u_matrix:new h.UniformMatrix4f(_),u_color_ramp:new h.Uniform1i(_),u_center_direction:new h.Uniform3f(_),u_radius:new h.Uniform1f(_),u_opacity:new h.Uniform1f(_),u_temporal_offset:new h.Uniform1f(_)}),skyboxCapture:_=>({u_matrix_3f:new h.UniformMatrix3f(_),u_sun_direction:new h.Uniform3f(_),u_sun_intensity:new h.Uniform1f(_),u_color_tint_r:new h.Uniform4f(_),u_color_tint_m:new h.Uniform4f(_),u_luminance:new h.Uniform1f(_)}),globeRaster:_=>({u_proj_matrix:new h.UniformMatrix4f(_),u_globe_matrix:new h.UniformMatrix4f(_),u_normalize_matrix:new h.UniformMatrix4f(_),u_merc_matrix:new h.UniformMatrix4f(_),u_zoom_transition:new h.Uniform1f(_),u_merc_center:new h.Uniform2f(_),u_image0:new h.Uniform1i(_),u_grid_matrix:new h.UniformMatrix3f(_),u_skirt_height:new h.Uniform1f(_),u_frustum_tl:new h.Uniform3f(_),u_frustum_tr:new h.Uniform3f(_),u_frustum_br:new h.Uniform3f(_),u_frustum_bl:new h.Uniform3f(_),u_globe_pos:new h.Uniform3f(_),u_globe_radius:new h.Uniform1f(_),u_viewport:new h.Uniform2f(_)}),globeAtmosphere:_=>({u_frustum_tl:new h.Uniform3f(_),u_frustum_tr:new h.Uniform3f(_),u_frustum_br:new h.Uniform3f(_),u_frustum_bl:new h.Uniform3f(_),u_horizon:new h.Uniform1f(_),u_transition:new h.Uniform1f(_),u_fadeout_range:new h.Uniform1f(_),u_color:new h.Uniform4f(_),u_high_color:new h.Uniform4f(_),u_space_color:new h.Uniform4f(_),u_star_intensity:new h.Uniform1f(_),u_star_density:new h.Uniform1f(_),u_star_size:new h.Uniform1f(_),u_temporal_offset:new h.Uniform1f(_),u_horizon_angle:new h.Uniform1f(_),u_rotation_matrix:new h.UniformMatrix4f(_)})};let Co;function qo(_,u,p,v,w,I,P){const k=_.context,N=k.gl,U=_.transform,z=_.useProgram("collisionBox"),q=[];let le=0,ye=0;for(let Se=0;Se<v.length;Se++){const Ge=v[Se],Ye=u.getTile(Ge),Xe=Ye.getBucket(p);if(!Xe)continue;const ct=qa(Ge,Xe,U);let st=ct;0===w[0]&&0===w[1]||(st=_.translatePosMatrix(ct,Ye,w,I));const Ct=P?Xe.textCollisionBox:Xe.iconCollisionBox,rn=Xe.collisionCircleArray;if(rn.length>0){const _t=h.create(),zt=st;h.mul(_t,Xe.placementInvProjMatrix,U.glCoordMatrix),h.mul(_t,_t,Xe.placementViewportMatrix),q.push({circleArray:rn,circleOffset:ye,transform:zt,invTransform:_t,projection:Xe.getProjection()}),le+=rn.length/4,ye=le}Ct&&(_.terrain&&_.terrain.setupElevationDraw(Ye,z),z.draw(k,N.LINES,h.DepthMode.disabled,h.StencilMode.disabled,_.colorModeForRenderPass(),h.CullFaceMode.disabled,Ed(st,U,Ye,Xe.getProjection()),p.id,Ct.layoutVertexBuffer,Ct.indexBuffer,Ct.segments,null,U.zoom,null,[Ct.collisionVertexBuffer,Ct.collisionVertexBufferExt]))}if(!P||!q.length)return;const be=_.useProgram("collisionCircle"),ve=new h.StructArrayLayout2f1f2i16;ve.resize(4*le),ve._trim();let we=0;for(const Se of q)for(let Ge=0;Ge<Se.circleArray.length/4;Ge++){const Ye=4*Ge,Xe=Se.circleArray[Ye+0],ct=Se.circleArray[Ye+1],st=Se.circleArray[Ye+2],Ct=Se.circleArray[Ye+3];ve.emplace(we++,Xe,ct,st,Ct,0),ve.emplace(we++,Xe,ct,st,Ct,1),ve.emplace(we++,Xe,ct,st,Ct,2),ve.emplace(we++,Xe,ct,st,Ct,3)}(!Co||Co.length<2*le)&&(Co=function(Se){const Ge=2*Se,Ye=new h.StructArrayLayout3ui6;Ye.resize(Ge),Ye._trim();for(let Xe=0;Xe<Ge;Xe++){const ct=6*Xe;Ye.uint16[ct+0]=4*Xe+0,Ye.uint16[ct+1]=4*Xe+1,Ye.uint16[ct+2]=4*Xe+2,Ye.uint16[ct+3]=4*Xe+2,Ye.uint16[ct+4]=4*Xe+3,Ye.uint16[ct+5]=4*Xe+0}return Ye}(le));const K=k.createIndexBuffer(Co,!0),de=k.createVertexBuffer(ve,h.collisionCircleLayout.members,!0);for(const Se of q){const Ge={u_matrix:Se.transform,u_inv_matrix:Se.invTransform,u_camera_to_center_distance:(Ae=U).getCameraToCenterDistance(Se.projection),u_viewport_size:[Ae.width,Ae.height]};be.draw(k,N.TRIANGLES,h.DepthMode.disabled,h.StencilMode.disabled,_.colorModeForRenderPass(),h.CullFaceMode.disabled,Ge,p.id,de,K,h.SegmentVector.simpleSegment(0,2*Se.circleOffset,Se.circleArray.length,Se.circleArray.length/2),null,U.zoom)}var Ae;de.destroy(),K.destroy()}const Ll=h.create();function $s({width:_,height:u,anchor:p,textOffset:v,textScale:w},I){const{horizontalAlign:P,verticalAlign:k}=h.getAnchorAlignment(p),N=-(P-.5)*_,U=-(k-.5)*u,z=h.evaluateVariableOffset(p,v);return new h.Point((N/w+z[0])*I,(U/w+z[1])*I)}function mh(_,u,p,v,w,I,P,k,N,U,z){const q=_.text.placedSymbolArray,le=_.text.dynamicLayoutVertexArray,ye=_.icon.dynamicLayoutVertexArray,be={},ve=_.getProjection(),we=Wt(k,ve,I),K=I.elevation,de=ve.upVectorScale(k.canonical,I.center.lat,I.worldSize).metersToTile;le.clear();for(let Ae=0;Ae<q.length;Ae++){const Se=q.get(Ae),{tileAnchorX:Ge,tileAnchorY:Ye,numGlyphs:Xe}=Se,ct=Se.hidden||!Se.crossTileID||_.allowVerticalPlacement&&!Se.placedOrientation?null:v[Se.crossTileID];if(ct){let st=0,Ct=0,rn=0;if(K){const Mt=K?K.getAtTileOffset(k,Ge,Ye):0,[Kn,pi,Ln]=ve.upVector(k.canonical,Ge,Ye);st=Mt*Kn*de,Ct=Mt*pi*de,rn=Mt*Ln*de}let[_t,zt,Dt,en]=Ki(Se.projectedAnchorX+st,Se.projectedAnchorY+Ct,Se.projectedAnchorZ+rn,p?we:P);const vt=Wp(I.getCameraToCenterDistance(ve),en);let Ut=w.evaluateSizeForFeature(_.textSizeData,U,Se)*vt/h.ONE_EM;p&&(Ut*=_.tilePixelRatio/N);const sn=$s(ct,Ut);p?(({x:_t,y:zt,z:Dt}=ve.projectTilePoint(Ge+sn.x,Ye+sn.y,k.canonical)),[_t,zt,Dt]=Ki(_t+st,zt+Ct,Dt+rn,P)):(u&&sn._rotate(-I.angle),_t+=sn.x,zt+=sn.y,Dt=0);const Zt=_.allowVerticalPlacement&&Se.placedOrientation===h.WritingMode.vertical?Math.PI/2:0;for(let Mt=0;Mt<Xe;Mt++)h.addDynamicAttributes(le,_t,zt,Dt,Zt);z&&Se.associatedIconIndex>=0&&(be[Se.associatedIconIndex]={x:_t,y:zt,z:Dt,angle:Zt})}else Da(Xe,le)}if(z){ye.clear();const Ae=_.icon.placedSymbolArray;for(let Se=0;Se<Ae.length;Se++){const Ge=Ae.get(Se),{numGlyphs:Ye}=Ge,Xe=be[Se];if(Ge.hidden||!Xe)Da(Ye,ye);else{const{x:ct,y:st,z:Ct,angle:rn}=Xe;for(let _t=0;_t<Ye;_t++)h.addDynamicAttributes(ye,ct,st,Ct,rn)}}_.icon.dynamicLayoutVertexBuffer.updateData(ye)}_.text.dynamicLayoutVertexBuffer.updateData(le)}function gh(_,u,p){return p.iconsInText&&u?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function qc(_,u,p,v,w,I,P,k,N,U,z,q){const le=_.context,ye=le.gl,be=_.transform,ve="map"===k,we="map"===N,K=ve&&"point"!==p.layout.get("symbol-placement"),de=ve&&!we&&!K,Ae=void 0!==p.layout.get("symbol-sort-key").constantOr(1);let Se=!1;const Ge=_.depthModeForSublayer(0,h.DepthMode.ReadOnly),Ye=[h.mercatorXfromLng(be.center.lng),h.mercatorYfromLat(be.center.lat)],Xe=p.layout.get("text-variable-anchor"),ct="globe"===be.projection.name,st=[],Ct=[0,-1,0];let rn=Ct;!ct&&!be.mercatorFromTransition||ve||(rn=function(_t){const zt=_t._camera.getWorldToCamera(_t.worldSize,1),Dt=h.multiply([],zt,_t.globeMatrix);h.invert(Dt,Dt);const en=[0,0,0],vt=[0,1,0,0];return h.transformMat4$1(vt,vt,Dt),en[0]=vt[0],en[1]=vt[1],en[2]=vt[2],h.normalize(en,en),en}(be));for(const _t of v){const zt=u.getTile(_t),Dt=zt.getBucket(p);if(!Dt||"mercator"===Dt.projection.name&&ct)continue;const en=w?Dt.text:Dt.icon;if(!en||Dt.fullyClipped||!en.segments.get().length)continue;const vt=en.programConfigurations.get(p.id),Ut=w||Dt.sdfIcons,sn=w?Dt.textSizeData:Dt.iconSizeData,Zt=we||0!==be.pitch,Mt=h.evaluateSizeForZoom(sn,be.zoom);let Kn,pi,Ln,oi,Ni=[0,0],Si=null;if(w)pi=zt.glyphAtlasTexture,Ln=ye.LINEAR,Kn=zt.glyphAtlasTexture.size,Dt.iconsInText&&(Ni=zt.imageAtlasTexture.size,Si=zt.imageAtlasTexture,oi=Zt||_.options.rotating||_.options.zooming||"composite"===sn.kind||"camera"===sn.kind?ye.LINEAR:ye.NEAREST);else{const no=1!==p.layout.get("icon-size").constantOr(0)||Dt.iconsNeedLinear;pi=zt.imageAtlasTexture,Ln=Ut||_.options.rotating||_.options.zooming||no||Zt?ye.LINEAR:ye.NEAREST,Kn=zt.imageAtlasTexture.size}const Bn="globe"===Dt.projection.name,mr=Bn?rn:Ct,br=Bn?h.globeToMercatorTransition(be.zoom):0,wr=Wt(_t,Dt.getProjection(),be),Er=be.calculatePixelsToTileUnitsMatrix(zt),Ps=Nt(wr,zt.tileID.canonical,we,ve,be,Dt.getProjection(),Er),qt=_.terrain&&we&&K?h.invert(h.create(),Ps):Ll,Mi=No(wr,zt.tileID.canonical,we,ve,be,Dt.getProjection(),Er),_i=Xe&&Dt.hasTextData(),Gn="none"!==p.layout.get("icon-text-fit")&&_i&&Dt.hasIconData();if(K){const no=be.elevation,ks=no?no.getAtTileOffsetFunc(_t,be.center.lat,be.worldSize,Dt.getProjection()):null,Hl=Po(wr,zt.tileID.canonical,we,ve,be,Dt.getProjection(),Er);ih(Dt,wr,_,w,Hl,Mi,we,U,ks,_t)}const Ti=K||w&&Xe||Gn,sr=_.translatePosMatrix(wr,zt,I,P),to=Ti?Ll:Ps,Kr=_.translatePosMatrix(Mi,zt,I,P,!0),Mr=Dt.getProjection().createInversionMatrix(be,_t.canonical),hs=[];_.terrainRenderModeElevated()&&we&&hs.push("PITCH_WITH_MAP_TERRAIN"),Bn&&hs.push("PROJECTION_GLOBE_VIEW"),Ti&&hs.push("PROJECTED_POS_ON_VIEWPORT");const Hu=Ut&&0!==p.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1);let wc;wc=Ut?Dt.iconsInText?Td(sn.kind,Mt,de,we,_,sr,to,Kr,Kn,Ni,_t,br,Ye,Mr,mr,Dt.getProjection()):mc(sn.kind,Mt,de,we,_,sr,to,Kr,w,Kn,!0,_t,br,Ye,Mr,mr,Dt.getProjection()):qi(sn.kind,Mt,de,we,_,sr,to,Kr,w,Kn,_t,br,Ye,Mr,mr,Dt.getProjection());const Qc={program:_.useProgram(gh(Ut,w,Dt),vt,hs),buffers:en,uniformValues:wc,atlasTexture:pi,atlasTextureIcon:Si,atlasInterpolation:Ln,atlasInterpolationIcon:oi,isSDF:Ut,hasHalo:Hu,tile:zt,labelPlaneMatrixInv:qt};if(Ae&&Dt.canOverlap){Se=!0;const no=en.segments.get();for(const ks of no)st.push({segments:new h.SegmentVector([ks]),sortKey:ks.sortKey,state:Qc})}else st.push({segments:en.segments,sortKey:0,state:Qc})}Se&&st.sort((_t,zt)=>_t.sortKey-zt.sortKey);for(const _t of st){const zt=_t.state;if(_.terrain&&_.terrain.setupElevationDraw(zt.tile,zt.program,{useDepthForOcclusion:!ct,labelPlaneMatrixInv:zt.labelPlaneMatrixInv}),le.activeTexture.set(ye.TEXTURE0),zt.atlasTexture.bind(zt.atlasInterpolation,ye.CLAMP_TO_EDGE),zt.atlasTextureIcon&&(le.activeTexture.set(ye.TEXTURE1),zt.atlasTextureIcon&&zt.atlasTextureIcon.bind(zt.atlasInterpolationIcon,ye.CLAMP_TO_EDGE)),zt.isSDF){const Dt=zt.uniformValues;zt.hasHalo&&(Dt.u_is_halo=1,Fu(zt.buffers,_t.segments,p,_,zt.program,Ge,z,q,Dt)),Dt.u_is_halo=0}Fu(zt.buffers,_t.segments,p,_,zt.program,Ge,z,q,zt.uniformValues)}}function Fu(_,u,p,v,w,I,P,k,N){const U=v.context,z=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.globeExtVertexBuffer];w.draw(U,U.gl.TRIANGLES,I,P,k,h.CullFaceMode.disabled,N,p.id,_.layoutVertexBuffer,_.indexBuffer,u,p.paint,v.transform.zoom,_.programConfigurations.get(p.id),z)}function _h(_,u,p,v,w,I,P){const k=_.context.gl,N=p.paint.get("fill-pattern"),U=N&&N.constantOr(1);let z,q,le,ye,be;P?(q=U&&!p.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",z=k.LINES):(q=U?"fillPattern":"fill",z=k.TRIANGLES);for(const ve of v){const we=u.getTile(ve);if(U&&!we.patternsLoaded())continue;const K=we.getBucket(p);if(!K)continue;_.prepareDrawTile();const de=K.programConfigurations.get(p.id),Ae=_.useProgram(q,de);U&&(_.context.activeTexture.set(k.TEXTURE0),we.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),de.updatePaintBuffers());const Se=N.constantOr(null);if(Se&&we.imageAtlas){const Ye=we.imageAtlas.patternPositions[Se.toString()];Ye&&de.setConstantPatternPositions(Ye)}const Ge=_.translatePosMatrix(ve.projMatrix,we,p.paint.get("fill-translate"),p.paint.get("fill-translate-anchor"));if(P){ye=K.indexBuffer2,be=K.segments2;const Ye=_.terrain&&_.terrain.renderingToTexture?_.terrain.drapeBufferSize:[k.drawingBufferWidth,k.drawingBufferHeight];le="fillOutlinePattern"===q&&U?Ff(Ge,_,we,Ye):Of(Ge,Ye)}else ye=K.indexBuffer,be=K.segments,le=U?Ru(Ge,_,we):Wc(Ge);_.prepareDrawProgram(_.context,Ae,ve.toUnwrapped()),Ae.draw(_.context,z,w,_.stencilModeForClipping(ve),I,h.CullFaceMode.disabled,le,p.id,K.layoutVertexBuffer,ye,be,p.paint,_.transform.zoom,de)}}function eo(_,u,p,v,w,I,P){const k=_.context,N=k.gl,U=_.transform,z=p.paint.get("fill-extrusion-pattern"),q=z.constantOr(1),le=p.paint.get("fill-extrusion-opacity"),ye=[p.paint.get("fill-extrusion-ambient-occlusion-intensity"),p.paint.get("fill-extrusion-ambient-occlusion-radius")],be=p.layout.get("fill-extrusion-edge-radius"),ve=be>0&&!p.paint.get("fill-extrusion-rounded-roof"),we=ve?0:be,K="globe"===U.projection.name?h.fillExtrusionHeightLift():0,de="globe"===U.projection.name,Ae=de?h.globeToMercatorTransition(U.zoom):0,Se=[h.mercatorXfromLng(U.center.lng),h.mercatorYfromLat(U.center.lat)],Ge=[];de&&Ge.push("PROJECTION_GLOBE_VIEW"),ye[0]>0&&Ge.push("FAUX_AO"),ve&&Ge.push("ZERO_ROOF_RADIUS");for(const Ye of v){const Xe=u.getTile(Ye),ct=Xe.getBucket(p);if(!ct||ct.projection.name!==U.projection.name)continue;const st=ct.programConfigurations.get(p.id),Ct=_.useProgram(q?"fillExtrusionPattern":"fillExtrusion",st,Ge);if(_.terrain){const Ut=_.terrain;if(_.style.terrainSetForDrapingOnly())Ut.setupElevationDraw(Xe,Ct,{useMeterToDem:!0});else{if(!ct.enableTerrain)continue;if(Ut.setupElevationDraw(Xe,Ct,{useMeterToDem:!0}),Nn(k,u,Ye,ct,p,Ut),!ct.centroidVertexBuffer){const sn=Ct.attributes.a_centroid_pos;void 0!==sn&&N.vertexAttrib2f(sn,0,0)}}}q&&(_.context.activeTexture.set(N.TEXTURE0),Xe.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),st.updatePaintBuffers());const rn=z.constantOr(null);if(rn&&Xe.imageAtlas){const Ut=Xe.imageAtlas.patternPositions[rn.toString()];Ut&&st.setConstantPatternPositions(Ut)}const _t=_.translatePosMatrix(Ye.projMatrix,Xe,p.paint.get("fill-extrusion-translate"),p.paint.get("fill-extrusion-translate-anchor")),zt=U.projection.createInversionMatrix(U,Ye.canonical),Dt=p.paint.get("fill-extrusion-vertical-gradient"),en=q?uh(_t,_,Dt,le,ye,we,Ye,Xe,K,Ae,Se,zt):xd(_t,_,Dt,le,ye,we,Ye,K,Ae,Se,zt);_.prepareDrawProgram(k,Ct,Ye.toUnwrapped());const vt=[];_.terrain&&vt.push(ct.centroidVertexBuffer),de&&vt.push(ct.layoutVertexExtBuffer),Ct.draw(k,k.gl.TRIANGLES,w,I,P,h.CullFaceMode.backCCW,en,p.id,ct.layoutVertexBuffer,ct.indexBuffer,ct.segments,p.paint,_.transform.zoom,st,vt)}}function Nn(_,u,p,v,w,I){const P=[K=>{let de=K.canonical.x-1,Ae=K.wrap;return de<0&&(de=(1<<K.canonical.z)-1,Ae--),new h.OverscaledTileID(K.overscaledZ,Ae,K.canonical.z,de,K.canonical.y)},K=>{let de=K.canonical.x+1,Ae=K.wrap;return de===1<<K.canonical.z&&(de=0,Ae++),new h.OverscaledTileID(K.overscaledZ,Ae,K.canonical.z,de,K.canonical.y)},K=>new h.OverscaledTileID(K.overscaledZ,K.wrap,K.canonical.z,K.canonical.x,(0===K.canonical.y?1<<K.canonical.z:K.canonical.y)-1),K=>new h.OverscaledTileID(K.overscaledZ,K.wrap,K.canonical.z,K.canonical.x,K.canonical.y===(1<<K.canonical.z)-1?0:K.canonical.y+1)],k=K=>{const de=u.getSource().minzoom,Ae=Ge=>{const Ye=u.getTileByID(Ge);if(Ye&&Ye.hasData())return Ye.getBucket(w)},Se=[0,-1,1];for(const Ge of Se){if(K.overscaledZ+Ge<de)continue;const Ye=Ae(K.calculateScaledKey(K.overscaledZ+Ge));if(Ye)return Ye}},N=[0,0,0],U=(K,de)=>(N[0]=Math.min(K.min.y,de.min.y),N[1]=Math.max(K.max.y,de.max.y),N[2]=h.EXTENT-de.min.x>K.max.x?de.min.x-h.EXTENT:K.max.x,N),z=(K,de)=>(N[0]=Math.min(K.min.x,de.min.x),N[1]=Math.max(K.max.x,de.max.x),N[2]=h.EXTENT-de.min.y>K.max.y?de.min.y-h.EXTENT:K.max.y,N),q=[(K,de)=>U(K,de),(K,de)=>U(de,K),(K,de)=>z(K,de),(K,de)=>z(de,K)],le=new h.Point(0,0);let ye,be,ve;const we=(K,de,Ae,Se,Ge)=>{const Ye=[[Se?Ae:K,Se?K:Ae,0],[Se?Ae:de,Se?de:Ae,0]],Xe=Ge<0?h.EXTENT+Ge:Ge,ct=[Se?Xe:(K+de)/2,Se?(K+de)/2:Xe,0];return 0===Ae&&Ge<0||0!==Ae&&Ge>0?I.getForTilePoints(ve,[ct],!0,be):Ye.push(ct),I.getForTilePoints(p,Ye,!0,ye),Math.max(Ye[0][2],Ye[1][2],ct[2])/I.exaggeration()};for(let K=0;K<4;K++){const de=(K<2?1:5)-K,Ae=v.borders[K];if(0===Ae.length)continue;const Se=ve=P[K](p),Ge=k(Se);if(!(Ge&&Ge instanceof h.FillExtrusionBucket&&Ge.enableTerrain)||v.borderDoneWithNeighborZ[K]===Ge.canonical.z&&Ge.borderDoneWithNeighborZ[de]===v.canonical.z||(be=I.findDEMTileFor(Se),!be||!be.dem))continue;if(!ye){const st=I.findDEMTileFor(p);if(!st||!st.dem)return;ye=st}const Ye=Ge.borders[de];let Xe=0;const ct=Ge.borderDoneWithNeighborZ[de]!==v.canonical.z;if(v.canonical.z===Ge.canonical.z){for(let st=0;st<Ae.length;st++){const Ct=v.featuresOnBorder[Ae[st]],rn=Ct.borders[K];let _t;for(;Xe<Ye.length&&(_t=Ge.featuresOnBorder[Ye[Xe]],!(_t.borders[de][1]>rn[0]+3));)ct&&Ge.encodeCentroid(void 0,_t,!1),Xe++;if(_t&&Xe<Ye.length){const zt=Xe;let Dt=0;for(;!(_t.borders[de][0]>rn[1]-3)&&(Dt++,++Xe!==Ye.length);)_t=Ge.featuresOnBorder[Ye[Xe]];if(_t=Ge.featuresOnBorder[Ye[zt]],Ct.intersectsCount()>1||_t.intersectsCount()>1||1!==Dt){1!==Dt&&(Xe=zt),v.encodeCentroid(void 0,Ct,!1),ct&&Ge.encodeCentroid(void 0,_t,!1);continue}const en=q[K](Ct,_t),vt=K%2?h.EXTENT-1:0;le.x=we(en[0],Math.min(h.EXTENT-1,en[1]),vt,K<2,en[2]),le.y=0,v.encodeCentroid(le,Ct,!1),ct&&Ge.encodeCentroid(le,_t,!1)}else v.encodeCentroid(void 0,Ct,!1)}v.borderDoneWithNeighborZ[K]=Ge.canonical.z,v.needsCentroidUpdate=!0,ct&&(Ge.borderDoneWithNeighborZ[de]=v.canonical.z,Ge.needsCentroidUpdate=!0)}else{for(const st of Ae)v.encodeCentroid(void 0,v.featuresOnBorder[st],!1);if(ct){for(const st of Ye)Ge.encodeCentroid(void 0,Ge.featuresOnBorder[st],!1);Ge.borderDoneWithNeighborZ[de]=v.canonical.z,Ge.needsCentroidUpdate=!0}v.borderDoneWithNeighborZ[K]=Ge.canonical.z,v.needsCentroidUpdate=!0}}(v.needsCentroidUpdate||!v.centroidVertexBuffer&&0!==v.centroidVertexArray.length)&&v.uploadCentroid(_)}const Ci=new h.Color(1,0,0,1),Zr=new h.Color(0,1,0,1),el=new h.Color(0,0,1,1),Dd=new h.Color(1,0,1,1),as=new h.Color(0,1,1,1);function Lu(_,u,p){const v=_.context,w=_.transform,I=v.gl,P="globe"===w.projection.name,k=P?["PROJECTION_GLOBE_VIEW"]:null;let N=p.projMatrix;if(P&&h.globeToMercatorTransition(w.zoom)>0){const Ct=h.transitionTileAABBinECEF(p.canonical,w),rn=h.globeDenormalizeECEF(Ct);N=h.multiply(new Float32Array(16),w.globeMatrix,rn),h.multiply(N,w.projMatrix,N)}const U=_.useProgram("debug",null,k),z=u.getTileByID(p.key);_.terrain&&_.terrain.setupElevationDraw(z,U);const q=h.DepthMode.disabled,le=h.StencilMode.disabled,ye=_.colorModeForRenderPass();v.activeTexture.set(I.TEXTURE0),_.emptyTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),P?z._makeGlobeTileDebugBuffers(_.context,w):z._makeDebugTileBoundsBuffers(_.context,w.projection);const ve=z._tileDebugBuffer||_.debugBuffer,we=z._tileDebugIndexBuffer||_.debugIndexBuffer,K=z._tileDebugSegments||_.debugSegments;U.draw(v,I.LINE_STRIP,q,le,ye,h.CullFaceMode.disabled,Cd(N,h.Color.red),"$debug",ve,we,K,null,null,null,[z._globeTileDebugBorderBuffer]);const de=z.latestRawTileData,Ae=Math.floor((de&&de.byteLength||0)/1024),Se=u.getTile(p).tileSize,Ge=512/Math.min(Se,512)*(p.overscaledZ/w.zoom)*.5;let Ye=p.canonical.toString();p.overscaledZ!==p.canonical.z&&(Ye+=` => ${p.overscaledZ}`),Ye+=` ${Ae}kb`,function(Ct,rn){Ct.initDebugOverlayCanvas();const _t=Ct.debugOverlayCanvas,zt=Ct.context.gl,Dt=Ct.debugOverlayCanvas.getContext("2d");Dt.clearRect(0,0,_t.width,_t.height),Dt.shadowColor="white",Dt.shadowBlur=2,Dt.lineWidth=1.5,Dt.strokeStyle="white",Dt.textBaseline="top",Dt.font="bold 36px Open Sans, sans-serif",Dt.fillText(rn,5,5),Dt.strokeText(rn,5,5),Ct.debugOverlayTexture.update(_t),Ct.debugOverlayTexture.bind(zt.LINEAR,zt.CLAMP_TO_EDGE)}(_,Ye);const Xe=z._tileDebugTextBuffer||_.debugBuffer,ct=z._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,st=z._tileDebugTextSegments||_.debugSegments;U.draw(v,I.TRIANGLES,q,le,h.ColorMode.alphaBlended,h.CullFaceMode.disabled,Cd(N,h.Color.transparent,Ge),"$debug",Xe,ct,st,null,null,null,[z._globeTileDebugTextBuffer])}function Io(_,u,p,v){tl(_,0,u+p/2,_.transform.width,p,v)}function pa(_,u,p,v){tl(_,u-p/2,0,p,_.transform.height,v)}function tl(_,u,p,v,w,I){const P=_.context,k=P.gl;k.enable(k.SCISSOR_TEST),k.scissor(u*h.exported.devicePixelRatio,p*h.exported.devicePixelRatio,v*h.exported.devicePixelRatio,w*h.exported.devicePixelRatio),P.clear({color:I}),k.disable(k.SCISSOR_TEST)}const Ii=h.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Nu}=Ii;function Sa(_,u,p,v){_.emplaceBack(u,p,v)}class Nl{constructor(u){this.vertexArray=new h.StructArrayLayout3f12,this.indices=new h.StructArrayLayout3ui6,Sa(this.vertexArray,-1,-1,1),Sa(this.vertexArray,1,-1,1),Sa(this.vertexArray,-1,1,1),Sa(this.vertexArray,1,1,1),Sa(this.vertexArray,-1,-1,-1),Sa(this.vertexArray,1,-1,-1),Sa(this.vertexArray,-1,1,-1),Sa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=u.createVertexBuffer(this.vertexArray,Nu),this.indexBuffer=u.createIndexBuffer(this.indices),this.segment=h.SegmentVector.simpleSegment(0,0,36,12)}}function hr(_,u,p,v,w,I){const P=_.gl,k=u.paint.get("sky-atmosphere-color"),N=u.paint.get("sky-atmosphere-halo-color"),U=u.paint.get("sky-atmosphere-sun-intensity"),z={u_matrix_3f:h.fromMat4(h.create$1(),v),u_sun_direction:w,u_sun_intensity:U,u_color_tint_r:[(be=k).r,be.g,be.b,be.a],u_color_tint_m:[(ve=N).r,ve.g,ve.b,ve.a],u_luminance:5e-5};var be,ve;P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+I,u.skyboxTexture,0),p.draw(_,P.TRIANGLES,h.DepthMode.disabled,h.StencilMode.disabled,h.ColorMode.unblended,h.CullFaceMode.frontCW,z,"skyboxCapture",u.skyboxGeometry.vertexBuffer,u.skyboxGeometry.indexBuffer,u.skyboxGeometry.segment)}const Bl=h.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Vl{constructor(u){const p=new h.StructArrayLayout5f20;p.emplaceBack(-1,1,1,0,0),p.emplaceBack(1,1,1,1,0),p.emplaceBack(1,-1,1,1,1),p.emplaceBack(-1,-1,1,0,1);const v=new h.StructArrayLayout3ui6;v.emplaceBack(0,1,2),v.emplaceBack(2,3,0),this.vertexBuffer=u.createVertexBuffer(p,Bl.members),this.indexBuffer=u.createIndexBuffer(v),this.segments=h.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ss={symbol:function(_,u,p,v,w){if("translucent"!==_.renderPass)return;const I=h.StencilMode.disabled,P=_.colorModeForRenderPass();p.layout.get("text-variable-anchor")&&function(k,N,U,z,q,le,ye){const be=N.transform,ve="map"===q,we="map"===le;for(const K of k){const de=z.getTile(K),Ae=de.getBucket(U);if(!Ae||!Ae.text||!Ae.text.segments.get().length)continue;const Se=h.evaluateSizeForZoom(Ae.textSizeData,be.zoom),Ge=Wt(K,Ae.getProjection(),be),Ye=be.calculatePixelsToTileUnitsMatrix(de),Xe=Nt(Ge,de.tileID.canonical,we,ve,be,Ae.getProjection(),Ye),ct="none"!==U.layout.get("icon-text-fit")&&Ae.hasIconData();if(Se){const st=Math.pow(2,be.zoom-de.tileID.overscaledZ);mh(Ae,ve,we,ye,h.symbolSize,be,Xe,K,st,Se,ct)}}}(v,_,p,u,p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),w),0!==p.paint.get("icon-opacity").constantOr(1)&&qc(_,u,p,v,!1,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),p.layout.get("icon-rotation-alignment"),p.layout.get("icon-pitch-alignment"),p.layout.get("icon-keep-upright"),I,P),0!==p.paint.get("text-opacity").constantOr(1)&&qc(_,u,p,v,!0,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),p.layout.get("text-rotation-alignment"),p.layout.get("text-pitch-alignment"),p.layout.get("text-keep-upright"),I,P),u.map.showCollisionBoxes&&(qo(_,u,p,v,p.paint.get("text-translate"),p.paint.get("text-translate-anchor"),!0),qo(_,u,p,v,p.paint.get("icon-translate"),p.paint.get("icon-translate-anchor"),!1))},circle:function(_,u,p,v){if("translucent"!==_.renderPass)return;const w=p.paint.get("circle-opacity"),I=p.paint.get("circle-stroke-width"),P=p.paint.get("circle-stroke-opacity"),k=void 0!==p.layout.get("circle-sort-key").constantOr(1);if(0===w.constantOr(1)&&(0===I.constantOr(1)||0===P.constantOr(1)))return;const N=_.context,U=N.gl,z=_.transform,q=_.depthModeForSublayer(0,h.DepthMode.ReadOnly),le=h.StencilMode.disabled,ye=_.colorModeForRenderPass(),be="globe"===z.projection.name,ve=[h.mercatorXfromLng(z.center.lng),h.mercatorYfromLat(z.center.lat)],we=[];for(let de=0;de<v.length;de++){const Ae=v[de],Se=u.getTile(Ae),Ge=Se.getBucket(p);if(!Ge||Ge.projection.name!==z.projection.name)continue;const Ye=Ge.programConfigurations.get(p.id),Xe=wd(p);be&&Xe.push("PROJECTION_GLOBE_VIEW");const ct=_.useProgram("circle",Ye,Xe),st=Ge.layoutVertexBuffer,Ct=Ge.globeExtVertexBuffer,rn=Ge.indexBuffer,_t=z.projection.createInversionMatrix(z,Ae.canonical),zt={programConfiguration:Ye,program:ct,layoutVertexBuffer:st,globeExtVertexBuffer:Ct,indexBuffer:rn,uniformValues:bd(_,Ae,Se,_t,ve,p),tile:Se};if(k){const Dt=Ge.segments.get();for(const en of Dt)we.push({segments:new h.SegmentVector([en]),sortKey:en.sortKey,state:zt})}else we.push({segments:Ge.segments,sortKey:0,state:zt})}k&&we.sort((de,Ae)=>de.sortKey-Ae.sortKey);const K={useDepthForOcclusion:!be};for(const de of we){const{programConfiguration:Ae,program:Se,layoutVertexBuffer:Ge,globeExtVertexBuffer:Ye,indexBuffer:Xe,uniformValues:ct,tile:st}=de.state,Ct=de.segments;_.terrain&&_.terrain.setupElevationDraw(st,Se,K),_.prepareDrawProgram(N,Se,st.tileID.toUnwrapped()),Se.draw(N,U.TRIANGLES,q,le,ye,h.CullFaceMode.disabled,ct,p.id,Ge,Xe,Ct,p.paint,z.zoom,Ae,[Ye])}},heatmap:function(_,u,p,v){if(0!==p.paint.get("heatmap-opacity"))if("offscreen"===_.renderPass){const w=_.context,I=w.gl,P=h.StencilMode.disabled,k=new h.ColorMode([I.ONE,I.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(ye,be,ve,we){const K=ye.gl,de=be.width*we,Ae=be.height*we;ye.activeTexture.set(K.TEXTURE1),ye.viewport.set([0,0,de,Ae]);let Se=ve.heatmapFbo;if(!Se||Se&&(Se.width!==de||Se.height!==Ae)){Se&&Se.destroy();const Ge=K.createTexture();K.bindTexture(K.TEXTURE_2D,Ge),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR),Se=ve.heatmapFbo=ye.createFramebuffer(de,Ae,!1),function(Ye,Xe,ct,st,Ct,rn){const _t=Ye.gl;_t.texImage2D(_t.TEXTURE_2D,0,Ye.isWebGL2&&Ye.extRenderToTextureHalfFloat?_t.RGBA16F:_t.RGBA,Ct,rn,0,_t.RGBA,Ye.extRenderToTextureHalfFloat?Ye.isWebGL2?_t.HALF_FLOAT:Ye.extTextureHalfFloat.HALF_FLOAT_OES:_t.UNSIGNED_BYTE,null),st.colorAttachment.set(ct)}(ye,0,Ge,Se,de,Ae)}else K.bindTexture(K.TEXTURE_2D,Se.colorAttachment.get()),ye.bindFramebuffer.set(Se.framebuffer)})(w,_,p,"globe"===_.transform.projection.name?.5:.25),w.clear({color:h.Color.transparent});const N=_.transform,U="globe"===N.projection.name,z=U?["PROJECTION_GLOBE_VIEW"]:null,q=U?h.CullFaceMode.frontCCW:h.CullFaceMode.disabled,le=[h.mercatorXfromLng(N.center.lng),h.mercatorYfromLat(N.center.lat)];for(let ye=0;ye<v.length;ye++){const be=v[ye];if(u.hasRenderableParent(be))continue;const ve=u.getTile(be),we=ve.getBucket(p);if(!we||we.projection.name!==N.projection.name)continue;const K=we.programConfigurations.get(p.id),de=_.useProgram("heatmap",K,z),{zoom:Ae}=_.transform;_.terrain&&_.terrain.setupElevationDraw(ve,de),_.prepareDrawProgram(w,de,be.toUnwrapped());const Se=N.projection.createInversionMatrix(N,be.canonical);de.draw(w,I.TRIANGLES,h.DepthMode.disabled,P,k,q,Id(_,be,ve,Se,le,Ae,p.paint.get("heatmap-intensity")),p.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,p.paint,_.transform.zoom,K,U?[we.globeExtVertexBuffer]:null)}w.viewport.set([0,0,_.width,_.height])}else"translucent"===_.renderPass&&(_.context.setColorMode(_.colorModeForRenderPass()),function(w,I){const P=w.context,k=P.gl,N=I.heatmapFbo;if(!N)return;P.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,N.colorAttachment.get()),P.activeTexture.set(k.TEXTURE1);let U=I.colorRampTexture;U||(U=I.colorRampTexture=new h.Texture(P,I.colorRamp,k.RGBA)),U.bind(k.LINEAR,k.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(P,k.TRIANGLES,h.DepthMode.disabled,h.StencilMode.disabled,w.colorModeForRenderPass(),h.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:I.paint.get("heatmap-opacity")},I.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,I.paint,w.transform.zoom)}(_,p))},line:function(_,u,p,v){if("translucent"!==_.renderPass)return;const w=p.paint.get("line-opacity"),I=p.paint.get("line-width");if(0===w.constantOr(1)||0===I.constantOr(1))return;const P=_.depthModeForSublayer(0,h.DepthMode.ReadOnly),k=_.colorModeForRenderPass(),N=_.terrain&&_.terrain.renderingToTexture?1:h.exported.devicePixelRatio,U=p.paint.get("line-dasharray"),z=U.constantOr(1),q=p.layout.get("line-cap"),le=p.paint.get("line-pattern"),ye=le.constantOr(1),be=p.paint.get("line-gradient"),ve=ye?"linePattern":"line",we=_.context,K=we.gl,de=(Se=>{const Ge=[];Wi(Se)&&Ge.push("RENDER_LINE_DASH"),Se.paint.get("line-gradient")&&Ge.push("RENDER_LINE_GRADIENT");const Ye=Se.paint.get("line-trim-offset");0===Ye[0]&&0===Ye[1]||Ge.push("RENDER_LINE_TRIM_OFFSET");const Xe=Se.paint.get("line-pattern").constantOr(1),ct=1!==Se.paint.get("line-opacity").constantOr(1);return!Xe&&ct&&Ge.push("RENDER_LINE_ALPHA_DISCARD"),Ge})(p);let Ae=de.includes("RENDER_LINE_ALPHA_DISCARD");_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(Ae=!1);for(const Se of v){const Ge=u.getTile(Se);if(ye&&!Ge.patternsLoaded())continue;const Ye=Ge.getBucket(p);if(!Ye)continue;_.prepareDrawTile();const Xe=Ye.programConfigurations.get(p.id),ct=_.useProgram(ve,Xe,de),st=le.constantOr(null);if(st&&Ge.imageAtlas){const Ut=Ge.imageAtlas.patternPositions[st.toString()];Ut&&Xe.setConstantPatternPositions(Ut)}const Ct=U.constantOr(null),rn=q.constantOr(null);if(!ye&&Ct&&rn&&Ge.lineAtlas){const Ut=Ge.lineAtlas.getDash(Ct,rn);Ut&&Xe.setConstantPatternPositions(Ut)}let[_t,zt]=p.paint.get("line-trim-offset");("round"===rn||"square"===rn)&&_t!==zt&&(0===_t&&(_t-=1),1===zt&&(zt+=1));const Dt=_.terrain?Se.projMatrix:null,en=ye?Ou(_,Ge,p,Dt,N):hh(_,Ge,p,Dt,Ye.lineClipsArray.length,N,[_t,zt]);if(be){const Ut=Ye.gradients[p.id];let sn=Ut.texture;if(p.gradientVersion!==Ut.version){let Zt=256;if(p.stepInterpolant){const Mt=u.getSource().maxzoom,Kn=Se.canonical.z===Mt?Math.ceil(1<<_.transform.maxZoom-Se.canonical.z):1;Zt=h.clamp(h.nextPowerOfTwo(Ye.maxLineLength/h.EXTENT*1024*Kn),256,we.maxTextureSize)}Ut.gradient=h.renderColorRamp({expression:p.gradientExpression(),evaluationKey:"lineProgress",resolution:Zt,image:Ut.gradient||void 0,clips:Ye.lineClipsArray}),Ut.texture?Ut.texture.update(Ut.gradient):Ut.texture=new h.Texture(we,Ut.gradient,K.RGBA),Ut.version=p.gradientVersion,sn=Ut.texture}we.activeTexture.set(K.TEXTURE1),sn.bind(p.stepInterpolant?K.NEAREST:K.LINEAR,K.CLAMP_TO_EDGE)}z&&(we.activeTexture.set(K.TEXTURE0),Ge.lineAtlasTexture.bind(K.LINEAR,K.REPEAT),Xe.updatePaintBuffers()),ye&&(we.activeTexture.set(K.TEXTURE0),Ge.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Xe.updatePaintBuffers()),_.prepareDrawProgram(we,ct,Se.toUnwrapped());const vt=Ut=>{ct.draw(we,K.TRIANGLES,P,Ut,k,h.CullFaceMode.disabled,en,p.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,p.paint,_.transform.zoom,Xe,[Ye.layoutVertexBuffer2])};if(Ae){const Ut=_.stencilModeForClipping(Se).ref;0===Ut&&_.terrain&&we.clear({stencil:0});const sn={func:K.EQUAL,mask:255};en.u_alpha_discard_threshold=.8,vt(new h.StencilMode(sn,Ut,255,K.KEEP,K.KEEP,K.INVERT)),en.u_alpha_discard_threshold=0,vt(new h.StencilMode(sn,Ut,255,K.KEEP,K.KEEP,K.KEEP))}else vt(_.stencilModeForClipping(Se))}Ae&&(_.resetStencilClippingMasks(),_.terrain&&we.clear({stencil:0}))},fill:function(_,u,p,v){const w=p.paint.get("fill-color"),I=p.paint.get("fill-opacity");if(0===I.constantOr(1))return;const P=_.colorModeForRenderPass(),k=p.paint.get("fill-pattern"),N=_.opaquePassEnabledForLayer()&&!k.constantOr(1)&&1===w.constantOr(h.Color.transparent).a&&1===I.constantOr(0)?"opaque":"translucent";if(_.renderPass===N){const U=_.depthModeForSublayer(1,"opaque"===_.renderPass?h.DepthMode.ReadWrite:h.DepthMode.ReadOnly);_h(_,u,p,v,U,P,!1)}if("translucent"===_.renderPass&&p.paint.get("fill-antialias")){const U=_.depthModeForSublayer(p.getPaintProperty("fill-outline-color")?2:0,h.DepthMode.ReadOnly);_h(_,u,p,v,U,P,!0)}},"fill-extrusion":function(_,u,p,v){const w=p.paint.get("fill-extrusion-opacity");if(0!==w&&"translucent"===_.renderPass){const I=new h.DepthMode(_.context.gl.LEQUAL,h.DepthMode.ReadWrite,_.depthRangeFor3D);if(1!==w||p.paint.get("fill-extrusion-pattern").constantOr(1))eo(_,u,p,v,I,h.StencilMode.disabled,h.ColorMode.disabled),eo(_,u,p,v,I,_.stencilModeFor3D(),_.colorModeForRenderPass()),_.resetStencilClippingMasks();else{const P=_.colorModeForRenderPass();eo(_,u,p,v,I,h.StencilMode.disabled,P)}}},hillshade:function(_,u,p,v){if("offscreen"!==_.renderPass&&"translucent"!==_.renderPass)return;const w=_.context,I=_.depthModeForSublayer(0,h.DepthMode.ReadOnly),P=_.colorModeForRenderPass(),k=_.terrain&&_.terrain.renderingToTexture,[N,U]="translucent"!==_.renderPass||k?[{},v]:_.stencilConfigForOverlap(v);for(const z of U){const q=u.getTile(z);if(q.needsHillshadePrepare&&"offscreen"===_.renderPass)fl(_,q,p,I,h.StencilMode.disabled,P);else if("translucent"===_.renderPass){const le=k&&_.terrain?_.terrain.stencilModeForRTTOverlap(z):N[z.overscaledZ];Pg(_,z,q,p,I,le,P)}}w.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,u,p,v,w,I){if("translucent"!==_.renderPass||0===p.paint.get("raster-opacity")||!v.length)return;const P=_.context,k=P.gl,N=u.getSource(),U=_.useProgram("raster"),z=_.colorModeForRenderPass(),q=_.terrain&&_.terrain.renderingToTexture,[le,ye]=N instanceof ue||q?[{},v]:_.stencilConfigForOverlap(v),be=ye[ye.length-1].overscaledZ,ve=!_.options.moving;for(const we of ye){const K=q?h.DepthMode.disabled:_.depthModeForSublayer(we.overscaledZ-be,1===p.paint.get("raster-opacity")?h.DepthMode.ReadWrite:h.DepthMode.ReadOnly,k.LESS),de=we.toUnwrapped(),Ae=u.getTile(we);if(q&&(!Ae||!Ae.hasData()))continue;const Se=q?we.projMatrix:_.transform.calculateProjMatrix(de,ve),Ge=_.terrain&&q?_.terrain.stencilModeForRTTOverlap(we):le[we.overscaledZ],Ye=I?0:p.paint.get("raster-fade-duration");Ae.registerFadeDuration(Ye);const Xe=u.findLoadedParent(we,0),ct=Ja(Ae,Xe,u,_.transform,Ye);let st,Ct;_.terrain&&_.terrain.prepareDrawTile();const rn="nearest"===p.paint.get("raster-resampling")?k.NEAREST:k.LINEAR;P.activeTexture.set(k.TEXTURE0),Ae.texture.bind(rn,k.CLAMP_TO_EDGE),P.activeTexture.set(k.TEXTURE1),Xe?(Xe.texture.bind(rn,k.CLAMP_TO_EDGE),st=Math.pow(2,Xe.tileID.overscaledZ-Ae.tileID.overscaledZ),Ct=[Ae.tileID.canonical.x*st%1,Ae.tileID.canonical.y*st%1]):Ae.texture.bind(rn,k.CLAMP_TO_EDGE),Ae.texture.useMipmap&&P.extTextureFilterAnisotropic&&_.transform.pitch>20&&k.texParameterf(k.TEXTURE_2D,P.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,P.extTextureFilterAnisotropicMax);const _t=Lf(Se,Ct||[0,0],st||1,ct,p,N instanceof ue?N.perspectiveTransform:[0,0]);if(_.prepareDrawProgram(P,U,de),N instanceof ue)N.boundsBuffer&&N.boundsSegments&&U.draw(P,k.TRIANGLES,K,h.StencilMode.disabled,z,h.CullFaceMode.disabled,_t,p.id,N.boundsBuffer,_.quadTriangleIndexBuffer,N.boundsSegments);else{const{tileBoundsBuffer:zt,tileBoundsIndexBuffer:Dt,tileBoundsSegments:en}=_.getTileBoundsBuffers(Ae);U.draw(P,k.TRIANGLES,K,Ge,z,h.CullFaceMode.disabled,_t,p.id,zt,Dt,en)}}_.resetStencilClippingMasks()},background:function(_,u,p,v){const w=p.paint.get("background-color"),I=p.paint.get("background-opacity");if(0===I)return;const P=_.context,k=P.gl,N=_.transform,U=N.tileSize,z=p.paint.get("background-pattern");if(_.isPatternMissing(z))return;const q=!z&&1===w.a&&1===I&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==q)return;const le=h.StencilMode.disabled,ye=_.depthModeForSublayer(0,"opaque"===q?h.DepthMode.ReadWrite:h.DepthMode.ReadOnly),be=_.colorModeForRenderPass(),ve=_.useProgram(z?"backgroundPattern":"background");let we,K=v;K||(we=_.getBackgroundTiles(),K=Object.values(we).map(de=>de.tileID)),z&&(P.activeTexture.set(k.TEXTURE0),_.imageManager.bind(_.context));for(const de of K){const Ae=de.toUnwrapped(),Se=v?de.projMatrix:_.transform.calculateProjMatrix(Ae);_.prepareDrawTile();const Ge=u?u.getTile(de):we?we[de.key]:new h.Tile(de,U,N.zoom,_),Ye=z?ss(Se,I,_,z,{tileID:de,tileSize:U}):On(Se,I,w);_.prepareDrawProgram(P,ve,Ae);const{tileBoundsBuffer:Xe,tileBoundsIndexBuffer:ct,tileBoundsSegments:st}=_.getTileBoundsBuffers(Ge);ve.draw(P,k.TRIANGLES,ye,le,be,h.CullFaceMode.disabled,Ye,p.id,Xe,ct,st)}},sky:function(_,u,p){const v=_.transform,w="mercator"===v.projection.name||"globe"===v.projection.name?1:h.smoothstep(7,8,v.zoom),I=p.paint.get("sky-opacity")*w;if(0===I)return;const P=_.context,k=p.paint.get("sky-type"),N=new h.DepthMode(P.gl.LEQUAL,h.DepthMode.ReadOnly,[0,1]),U=_.frameCounter/1e3%1;"atmosphere"===k?"offscreen"===_.renderPass?p.needsSkyboxCapture(_)&&(function(z,q,le,ye){const be=z.context,ve=be.gl;let we=q.skyboxFbo;if(!we){we=q.skyboxFbo=be.createFramebuffer(32,32,!1),q.skyboxGeometry=new Nl(be),q.skyboxTexture=be.gl.createTexture(),ve.bindTexture(ve.TEXTURE_CUBE_MAP,q.skyboxTexture),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MAG_FILTER,ve.LINEAR);for(let Se=0;Se<6;++Se)ve.texImage2D(ve.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,ve.RGBA,32,32,0,ve.RGBA,ve.UNSIGNED_BYTE,null)}be.bindFramebuffer.set(we.framebuffer),be.viewport.set([0,0,32,32]);const K=q.getCenter(z,!0),de=z.useProgram("skyboxCapture"),Ae=new Float64Array(16);h.identity(Ae),h.rotateY(Ae,Ae,.5*-Math.PI),hr(be,q,de,Ae,K,0),h.identity(Ae),h.rotateY(Ae,Ae,.5*Math.PI),hr(be,q,de,Ae,K,1),h.identity(Ae),h.rotateX(Ae,Ae,.5*-Math.PI),hr(be,q,de,Ae,K,2),h.identity(Ae),h.rotateX(Ae,Ae,.5*Math.PI),hr(be,q,de,Ae,K,3),h.identity(Ae),hr(be,q,de,Ae,K,4),h.identity(Ae),h.rotateY(Ae,Ae,Math.PI),hr(be,q,de,Ae,K,5),be.viewport.set([0,0,z.width,z.height])}(_,p),p.markSkyboxValid(_)):"sky"===_.renderPass&&function(z,q,le,ye,be){const ve=z.context,we=ve.gl,K=z.transform,de=z.useProgram("skybox");ve.activeTexture.set(we.TEXTURE0),we.bindTexture(we.TEXTURE_CUBE_MAP,q.skyboxTexture);const Ae={u_matrix:K.skyboxMatrix,u_sun_direction:q.getCenter(z,!1),u_cubemap:0,u_opacity:ye,u_temporal_offset:be};z.prepareDrawProgram(ve,de),de.draw(ve,we.TRIANGLES,le,h.StencilMode.disabled,z.colorModeForRenderPass(),h.CullFaceMode.backCW,Ae,"skybox",q.skyboxGeometry.vertexBuffer,q.skyboxGeometry.indexBuffer,q.skyboxGeometry.segment)}(_,p,N,I,U):"gradient"===k&&"sky"===_.renderPass&&function(z,q,le,ye,be){const ve=z.context,we=ve.gl,K=z.transform,de=z.useProgram("skyboxGradient");q.skyboxGeometry||(q.skyboxGeometry=new Nl(ve)),ve.activeTexture.set(we.TEXTURE0);let Ae=q.colorRampTexture;Ae||(Ae=q.colorRampTexture=new h.Texture(ve,q.colorRamp,we.RGBA)),Ae.bind(we.LINEAR,we.CLAMP_TO_EDGE);const Se=(Ge=K.skyboxMatrix,Ye=q.getCenter(z,!1),Xe=q.paint.get("sky-gradient-radius"),ct=ye,st=be,{u_matrix:Ge,u_color_ramp:0,u_center_direction:Ye,u_radius:h.degToRad(Xe),u_opacity:ct,u_temporal_offset:st});var Ge,Ye,Xe,ct,st;z.prepareDrawProgram(ve,de),de.draw(ve,we.TRIANGLES,le,h.StencilMode.disabled,z.colorModeForRenderPass(),h.CullFaceMode.backCW,Se,"skyboxGradient",q.skyboxGeometry.vertexBuffer,q.skyboxGeometry.indexBuffer,q.skyboxGeometry.segment)}(_,p,N,I,U)},debug:function(_,u,p){for(let v=0;v<p.length;v++)Lu(_,u,p[v])},custom:function(_,u,p,v){const w=_.context,I=p.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||"offscreen"===_.renderPass)&&p.isLayerDraped()){if("offscreen"===_.renderPass){const P=I.prerender;if(P){if(_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),"globe"===_.transform.projection.name){const k=_.transform.pointMerc;P.call(I,w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),h.globeToMercatorTransition(_.transform.zoom),[k.x,k.y],_.transform.pixelsPerMeterRatio)}else P.call(I,w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState()}}else if("translucent"===_.renderPass){if(_.terrain&&_.terrain.renderingToTexture){const k=I.renderToTile;if(k){const N=v[0].canonical,U=new h.MercatorCoordinate(N.x+v[0].wrap*(1<<N.z),N.y,N.z);w.setDepthMode(h.DepthMode.disabled),w.setStencilMode(h.StencilMode.disabled),w.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),k.call(I,w.gl,U),w.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),w.setStencilMode(h.StencilMode.disabled);const P="3d"===I.renderingMode?new h.DepthMode(_.context.gl.LEQUAL,h.DepthMode.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,h.DepthMode.ReadOnly);if(w.setDepthMode(P),"globe"===_.transform.projection.name){const k=_.transform.pointMerc;I.render(w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),h.globeToMercatorTransition(_.transform.zoom),[k.x,k.y],_.transform.pixelsPerMeterRatio)}else I.render(w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState(),w.bindFramebuffer.set(null)}}else h.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Ma{constructor(u,p,v=!1){this.context=new tn(u,v),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=h.SourceCache.maxUnderzooming+h.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(u,p){const v=!!u&&!!u.terrain&&this.transform.projection.supportsTerrain;if(!(v||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ku(this,u));const w=this._terrain;this.transform.elevation=v?w:null,w.update(u,this.transform,p)}_updateFog(u){const p=u.fog;if(!p||"globe"===this.transform.projection.name||p.getOpacity(this.transform.pitch)<1||p.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[v,w]=p.getFovAdjustedRange(this.transform._fov);if(v>w)return void(this.transform.fogCullDistSq=null);const I=v+.78*(w-v);this.transform.fogCullDistSq=I*I}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(u,p){if(this.width=u*h.exported.devicePixelRatio,this.height=p*h.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style.order)this.style._layers[v].resize()}setup(){const u=this.context,p=new h.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(h.EXTENT,0),p.emplaceBack(0,h.EXTENT),p.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=u.createVertexBuffer(p,h.posAttributes.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);const v=new h.StructArrayLayout2i4;v.emplaceBack(0,0),v.emplaceBack(h.EXTENT,0),v.emplaceBack(0,h.EXTENT),v.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=u.createVertexBuffer(v,h.posAttributes.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);const w=new h.StructArrayLayout2i4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(w,h.posAttributes.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);const I=new h.StructArrayLayout4i8;I.emplaceBack(0,0,0,0),I.emplaceBack(h.EXTENT,0,h.EXTENT,0),I.emplaceBack(0,h.EXTENT,0,h.EXTENT),I.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.mercatorBoundsBuffer=u.createVertexBuffer(I,h.boundsAttributes.members),this.mercatorBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);const P=new h.StructArrayLayout3ui6;P.emplaceBack(0,1,2),P.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(P);const k=new h.StructArrayLayout1ui2;for(const U of[0,1,3,2,0])k.emplaceBack(U);this.debugIndexBuffer=u.createIndexBuffer(k),this.emptyTexture=new h.Texture(u,new h.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),u.gl.RGBA),this.identityMat=h.create();const N=this.context.gl;this.stencilClearMode=new h.StencilMode({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(h.window.performance.now()),this.atmosphereBuffer=new Vl(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(u){return u._makeTileBoundsBuffers(this.context,this.transform.projection),u._tileBoundsBuffer?{tileBoundsBuffer:u._tileBoundsBuffer,tileBoundsIndexBuffer:u._tileBoundsIndexBuffer,tileBoundsSegments:u._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const u=this.context,p=u.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(u,p.TRIANGLES,h.DepthMode.disabled,this.stencilClearMode,h.ColorMode.disabled,h.CullFaceMode.disabled,Ol(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(u,p,v){if(!p||this.currentStencilSource===p.id||!u.isTileClipped()||!v||0===v.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let k=!1;for(const N of v)if(void 0===this._tileClippingMaskIDs[N.key]){k=!0;break}if(!k)return}this.currentStencilSource=p.id;const w=this.context,I=w.gl;this.nextStencilID+v.length>256&&this.clearStencil(),w.setColorMode(h.ColorMode.disabled),w.setDepthMode(h.DepthMode.disabled);const P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const k of v){const N=p.getTile(k),U=this._tileClippingMaskIDs[k.key]=this.nextStencilID++,{tileBoundsBuffer:z,tileBoundsIndexBuffer:q,tileBoundsSegments:le}=this.getTileBoundsBuffers(N);P.draw(w,I.TRIANGLES,h.DepthMode.disabled,new h.StencilMode({func:I.ALWAYS,mask:0},U,255,I.KEEP,I.KEEP,I.REPLACE),h.ColorMode.disabled,h.CullFaceMode.disabled,Ol(k.projMatrix),"$clipping",z,q,le)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,p=this.context.gl;return new h.StencilMode({func:p.NOTEQUAL,mask:255},u,255,p.KEEP,p.KEEP,p.REPLACE)}stencilModeForClipping(u){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(u);const p=this.context.gl;return new h.StencilMode({func:p.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,p.KEEP,p.KEEP,p.REPLACE)}stencilConfigForOverlap(u){const p=this.context.gl,v=u.sort((P,k)=>k.overscaledZ-P.overscaledZ),w=v[v.length-1].overscaledZ,I=v[0].overscaledZ-w+1;if(I>1){this.currentStencilSource=void 0,this.nextStencilID+I>256&&this.clearStencil();const P={};for(let k=0;k<I;k++)P[k+w]=new h.StencilMode({func:p.GEQUAL,mask:255},k+this.nextStencilID,255,p.KEEP,p.KEEP,p.REPLACE);return this.nextStencilID+=I,[P,v]}return[{[w]:h.StencilMode.disabled},v]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new h.ColorMode([u.CONSTANT_COLOR,u.ONE],new h.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?h.ColorMode.unblended:h.ColorMode.alphaBlended}depthModeForSublayer(u,p,v){if(!this.opaquePassEnabledForLayer())return h.DepthMode.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new h.DepthMode(v||this.context.gl.LEQUAL,p,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(u,p){this.style=u,this.options=p,this.imageManager=u.imageManager,this.glyphManager=u.glyphManager,this.symbolFadeChange=u.placement.symbolFadeChange(h.exported.now()),this.imageManager.beginFrame();const v=this.style.order,w=this.style._sourceCaches;for(const U in w){const z=w[U];z.used&&z.prepare(this.context)}const I={},P={},k={};for(const U in w){const z=w[U];I[U]=z.getVisibleCoordinates(),P[U]=I[U].slice().reverse(),k[U]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<v.length;U++)if(this.style._layers[v[U]].is3D()){this.opaquePassCutoff=U;break}if(this.terrain&&(this.terrain.updateTileBinding(k),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new h.GlobeSharedBuffers(this.context)),!h.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const U of v){const z=this.style._layers[U],q=u._getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const le=q?P[q.id]:void 0;("custom"===z.type||z.isSky()||le&&le.length)&&this.renderLayer(this,q,z,le)}this.depthRangeFor3D=[0,1-(u.order.length+2)*this.numSublayers*this.depthEpsilon];const N=this.terrain;if(N&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&N.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:p.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=p.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[v[this.currentLayer]],z=u._getLayerSourceCache(U);if(U.isSky())continue;const q=z?P[z.id]:void 0;this._renderTileClippingMasks(U,z,q),this.renderLayer(this,z,U,q)}if(this.style.fog&&this.transform.projection.supportsFog&&function(U,z){const q=U.context,le=q.gl,ye=U.transform,be=new h.DepthMode(le.LEQUAL,h.DepthMode.ReadOnly,[0,1]),ve=U.useProgram("globeAtmosphere",null,"globe"===ye.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),we=h.globeToMercatorTransition(ye.zoom),K=z.properties.get("color").toArray01(),de=z.properties.get("high-color").toArray01(),Ae=z.properties.get("space-color").toArray01PremultipliedAlpha(),Se=h.identity$1([]);h.rotateY$1(Se,Se,-h.degToRad(ye._center.lng)),h.rotateX$1(Se,Se,h.degToRad(ye._center.lat)),h.rotateZ$1(Se,Se,ye.angle),h.rotateX$1(Se,Se,-ye._pitch);const Ge=h.fromQuat(new Float32Array(16),Se),Ye=h.mapValue(z.properties.get("star-intensity"),0,1,0,.25),ct=h.mapValue(z.properties.get("horizon-blend"),0,1,5e-4,.25),st=h.globeUseCustomAntiAliasing(U,q,ye)&&5e-4===ct?ye.worldSize/(2*Math.PI*1.025)-1:ye.globeRadius,Ct=U.frameCounter/1e3%1,rn=h.length(ye.globeCenterInViewSpace),_t=Math.sqrt(Math.pow(rn,2)-Math.pow(st,2)),zt=Math.acos(_t/rn),Dt={u_frustum_tl:ye.frustumCorners.TL,u_frustum_tr:ye.frustumCorners.TR,u_frustum_br:ye.frustumCorners.BR,u_frustum_bl:ye.frustumCorners.BL,u_horizon:ye.frustumCorners.horizon,u_transition:we,u_fadeout_range:ct,u_color:K,u_high_color:de,u_space_color:Ae,u_star_intensity:Ye,u_star_size:5*h.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ct,u_horizon_angle:zt,u_rotation_matrix:Ge};U.prepareDrawProgram(q,ve);const en=U.atmosphereBuffer;en&&ve.draw(q,le.TRIANGLES,be,h.StencilMode.disabled,h.ColorMode.alphaBlended,h.CullFaceMode.backCW,Dt,"skybox",en.vertexBuffer,en.indexBuffer,en.segments)}(this,this.style.fog),this.renderPass="sky",(h.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const U=this.style._layers[v[this.currentLayer]],z=u._getLayerSourceCache(U);U.isSky()&&this.renderLayer(this,z,U,z?P[z.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;){const U=this.style._layers[v[this.currentLayer]],z=u._getLayerSourceCache(U);if(U.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(U)){if(U.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const q=z?("symbol"===U.type?k:P)[z.id]:void 0;this._renderTileClippingMasks(U,z,z?I[z.id]:void 0),this.renderLayer(this,z,U,q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let U=null;h.values(this.style._layers).forEach(z=>{const q=u._getLayerSourceCache(z);q&&!z.isHidden(this.transform.zoom)&&(!U||U.getSource().maxzoom<q.getSource().maxzoom)&&(U=q)}),U&&this.options.showTileBoundaries&&Ss.debug(this,U,U.getVisibleCoordinates())}this.options.showPadding&&function(U){const z=U.transform.padding;Io(U,U.transform.height-(z.top||0),3,Ci),Io(U,z.bottom||0,3,Zr),pa(U,z.left||0,3,el),pa(U,U.transform.width-(z.right||0),3,Dd);const q=U.transform.centerPoint;var le,ye,be,ve;tl(le=U,(ye=q.x)-1,(be=U.transform.height-q.y)-10,2,20,ve=as),tl(le,ye-10,be-1,20,2,ve)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(h.window.performance.now()),this.saveCanvasCopy())}renderLayer(u,p,v,w){v.isHidden(this.transform.zoom)||("background"===v.type||"sky"===v.type||"custom"===v.type||w&&w.length)&&(this.id=v.id,this.gpuTimingStart(v),(!u.transform.projection.unsupportedLayers||!u.transform.projection.unsupportedLayers.includes(v.type)||u.terrain&&"custom"===v.type)&&Ss[v.type](u,p,v,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(u){if(!this.options.gpuTiming)return;const p=this.context.extTimerQuery;let v=this.gpuTimers[u.id];v||(v=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:p.createQueryEXT()}),v.calls++,p.beginQueryEXT(p.TIME_ELAPSED_EXT,v.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const u=this.context.extTimerQuery,p=u.createQueryEXT();this.deferredRenderGpuTimeQueries.push(p),u.beginQueryEXT(u.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;u.endQueryEXT(u.TIME_ELAPSED_EXT)}collectGpuTimers(){const u=this.gpuTimers;return this.gpuTimers={},u}collectDeferredRenderGpuQueries(){const u=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],u}queryGpuTimers(u){const p={};for(const v in u){const w=u[v],I=this.context.extTimerQuery,P=I.getQueryObjectEXT(w.query,I.QUERY_RESULT_EXT)/1e6;I.deleteQueryEXT(w.query),p[v]=P}return p}queryGpuTimeDeferredRender(u){if(!this.options.gpuTimingDeferredRender)return 0;const p=this.context.extTimerQuery;let v=0;for(const w of u)v+=p.getQueryObjectEXT(w,p.QUERY_RESULT_EXT)/1e6,p.deleteQueryEXT(w);return v}translatePosMatrix(u,p,v,w,I){if(!v[0]&&!v[1])return u;const P=I?"map"===w?this.transform.angle:0:"viewport"===w?-this.transform.angle:0;if(P){const U=Math.sin(P),z=Math.cos(P);v=[v[0]*z-v[1]*U,v[0]*U+v[1]*z]}const k=[I?v[0]:Hn(p,v[0],this.transform.zoom),I?v[1]:Hn(p,v[1],this.transform.zoom),0],N=new Float32Array(16);return h.translate(N,u,k),N}saveTileTexture(u){const p=this._tileTextures[u.size[0]];p?p.push(u):this._tileTextures[u.size[0]]=[u]}getTileTexture(u){const p=this._tileTextures[u];return p&&p.length>0?p.pop():null}isPatternMissing(u){return null===u||void 0!==u&&!this.imageManager.getPattern(u.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const u=this.terrain&&this.terrain.renderingToTexture,p=this.terrain&&0===this.terrain.exaggeration(),v=this.style&&this.style.fog,w=[];return this.terrainRenderModeElevated()&&w.push("TERRAIN"),"globe"===this.transform.projection.name&&w.push("GLOBE"),p&&w.push("ZERO_EXAGGERATION"),v&&!u&&0!==v.getOpacity(this.transform.pitch)&&w.push("FOG"),u&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}useProgram(u,p,v){this.cache=this.cache||{};const w=v||[],I=this.currentGlobalDefines().concat(w),P=tr.cacheKey(Pu[u],u,I,p);return this.cache[P]||(this.cache[P]=new tr(this.context,u,Pu[u],p,nr[u],I)),this.cache[P]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=h.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(u,p,v){if(this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const I=w.getOpacity(this.transform.pitch),P=((k,N,U,z,q,le,ye,be,ve,we,K)=>{const de=k.transform,Ae=N.properties.get("color").toArray01();Ae[3]=z;const Se=k.frameCounter/1e3%1;return{u_fog_matrix:U?de.calculateFogTileMatrix(U):k.identityMat,u_fog_range:N.getFovAdjustedRange(de._fov),u_fog_color:Ae,u_fog_horizon_blend:N.properties.get("horizon-blend"),u_fog_temporal_offset:Se,u_frustum_tl:q,u_frustum_tr:le,u_frustum_br:ye,u_frustum_bl:be,u_globe_pos:ve,u_globe_radius:we,u_viewport:K,u_globe_transition:h.globeToMercatorTransition(de.zoom),u_is_globe:+("globe"===de.projection.name)}})(this,w,v,I,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*h.exported.devicePixelRatio,this.transform.height*h.exported.devicePixelRatio]);p.setFogUniformValues(u,P)}}setTileLoadedFlag(u){this.tileLoaded=u}saveCanvasCopy(){const u=this.canvasCopy();u&&(this.frameCopies.push(u),this.tileLoaded=!1)}canvasCopy(){const u=this.context.gl,p=u.createTexture();return u.bindTexture(u.TEXTURE_2D,p),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,u.drawingBufferWidth,u.drawingBufferHeight,0),p}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const u=this.style&&this.style.fog;return!!u&&0!==u.getOpacity(this.transform.pitch)}getBackgroundTiles(){const u=this._backgroundTiles,p=this._backgroundTiles={},v=this.transform.coveringTiles({tileSize:512});for(const w of v)p[w.key]=u[w.key]||new h.Tile(w,512,this.transform.tileZoom,this);return p}clearBackgroundTiles(){this._backgroundTiles={}}}class Ad{constructor(u=0,p=0,v=0,w=0){if(isNaN(u)||u<0||isNaN(p)||p<0||isNaN(v)||v<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=p,this.left=v,this.right=w}interpolate(u,p,v){return null!=p.top&&null!=u.top&&(this.top=h.number(u.top,p.top,v)),null!=p.bottom&&null!=u.bottom&&(this.bottom=h.number(u.bottom,p.bottom,v)),null!=p.left&&null!=u.left&&(this.left=h.number(u.left,p.left,v)),null!=p.right&&null!=u.right&&(this.right=h.number(u.right,p.right,v)),this}getCenter(u,p){const v=h.clamp((this.left+u-this.right)/2,0,u),w=h.clamp((this.top+p-this.bottom)/2,0,p);return new h.Point(v,w)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new Ad(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ma(_,u){const p=h.getColumn(_,3);h.fromQuat(_,u),h.setColumn(_,3,p)}function Vi(_,u){const p=h.identity$1([]);return h.rotateZ$1(p,p,-u),h.rotateX$1(p,p,-_),p}function zl(_,u){const p=[_[0],_[1],0],v=[u[0],u[1],0];if(h.length(p)>=1e-15){const P=h.normalize([],p);h.scale$2(v,P,h.dot(v,P)),u[0]=v[0],u[1]=v[1]}const w=h.cross([],u,_);if(h.len(w)<1e-15)return null;const I=Math.atan2(-w[1],w[0]);return Vi(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),I)}class Zc{constructor(u,p){this.position=u,this.orientation=p}get position(){return this._position}set position(u){if(u){const p=u instanceof h.MercatorCoordinate?u:new h.MercatorCoordinate(u[0],u[1],u[2]);this._renderWorldCopies&&(p.x=h.wrap(p.x,0,1)),this._position=p}else this._position=null}lookAtPoint(u,p){if(this.orientation=null,!this.position)return;const v=this.position,w=this._elevation?this._elevation.getAtPointOrZero(h.MercatorCoordinate.fromLngLat(u)):0,I=h.MercatorCoordinate.fromLngLat(u,w),P=[I.x-v.x,I.y-v.y,I.z-v.z];p||(p=[0,0,1]),p[2]=Math.abs(p[2]),this.orientation=zl(P,p)}setPitchBearing(u,p){this.orientation=Vi(h.degToRad(u),h.degToRad(-p))}}class ji{constructor(u,p){this._transform=h.identity([]),this.orientation=p,this.position=u}get mercatorPosition(){const u=this.position;return new h.MercatorCoordinate(u[0],u[1],u[2])}get position(){const u=h.getColumn(this._transform,3);return[u[0],u[1],u[2]]}set position(u){var p;u&&h.setColumn(this._transform,3,[(p=u)[0],p[1],p[2],1])}get orientation(){return this._orientation}set orientation(u){this._orientation=u||h.identity$1([]),u&&ma(this._transform,this._orientation)}getPitchBearing(){const u=this.forward(),p=this.right();return{bearing:Math.atan2(-p[1],p[0]),pitch:Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2])}}setPitchBearing(u,p){this._orientation=Vi(u,p),ma(this._transform,this._orientation)}forward(){const u=h.getColumn(this._transform,2);return[-u[0],-u[1],-u[2]]}up(){const u=h.getColumn(this._transform,1);return[-u[0],-u[1],-u[2]]}right(){const u=h.getColumn(this._transform,0);return[u[0],u[1],u[2]]}getCameraToWorld(u,p){const v=new Float64Array(16);return h.invert(v,this.getWorldToCamera(u,p)),v}getWorldToCameraPosition(u,p,v){const w=this.position;h.scale$2(w,w,-u);const I=new Float64Array(16);return h.fromScaling(I,[v,v,v]),h.translate(I,I,w),I[10]*=p,I}getWorldToCamera(u,p){const v=new Float64Array(16),w=new Float64Array(4),I=this.position;return h.conjugate(w,this._orientation),h.scale$2(I,I,-u),h.fromQuat(v,w),h.translate(v,v,I),v[1]*=-1,v[5]*=-1,v[9]*=-1,v[13]*=-1,v[8]*=p,v[9]*=p,v[10]*=p,v[11]*=p,v}getCameraToClipPerspective(u,p,v,w){const I=new Float64Array(16);return h.perspective(I,u,p,v,w),I}getDistanceToElevation(u,p=!1){const v=0===u?0:h.mercatorZfromAltitude(u,p?h.latFromMercatorY(this.position[1]):this.position[1]),w=this.forward();return(v-this.position[2])/w[2]}clone(){return new ji([...this.position],[...this.orientation])}}function Sd(_,u){const p=Bu(_.projection,_.zoom,_.width,_.height),v=function(I,P,k,N,U){const z=new h.LngLat(k.lng-180*ls,k.lat),q=new h.LngLat(k.lng+180*ls,k.lat),le=I.project(z.lng,z.lat),ye=I.project(q.lng,q.lat),be=-Math.atan2(ye.y-le.y,ye.x-le.x),ve=h.MercatorCoordinate.fromLngLat(k);ve.y=h.clamp(ve.y,-1+ls,1-ls);const we=ve.toLngLat(),K=I.project(we.lng,we.lat),de=h.MercatorCoordinate.fromLngLat(we);de.x+=ls;const Ae=de.toLngLat(),Se=I.project(Ae.lng,Ae.lat),Ge=jl(Se.x-K.x,Se.y-K.y,be),Ye=h.MercatorCoordinate.fromLngLat(we);Ye.y+=ls;const Xe=Ye.toLngLat(),ct=I.project(Xe.lng,Xe.lat),st=jl(ct.x-K.x,ct.y-K.y,be),Ct=Math.abs(Ge.x)/Math.abs(st.y),rn=h.identity([]);h.rotateZ(rn,rn,-be*(1-(U?0:N)));const _t=h.identity([]);return h.scale(_t,_t,[1,1-(1-Ct)*N,1]),_t[4]=-st.x/st.y*N,h.rotateZ(_t,_t,be),h.multiply(_t,rn,_t),_t}(_.projection,0,_.center,p,u),w=Ul(_);return h.scale(v,v,[w,w,1]),v}function Ul(_){const u=_.projection,p=Bu(_.projection,_.zoom,_.width,_.height),v=Md(u,_.center),w=Md(u,h.LngLat.convert(u.center));return Math.pow(2,v*p+(1-p)*w)}function Bu(_,u,p,v,w=1/0){const I=_.range;if(!I)return 0;const P=Math.min(w,Math.max(p,v)),k=Math.log(P/1024)/Math.LN2;return h.smoothstep(I[0]+k,I[1]+k,u)}const ls=1/4e4;function Md(_,u){const p=h.clamp(u.lat,-h.MAX_MERCATOR_LATITUDE,h.MAX_MERCATOR_LATITUDE),v=new h.LngLat(u.lng-180*ls,p),w=new h.LngLat(u.lng+180*ls,p),I=_.project(v.lng,p),P=_.project(w.lng,p),k=h.MercatorCoordinate.fromLngLat(v),N=h.MercatorCoordinate.fromLngLat(w),U=P.x-I.x,z=P.y-I.y,q=N.x-k.x,le=N.y-k.y,ye=Math.sqrt((q*q+le*le)/(U*U+z*z));return Math.log(ye)/Math.LN2}function jl(_,u,p){const v=Math.cos(p),w=Math.sin(p);return{x:_*v-u*w,y:_*w+u*v}}class ml{constructor(u,p,v,w,I,P,k){this.tileSize=512,this._renderWorldCopies=void 0===I||I,this._minZoom=u||0,this._maxZoom=p||22,this._minPitch=v??0,this._maxPitch=w??60,this.setProjection(P),this.setMaxBounds(k),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ad,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new ji,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const u=new ml(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return u._elevation=this._elevation,u._centerAltitude=this._centerAltitude,u._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,u.tileSize=this.tileSize,u.mercatorFromTransition=this.mercatorFromTransition,u.width=this.width,u.height=this.height,u.cameraElevationReference=this.cameraElevationReference,u._center=this._center,u._setZoom(this.zoom),u._seaLevelZoom=this._seaLevelZoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._nearZ=this._nearZ,u._farZ=this._farZ,u._averageElevation=this._averageElevation,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._camera=this._camera.clone(),u._calcMatrices(),u.freezeTileCoverage=this.freezeTileCoverage,u.frustumCorners=this.frustumCorners,u}get elevation(){return this._elevation}set elevation(u){this._elevation!==u&&(this._elevation=u,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(u,p=!1){const v=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||v)&&this._updateCameraOnTerrain(),(u||v)&&this._constrainCamera(p),this._calcMatrices()}getProjection(){return h.pick(this.projection,["name","center","parallels"])}setProjection(u){this.projectionOptions=u||{name:"mercator"};const p=this.projection?this.getProjection():void 0;this.projection=h.getProjection(this.projectionOptions);const v=!Me(p,this.getProjection());return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setMercatorFromTransition(){const u=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=h.getProjection({name:"mercator"});const p=u!==this.projection.name;return p&&this._calcMatrices(),p}get minZoom(){return this._minZoom}set minZoom(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))}get maxZoom(){return this._maxZoom}set maxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))}get minPitch(){return this._minPitch}set minPitch(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))}get maxPitch(){return this._maxPitch}set maxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(u){void 0===u?u=!0:null===u&&(u=!1),this._renderWorldCopies=u}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get cameraWorldSize(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return h.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.Point(this.width,this.height)}get bearing(){return h.wrap(this.rotation,-180,180)}set bearing(u){this.rotation=u}get rotation(){return-this.angle/Math.PI*180}set rotation(u){const p=-u*Math.PI/180;var v,w,I,P,k,N,U,z,q,le;this.angle!==p&&(this._unmodified=!1,this.angle=p,this._calcMatrices(),this.rotationMatrix=(v=new h.ARRAY_TYPE(4),h.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v),w=this.rotationMatrix,P=this.angle,k=(I=this.rotationMatrix)[0],N=I[1],U=I[2],z=I[3],q=Math.sin(P),le=Math.cos(P),w[0]=k*le+U*q,w[1]=N*le+z*q,w[2]=k*-q+U*le,w[3]=N*-q+z*le)}get pitch(){return this._pitch/Math.PI*180}set pitch(u){const p=h.clamp(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==p&&(this._unmodified=!1,this._pitch=p,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const u=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/u)}set fov(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=h.degToRad(u),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(u){this._averageElevation=u,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(u){const p=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==p&&(this._unmodified=!1,this._setZoom(p),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(u){this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const u=this._elevation;this._centerAltitude=u.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=u.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const u=this._elevation,p=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],v=this.horizonLineFromTop();let w=0,I=0;for(let P=0;P<p.length;P++){const k=new h.Point(p[P][0]*this.width,v+p[P][1]*(this.height-v)),N=u.pointCoordinate(k);if(!N)continue;const U=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);w+=N[3]*U,I+=U}return 0===I?NaN:w/I}get center(){return this._center}set center(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const u=this._seaLevelZoom,p=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),v=this.pixelsPerMeter/this.worldSize*p,w=this._mercatorZfromZoom(u),I=this._mercatorZfromZoom(this._maxZoom),P=Math.max(w-v,I);this._setZoom(this._zoomFromMercatorZ(P))}get padding(){return this._edgeInsets.toJSON()}set padding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}computeZoomRelativeTo(u){const p=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,u.toAltitude()));let v;v=u.z<this._camera.position[2]?[p.x,p.y,p.z]:[u.x,u.y,u.z];const w=h.length(h.sub([],this._camera.position,v));return h.clamp(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(u){if(!this.height||!u.position&&!u.orientation)return;this._updateCameraState();let p=!1;if(u.orientation&&!h.exactEquals(u.orientation,this._camera.orientation)&&(p=this._setCameraOrientation(u.orientation)),u.position){const v=[u.position.x,u.position.y,u.position.z];h.exactEquals$1(v,this._camera.position)||(this._setCameraPosition(v),p=!0)}p&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const u=this._camera.position,p=new Zc;return p.position=new h.MercatorCoordinate(u[0],u[1],u[2]),p.orientation=this._camera.orientation,p._elevation=this.elevation,p._renderWorldCopies=this.renderWorldCopies,p}_setCameraOrientation(u){if(!h.length$1(u))return!1;h.normalize$1(u,u);const p=h.transformQuat([],[0,0,-1],u),v=h.transformQuat([],[0,-1,0],u);if(v[2]<0)return!1;const w=zl(p,v);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(u){const p=this.zoomScale(this.minZoom)*this.tileSize,v=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;u[2]=h.clamp(u[2],w/v,w/p),this._camera.position=u}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,p,v){this._unmodified=!1,this._edgeInsets.interpolate(u,p,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(u){const p=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,p)}getVisibleUnwrappedCoordinates(u){const p=[new h.UnwrappedTileID(0,u)];if(this.renderWorldCopies){const v=this.pointCoordinate(new h.Point(0,0)),w=this.pointCoordinate(new h.Point(this.width,0)),I=this.pointCoordinate(new h.Point(this.width,this.height)),P=this.pointCoordinate(new h.Point(0,this.height)),k=Math.floor(Math.min(v.x,w.x,I.x,P.x)),N=Math.floor(Math.max(v.x,w.x,I.x,P.x)),U=1;for(let z=k-U;z<=N+U;z++)0!==z&&p.push(new h.UnwrappedTileID(z,u))}return p}coveringTiles(u){let p=this.coveringZoomLevel(u);const v=p,w=this.elevation&&!u.isTerrainDEM,I="mercator"===this.projection.name;if(void 0!==u.minzoom&&p<u.minzoom)return[];void 0!==u.maxzoom&&p>u.maxzoom&&(p=u.maxzoom);const P=this.locationCoordinate(this.center),k=this.center.lat,N=1<<p,U=[N*P.x,N*P.y,0],z="globe"===this.projection.name,q=!z,le=h.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p,q),ye=z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),be=N*h.mercatorZfromAltitude(1,this.center.lat),ve=this._camera.position[2]/h.mercatorZfromAltitude(1,this.center.lat),we=[N*ye.x,N*ye.y,ve*(q?1:be)],K=this.cameraToCenterDistance/u.tileSize*(u.roundZoom?1:.502),de=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?p:0,Ae=u.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Se=u.isTerrainDEM?-Ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ge=this.projection.isReprojectedInTileSpace?Ul(this):1,Ye=vt=>{const sn=new h.MercatorCoordinate(vt.x+25e-6,vt.y,vt.z),Zt=new h.MercatorCoordinate(vt.x,vt.y+25e-6,vt.z),Mt=vt.toLngLat(),Kn=sn.toLngLat(),pi=Zt.toLngLat(),Ln=this.locationCoordinate(Mt),oi=this.locationCoordinate(Kn),Ni=this.locationCoordinate(pi),Si=Math.hypot(oi.x-Ln.x,oi.y-Ln.y),Bn=Math.hypot(Ni.x-Ln.x,Ni.y-Ln.y);return Math.sqrt(Si*Bn)*Ge/25e-6},Xe=vt=>{const Ut=Ae,sn=Se;return{aabb:h.tileAABB(this,N,0,0,0,vt,sn,Ut,this.projection),zoom:0,x:0,y:0,minZ:sn,maxZ:Ut,wrap:vt,fullyVisible:!1}},ct=[];let st=[];const Ct=p,rn=u.reparseOverscaled?v:p,_t=vt=>vt*vt,zt=_t((ve-this._centerAltitude)*be),Dt=vt=>{if(!this._elevation||!vt.tileID||!I)return;const Ut=this._elevation.getMinMaxForTile(vt.tileID),sn=vt.aabb;Ut?(sn.min[2]=Ut.min,sn.max[2]=Ut.max,sn.center[2]=(sn.min[2]+sn.max[2])/2):(vt.shouldSplit=en(vt),vt.shouldSplit||(sn.min[2]=sn.max[2]=sn.center[2]=this._centerAltitude))},en=vt=>{if(vt.zoom<de)return!0;if(vt.zoom===Ct)return!1;if(null!=vt.shouldSplit)return vt.shouldSplit;const Ut=vt.aabb.distanceX(we),sn=vt.aabb.distanceY(we);let Zt=zt,Mt=1;if(z){Zt=_t(vt.aabb.distanceZ(we));const Ln=Math.pow(2,vt.zoom),oi=h.latFromMercatorY((vt.y+1)/Ln),Ni=h.latFromMercatorY(vt.y/Ln),Si=Math.min(Math.max(k,oi),Ni),Bn=h.circumferenceAtLatitude(Si)/h.circumferenceAtLatitude(k);if(Mt=Si===k?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Bn/this._mercatorScaleRatio),this.zoom<=h.GLOBE_ZOOM_THRESHOLD_MIN&&vt.zoom===Ct-1&&Bn>=.9)return!0}else if(w&&(Zt=_t(vt.aabb.distanceZ(we)*be)),this.projection.isReprojectedInTileSpace&&v<=5){const Ln=Math.pow(2,vt.zoom),oi=Ye(new h.MercatorCoordinate((vt.x+.5)/Ln,(vt.y+.5)/Ln));Mt=oi>.85?1:oi}const Kn=Ut*Ut+sn*sn+Zt;return Kn<_t((1<<Ct-vt.zoom)*K*Mt*((Ln,oi)=>{if(oi*_t(.707)<Ln)return 1;const Ni=Math.sqrt(oi/Ln);return Ni/(1.4144271570014144+(Math.pow(1.1,Ni-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Zt,zt),Kn))};if(this.renderWorldCopies)for(let vt=1;vt<=3;vt++)ct.push(Xe(-vt)),ct.push(Xe(vt));for(ct.push(Xe(0));ct.length>0;){const vt=ct.pop(),Ut=vt.x,sn=vt.y;let Zt=vt.fullyVisible;if(!Zt){const Mt=vt.aabb.intersects(le);if(0===Mt)continue;Zt=2===Mt}if(vt.zoom!==Ct&&en(vt))for(let Mt=0;Mt<4;Mt++){const Kn=(Ut<<1)+Mt%2,pi=(sn<<1)+(Mt>>1),Ln={aabb:I?vt.aabb.quadrant(Mt):h.tileAABB(this,N,vt.zoom+1,Kn,pi,vt.wrap,vt.minZ,vt.maxZ,this.projection),zoom:vt.zoom+1,x:Kn,y:pi,wrap:vt.wrap,fullyVisible:Zt,tileID:void 0,shouldSplit:void 0,minZ:vt.minZ,maxZ:vt.maxZ};w&&!z&&(Ln.tileID=new h.OverscaledTileID(vt.zoom+1===Ct?rn:vt.zoom+1,vt.wrap,vt.zoom+1,Kn,pi),Dt(Ln)),ct.push(Ln)}else{const Mt=vt.zoom===Ct?rn:vt.zoom;if(u.minzoom&&u.minzoom>Mt)continue;const Kn=U[0]-(.5+Ut+(vt.wrap<<vt.zoom))*(1<<p-vt.zoom),pi=U[1]-.5-sn,Ln=vt.tileID?vt.tileID:new h.OverscaledTileID(Mt,vt.wrap,vt.zoom,Ut,sn);st.push({tileID:Ln,distanceSq:Kn*Kn+pi*pi})}}if(this.fogCullDistSq){const vt=this.fogCullDistSq,Ut=this.horizonLineFromTop();st=st.filter(sn=>{const Zt=[0,0,0,1],Mt=[h.EXTENT,h.EXTENT,0,1],Kn=this.calculateFogTileMatrix(sn.tileID.toUnwrapped());h.transformMat4$1(Zt,Zt,Kn),h.transformMat4$1(Mt,Mt,Kn);const pi=h.getAABBPointSquareDist(Zt,Mt);if(0===pi)return!0;let Ln=!1;const oi=this._elevation;if(oi&&pi>vt&&0!==Ut){const Ni=this.calculateProjMatrix(sn.tileID.toUnwrapped());let Si;u.isTerrainDEM||(Si=oi.getMinMaxForTile(sn.tileID)),Si||(Si={min:Se,max:Ae});const Bn=h.furthestTileCorner(this.rotation),mr=[Bn[0]*h.EXTENT,Bn[1]*h.EXTENT,Si.max];h.transformMat4(mr,mr,Ni),Ln=(1-mr[1])*this.height*.5<Ut}return pi<vt||Ln})}return st.sort((vt,Ut)=>vt.distanceSq-Ut.distanceSq).map(vt=>vt.tileID)}resize(u,p){this.width=u,this.height=p,this.pixelsToGLUnits=[2/u,-2/p],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(u){return Math.pow(2,u)}scaleZoom(u){return Math.log(u)/Math.LN2}project(u){const p=h.clamp(u.lat,-h.MAX_MERCATOR_LATITUDE,h.MAX_MERCATOR_LATITUDE),v=this.projection.project(u.lng,p);return new h.Point(v.x*this.worldSize,v.y*this.worldSize)}unproject(u){return this.projection.unproject(u.x/this.worldSize,u.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/h.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(u,p){let v,w;const I=this.centerPoint;if("globe"===this.projection.name){const k=this.worldSize;v=(p.x-I.x)/k,w=(p.y-I.y)/k}else{const k=this.pointCoordinate(p),N=this.pointCoordinate(I);v=k.x-N.x,w=k.y-N.y}const P=this.locationCoordinate(u);this.setLocation(new h.MercatorCoordinate(P.x-v,P.y-w))}setLocation(u){this.center=this.coordinateLocation(u),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(u){return this.projection.locationPoint(this,u)}locationPoint3D(u){return this.projection.locationPoint(this,u,!0)}pointLocation(u){return this.coordinateLocation(this.pointCoordinate(u))}pointLocation3D(u){return this.coordinateLocation(this.pointCoordinate3D(u))}locationCoordinate(u,p){const v=p?h.mercatorZfromAltitude(p,u.lat):void 0,w=this.projection.project(u.lng,u.lat);return new h.MercatorCoordinate(w.x,w.y,v)}coordinateLocation(u){return this.projection.unproject(u.x,u.y)}pointRayIntersection(u,p){const v=p??this._centerAltitude,w=[u.x,u.y,0,1],I=[u.x,u.y,1,1];h.transformMat4$1(w,w,this.pixelMatrixInverse),h.transformMat4$1(I,I,this.pixelMatrixInverse);const P=I[3];h.scale$1(w,w,1/w[3]),h.scale$1(I,I,1/P);const k=w[2],N=I[2];return{p0:w,p1:I,t:k===N?0:(v-k)/(N-k)}}screenPointToMercatorRay(u){const p=[u.x,u.y,0,1],v=[u.x,u.y,1,1];return h.transformMat4$1(p,p,this.pixelMatrixInverse),h.transformMat4$1(v,v,this.pixelMatrixInverse),h.scale$1(p,p,1/p[3]),h.scale$1(v,v,1/v[3]),p[2]=h.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,v[2]=h.mercatorZfromAltitude(v[2],this._center.lat)*this.worldSize,h.scale$1(p,p,1/this.worldSize),h.scale$1(v,v,1/this.worldSize),new h.Ray([p[0],p[1],p[2]],h.normalize([],h.sub([],v,p)))}rayIntersectionCoordinate(u){const{p0:p,p1:v,t:w}=u,I=h.mercatorZfromAltitude(p[2],this._center.lat),P=h.mercatorZfromAltitude(v[2],this._center.lat);return new h.MercatorCoordinate(h.number(p[0],v[0],w)/this.worldSize,h.number(p[1],v[1],w)/this.worldSize,h.number(I,P,w))}pointCoordinate(u,p=this._centerAltitude){return this.projection.pointCoordinate(this,u.x,u.y,p)}pointCoordinate3D(u){if(!this.elevation)return this.pointCoordinate(u);let p=this.projection.pointCoordinate3D(this,u.x,u.y);if(p)return new h.MercatorCoordinate(p[0],p[1],p[2]);let v=0,w=this.horizonLineFromTop();if(u.y>w)return this.pointCoordinate(u);const I=.02*w,P=u.clone();for(let k=0;k<10&&w-v>I;k++){P.y=h.number(v,w,.66);const N=this.projection.pointCoordinate3D(this,P.x,P.y);N?(w=P.y,p=N):v=P.y}return p?new h.MercatorCoordinate(p[0],p[1],p[2]):this.pointCoordinate(u)}isPointAboveHorizon(u){return this.projection.isPointAboveHorizon(this,u)}isPointOnSurface(u){if(u.y<0||u.y>this.height||u.x<0||u.x>this.width)return!1;if(this.elevation||this.zoom>=h.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(u);const p=this.pointCoordinate(u);return p.y>=0&&p.y<=1}_coordinatePoint(u,p){const v=p&&this.elevation?this.elevation.getAtPointOrZero(u,this._centerAltitude):this._centerAltitude,w=[u.x*this.worldSize,u.y*this.worldSize,v+u.toAltitude(),1];return h.transformMat4$1(w,w,this.pixelMatrix),w[3]>0?new h.Point(w[0]/w[3],w[1]/w[3]):new h.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:u,left:p}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,I=this.pointLocation3D(new h.Point(p,u)),P=this.pointLocation3D(new h.Point(w,u)),k=this.pointLocation3D(new h.Point(w,v)),N=this.pointLocation3D(new h.Point(p,v));let U=Math.min(I.lng,P.lng,k.lng,N.lng),z=Math.max(I.lng,P.lng,k.lng,N.lng),q=Math.min(I.lat,P.lat,k.lat,N.lat),le=Math.max(I.lat,P.lat,k.lat,N.lat);const ye=Math.pow(2,-this.zoom)/16*270,be="globe"===this.projection.name?1:4,ve=(we,K,de,Ae,Se)=>{const Ge=(we+de)/2,Ye=(K+Ae)/2,Xe=new h.Point(Ge,Ye),{lng:ct,lat:st}=this.pointLocation3D(Xe),Ct=Math.max(0,U-ct,q-st,ct-z,st-le);U=Math.min(U,ct),z=Math.max(z,ct),q=Math.min(q,st),le=Math.max(le,st),(Se<be||Ct>ye)&&(ve(we,K,Ge,Ye,Se+1),ve(Ge,Ye,de,Ae,Se+1))};if(ve(p,u,w,u,1),ve(w,u,w,v,1),ve(w,v,p,v,1),ve(p,v,p,u,1),"globe"===this.projection.name){const[we,K]=h.polesInViewport(this);we?(le=90,z=180,U=-180):K&&(q=-90,z=180,U=-180)}return new h.LngLatBounds(new h.LngLat(U,q),new h.LngLat(z,le))}_getBoundsRectangular(u,p){const{top:v,left:w}=this._edgeInsets,I=this.height-this._edgeInsets.bottom,P=this.width-this._edgeInsets.right,k=new h.Point(w,v),N=new h.Point(P,v),U=new h.Point(P,I),z=new h.Point(w,I);let q=this.pointCoordinate(k,u),le=this.pointCoordinate(N,u);const ye=this.pointCoordinate(U,p),be=this.pointCoordinate(z,p),ve=(we,K)=>(K.y-we.y)/(K.x-we.x);return q.y>1&&le.y>=0?q=new h.MercatorCoordinate((1-be.y)/ve(be,q)+be.x,1):q.y<0&&le.y<=1&&(q=new h.MercatorCoordinate(-be.y/ve(be,q)+be.x,0)),le.y>1&&q.y>=0?le=new h.MercatorCoordinate((1-ye.y)/ve(ye,le)+ye.x,1):le.y<0&&q.y<=1&&(le=new h.MercatorCoordinate(-ye.y/ve(ye,le)+ye.x,0)),(new h.LngLatBounds).extend(this.coordinateLocation(q)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(be)).extend(this.coordinateLocation(ye))}_getBoundsRectangularTerrain(){const u=this.elevation;if(!u.visibleDemTiles.length||u.isUsingMockSource())return this._getBoundsRectangular(0,0);const p=u.visibleDemTiles.reduce((v,w)=>{if(w.dem){const I=w.dem.tree;v.min=Math.min(v.min,I.minimums[0]),v.max=Math.max(v.max,I.maximums[0])}return v},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(p.min*u.exaggeration(),p.max*u.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(u=!0){const p=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,v=this.height/2-p*(1-this._horizonShift);return u?Math.max(0,v):v}getMaxBounds(){return this.maxBounds}setMaxBounds(u){this.maxBounds=u,this.minLat=-h.MAX_MERCATOR_LATITUDE,this.maxLat=h.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,u&&(this.minLat=u.getSouth(),this.maxLat=u.getNorth(),this.minLng=u.getWest(),this.maxLng=u.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=h.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=h.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=h.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=h.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(u,p){return this.projection.createTileMatrix(this,p,u)}calculateDistanceTileData(u){const p=u.key,v=this._distanceTileDataCache;if(v[p])return v[p];const w=u.canonical,I=1/this.height,P=this.cameraWorldSize,k=P/this.zoomScale(w.z),N=(w.x+Math.pow(2,w.z)*u.wrap)*k,U=w.y*k,z=this.point;z.x*=P/this.worldSize,z.y*=P/this.worldSize;const q=this.angle,le=Math.sin(-q),ye=-Math.cos(-q);return v[p]={bearing:[le,ye],center:[(z.x-N)*I,(z.y-U)*I],scale:k/h.EXTENT*I},v[p]}calculateFogTileMatrix(u){const p=u.key,v=this._fogTileMatrixCache;if(v[p])return v[p];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,u);return h.multiply(w,this.worldToFogMatrix,w),v[p]=new Float32Array(w),v[p]}calculateProjMatrix(u,p=!1){const v=u.key,w=p?this._alignedProjMatrixCache:this._projMatrixCache;if(w[v])return w[v];const I=this.calculatePosMatrix(u,this.worldSize);return h.multiply(I,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.alignedProjMatrix:this.projMatrix,I),w[v]=new Float32Array(I),w[v]}calculatePixelsToTileUnitsMatrix(u){const p=u.tileID.key,v=this._pixelsToTileUnitsCache;if(v[p])return v[p];const w=function(I,P){const{scale:k}=I.tileTransform,N=k*h.EXTENT/(I.tileSize*Math.pow(2,P.zoom-I.tileID.overscaledZ+I.tileID.canonical.z));return U=new Float32Array(4),le=(z=P.inverseAdjustmentMatrix)[1],ye=z[2],be=z[3],we=(q=[N,N])[1],U[0]=z[0]*(ve=q[0]),U[1]=le*ve,U[2]=ye*we,U[3]=be*we,U;var U,z,q,le,ye,be,ve,we}(u,this);return v[p]=w,v[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const u=1/this.worldSize,p=h.fromScaling([],[u,u,u]);return h.multiply(p,p,this.globeMatrix),p}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const u=this._elevation;this._updateCameraState();const p=h.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(p),w=this._camera.forward(),I=h.mercatorZfromAltitude(1,this._center.lat);v[2]/=I,w[2]/=I,h.normalize(w,w);const P=u.raycast(v,w,u.exaggeration());if(P){const k=h.scaleAndAdd([],v,w,P),N=new h.MercatorCoordinate(k[0],k[1],h.mercatorZfromAltitude(k[2],h.latFromMercatorY(k[1]))),U=(N.z+h.length([N.x-v[0],N.y-v[1],N.z-v[2]*I]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(U),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(u=!1){if(!this._elevation)return;const p=this._elevation,v=h.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(v),I=p.getAtPointOrZero(new h.MercatorCoordinate(...w)),P=this.pixelsPerMeter/this.worldSize*I,k=this._minimumHeightOverTerrain(),N=w[2]-P;if(N<=k)if(N<0||u){const U=this.locationCoordinate(this._center,this._centerAltitude),z=[w[0],w[1],U.z-w[2]],q=h.length(z);z[2]-=(k-N)/this._pixelsPerMercatorPixel;const le=h.length(z);if(0===le)return;h.scale$2(z,z,q/le*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],U.z*this._pixelsPerMercatorPixel-z[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const u="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||u){const le=this.center;return le.lat=h.clamp(le.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!u)&&(le.lng=h.clamp(le.lng,this.minLng,this.maxLng)),this.center=le,void(this._constraining=!1)}const p=this._unmodified,{x:v,y:w}=this.point;let I=0,P=v,k=w;const N=this.width/2,U=this.height/2,z=this.worldMinY*this.scale,q=this.worldMaxY*this.scale;if(w-U<z&&(k=z+U),w+U>q&&(k=q-U),q-z<this.height&&(I=Math.max(I,this.height/(q-z)),k=(q+z)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const le=this.worldMinX*this.scale,ye=this.worldMaxX*this.scale,be=this.worldSize/2-(le+ye)/2;P=(v+be+this.worldSize)%this.worldSize-be,P-N<le&&(P=le+N),P+N>ye&&(P=ye-N),ye-le<this.width&&(I=Math.max(I,this.width/(ye-le)),P=(ye+le)/2)}P===v&&k===w||(this.center=this.unproject(new h.Point(P,k))),I&&(this.zoom+=this.scaleZoom(I)),this._constrainCamera(),this._unmodified=p,this._constraining=!1}_minZoomForBounds(){let u=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(u=Math.max(u,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),u}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const u=this.centerOffset,p=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=h.mercatorZfromAltitude(1,this.center.lat)/h.mercatorZfromAltitude(1,h.GLOBE_SCALE_MATCH_LATITUDE));const v=Bu(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,v),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w="meters"===this.projection.zAxisUnit?p:1,I=this._camera.getWorldToCamera(this.worldSize,w),P=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);P[8]=2*-u.x/this.width,P[9]=2*u.y/this.height;let k=h.mul([],P,I);if(this.projection.isReprojectedInTileSpace){const Ye=this.locationCoordinate(this.center),Xe=h.identity([]);h.translate(Xe,Xe,[Ye.x*this.worldSize,Ye.y*this.worldSize,0]),h.multiply(Xe,Xe,Sd(this)),h.translate(Xe,Xe,[-Ye.x*this.worldSize,-Ye.y*this.worldSize,0]),h.multiply(k,k,Xe),this.inverseAdjustmentMatrix=function(ct){const st=Sd(ct,!0);return ze([],[st[0],st[1],st[4],st[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=h.scale([],k,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=k,this.invProjMatrix=h.invert(new Float64Array(16),this.projMatrix);const N=h.invert([],P);this.frustumCorners=h.FrustumCorners.fromInvProjectionMatrix(N,this.horizonLineFromTop(),this.height);const U=new Float32Array(16);h.identity(U),h.scale(U,U,[1,-1,1]),h.rotateX(U,U,this._pitch),h.rotateZ(U,U,this.angle);const z=h.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;z[8]=2*-u.x/this.width,z[9]=2*(u.y+q)/this.height,this.skyboxMatrix=h.multiply(U,z,U);const le=this.point,ye=le.x,be=le.y,ve=this.width%2/2,we=this.height%2/2,K=Math.cos(this.angle),de=Math.sin(this.angle),Ae=ye-Math.round(ye)+K*ve+de*we,Se=be-Math.round(be)+K*we+de*ve,Ge=new Float64Array(k);if(h.translate(Ge,Ge,[Ae>.5?Ae-1:Ae,Se>.5?Se-1:Se,0]),this.alignedProjMatrix=Ge,k=h.create(),h.scale(k,k,[this.width/2,-this.height/2,1]),h.translate(k,k,[1,-1,0]),this.labelPlaneMatrix=k,k=h.create(),h.scale(k,k,[1,-1,1]),h.translate(k,k,[-1,-1,0]),h.scale(k,k,[2/this.width,2/this.height,1]),this.glCoordMatrix=k,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},k=h.invert(new Float64Array(16),this.pixelMatrix),!k)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=k,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=h.calculateGlobeMatrix(this);const Ye=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=h.transformMat4(Ye,Ye,I),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=k;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const u=this.cameraWorldSizeForFog,p=this.cameraPixelsPerMeter,v=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,I=[u,u,p];h.scale$2(I,I,w),h.scale$2(v,v,-1),h.multiply$2(v,v,I);const P=h.create();h.translate(P,P,v),h.scale(P,P,I),this.mercatorFogMatrix=P,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(u,p,w)}_computeCameraPosition(u){const p=(u=u||this.pixelsPerMeter)/this.pixelsPerMeter,v=this._camera.forward(),w=this.point,I=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*p-u/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-v[0]*I,w.y/this.worldSize-v[1]*I,u/this.worldSize*this._centerAltitude-v[2]*I]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(u){const p=this._maxCameraBoundsDistance()*Math.cos(this._pitch),v=this._camera.position[2],w=u[2];let I=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(I=Math.min((p-v)/w,1)),this._camera.position=h.scaleAndAdd([],this._camera.position,u,I),this._updateStateFromCamera()}_updateStateFromCamera(){const u=this._camera.position,p=this._camera.forward(),{pitch:v,bearing:w}=this._camera.getPitchBearing(),I=h.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,P=this._mercatorZfromZoom(this._maxZoom)*Math.cos(h.degToRad(this._maxPitch)),k=Math.max((u[2]-I)/Math.cos(v),P),N=this._zoomFromMercatorZ(k);h.scaleAndAdd(u,u,p,k),this._pitch=h.clamp(v,h.degToRad(this.minPitch),h.degToRad(this.maxPitch)),this.angle=h.wrap(w,-Math.PI,Math.PI),this._setZoom(h.clamp(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new h.MercatorCoordinate(u[0],u[1],u[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(u){return Math.pow(2,u)*this.tileSize}_mercatorZfromZoom(u){return this.cameraToCenterDistance/this._worldSizeFromZoom(u)}_minimumHeightOverTerrain(){const u=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(u)}_zoomFromMercatorZ(u){return this.scaleZoom(this.cameraToCenterDistance/(u*this.tileSize))}zoomFromMercatorZAdjusted(u){let p=0,v=h.GLOBE_ZOOM_THRESHOLD_MAX,w=0,I=1/0;for(;v-p>1e-6&&v>p;){const P=p+.5*(v-p),k=this.tileSize*Math.pow(2,P),N=this.getCameraToCenterDistance(this.projection,P,k),U=this.scaleZoom(N/(u*this.tileSize)),z=Math.abs(P-U);z<I&&(I=z,w=P),P<U?p=P:v=P}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(h.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(u,p){const v=Math.min(u.x,p.x),w=Math.max(u.x,p.x),I=Math.min(u.y,p.y),P=Math.max(u.y,p.y);if(I<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const k=[new h.Point(v,I),new h.Point(w,P),new h.Point(v,P),new h.Point(w,I)],N=this.renderWorldCopies?-3:0,U=this.renderWorldCopies?4:1;for(const z of k){const q=this.pointRayIntersection(z);if(q.t<0)return!0;const le=this.rayIntersectionCoordinate(q);if(le.x<N||le.y<0||le.x>U||le.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+h.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new h.Point(0,0),new h.Point(this.width,this.height))}zoomDeltaToMovement(u,p){const v=h.length(h.sub([],this._camera.position,u)),w=this._zoomFromMercatorZ(v)+p;return v-this._mercatorZfromZoom(w)}getCameraPoint(){if("globe"===this.projection.name){const u=function([p,v,w],I){const P=[p,v,w,1];h.transformMat4$1(P,P,I);const k=P[3]=Math.max(P[3],1e-6);return P[0]/=k,P[1]/=k,P[2]/=k,P}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new h.Point(u[0],u[1])}{const u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.Point(0,u))}}getCameraToCenterDistance(u,p=this.zoom,v=this.worldSize){const w=Bu(u,p,this.width,this.height,1024),I=u.pixelSpaceConversion(this.center.lat,v,w);return.5/Math.tan(.5*this._fov)*this.height*I}getWorldToCameraMatrix(){const u=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&h.multiply(u,u,this.globeMatrix),u}}function To(_,u){let p=!1,v=null;const w=()=>{v=null,p&&(_(),v=setTimeout(w,u),p=!1)};return()=>(p=!0,v||w(),v)}class kg{constructor(u){this._hashName=u&&encodeURIComponent(u),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=To(this._updateHashUnthrottled.bind(this),300)}addTo(u){return this._map=u,h.window.addEventListener("hashchange",this._onHashChange,!1),u.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),h.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const u=this._map;if(!u)return"";const p=xs(u);if(this._hashName){const v=this._hashName;let w=!1;const I=h.window.location.hash.slice(1).split("&").map(P=>{const k=P.split("=")[0];return k===v?(w=!0,`${k}=${p}`):P}).filter(P=>P);return w||I.push(`${v}=${p}`),`#${I.join("&")}`}return`#${p}`}_getCurrentHash(){const u=h.window.location.hash.replace("#","");if(this._hashName){let p;return u.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(p=v)}),(p&&p[1]||"").split("/")}return u.split("/")}_onHashChange(){const u=this._map;if(!u)return!1;const p=this._getCurrentHash();if(p.length>=3&&!p.some(v=>isNaN(v))){const v=u.dragRotate.isEnabled()&&u.touchZoomRotate.isEnabled()?+(p[3]||0):u.getBearing();return u.jumpTo({center:[+p[2],+p[1]],zoom:+p[0],bearing:v,pitch:+(p[4]||0)}),!0}return!1}_updateHashUnthrottled(){const u=h.window.location.href.replace(/(#.+)?$/,this.getHashString());h.window.history.replaceState(h.window.history.state,null,u)}}function xs(_,u){const p=_.getCenter(),v=Math.round(100*_.getZoom())/100,w=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),I=Math.pow(10,w),P=Math.round(p.lng*I)/I,k=Math.round(p.lat*I)/I,N=_.getBearing(),U=_.getPitch();let z=u?`/${P}/${k}/${v}`:`${v}/${k}/${P}`;return(N||U)&&(z+="/"+Math.round(10*N)/10),U&&(z+=`/${Math.round(U)}`),z}const cs={linearity:.3,easing:h.bezier(0,0,.3,1)},gc=h.extend({deceleration:2500,maxSpeed:1400},cs),gl=h.extend({deceleration:20,maxSpeed:1400},cs),Tn=h.extend({deceleration:1e3,maxSpeed:360},cs),Bo=h.extend({deceleration:1e3,maxSpeed:90},cs);class Nf{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.exported.now(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,p=h.exported.now();for(;u.length>0&&p-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const p={zoom:0,bearing:0,pitch:0,pan:new h.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:I}of this._inertiaBuffer)p.zoom+=I.zoomDelta||0,p.bearing+=I.bearingDelta||0,p.pitch+=I.pitchDelta||0,I.panDelta&&p.pan._add(I.panDelta),I.around&&(p.around=I.around),I.pinchAround&&(p.pinchAround=I.pinchAround);const v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(p.pan.mag()){const I=vh(p.pan.mag(),v,h.extend({},gc,u||{}));w.offset=p.pan.mult(I.amount/p.pan.mag()),w.center=this._map.transform.center,yh(w,I)}if(p.zoom){const I=vh(p.zoom,v,gl);w.zoom=this._map.transform.zoom+I.amount,yh(w,I)}if(p.bearing){const I=vh(p.bearing,v,Tn);w.bearing=this._map.transform.bearing+h.clamp(I.amount,-179,179),yh(w,I)}if(p.pitch){const I=vh(p.pitch,v,Bo);w.pitch=this._map.transform.pitch+I.amount,yh(w,I)}if(w.zoom||w.bearing){const I=void 0===p.pinchAround?p.around:p.pinchAround;w.around=I?this._map.unproject(I):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function yh(_,u){(!_.duration||_.duration<u.duration)&&(_.duration=u.duration,_.easing=u.easing)}function vh(_,u,p){const{maxSpeed:v,linearity:w,deceleration:I}=p,P=h.clamp(_*w/(u/1e3),-v,v),k=Math.abs(P)/(I*w);return{easing:p.easing,duration:1e3*k,amount:P*(k/2)}}class Ms extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,v,w={}){const I=Ie(p.getCanvasContainer(),v),P=p.unproject(I);super(u,h.extend({point:I,lngLat:P,originalEvent:v},w)),this._defaultPrevented=!1,this.target=p}}class xh extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,v){const w="touchend"===u?v.changedTouches:v.touches,I=Le(p.getCanvasContainer(),w),P=I.map(N=>p.unproject(N)),k=I.reduce((N,U,z,q)=>N.add(U.div(q.length)),new h.Point(0,0));super(u,{points:I,point:k,lngLats:P,lngLat:p.unproject(k),originalEvent:v}),this._defaultPrevented=!1}}class Vu extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,p,v){super(u,{originalEvent:v}),this._defaultPrevented=!1}}class _c{constructor(u,p){this._map=u,this._clickTolerance=p.clickTolerance}reset(){this._mousedownPos=void 0}wheel(u){return this._firePreventable(new Vu(u.type,this._map,u))}mousedown(u,p){return this._mousedownPos=p,this._firePreventable(new Ms(u.type,this._map,u))}mouseup(u){this._map.fire(new Ms(u.type,this._map,u))}preclick(u){const p=h.extend({},u);p.type="preclick",this._map.fire(new Ms(p.type,this._map,p))}click(u,p){this._mousedownPos&&this._mousedownPos.dist(p)>=this._clickTolerance||(this.preclick(u),this._map.fire(new Ms(u.type,this._map,u)))}dblclick(u){return this._firePreventable(new Ms(u.type,this._map,u))}mouseover(u){this._map.fire(new Ms(u.type,this._map,u))}mouseout(u){this._map.fire(new Ms(u.type,this._map,u))}touchstart(u){return this._firePreventable(new xh(u.type,this._map,u))}touchmove(u){this._map.fire(new xh(u.type,this._map,u))}touchend(u){this._map.fire(new xh(u.type,this._map,u))}touchcancel(u){this._map.fire(new xh(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Pd{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(u){this._map.fire(new Ms(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ms("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new Ms(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rg{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=p.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,p){this.isEnabled()&&u.shiftKey&&0===u.button&&(ke(),this._startPos=this._lastPos=p,this._active=!0)}mousemoveWindow(u,p){if(!this._active)return;const v=p,w=this._startPos,I=this._lastPos;if(!w||!I||I.equals(v)||!this._box&&v.dist(w)<this._clickTolerance)return;this._lastPos=v,this._box||(this._box=ce("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));const P=Math.min(w.x,v.x),k=Math.max(w.x,v.x),N=Math.min(w.y,v.y),U=Math.max(w.y,v.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${P}px,${N}px)`,this._box.style.width=k-P+"px",this._box.style.height=U-N+"px")})}mouseupWindow(u,p){if(!this._active)return;const v=this._startPos,w=p;if(v&&0===u.button){if(this.reset(),tt(),v.x!==w.x||v.y!==w.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:u})),{cameraAnimation:I=>I.fitScreenCoordinates(v,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",u)}}keydown(u){this._active&&27===u.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",u))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),$e(),delete this._startPos,delete this._lastPos}_fireEvent(u,p){return this._map.fire(new h.Event(u,{originalEvent:p}))}}function Bf(_,u){const p={};for(let v=0;v<_.length;v++)p[_[v].identifier]=u[v];return p}class kd{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(u,p,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=u.timeStamp),v.length===this.numTouches&&(this.centroid=function(w){const I=new h.Point(0,0);for(const P of w)I._add(P);return I.div(w.length)}(p),this.touches=Bf(v,p)))}touchmove(u,p,v){if(this.aborted||!this.centroid)return;const w=Bf(v,p);for(const I in this.touches){const P=w[I];(!P||P.dist(this.touches[I])>30)&&(this.aborted=!0)}}touchend(u,p,v){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),0===v.length){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class Og{constructor(u){this.singleTap=new kd(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(u,p,v){this.singleTap.touchstart(u,p,v)}touchmove(u,p,v){this.singleTap.touchmove(u,p,v)}touchend(u,p,v){const w=this.singleTap.touchend(u,p,v);if(w){const I=u.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(w)<30;if(I&&P||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class E0{constructor(){this._zoomIn=new Og({numTouches:1,numTaps:2}),this._zoomOut=new Og({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,p,v){this._zoomIn.touchstart(u,p,v),this._zoomOut.touchstart(u,p,v)}touchmove(u,p,v){this._zoomIn.touchmove(u,p,v),this._zoomOut.touchmove(u,p,v)}touchend(u,p,v){const w=this._zoomIn.touchend(u,p,v),I=this._zoomOut.touchend(u,p,v);return w?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(w)},{originalEvent:u})}):I?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(I)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Fg={0:1,2:2};class Kc{constructor(u){this.reset(),this._clickTolerance=u.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(u,p){return!1}_move(u,p){return{}}mousedown(u,p){if(this._lastPoint)return;const v=mt(u);this._correctButton(u,v)&&(this._lastPoint=p,this._eventButton=v)}mousemoveWindow(u,p){const v=this._lastPoint;if(v)if(u.preventDefault(),null!=this._eventButton&&function(w,I){const P=Fg[I];return void 0===w.buttons||(w.buttons&P)!==P}(u,this._eventButton))this.reset();else if(this._moved||!(p.dist(v)<this._clickTolerance))return this._moved=!0,this._lastPoint=p,this._move(v,p)}mouseupWindow(u){this._lastPoint&&mt(u)===this._eventButton&&(this._moved&&tt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bh extends Kc{mousedown(u,p){super.mousedown(u,p),this._lastPoint&&(this._active=!0)}_correctButton(u,p){return 0===p&&!u.ctrlKey}_move(u,p){return{around:p,panDelta:p.sub(u)}}}class Kp extends Kc{_correctButton(u,p){return 0===p&&u.ctrlKey||2===p}_move(u,p){const v=.8*(p.x-u.x);if(v)return this._active=!0,{bearingDelta:v}}contextmenu(u){u.preventDefault()}}class Rd extends Kc{_correctButton(u,p){return 0===p&&u.ctrlKey||2===p}_move(u,p){const v=-.5*(p.y-u.y);if(v)return this._active=!0,{pitchDelta:v}}contextmenu(u){u.preventDefault()}}class zu{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._minTouches=1,this._clickTolerance=p.clickTolerance||1,this.reset(),h.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new h.Point(0,0)}touchstart(u,p,v){return this._calculateTransform(u,p,v)}touchmove(u,p,v){if(this._active&&!(v.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===v.length&&!h.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return u.cancelable&&u.preventDefault(),this._calculateTransform(u,p,v)}}touchend(u,p,v){this._calculateTransform(u,p,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,p,v){v.length>0&&(this._active=!0);const w=Bf(v,p),I=new h.Point(0,0),P=new h.Point(0,0);let k=0;for(const U in w){const z=w[U],q=this._touches[U];q&&(I._add(z),P._add(z.sub(q)),k++,w[U]=z)}if(this._touches=w,k<this._minTouches||!P.mag())return;const N=P.div(k);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:I.div(k),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ce("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Uu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(u){}_move(u,p,v){return{}}touchstart(u,p,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([p[0],p[1]]))}touchmove(u,p,v){const w=this._firstTwoTouches;if(!w)return;u.preventDefault();const[I,P]=w,k=wh(v,p,I),N=wh(v,p,P);if(!k||!N)return;const U=this._aroundCenter?null:k.add(N).div(2);return this._move([k,N],U,u)}touchend(u,p,v){if(!this._firstTwoTouches)return;const[w,I]=this._firstTwoTouches,P=wh(v,p,w),k=wh(v,p,I);P&&k||(this._active&&tt(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&"center"===u.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function wh(_,u,p){for(let v=0;v<_.length;v++)if(_[v].identifier===p)return u[v]}function Yp(_,u){return Math.log(_/u)/Math.LN2}class C0 extends Uu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,p){const v=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(Yp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Yp(this._distance,v),pinchAround:p}}}function _l(_,u){return 180*_.angleWith(u)/Math.PI}class yc extends Uu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,p){const v=this._vector;if(this._vector=u[0].sub(u[1]),v&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:_l(this._vector,v),pinchAround:p}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const p=25/(Math.PI*this._minDiameter)*360,v=this._startVector;if(!v)return!1;const w=_l(u,v);return Math.abs(w)<p}}function $l(_){return Math.abs(_.y)>Math.abs(_.x)}class Lg extends Uu{constructor(u){super(),this._map=u}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(u){this._lastPoints=u,$l(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,p,v){const w=this._lastPoints;if(!w)return;const I=u[0].sub(w[0]),P=u[1].sub(w[1]);return this._map._cooperativeGestures&&!h.isFullscreen()&&v.touches.length<3||(this._valid=this.gestureBeginsVertically(I,P,v.timeStamp),!this._valid)?void 0:(this._lastPoints=u,this._active=!0,{pitchDelta:(I.y+P.y)/2*-.5})}gestureBeginsVertically(u,p,v){if(void 0!==this._valid)return this._valid;const w=u.mag()>=2,I=p.mag()>=2;if(!w&&!I)return;if(!w||!I)return null==this._firstMove&&(this._firstMove=v),v-this._firstMove<100&&void 0;const P=u.y>0==p.y>0;return $l(u)&&$l(p)&&P}}const us={panStep:100,bearingStep:15,pitchStep:10};class vc{constructor(){const u=us;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let p=0,v=0,w=0,I=0,P=0;switch(u.keyCode){case 61:case 107:case 171:case 187:p=1;break;case 189:case 109:case 173:p=-1;break;case 37:u.shiftKey?v=-1:(u.preventDefault(),I=-1);break;case 39:u.shiftKey?v=1:(u.preventDefault(),I=1);break;case 38:u.shiftKey?w=1:(u.preventDefault(),P=-1);break;case 40:u.shiftKey?w=-1:(u.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(v=0,w=0),{cameraAnimation:k=>{const N=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:ga,zoom:p?Math.round(N)+p*(u.shiftKey?2:1):N,bearing:k.getBearing()+v*this._bearingStep,pitch:k.getPitch()+w*this._pitchStep,offset:[-I*this._panStep,-P*this._panStep],center:k.getCenter()},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ga(_){return _*(2-_)}const mo=4.000244140625;class Vf{constructor(u,p){this._map=u,this._el=u.getCanvasContainer(),this._handler=p,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,h.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&"center"===u.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(u){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(u.ctrlKey||u.metaKey||this.isZooming()||h.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let p=u.deltaMode===h.window.WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const v=h.exported.now(),w=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,0!==p&&p%mo==0?this._type="wheel":0!==p&&Math.abs(p)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=p,this._timeout=setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(w*p)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,p+=this._lastValue)),u.shiftKey&&p&&(p/=4),this._type&&(this._lastWheelEvent=u,this._delta-=p,this._active||this._start(u)),u.preventDefault()}_onTimeout(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const p=Ie(this._el,u);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:p,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._map.transform;"wheel"===this._type&&u.projection.wrap&&(u._center.lng>=180||u._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const p=()=>u._terrainEnabled()&&this._aroundCoord?u.computeZoomRelativeTo(this._aroundCoord):u.zoom;if(0!==this._delta){const N="wheel"===this._type&&Math.abs(this._delta)>mo?this._wheelZoomRate:this._defaultZoomRate;let U=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&0!==U&&(U=1/U);const z=p(),q=Math.pow(2,z),le="number"==typeof this._targetZoom?u.zoomScale(this._targetZoom):q;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(le*U))),"wheel"===this._type&&(this._startZoom=z,this._easing=this._smoothOutEasing(200)),this._delta=0}const v="number"==typeof this._targetZoom?this._targetZoom:p(),w=this._startZoom,I=this._easing;let P,k=!1;if("wheel"===this._type&&w&&I){const N=Math.min((h.exported.now()-this._lastWheelEventTime)/200,1),U=I(N);P=h.number(w,v,U),N<1?this._frameId||(this._frameId=!0):k=!0}else P=v,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!k,zoomDelta:P-p(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let p=h.ease;if(this._prevEase){const v=this._prevEase,w=(h.exported.now()-v.start)/v.duration,I=v.easing(w+.01)-v.easing(w),P=.27/Math.sqrt(I*I+1e-4)*.01,k=Math.sqrt(.0729-P*P);p=h.bezier(P,k,.25,1)}return this._prevEase={start:h.exported.now(),duration:u,easing:p},p}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ce("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(h.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Od{constructor(u,p){this._clickZoom=u,this._tapZoom=p}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class bs{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(u,p){return u.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:v.getZoom()+(u.shiftKey?-1:1),around:v.unproject(p)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fd{constructor(){this._tap=new Og({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(u,p,v){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?v.length>0&&(this._swipePoint=p[0],this._swipeTouch=v[0].identifier):this._tap.touchstart(u,p,v))}touchmove(u,p,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;const w=p[0],I=w.y-this._swipePoint.y;return this._swipePoint=w,u.preventDefault(),this._active=!0,{zoomDelta:I/128}}}else this._tap.touchmove(u,p,v)}touchend(u,p,v){this._tapTime?this._swipePoint&&0===v.length&&this.reset():this._tap.touchend(u,p,v)&&(this._tapTime=u.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zf{constructor(u,p,v){this._el=u,this._mousePan=p,this._touchPan=v}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Uf{constructor(u,p,v){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=p,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Eh{constructor(u,p,v,w){this._el=u,this._touchZoom=p,this._touchRotate=v,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const _a=_=>_.zoom||_.drag||_.pitch||_.rotate;class ju extends h.Event{}class jf{constructor(){this.constants=[1,1,.01],this.radius=0}setup(u,p){const v=h.sub([],p,u);this.radius=h.length(v[2]<0?h.div([],v,this.constants):[v[0],v[1],0])}projectRay(u){h.div(u,u,this.constants),h.normalize(u,u),h.mul$1(u,u,this.constants);const p=h.scale$2([],u,this.radius);if(p[2]>0){const v=h.scale$2([],[0,0,1],h.dot(p,[0,0,1])),w=h.scale$2([],h.normalize([],[p[0],p[1],0]),this.radius),I=h.add([],p,h.scale$2([],h.sub([],h.add([],w,v),p),2));p[0]=I[0],p[1]=I[1]}return p}}function ds(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class ws{constructor(u,p){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Nf(u),this._bearingSnap=p.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new jf,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(p),h.bindAll(["handleEvent","handleWindowEvent"],this);const v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[h.window.document,"mousemove",{capture:!0}],[h.window.document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[h.window,"blur",void 0]];for(const[w,I,P]of this._listeners)w.addEventListener(I,w===h.window.document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[u,p,v]of this._listeners)u.removeEventListener(p,u===h.window.document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(u){const p=this._map,v=p.getCanvasContainer();this._add("mapEvent",new _c(p,u));const w=p.boxZoom=new Rg(p,u);this._add("boxZoom",w);const I=new E0,P=new bs;p.doubleClickZoom=new Od(P,I),this._add("tapZoom",I),this._add("clickZoom",P);const k=new Fd;this._add("tapDragZoom",k);const N=p.touchPitch=new Lg(p);this._add("touchPitch",N);const U=new Kp(u),z=new Rd(u);p.dragRotate=new Uf(u,U,z),this._add("mouseRotate",U,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const q=new bh(u),le=new zu(p,u);p.dragPan=new zf(v,q,le),this._add("mousePan",q),this._add("touchPan",le,["touchZoom","touchRotate"]);const ye=new yc,be=new C0;p.touchZoomRotate=new Eh(v,be,ye,k),this._add("touchRotate",ye,["touchPan","touchZoom"]),this._add("touchZoom",be,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Pd(p));const ve=p.scrollZoom=new Vf(p,this);this._add("scrollZoom",ve,["mousePan"]);const we=p.keyboard=new vc;this._add("keyboard",we);for(const K of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])u.interactive&&u[K]&&p[K].enable(u[K])}_add(u,p,v){this._handlers.push({handlerName:u,handler:p,allowed:v}),this._handlersById[u]=p}stop(u){if(!this._updatingCamera){for(const{handler:p}of this._handlers)p.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[]}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_a(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(u,p,v){for(const w in u)if(w!==v&&(!p||p.indexOf(w)<0))return!0;return!1}handleWindowEvent(u){this.handleEvent(u,`${u.type}Window`)}_getMapTouches(u){const p=[];for(const v of u)this._el.contains(v.target)&&p.push(v);return p}handleEvent(u,p){this._updatingCamera=!0;const v="renderFrame"===u.type,w=v?void 0:u,I={needsRenderFrame:!1},P={},k={},N=u.touches?this._getMapTouches(u.touches):void 0,U=N?Le(this._el,N):v?void 0:Ie(this._el,u);for(const{handlerName:le,handler:ye,allowed:be}of this._handlers){if(!ye.isEnabled())continue;let ve;this._blockedByActive(k,be,le)?ye.reset():ye[p||u.type]&&(ve=ye[p||u.type](u,U,N),this.mergeHandlerResult(I,P,ve,le,w),ve&&ve.needsRenderFrame&&this._triggerRenderFrame()),(ve||ye.isActive())&&(k[le]=ye)}const z={};for(const le in this._previousActiveHandlers)k[le]||(z[le]=w);this._previousActiveHandlers=k,(Object.keys(z).length||ds(I))&&(this._changes.push([I,P,z]),this._triggerRenderFrame()),(Object.keys(k).length||ds(I))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=I;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))}mergeHandlerResult(u,p,v,w,I){if(!v)return;h.extend(u,v);const P={handlerName:w,originalEvent:v.originalEvent||I};void 0!==v.zoomDelta&&(p.zoom=P),void 0!==v.panDelta&&(p.drag=P),void 0!==v.pitchDelta&&(p.pitch=P),void 0!==v.bearingDelta&&(p.rotate=P)}_applyChanges(){const u={},p={},v={};for(const[w,I,P]of this._changes)w.panDelta&&(u.panDelta=(u.panDelta||new h.Point(0,0))._add(w.panDelta)),w.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+w.pitchDelta),void 0!==w.around&&(u.around=w.around),void 0!==w.aroundCoord&&(u.aroundCoord=w.aroundCoord),void 0!==w.pinchAround&&(u.pinchAround=w.pinchAround),w.noInertia&&(u.noInertia=w.noInertia),h.extend(p,I),h.extend(v,P);this._updateMapTransform(u,p,v),this._changes=[]}_updateMapTransform(u,p,v){const w=this._map,I=w.transform,P=de=>[de.x,de.y,de.z];if((de=>{const Ae=this._eventsInProgress.drag;return Ae&&!this._handlersById[Ae.handlerName].isActive()})()&&!ds(u)){const de=I.zoom;I.cameraElevationReference="sea",I.recenterOnTerrain(),I.cameraElevationReference="ground",de!==I.zoom&&this._map._update(!0)}if(I._isCameraConstrained&&w._stop(!0),!ds(u))return void this._fireEvents(p,v,!0);let{panDelta:k,zoomDelta:N,bearingDelta:U,pitchDelta:z,around:q,aroundCoord:le,pinchAround:ye}=u;I._isCameraConstrained&&(N>0&&(N=0),I._isCameraConstrained=!1),void 0!==ye&&(q=ye),(N||(de=>p.drag&&!this._eventsInProgress.drag)())&&q&&(this._dragOrigin=P(I.pointCoordinate3D(q)),this._trackingEllipsoid.setup(I._camera.position,this._dragOrigin)),I.cameraElevationReference="sea",w._stop(!0),q=q||w.transform.centerPoint,U&&(I.bearing+=U),z&&(I.pitch+=z),I._updateCameraState();const be=[0,0,0];if(k)if("mercator"===I.projection.name){const de=this._trackingEllipsoid.projectRay(I.screenPointToMercatorRay(q).dir),Ae=this._trackingEllipsoid.projectRay(I.screenPointToMercatorRay(q.sub(k)).dir);be[0]=Ae[0]-de[0],be[1]=Ae[1]-de[1]}else{const de=I.pointCoordinate(q);if("globe"===I.projection.name){k=k.rotate(-I.angle);const Ae=I._pixelsPerMercatorPixel/I.worldSize;be[0]=-k.x*h.mercatorScale(h.latFromMercatorY(de.y))*Ae,be[1]=-k.y*h.mercatorScale(I.center.lat)*Ae}else{const Ae=I.pointCoordinate(q.sub(k));de&&Ae&&(be[0]=Ae.x-de.x,be[1]=Ae.y-de.y)}}const ve=I.zoom,we=[0,0,0];if(N){const de=P(le||I.pointCoordinate3D(q)),Ae={dir:h.normalize([],h.sub([],de,I._camera.position))};if(Ae.dir[2]<0){const Se=I.zoomDeltaToMovement(de,N);h.scale$2(we,Ae.dir,Se)}}const K=h.add(be,be,we);I._translateCameraConstrained(K),N&&Math.abs(I.zoom-ve)>1e-4&&I.recenterOnTerrain(),I.cameraElevationReference="ground",this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(p,v,!0)}_fireEvents(u,p,v){const w=_a(this._eventsInProgress),I=_a(u),P={};for(const z in u){const{originalEvent:q}=u[z];this._eventsInProgress[z]||(P[`${z}start`]=q),this._eventsInProgress[z]=u[z]}!w&&I&&this._fireEvent("movestart",I.originalEvent);for(const z in P)this._fireEvent(z,P[z]);I&&this._fireEvent("move",I.originalEvent);for(const z in u){const{originalEvent:q}=u[z];this._fireEvent(z,q)}const k={};let N;for(const z in this._eventsInProgress){const{handlerName:q,originalEvent:le}=this._eventsInProgress[z];this._handlersById[q].isActive()||(delete this._eventsInProgress[z],N=p[q]||le,k[`${z}end`]=N)}for(const z in k)this._fireEvent(z,k[z]);const U=_a(this._eventsInProgress);if(v&&(w||I)&&!U){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=le=>0!==le&&-this._bearingSnap<le&&le<this._bearingSnap;z?(q(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:N})):(this._map.fire(new h.Event("moveend",{originalEvent:N})),q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(u,p){this._map.fire(new h.Event(u,p?{originalEvent:p}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(u=>{this._frameId=void 0,this.handleEvent(new ju("renderFrame",{timeStamp:u})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Pa="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Yc extends h.Evented{constructor(u,p){super(),this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=p.bearingSnap,this._respectPrefersReducedMotion=!1!==p.respectPrefersReducedMotion,h.bindAll(["_renderFrameCallback"],this)}getCenter(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(u,p){return this.jumpTo({center:u},p)}panBy(u,p,v){return u=h.Point.convert(u).mult(-1),this.panTo(this.transform.center,h.extend({offset:u},p),v)}panTo(u,p,v){return this.easeTo(h.extend({center:u},p),v)}getZoom(){return this.transform.zoom}setZoom(u,p){return this.jumpTo({zoom:u},p),this}zoomTo(u,p,v){return this.easeTo(h.extend({zoom:u},p),v)}zoomIn(u,p){return this.zoomTo(this.getZoom()+1,u,p),this}zoomOut(u,p){return this.zoomTo(this.getZoom()-1,u,p),this}getBearing(){return this.transform.bearing}setBearing(u,p){return this.jumpTo({bearing:u},p),this}getPadding(){return this.transform.padding}setPadding(u,p){return this.jumpTo({padding:u},p),this}rotateTo(u,p,v){return this.easeTo(h.extend({bearing:u},p),v)}resetNorth(u,p){return this.rotateTo(0,h.extend({duration:1e3},u),p),this}resetNorthPitch(u,p){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},u),p),this}snapToNorth(u,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,p):this}getPitch(){return this.transform.pitch}setPitch(u,p){return this.jumpTo({pitch:u},p),this}cameraForBounds(u,p){u=h.LngLatBounds.convert(u);const v=p&&p.bearing||0,w=p&&p.pitch||0,I=u.getNorthWest(),P=u.getSouthEast();return this._cameraForBounds(this.transform,I,P,v,w,p)}_extendCameraOptions(u){const p={top:0,bottom:0,right:0,left:0};if("number"==typeof(u=h.extend({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding){const v=u.padding;u.padding={top:v,bottom:v,right:v,left:v}}return u.padding=h.extend(p,u.padding),u}_minimumAABBFrustumDistance(u,p){const v=p.max[0]-p.min[0],w=p.max[1]-p.min[1];return v/w>u.aspect?v/(2*Math.tan(.5*u.fovX)*u.aspect):w/(2*Math.tan(.5*u.fovY)*u.aspect)}_cameraForBoundsOnGlobe(u,p,v,w,I,P){const k=u.clone(),N=this._extendCameraOptions(P);k.bearing=w,k.pitch=I;const U=h.LngLat.convert(p),z=h.LngLat.convert(v),q=.5*(U.lat+z.lat),le=.5*(U.lng+z.lng),ye=h.latLngToECEF(q,le),be=h.normalize([],ye),ve=h.normalize([],h.cross([],be,[0,1,0])),we=h.cross([],ve,be),K=[ve[0],ve[1],ve[2],0,we[0],we[1],we[2],0,be[0],be[1],be[2],0,0,0,0,1],de=[ye,h.latLngToECEF(U.lat,U.lng),h.latLngToECEF(z.lat,U.lng),h.latLngToECEF(z.lat,z.lng),h.latLngToECEF(U.lat,z.lng),h.latLngToECEF(q,U.lng),h.latLngToECEF(q,z.lng),h.latLngToECEF(U.lat,le),h.latLngToECEF(z.lat,le)];let Ae=h.Aabb.fromPoints(de.map(Zt=>[h.dot(ve,Zt),h.dot(we,Zt),h.dot(be,Zt)]));const Se=h.transformMat4([],Ae.center,K);0===h.squaredLength(Se)&&h.set(Se,0,0,1),h.normalize(Se,Se),h.scale$2(Se,Se,h.GLOBE_RADIUS),k.center=h.ecefToLatLng(Se);const Ge=k.getWorldToCameraMatrix(),Ye=h.invert(new Float64Array(16),Ge);Ae=h.Aabb.applyTransform(Ae,h.multiply([],Ge,K)),h.transformMat4(Se,Se,Ge);const Xe=.5*(Ae.max[2]-Ae.min[2]),ct=this._minimumAABBFrustumDistance(k,Ae),st=h.scale$2([],[0,0,1],Xe),Ct=h.add(st,Se,st),rn=ct+(0===k.pitch?0:h.distance(Se,Ct)),_t=k.globeCenterInViewSpace,zt=h.sub([],Se,[_t[0],_t[1],_t[2]]);h.normalize(zt,zt),h.scale$2(zt,zt,rn);const Dt=h.add([],Se,zt);h.transformMat4(Dt,Dt,Ye);const en=h.earthRadius/h.GLOBE_RADIUS,vt=h.length(Dt),Ut=h.mercatorZfromAltitude(Math.max(vt*en-h.earthRadius,Number.EPSILON),0),sn=Math.min(k.zoomFromMercatorZAdjusted(Ut),N.maxZoom);return sn>.5*(h.GLOBE_ZOOM_THRESHOLD_MIN+h.GLOBE_ZOOM_THRESHOLD_MAX)?(k.setProjection({name:"mercator"}),k.zoom=sn,this._cameraForBounds(k,p,v,w,I,P)):{center:k.center,zoom:sn,bearing:w,pitch:I}}queryTerrainElevation(u,p){const v=this.transform.elevation;return v?(p=h.extend({},{exaggerated:!0},p),v.getAtPoint(h.MercatorCoordinate.fromLngLat(u),null,p.exaggerated)):null}_cameraForBounds(u,p,v,w,I,P){if("globe"===u.projection.name)return this._cameraForBoundsOnGlobe(u,p,v,w,I,P);const k=u.clone(),N=this._extendCameraOptions(P),U=k.padding;k.bearing=w,k.pitch=I;const z=h.LngLat.convert(p),q=h.LngLat.convert(v),le=new h.LngLat(z.lng,q.lat),ye=new h.LngLat(q.lng,z.lat),be=k.project(z),ve=k.project(q),we=this.queryTerrainElevation(z),K=this.queryTerrainElevation(q),de=this.queryTerrainElevation(le),Ae=this.queryTerrainElevation(ye),Se=[[be.x,be.y,Math.min(we||0,K||0,de||0,Ae||0)],[ve.x,ve.y,Math.max(we||0,K||0,de||0,Ae||0)]];let Ge=h.Aabb.fromPoints(Se);const Ye=k.getWorldToCameraMatrix(),Xe=h.invert(new Float64Array(16),Ye);Ge=h.Aabb.applyTransform(Ge,Ye);const ct=h.sub([],Ge.max,Ge.min),st=U.left||0,Ct=U.right||0,rn=U.bottom||0,_t=U.top||0,{left:zt,right:Dt,top:en,bottom:vt}=N.padding,Ut=.5*(st+Ct),sn=.5*(_t+rn),Zt=Math.min(k.scaleZoom(k.scale*Math.min((k.width-(st+Ct+zt+Dt))/ct[0],(k.height-(rn+_t+vt+en))/ct[1])),N.maxZoom),Mt=k.scale/k.zoomScale(Zt);Ge=new h.Aabb([Ge.min[0]-(zt+Ut)*Mt,Ge.min[1]-(vt+sn)*Mt,Ge.min[2]],[Ge.max[0]+(Dt+Ut)*Mt,Ge.max[1]+(en+sn)*Mt,Ge.max[2]]);const Kn=.5*ct[2],pi=this._minimumAABBFrustumDistance(k,Ge),Ln=[0,0,1,0];h.transformMat4$1(Ln,Ln,Ye),h.normalize$2(Ln,Ln);const oi=h.scale$2([],Ln,pi+Kn),Ni=h.add([],Ge.center,oi),Si=("number"==typeof N.offset.x&&"number"==typeof N.offset.y?new h.Point(N.offset.x,N.offset.y):h.Point.convert(N.offset)).rotate(-h.degToRad(w));Ge.center[0]-=Si.x*Mt,Ge.center[1]+=Si.y*Mt,h.transformMat4(Ge.center,Ge.center,Xe),h.transformMat4(Ni,Ni,Xe);const Bn=[Ge.center[0],Ge.center[1],Ni[2]*k.pixelsPerMeter];h.scale$2(Bn,Bn,1/k.worldSize);const mr=h.lngFromMercatorX(Bn[0]),br=h.latFromMercatorY(Bn[1]),wr=Math.min(k._zoomFromMercatorZ(Bn[2]),N.maxZoom),Er=new h.LngLat(mr,br);return k.mercatorFromTransition&&wr<.5*(h.GLOBE_ZOOM_THRESHOLD_MIN+h.GLOBE_ZOOM_THRESHOLD_MAX)?(k.setProjection({name:"globe"}),k.zoom=wr,this._cameraForBounds(k,p,v,w,I,P)):{center:Er,zoom:wr,bearing:w,pitch:I}}fitBounds(u,p,v){const w=this.cameraForBounds(u,p);return this._fitInternal(w,p,v)}fitScreenCoordinates(u,p,v,w,I){const P=h.Point.convert(u),k=h.Point.convert(p),N=new h.Point(Math.min(P.x,k.x),Math.min(P.y,k.y)),U=new h.Point(Math.max(P.x,k.x),Math.max(P.y,k.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(P,k))return this;const z=this.transform.pointLocation3D(N),q=this.transform.pointLocation3D(U),le=this.transform.pointLocation3D(new h.Point(N.x,U.y)),ye=this.transform.pointLocation3D(new h.Point(U.x,N.y)),be=[Math.min(z.lng,q.lng,le.lng,ye.lng),Math.min(z.lat,q.lat,le.lat,ye.lat)],ve=[Math.max(z.lng,q.lng,le.lng,ye.lng),Math.max(z.lat,q.lat,le.lat,ye.lat)],we=w&&w.pitch?w.pitch:this.getPitch(),K=this._cameraForBounds(this.transform,be,ve,v,we,w);return this._fitInternal(K,w,I)}_fitInternal(u,p,v){return u?(delete(p=h.extend(u,p)).padding,p.linear?this.easeTo(p,v):this.flyTo(p,v)):this}jumpTo(u,p){this.stop();const v=u.preloadOnly?this.transform.clone():this.transform;let w=!1,I=!1,P=!1;return"zoom"in u&&v.zoom!==+u.zoom&&(w=!0,v.zoom=+u.zoom),void 0!==u.center&&(v.center=h.LngLat.convert(u.center)),"bearing"in u&&v.bearing!==+u.bearing&&(I=!0,v.bearing=+u.bearing),"pitch"in u&&v.pitch!==+u.pitch&&(P=!0,v.pitch=+u.pitch),null==u.padding||v.isPaddingEqual(u.padding)||(v.padding=u.padding),u.preloadOnly?(this._preloadTiles(v),this):(this.fire(new h.Event("movestart",p)).fire(new h.Event("move",p)),w&&this.fire(new h.Event("zoomstart",p)).fire(new h.Event("zoom",p)).fire(new h.Event("zoomend",p)),I&&this.fire(new h.Event("rotatestart",p)).fire(new h.Event("rotate",p)).fire(new h.Event("rotateend",p)),P&&this.fire(new h.Event("pitchstart",p)).fire(new h.Event("pitch",p)).fire(new h.Event("pitchend",p)),this.fire(new h.Event("moveend",p)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||h.warnOnce(Pa),this.transform.getFreeCameraOptions()}setFreeCameraOptions(u,p){const v=this.transform;if(!v.projection.supportsFreeCamera)return h.warnOnce(Pa),this;this.stop();const w=v.zoom,I=v.pitch,P=v.bearing;v.setFreeCameraOptions(u);const k=w!==v.zoom,N=I!==v.pitch,U=P!==v.bearing;return this.fire(new h.Event("movestart",p)).fire(new h.Event("move",p)),k&&this.fire(new h.Event("zoomstart",p)).fire(new h.Event("zoom",p)).fire(new h.Event("zoomend",p)),U&&this.fire(new h.Event("rotatestart",p)).fire(new h.Event("rotate",p)).fire(new h.Event("rotateend",p)),N&&this.fire(new h.Event("pitchstart",p)).fire(new h.Event("pitch",p)).fire(new h.Event("pitchend",p)),this.fire(new h.Event("moveend",p)),this}easeTo(u,p){this._stop(!1,u.easeId),(!1===(u=h.extend({offset:[0,0],duration:500,easing:h.ease},u)).animate||this._prefersReducedMotion(u))&&(u.duration=0);const v=this.transform,w=this.getZoom(),I=this.getBearing(),P=this.getPitch(),k=this.getPadding(),N="zoom"in u?+u.zoom:w,U="bearing"in u?this._normalizeBearing(u.bearing,I):I,z="pitch"in u?+u.pitch:P,q="padding"in u?u.padding:v.padding,le=h.Point.convert(u.offset);let ye,be,ve;if("globe"===v.projection.name){const st=h.MercatorCoordinate.fromLngLat(v.center),Ct=le.rotate(-v.angle);st.x+=Ct.x/v.worldSize,st.y+=Ct.y/v.worldSize;const rn=st.toLngLat(),_t=h.LngLat.convert(u.center||rn);this._normalizeCenter(_t),ye=v.centerPoint.add(Ct),be=new h.Point(st.x,st.y).mult(v.worldSize),ve=new h.Point(h.mercatorXfromLng(_t.lng),h.mercatorYfromLat(_t.lat)).mult(v.worldSize).sub(be)}else{ye=v.centerPoint.add(le);const st=v.pointLocation(ye),Ct=h.LngLat.convert(u.center||st);this._normalizeCenter(Ct),be=v.project(st),ve=v.project(Ct).sub(be)}const we=v.zoomScale(N-w);let K,de;u.around&&(K=h.LngLat.convert(u.around),de=v.locationPoint(K));const Ae=this._zooming||N!==w,Se=this._rotating||I!==U,Ge=this._pitching||z!==P,Ye=!v.isPaddingEqual(q),Xe=st=>Ct=>{if(Ae&&(st.zoom=h.number(w,N,Ct)),Se&&(st.bearing=h.number(I,U,Ct)),Ge&&(st.pitch=h.number(P,z,Ct)),Ye&&(st.interpolatePadding(k,q,Ct),ye=st.centerPoint.add(le)),K)st.setLocationAtPoint(K,de);else{const rn=st.zoomScale(st.zoom-w),_t=N>w?Math.min(2,we):Math.max(.5,we),zt=Math.pow(_t,1-Ct),Dt=st.unproject(be.add(ve.mult(Ct*zt)).mult(rn));st.setLocationAtPoint(st.renderWorldCopies?Dt.wrap():Dt,ye)}return u.preloadOnly||this._fireMoveEvents(p),st};if(u.preloadOnly){const st=this._emulate(Xe,u.duration,v);return this._preloadTiles(st),this}const ct={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ae,this._rotating=Se,this._pitching=Ge,this._padding=Ye,this._easeId=u.easeId,this._prepareEase(p,u.noMoveStart,ct),this._ease(Xe(v),st=>{v.recenterOnTerrain(),this._afterEase(p,st)},u),this}_prepareEase(u,p,v={}){this._moving=!0,this.transform.cameraElevationReference="sea",p||v.moving||this.fire(new h.Event("movestart",u)),this._zooming&&!v.zooming&&this.fire(new h.Event("zoomstart",u)),this._rotating&&!v.rotating&&this.fire(new h.Event("rotatestart",u)),this._pitching&&!v.pitching&&this.fire(new h.Event("pitchstart",u))}_fireMoveEvents(u){this.fire(new h.Event("move",u)),this._zooming&&this.fire(new h.Event("zoom",u)),this._rotating&&this.fire(new h.Event("rotate",u)),this._pitching&&this.fire(new h.Event("pitch",u))}_afterEase(u,p){if(this._easeId&&p&&this._easeId===p)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const v=this._zooming,w=this._rotating,I=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new h.Event("zoomend",u)),w&&this.fire(new h.Event("rotateend",u)),I&&this.fire(new h.Event("pitchend",u)),this.fire(new h.Event("moveend",u))}flyTo(u,p){if(this._prefersReducedMotion(u)){const Zt=h.pick(u,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Zt,p)}this.stop(),u=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},u);const v=this.transform,w=this.getZoom(),I=this.getBearing(),P=this.getPitch(),k=this.getPadding(),N="zoom"in u?h.clamp(+u.zoom,v.minZoom,v.maxZoom):w,U="bearing"in u?this._normalizeBearing(u.bearing,I):I,z="pitch"in u?+u.pitch:P,q="padding"in u?u.padding:v.padding,le=v.zoomScale(N-w),ye=h.Point.convert(u.offset);let be=v.centerPoint.add(ye);const ve=v.pointLocation(be),we=h.LngLat.convert(u.center||ve);this._normalizeCenter(we);const K=v.project(ve),de=v.project(we).sub(K);let Ae=u.curve;const Se=Math.max(v.width,v.height),Ge=Se/le,Ye=de.mag();if("minZoom"in u){const Zt=h.clamp(Math.min(u.minZoom,w,N),v.minZoom,v.maxZoom),Mt=Se/v.zoomScale(Zt-w);Ae=Math.sqrt(Mt/Ye*2)}const Xe=Ae*Ae;function ct(Zt){const Mt=(Ge*Ge-Se*Se+(Zt?-1:1)*Xe*Xe*Ye*Ye)/(2*(Zt?Ge:Se)*Xe*Ye);return Math.log(Math.sqrt(Mt*Mt+1)-Mt)}function st(Zt){return(Math.exp(Zt)-Math.exp(-Zt))/2}function Ct(Zt){return(Math.exp(Zt)+Math.exp(-Zt))/2}const rn=ct(0);let _t=function(Zt){return Ct(rn)/Ct(rn+Ae*Zt)},zt=function(Zt){return Se*((Ct(rn)*(st(Mt=rn+Ae*Zt)/Ct(Mt))-st(rn))/Xe)/Ye;var Mt},Dt=(ct(1)-rn)/Ae;if(Math.abs(Ye)<1e-6||!isFinite(Dt)){if(Math.abs(Se-Ge)<1e-6)return this.easeTo(u,p);const Zt=Ge<Se?-1:1;Dt=Math.abs(Math.log(Ge/Se))/Ae,zt=function(){return 0},_t=function(Mt){return Math.exp(Zt*Ae*Mt)}}u.duration="duration"in u?+u.duration:1e3*Dt/("screenSpeed"in u?+u.screenSpeed/Ae:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0);const en=I!==U,vt=z!==P,Ut=!v.isPaddingEqual(q),sn=Zt=>Mt=>{const Kn=Mt*Dt,pi=1/_t(Kn);Zt.zoom=1===Mt?N:w+Zt.scaleZoom(pi),en&&(Zt.bearing=h.number(I,U,Mt)),vt&&(Zt.pitch=h.number(P,z,Mt)),Ut&&(Zt.interpolatePadding(k,q,Mt),be=Zt.centerPoint.add(ye));const Ln=1===Mt?we:Zt.unproject(K.add(de.mult(zt(Kn))).mult(pi));return Zt.setLocationAtPoint(Zt.renderWorldCopies?Ln.wrap():Ln,be),Zt._updateCameraOnTerrain(),u.preloadOnly||this._fireMoveEvents(p),Zt};if(u.preloadOnly){const Zt=this._emulate(sn,u.duration,v);return this._preloadTiles(Zt),this}return this._zooming=!0,this._rotating=en,this._pitching=vt,this._padding=Ut,this._prepareEase(p,!1),this._ease(sn(v),()=>this._afterEase(p),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(u,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const v=this._onEaseEnd;this._onEaseEnd=void 0,v.call(this,p)}if(!u){const v=this.handlers;v&&v.stop(!1)}return this}_ease(u,p,v){!1===v.animate||0===v.duration?(u(1),p()):(this._easeStart=h.exported.now(),this._easeOptions=v,this._onEaseFrame=u,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const u=Math.min((h.exported.now()-this._easeStart)/this._easeOptions.duration,1),p=this._onEaseFrame;p&&p(this._easeOptions.easing(u)),u<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(u,p){u=h.wrap(u,-180,180);const v=Math.abs(u-p);return Math.abs(u-360-p)<v&&(u-=360),Math.abs(u+360-p)<v&&(u+=360),u}_normalizeCenter(u){const p=this.transform;if(!p.renderWorldCopies||p.maxBounds)return;const v=u.lng-p.center.lng;u.lng+=v>180?-360:v<-180?360:0}_prefersReducedMotion(u){return this._respectPrefersReducedMotion&&h.exported.prefersReducedMotion&&!(u&&u.essential)}_emulate(u,p,v){const w=Math.ceil(15*p/1e3),I=[],P=u(v.clone());for(let k=0;k<=w;k++){const N=P(k/w);I.push(N.clone())}return I}}class Fn{constructor(u={}){this.options=u,h.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(u){const p=this.options&&this.options.compact;return this._map=u,this._container=ce("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ce("button","mapboxgl-ctrl-attrib-button",this._container),ce("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ce("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),p&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===p&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(u,p){const v=this._map._getUIString(`AttributionControl.${p}`);u.setAttribute("aria-label",v),u.removeAttribute("title"),u.firstElementChild&&u.firstElementChild.setAttribute("title",v)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));const p=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.config.ACCESS_TOKEN}];if(u){const v=p.reduce((w,I,P)=>(I.value&&(w+=`${I.key}=${I.value}${P<p.length-1?"&":""}`),w),"?");u.href=`${h.config.FEEDBACK_URL}/${v}#${xs(this._map,!0)}`,u.rel="noopener nofollow",this._setElementTitle(u,"MapFeedback")}}_updateData(u){!u||"metadata"!==u.sourceDataType&&"visibility"!==u.sourceDataType&&"style"!==u.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let u=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const p=this._map.style._sourceCaches;for(const w in p){const I=p[w];if(I.used){const P=I.getSource();P.attribution&&u.indexOf(P.attribution)<0&&u.push(P.attribution)}}u.sort((w,I)=>w.length-I.length),u=u.filter((w,I)=>{for(let P=I+1;P<u.length;P++)if(u[P].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=[...this.options.customAttribution,...u]:u.unshift(this.options.customAttribution));const v=u.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,u.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ch{constructor(){h.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(u){this._map=u,this._container=ce("div","mapboxgl-ctrl");const p=ce("a","mapboxgl-ctrl-logo");return p.target="_blank",p.rel="noopener nofollow",p.href="https://www.mapbox.com/",p.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),p.setAttribute("rel","noopener nofollow"),this._container.appendChild(p),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(u){u&&"metadata"!==u.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const u=this._map.style._sourceCaches;if(0===Object.entries(u).length)return!0;for(const p in u){const v=u[p].getSource();if(v.hasOwnProperty("mapbox_logo")&&!v.mapbox_logo)return!1}return!0}_updateCompact(){const u=this._container.children;if(u.length){const p=u[0];this._map.getCanvasContainer().offsetWidth<250?p.classList.add("mapboxgl-compact"):p.classList.remove("mapboxgl-compact")}}}class Xp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const p=++this._id;return this._queue.push({callback:u,id:p,cancelled:!1}),p}remove(u){const p=this._currentlyRunning,v=p?this._queue.concat(p):this._queue;for(const w of v)if(w.id===u)return void(w.cancelled=!0)}run(u=0){const p=this._currentlyRunning=this._queue;this._queue=[];for(const v of p)if(!v.cancelled&&(v.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function xc(_,u,p){if(_=new h.LngLat(_.lng,_.lat),u){const v=new h.LngLat(_.lng-360,_.lat),w=new h.LngLat(_.lng+360,_.lat),I=360*Math.ceil(Math.abs(_.lng-p.center.lng)/360),P=p.locationPoint(_).distSqr(u),k=u.x<0||u.y<0||u.x>p.width||u.y>p.height;p.locationPoint(v).distSqr(u)<P&&(k||Math.abs(v.lng-p.center.lng)<I)?_=v:p.locationPoint(w).distSqr(u)<P&&(k||Math.abs(w.lng-p.center.lng)<I)&&(_=w)}for(;Math.abs(_.lng-p.center.lng)>180;){const v=p.locationPoint(_);if(v.x>=0&&v.y>=0&&v.x<=p.width&&v.y<=p.height)break;_.lng>p.center.lng?_.lng-=360:_.lng+=360}return _}const bc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Sn extends h.Evented{constructor(u,p){if(super(),(u instanceof h.window.HTMLElement||p)&&(u=h.extend({element:u},p)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=u&&u.occludedOpacity||.2,u&&u.element)this._element=u.element,this._offset=h.Point.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=ce("div");const w=41,I=27,P=xe("svg",{display:"block",height:w*this._scale+"px",width:I*this._scale+"px",viewBox:`0 0 ${I} ${w}`},this._element),k=xe("radialGradient",{id:"shadowGradient"},xe("defs",{},P));xe("stop",{offset:"10%","stop-opacity":.4},k),xe("stop",{offset:"100%","stop-opacity":.05},k),xe("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},P),xe("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},P),xe("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},P),xe("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},P),this._offset=h.Point.convert(u&&u.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const v=this._element.classList;for(const w in bc)v.remove(`mapboxgl-marker-anchor-${w}`);v.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(u){return u===this._map||(this.remove(),this._map=u,u.getCanvasContainer().appendChild(this._element),u.on("move",this._updateMoving),u.on("moveend",this._update),u.on("remove",this._clearFadeTimer),u._addMarker(this),this.setDraggable(this._draggable),this._update(),u.on("click",this._onMapClick)),this}remove(){const u=this._map;return u&&(u.off("click",this._onMapClick),u.off("move",this._updateMoving),u.off("moveend",this._update),u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler),u.off("mouseup",this._onUp),u.off("touchend",this._onUp),u.off("mousemove",this._onMove),u.off("touchmove",this._onMove),u.off("remove",this._clearFadeTimer),u._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=h.LngLat.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(24.6+w)],"bottom-right":[-w,-1*(24.6+w)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=u,u._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(u){const p=u.code,v=u.charCode||u.keyCode;"Space"!==p&&"Enter"!==p&&32!==v&&13!==v||this.togglePopup()}_onMapClick(u){const p=u.originalEvent.target,v=this._element;this._popup&&(p===v||v.contains(p))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const u=this._popup;return u?(u.isOpen()?(u.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(u.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const u=this._map,p=this._pos;if(!u||!p)return!1;const v=u.unproject(p),w=u.getFreeCameraOptions();if(!w.position)return!1;const I=w.position.toLngLat();return I.distanceTo(v)<.9*I.distanceTo(this._lngLat)}_evaluateOpacity(){const u=this._map;if(!u)return;const p=this._pos;if(!p||p.x<0||p.x>u.transform.width||p.y<0||p.y>u.transform.height)return void this._clearFadeTimer();const v=u.unproject(p);let w;u._showingGlobe()&&h.isLngLatBehindGlobe(u.transform,this._lngLat)?w=0:(w=1-u._queryFogOpacity(v),u.transform._terrainEnabled()&&u.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const u=this._pos;if(!u||!this._map)return;const p=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${u.x}px,${u.y}px)\n            ${bc[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${p.x}px,${p.y}px)\n        `}_calculateXYTransform(){const u=this._pos,p=this._map,v=this.getPitchAlignment();if(!p||!u||"map"!==v)return"";if(!p._showingGlobe()){const N=p.getPitch();return N?`rotateX(${N}deg)`:""}const w=h.radToDeg(h.globeTiltAtLngLat(p.transform,this._lngLat)),I=u.sub(h.globeCenterToScreenPoint(p.transform)),P=Math.abs(I.x)+Math.abs(I.y);if(0===P)return"";const k=w/P;return`rotateX(${-I.y*k}deg) rotateY(${I.x*k}deg)`}_calculateZTransform(){const u=this._pos,p=this._map;if(!p||!u)return"";let v=0;const w=this.getRotationAlignment();if("map"===w)if(p._showingGlobe()){const I=p.project(new h.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),P=p.project(new h.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(I);v=h.radToDeg(Math.atan2(P.y,P.x))-90}else v=-p.getBearing();else if("horizon"===w){const I=h.smoothstep(4,6,p.getZoom()),P=h.globeCenterToScreenPoint(p.transform);P.y+=I*p.transform.height;const k=u.sub(P),N=h.radToDeg(Math.atan2(k.y,k.x));v=(N>90?N-270:N+90)*(1-I)}return v+=this._rotation,v?`rotateZ(${v}deg)`:""}_update(u){h.window.cancelAnimationFrame(this._updateFrameId);const p=this._map;p&&(p.transform.renderWorldCopies&&(this._lngLat=xc(this._lngLat,this._pos,p.transform)),this._pos=p.project(this._lngLat),!0===u?this._updateFrameId=h.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),p._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(p._showingGlobe()||p.getTerrain()||p.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(u){return this._offset=h.Point.convert(u),this._update(),this}_onMove(u){const p=this._map;if(!p)return;const v=this._pointerdownPos,w=this._positionDelta;if(v&&w){if(!this._isDragging){const I=this._clickTolerance||p._clickTolerance;if(u.point.dist(v)<I)return;this._isDragging=!0}this._pos=u.point.sub(w),this._lngLat=p.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const u=this._map;u&&(u.off("mousemove",this._onMove),u.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new h.Event("dragend")),this._state="inactive"}_addDragHandler(u){const p=this._map,v=this._pos;p&&v&&this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(v),this._pointerdownPos=u.point,this._state="pending",p.on("mousemove",this._onMove),p.on("touchmove",this._onMove),p.once("mouseup",this._onUp),p.once("touchend",this._onUp))}setDraggable(u){this._draggable=!!u;const p=this._map;return p&&(u?(p.on("mousedown",this._addDragHandler),p.on("touchstart",this._addDragHandler)):(p.off("mousedown",this._addDragHandler),p.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(u){return this._occludedOpacity=u||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ih={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Qp=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function $f(_=new h.Point(0,0),u="bottom"){if("number"==typeof _){const p=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(u){case"top":return new h.Point(0,_);case"top-left":return new h.Point(p,p);case"top-right":return new h.Point(-p,p);case"bottom":return new h.Point(0,-_);case"bottom-left":return new h.Point(p,-p);case"bottom-right":return new h.Point(-p,-p);case"left":return new h.Point(_,0);case"right":return new h.Point(-_,0)}return new h.Point(0,0)}return _ instanceof h.Point||Array.isArray(_)?h.Point.convert(_):h.Point.convert(_[u]||[0,0])}class Ld{constructor(u){this.jumpTo(u)}getValue(u){if(u<=this._startTime)return this._start;if(u>=this._endTime)return this._end;const p=h.easeCubicInOut((u-this._startTime)/(this._endTime-this._startTime));return this._start*(1-p)+this._end*p}isEasing(u){return u>=this._startTime&&u<=this._endTime}jumpTo(u){this._startTime=-1/0,this._endTime=-1/0,this._start=u,this._end=u}easeTo(u,p,v){this._start=this.getValue(p),this._end=u,this._startTime=p,this._endTime=p+v}}const Ng={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Bg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Vg={showCompass:!0,showZoom:!0,visualizePitch:!1};class Jp{constructor(u,p,v=!1){this._clickTolerance=10,this.element=p,this.mouseRotate=new Kp({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,v&&(this.mousePitch=new Rd({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),p.addEventListener("mousedown",this.mousedown),p.addEventListener("touchstart",this.touchstart,{passive:!1}),p.addEventListener("touchmove",this.touchmove),p.addEventListener("touchend",this.touchend),p.addEventListener("touchcancel",this.reset)}down(u,p){this.mouseRotate.mousedown(u,p),this.mousePitch&&this.mousePitch.mousedown(u,p),ke()}move(u,p){const v=this.map,w=this.mouseRotate.mousemoveWindow(u,p),I=w&&w.bearingDelta;if(I&&v.setBearing(v.getBearing()+I),this.mousePitch){const P=this.mousePitch.mousemoveWindow(u,p),k=P&&P.pitchDelta;k&&v.setPitch(v.getPitch()+k)}}off(){const u=this.element;u.removeEventListener("mousedown",this.mousedown),u.removeEventListener("touchstart",this.touchstart,{passive:!1}),u.removeEventListener("touchmove",this.touchmove),u.removeEventListener("touchend",this.touchend),u.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){$e(),h.window.removeEventListener("mousemove",this.mousemove),h.window.removeEventListener("mouseup",this.mouseup)}mousedown(u){this.down(h.extend({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),Ie(this.element,u)),h.window.addEventListener("mousemove",this.mousemove),h.window.addEventListener("mouseup",this.mouseup)}mousemove(u){this.move(u,Ie(this.element,u))}mouseup(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()}touchstart(u){1!==u.targetTouches.length?this.reset():(this._startPos=this._lastPos=Le(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>u.preventDefault()},this._startPos))}touchmove(u){1!==u.targetTouches.length?this.reset():(this._lastPos=Le(this.element,u.targetTouches)[0],this.move({preventDefault:()=>u.preventDefault()},this._lastPos))}touchend(u){0===u.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Xc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Hf={maxWidth:100,unit:"metric"},Gf={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},$u={version:h.version,supported:He,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:class extends Yc{constructor(_){if(h.LivePerformanceUtils.mark(h.PerformanceMarkers.create),null!=(_=h.extend({},Bg,_)).minZoom&&null!=_.maxZoom&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=_.minPitch&&null!=_.maxPitch&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=_.minPitch&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=_.maxPitch&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&h.isSafariWithAntialiasingBug(h.window)&&(_.antialias=!1,h.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ml(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies),_),this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._useWebGL2=_.useWebGL2,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._optimizeForTerrain=_.optimizeForTerrain,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new Xp,this._domRenderTaskQueue=new Xp,this._controls=[],this._markers=[],this._popups=[],this._mapId=h.uniqueId(),this._locale=h.extend({},Ng,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ld(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new h.RequestManager(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,"string"==typeof _.container){if(this._container=h.window.document.getElementById(_.container),!this._container)throw new Error(`Container '${_.container}' not found.`)}else{if(!(_.container instanceof h.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&h.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==h.window&&(h.window.addEventListener("online",this._onWindowOnline,!1),h.window.addEventListener("resize",this._onWindowResize,!1),h.window.addEventListener("orientationchange",this._onWindowResize,!1),h.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),h.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ws(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,_.style&&this.setStyle(_.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),this._hash=_.hash&&new kg("string"==typeof _.hash&&_.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),_.bounds&&(this.resize(),this.fitBounds(_.bounds,h.extend({},_.fitBoundsOptions,{duration:0})))),this.resize(),_.attributionControl&&this.addControl(new Fn({customAttribution:_.customAttribution})),this._logoControl=new Ch,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update("style"===u.dataType),this.fire(new h.Event(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new h.Event(`${u.dataType}dataloading`,u))})}_getMapId(){return this._mapId}addControl(_,u){if(void 0===u&&(u=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const p=_.onAdd(this);this._controls.push(_);const v=this._controlPositions[u];return-1!==u.indexOf("bottom")?v.insertBefore(p,v.firstChild):v.appendChild(p),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(_);return u>-1&&this._controls.splice(u,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const u=!this._moving;return u&&this.fire(new h.Event("movestart",_)).fire(new h.Event("move",_)),this.fire(new h.Event("resize",_)),u&&this.fire(new h.Event("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(h.LngLatBounds.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new h.Event("zoomstart")).fire(new h.Event("zoom")).fire(new h.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new h.Event("zoomstart")).fire(new h.Event("zoom")).fire(new h.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new h.Event("pitchstart")).fire(new h.Event("pitch")).fire(new h.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new h.Event("pitchstart")).fire(new h.Event("pitch")).fire(new h.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return"auto"===_?h.window.navigator.language:Array.isArray(_)?0===_.length?void 0:_.map(u=>"auto"===u?h.window.navigator.language:u):_}setLanguage(_){const u=this._parseLanguage(_);if(!this.style||u===this._language)return this;this._language=u,this.style._reloadSources();for(const p of this._controls)p._setLanguage&&p._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(_){return this._lazyInitEmptyStyle(),_?"string"==typeof _&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const _=this.transform,u=_.projection.name;let p;"globe"===u&&_.zoom>=h.GLOBE_ZOOM_THRESHOLD_MAX?(_.setMercatorFromTransition(),p=!0):"mercator"===u&&_.zoom<h.GLOBE_ZOOM_THRESHOLD_MAX&&(_.setProjection({name:"globe"}),p=!0),p&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(_,u){return this._updateProjection(_||u||{name:"mercator"})}_updateProjection(_){let u;if(u="globe"===_.name&&this.transform.zoom>=h.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),u){this.painter.clearBackgroundTiles();for(const p in this.style._sourceCaches)this.style._sourceCaches[p].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(_){return this.transform.locationPoint3D(h.LngLat.convert(_))}unproject(_){return this.transform.pointLocation3D(h.Point.convert(_))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,u,p){if("mouseenter"===_||"mouseover"===_){let v=!1;const w=P=>{const k=u.filter(U=>this.getLayer(U)),N=k.length?this.queryRenderedFeatures(P.point,{layers:k}):[];N.length?v||(v=!0,p.call(this,new Ms(_,this,P.originalEvent,{features:N}))):v=!1},I=()=>{v=!1};return{layers:new Set(u),listener:p,delegates:{mousemove:w,mouseout:I}}}if("mouseleave"===_||"mouseout"===_){let v=!1;const w=P=>{const k=u.filter(N=>this.getLayer(N));(k.length?this.queryRenderedFeatures(P.point,{layers:k}):[]).length?v=!0:v&&(v=!1,p.call(this,new Ms(_,this,P.originalEvent)))},I=P=>{v&&(v=!1,p.call(this,new Ms(_,this,P.originalEvent)))};return{layers:new Set(u),listener:p,delegates:{mousemove:w,mouseout:I}}}{const v=w=>{const I=u.filter(k=>this.getLayer(k)),P=I.length?this.queryRenderedFeatures(w.point,{layers:I}):[];P.length&&(w.features=P,p.call(this,w),delete w.features)};return{layers:new Set(u),listener:p,delegates:{[_]:v}}}}on(_,u,p){if(void 0===p)return super.on(_,u);Array.isArray(u)||(u=[u]);const v=this._createDelegatedListener(_,u,p);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(v);for(const w in v.delegates)this.on(w,v.delegates[w]);return this}once(_,u,p){if(void 0===p)return super.once(_,u);Array.isArray(u)||(u=[u]);const v=this._createDelegatedListener(_,u,p);for(const w in v.delegates)this.once(w,v.delegates[w]);return this}off(_,u,p){if(void 0===p)return super.off(_,u);u=new Set(Array.isArray(u)?u:[u]);const v=(I,P)=>{if(I.size!==P.size)return!1;for(const k of I)if(!P.has(k))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[_]:void 0;return w&&(I=>{for(let P=0;P<I.length;P++){const k=I[P];if(k.listener===p&&v(k.layers,u)){for(const N in k.delegates)this.off(N,k.delegates[N]);return I.splice(P,1),this}}})(w),this}queryRenderedFeatures(_,u){return this.style?(void 0!==u||void 0===_||_ instanceof h.Point||Array.isArray(_)||(u=_,_=void 0),this.style.queryRenderedFeatures(_=_||[[0,0],[this.transform.width,this.transform.height]],u=u||{},this.transform)):[]}querySourceFeatures(_,u){return this.style.querySourceFeatures(_,u)}isPointOnSurface(_){const{name:u}=this.transform.projection;return"globe"!==u&&"mercator"!==u&&h.warnOnce(`${u} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(h.Point.convert(_))}setStyle(_,u){return!1!==(u=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},u)).diff&&u.localIdeographFontFamily===this._localIdeographFontFamily&&u.localFontFamily===this._localFontFamily&&this.style&&_?(this._diffStyle(_,u),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._localFontFamily=u.localFontFamily,this._updateStyle(_,u))}_getUIString(_){const u=this._locale[_];if(null==u)throw new Error(`Missing UI string '${_}'`);return u}_updateStyle(_,u){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_&&(this.style=new Eo(this,u||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof _?this.style.loadURL(_):this.style.loadJSON(_)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Eo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,u){if("string"==typeof _){const p=this._requestManager.normalizeStyleURL(_),v=this._requestManager.transformRequest(p,h.ResourceType.Style);h.getJSON(v,(w,I)=>{w?this.fire(new h.ErrorEvent(w)):I&&this._updateDiff(I,u)})}else"object"==typeof _&&this._updateDiff(_,u)}_updateDiff(_,u){try{this.style.setState(_)&&this._update(!0)}catch(p){h.warnOnce(`Unable to perform style diff: ${p.message||p.error||p}.  Rebuilding the style from scratch.`),this._updateStyle(_,u)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(h.warnOnce("There is no style added to the map."),!1)}addSource(_,u){return this._lazyInitEmptyStyle(),this.style.addSource(_,u),this._update(!0)}isSourceLoaded(_){return!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){const _=this.style&&this.style._sourceCaches;for(const u in _){const p=_[u]._tiles;for(const v in p){const w=p[v];if("loaded"!==w.state&&"errored"!==w.state)return!1}}return!0}addSourceType(_,u,p){this._lazyInitEmptyStyle(),this.style.addSourceType(_,u,p)}removeSource(_){return this.style.removeSource(_),this._updateTerrain(),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,u,{pixelRatio:p=1,sdf:v=!1,stretchX:w,stretchY:I,content:P}={}){if(this._lazyInitEmptyStyle(),u instanceof h.window.HTMLImageElement||h.window.ImageBitmap&&u instanceof h.window.ImageBitmap){const{width:k,height:N,data:U}=h.exported.getImageData(u);this.style.addImage(_,{data:new h.RGBAImage({width:k,height:N},U),pixelRatio:p,stretchX:w,stretchY:I,content:P,sdf:v,version:0})}else if(void 0===u.width||void 0===u.height)this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:k,height:N}=u,U=u;this.style.addImage(_,{data:new h.RGBAImage({width:k,height:N},new Uint8Array(U.data)),pixelRatio:p,stretchX:w,stretchY:I,content:P,sdf:v,version:0,userImage:U}),U.onAdd&&U.onAdd(this,_)}}updateImage(_,u){const p=this.style.getImage(_);if(!p)return void this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const v=u instanceof h.window.HTMLImageElement||h.window.ImageBitmap&&u instanceof h.window.ImageBitmap?h.exported.getImageData(u):u,{width:w,height:I}=v;void 0!==w&&void 0!==I?w===p.data.width&&I===p.data.height?(p.data.replace(v.data,!(u instanceof h.window.HTMLImageElement||h.window.ImageBitmap&&u instanceof h.window.ImageBitmap)),this.style.updateImage(_,p)):this.fire(new h.ErrorEvent(new Error(`The width and height of the updated image (${w}, ${I})\n                must be that same as the previous version of the image\n                (${p.data.width}, ${p.data.height})`))):this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_,u){h.getImage(this._requestManager.transformRequest(_,h.ResourceType.Image),(p,v)=>{u(p,v instanceof h.window.HTMLImageElement?h.exported.getImageData(v):v)})}listImages(){return this.style.listImages()}addLayer(_,u){return this._lazyInitEmptyStyle(),this.style.addLayer(_,u),this._update(!0)}moveLayer(_,u){return this.style.moveLayer(_,u),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}setLayerZoomRange(_,u,p){return this.style.setLayerZoomRange(_,u,p),this._update(!0)}setFilter(_,u,p={}){return this.style.setFilter(_,u,p),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,u,p,v={}){return this.style.setPaintProperty(_,u,p,v),this._update(!0)}getPaintProperty(_,u){return this.style.getPaintProperty(_,u)}setLayoutProperty(_,u,p,v={}){return this.style.setLayoutProperty(_,u,p,v),this._update(!0)}getLayoutProperty(_,u){return this.style.getLayoutProperty(_,u)}setLight(_,u={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,u),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(h.LngLat.convert(_),this.transform):0}setFeatureState(_,u){return this.style.setFeatureState(_,u),this._update()}removeFeatureState(_,u){return this.style.removeFeatureState(_,u),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,u=this._container.getBoundingClientRect().height||300;let p,v,w,I=this._container;for(;I&&(!v||!w);){const P=h.window.getComputedStyle(I).transform;P&&"none"!==P&&(p=P.match(/matrix.*\((.+)\)/)[1].split(", "),p[0]&&"0"!==p[0]&&"1"!==p[0]&&(v=p[0]),p[3]&&"0"!==p[3]&&"1"!==p[3]&&(w=p[3])),I=I.parentElement}this._containerWidth=v?Math.abs(_/v):_,this._containerHeight=w?Math.abs(u/w):u}_detectMissingCSS(){"rgb(250, 128, 114)"!==h.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&h.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=ce("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const u=this._canvasContainer=ce("div","mapboxgl-canvas-container",_);this._interactive&&u.classList.add("mapboxgl-interactive"),this._canvas=ce("canvas","mapboxgl-canvas",u),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const p=this._controlContainer=ce("div","mapboxgl-control-container",_),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{v[w]=ce("div",`mapboxgl-ctrl-${w}`,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,u){const p=h.exported.devicePixelRatio||1;this._canvas.width=p*Math.ceil(_),this._canvas.height=p*Math.ceil(u),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${u}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const u=this._markers.indexOf(_);-1!==u&&this._markers.splice(u,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const u=this._popups.indexOf(_);-1!==u&&this._popups.splice(u,1)}_setupPainter(){const _=h.extend({},He.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),u=this._useWebGL2&&this._canvas.getContext("webgl2",_),p=u||this._canvas.getContext("webgl",_)||this._canvas.getContext("experimental-webgl",_);p?(this._useWebGL2&&!u&&h.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),h.storeAuthState(p,!0),this.painter=new Ma(p,this.transform,!!u),this.on("data",v=>{"source"===v.dataType&&this.painter.setTileLoadedFlag(!0)}),h.exported$1.testSupport(p)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let u;const p=this.painter.context.extTimerQuery,v=h.exported.now();if(this.listens("gpu-timing-frame")&&(u=p.createQueryEXT(),p.beginQueryEXT(p.TIME_ELAPSED_EXT,u)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],h.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],h.window.performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const k=this.transform.zoom,N=this.transform.pitch,U=h.exported.now(),z=new h.EvaluationParameters(k,{now:U,fadeDuration:w,pitch:N,transition:this.style.getTransition()});this.style.update(z)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let I=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),I=this._updateAverageElevation(v),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):I=this._updateAverageElevation(v),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),u){const k=h.exported.now()-v;p.endQueryEXT(p.TIME_ELAPSED_EXT,u),setTimeout(()=>{const N=p.getQueryObjectEXT(u,p.QUERY_RESULT_EXT)/1e6;p.deleteQueryEXT(u),this.fire(new h.Event("gpu-timing-frame",{cpuTime:k,gpuTime:N})),h.window.performance.mark("frame-gpu",{startTime:v,detail:{gpuTime:N}})},50)}if(this.listens("gpu-timing-layer")){const k=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(k);this.fire(new h.Event("gpu-timing-layer",{layerTimes:N}))},50)}if(this.listens("gpu-timing-deferred-render")){const k=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const N=this.painter.queryGpuTimeDeferredRender(k);this.fire(new h.Event("gpu-timing-deferred-render",{gpuTime:N}))},50)}const P=this._sourcesDirty||this._styleDirty||this._placementDirty||I;if(P||this._repaint)this.triggerRepaint();else{const k=!this.isMoving()&&this.loaded();if(k&&(I=this._updateAverageElevation(v,!0)),I)this.triggerRepaint();else if(this._triggerFrame(!1),k&&(this.fire(new h.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const N=this._calculateSpeedIndex();this.fire(new h.Event("speedindexcompleted",{speedIndex:N})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||P||(this._fullyLoaded=!0,h.LivePerformanceUtils.mark(h.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&h.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const u of this._markers)_&&!this.getRenderWorldCopies()&&(u._lngLat=u._lngLat.wrap()),u._update();for(const u of this._popups)!_||this.getRenderWorldCopies()||u._trackPointer||(u._lngLat=u._lngLat.wrap()),u._update()}_updateAverageElevation(_,u=!1){const p=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&p(0);if((u||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const v=this.transform.averageElevation;let w=this.transform.sampleAverageElevation(),I=!1;this.transform.elevation&&(I=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=_;const P=Math.abs(v-w);if(P>1){if(this._isInitialLoad||I)return this._averageElevation.jumpTo(w),p(w);this._averageElevation.easeTo(w,_,300)}else if(P>1e-4)return this._averageElevation.jumpTo(w),p(w)}return!!this._averageElevation.isEasing(_)&&p(this._averageElevation.getValue(_))}_authenticate(){h.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===h.AUTH_ERR_MSG||401===_.status)){const u=this.painter.context.gl;h.storeAuthState(u,!1),this._logoControl instanceof Ch&&this._logoControl._updateLogo(),u&&u.clear(u.DEPTH_BUFFER_BIT|u.COLOR_BUFFER_BIT|u.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new h.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),h.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),u=this.painter.getCanvasCopiesAndTimestamps();u.timeStamps.push(performance.now());const p=this.painter.context.gl,v=p.createFramebuffer();function w(I){p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,I,0);const P=new Uint8Array(p.drawingBufferWidth*p.drawingBufferHeight*4);return p.readPixels(0,0,p.drawingBufferWidth,p.drawingBufferHeight,p.RGBA,p.UNSIGNED_BYTE,P),P}return p.bindFramebuffer(p.FRAMEBUFFER,v),this._canvasPixelComparison(w(_),u.canvasCopies.map(w),u.timeStamps)}_canvasPixelComparison(_,u,p){let v=p[1]-p[0];const w=_.length/4;for(let I=0;I<u.length;I++){const P=u[I];let k=0;for(let N=0;N<P.length;N+=4)P[N]===_[N]&&P[N+1]===_[N+1]&&P[N+2]===_[N+2]&&P[N+3]===_[N+3]&&(k+=1);v+=(p[I+2]-p[I+1])*(1-k/w)}return v}remove(){this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==h.window&&(h.window.removeEventListener("resize",this._onWindowResize,!1),h.window.removeEventListener("orientationchange",this._onWindowResize,!1),h.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),h.window.removeEventListener("online",this._onWindowOnline,!1),h.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),h.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new h.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=h.exported.frame(u=>{const p=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,p&&this._render(u)}))}_preloadTiles(_){const u=this.style?Object.values(this.style._sourceCaches):[];return h.asyncAll(u,(p,v)=>p._preloadTiles(_,v),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){"hidden"===h.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,_&&this._update())}_setCacheLimits(_,u){h.setCacheLimits(_,u)}get version(){return h.version}},NavigationControl:class{constructor(_){this.options=h.extend({},Vg,_),this._container=ce("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",u=>u.preventDefault()),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",u=>{this._map&&this._map.zoomIn({},{originalEvent:u})}),ce("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",u=>{this._map&&this._map.zoomOut({},{originalEvent:u})}),ce("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",u=>{const p=this._map;p&&(this.options.visualizePitch?p.resetNorthPitch({},{originalEvent:u}):p.resetNorth({},{originalEvent:u}))}),this._compassIcon=ce("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const u=_.getZoom(),p=u===_.getMaxZoom(),v=u===_.getMinZoom();this._zoomInButton.disabled=p,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",p.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const u=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=u)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Jp(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,u){const p=ce("button",_,this._container);return p.type="button",p.addEventListener("click",u),p}_setButtonTitle(_,u){if(!this._map)return;const p=this._map._getUIString(`NavigationControl.${u}`);_.setAttribute("aria-label",p),_.firstElementChild&&_.firstElementChild.setAttribute("title",p)}},GeolocateControl:class extends h.Evented{constructor(_){super(),this.options=h.extend({geolocation:h.window.navigator.geolocation},Xc,_),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=To(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=ce("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const u=(p=!!this.options.geolocation)=>{this._supportsGeolocation=p,_(p)};void 0!==this._supportsGeolocation?_(this._supportsGeolocation):void 0!==h.window.navigator.permissions?h.window.navigator.permissions.query({name:"geolocation"}).then(p=>u("denied"!==p.state)).catch(()=>u()):u()}_isOutOfMapMaxBounds(_){const u=this._map.getMaxBounds(),p=_.coords;return!!u&&(p.longitude<u.getWest()||p.longitude>u.getEast()||p.latitude<u.getSouth()||p.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(_),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(_),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",_)),this._finish()}}_updateCamera(_){const u=new h.LngLat(_.coords.longitude,_.coords.latitude),p=_.coords.accuracy,v=this._map.getBearing(),w=h.extend({bearing:v},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(p),w,{geolocateSource:!0})}_updateMarker(_){if(_){const u=new h.LngLat(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,u=h.mercatorZfromAltitude(1,_._center.lat)*_.worldSize,p=Math.ceil(2*this._accuracy*u);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(1===_.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===_.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=ce("button","mapboxgl-ctrl-geolocate",this._container),ce("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===_){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ce("div","mapboxgl-user-location"),this._dotElement.appendChild(ce("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ce("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Sn({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ce("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Sn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||"ACTIVE_LOCK"!==this._watchState||u.originalEvent&&"resize"===u.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new h.Event("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:!0===_.absolute&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{h.window.addEventListener("ondeviceorientationabsolute"in h.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==h.window.DeviceMotionEvent&&"function"==typeof h.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(u=>{"granted"===u&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),h.window.removeEventListener("deviceorientation",this._onDeviceOrientation),h.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Fn,ScaleControl:class{constructor(_){this.options=h.extend({},Hf,_),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),h.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,u=this._map,p=u._containerHeight/2,v=u._containerWidth/2-_/2,w=u.unproject([v,p]),I=u.unproject([v+_,p]),P=w.distanceTo(I);if("imperial"===this.options.unit){const k=3.2808*P;k>5280?this._setScale(_,k/5280,"mile"):this._setScale(_,k,"foot")}else"nautical"===this.options.unit?this._setScale(_,P/1852,"nautical-mile"):P>=1e3?this._setScale(_,P/1e3,"kilometer"):this._setScale(_,P,"meter")}_setScale(_,u,p){this._map._requestDomTask(()=>{const v=function(I){const P=Math.pow(10,`${Math.floor(I)}`.length-1);let k=I/P;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(N){const U=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*U)/U}(k),P*k}(u),w=v/u;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==p?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:p}).format(v):`${v}&nbsp;${Gf[p]}`,this._container.style.width=_*w+"px"})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=ce("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_){this._fullscreen=!1,_&&_.container&&(_.container instanceof h.window.HTMLElement?this._container=_.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in h.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in h.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=ce("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,h.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!h.window.document.fullscreenEnabled&&!h.window.document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=ce("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ce("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),h.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(h.window.document.fullscreenElement||h.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?h.window.document.exitFullscreen?h.window.document.exitFullscreen():h.window.document.webkitCancelFullScreen&&h.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends h.Evented{constructor(_){super(),this.options=h.extend(Object.create(Ih),_),h.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new h.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new h.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=h.LngLat.convert(_),this._pos=null,this._trackPointer=!1,this._update();const u=this._map;return u&&(u.on("move",this._update),u.off("mousemove",this._onMouseEvent),u._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(h.window.document.createTextNode(_))}setHTML(_){const u=h.window.document.createDocumentFragment(),p=h.window.document.createElement("body");let v;for(p.innerHTML=_;v=p.firstChild,v;)u.appendChild(v);return this.setDOMContent(u)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let u=this._content;if(u)for(;u.hasChildNodes();)u.firstChild&&u.removeChild(u.firstChild);else u=this._content=ce("div","mapboxgl-popup-content",this._container||void 0);if(u.appendChild(_),this.options.closeButton){const p=this._closeButton=ce("button","mapboxgl-popup-close-button",u);p.type="button",p.setAttribute("aria-label","Close popup"),p.setAttribute("aria-hidden","true"),p.innerHTML="&#215;",p.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let u;return this._classList.delete(_)?u=!1:(this._classList.add(_),u=!0),this._updateClassList(),u}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const u=this._map,p=this._container,v=this._pos;if(!u||!p||!v)return"bottom";const w=p.offsetWidth,I=p.offsetHeight,P=v.x<w/2,k=v.x>u.transform.width-w/2;if(v.y+_<I)return P?"top-left":k?"top-right":"top";if(v.y>u.transform.height-I){if(P)return"bottom-left";if(k)return"bottom-right"}return P?"left":k?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const u=[...this._classList];u.push("mapboxgl-popup"),this._anchor&&u.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&u.push("mapboxgl-popup-track-pointer"),_.className=u.join(" ")}_update(_){const u=this._map,p=this._content;if(!u||!this._lngLat&&!this._trackPointer||!p)return;let v=this._container;if(v||(v=this._container=ce("div","mapboxgl-popup",u.getContainer()),this._tip=ce("div","mapboxgl-popup-tip",v),v.appendChild(p)),this.options.maxWidth&&v.style.maxWidth!==this.options.maxWidth&&(v.style.maxWidth=this.options.maxWidth),u.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=xc(this._lngLat,this._pos,u.transform)),!this._trackPointer||_){const w=this._pos=this._trackPointer&&_?_:u.project(this._lngLat),I=$f(this.options.offset),P=this._anchor=this._getAnchor(I.y),k=$f(this.options.offset,P),N=w.add(k).round();u._requestDomTask(()=>{this._container&&P&&(this._container.style.transform=`${bc[P]} translate(${N.x}px,${N.y}px)`)})}if(!this._marker&&u._showingGlobe()){const w=h.isLngLatBehindGlobe(u.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Qp);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:Sn,Style:Eo,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.Point,MercatorCoordinate:h.MercatorCoordinate,FreeCameraOptions:Zc,Evented:h.Evented,config:h.config,prewarm:function(){po().acquire(Pn)},clearPrewarmedResources:function(){const _=Un;_&&(_.isPreloaded()&&1===_.numActive()?(_.release(Pn),Un=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return h.config.ACCESS_TOKEN},set accessToken(_){h.config.ACCESS_TOKEN=_},get baseApiUrl(){return h.config.API_URL},set baseApiUrl(_){h.config.API_URL=_},get workerCount(){return Li.workerCount},set workerCount(_){Li.workerCount=_},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){h.config.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){h.clearTileCache(_)},workerUrl:"",workerClass:null,setNow:h.exported.setNow,restoreNow:h.exported.restoreNow};return $u}),W}()},3808:kn=>{window,kn.exports=function(an){var Ve={};function W(ie){if(Ve[ie])return Ve[ie].exports;var fe=Ve[ie]={i:ie,l:!1,exports:{}};return an[ie].call(fe.exports,fe,fe.exports,W),fe.l=!0,fe.exports}return W.m=an,W.c=Ve,W.d=function(ie,fe,h){W.o(ie,fe)||Object.defineProperty(ie,fe,{enumerable:!0,get:h})},W.r=function(ie){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(ie,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ie,"__esModule",{value:!0})},W.t=function(ie,fe){if(1&fe&&(ie=W(ie)),8&fe||4&fe&&"object"==typeof ie&&ie&&ie.__esModule)return ie;var h=Object.create(null);if(W.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:ie}),2&fe&&"string"!=typeof ie)for(var Me in ie)W.d(h,Me,function(He){return ie[He]}.bind(null,Me));return h},W.n=function(ie){var fe=ie&&ie.__esModule?function(){return ie.default}:function(){return ie};return W.d(fe,"a",fe),fe},W.o=function(ie,fe){return Object.prototype.hasOwnProperty.call(ie,fe)},W.p="",W(W.s=0)}({"./src/index.js":
/*!**********************!*\
                  !*** ./src/index.js ***!
                  \**********************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve),W(
/*! ./sass/index.scss */
"./src/sass/index.scss");var Me=W(
/*! ./js/init */
"./src/js/init.js").default.init;typeof window<"u"&&(window.printJS=Me),Ve.default=Me},"./src/js/browser.js":
/*!***************************!*\
                  !*** ./src/js/browser.js ***!
                  \***************************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve);var ie={isFirefox:function(){return typeof InstallTrigger<"u"},isIE:function(){return-1!==navigator.userAgent.indexOf("MSIE")||!!document.documentMode},isEdge:function(){return!ie.isIE()&&!!window.StyleMedia},isChrome:function(){return!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).chrome},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||-1!==navigator.userAgent.toLowerCase().indexOf("safari")},isIOSChrome:function(){return-1!==navigator.userAgent.toLowerCase().indexOf("crios")}};Ve.default=ie},"./src/js/functions.js":
/*!*****************************!*\
                  !*** ./src/js/functions.js ***!
                  \*****************************/
/*! exports provided: addWrapper, capitalizePrint, collectStyles, addHeader, cleanUp, isRawHTML */function(an,Ve,W){"use strict";W.r(Ve),W.d(Ve,"addWrapper",function(){return Me}),W.d(Ve,"capitalizePrint",function(){return He}),W.d(Ve,"collectStyles",function(){return rt}),W.d(Ve,"addHeader",function(){return ce}),W.d(Ve,"cleanUp",function(){return xe}),W.d(Ve,"isRawHTML",function(){return ae});var ie=W(
/*! ./modal */
"./src/js/modal.js"),fe=W(
/*! ./browser */
"./src/js/browser.js");function h(he){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(ke){return typeof ke}:function(ke){return ke&&"function"==typeof Symbol&&ke.constructor===Symbol&&ke!==Symbol.prototype?"symbol":typeof ke})(he)}function Me(he,_e){return'<div style="font-family:'+_e.font+" !important; font-size: "+_e.font_size+' !important; width:100%;">'+he+"</div>"}function He(he){return he.charAt(0).toUpperCase()+he.slice(1)}function rt(he,_e){for(var $e="",Je=(document.defaultView||window).getComputedStyle(he,""),tt=0;tt<Je.length;tt++)(-1!==_e.targetStyles.indexOf("*")||-1!==_e.targetStyle.indexOf(Je[tt])||se(_e.targetStyles,Je[tt]))&&Je.getPropertyValue(Je[tt])&&($e+=Je[tt]+":"+Je.getPropertyValue(Je[tt])+";");return $e+"max-width: "+_e.maxWidth+"px !important; font-size: "+_e.font_size+" !important;"}function se(he,_e){for(var ke=0;ke<he.length;ke++)if("object"===h(_e)&&-1!==_e.indexOf(he[ke]))return!0;return!1}function ce(he,_e){var ke=document.createElement("div");if(ae(_e.header))ke.innerHTML=_e.header;else{var $e=document.createElement("h1"),Je=document.createTextNode(_e.header);$e.appendChild(Je),$e.setAttribute("style",_e.headerStyle),ke.appendChild($e)}he.insertBefore(ke,he.childNodes[0])}function xe(he){he.showModal&&ie.default.close(),he.onLoadingEnd&&he.onLoadingEnd(),(he.showModal||he.onLoadingStart)&&window.URL.revokeObjectURL(he.printable);var _e="mouseover";(fe.default.isChrome()||fe.default.isFirefox())&&(_e="focus");window.addEventListener(_e,function $e(){window.removeEventListener(_e,$e),he.onPrintDialogClose();var Je=document.getElementById(he.frameId);Je&&Je.remove()})}function ae(he){return new RegExp("<([A-Za-z][A-Za-z0-9]*)\\b[^>]*>(.*?)</\\1>").test(he)}},"./src/js/html.js":
/*!************************!*\
                  !*** ./src/js/html.js ***!
                  \************************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve);var ie=W(
/*! ./functions */
"./src/js/functions.js"),fe=W(
/*! ./print */
"./src/js/print.js");function h(rt){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(ce){return typeof ce}:function(ce){return ce&&"function"==typeof Symbol&&ce.constructor===Symbol&&ce!==Symbol.prototype?"symbol":typeof ce})(rt)}function Me(rt,se){for(var ce=rt.cloneNode(),xe=Array.prototype.slice.call(rt.childNodes),ae=0;ae<xe.length;ae++)if(-1===se.ignoreElements.indexOf(xe[ae].id)){var he=Me(xe[ae],se);ce.appendChild(he)}switch(se.scanStyles&&1===rt.nodeType&&ce.setAttribute("style",Object(ie.collectStyles)(rt,se)),rt.tagName){case"SELECT":ce.value=rt.value;break;case"CANVAS":ce.getContext("2d").drawImage(rt,0,0)}return ce}Ve.default={print:function(se,ce){var xe=function He(rt){return"object"===h(rt)&&rt&&(rt instanceof HTMLElement||1===rt.nodeType)}(se.printable)?se.printable:document.getElementById(se.printable);xe?(se.printableElement=Me(xe,se),se.header&&Object(ie.addHeader)(se.printableElement,se),fe.default.send(se,ce)):window.console.error("Invalid HTML element id: "+se.printable)}}},"./src/js/image.js":
/*!*************************!*\
                  !*** ./src/js/image.js ***!
                  \*************************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve);var ie=W(
/*! ./functions */
"./src/js/functions.js"),fe=W(
/*! ./print */
"./src/js/print.js"),h=W(
/*! ./browser */
"./src/js/browser.js");Ve.default={print:function(He,rt){He.printable.constructor!==Array&&(He.printable=[He.printable]),He.printableElement=document.createElement("div"),He.printable.forEach(function(se){var ce=document.createElement("img");ce.setAttribute("style",He.imageStyle),ce.src=se,h.default.isFirefox()&&(ce.src=ce.src);var ae=document.createElement("div");ae.appendChild(ce),He.printableElement.appendChild(ae)}),He.header&&Object(ie.addHeader)(He.printableElement,He),fe.default.send(He,rt)}}},"./src/js/init.js":
/*!************************!*\
                  !*** ./src/js/init.js ***!
                  \************************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve);var ie=W(
/*! ./browser */
"./src/js/browser.js"),fe=W(
/*! ./modal */
"./src/js/modal.js"),h=W(
/*! ./pdf */
"./src/js/pdf.js"),Me=W(
/*! ./html */
"./src/js/html.js"),He=W(
/*! ./raw-html */
"./src/js/raw-html.js"),rt=W(
/*! ./image */
"./src/js/image.js"),se=W(
/*! ./json */
"./src/js/json.js");function ce(ae){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(_e){return typeof _e}:function(_e){return _e&&"function"==typeof Symbol&&_e.constructor===Symbol&&_e!==Symbol.prototype?"symbol":typeof _e})(ae)}var xe=["pdf","html","image","json","raw-html"];Ve.default={init:function(){var he={printable:null,fallbackPrintable:null,type:"pdf",header:null,headerStyle:"font-weight: 300;",maxWidth:800,properties:null,gridHeaderStyle:"font-weight: bold; padding: 5px; border: 1px solid #dddddd;",gridStyle:"border: 1px solid lightgray; margin-bottom: -1px;",showModal:!1,onError:function(Le){throw Le},onLoadingStart:null,onLoadingEnd:null,onPrintDialogClose:function(){},onIncompatibleBrowser:function(){},modalMessage:"Retrieving Document...",frameId:"printJS",printableElement:null,documentTitle:"Document",targetStyle:["clear","display","width","min-width","height","min-height","max-height"],targetStyles:["border","box","break","text-decoration"],ignoreElements:[],repeatTableHeader:!0,css:null,style:null,scanStyles:!0,base64:!1,onPdfOpen:null,font:"TimesNewRoman",font_size:"12pt",honorMarginPadding:!0,honorColor:!1,imageStyle:"max-width: 100%;"},_e=arguments[0];if(void 0===_e)throw new Error("printJS expects at least 1 attribute.");switch(ce(_e)){case"string":he.printable=encodeURI(_e),he.fallbackPrintable=he.printable,he.type=arguments[1]||he.type;break;case"object":for(var ke in he.printable=_e.printable,he.fallbackPrintable=typeof _e.fallbackPrintable<"u"?_e.fallbackPrintable:he.printable,he.fallbackPrintable=he.base64?"data:application/pdf;base64,".concat(he.fallbackPrintable):he.fallbackPrintable,he)"printable"===ke||"fallbackPrintable"===ke||(he[ke]=typeof _e[ke]<"u"?_e[ke]:he[ke]);break;default:throw new Error('Unexpected argument type! Expected "string" or "object", got '+ce(_e))}if(!he.printable)throw new Error("Missing printable information.");if(!he.type||"string"!=typeof he.type||-1===xe.indexOf(he.type.toLowerCase()))throw new Error("Invalid print type. Available types are: pdf, html, image and json.");he.showModal&&fe.default.show(he),he.onLoadingStart&&he.onLoadingStart();var $e=document.getElementById(he.frameId);$e&&$e.parentNode.removeChild($e);var Je=document.createElement("iframe");switch(ie.default.isFirefox()?Je.setAttribute("style","width: 1px; height: 100px; position: fixed; left: 0; top: 0; opacity: 0; border-width: 0; margin: 0; padding: 0"):Je.setAttribute("style","visibility: hidden; height: 0; width: 0; position: absolute; border: 0"),Je.setAttribute("id",he.frameId),"pdf"!==he.type&&(Je.srcdoc="<html><head><title>"+he.documentTitle+"</title>",he.css&&(Array.isArray(he.css)||(he.css=[he.css]),he.css.forEach(function(Ie){Je.srcdoc+='<link rel="stylesheet" href="'+Ie+'">'})),Je.srcdoc+="</head><body></body></html>"),he.type){case"pdf":if(ie.default.isIE())try{console.info("Print.js doesn't support PDF printing in Internet Explorer."),window.open(he.fallbackPrintable,"_blank").focus(),he.onIncompatibleBrowser()}catch(Ie){he.onError(Ie)}finally{he.showModal&&fe.default.close(),he.onLoadingEnd&&he.onLoadingEnd()}else h.default.print(he,Je);break;case"image":rt.default.print(he,Je);break;case"html":Me.default.print(he,Je);break;case"raw-html":He.default.print(he,Je);break;case"json":se.default.print(he,Je)}}}},"./src/js/json.js":
/*!************************!*\
                  !*** ./src/js/json.js ***!
                  \************************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve);var ie=W(
/*! ./functions */
"./src/js/functions.js"),fe=W(
/*! ./print */
"./src/js/print.js");function h(He){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(se){return typeof se}:function(se){return se&&"function"==typeof Symbol&&se.constructor===Symbol&&se!==Symbol.prototype?"symbol":typeof se})(He)}Ve.default={print:function(rt,se){if("object"!==h(rt.printable))throw new Error("Invalid javascript data object (JSON).");if("boolean"!=typeof rt.repeatTableHeader)throw new Error("Invalid value for repeatTableHeader attribute (JSON).");if(!rt.properties||!Array.isArray(rt.properties))throw new Error("Invalid properties array for your JSON data.");rt.properties=rt.properties.map(function(ce){return{field:"object"===h(ce)?ce.field:ce,displayName:"object"===h(ce)?ce.displayName:ce,columnSize:"object"===h(ce)&&ce.columnSize?ce.columnSize+";":100/rt.properties.length+"%;"}}),rt.printableElement=document.createElement("div"),rt.header&&Object(ie.addHeader)(rt.printableElement,rt),rt.printableElement.innerHTML+=function Me(He){var rt=He.printable,se=He.properties,ce='<table style="border-collapse: collapse; width: 100%;">';He.repeatTableHeader&&(ce+="<thead>"),ce+="<tr>";for(var xe=0;xe<se.length;xe++)ce+='<th style="width:'+se[xe].columnSize+";"+He.gridHeaderStyle+'">'+Object(ie.capitalizePrint)(se[xe].displayName)+"</th>";ce+="</tr>",He.repeatTableHeader&&(ce+="</thead>"),ce+="<tbody>";for(var ae=0;ae<rt.length;ae++){ce+="<tr>";for(var he=0;he<se.length;he++){var _e=rt[ae],ke=se[he].field.split(".");if(ke.length>1)for(var $e=0;$e<ke.length;$e++)_e=_e[ke[$e]];else _e=_e[se[he].field];ce+='<td style="width:'+se[he].columnSize+He.gridStyle+'">'+_e+"</td>"}ce+="</tr>"}return ce+"</tbody></table>"}(rt),fe.default.send(rt,se)}}},"./src/js/modal.js":
/*!*************************!*\
                  !*** ./src/js/modal.js ***!
                  \*************************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve);var ie={show:function(h){var He=document.createElement("div");He.setAttribute("style","font-family:sans-serif; display:table; text-align:center; font-weight:300; font-size:30px; left:0; top:0;position:fixed; z-index: 9990;color: #0460B5; width: 100%; height: 100%; background-color:rgba(255,255,255,.9);transition: opacity .3s ease;"),He.setAttribute("id","printJS-Modal");var rt=document.createElement("div");rt.setAttribute("style","display:table-cell; vertical-align:middle; padding-bottom:100px;");var se=document.createElement("div");se.setAttribute("class","printClose"),se.setAttribute("id","printClose"),rt.appendChild(se);var ce=document.createElement("span");ce.setAttribute("class","printSpinner"),rt.appendChild(ce);var xe=document.createTextNode(h.modalMessage);rt.appendChild(xe),He.appendChild(rt),document.getElementsByTagName("body")[0].appendChild(He),document.getElementById("printClose").addEventListener("click",function(){ie.close()})},close:function(){var h=document.getElementById("printJS-Modal");h&&h.parentNode.removeChild(h)}};Ve.default=ie},"./src/js/pdf.js":
/*!***********************!*\
                  !*** ./src/js/pdf.js ***!
                  \***********************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve);var ie=W(
/*! ./print */
"./src/js/print.js"),fe=W(
/*! ./functions */
"./src/js/functions.js");function h(Me,He,rt){var se=new window.Blob([rt],{type:"application/pdf"});se=window.URL.createObjectURL(se),He.setAttribute("src",se),ie.default.send(Me,He)}Ve.default={print:function(He,rt){if(He.base64){var se=Uint8Array.from(atob(He.printable),function(xe){return xe.charCodeAt(0)});h(He,rt,se)}else{He.printable=/^(blob|http|\/\/)/i.test(He.printable)?He.printable:window.location.origin+("/"!==He.printable.charAt(0)?"/"+He.printable:He.printable);var ce=new window.XMLHttpRequest;ce.responseType="arraybuffer",ce.addEventListener("error",function(){Object(fe.cleanUp)(He),He.onError(ce.statusText,ce)}),ce.addEventListener("load",function(){if(-1===[200,201].indexOf(ce.status))return Object(fe.cleanUp)(He),void He.onError(ce.statusText,ce);h(He,rt,ce.response)}),ce.open("GET",He.printable,!0),ce.send()}}}},"./src/js/print.js":
/*!*************************!*\
                  !*** ./src/js/print.js ***!
                  \*************************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve);var ie=W(
/*! ./browser */
"./src/js/browser.js"),fe=W(
/*! ./functions */
"./src/js/functions.js");function Me(se,ce){try{if(se.focus(),ie.default.isEdge()||ie.default.isIE())try{se.contentWindow.document.execCommand("print",!1,null)}catch{se.contentWindow.print()}else se.contentWindow.print()}catch(xe){ce.onError(xe)}finally{ie.default.isFirefox()&&(se.style.visibility="hidden",se.style.left="-1px"),Object(fe.cleanUp)(ce)}}function He(se){var ce=se.map(function(xe){if(xe.src&&xe.src!==window.location.href)return function rt(se){return new Promise(function(ce){!function ae(){!se||typeof se.naturalWidth>"u"||0===se.naturalWidth||!se.complete?setTimeout(ae,500):ce()}()})}(xe)});return Promise.all(ce)}Ve.default={send:function(ce,xe){document.getElementsByTagName("body")[0].appendChild(xe);var ae=document.getElementById(ce.frameId);ae.onload=function(){if("pdf"!==ce.type){var he=ae.contentWindow||ae.contentDocument;if(he.document&&(he=he.document),he.body.appendChild(ce.printableElement),"pdf"!==ce.type&&ce.style){var _e=document.createElement("style");_e.innerHTML=ce.style,he.head.appendChild(_e)}var ke=he.getElementsByTagName("img");ke.length>0?He(Array.from(ke)).then(function(){return Me(ae,ce)}):Me(ae,ce)}else ie.default.isFirefox()?setTimeout(function(){return Me(ae,ce)},1e3):Me(ae,ce)}}}},"./src/js/raw-html.js":
/*!****************************!*\
                  !*** ./src/js/raw-html.js ***!
                  \****************************/
/*! exports provided: default */function(an,Ve,W){"use strict";W.r(Ve);var ie=W(
/*! ./print */
"./src/js/print.js");Ve.default={print:function(h,Me){h.printableElement=document.createElement("div"),h.printableElement.setAttribute("style","width:100%"),h.printableElement.innerHTML=h.printable,ie.default.send(h,Me)}}},"./src/sass/index.scss":
/*!*****************************!*\
                  !*** ./src/sass/index.scss ***!
                  \*****************************/
/*! no static exports found */function(an,Ve,W){},0:
/*!****************************!*\
                  !*** multi ./src/index.js ***!
                  \****************************/
/*! no static exports found */function(an,Ve,W){an.exports=W(
/*! ./src/index.js */
"./src/index.js")}}).default},2480:()=>{},3106:(kn,an,Ve)=>{"use strict";Ve.d(an,{Z:()=>$e});var W=Ve(9058),ie=Ve(4537),fe=Ve(534),h=Ve(7879);class Me{constructor(tt,Ie){this._delegate=tt,this.firebase=Ie,(0,fe._addComponent)(tt,new ie.wA("app-compat",()=>this,"PUBLIC")),this.container=tt.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(tt){this._delegate.automaticDataCollectionEnabled=tt}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(tt=>{this._delegate.checkDestroyed(),tt()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,fe.deleteApp)(this._delegate)))}_getService(tt,Ie=fe._DEFAULT_ENTRY_NAME){var Le;this._delegate.checkDestroyed();const mt=this._delegate.container.getProvider(tt);return!mt.isInitialized()&&"EXPLICIT"===(null===(Le=mt.getComponent())||void 0===Le?void 0:Le.instantiationMode)&&mt.initialize(),mt.getImmediate({identifier:Ie})}_removeServiceInstance(tt,Ie=fe._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(tt).clearInstance(Ie)}_addComponent(tt){(0,fe._addComponent)(this._delegate,tt)}_addOrOverwriteComponent(tt){(0,fe._addOrOverwriteComponent)(this._delegate,tt)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const rt=new W.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),xe=function ce(){const Je=function se(Je){const tt={},Ie={__esModule:!0,initializeApp:function at(xt,lt={}){const pn=fe.initializeApp(xt,lt);if((0,W.r3)(tt,pn.name))return tt[pn.name];const Lt=new Je(pn,Ie);return tt[pn.name]=Lt,Lt},app:mt,registerVersion:fe.registerVersion,setLogLevel:fe.setLogLevel,onLog:fe.onLog,apps:null,SDK_VERSION:fe.SDK_VERSION,INTERNAL:{registerComponent:function kt(xt){const lt=xt.name,pn=lt.replace("-compat","");if(fe._registerComponent(xt)&&"PUBLIC"===xt.type){const Lt=(nn=mt())=>{if("function"!=typeof nn[pn])throw rt.create("invalid-app-argument",{appName:lt});return nn[pn]()};void 0!==xt.serviceProps&&(0,W.ZB)(Lt,xt.serviceProps),Ie[pn]=Lt,Je.prototype[pn]=function(...nn){return this._getService.bind(this,lt).apply(this,xt.multipleInstances?nn:[])}}return"PUBLIC"===xt.type?Ie[pn]:null},removeApp:function Le(xt){delete tt[xt]},useAsService:function fn(xt,lt){return"serverAuth"===lt?null:lt},modularAPIs:fe}};function mt(xt){if(!(0,W.r3)(tt,xt=xt||fe._DEFAULT_ENTRY_NAME))throw rt.create("no-app",{appName:xt});return tt[xt]}return Ie.default=Ie,Object.defineProperty(Ie,"apps",{get:function ze(){return Object.keys(tt).map(xt=>tt[xt])}}),mt.App=Je,Ie}(Me);return Je.INTERNAL=Object.assign(Object.assign({},Je.INTERNAL),{createFirebaseNamespace:ce,extendNamespace:function tt(Ie){(0,W.ZB)(Je,Ie)},createSubscribe:W.ne,ErrorFactory:W.LL,deepExtend:W.ZB}),Je}(),ae=new h.Yd("@firebase/app-compat");if((0,W.jU)()&&void 0!==self.firebase){ae.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Je=self.firebase.SDK_VERSION;Je&&Je.indexOf("LITE")>=0&&ae.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const $e=xe;!function ke(Je){(0,fe.registerVersion)("@firebase/app-compat","0.2.25",Je)}()},534:(kn,an,Ve)=>{"use strict";Ve.r(an),Ve.d(an,{FirebaseError:()=>h.ZR,SDK_VERSION:()=>Re,_DEFAULT_ENTRY_NAME:()=>Wo,_addComponent:()=>So,_addOrOverwriteComponent:()=>Mo,_apps:()=>Ir,_clearComponents:()=>Sr,_components:()=>fo,_getProvider:()=>Bi,_registerComponent:()=>co,_removeServiceInstance:()=>qr,deleteApp:()=>Be,getApp:()=>oe,getApps:()=>De,initializeApp:()=>te,onLog:()=>dt,registerVersion:()=>ut,setLogLevel:()=>et});var W=Ve(5861),ie=Ve(4537),fe=Ve(7879),h=Ve(9058);const Me=(Tt,Ke)=>Ke.some(dn=>Tt instanceof dn);let He,rt;const xe=new WeakMap,ae=new WeakMap,he=new WeakMap,_e=new WeakMap,ke=new WeakMap;let tt={get(Tt,Ke,dn){if(Tt instanceof IDBTransaction){if("done"===Ke)return ae.get(Tt);if("objectStoreNames"===Ke)return Tt.objectStoreNames||he.get(Tt);if("store"===Ke)return dn.objectStoreNames[1]?void 0:dn.objectStore(dn.objectStoreNames[0])}return at(Tt[Ke])},set:(Tt,Ke,dn)=>(Tt[Ke]=dn,!0),has:(Tt,Ke)=>Tt instanceof IDBTransaction&&("done"===Ke||"store"===Ke)||Ke in Tt};function mt(Tt){return"function"==typeof Tt?function Le(Tt){return Tt!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function ce(){return rt||(rt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(Tt)?function(...Ke){return Tt.apply(ze(this),Ke),at(xe.get(this))}:function(...Ke){return at(Tt.apply(ze(this),Ke))}:function(Ke,...dn){const jn=Tt.call(ze(this),Ke,...dn);return he.set(jn,Ke.sort?Ke.sort():[Ke]),at(jn)}}(Tt):(Tt instanceof IDBTransaction&&function Je(Tt){if(ae.has(Tt))return;const Ke=new Promise((dn,jn)=>{const $i=()=>{Tt.removeEventListener("complete",Zi),Tt.removeEventListener("error",gt),Tt.removeEventListener("abort",gt)},Zi=()=>{dn(),$i()},gt=()=>{jn(Tt.error||new DOMException("AbortError","AbortError")),$i()};Tt.addEventListener("complete",Zi),Tt.addEventListener("error",gt),Tt.addEventListener("abort",gt)});ae.set(Tt,Ke)}(Tt),Me(Tt,function se(){return He||(He=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(Tt,tt):Tt)}function at(Tt){if(Tt instanceof IDBRequest)return function $e(Tt){const Ke=new Promise((dn,jn)=>{const $i=()=>{Tt.removeEventListener("success",Zi),Tt.removeEventListener("error",gt)},Zi=()=>{dn(at(Tt.result)),$i()},gt=()=>{jn(Tt.error),$i()};Tt.addEventListener("success",Zi),Tt.addEventListener("error",gt)});return Ke.then(dn=>{dn instanceof IDBCursor&&xe.set(dn,Tt)}).catch(()=>{}),ke.set(Ke,Tt),Ke}(Tt);if(_e.has(Tt))return _e.get(Tt);const Ke=mt(Tt);return Ke!==Tt&&(_e.set(Tt,Ke),ke.set(Ke,Tt)),Ke}const ze=Tt=>ke.get(Tt),xt=["get","getKey","getAll","getAllKeys","count"],lt=["put","add","delete","clear"],pn=new Map;function Lt(Tt,Ke){if(!(Tt instanceof IDBDatabase)||Ke in Tt||"string"!=typeof Ke)return;if(pn.get(Ke))return pn.get(Ke);const dn=Ke.replace(/FromIndex$/,""),jn=Ke!==dn,$i=lt.includes(dn);if(!(dn in(jn?IDBIndex:IDBObjectStore).prototype)||!$i&&!xt.includes(dn))return;const Zi=function(){var gt=(0,W.Z)(function*(xr,...Zn){const Hi=this.transaction(xr,$i?"readwrite":"readonly");let Wa=Hi.store;return jn&&(Wa=Wa.index(Zn.shift())),(yield Promise.all([Wa[dn](...Zn),$i&&Hi.done]))[0]});return function(Zn){return gt.apply(this,arguments)}}();return pn.set(Ke,Zi),Zi}!function Ie(Tt){tt=Tt(tt)}(Tt=>({...Tt,get:(Ke,dn,jn)=>Lt(Ke,dn)||Tt.get(Ke,dn,jn),has:(Ke,dn)=>!!Lt(Ke,dn)||Tt.has(Ke,dn)}));class nn{constructor(Ke){this.container=Ke}getPlatformInfoString(){return this.container.getProviders().map(dn=>{if(function wn(Tt){const Ke=Tt.getComponent();return"VERSION"===Ke?.type}(dn)){const jn=dn.getImmediate();return`${jn.library}/${jn.version}`}return null}).filter(dn=>dn).join(" ")}}const Rt="@firebase/app",Kt=new fe.Yd("@firebase/app"),Wo="[DEFAULT]",Jr={[Rt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Ir=new Map,fo=new Map;function So(Tt,Ke){try{Tt.container.addComponent(Ke)}catch(dn){Kt.debug(`Component ${Ke.name} failed to register with FirebaseApp ${Tt.name}`,dn)}}function Mo(Tt,Ke){Tt.container.addOrOverwriteComponent(Ke)}function co(Tt){const Ke=Tt.name;if(fo.has(Ke))return Kt.debug(`There were multiple attempts to register component ${Ke}.`),!1;fo.set(Ke,Tt);for(const dn of Ir.values())So(dn,Tt);return!0}function Bi(Tt,Ke){const dn=Tt.container.getProvider("heartbeat").getImmediate({optional:!0});return dn&&dn.triggerHeartbeat(),Tt.container.getProvider(Ke)}function qr(Tt,Ke,dn=Wo){Bi(Tt,Ke).clearInstance(dn)}function Sr(){fo.clear()}const vr=new h.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class zr{constructor(Ke,dn,jn){this._isDeleted=!1,this._options=Object.assign({},Ke),this._config=Object.assign({},dn),this._name=dn.name,this._automaticDataCollectionEnabled=dn.automaticDataCollectionEnabled,this._container=jn,this.container.addComponent(new ie.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ke){this.checkDestroyed(),this._automaticDataCollectionEnabled=Ke}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Ke){this._isDeleted=Ke}checkDestroyed(){if(this.isDeleted)throw vr.create("app-deleted",{appName:this._name})}}const Re="10.7.1";function te(Tt,Ke={}){let dn=Tt;"object"!=typeof Ke&&(Ke={name:Ke});const jn=Object.assign({name:Wo,automaticDataCollectionEnabled:!1},Ke),$i=jn.name;if("string"!=typeof $i||!$i)throw vr.create("bad-app-name",{appName:String($i)});if(dn||(dn=(0,h.aH)()),!dn)throw vr.create("no-options");const Zi=Ir.get($i);if(Zi){if((0,h.vZ)(dn,Zi.options)&&(0,h.vZ)(jn,Zi.config))return Zi;throw vr.create("duplicate-app",{appName:$i})}const gt=new ie.H0($i);for(const Zn of fo.values())gt.addComponent(Zn);const xr=new zr(dn,jn,gt);return Ir.set($i,xr),xr}function oe(Tt=Wo){const Ke=Ir.get(Tt);if(!Ke&&Tt===Wo&&(0,h.aH)())return te();if(!Ke)throw vr.create("no-app",{appName:Tt});return Ke}function De(){return Array.from(Ir.values())}function Be(Tt){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,W.Z)(function*(Tt){const Ke=Tt.name;Ir.has(Ke)&&(Ir.delete(Ke),yield Promise.all(Tt.container.getProviders().map(dn=>dn.delete())),Tt.isDeleted=!0)})).apply(this,arguments)}function ut(Tt,Ke,dn){var jn;let $i=null!==(jn=Jr[Tt])&&void 0!==jn?jn:Tt;dn&&($i+=`-${dn}`);const Zi=$i.match(/\s|\//),gt=Ke.match(/\s|\//);if(Zi||gt){const xr=[`Unable to register library "${$i}" with version "${Ke}":`];return Zi&&xr.push(`library name "${$i}" contains illegal characters (whitespace or "/")`),Zi&&gt&&xr.push("and"),gt&&xr.push(`version name "${Ke}" contains illegal characters (whitespace or "/")`),void Kt.warn(xr.join(" "))}co(new ie.wA(`${$i}-version`,()=>({library:$i,version:Ke}),"VERSION"))}function dt(Tt,Ke){if(null!==Tt&&"function"!=typeof Tt)throw vr.create("invalid-log-argument");(0,fe.Am)(Tt,Ke)}function et(Tt){(0,fe.Ub)(Tt)}const Et="firebase-heartbeat-database",tn=1,Ee="firebase-heartbeat-store";let pe=null;function ne(){return pe||(pe=function kt(Tt,Ke,{blocked:dn,upgrade:jn,blocking:$i,terminated:Zi}={}){const gt=indexedDB.open(Tt,Ke),xr=at(gt);return jn&&gt.addEventListener("upgradeneeded",Zn=>{jn(at(gt.result),Zn.oldVersion,Zn.newVersion,at(gt.transaction),Zn)}),dn&&gt.addEventListener("blocked",Zn=>dn(Zn.oldVersion,Zn.newVersion,Zn)),xr.then(Zn=>{Zi&&Zn.addEventListener("close",()=>Zi()),$i&&Zn.addEventListener("versionchange",Hi=>$i(Hi.oldVersion,Hi.newVersion,Hi))}).catch(()=>{}),xr}(Et,tn,{upgrade:(Tt,Ke)=>{0===Ke&&Tt.createObjectStore(Ee)}}).catch(Tt=>{throw vr.create("idb-open",{originalErrorMessage:Tt.message})})),pe}function ee(){return(ee=(0,W.Z)(function*(Tt){try{return yield(yield ne()).transaction(Ee).objectStore(Ee).get(En(Tt))}catch(Ke){if(Ke instanceof h.ZR)Kt.warn(Ke.message);else{const dn=vr.create("idb-get",{originalErrorMessage:Ke?.message});Kt.warn(dn.message)}}})).apply(this,arguments)}function Te(Tt,Ke){return bt.apply(this,arguments)}function bt(){return(bt=(0,W.Z)(function*(Tt,Ke){try{const jn=(yield ne()).transaction(Ee,"readwrite");yield jn.objectStore(Ee).put(Ke,En(Tt)),yield jn.done}catch(dn){if(dn instanceof h.ZR)Kt.warn(dn.message);else{const jn=vr.create("idb-set",{originalErrorMessage:dn?.message});Kt.warn(jn.message)}}})).apply(this,arguments)}function En(Tt){return`${Tt.name}!${Tt.options.appId}`}class vi{constructor(Ke){this.container=Ke,this._heartbeatsCache=null;const dn=this.container.getProvider("app").getImmediate();this._storage=new Un(dn),this._heartbeatsCachePromise=this._storage.read().then(jn=>(this._heartbeatsCache=jn,jn))}triggerHeartbeat(){var Ke=this;return(0,W.Z)(function*(){var dn,jn;const Zi=Ke.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),gt=Pn();if((null!=(null===(dn=Ke._heartbeatsCache)||void 0===dn?void 0:dn.heartbeats)||(Ke._heartbeatsCache=yield Ke._heartbeatsCachePromise,null!=(null===(jn=Ke._heartbeatsCache)||void 0===jn?void 0:jn.heartbeats)))&&Ke._heartbeatsCache.lastSentHeartbeatDate!==gt&&!Ke._heartbeatsCache.heartbeats.some(xr=>xr.date===gt))return Ke._heartbeatsCache.heartbeats.push({date:gt,agent:Zi}),Ke._heartbeatsCache.heartbeats=Ke._heartbeatsCache.heartbeats.filter(xr=>{const Zn=new Date(xr.date).valueOf();return Date.now()-Zn<=2592e6}),Ke._storage.overwrite(Ke._heartbeatsCache)})()}getHeartbeatsHeader(){var Ke=this;return(0,W.Z)(function*(){var dn;if(null===Ke._heartbeatsCache&&(yield Ke._heartbeatsCachePromise),null==(null===(dn=Ke._heartbeatsCache)||void 0===dn?void 0:dn.heartbeats)||0===Ke._heartbeatsCache.heartbeats.length)return"";const jn=Pn(),{heartbeatsToSend:$i,unsentEntries:Zi}=function Li(Tt,Ke=1024){const dn=[];let jn=Tt.slice();for(const $i of Tt){const Zi=dn.find(gt=>gt.agent===$i.agent);if(Zi){if(Zi.dates.push($i.date),po(dn)>Ke){Zi.dates.pop();break}}else if(dn.push({agent:$i.agent,dates:[$i.date]}),po(dn)>Ke){dn.pop();break}jn=jn.slice(1)}return{heartbeatsToSend:dn,unsentEntries:jn}}(Ke._heartbeatsCache.heartbeats),gt=(0,h.L)(JSON.stringify({version:2,heartbeats:$i}));return Ke._heartbeatsCache.lastSentHeartbeatDate=jn,Zi.length>0?(Ke._heartbeatsCache.heartbeats=Zi,yield Ke._storage.overwrite(Ke._heartbeatsCache)):(Ke._heartbeatsCache.heartbeats=[],Ke._storage.overwrite(Ke._heartbeatsCache)),gt})()}}function Pn(){return(new Date).toISOString().substring(0,10)}class Un{constructor(Ke){this.app=Ke,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,W.Z)(function*(){return!!(0,h.hl)()&&(0,h.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Ke=this;return(0,W.Z)(function*(){if(yield Ke._canUseIndexedDBPromise){const jn=yield function ue(Tt){return ee.apply(this,arguments)}(Ke.app);return jn?.heartbeats?jn:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(Ke){var dn=this;return(0,W.Z)(function*(){var jn;if(yield dn._canUseIndexedDBPromise){const Zi=yield dn.read();return Te(dn.app,{lastSentHeartbeatDate:null!==(jn=Ke.lastSentHeartbeatDate)&&void 0!==jn?jn:Zi.lastSentHeartbeatDate,heartbeats:Ke.heartbeats})}})()}add(Ke){var dn=this;return(0,W.Z)(function*(){var jn;if(yield dn._canUseIndexedDBPromise){const Zi=yield dn.read();return Te(dn.app,{lastSentHeartbeatDate:null!==(jn=Ke.lastSentHeartbeatDate)&&void 0!==jn?jn:Zi.lastSentHeartbeatDate,heartbeats:[...Zi.heartbeats,...Ke.heartbeats]})}})()}}function po(Tt){return(0,h.L)(JSON.stringify({version:2,heartbeats:Tt})).length}!function Vc(Tt){co(new ie.wA("platform-logger",Ke=>new nn(Ke),"PRIVATE")),co(new ie.wA("heartbeat",Ke=>new vi(Ke),"PRIVATE")),ut(Rt,"0.9.25",Tt),ut(Rt,"0.9.25","esm2017"),ut("fire-js","")}("")},4537:(kn,an,Ve)=>{"use strict";Ve.d(an,{H0:()=>se,wA:()=>fe});var W=Ve(5861),ie=Ve(9058);class fe{constructor(xe,ae,he){this.name=xe,this.instanceFactory=ae,this.type=he,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(xe){return this.instantiationMode=xe,this}setMultipleInstances(xe){return this.multipleInstances=xe,this}setServiceProps(xe){return this.serviceProps=xe,this}setInstanceCreatedCallback(xe){return this.onInstanceCreated=xe,this}}const h="[DEFAULT]";class Me{constructor(xe,ae){this.name=xe,this.container=ae,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(xe){const ae=this.normalizeInstanceIdentifier(xe);if(!this.instancesDeferred.has(ae)){const he=new ie.BH;if(this.instancesDeferred.set(ae,he),this.isInitialized(ae)||this.shouldAutoInitialize())try{const _e=this.getOrInitializeService({instanceIdentifier:ae});_e&&he.resolve(_e)}catch{}}return this.instancesDeferred.get(ae).promise}getImmediate(xe){var ae;const he=this.normalizeInstanceIdentifier(xe?.identifier),_e=null!==(ae=xe?.optional)&&void 0!==ae&&ae;if(!this.isInitialized(he)&&!this.shouldAutoInitialize()){if(_e)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:he})}catch(ke){if(_e)return null;throw ke}}getComponent(){return this.component}setComponent(xe){if(xe.name!==this.name)throw Error(`Mismatching Component ${xe.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=xe,this.shouldAutoInitialize()){if(function rt(ce){return"EAGER"===ce.instantiationMode}(xe))try{this.getOrInitializeService({instanceIdentifier:h})}catch{}for(const[ae,he]of this.instancesDeferred.entries()){const _e=this.normalizeInstanceIdentifier(ae);try{const ke=this.getOrInitializeService({instanceIdentifier:_e});he.resolve(ke)}catch{}}}}clearInstance(xe=h){this.instancesDeferred.delete(xe),this.instancesOptions.delete(xe),this.instances.delete(xe)}delete(){var xe=this;return(0,W.Z)(function*(){const ae=Array.from(xe.instances.values());yield Promise.all([...ae.filter(he=>"INTERNAL"in he).map(he=>he.INTERNAL.delete()),...ae.filter(he=>"_delete"in he).map(he=>he._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(xe=h){return this.instances.has(xe)}getOptions(xe=h){return this.instancesOptions.get(xe)||{}}initialize(xe={}){const{options:ae={}}=xe,he=this.normalizeInstanceIdentifier(xe.instanceIdentifier);if(this.isInitialized(he))throw Error(`${this.name}(${he}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const _e=this.getOrInitializeService({instanceIdentifier:he,options:ae});for(const[ke,$e]of this.instancesDeferred.entries())he===this.normalizeInstanceIdentifier(ke)&&$e.resolve(_e);return _e}onInit(xe,ae){var he;const _e=this.normalizeInstanceIdentifier(ae),ke=null!==(he=this.onInitCallbacks.get(_e))&&void 0!==he?he:new Set;ke.add(xe),this.onInitCallbacks.set(_e,ke);const $e=this.instances.get(_e);return $e&&xe($e,_e),()=>{ke.delete(xe)}}invokeOnInitCallbacks(xe,ae){const he=this.onInitCallbacks.get(ae);if(he)for(const _e of he)try{_e(xe,ae)}catch{}}getOrInitializeService({instanceIdentifier:xe,options:ae={}}){let he=this.instances.get(xe);if(!he&&this.component&&(he=this.component.instanceFactory(this.container,{instanceIdentifier:(ce=xe,ce===h?void 0:ce),options:ae}),this.instances.set(xe,he),this.instancesOptions.set(xe,ae),this.invokeOnInitCallbacks(he,xe),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,xe,he)}catch{}var ce;return he||null}normalizeInstanceIdentifier(xe=h){return this.component?this.component.multipleInstances?xe:h:xe}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class se{constructor(xe){this.name=xe,this.providers=new Map}addComponent(xe){const ae=this.getProvider(xe.name);if(ae.isComponentSet())throw new Error(`Component ${xe.name} has already been registered with ${this.name}`);ae.setComponent(xe)}addOrOverwriteComponent(xe){this.getProvider(xe.name).isComponentSet()&&this.providers.delete(xe.name),this.addComponent(xe)}getProvider(xe){if(this.providers.has(xe))return this.providers.get(xe);const ae=new Me(xe,this);return this.providers.set(xe,ae),ae}getProviders(){return Array.from(this.providers.values())}}},7879:(kn,an,Ve)=>{"use strict";Ve.d(an,{Am:()=>ce,Ub:()=>se,Yd:()=>rt,in:()=>ie});const W=[];var ie=function(xe){return xe[xe.DEBUG=0]="DEBUG",xe[xe.VERBOSE=1]="VERBOSE",xe[xe.INFO=2]="INFO",xe[xe.WARN=3]="WARN",xe[xe.ERROR=4]="ERROR",xe[xe.SILENT=5]="SILENT",xe}(ie||{});const fe={debug:ie.DEBUG,verbose:ie.VERBOSE,info:ie.INFO,warn:ie.WARN,error:ie.ERROR,silent:ie.SILENT},h=ie.INFO,Me={[ie.DEBUG]:"log",[ie.VERBOSE]:"log",[ie.INFO]:"info",[ie.WARN]:"warn",[ie.ERROR]:"error"},He=(xe,ae,...he)=>{if(ae<xe.logLevel)return;const _e=(new Date).toISOString(),ke=Me[ae];if(!ke)throw new Error(`Attempted to log a message with an invalid logType (value: ${ae})`);console[ke](`[${_e}]  ${xe.name}:`,...he)};class rt{constructor(ae){this.name=ae,this._logLevel=h,this._logHandler=He,this._userLogHandler=null,W.push(this)}get logLevel(){return this._logLevel}set logLevel(ae){if(!(ae in ie))throw new TypeError(`Invalid value "${ae}" assigned to \`logLevel\``);this._logLevel=ae}setLogLevel(ae){this._logLevel="string"==typeof ae?fe[ae]:ae}get logHandler(){return this._logHandler}set logHandler(ae){if("function"!=typeof ae)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=ae}get userLogHandler(){return this._userLogHandler}set userLogHandler(ae){this._userLogHandler=ae}debug(...ae){this._userLogHandler&&this._userLogHandler(this,ie.DEBUG,...ae),this._logHandler(this,ie.DEBUG,...ae)}log(...ae){this._userLogHandler&&this._userLogHandler(this,ie.VERBOSE,...ae),this._logHandler(this,ie.VERBOSE,...ae)}info(...ae){this._userLogHandler&&this._userLogHandler(this,ie.INFO,...ae),this._logHandler(this,ie.INFO,...ae)}warn(...ae){this._userLogHandler&&this._userLogHandler(this,ie.WARN,...ae),this._logHandler(this,ie.WARN,...ae)}error(...ae){this._userLogHandler&&this._userLogHandler(this,ie.ERROR,...ae),this._logHandler(this,ie.ERROR,...ae)}}function se(xe){W.forEach(ae=>{ae.setLogLevel(xe)})}function ce(xe,ae){for(const he of W){let _e=null;ae&&ae.level&&(_e=fe[ae.level]),he.userLogHandler=null===xe?null:(ke,$e,...Je)=>{const tt=Je.map(Ie=>{if(null==Ie)return null;if("string"==typeof Ie)return Ie;if("number"==typeof Ie||"boolean"==typeof Ie)return Ie.toString();if(Ie instanceof Error)return Ie.message;try{return JSON.stringify(Ie)}catch{return null}}).filter(Ie=>Ie).join(" ");$e>=(_e??ke.logLevel)&&xe({level:ie[$e].toLowerCase(),message:tt,args:Je,type:ke.name})}}}},6365:(kn,an,Ve)=>{"use strict";Ve.r(an);var W=Ve(5861),ie=Ve(3106),fe=Ve(8217),h=Ve(9058),rt=(Ve(534),Ve(7879),Ve(4537));function se(){return window}function ae(){return ae=(0,W.Z)(function*(ne,ue,ee){var Te;const{BuildInfo:bt}=se();(0,fe.au)(ue.sessionId,"AuthEvent did not contain a session ID");const En=yield function Ie(ne){return Le.apply(this,arguments)}(ue.sessionId),bn={};return(0,fe.av)()?bn.ibi=bt.packageName:(0,fe.aw)()?bn.apn=bt.packageName:(0,fe.ax)(ne,"operation-not-supported-in-this-environment"),bt.displayName&&(bn.appDisplayName=bt.displayName),bn.sessionId=En,(0,fe.ay)(ne,ee,ue.type,void 0,null!==(Te=ue.eventId)&&void 0!==Te?Te:void 0,bn)}),ae.apply(this,arguments)}function _e(){return(_e=(0,W.Z)(function*(ne){const{BuildInfo:ue}=se(),ee={};(0,fe.av)()?ee.iosBundleId=ue.packageName:(0,fe.aw)()?ee.androidPackageName=ue.packageName:(0,fe.ax)(ne,"operation-not-supported-in-this-environment"),yield(0,fe.az)(ne,ee)})).apply(this,arguments)}function Je(){return(Je=(0,W.Z)(function*(ne,ue,ee){const{cordova:Te}=se();let bt=()=>{};try{yield new Promise((En,bn)=>{let Xn=null;function vi(){var Un;En();const po=null===(Un=Te.plugins.browsertab)||void 0===Un?void 0:Un.close;"function"==typeof po&&po(),"function"==typeof ee?.close&&ee.close()}function Pn(){Xn||(Xn=window.setTimeout(()=>{bn((0,fe.aB)(ne,"redirect-cancelled-by-user"))},2e3))}function Li(){"visible"===document?.visibilityState&&Pn()}ue.addPassiveListener(vi),document.addEventListener("resume",Pn,!1),(0,fe.aw)()&&document.addEventListener("visibilitychange",Li,!1),bt=()=>{ue.removePassiveListener(vi),document.removeEventListener("resume",Pn,!1),document.removeEventListener("visibilitychange",Li,!1),Xn&&window.clearTimeout(Xn)}})}finally{bt()}})).apply(this,arguments)}function Le(){return(Le=(0,W.Z)(function*(ne){const ue=function mt(ne){if((0,fe.au)(/[0-9a-zA-Z]+/.test(ne),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(ne);const ue=new ArrayBuffer(ne.length),ee=new Uint8Array(ue);for(let Te=0;Te<ne.length;Te++)ee[Te]=ne.charCodeAt(Te);return ee}(ne),ee=yield crypto.subtle.digest("SHA-256",ue);return Array.from(new Uint8Array(ee)).map(bt=>bt.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class ze extends fe.aD{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(ue=>{this.resolveInialized=ue})}addPassiveListener(ue){this.passiveListeners.add(ue)}removePassiveListener(ue){this.passiveListeners.delete(ue)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(ue){return this.resolveInialized(),this.passiveListeners.forEach(ee=>ee(ue)),super.onEvent(ue)}initialized(){var ue=this;return(0,W.Z)(function*(){yield ue.initPromise})()}}function xt(ne){return lt.apply(this,arguments)}function lt(){return(lt=(0,W.Z)(function*(ne){const ue=yield nn()._get(wn(ne));return ue&&(yield nn()._remove(wn(ne))),ue})).apply(this,arguments)}function Lt(){const ne=[];for(let ee=0;ee<20;ee++){const Te=Math.floor(62*Math.random());ne.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Te))}return ne.join("")}function nn(){return(0,fe.aE)(fe.b)}function wn(ne){return(0,fe.aF)("authEvent",ne.config.apiKey,ne.name)}function Kt(ne){if(!ne?.includes("?"))return{};const[ue,...ee]=ne.split("?");return(0,h.zd)(ee.join("?"))}const Pe=class yi{constructor(){this._redirectPersistence=fe.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=fe.aG,this._overrideRedirectResult=fe.aH}_initialize(ue){var ee=this;return(0,W.Z)(function*(){const Te=ue._key();let bt=ee.eventManagers.get(Te);return bt||(bt=new ze(ue),ee.eventManagers.set(Te,bt),ee.attachCallbackListeners(ue,bt)),bt})()}_openPopup(ue){(0,fe.ax)(ue,"operation-not-supported-in-this-environment")}_openRedirect(ue,ee,Te,bt){var En=this;return(0,W.Z)(function*(){!function tt(ne){var ue,ee,Te,bt,En,bn,Xn,vi,Pn,Li;const Un=se();(0,fe.aC)("function"==typeof(null===(ue=Un?.universalLinks)||void 0===ue?void 0:ue.subscribe),ne,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,fe.aC)(typeof(null===(ee=Un?.BuildInfo)||void 0===ee?void 0:ee.packageName)<"u",ne,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,fe.aC)("function"==typeof(null===(En=null===(bt=null===(Te=Un?.cordova)||void 0===Te?void 0:Te.plugins)||void 0===bt?void 0:bt.browsertab)||void 0===En?void 0:En.openUrl),ne,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,fe.aC)("function"==typeof(null===(vi=null===(Xn=null===(bn=Un?.cordova)||void 0===bn?void 0:bn.plugins)||void 0===Xn?void 0:Xn.browsertab)||void 0===vi?void 0:vi.isAvailable),ne,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,fe.aC)("function"==typeof(null===(Li=null===(Pn=Un?.cordova)||void 0===Pn?void 0:Pn.InAppBrowser)||void 0===Li?void 0:Li.open),ne,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(ue);const bn=yield En._initialize(ue);yield bn.initialized(),bn.resetRedirect(),(0,fe.aI)(),yield En._originValidation(ue);const Xn=function kt(ne,ue,ee=null){return{type:ue,eventId:ee,urlResponse:null,sessionId:Lt(),postBody:null,tenantId:ne.tenantId,error:(0,fe.aB)(ne,"no-auth-event")}}(ue,Te,bt);yield function fn(ne,ue){return nn()._set(wn(ne),ue)}(ue,Xn);const vi=yield function xe(ne,ue,ee){return ae.apply(this,arguments)}(ue,Xn,ee),Pn=yield function ke(ne){const{cordova:ue}=se();return new Promise(ee=>{ue.plugins.browsertab.isAvailable(Te=>{let bt=null;Te?ue.plugins.browsertab.openUrl(ne):bt=ue.InAppBrowser.open(ne,(0,fe.aA)()?"_blank":"_system","location=yes"),ee(bt)})})}(vi);return function $e(ne,ue,ee){return Je.apply(this,arguments)}(ue,bn,Pn)})()}_isIframeWebStorageSupported(ue,ee){throw new Error("Method not implemented.")}_originValidation(ue){const ee=ue._key();return this.originValidationPromises[ee]||(this.originValidationPromises[ee]=function he(ne){return _e.apply(this,arguments)}(ue)),this.originValidationPromises[ee]}attachCallbackListeners(ue,ee){const{universalLinks:Te,handleOpenURL:bt,BuildInfo:En}=se(),bn=setTimeout((0,W.Z)(function*(){yield xt(ue),ee.onEvent(qe())}),500),Xn=function(){var Li=(0,W.Z)(function*(Un){clearTimeout(bn);const po=yield xt(ue);let Vc=null;po&&Un?.url&&(Vc=function pn(ne,ue){var ee,Te;const bt=function Jn(ne){const ue=Kt(ne),ee=ue.link?decodeURIComponent(ue.link):void 0,Te=Kt(ee).link,bt=ue.deep_link_id?decodeURIComponent(ue.deep_link_id):void 0;return Kt(bt).link||bt||Te||ee||ne}(ue);if(bt.includes("/__/auth/callback")){const En=Kt(bt),bn=En.firebaseError?function Rt(ne){try{return JSON.parse(ne)}catch{return null}}(decodeURIComponent(En.firebaseError)):null,Xn=null===(Te=null===(ee=bn?.code)||void 0===ee?void 0:ee.split("auth/"))||void 0===Te?void 0:Te[1],vi=Xn?(0,fe.aB)(Xn):null;return vi?{type:ne.type,eventId:ne.eventId,tenantId:ne.tenantId,error:vi,urlResponse:null,sessionId:null,postBody:null}:{type:ne.type,eventId:ne.eventId,tenantId:ne.tenantId,sessionId:ne.sessionId,urlResponse:bt,postBody:null}}return null}(po,Un.url)),ee.onEvent(Vc||qe())});return function(po){return Li.apply(this,arguments)}}();typeof Te<"u"&&"function"==typeof Te.subscribe&&Te.subscribe(null,Xn);const vi=bt,Pn=`${En.packageName.toLowerCase()}://`;se().handleOpenURL=function(){var Li=(0,W.Z)(function*(Un){if(Un.toLowerCase().startsWith(Pn)&&Xn({url:Un}),"function"==typeof vi)try{vi(Un)}catch(po){console.error(po)}});return function(Un){return Li.apply(this,arguments)}}()}};function qe(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,fe.aB)("no-auth-event")}}function _n(){var ne;return(null===(ne=self?.location)||void 0===ne?void 0:ne.protocol)||null}function $t(ne=(0,h.z$)()){return!("file:"!==_n()&&"ionic:"!==_n()&&"capacitor:"!==_n()||!ne.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ei(){try{const ne=self.localStorage,ue=fe.aN();if(ne)return ne.setItem(ue,"1"),ne.removeItem(ue),!function ti(ne=(0,h.z$)()){return function bi(){return(0,h.w1)()&&11===document?.documentMode}()||function ur(ne=(0,h.z$)()){return/Edge\/\d+/.test(ne)}(ne)}()||(0,h.hl)()}catch{return Vr()&&(0,h.hl)()}return!1}function Vr(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function pr(){return(function Rn(){return"http:"===_n()||"https:"===_n()}()||(0,h.ru)()||$t())&&!function qn(){return(0,h.b$)()||(0,h.UG)()}()&&Ei()&&!Vr()}function dr(){return $t()&&typeof document<"u"}function Fo(){return(Fo=(0,W.Z)(function*(){return!!dr()&&new Promise(ne=>{const ue=setTimeout(()=>{ne(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(ue),ne(!0)})})})).apply(this,arguments)}const hi={LOCAL:"local",NONE:"none",SESSION:"session"},Or=fe.aC,bo="persistence";function Jr(ne){return Ir.apply(this,arguments)}function Ir(){return(Ir=(0,W.Z)(function*(ne){yield ne._initializationPromise;const ue=So(),ee=fe.aF(bo,ne.config.apiKey,ne.name);ue&&ue.setItem(ee,ne._getPersistence())})).apply(this,arguments)}function So(){var ne;try{return(null===(ne=function Lo(){return typeof window<"u"?window:null}())||void 0===ne?void 0:ne.sessionStorage)||null}catch{return null}}const Mo=fe.aC;class co{constructor(){this.browserResolver=fe.aE(fe.k),this.cordovaResolver=fe.aE(Pe),this.underlyingResolver=null,this._redirectPersistence=fe.a,this._completeRedirectFn=fe.aG,this._overrideRedirectResult=fe.aH}_initialize(ue){var ee=this;return(0,W.Z)(function*(){return yield ee.selectUnderlyingResolver(),ee.assertedUnderlyingResolver._initialize(ue)})()}_openPopup(ue,ee,Te,bt){var En=this;return(0,W.Z)(function*(){return yield En.selectUnderlyingResolver(),En.assertedUnderlyingResolver._openPopup(ue,ee,Te,bt)})()}_openRedirect(ue,ee,Te,bt){var En=this;return(0,W.Z)(function*(){return yield En.selectUnderlyingResolver(),En.assertedUnderlyingResolver._openRedirect(ue,ee,Te,bt)})()}_isIframeWebStorageSupported(ue,ee){this.assertedUnderlyingResolver._isIframeWebStorageSupported(ue,ee)}_originValidation(ue){return this.assertedUnderlyingResolver._originValidation(ue)}get _shouldInitProactively(){return dr()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Mo(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var ue=this;return(0,W.Z)(function*(){if(ue.underlyingResolver)return;const ee=yield function lo(){return Fo.apply(this,arguments)}();ue.underlyingResolver=ee?ue.cordovaResolver:ue.browserResolver})()}}function Bi(ne){return ne.unwrap()}function Sr(ne){return vr(ne)}function vr(ne){const{_tokenResponse:ue}=ne instanceof h.ZR?ne.customData:ne;if(!ue)return null;if(!(ne instanceof h.ZR)&&"temporaryProof"in ue&&"phoneNumber"in ue)return fe.P.credentialFromResult(ne);const ee=ue.providerId;if(!ee||ee===fe.p.PASSWORD)return null;let Te;switch(ee){case fe.p.GOOGLE:Te=fe.X;break;case fe.p.FACEBOOK:Te=fe.W;break;case fe.p.GITHUB:Te=fe.Y;break;case fe.p.TWITTER:Te=fe.$;break;default:const{oauthIdToken:bt,oauthAccessToken:En,oauthTokenSecret:bn,pendingToken:Xn,nonce:vi}=ue;return En||bn||bt||Xn?Xn?ee.startsWith("saml.")?fe.aQ._create(ee,Xn):fe.N._fromParams({providerId:ee,signInMethod:ee,pendingToken:Xn,idToken:bt,accessToken:En}):new fe.Z(ee).credential({idToken:bt,accessToken:En,rawNonce:vi}):null}return ne instanceof h.ZR?Te.credentialFromError(ne):Te.credentialFromResult(ne)}function zr(ne,ue){return ue.catch(ee=>{throw ee instanceof h.ZR&&function Ks(ne,ue){var ee;const Te=null===(ee=ue.customData)||void 0===ee?void 0:ee._tokenResponse;if("auth/multi-factor-auth-required"===ue?.code)ue.resolver=new oe(ne,fe.as(ne,ue));else if(Te){const bt=vr(ue),En=ue;bt&&(En.credential=bt,En.tenantId=Te.tenantId||void 0,En.email=Te.email||void 0,En.phoneNumber=Te.phoneNumber||void 0)}}(ne,ee),ee}).then(ee=>{const bt=ee.user;return{operationType:ee.operationType,credential:Sr(ee),additionalUserInfo:fe.aq(ee),user:De.getOrCreate(bt)}})}function Re(ne,ue){return te.apply(this,arguments)}function te(){return(te=(0,W.Z)(function*(ne,ue){const ee=yield ue;return{verificationId:ee.verificationId,confirm:Te=>zr(ne,ee.confirm(Te))}})).apply(this,arguments)}class oe{constructor(ue,ee){this.resolver=ee,this.auth=function qr(ne){return ne.wrapped()}(ue)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(ue){return zr(Bi(this.auth),this.resolver.resolveSignIn(ue))}}class De{constructor(ue){this._delegate=ue,this.multiFactor=fe.at(ue)}static getOrCreate(ue){return De.USER_MAP.has(ue)||De.USER_MAP.set(ue,new De(ue)),De.USER_MAP.get(ue)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(ue){return this._delegate.getIdTokenResult(ue)}getIdToken(ue){return this._delegate.getIdToken(ue)}linkAndRetrieveDataWithCredential(ue){return this.linkWithCredential(ue)}linkWithCredential(ue){var ee=this;return(0,W.Z)(function*(){return zr(ee.auth,fe.a2(ee._delegate,ue))})()}linkWithPhoneNumber(ue,ee){var Te=this;return(0,W.Z)(function*(){return Re(Te.auth,fe.l(Te._delegate,ue,ee))})()}linkWithPopup(ue){var ee=this;return(0,W.Z)(function*(){return zr(ee.auth,fe.d(ee._delegate,ue,co))})()}linkWithRedirect(ue){var ee=this;return(0,W.Z)(function*(){return yield Jr(fe.aJ(ee.auth)),fe.g(ee._delegate,ue,co)})()}reauthenticateAndRetrieveDataWithCredential(ue){return this.reauthenticateWithCredential(ue)}reauthenticateWithCredential(ue){var ee=this;return(0,W.Z)(function*(){return zr(ee.auth,fe.a3(ee._delegate,ue))})()}reauthenticateWithPhoneNumber(ue,ee){return Re(this.auth,fe.r(this._delegate,ue,ee))}reauthenticateWithPopup(ue){return zr(this.auth,fe.e(this._delegate,ue,co))}reauthenticateWithRedirect(ue){var ee=this;return(0,W.Z)(function*(){return yield Jr(fe.aJ(ee.auth)),fe.h(ee._delegate,ue,co)})()}sendEmailVerification(ue){return fe.ag(this._delegate,ue)}unlink(ue){var ee=this;return(0,W.Z)(function*(){return yield fe.ap(ee._delegate,ue),ee})()}updateEmail(ue){return fe.al(this._delegate,ue)}updatePassword(ue){return fe.am(this._delegate,ue)}updatePhoneNumber(ue){return fe.u(this._delegate,ue)}updateProfile(ue){return fe.ak(this._delegate,ue)}verifyBeforeUpdateEmail(ue,ee){return fe.ah(this._delegate,ue,ee)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}De.USER_MAP=new WeakMap;const Be=fe.aC;let Qe=(()=>{class ne{constructor(ee,Te){if(this.app=ee,Te.isInitialized())return this._delegate=Te.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:bt}=ee.options;Be(bt,"invalid-api-key",{appName:ee.name}),Be(bt,"invalid-api-key",{appName:ee.name});const En=typeof window<"u"?co:void 0;this._delegate=Te.initialize({options:{persistence:dt(bt,ee.name),popupRedirectResolver:En}}),this._delegate._updateErrorMap(fe.G),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?De.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(ee){this._delegate.languageCode=ee}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(ee){this._delegate.tenantId=ee}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(ee,Te){fe.K(this._delegate,ee,Te)}applyActionCode(ee){return fe.a7(this._delegate,ee)}checkActionCode(ee){return fe.a8(this._delegate,ee)}confirmPasswordReset(ee,Te){return fe.a6(this._delegate,ee,Te)}createUserWithEmailAndPassword(ee,Te){var bt=this;return(0,W.Z)(function*(){return zr(bt._delegate,fe.aa(bt._delegate,ee,Te))})()}fetchProvidersForEmail(ee){return this.fetchSignInMethodsForEmail(ee)}fetchSignInMethodsForEmail(ee){return fe.af(this._delegate,ee)}isSignInWithEmailLink(ee){return fe.ad(this._delegate,ee)}getRedirectResult(){var ee=this;return(0,W.Z)(function*(){Be(pr(),ee._delegate,"operation-not-supported-in-this-environment");const Te=yield fe.j(ee._delegate,co);return Te?zr(ee._delegate,Promise.resolve(Te)):{credential:null,user:null}})()}addFrameworkForLogging(ee){!function Oe(ne,ue){(0,fe.aJ)(ne)._logFramework(ue)}(this._delegate,ee)}onAuthStateChanged(ee,Te,bt){const{next:En,error:bn,complete:Xn}=ut(ee,Te,bt);return this._delegate.onAuthStateChanged(En,bn,Xn)}onIdTokenChanged(ee,Te,bt){const{next:En,error:bn,complete:Xn}=ut(ee,Te,bt);return this._delegate.onIdTokenChanged(En,bn,Xn)}sendSignInLinkToEmail(ee,Te){return fe.ac(this._delegate,ee,Te)}sendPasswordResetEmail(ee,Te){return fe.a5(this._delegate,ee,Te||void 0)}setPersistence(ee){var Te=this;return(0,W.Z)(function*(){let bt;switch(function Wo(ne,ue){Or(Object.values(hi).includes(ue),ne,"invalid-persistence-type"),(0,h.b$)()?Or(ue!==hi.SESSION,ne,"unsupported-persistence-type"):(0,h.UG)()?Or(ue===hi.NONE,ne,"unsupported-persistence-type"):Vr()?Or(ue===hi.NONE||ue===hi.LOCAL&&(0,h.hl)(),ne,"unsupported-persistence-type"):Or(ue===hi.NONE||Ei(),ne,"unsupported-persistence-type")}(Te._delegate,ee),ee){case hi.SESSION:bt=fe.a;break;case hi.LOCAL:bt=(yield fe.aE(fe.i)._isAvailable())?fe.i:fe.b;break;case hi.NONE:bt=fe.U;break;default:return fe.ax("argument-error",{appName:Te._delegate.name})}return Te._delegate.setPersistence(bt)})()}signInAndRetrieveDataWithCredential(ee){return this.signInWithCredential(ee)}signInAnonymously(){return zr(this._delegate,fe.a0(this._delegate))}signInWithCredential(ee){return zr(this._delegate,fe.a1(this._delegate,ee))}signInWithCustomToken(ee){return zr(this._delegate,fe.a4(this._delegate,ee))}signInWithEmailAndPassword(ee,Te){return zr(this._delegate,fe.ab(this._delegate,ee,Te))}signInWithEmailLink(ee,Te){return zr(this._delegate,fe.ae(this._delegate,ee,Te))}signInWithPhoneNumber(ee,Te){return Re(this._delegate,fe.s(this._delegate,ee,Te))}signInWithPopup(ee){var Te=this;return(0,W.Z)(function*(){return Be(pr(),Te._delegate,"operation-not-supported-in-this-environment"),zr(Te._delegate,fe.c(Te._delegate,ee,co))})()}signInWithRedirect(ee){var Te=this;return(0,W.Z)(function*(){return Be(pr(),Te._delegate,"operation-not-supported-in-this-environment"),yield Jr(Te._delegate),fe.f(Te._delegate,ee,co)})()}updateCurrentUser(ee){return this._delegate.updateCurrentUser(ee)}verifyPasswordResetCode(ee){return fe.a9(this._delegate,ee)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return ne.Persistence=hi,ne})();function ut(ne,ue,ee){let Te=ne;"function"!=typeof ne&&({next:Te,error:ue,complete:ee}=ne);const bt=Te;return{next:bn=>bt(bn&&De.getOrCreate(bn)),error:ue,complete:ee}}function dt(ne,ue){const ee=function fo(ne,ue){const ee=So();if(!ee)return[];const Te=fe.aF(bo,ne,ue);switch(ee.getItem(Te)){case hi.NONE:return[fe.U];case hi.LOCAL:return[fe.i,fe.a];case hi.SESSION:return[fe.a];default:return[]}}(ne,ue);if(typeof self<"u"&&!ee.includes(fe.i)&&ee.push(fe.i),typeof window<"u")for(const Te of[fe.b,fe.a])ee.includes(Te)||ee.push(Te);return ee.includes(fe.U)||ee.push(fe.U),ee}class et{constructor(){this.providerId="phone",this._delegate=new fe.P(Bi(ie.Z.auth()))}static credential(ue,ee){return fe.P.credential(ue,ee)}verifyPhoneNumber(ue,ee){return this._delegate.verifyPhoneNumber(ue,ee)}unwrap(){return this._delegate}}et.PHONE_SIGN_IN_METHOD=fe.P.PHONE_SIGN_IN_METHOD,et.PROVIDER_ID=fe.P.PROVIDER_ID;const Et=fe.aC;class tn{constructor(ue,ee,Te=ie.Z.app()){var bt;Et(null===(bt=Te.options)||void 0===bt?void 0:bt.apiKey,"invalid-api-key",{appName:Te.name}),this._delegate=new fe.R(Te.auth(),ue,ee),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function pe(ne){ne.INTERNAL.registerComponent(new rt.wA("auth-compat",ue=>{const ee=ue.getProvider("app-compat").getImmediate(),Te=ue.getProvider("auth");return new Qe(ee,Te)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:fe.A.EMAIL_SIGNIN,PASSWORD_RESET:fe.A.PASSWORD_RESET,RECOVER_EMAIL:fe.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:fe.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:fe.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:fe.A.VERIFY_EMAIL}},EmailAuthProvider:fe.V,FacebookAuthProvider:fe.W,GithubAuthProvider:fe.Y,GoogleAuthProvider:fe.X,OAuthProvider:fe.Z,SAMLAuthProvider:fe._,PhoneAuthProvider:et,PhoneMultiFactorGenerator:fe.m,RecaptchaVerifier:tn,TwitterAuthProvider:fe.$,Auth:Qe,AuthCredential:fe.L,Error:h.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),ne.registerVersion("@firebase/auth-compat","0.5.1")}(ie.Z)},5861:(kn,an,Ve)=>{"use strict";function W(fe,h,Me,He,rt,se,ce){try{var xe=fe[se](ce),ae=xe.value}catch(he){return void Me(he)}xe.done?h(ae):Promise.resolve(ae).then(He,rt)}function ie(fe){return function(){var h=this,Me=arguments;return new Promise(function(He,rt){var se=fe.apply(h,Me);function ce(ae){W(se,He,rt,ce,xe,"next",ae)}function xe(ae){W(se,He,rt,ce,xe,"throw",ae)}ce(void 0)})}}Ve.d(an,{Z:()=>ie})},7582:(kn,an,Ve)=>{"use strict";function h(Pe,qe){var Oe={};for(var Ue in Pe)Object.prototype.hasOwnProperty.call(Pe,Ue)&&qe.indexOf(Ue)<0&&(Oe[Ue]=Pe[Ue]);if(null!=Pe&&"function"==typeof Object.getOwnPropertySymbols){var Ft=0;for(Ue=Object.getOwnPropertySymbols(Pe);Ft<Ue.length;Ft++)qe.indexOf(Ue[Ft])<0&&Object.prototype.propertyIsEnumerable.call(Pe,Ue[Ft])&&(Oe[Ue[Ft]]=Pe[Ue[Ft]])}return Oe}function he(Pe,qe,Oe,Ue){return new(Oe||(Oe=Promise))(function(Ot,_n){function Rn(bi){try{qn(Ue.next(bi))}catch(ur){_n(ur)}}function $t(bi){try{qn(Ue.throw(bi))}catch(ur){_n(ur)}}function qn(bi){bi.done?Ot(bi.value):function Ft(Ot){return Ot instanceof Oe?Ot:new Oe(function(_n){_n(Ot)})}(bi.value).then(Rn,$t)}qn((Ue=Ue.apply(Pe,qe||[])).next())})}function at(Pe){return this instanceof at?(this.v=Pe,this):new at(Pe)}function ze(Pe,qe,Oe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ft,Ue=Oe.apply(Pe,qe||[]),Ot=[];return Ft={},_n("next"),_n("throw"),_n("return"),Ft[Symbol.asyncIterator]=function(){return this},Ft;function _n(ti){Ue[ti]&&(Ft[ti]=function(Ei){return new Promise(function(Vr,pr){Ot.push([ti,Ei,Vr,pr])>1||Rn(ti,Ei)})})}function Rn(ti,Ei){try{!function $t(ti){ti.value instanceof at?Promise.resolve(ti.value.v).then(qn,bi):ur(Ot[0][2],ti)}(Ue[ti](Ei))}catch(Vr){ur(Ot[0][3],Vr)}}function qn(ti){Rn("next",ti)}function bi(ti){Rn("throw",ti)}function ur(ti,Ei){ti(Ei),Ot.shift(),Ot.length&&Rn(Ot[0][0],Ot[0][1])}}function fn(Pe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Oe,qe=Pe[Symbol.asyncIterator];return qe?qe.call(Pe):(Pe=function Je(Pe){var qe="function"==typeof Symbol&&Symbol.iterator,Oe=qe&&Pe[qe],Ue=0;if(Oe)return Oe.call(Pe);if(Pe&&"number"==typeof Pe.length)return{next:function(){return Pe&&Ue>=Pe.length&&(Pe=void 0),{value:Pe&&Pe[Ue++],done:!Pe}}};throw new TypeError(qe?"Object is not iterable.":"Symbol.iterator is not defined.")}(Pe),Oe={},Ue("next"),Ue("throw"),Ue("return"),Oe[Symbol.asyncIterator]=function(){return this},Oe);function Ue(Ot){Oe[Ot]=Pe[Ot]&&function(_n){return new Promise(function(Rn,$t){!function Ft(Ot,_n,Rn,$t){Promise.resolve($t).then(function(qn){Ot({value:qn,done:Rn})},_n)}(Rn,$t,(_n=Pe[Ot](_n)).done,_n.value)})}}}Ve.d(an,{FC:()=>ze,KL:()=>fn,_T:()=>h,mG:()=>he,qq:()=>at}),"function"==typeof SuppressedError&&SuppressedError}},kn=>{kn(kn.s=4411)}]);